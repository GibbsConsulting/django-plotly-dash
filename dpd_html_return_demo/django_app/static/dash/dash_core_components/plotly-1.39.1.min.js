/**
* plotly.js v1.39.1
* Copyright 2012-2018, Plotly, Inc.
* All rights reserved.
* Licensed under the MIT license
*/
(function(t){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=t()}else if(typeof define==="function"&&define.amd){define([],t)}else{var e;if(typeof window!=="undefined"){e=window}else if(typeof global!=="undefined"){e=global}else if(typeof self!=="undefined"){e=self}else{e=this}e.Plotly=t()}})(function(){var t,e,r;return function(){function t(e,r,n){function a(o,s){if(!r[o]){if(!e[o]){var l=typeof require=="function"&&require;if(!s&&l)return l(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};e[o][0].call(c.exports,function(t){var r=e[o][1][t];return a(r?r:t)},c,c.exports,t,e,r,n)}return r[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<n.length;o++)a(n[o]);return a}return t}()({1:[function(t,e,r){"use strict";var n=t("../src/lib");var a={"X,X div":"font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;z-index:1001;background:rgba(255,255,255,0.7);","X .modebar--hover":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;margin-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-group:first-child":"margin-left:0px;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar-btn path":"fill:rgba(0,31,95,0.3);","X .modebar-btn.active path,X .modebar-btn:hover path":"fill:rgba(0,22,72,0.5);","X .modebar-btn.modebar-btn--logo":"padding:3px 1px;","X .modebar-btn.modebar-btn--logo path":"fill:#447adb !important;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans';position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var i in a){var o=i.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");n.addStyleRule(o,a[i])}},{"../src/lib":684}],2:[function(t,e,r){"use strict";e.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:1e3,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:1e3,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"}}},{}],3:[function(t,e,r){"use strict";e.exports=t("../src/transforms/aggregate")},{"../src/transforms/aggregate":1125}],4:[function(t,e,r){"use strict";e.exports=t("../src/traces/bar")},{"../src/traces/bar":831}],5:[function(t,e,r){"use strict";e.exports=t("../src/traces/box")},{"../src/traces/box":844}],6:[function(t,e,r){"use strict";e.exports=t("../src/components/calendars")},{"../src/components/calendars":556}],7:[function(t,e,r){"use strict";e.exports=t("../src/traces/candlestick")},{"../src/traces/candlestick":854}],8:[function(t,e,r){"use strict";e.exports=t("../src/traces/carpet")},{"../src/traces/carpet":873}],9:[function(t,e,r){"use strict";e.exports=t("../src/traces/choropleth")},{"../src/traces/choropleth":887}],10:[function(t,e,r){"use strict";e.exports=t("../src/traces/cone")},{"../src/traces/cone":895}],11:[function(t,e,r){"use strict";e.exports=t("../src/traces/contour")},{"../src/traces/contour":910}],12:[function(t,e,r){"use strict";e.exports=t("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":921}],13:[function(t,e,r){"use strict";e.exports=t("../src/core")},{"../src/core":664}],14:[function(t,e,r){"use strict";e.exports=t("../src/transforms/filter")},{"../src/transforms/filter":1126}],15:[function(t,e,r){"use strict";e.exports=t("../src/transforms/groupby")},{"../src/transforms/groupby":1127}],16:[function(t,e,r){"use strict";e.exports=t("../src/traces/heatmap")},{"../src/traces/heatmap":933}],17:[function(t,e,r){"use strict";e.exports=t("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":943}],18:[function(t,e,r){"use strict";e.exports=t("../src/traces/histogram")},{"../src/traces/histogram":954}],19:[function(t,e,r){"use strict";e.exports=t("../src/traces/histogram2d")},{"../src/traces/histogram2d":960}],20:[function(t,e,r){"use strict";e.exports=t("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":964}],21:[function(t,e,r){"use strict";var n=t("./core");n.register([t("./bar"),t("./box"),t("./heatmap"),t("./histogram"),t("./histogram2d"),t("./histogram2dcontour"),t("./pie"),t("./contour"),t("./scatterternary"),t("./violin"),t("./scatter3d"),t("./surface"),t("./mesh3d"),t("./cone"),t("./streamtube"),t("./scattergeo"),t("./choropleth"),t("./scattergl"),t("./splom"),t("./pointcloud"),t("./heatmapgl"),t("./parcoords"),t("./scattermapbox"),t("./sankey"),t("./table"),t("./carpet"),t("./scattercarpet"),t("./contourcarpet"),t("./ohlc"),t("./candlestick"),t("./scatterpolar"),t("./scatterpolargl")]);n.register([t("./aggregate"),t("./filter"),t("./groupby"),t("./sort")]);n.register([t("./calendars")]);e.exports=n},{"./aggregate":3,"./bar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./cone":10,"./contour":11,"./contourcarpet":12,"./core":13,"./filter":14,"./groupby":15,"./heatmap":16,"./heatmapgl":17,"./histogram":18,"./histogram2d":19,"./histogram2dcontour":20,"./mesh3d":22,"./ohlc":23,"./parcoords":24,"./pie":25,"./pointcloud":26,"./sankey":27,"./scatter3d":28,"./scattercarpet":29,"./scattergeo":30,"./scattergl":31,"./scattermapbox":32,"./scatterpolar":33,"./scatterpolargl":34,"./scatterternary":35,"./sort":36,"./splom":37,"./streamtube":38,"./surface":39,"./table":40,"./violin":41}],22:[function(t,e,r){"use strict";e.exports=t("../src/traces/mesh3d")},{"../src/traces/mesh3d":969}],23:[function(t,e,r){"use strict";e.exports=t("../src/traces/ohlc")},{"../src/traces/ohlc":974}],24:[function(t,e,r){"use strict";e.exports=t("../src/traces/parcoords")},{"../src/traces/parcoords":985}],25:[function(t,e,r){"use strict";e.exports=t("../src/traces/pie")},{"../src/traces/pie":996}],26:[function(t,e,r){"use strict";e.exports=t("../src/traces/pointcloud")},{"../src/traces/pointcloud":1005}],27:[function(t,e,r){"use strict";e.exports=t("../src/traces/sankey")},{"../src/traces/sankey":1011}],28:[function(t,e,r){"use strict";e.exports=t("../src/traces/scatter3d")},{"../src/traces/scatter3d":1045}],29:[function(t,e,r){"use strict";e.exports=t("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1051}],30:[function(t,e,r){"use strict";e.exports=t("../src/traces/scattergeo")},{"../src/traces/scattergeo":1058}],31:[function(t,e,r){"use strict";e.exports=t("../src/traces/scattergl")},{"../src/traces/scattergl":1066}],32:[function(t,e,r){"use strict";e.exports=t("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1072}],33:[function(t,e,r){"use strict";e.exports=t("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1079}],34:[function(t,e,r){"use strict";e.exports=t("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1083}],35:[function(t,e,r){"use strict";e.exports=t("../src/traces/scatterternary")},{"../src/traces/scatterternary":1089}],36:[function(t,e,r){"use strict";e.exports=t("../src/transforms/sort")},{"../src/transforms/sort":1129}],37:[function(t,e,r){"use strict";e.exports=t("../src/traces/splom")},{"../src/traces/splom":1094}],38:[function(t,e,r){"use strict";e.exports=t("../src/traces/streamtube")},{"../src/traces/streamtube":1099}],39:[function(t,e,r){"use strict";e.exports=t("../src/traces/surface")},{"../src/traces/surface":1104}],40:[function(t,e,r){"use strict";e.exports=t("../src/traces/table")},{"../src/traces/table":1112}],41:[function(t,e,r){"use strict";e.exports=t("../src/traces/violin")},{"../src/traces/violin":1119}],42:[function(t,e,r){"use strict";e.exports=u;var n=t("right-now");var a=t("3d-view");var i=t("mouse-change");var o=t("mouse-wheel");var s=t("mouse-event-offset");var l=t("has-passive-events");function u(t,e){t=t||document.body;e=e||{};var r=[.01,Infinity];if("distanceLimits"in e){r[0]=e.distanceLimits[0];r[1]=e.distanceLimits[1]}if("zoomMin"in e){r[0]=e.zoomMin}if("zoomMax"in e){r[1]=e.zoomMax}var u=a({center:e.center||[0,0,0],up:e.up||[0,1,0],eye:e.eye||[0,0,10],mode:e.mode||"orbit",distanceLimits:r});var c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var f=0;var h=t.clientWidth;var p=t.clientHeight;var d={view:u,element:t,delay:e.delay||16,rotateSpeed:e.rotateSpeed||1,zoomSpeed:e.zoomSpeed||1,translateSpeed:e.translateSpeed||1,flipX:!!e.flipX,flipY:!!e.flipY,modes:u.modes,tick:function(){var e=n();var r=this.delay;u.idle(e-r);u.flush(e-(100+r*2));var a=e-2*r;u.recalcMatrix(a);var i=true;var o=u.computedMatrix;for(var s=0;s<16;++s){i=i&&c[s]===o[s];c[s]=o[s]}var l=t.clientWidth===h&&t.clientHeight===p;h=t.clientWidth;p=t.clientHeight;if(i){return!l}f=Math.exp(u.computedRadius[0]);return true},lookAt:function(t,e,r){u.lookAt(u.lastT(),t,e,r)},rotate:function(t,e,r){u.rotate(u.lastT(),t,e,r)},pan:function(t,e,r){u.pan(u.lastT(),t,e,r)},translate:function(t,e,r){u.translate(u.lastT(),t,e,r)}};Object.defineProperties(d,{matrix:{get:function(){return u.computedMatrix},set:function(t){u.setMatrix(u.lastT(),t);return u.computedMatrix},enumerable:true},mode:{get:function(){return u.getMode()},set:function(t){u.setMode(t);return u.getMode()},enumerable:true},center:{get:function(){return u.computedCenter},set:function(t){u.lookAt(u.lastT(),t);return u.computedCenter},enumerable:true},eye:{get:function(){return u.computedEye},set:function(t){u.lookAt(u.lastT(),null,t);return u.computedEye},enumerable:true},up:{get:function(){return u.computedUp},set:function(t){u.lookAt(u.lastT(),null,null,t);return u.computedUp},enumerable:true},distance:{get:function(){return f},set:function(t){u.setDistance(u.lastT(),t);return t},enumerable:true},distanceLimits:{get:function(){return u.getDistanceLimits(r)},set:function(t){u.setDistanceLimits(t);return t},enumerable:true}});t.addEventListener("contextmenu",function(t){t.preventDefault();return false});var v=0,g=0,m={shift:false,control:false,alt:false,meta:false};i(t,y);t.addEventListener("touchstart",function(e){var r=s(e.changedTouches[0],t);y(0,r[0],r[1],m);y(1,r[0],r[1],m);e.preventDefault()},l?{passive:false}:false);t.addEventListener("touchmove",function(e){var r=s(e.changedTouches[0],t);y(1,r[0],r[1],m);e.preventDefault()},l?{passive:false}:false);t.addEventListener("touchend",function(e){var r=s(e.changedTouches[0],t);y(0,v,g,m);e.preventDefault()},l?{passive:false}:false);function y(e,r,a,i){var o=1/t.clientHeight;var s=o*(r-v);var l=o*(a-g);var c=d.flipX?1:-1;var h=d.flipY?1:-1;var p=Math.PI*d.rotateSpeed;var y=n();if(e&1){if(i.shift){u.rotate(y,0,0,-s*p)}else{u.rotate(y,c*p*s,-h*p*l,0)}}else if(e&2){u.pan(y,-d.translateSpeed*s*f,d.translateSpeed*l*f,0)}else if(e&4){var x=d.zoomSpeed*l/window.innerHeight*(y-u.lastT())*50;u.pan(y,0,0,f*(Math.exp(x)-1))}v=r;g=a;m=i}o(t,function(t,e,r){var a=d.flipX?1:-1;var i=d.flipY?1:-1;var o=n();if(Math.abs(t)>Math.abs(e)){u.rotate(o,0,0,-t*a*Math.PI*d.rotateSpeed/window.innerWidth)}else{var s=d.zoomSpeed*i*e/window.innerHeight*(o-u.lastT())/100;u.pan(o,0,0,f*(Math.exp(s)-1))}},true);return d}},{"3d-view":43,"has-passive-events":379,"mouse-change":402,"mouse-event-offset":403,"mouse-wheel":405,"right-now":465}],43:[function(t,e,r){"use strict";e.exports=u;var n=t("turntable-camera-controller");var a=t("orbit-camera-controller");var i=t("matrix-camera-controller");function o(t,e){this._controllerNames=Object.keys(t);this._controllerList=this._controllerNames.map(function(e){return t[e]});this._mode=e;this._active=t[e];if(!this._active){this._mode="turntable";this._active=t.turntable}this.modes=this._controllerNames;this.computedMatrix=this._active.computedMatrix;this.computedEye=this._active.computedEye;this.computedUp=this._active.computedUp;this.computedCenter=this._active.computedCenter;this.computedRadius=this._active.computedRadius}var s=o.prototype;var l=[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]];l.forEach(function(t){var e=t[0];var r=[];for(var n=0;n<t[1];++n){r.push("a"+n)}var a="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+t[0]+"("+r.join()+")}";s[e]=Function.apply(null,r.concat(a))});s.recalcMatrix=function(t){this._active.recalcMatrix(t)};s.getDistance=function(t){return this._active.getDistance(t)};s.getDistanceLimits=function(t){return this._active.getDistanceLimits(t)};s.lastT=function(){return this._active.lastT()};s.setMode=function(t){if(t===this._mode){return}var e=this._controllerNames.indexOf(t);if(e<0){return}var r=this._active;var n=this._controllerList[e];var a=Math.max(r.lastT(),n.lastT());r.recalcMatrix(a);n.setMatrix(a,r.computedMatrix);this._active=n;this._mode=t;this.computedMatrix=this._active.computedMatrix;this.computedEye=this._active.computedEye;this.computedUp=this._active.computedUp;this.computedCenter=this._active.computedCenter;this.computedRadius=this._active.computedRadius};s.getMode=function(){return this._mode};function u(t){t=t||{};var e=t.eye||[0,0,1];var r=t.center||[0,0,0];var s=t.up||[0,1,0];var l=t.distanceLimits||[0,Infinity];var u=t.mode||"turntable";var c=n();var f=a();var h=i();c.setDistanceLimits(l[0],l[1]);c.lookAt(0,e,r,s);f.setDistanceLimits(l[0],l[1]);f.lookAt(0,e,r,s);h.setDistanceLimits(l[0],l[1]);h.lookAt(0,e,r,s);return new o({turntable:c,orbit:f,matrix:h},u)}},{"matrix-camera-controller":400,"orbit-camera-controller":423,"turntable-camera-controller":504}],44:[function(t,e,r){"use strict";var n=t("css-font");var a=t("pick-by-alias");var i=t("regl");var o=t("gl-util/context");var s=t("es6-weak-map");var l=t("color-normalize");var u=t("font-atlas");var c=t("typedarray-pool");var f=t("parse-rect");var h=t("is-plain-obj");var p=t("parse-unit");var d=t("to-px");var v=t("detect-kerning");var g=t("object-assign");var m=t("font-measure");var y=t("flatten-vertex-data");var x=new s;var b=false;if(document.body){var _=document.body.appendChild(document.createElement("div"));_.style.font="italic small-caps bold condensed 16px/2 cursive";if(getComputedStyle(_).fontStretch){b=true}document.body.removeChild(_)}var w=function t(e){if(k(e)){e={regl:e};this.gl=e.regl._gl}else{this.gl=o(e)}this.shader=x.get(this.gl);if(!this.shader){this.regl=e.regl||i({gl:this.gl})}else{this.regl=this.shader.regl}this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"});this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"});if(!this.shader){this.shader=this.createShader();x.set(this.gl,this.shader)}this.batch=[];this.fontSize=[];this.font=[];this.fontAtlas=[];this.draw=this.shader.draw.bind(this);this.render=function(){this.regl._refresh();this.draw(this.batch)};this.canvas=this.gl.canvas;this.update(h(e)?e:{})};w.prototype.createShader=function t(){var e=this.regl;var r=e({blend:{enable:true,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:false},depth:{enable:false},count:e.prop("count"),offset:e.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:e.this("sizeBuffer")},width:{offset:0,stride:8,buffer:e.this("sizeBuffer")},char:e.this("charBuffer"),position:e.this("position")},uniforms:{atlasSize:function(t,e){return[e.atlas.width,e.atlas.height]},atlasDim:function(t,e){return[e.atlas.cols,e.atlas.rows]},atlas:function(t,e){return e.atlas.texture},charStep:function(t,e){return e.atlas.step},em:function(t,e){return e.atlas.em},color:e.prop("color"),opacity:e.prop("opacity"),viewport:e.this("viewportArray"),scale:e.this("scale"),align:e.prop("align"),baseline:e.prop("baseline"),translate:e.this("translate"),positionOffset:e.prop("positionOffset")},primitive:"points",viewport:e.this("viewport"),vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute float width, charOffset, char;\n\t\t\tattribute vec2 position;\n\t\t\tuniform float fontSize, charStep, em, align, baseline;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform vec4 color;\n\t\t\tuniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvoid main () {\n\t\t\t\t"+(!w.normalViewport?"vec2 positionOffset = vec2(positionOffset.x,- positionOffset.y);":"")+"\n\n\t\t\t\tvec2 offset = floor(em * (vec2(align + charOffset, baseline)\n\t\t\t\t\t+ positionOffset))\n\t\t\t\t\t/ (viewport.zw * scale.xy);\n\n\t\t\t\tvec2 position = (position + translate) * scale;\n\t\t\t\tposition += offset * scale;\n\n\t\t\t\t"+(w.normalViewport?"position.y = 1. - position.y;":"")+"\n\n\t\t\t\tcharCoord = position * viewport.zw + viewport.xy;\n\n\t\t\t\tgl_Position = vec4(position * 2. - 1., 0, 1);\n\n\t\t\t\tgl_PointSize = charStep;\n\n\t\t\t\tcharId.x = mod(char, atlasDim.x);\n\t\t\t\tcharId.y = floor(char / atlasDim.x);\n\n\t\t\t\tcharWidth = width * em;\n\n\t\t\t\tfontColor = color / 255.;\n\t\t\t}",frag:"\n\t\t\tprecision highp float;\n\t\t\tuniform sampler2D atlas;\n\t\t\tuniform float fontSize, charStep, opacity;\n\t\t\tuniform vec2 atlasSize;\n\t\t\tuniform vec4 viewport;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\n\t\t\tfloat lightness(vec4 color) {\n\t\t\t\treturn color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n\t\t\t}\n\n\t\t\tvoid main () {\n\t\t\t\tvec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n\t\t\t\tfloat halfCharStep = floor(charStep * .5 + .5);\n\n\t\t\t\t// invert y and shift by 1px (FF expecially needs that)\n\t\t\t\tuv.y = charStep - uv.y;\n\n\t\t\t\t// ignore points outside of character bounding box\n\t\t\t\tfloat halfCharWidth = ceil(charWidth * .5);\n\t\t\t\tif (floor(uv.x) > halfCharStep + halfCharWidth ||\n\t\t\t\t\tfloor(uv.x) < halfCharStep - halfCharWidth) return;\n\n\t\t\t\tuv += charId * charStep;\n\t\t\t\tuv = uv / atlasSize;\n\n\t\t\t\tvec4 color = fontColor;\n\t\t\t\tvec4 mask = texture2D(atlas, uv);\n\n\t\t\t\tfloat maskY = lightness(mask);\n\t\t\t\t// float colorY = lightness(color);\n\t\t\t\tcolor.a *= maskY;\n\t\t\t\tcolor.a *= opacity;\n\n\t\t\t\t// color.a += .1;\n\n\t\t\t\t// antialiasing, see yiq color space y-channel formula\n\t\t\t\t// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n\t\t\t\tgl_FragColor = color;\n\t\t\t}"});var n={};return{regl:e,draw:r,atlas:n}};w.prototype.update=function t(e){var r=this;if(typeof e==="string"){e={text:e}}else if(!e){return}e=a(e,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},true);if(e.opacity!=null){if(Array.isArray(e.opacity)){this.opacity=e.opacity.map(function(t){return parseFloat(t)})}else{this.opacity=parseFloat(e.opacity)}}if(e.viewport!=null){this.viewport=f(e.viewport);if(w.normalViewport){this.viewport.y=this.canvas.height-this.viewport.y-this.viewport.height}this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]}if(this.viewport==null){this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight};this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]}if(e.kerning!=null){this.kerning=e.kerning}if(e.offset!=null){if(typeof e.offset==="number"){e.offset=[e.offset,0]}this.positionOffset=y(e.offset)}if(e.direction){this.direction=e.direction}if(e.range){this.range=e.range;this.scale=[1/(e.range[2]-e.range[0]),1/(e.range[3]-e.range[1])];this.translate=[-e.range[0],-e.range[1]]}if(e.scale){this.scale=e.scale}if(e.translate){this.translate=e.translate}if(!this.scale){this.scale=[1/this.viewport.width,1/this.viewport.height]}if(!this.translate){this.translate=[0,0]}if(!this.font.length&&!e.font){e.font=w.baseFontSize+"px sans-serif"}var i=false,o=false;if(e.font){(Array.isArray(e.font)?e.font:[e.font]).forEach(function(t,e){if(typeof t==="string"){try{t=n.parse(t)}catch(e){t=n.parse(w.baseFontSize+"px "+t)}}else{t=n.parse(n.stringify(t))}var a=n.stringify({size:w.baseFontSize,family:t.family,stretch:b?t.stretch:undefined,variant:t.variant,weight:t.weight,style:t.style});var s=p(t.size);var l=Math.round(s[0]*d(s[1]));if(l!==r.fontSize[e]){o=true;r.fontSize[e]=l}if(!r.font[e]||a!=r.font[e].baseString){i=true;r.font[e]=w.fonts[a];if(!r.font[e]){var u=t.family.join(", ");var c=[t.style];if(t.style!=t.variant){c.push(t.variant)}if(t.variant!=t.weight){c.push(t.weight)}if(b&&t.weight!=t.stretch){c.push(t.stretch)}r.font[e]={baseString:a,family:u,weight:t.weight,stretch:t.stretch,style:t.style,variant:t.variant,width:{},kerning:{},metrics:m(u,{origin:"top",fontSize:w.baseFontSize,fontStyle:c.join(" ")})};w.fonts[a]=r.font[e]}}})}if(i||o){this.font.forEach(function(t,a){var i=n.stringify({size:r.fontSize[a],family:t.family,stretch:b?t.stretch:undefined,variant:t.variant,weight:t.weight,style:t.style});r.fontAtlas[a]=r.shader.atlas[i];if(!r.fontAtlas[a]){var o=t.metrics;r.shader.atlas[i]=r.fontAtlas[a]={fontString:i,step:Math.ceil(r.fontSize[a]*o.bottom*.5)*2,em:r.fontSize[a],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:r.regl.texture()}}if(e.text==null){e.text=r.text}})}if(typeof e.text==="string"&&e.position&&e.position.length>2){var s=Array(e.position.length*.5);for(var h=0;h<s.length;h++){s[h]=e.text}e.text=s}var x;if(e.text!=null||i){this.textOffsets=[0];if(Array.isArray(e.text)){this.count=e.text[0].length;this.counts=[this.count];for(var _=1;_<e.text.length;_++){r.textOffsets[_]=r.textOffsets[_-1]+e.text[_-1].length;r.count+=e.text[_].length;r.counts.push(e.text[_].length)}this.text=e.text.join("")}else{this.text=e.text;this.count=this.text.length;this.counts=[this.count]}x=[];this.font.forEach(function(t,e){w.atlasContext.font=t.baseString;var n=r.fontAtlas[e];for(var a=0;a<r.text.length;a++){var i=r.text.charAt(a);if(n.ids[i]==null){n.ids[i]=n.chars.length;n.chars.push(i);x.push(i)}if(t.width[i]==null){t.width[i]=w.atlasContext.measureText(i).width/w.baseFontSize;if(r.kerning){var o=[];for(var s in t.width){o.push(s+i,i+s)}g(t.kerning,v(t.family,{pairs:o}))}}}})}if(e.position){if(e.position.length>2){var k=!e.position[0].length;var M=c.mallocFloat(this.count*2);for(var A=0,T=0;A<this.counts.length;A++){var S=r.counts[A];if(k){for(var E=0;E<S;E++){M[T++]=e.position[A*2];M[T++]=e.position[A*2+1]}}else{for(var C=0;C<S;C++){M[T++]=e.position[A][0];M[T++]=e.position[A][1]}}}if(this.position.call){this.position({type:"float",data:M})}else{this.position=this.regl.buffer({type:"float",data:M})}c.freeFloat(M)}else{if(this.position.destroy){this.position.destroy()}this.position={constant:e.position}}}if(e.text||i){var L=c.mallocUint8(this.count);var I=c.mallocFloat(this.count*2);this.textWidth=[];for(var z=0,P=0;z<this.counts.length;z++){var O=r.counts[z];var D=r.font[z]||r.font[0];var R=r.fontAtlas[z]||r.fontAtlas[0];for(var B=0;B<O;B++){var F=r.text.charAt(P);var N=r.text.charAt(P-1);L[P]=R.ids[F];I[P*2]=D.width[F];if(B){var j=I[P*2-2];var V=I[P*2];var U=I[P*2-1];var q=U+j*.5+V*.5;if(r.kerning){var H=D.kerning[N+F];if(H){q+=H*.001}}I[P*2+1]=q}else{I[P*2+1]=I[P*2]*.5}P++}r.textWidth.push(!I.length?0:I[P*2-2]*.5+I[P*2-1])}if(!e.align){e.align=this.align}this.charBuffer({data:L,type:"uint8",usage:"stream"});this.sizeBuffer({data:I,type:"float",usage:"stream"});c.freeUint8(L);c.freeFloat(I);if(x.length){this.font.forEach(function(t,e){var n=r.fontAtlas[e];var a=n.step;var i=Math.floor(w.maxAtlasSize/a);var o=Math.min(i,n.chars.length);var s=Math.ceil(n.chars.length/o);var l=o*a;var c=s*a;n.width=l;n.height=c;n.rows=s;n.cols=o;if(!n.em){return}n.texture({data:u({canvas:w.atlasCanvas,font:n.fontString,chars:n.chars,shape:[l,c],step:[a,a]})})})}}if(e.align){this.align=e.align;this.alignOffset=this.textWidth.map(function(t,e){var n=!Array.isArray(r.align)?r.align:r.align.length>1?r.align[e]:r.align[0];if(typeof n==="number"){return n}switch(n){case"right":case"end":return-t;case"center":case"centre":case"middle":return-t*.5}return 0})}if(this.baseline==null&&e.baseline==null){e.baseline=0}if(e.baseline!=null){this.baseline=e.baseline;if(!Array.isArray(this.baseline)){this.baseline=[this.baseline]}this.baselineOffset=this.baseline.map(function(t,e){var n=(r.font[e]||r.font[0]).metrics;var a=0;a+=n.bottom*.5;if(typeof t==="number"){a+=t-n.baseline}else{a+=-n[t]}if(!w.normalViewport){a*=-1}return a})}if(e.color!=null){if(!e.color){e.color="transparent"}if(typeof e.color==="string"||!isNaN(e.color)){this.color=l(e.color,"uint8")}else{var G;if(typeof e.color[0]==="number"&&e.color.length>this.counts.length){var W=e.color.length;G=c.mallocUint8(W);var Y=(e.color.subarray||e.color.slice).bind(e.color);for(var X=0;X<W;X+=4){G.set(l(Y(X,X+4),"uint8"),X)}}else{var Z=e.color.length;G=c.mallocUint8(Z*4);for(var $=0;$<Z;$++){G.set(l(e.color[$]||0,"uint8"),$*4)}}this.color=G}}if(e.position||e.text||e.color||e.baseline||e.align||e.font||e.offset||e.opacity){var J=this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2;if(J){var K=Math.max(this.position.length*.5||0,this.color.length*.25||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,this.positionOffset.length*.5||0);this.batch=Array(K);for(var Q=0;Q<this.batch.length;Q++){r.batch[Q]={count:r.counts.length>1?r.counts[Q]:r.counts[0],offset:r.textOffsets.length>1?r.textOffsets[Q]:r.textOffsets[0],color:!r.color?[0,0,0,255]:r.color.length<=4?r.color:r.color.subarray(Q*4,Q*4+4),opacity:Array.isArray(r.opacity)?r.opacity[Q]:r.opacity,baseline:r.baselineOffset[Q]!=null?r.baselineOffset[Q]:r.baselineOffset[0],align:!r.align?0:r.alignOffset[Q]!=null?r.alignOffset[Q]:r.alignOffset[0],atlas:r.fontAtlas[Q]||r.fontAtlas[0],positionOffset:r.positionOffset.length>2?r.positionOffset.subarray(Q*2,Q*2+2):r.positionOffset}}}else{if(this.count){this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]}else{this.batch=[]}}}};w.prototype.destroy=function t(){};w.prototype.kerning=true;w.prototype.position={constant:new Float32Array(2)};w.prototype.translate=null;w.prototype.scale=null;w.prototype.font=null;w.prototype.text="";w.prototype.positionOffset=[0,0];w.prototype.opacity=1;w.prototype.color=new Uint8Array([0,0,0,255]);w.prototype.alignOffset=[0,0];w.normalViewport=false;w.maxAtlasSize=1024;w.atlasCanvas=document.createElement("canvas");w.atlasContext=w.atlasCanvas.getContext("2d",{alpha:false});w.baseFontSize=64;w.fonts={};function k(t){return typeof t==="function"&&t._gl&&t.prop&&t.texture&&t.buffer}e.exports=w},{"color-normalize":45,"css-font":126,"detect-kerning":150,"es6-weak-map":208,"flatten-vertex-data":48,"font-atlas":217,"font-measure":218,"gl-util/context":304,"is-plain-obj":390,"object-assign":421,"parse-rect":426,"parse-unit":428,"pick-by-alias":432,regl:463,"to-px":501,"typedarray-pool":507}],45:[function(t,e,r){"use strict";var n=t("color-rgba");var a=t("clamp");var i=t("dtype");e.exports=function t(e,r){if(r==="float"||!r)r="array";if(r==="uint")r="uint8";if(r==="uint_clamped")r="uint8_clamped";var o=i(r);var s=new o(4);if(e instanceof o){if(Array.isArray(e)){return e.slice()}s.set(e);return s}var t=r!=="uint8"&&r!=="uint8_clamped";if(e instanceof Uint8Array||e instanceof Uint8ClampedArray){s[0]=e[0];s[1]=e[1];s[2]=e[2];s[3]=e[3]!=null?e[3]:255;if(t){s[0]/=255;s[1]/=255;s[2]/=255;s[3]/=255}return s}if(!e.length||typeof e==="string"){e=n(e);e[0]/=255;e[1]/=255;e[2]/=255}if(!t){s[0]=a(Math.round(e[0]*255),0,255);s[1]=a(Math.round(e[1]*255),0,255);s[2]=a(Math.round(e[2]*255),0,255);s[3]=e[3]==null?255:a(Math.floor(e[3]*255),0,255)}else{s[0]=e[0];s[1]=e[1];s[2]=e[2];s[3]=e[3]!=null?e[3]:1}return s}},{clamp:102,"color-rgba":47,dtype:153}],46:[function(t,e,r){(function(r){"use strict";var n=t("color-name");var a=t("is-plain-obj");var i=t("defined");e.exports=s;var o={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function s(t){var e,s=[],l=1,u;if(typeof t==="string"){if(n[t]){s=n[t].slice();u="rgb"}else if(t==="transparent"){l=0;u="rgb";s=[0,0,0]}else if(/^#[A-Fa-f0-9]+$/.test(t)){var c=t.slice(1);var f=c.length;var h=f<=4;l=1;if(h){s=[parseInt(c[0]+c[0],16),parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16)];if(f===4){l=parseInt(c[3]+c[3],16)/255}}else{s=[parseInt(c[0]+c[1],16),parseInt(c[2]+c[3],16),parseInt(c[4]+c[5],16)];if(f===8){l=parseInt(c[6]+c[7],16)/255}}if(!s[0])s[0]=0;if(!s[1])s[1]=0;if(!s[2])s[2]=0;u="rgb"}else if(e=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(t)){var p=e[1];var c=p.replace(/a$/,"");u=c;var f=c==="cmyk"?4:c==="gray"?1:3;s=e[2].trim().split(/\s*,\s*/).map(function(t,e){if(/%$/.test(t)){if(e===f)return parseFloat(t)/100;if(c==="rgb")return parseFloat(t)*255/100;return parseFloat(t)}else if(c[e]==="h"){if(/deg$/.test(t)){return parseFloat(t)}else if(o[t]!==undefined){return o[t]}}return parseFloat(t)});if(p===c)s.push(1);l=s[f]===undefined?1:s[f];s=s.slice(0,f)}else if(t.length>10&&/[0-9](?:\s|\/)/.test(t)){s=t.match(/([0-9]+)/g).map(function(t){return parseFloat(t)});u=t.match(/([a-z])/ig).join("").toLowerCase()}}else if(!isNaN(t)){u="rgb";s=[t>>>16,(t&65280)>>>8,t&255]}else if(a(t)){var d=i(t.r,t.red,t.R,null);if(d!==null){u="rgb";s=[d,i(t.g,t.green,t.G),i(t.b,t.blue,t.B)]}else{u="hsl";s=[i(t.h,t.hue,t.H),i(t.s,t.saturation,t.S),i(t.l,t.lightness,t.L,t.b,t.brightness)]}l=i(t.a,t.alpha,t.opacity,1);if(t.opacity!=null)l/=100}else if(Array.isArray(t)||r.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(t)){s=[t[0],t[1],t[2]];u="rgb";l=t.length===4?t[3]:1}return{space:u,values:s,alpha:l}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"color-name":106,defined:148,"is-plain-obj":390}],47:[function(t,e,r){"use strict";var n=t("color-parse");var a=t("color-space/hsl");var i=t("clamp");e.exports=function t(e){var r,o,s;var l=n(e);if(!l.space)return[];r=Array(3);r[0]=i(l.values[0],0,255);r[1]=i(l.values[1],0,255);r[2]=i(l.values[2],0,255);if(l.space[0]==="h"){r=a.rgb(r)}r.push(i(l.alpha,0,1));return r}},{clamp:102,"color-parse":46,"color-space/hsl":110}],48:[function(t,e,r){var n=t("dtype");e.exports=a;function a(t,e,r){if(!t)throw new TypeError("must specify data as first parameter");r=+(r||0)|0;if(Array.isArray(t)&&(t[0]&&typeof t[0][0]==="number")){var a=t[0].length;var i=t.length*a;var o,s,l,u;if(!e||typeof e==="string"){e=new(n(e||"float32"))(i+r)}var c=e.length-r;if(i!==c){throw new Error("source length "+i+" ("+a+"x"+t.length+")"+" does not match destination length "+c)}for(o=0,l=r;o<t.length;o++){for(s=0;s<a;s++){e[l++]=t[o][s]===null?NaN:t[o][s]}}}else{if(!e||typeof e==="string"){var f=n(e||"float32");if(Array.isArray(t)||e==="array"){e=new f(t.length+r);for(o=0,l=r,u=e.length;l<u;l++,o++){e[l]=t[o]===null?NaN:t[o]}}else{if(r===0){e=new f(t)}else{e=new f(t.length+r);e.set(t,r)}}}else{e.set(t,r)}}return e}},{dtype:153}],49:[function(e,r,n){(function(a,i){typeof n==="object"&&typeof r!=="undefined"?i(n,e("d3-array"),e("d3-collection"),e("d3-interpolate")):typeof t==="function"&&t.amd?t(["exports","d3-array","d3-collection","d3-interpolate"],i):i(a.d3=a.d3||{},a.d3,a.d3,a.d3)})(this,function(t,e,r,n){"use strict";var a=function(){var t={},a=24,i=8,o=[1,1],s=[],l=[];t.nodeWidth=function(e){if(!arguments.length)return a;a=+e;return t};t.nodePadding=function(e){if(!arguments.length)return i;i=+e;return t};t.nodes=function(e){if(!arguments.length)return s;s=e;return t};t.links=function(e){if(!arguments.length)return l;l=e;return t};t.size=function(e){if(!arguments.length)return o;o=e;return t};t.layout=function(e){u();c();f();d(e);v();return t};t.relayout=function(){v();return t};t.link=function(){var t=.5;function e(e){var r=e.source.x+e.source.dx,a=e.target.x,i=n.interpolateNumber(r,a),o=i(t),s=i(1-t),l=e.source.y+e.sy,u=l+e.dy,c=e.target.y+e.ty,f=c+e.dy;return"M"+r+","+l+"C"+o+","+l+" "+s+","+c+" "+a+","+c+"L"+a+","+f+"C"+s+","+f+" "+o+","+u+" "+r+","+u+"Z"}e.curvature=function(r){if(!arguments.length)return t;t=+r;return e};return e};function u(){s.forEach(function(t){t.sourceLinks=[];t.targetLinks=[]});l.forEach(function(t,e){var r=t.source,n=t.target;if(typeof r==="number")r=t.source=s[t.source];if(typeof n==="number")n=t.target=s[t.target];t.originalIndex=e;r.sourceLinks.push(t);n.targetLinks.push(t)})}function c(){s.forEach(function(t){t.value=Math.max(e.sum(t.sourceLinks,m),e.sum(t.targetLinks,m))})}function f(){var t=s,e,r=0;while(t.length){e=[];t.forEach(function(t){t.x=r;t.dx=a;t.sourceLinks.forEach(function(t){if(e.indexOf(t.target)<0){e.push(t.target)}})});t=e;++r}h(r);p((o[0]-a)/(r-1))}function h(t){s.forEach(function(e){if(!e.sourceLinks.length){e.x=t-1}})}function p(t){s.forEach(function(e){e.x*=t})}function d(t){var n=r.nest().key(function(t){return t.x}).sortKeys(e.ascending).entries(s).map(function(t){return t.values});u();h();for(var a=1;t>0;--t){f(a*=.99);h();c(a);h()}function u(){var t=e.min(n,function(t){return(o[1]-(t.length-1)*i)/e.sum(t,m)});n.forEach(function(e){e.forEach(function(e,r){e.y=r;e.dy=e.value*t})});l.forEach(function(e){e.dy=e.value*t})}function c(t){n.forEach(function(n){n.forEach(function(n){if(n.targetLinks.length){var a=e.sum(n.targetLinks,r)/e.sum(n.targetLinks,m);n.y+=(a-g(n))*t}})});function r(t){return g(t.source)*t.value}}function f(t){n.slice().reverse().forEach(function(n){n.forEach(function(n){if(n.sourceLinks.length){var a=e.sum(n.sourceLinks,r)/e.sum(n.sourceLinks,m);n.y+=(a-g(n))*t}})});function r(t){return g(t.target)*t.value}}function h(){n.forEach(function(t){var e,r,n=0,a=t.length,s;t.sort(p);for(s=0;s<a;++s){e=t[s];r=n-e.y;if(r>0)e.y+=r;n=e.y+e.dy+i}r=n-i-o[1];if(r>0){n=e.y-=r;for(s=a-2;s>=0;--s){e=t[s];r=e.y+e.dy+i-n;if(r>0)e.y-=r;n=e.y}}})}function p(t,e){return t.y-e.y}}function v(){s.forEach(function(r){r.sourceLinks.sort(e);r.targetLinks.sort(t)});s.forEach(function(t){var e=0,r=0;t.sourceLinks.forEach(function(t){t.sy=e;e+=t.dy});t.targetLinks.forEach(function(t){t.ty=r;r+=t.dy})});function t(t,e){return t.source.y-e.source.y||t.originalIndex-e.originalIndex}function e(t,e){return t.target.y-e.target.y||t.originalIndex-e.originalIndex}}function g(t){return t.y+t.dy/2}function m(t){return t.value}return t};t.sankey=a;Object.defineProperty(t,"__esModule",{value:true})})},{"d3-array":139,"d3-collection":140,"d3-interpolate":144}],50:[function(t,e,r){"use strict";var n=typeof WeakMap==="undefined"?t("weak-map"):WeakMap;var a=t("gl-buffer");var i=t("gl-vao");var o=new n;function s(t){var e=o.get(t);var r=e&&(e._triangleBuffer.handle||e._triangleBuffer.buffer);if(!r||!t.isBuffer(r)){var n=a(t,new Float32Array([-1,-1,-1,4,4,-1]));e=i(t,[{buffer:n,type:t.FLOAT,size:2}]);e._triangleBuffer=n;o.set(t,e)}e.bind();t.drawArrays(t.TRIANGLES,0,3);e.unbind()}e.exports=s},{"gl-buffer":230,"gl-vao":308,"weak-map":517}],51:[function(t,e,r){e.exports=n;function n(t){var e=0;var r=0;var n=0;var a=0;return t.map(function(t){t=t.slice();var i=t[0];var o=i.toUpperCase();if(i!=o){t[0]=o;switch(i){case"a":t[6]+=n;t[7]+=a;break;case"v":t[1]+=a;break;case"h":t[1]+=n;break;default:for(var s=1;s<t.length;){t[s++]+=n;t[s++]+=a}}}switch(o){case"Z":n=e;a=r;break;case"H":n=t[1];break;case"V":a=t[1];break;case"M":n=e=t[1];a=r=t[2];break;default:n=t[t.length-2];a=t[t.length-1]}return t})}},{}],52:[function(t,e,r){var n=t("pad-left");e.exports=a;function a(t,e,r){e=typeof e==="number"?e:1;r=r||": ";var a=t.split(/\r?\n/);var i=String(a.length+e-1).length;return a.map(function(t,a){var o=a+e;var s=String(o).length;var l=n(o,i-s);return l+r+t}).join("\n")}},{"pad-left":424}],53:[function(t,e,r){"use strict";e.exports=i;var n=t("robust-orientation");function a(t,e){var r=new Array(e+1);for(var a=0;a<t.length;++a){r[a]=t[a]}for(var a=0;a<=t.length;++a){for(var i=t.length;i<=e;++i){var o=new Array(e);for(var s=0;s<e;++s){o[s]=Math.pow(i+1-a,s)}r[i]=o}var l=n.apply(void 0,r);if(l){return true}}return false}function i(t){var e=t.length;if(e===0){return[]}if(e===1){return[0]}var r=t[0].length;var n=[t[0]];var i=[0];for(var o=1;o<e;++o){n.push(t[o]);if(!a(n,r)){n.pop();continue}i.push(o);if(i.length===r+1){return i}}return i}},{"robust-orientation":471}],54:[function(t,e,r){"use strict";e.exports=i;var n=t("delaunay-triangulate");var a=t("circumradius");function i(t,e){return n(e).filter(function(r){var n=new Array(r.length);for(var i=0;i<r.length;++i){n[i]=e[r[i]]}return a(n)*t<1})}},{circumradius:101,"delaunay-triangulate":149}],55:[function(t,e,r){e.exports=i;var n=t("alpha-complex");var a=t("simplicial-complex-boundary");function i(t,e){return a(n(t,e))}},{"alpha-complex":54,"simplicial-complex-boundary":478}],56:[function(t,e,r){"use strict";e.exports=n;function n(t,e){if(!t||t.length==null)throw Error("Argument should be an array");if(e==null)e=1;else e=Math.floor(e);var r=Array(e*2);for(var n=0;n<e;n++){var a=-Infinity,i=Infinity,o=n,s=t.length;for(;o<s;o+=e){if(t[o]>a)a=t[o];if(t[o]<i)i=t[o]}r[n]=i;r[e+n]=a}return r}},{}],57:[function(t,e,r){"use strict";var n=t("array-bounds");e.exports=a;function a(t,e,r){if(!t||t.length==null)throw Error("Argument should be an array");if(e==null)e=1;if(r==null)r=n(t,e);for(var a=0;a<e;a++){var i=r[e+a],o=r[a],s=a,l=t.length;if(i===Infinity&&o===-Infinity){for(s=a;s<l;s+=e){t[s]=t[s]===i?1:t[s]===o?0:.5}}else if(i===Infinity){for(s=a;s<l;s+=e){t[s]=t[s]===i?1:0}}else if(o===-Infinity){for(s=a;s<l;s+=e){t[s]=t[s]===o?0:1}}else{var u=i-o;for(s=a;s<l;s+=e){t[s]=u===0?.5:(t[s]-o)/u}}}return t}},{"array-bounds":56}],58:[function(t,e,r){e.exports=function t(e,r){var n=typeof e==="number",a=typeof r==="number";if(n&&!a){r=e;e=0}else if(!n&&!a){e=0;r=0}e=e|0;r=r|0;var i=r-e;if(i<0)throw new Error("array length must be positive");var o=new Array(i);for(var s=0,l=e;s<i;s++,l++)o[s]=l;return o}},{}],59:[function(t,e,r){(function(r){"use strict";function n(t,e){if(t===e){return 0}var r=t.length;var n=e.length;for(var a=0,i=Math.min(r,n);a<i;++a){if(t[a]!==e[a]){r=t[a];n=e[a];break}}if(r<n){return-1}if(n<r){return 1}return 0}function a(t){if(r.Buffer&&typeof r.Buffer.isBuffer==="function"){return r.Buffer.isBuffer(t)}return!!(t!=null&&t._isBuffer)}var i=t("util/");var o=Object.prototype.hasOwnProperty;var s=Array.prototype.slice;var l=function(){return function t(){}.name==="foo"}();function u(t){return Object.prototype.toString.call(t)}function c(t){if(a(t)){return false}if(typeof r.ArrayBuffer!=="function"){return false}if(typeof ArrayBuffer.isView==="function"){return ArrayBuffer.isView(t)}if(!t){return false}if(t instanceof DataView){return true}if(t.buffer&&t.buffer instanceof ArrayBuffer){return true}return false}var f=e.exports=y;var h=/\s*function\s+([^\(\s]*)\s*/;function p(t){if(!i.isFunction(t)){return}if(l){return t.name}var e=t.toString();var r=e.match(h);return r&&r[1]}f.AssertionError=function t(e){this.name="AssertionError";this.actual=e.actual;this.expected=e.expected;this.operator=e.operator;if(e.message){this.message=e.message;this.generatedMessage=false}else{this.message=g(this);this.generatedMessage=true}var r=e.stackStartFunction||m;if(Error.captureStackTrace){Error.captureStackTrace(this,r)}else{var n=new Error;if(n.stack){var a=n.stack;var i=p(r);var o=a.indexOf("\n"+i);if(o>=0){var s=a.indexOf("\n",o+1);a=a.substring(s+1)}this.stack=a}}};i.inherits(f.AssertionError,Error);function d(t,e){if(typeof t==="string"){return t.length<e?t:t.slice(0,e)}else{return t}}function v(t){if(l||!i.isFunction(t)){return i.inspect(t)}var e=p(t);var r=e?": "+e:"";return"[Function"+r+"]"}function g(t){return d(v(t.actual),128)+" "+t.operator+" "+d(v(t.expected),128)}function m(t,e,r,n,a){throw new f.AssertionError({message:r,actual:t,expected:e,operator:n,stackStartFunction:a})}f.fail=m;function y(t,e){if(!t)m(t,true,e,"==",f.ok)}f.ok=y;f.equal=function t(e,r,n){if(e!=r)m(e,r,n,"==",f.equal)};f.notEqual=function t(e,r,n){if(e==r){m(e,r,n,"!=",f.notEqual)}};f.deepEqual=function t(e,r,n){if(!x(e,r,false)){m(e,r,n,"deepEqual",f.deepEqual)}};f.deepStrictEqual=function t(e,r,n){if(!x(e,r,true)){m(e,r,n,"deepStrictEqual",f.deepStrictEqual)}};function x(t,e,r,o){if(t===e){return true}else if(a(t)&&a(e)){return n(t,e)===0}else if(i.isDate(t)&&i.isDate(e)){return t.getTime()===e.getTime()}else if(i.isRegExp(t)&&i.isRegExp(e)){return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase}else if((t===null||typeof t!=="object")&&(e===null||typeof e!=="object")){return r?t===e:t==e}else if(c(t)&&c(e)&&u(t)===u(e)&&!(t instanceof Float32Array||t instanceof Float64Array)){return n(new Uint8Array(t.buffer),new Uint8Array(e.buffer))===0}else if(a(t)!==a(e)){return false}else{o=o||{actual:[],expected:[]};var s=o.actual.indexOf(t);if(s!==-1){if(s===o.expected.indexOf(e)){return true}}o.actual.push(t);o.expected.push(e);return _(t,e,r,o)}}function b(t){return Object.prototype.toString.call(t)=="[object Arguments]"}function _(t,e,r,n){if(t===null||t===undefined||e===null||e===undefined)return false;if(i.isPrimitive(t)||i.isPrimitive(e))return t===e;if(r&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return false;var a=b(t);var o=b(e);if(a&&!o||!a&&o)return false;if(a){t=s.call(t);e=s.call(e);return x(t,e,r)}var l=T(t);var u=T(e);var c,f;if(l.length!==u.length)return false;l.sort();u.sort();for(f=l.length-1;f>=0;f--){if(l[f]!==u[f])return false}for(f=l.length-1;f>=0;f--){c=l[f];if(!x(t[c],e[c],r,n))return false}return true}f.notDeepEqual=function t(e,r,n){if(x(e,r,false)){m(e,r,n,"notDeepEqual",f.notDeepEqual)}};f.notDeepStrictEqual=w;function w(t,e,r){if(x(t,e,true)){m(t,e,r,"notDeepStrictEqual",w)}}f.strictEqual=function t(e,r,n){if(e!==r){m(e,r,n,"===",f.strictEqual)}};f.notStrictEqual=function t(e,r,n){if(e===r){m(e,r,n,"!==",f.notStrictEqual)}};function k(t,e){if(!t||!e){return false}if(Object.prototype.toString.call(e)=="[object RegExp]"){return e.test(t)}try{if(t instanceof e){return true}}catch(t){}if(Error.isPrototypeOf(e)){return false}return e.call({},t)===true}function M(t){var e;try{t()}catch(t){e=t}return e}function A(t,e,r,n){var a;if(typeof e!=="function"){throw new TypeError('"block" argument must be a function')}if(typeof r==="string"){n=r;r=null}a=M(e);n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:".");if(t&&!a){m(a,r,"Missing expected exception"+n)}var o=typeof n==="string";var s=!t&&i.isError(a);var l=!t&&a&&!r;if(s&&o&&k(a,r)||l){m(a,r,"Got unwanted exception"+n)}if(t&&a&&r&&!k(a,r)||!t&&a){throw a}}f.throws=function(t,e,r){A(true,t,e,r)};f.doesNotThrow=function(t,e,r){A(false,t,e,r)};f.ifError=function(t){if(t)throw t};var T=Object.keys||function(t){var e=[];for(var r in t){if(o.call(t,r))e.push(r)}return e}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"util/":514}],60:[function(t,e,r){e.exports=function t(e){return atob(e)}},{}],61:[function(t,e,r){"use strict";e.exports=i;var n=t("robust-linear-solve");function a(t){var e=0;for(var r=0;r<t.length;++r){e+=t[r]}return e}function i(t,e){var r=e.length;var i=new Array(r+1);for(var o=0;o<r;++o){var s=new Array(r+1);for(var l=0;l<=r;++l){s[l]=t[l][o]}i[o]=s}i[r]=new Array(r+1);for(var o=0;o<=r;++o){i[r][o]=1}var u=new Array(r+1);for(var o=0;o<r;++o){u[o]=e[o]}u[r]=1;var c=n(i,u);var f=a(c[r+1]);if(f===0){f=1}var h=new Array(r+1);for(var o=0;o<=r;++o){h[o]=a(c[o])/f}return h}},{"robust-linear-solve":470}],62:[function(t,e,r){"use strict";r.byteLength=c;r.toByteArray=f;r.fromByteArray=d;var n=[];var a=[];var i=typeof Uint8Array!=="undefined"?Uint8Array:Array;var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var s=0,l=o.length;s<l;++s){n[s]=o[s];a[o.charCodeAt(s)]=s}a["-".charCodeAt(0)]=62;a["_".charCodeAt(0)]=63;function u(t){var e=t.length;if(e%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}return t[e-2]==="="?2:t[e-1]==="="?1:0}function c(t){return t.length*3/4-u(t)}function f(t){var e,r,n,o,s;var l=t.length;o=u(t);s=new i(l*3/4-o);r=o>0?l-4:l;var c=0;for(e=0;e<r;e+=4){n=a[t.charCodeAt(e)]<<18|a[t.charCodeAt(e+1)]<<12|a[t.charCodeAt(e+2)]<<6|a[t.charCodeAt(e+3)];s[c++]=n>>16&255;s[c++]=n>>8&255;s[c++]=n&255}if(o===2){n=a[t.charCodeAt(e)]<<2|a[t.charCodeAt(e+1)]>>4;s[c++]=n&255}else if(o===1){n=a[t.charCodeAt(e)]<<10|a[t.charCodeAt(e+1)]<<4|a[t.charCodeAt(e+2)]>>2;s[c++]=n>>8&255;s[c++]=n&255}return s}function h(t){return n[t>>18&63]+n[t>>12&63]+n[t>>6&63]+n[t&63]}function p(t,e,r){var n;var a=[];for(var i=e;i<r;i+=3){n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255);a.push(h(n))}return a.join("")}function d(t){var e;var r=t.length;var a=r%3;var i="";var o=[];var s=16383;for(var l=0,u=r-a;l<u;l+=s){o.push(p(t,l,l+s>u?u:l+s))}if(a===1){e=t[r-1];i+=n[e>>2];i+=n[e<<4&63];i+="=="}else if(a===2){e=(t[r-2]<<8)+t[r-1];i+=n[e>>10];i+=n[e>>4&63];i+=n[e<<2&63];i+="="}o.push(i);return o.join("")}},{}],63:[function(t,e,r){"use strict";var n=t("./lib/rationalize");e.exports=a;function a(t,e){return n(t[0].mul(e[1]).add(e[0].mul(t[1])),t[1].mul(e[1]))}},{"./lib/rationalize":73}],64:[function(t,e,r){"use strict";e.exports=n;function n(t,e){return t[0].mul(e[1]).cmp(e[0].mul(t[1]))}},{}],65:[function(t,e,r){"use strict";var n=t("./lib/rationalize");e.exports=a;function a(t,e){return n(t[0].mul(e[1]),t[1].mul(e[0]))}},{"./lib/rationalize":73}],66:[function(t,e,r){"use strict";var n=t("./is-rat");var a=t("./lib/is-bn");var i=t("./lib/num-to-bn");var o=t("./lib/str-to-bn");var s=t("./lib/rationalize");var l=t("./div");e.exports=u;function u(t,e){if(n(t)){if(e){return l(t,u(e))}return[t[0].clone(),t[1].clone()]}var r=0;var c,f;if(a(t)){c=t.clone()}else if(typeof t==="string"){c=o(t)}else if(t===0){return[i(0),i(1)]}else if(t===Math.floor(t)){c=i(t)}else{while(t!==Math.floor(t)){t=t*Math.pow(2,256);r-=256}c=i(t)}if(n(e)){c.mul(e[1]);f=e[0].clone()}else if(a(e)){f=e.clone()}else if(typeof e==="string"){f=o(e)}else if(!e){f=i(1)}else if(e===Math.floor(e)){f=i(e)}else{while(e!==Math.floor(e)){e=e*Math.pow(2,256);r+=256}f=i(e)}if(r>0){c=c.ushln(r)}else if(r<0){f=f.ushln(-r)}return s(c,f)}},{"./div":65,"./is-rat":67,"./lib/is-bn":71,"./lib/num-to-bn":72,"./lib/rationalize":73,"./lib/str-to-bn":74}],67:[function(t,e,r){"use strict";var n=t("./lib/is-bn");e.exports=a;function a(t){return Array.isArray(t)&&t.length===2&&n(t[0])&&n(t[1])}},{"./lib/is-bn":71}],68:[function(t,e,r){"use strict";var n=t("bn.js");e.exports=a;function a(t){return t.cmp(new n(0))}},{"bn.js":82}],69:[function(t,e,r){"use strict";var n=t("./bn-sign");e.exports=a;function a(t){var e=t.length;var r=t.words;var a=0;if(e===1){a=r[0]}else if(e===2){a=r[0]+r[1]*67108864}else{for(var i=0;i<e;i++){var o=r[i];a+=o*Math.pow(67108864,i)}}return n(t)*a}},{"./bn-sign":68}],70:[function(t,e,r){"use strict";var n=t("double-bits");var a=t("bit-twiddle").countTrailingZeros;e.exports=i;function i(t){var e=a(n.lo(t));if(e<32){return e}var r=a(n.hi(t));if(r>20){return 52}return r+32}},{"bit-twiddle":80,"double-bits":151}],71:[function(t,e,r){"use strict";var n=t("bn.js");e.exports=a;function a(t){return t&&typeof t==="object"&&Boolean(t.words)}},{"bn.js":82}],72:[function(t,e,r){"use strict";var n=t("bn.js");var a=t("double-bits");e.exports=i;function i(t){var e=a.exponent(t);if(e<52){return new n(t)}else{return new n(t*Math.pow(2,52-e)).ushln(e-52)}}},{"bn.js":82,"double-bits":151}],73:[function(t,e,r){"use strict";var n=t("./num-to-bn");var a=t("./bn-sign");e.exports=i;function i(t,e){var r=a(t);var i=a(e);if(r===0){return[n(0),n(1)]}if(i===0){return[n(0),n(0)]}if(i<0){t=t.neg();e=e.neg()}var o=t.gcd(e);if(o.cmpn(1)){return[t.div(o),e.div(o)]}return[t,e]}},{"./bn-sign":68,"./num-to-bn":72}],74:[function(t,e,r){"use strict";var n=t("bn.js");e.exports=a;function a(t){return new n(t)}},{"bn.js":82}],75:[function(t,e,r){"use strict";var n=t("./lib/rationalize");e.exports=a;function a(t,e){return n(t[0].mul(e[0]),t[1].mul(e[1]))}},{"./lib/rationalize":73}],76:[function(t,e,r){"use strict";var n=t("./lib/bn-sign");e.exports=a;function a(t){return n(t[0])*n(t[1])}},{"./lib/bn-sign":68}],77:[function(t,e,r){"use strict";var n=t("./lib/rationalize");e.exports=a;function a(t,e){return n(t[0].mul(e[1]).sub(t[1].mul(e[0])),t[1].mul(e[1]))}},{"./lib/rationalize":73}],78:[function(t,e,r){"use strict";var n=t("./lib/bn-to-num");var a=t("./lib/ctz");e.exports=i;function i(t){var e=t[0];var r=t[1];if(e.cmpn(0)===0){return 0}var i=e.abs().divmod(r.abs());var o=i.div;var s=n(o);var l=i.mod;var u=e.negative!==r.negative?-1:1;if(l.cmpn(0)===0){return u*s}if(s){var c=a(s)+4;var f=n(l.ushln(c).divRound(r));return u*(s+f*Math.pow(2,-c))}else{var h=r.bitLength()-l.bitLength()+53;var f=n(l.ushln(h).divRound(r));if(h<1023){return u*f*Math.pow(2,-h)}f*=Math.pow(2,-1023);return u*f*Math.pow(2,1023-h)}}},{"./lib/bn-to-num":69,"./lib/ctz":70}],79:[function(t,e,r){"use strict";function n(t,e,r,n,a,i){var o=["function ",t,"(a,l,h,",n.join(","),"){",i?"":"var i=",r?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",a?".get(m)":"[m]"];if(i){if(e.indexOf("c")<0){o.push(";if(x===y){return m}else if(x<=y){")}else{o.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){")}}else{o.push(";if(",e,"){i=m;")}if(r){o.push("l=m+1}else{h=m-1}")}else{o.push("h=m-1}else{l=m+1}")}o.push("}");if(i){o.push("return -1};")}else{o.push("return i};")}return o.join("")}function a(t,e,r,a){var i=new Function([n("A","x"+t+"y",e,["y"],false,a),n("B","x"+t+"y",e,["y"],true,a),n("P","c(x,y)"+t+"0",e,["y","c"],false,a),n("Q","c(x,y)"+t+"0",e,["y","c"],true,a),"function dispatchBsearch",r,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",r].join(""));return i()}e.exports={ge:a(">=",false,"GE"),gt:a(">",false,"GT"),lt:a("<",true,"LT"),le:a("<=",true,"LE"),eq:a("-",true,"EQ",true)}},{}],80:[function(t,e,r){"use strict";"use restrict";var n=32;r.INT_BITS=n;r.INT_MAX=2147483647;r.INT_MIN=-1<<n-1;r.sign=function(t){return(t>0)-(t<0)};r.abs=function(t){var e=t>>n-1;return(t^e)-e};r.min=function(t,e){return e^(t^e)&-(t<e)};r.max=function(t,e){return t^(t^e)&-(t<e)};r.isPow2=function(t){return!(t&t-1)&&!!t};r.log2=function(t){var e,r;e=(t>65535)<<4;t>>>=e;r=(t>255)<<3;t>>>=r;e|=r;r=(t>15)<<2;t>>>=r;e|=r;r=(t>3)<<1;t>>>=r;e|=r;return e|t>>1};r.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0};r.popCount=function(t){t=t-(t>>>1&1431655765);t=(t&858993459)+(t>>>2&858993459);return(t+(t>>>4)&252645135)*16843009>>>24};function a(t){var e=32;t&=-t;if(t)e--;if(t&65535)e-=16;if(t&16711935)e-=8;if(t&252645135)e-=4;if(t&858993459)e-=2;if(t&1431655765)e-=1;return e}r.countTrailingZeros=a;r.nextPow2=function(t){t+=t===0;--t;t|=t>>>1;t|=t>>>2;t|=t>>>4;t|=t>>>8;t|=t>>>16;return t+1};r.prevPow2=function(t){t|=t>>>1;t|=t>>>2;t|=t>>>4;t|=t>>>8;t|=t>>>16;return t-(t>>>1)};r.parity=function(t){t^=t>>>16;t^=t>>>8;t^=t>>>4;t&=15;return 27030>>>t&1};var i=new Array(256);(function(t){for(var e=0;e<256;++e){var r=e,n=e,a=7;for(r>>>=1;r;r>>>=1){n<<=1;n|=r&1;--a}t[e]=n<<a&255}})(i);r.reverse=function(t){return i[t&255]<<24|i[t>>>8&255]<<16|i[t>>>16&255]<<8|i[t>>>24&255]};r.interleave2=function(t,e){t&=65535;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;e&=65535;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;return t|e<<1};r.deinterleave2=function(t,e){t=t>>>e&1431655765;t=(t|t>>>1)&858993459;t=(t|t>>>2)&252645135;t=(t|t>>>4)&16711935;t=(t|t>>>16)&65535;return t<<16>>16};r.interleave3=function(t,e,r){t&=1023;t=(t|t<<16)&4278190335;t=(t|t<<8)&251719695;t=(t|t<<4)&3272356035;t=(t|t<<2)&1227133513;e&=1023;e=(e|e<<16)&4278190335;e=(e|e<<8)&251719695;e=(e|e<<4)&3272356035;e=(e|e<<2)&1227133513;t|=e<<1;r&=1023;r=(r|r<<16)&4278190335;r=(r|r<<8)&251719695;r=(r|r<<4)&3272356035;r=(r|r<<2)&1227133513;return t|r<<2};r.deinterleave3=function(t,e){t=t>>>e&1227133513;t=(t|t>>>2)&3272356035;t=(t|t>>>4)&251719695;t=(t|t>>>8)&4278190335;t=(t|t>>>16)&1023;return t<<22>>22};r.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>a(t)+1}},{}],81:[function(t,e,r){"use strict";var n=t("clamp");e.exports=i;var a=1e20;function i(t,e){if(!e)e={};var r=e.cutoff==null?.25:e.cutoff;var i=e.radius==null?8:e.radius;var s=e.channel||0;var l,u,c,f,h,p,d,v,g,m,y;if(ArrayBuffer.isView(t)||Array.isArray(t)){if(!e.width||!e.height)throw Error("For raw data width and height should be provided by options");l=e.width,u=e.height;f=t;if(!e.stride)p=Math.floor(t.length/l/u);else p=e.stride}else{if(window.HTMLCanvasElement&&t instanceof window.HTMLCanvasElement){v=t;d=v.getContext("2d");l=v.width,u=v.height;g=d.getImageData(0,0,l,u);f=g.data;p=4}else if(window.CanvasRenderingContext2D&&t instanceof window.CanvasRenderingContext2D){v=t.canvas;d=t;l=v.width,u=v.height;g=d.getImageData(0,0,l,u);f=g.data;p=4}else if(window.ImageData&&t instanceof window.ImageData){g=t;l=t.width,u=t.height;f=g.data;p=4}}c=Math.max(l,u);if(window.Uint8ClampedArray&&f instanceof window.Uint8ClampedArray||window.Uint8Array&&f instanceof window.Uint8Array){h=f;f=Array(l*u);for(m=0,y=h.length;m<y;m++){f[m]=h[m*p+s]/255}}else{if(p!==1)throw Error("Raw data can have only 1 value per pixel")}var x=Array(l*u);var b=Array(l*u);var _=Array(c);var w=Array(c);var k=Array(c+1);var M=Array(c);for(m=0,y=l*u;m<y;m++){var A=f[m];x[m]=A===1?0:A===0?a:Math.pow(Math.max(0,.5-A),2);b[m]=A===1?a:A===0?0:Math.pow(Math.max(0,A-.5),2)}o(x,l,u,_,w,M,k);o(b,l,u,_,w,M,k);var T=window.Float32Array?new Float32Array(l*u):new Array(l*u);for(m=0,y=l*u;m<y;m++){T[m]=n(1-((x[m]-b[m])/i+r),0,1)}return T}function o(t,e,r,n,a,i,o){for(var l=0;l<e;l++){for(var u=0;u<r;u++){n[u]=t[u*e+l]}s(n,a,i,o,r);for(u=0;u<r;u++){t[u*e+l]=a[u]}}for(u=0;u<r;u++){for(l=0;l<e;l++){n[l]=t[u*e+l]}s(n,a,i,o,e);for(l=0;l<e;l++){t[u*e+l]=Math.sqrt(a[l])}}}function s(t,e,r,n,i){r[0]=0;n[0]=-a;n[1]=+a;for(var o=1,s=0;o<i;o++){var l=(t[o]+o*o-(t[r[s]]+r[s]*r[s]))/(2*o-2*r[s]);while(l<=n[s]){s--;l=(t[o]+o*o-(t[r[s]]+r[s]*r[s]))/(2*o-2*r[s])}s++;r[s]=o;n[s]=l;n[s+1]=+a}for(o=0,s=0;o<i;o++){while(n[s+1]<o)s++;e[o]=(o-r[s])*(o-r[s])+t[r[s]]}}},{clamp:102}],82:[function(t,e,r){(function(e,r){"use strict";function n(t,e){if(!t)throw new Error(e||"Assertion failed")}function a(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype;t.prototype=new r;t.prototype.constructor=t}function i(t,e,r){if(i.isBN(t)){return t}this.negative=0;this.words=null;this.length=0;this.red=null;if(t!==null){if(e==="le"||e==="be"){r=e;e=10}this._init(t||0,e||10,r||"be")}}if(typeof e==="object"){e.exports=i}else{r.BN=i}i.BN=i;i.wordSize=26;var o;try{o=t("buffer").Buffer}catch(t){}i.isBN=function t(e){if(e instanceof i){return true}return e!==null&&typeof e==="object"&&e.constructor.wordSize===i.wordSize&&Array.isArray(e.words)};i.max=function t(e,r){if(e.cmp(r)>0)return e;return r};i.min=function t(e,r){if(e.cmp(r)<0)return e;return r};i.prototype._init=function t(e,r,a){if(typeof e==="number"){return this._initNumber(e,r,a)}if(typeof e==="object"){return this._initArray(e,r,a)}if(r==="hex"){r=16}n(r===(r|0)&&r>=2&&r<=36);e=e.toString().replace(/\s+/g,"");var i=0;if(e[0]==="-"){i++}if(r===16){this._parseHex(e,i)}else{this._parseBase(e,r,i)}if(e[0]==="-"){this.negative=1}this.strip();if(a!=="le")return;this._initArray(this.toArray(),r,a)};i.prototype._initNumber=function t(e,r,a){if(e<0){this.negative=1;e=-e}if(e<67108864){this.words=[e&67108863];this.length=1}else if(e<4503599627370496){this.words=[e&67108863,e/67108864&67108863];this.length=2}else{n(e<9007199254740992);this.words=[e&67108863,e/67108864&67108863,1];this.length=3}if(a!=="le")return;this._initArray(this.toArray(),r,a)};i.prototype._initArray=function t(e,r,a){n(typeof e.length==="number");if(e.length<=0){this.words=[0];this.length=1;return this}this.length=Math.ceil(e.length/3);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}var o,s;var l=0;if(a==="be"){for(i=e.length-1,o=0;i>=0;i-=3){s=e[i]|e[i-1]<<8|e[i-2]<<16;this.words[o]|=s<<l&67108863;this.words[o+1]=s>>>26-l&67108863;l+=24;if(l>=26){l-=26;o++}}}else if(a==="le"){for(i=0,o=0;i<e.length;i+=3){s=e[i]|e[i+1]<<8|e[i+2]<<16;this.words[o]|=s<<l&67108863;this.words[o+1]=s>>>26-l&67108863;l+=24;if(l>=26){l-=26;o++}}}return this.strip()};function s(t,e,r){var n=0;var a=Math.min(t.length,r);for(var i=e;i<a;i++){var o=t.charCodeAt(i)-48;n<<=4;if(o>=49&&o<=54){n|=o-49+10}else if(o>=17&&o<=22){n|=o-17+10}else{n|=o&15}}return n}i.prototype._parseHex=function t(e,r){this.length=Math.ceil((e.length-r)/6);this.words=new Array(this.length);for(var n=0;n<this.length;n++){this.words[n]=0}var a,i;var o=0;for(n=e.length-6,a=0;n>=r;n-=6){i=s(e,n,n+6);this.words[a]|=i<<o&67108863;this.words[a+1]|=i>>>26-o&4194303;o+=24;if(o>=26){o-=26;a++}}if(n+6!==r){i=s(e,r,n+6);this.words[a]|=i<<o&67108863;this.words[a+1]|=i>>>26-o&4194303}this.strip()};function l(t,e,r,n){var a=0;var i=Math.min(t.length,r);for(var o=e;o<i;o++){var s=t.charCodeAt(o)-48;a*=n;if(s>=49){a+=s-49+10}else if(s>=17){a+=s-17+10}else{a+=s}}return a}i.prototype._parseBase=function t(e,r,n){this.words=[0];this.length=1;for(var a=0,i=1;i<=67108863;i*=r){a++}a--;i=i/r|0;var o=e.length-n;var s=o%a;var u=Math.min(o,o-s)+n;var c=0;for(var f=n;f<u;f+=a){c=l(e,f,f+a,r);this.imuln(i);if(this.words[0]+c<67108864){this.words[0]+=c}else{this._iaddn(c)}}if(s!==0){var h=1;c=l(e,f,e.length,r);for(f=0;f<s;f++){h*=r}this.imuln(h);if(this.words[0]+c<67108864){this.words[0]+=c}else{this._iaddn(c)}}};i.prototype.copy=function t(e){e.words=new Array(this.length);for(var r=0;r<this.length;r++){e.words[r]=this.words[r]}e.length=this.length;e.negative=this.negative;e.red=this.red};i.prototype.clone=function t(){var e=new i(null);this.copy(e);return e};i.prototype._expand=function t(e){while(this.length<e){this.words[this.length++]=0}return this};i.prototype.strip=function t(){while(this.length>1&&this.words[this.length-1]===0){this.length--}return this._normSign()};i.prototype._normSign=function t(){if(this.length===1&&this.words[0]===0){this.negative=0}return this};i.prototype.inspect=function t(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"];var c=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5];var f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function t(e,r){e=e||10;r=r|0||1;var a;if(e===16||e==="hex"){a="";var i=0;var o=0;for(var s=0;s<this.length;s++){var l=this.words[s];var h=((l<<i|o)&16777215).toString(16);o=l>>>24-i&16777215;if(o!==0||s!==this.length-1){a=u[6-h.length]+h+a}else{a=h+a}i+=2;if(i>=26){i-=26;s--}}if(o!==0){a=o.toString(16)+a}while(a.length%r!==0){a="0"+a}if(this.negative!==0){a="-"+a}return a}if(e===(e|0)&&e>=2&&e<=36){var p=c[e];var d=f[e];a="";var v=this.clone();v.negative=0;while(!v.isZero()){var g=v.modn(d).toString(e);v=v.idivn(d);if(!v.isZero()){a=u[p-g.length]+g+a}else{a=g+a}}if(this.isZero()){a="0"+a}while(a.length%r!==0){a="0"+a}if(this.negative!==0){a="-"+a}return a}n(false,"Base should be between 2 and 36")};i.prototype.toNumber=function t(){var e=this.words[0];if(this.length===2){e+=this.words[1]*67108864}else if(this.length===3&&this.words[2]===1){e+=4503599627370496+this.words[1]*67108864}else if(this.length>2){n(false,"Number can only safely store up to 53 bits")}return this.negative!==0?-e:e};i.prototype.toJSON=function t(){return this.toString(16)};i.prototype.toBuffer=function t(e,r){n(typeof o!=="undefined");return this.toArrayLike(o,e,r)};i.prototype.toArray=function t(e,r){return this.toArrayLike(Array,e,r)};i.prototype.toArrayLike=function t(e,r,a){var i=this.byteLength();var o=a||Math.max(1,i);n(i<=o,"byte array longer than desired length");n(o>0,"Requested array length <= 0");this.strip();var s=r==="le";var l=new e(o);var u,c;var f=this.clone();if(!s){for(c=0;c<o-i;c++){l[c]=0}for(c=0;!f.isZero();c++){u=f.andln(255);f.iushrn(8);l[o-c-1]=u}}else{for(c=0;!f.isZero();c++){u=f.andln(255);f.iushrn(8);l[c]=u}for(;c<o;c++){l[c]=0}}return l};if(Math.clz32){i.prototype._countBits=function t(e){return 32-Math.clz32(e)}}else{i.prototype._countBits=function t(e){var r=e;var n=0;if(r>=4096){n+=13;r>>>=13}if(r>=64){n+=7;r>>>=7}if(r>=8){n+=4;r>>>=4}if(r>=2){n+=2;r>>>=2}return n+r}}i.prototype._zeroBits=function t(e){if(e===0)return 26;var r=e;var n=0;if((r&8191)===0){n+=13;r>>>=13}if((r&127)===0){n+=7;r>>>=7}if((r&15)===0){n+=4;r>>>=4}if((r&3)===0){n+=2;r>>>=2}if((r&1)===0){n++}return n};i.prototype.bitLength=function t(){var e=this.words[this.length-1];var r=this._countBits(e);return(this.length-1)*26+r};function h(t){var e=new Array(t.bitLength());for(var r=0;r<e.length;r++){var n=r/26|0;var a=r%26;e[r]=(t.words[n]&1<<a)>>>a}return e}i.prototype.zeroBits=function t(){if(this.isZero())return 0;var e=0;for(var r=0;r<this.length;r++){var n=this._zeroBits(this.words[r]);e+=n;if(n!==26)break}return e};i.prototype.byteLength=function t(){return Math.ceil(this.bitLength()/8)};i.prototype.toTwos=function t(e){if(this.negative!==0){return this.abs().inotn(e).iaddn(1)}return this.clone()};i.prototype.fromTwos=function t(e){if(this.testn(e-1)){return this.notn(e).iaddn(1).ineg()}return this.clone()};i.prototype.isNeg=function t(){return this.negative!==0};i.prototype.neg=function t(){return this.clone().ineg()};i.prototype.ineg=function t(){if(!this.isZero()){this.negative^=1}return this};i.prototype.iuor=function t(e){while(this.length<e.length){this.words[this.length++]=0}for(var r=0;r<e.length;r++){this.words[r]=this.words[r]|e.words[r]}return this.strip()};i.prototype.ior=function t(e){n((this.negative|e.negative)===0);return this.iuor(e)};i.prototype.or=function t(e){if(this.length>e.length)return this.clone().ior(e);return e.clone().ior(this)};i.prototype.uor=function t(e){if(this.length>e.length)return this.clone().iuor(e);return e.clone().iuor(this)};i.prototype.iuand=function t(e){var r;if(this.length>e.length){r=e}else{r=this}for(var n=0;n<r.length;n++){this.words[n]=this.words[n]&e.words[n]}this.length=r.length;return this.strip()};i.prototype.iand=function t(e){n((this.negative|e.negative)===0);return this.iuand(e)};i.prototype.and=function t(e){if(this.length>e.length)return this.clone().iand(e);return e.clone().iand(this)};i.prototype.uand=function t(e){if(this.length>e.length)return this.clone().iuand(e);return e.clone().iuand(this)};i.prototype.iuxor=function t(e){var r;var n;if(this.length>e.length){r=this;n=e}else{r=e;n=this}for(var a=0;a<n.length;a++){this.words[a]=r.words[a]^n.words[a]}if(this!==r){for(;a<r.length;a++){this.words[a]=r.words[a]}}this.length=r.length;return this.strip()};i.prototype.ixor=function t(e){n((this.negative|e.negative)===0);return this.iuxor(e)};i.prototype.xor=function t(e){if(this.length>e.length)return this.clone().ixor(e);return e.clone().ixor(this)};i.prototype.uxor=function t(e){if(this.length>e.length)return this.clone().iuxor(e);return e.clone().iuxor(this)};i.prototype.inotn=function t(e){n(typeof e==="number"&&e>=0);var r=Math.ceil(e/26)|0;var a=e%26;this._expand(r);if(a>0){r--}for(var i=0;i<r;i++){this.words[i]=~this.words[i]&67108863}if(a>0){this.words[i]=~this.words[i]&67108863>>26-a}return this.strip()};i.prototype.notn=function t(e){return this.clone().inotn(e)};i.prototype.setn=function t(e,r){n(typeof e==="number"&&e>=0);var a=e/26|0;var i=e%26;this._expand(a+1);if(r){this.words[a]=this.words[a]|1<<i}else{this.words[a]=this.words[a]&~(1<<i)}return this.strip()};i.prototype.iadd=function t(e){var r;if(this.negative!==0&&e.negative===0){this.negative=0;r=this.isub(e);this.negative^=1;return this._normSign()}else if(this.negative===0&&e.negative!==0){e.negative=0;r=this.isub(e);e.negative=1;return r._normSign()}var n,a;if(this.length>e.length){n=this;a=e}else{n=e;a=this}var i=0;for(var o=0;o<a.length;o++){r=(n.words[o]|0)+(a.words[o]|0)+i;this.words[o]=r&67108863;i=r>>>26}for(;i!==0&&o<n.length;o++){r=(n.words[o]|0)+i;this.words[o]=r&67108863;i=r>>>26}this.length=n.length;if(i!==0){this.words[this.length]=i;this.length++}else if(n!==this){for(;o<n.length;o++){this.words[o]=n.words[o]}}return this};i.prototype.add=function t(e){var r;if(e.negative!==0&&this.negative===0){e.negative=0;r=this.sub(e);e.negative^=1;return r}else if(e.negative===0&&this.negative!==0){this.negative=0;r=e.sub(this);this.negative=1;return r}if(this.length>e.length)return this.clone().iadd(e);return e.clone().iadd(this)};i.prototype.isub=function t(e){if(e.negative!==0){e.negative=0;var r=this.iadd(e);e.negative=1;return r._normSign()}else if(this.negative!==0){this.negative=0;this.iadd(e);this.negative=1;return this._normSign()}var n=this.cmp(e);if(n===0){this.negative=0;this.length=1;this.words[0]=0;return this}var a,i;if(n>0){a=this;i=e}else{a=e;i=this}var o=0;for(var s=0;s<i.length;s++){r=(a.words[s]|0)-(i.words[s]|0)+o;o=r>>26;this.words[s]=r&67108863}for(;o!==0&&s<a.length;s++){r=(a.words[s]|0)+o;o=r>>26;this.words[s]=r&67108863}if(o===0&&s<a.length&&a!==this){for(;s<a.length;s++){this.words[s]=a.words[s]}}this.length=Math.max(this.length,s);if(a!==this){this.negative=1}return this.strip()};i.prototype.sub=function t(e){return this.clone().isub(e)};function p(t,e,r){r.negative=e.negative^t.negative;var n=t.length+e.length|0;r.length=n;n=n-1|0;var a=t.words[0]|0;var i=e.words[0]|0;var o=a*i;var s=o&67108863;var l=o/67108864|0;r.words[0]=s;for(var u=1;u<n;u++){var c=l>>>26;var f=l&67108863;var h=Math.min(u,e.length-1);for(var p=Math.max(0,u-t.length+1);p<=h;p++){var d=u-p|0;a=t.words[d]|0;i=e.words[p]|0;o=a*i+f;c+=o/67108864|0;f=o&67108863}r.words[u]=f|0;l=c|0}if(l!==0){r.words[u]=l|0}else{r.length--}return r.strip()}var d=function t(e,r,n){var a=e.words;var i=r.words;var o=n.words;var s=0;var l;var u;var c;var f=a[0]|0;var h=f&8191;var p=f>>>13;var d=a[1]|0;var v=d&8191;var g=d>>>13;var m=a[2]|0;var y=m&8191;var x=m>>>13;var b=a[3]|0;var _=b&8191;var w=b>>>13;var k=a[4]|0;var M=k&8191;var A=k>>>13;var T=a[5]|0;var S=T&8191;var E=T>>>13;var C=a[6]|0;var L=C&8191;var I=C>>>13;var z=a[7]|0;var P=z&8191;var O=z>>>13;var D=a[8]|0;var R=D&8191;var B=D>>>13;var F=a[9]|0;var N=F&8191;var j=F>>>13;var V=i[0]|0;var U=V&8191;var q=V>>>13;var H=i[1]|0;var G=H&8191;var W=H>>>13;var Y=i[2]|0;var X=Y&8191;var Z=Y>>>13;var $=i[3]|0;var J=$&8191;var K=$>>>13;var Q=i[4]|0;var tt=Q&8191;var et=Q>>>13;var rt=i[5]|0;var nt=rt&8191;var at=rt>>>13;var it=i[6]|0;var ot=it&8191;var st=it>>>13;var lt=i[7]|0;var ut=lt&8191;var ct=lt>>>13;var ft=i[8]|0;var ht=ft&8191;var pt=ft>>>13;var dt=i[9]|0;var vt=dt&8191;var gt=dt>>>13;n.negative=e.negative^r.negative;n.length=19;l=Math.imul(h,U);u=Math.imul(h,q);u=u+Math.imul(p,U)|0;c=Math.imul(p,q);var mt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(mt>>>26)|0;mt&=67108863;l=Math.imul(v,U);u=Math.imul(v,q);u=u+Math.imul(g,U)|0;c=Math.imul(g,q);l=l+Math.imul(h,G)|0;u=u+Math.imul(h,W)|0;u=u+Math.imul(p,G)|0;c=c+Math.imul(p,W)|0;var yt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(yt>>>26)|0;yt&=67108863;l=Math.imul(y,U);u=Math.imul(y,q);u=u+Math.imul(x,U)|0;c=Math.imul(x,q);l=l+Math.imul(v,G)|0;u=u+Math.imul(v,W)|0;u=u+Math.imul(g,G)|0;c=c+Math.imul(g,W)|0;l=l+Math.imul(h,X)|0;u=u+Math.imul(h,Z)|0;u=u+Math.imul(p,X)|0;c=c+Math.imul(p,Z)|0;var xt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(xt>>>26)|0;xt&=67108863;l=Math.imul(_,U);u=Math.imul(_,q);u=u+Math.imul(w,U)|0;c=Math.imul(w,q);l=l+Math.imul(y,G)|0;u=u+Math.imul(y,W)|0;u=u+Math.imul(x,G)|0;c=c+Math.imul(x,W)|0;l=l+Math.imul(v,X)|0;u=u+Math.imul(v,Z)|0;u=u+Math.imul(g,X)|0;c=c+Math.imul(g,Z)|0;l=l+Math.imul(h,J)|0;u=u+Math.imul(h,K)|0;u=u+Math.imul(p,J)|0;c=c+Math.imul(p,K)|0;var bt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(bt>>>26)|0;bt&=67108863;l=Math.imul(M,U);u=Math.imul(M,q);u=u+Math.imul(A,U)|0;c=Math.imul(A,q);l=l+Math.imul(_,G)|0;u=u+Math.imul(_,W)|0;u=u+Math.imul(w,G)|0;c=c+Math.imul(w,W)|0;l=l+Math.imul(y,X)|0;u=u+Math.imul(y,Z)|0;u=u+Math.imul(x,X)|0;c=c+Math.imul(x,Z)|0;l=l+Math.imul(v,J)|0;u=u+Math.imul(v,K)|0;u=u+Math.imul(g,J)|0;c=c+Math.imul(g,K)|0;l=l+Math.imul(h,tt)|0;u=u+Math.imul(h,et)|0;u=u+Math.imul(p,tt)|0;c=c+Math.imul(p,et)|0;var _t=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(_t>>>26)|0;_t&=67108863;l=Math.imul(S,U);u=Math.imul(S,q);u=u+Math.imul(E,U)|0;c=Math.imul(E,q);l=l+Math.imul(M,G)|0;u=u+Math.imul(M,W)|0;u=u+Math.imul(A,G)|0;c=c+Math.imul(A,W)|0;l=l+Math.imul(_,X)|0;u=u+Math.imul(_,Z)|0;u=u+Math.imul(w,X)|0;c=c+Math.imul(w,Z)|0;l=l+Math.imul(y,J)|0;u=u+Math.imul(y,K)|0;u=u+Math.imul(x,J)|0;c=c+Math.imul(x,K)|0;l=l+Math.imul(v,tt)|0;u=u+Math.imul(v,et)|0;u=u+Math.imul(g,tt)|0;c=c+Math.imul(g,et)|0;l=l+Math.imul(h,nt)|0;u=u+Math.imul(h,at)|0;u=u+Math.imul(p,nt)|0;c=c+Math.imul(p,at)|0;var wt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(wt>>>26)|0;wt&=67108863;l=Math.imul(L,U);u=Math.imul(L,q);u=u+Math.imul(I,U)|0;c=Math.imul(I,q);l=l+Math.imul(S,G)|0;u=u+Math.imul(S,W)|0;u=u+Math.imul(E,G)|0;c=c+Math.imul(E,W)|0;l=l+Math.imul(M,X)|0;u=u+Math.imul(M,Z)|0;u=u+Math.imul(A,X)|0;c=c+Math.imul(A,Z)|0;l=l+Math.imul(_,J)|0;u=u+Math.imul(_,K)|0;u=u+Math.imul(w,J)|0;c=c+Math.imul(w,K)|0;l=l+Math.imul(y,tt)|0;u=u+Math.imul(y,et)|0;u=u+Math.imul(x,tt)|0;c=c+Math.imul(x,et)|0;l=l+Math.imul(v,nt)|0;u=u+Math.imul(v,at)|0;u=u+Math.imul(g,nt)|0;c=c+Math.imul(g,at)|0;l=l+Math.imul(h,ot)|0;u=u+Math.imul(h,st)|0;u=u+Math.imul(p,ot)|0;c=c+Math.imul(p,st)|0;var kt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(kt>>>26)|0;kt&=67108863;l=Math.imul(P,U);u=Math.imul(P,q);u=u+Math.imul(O,U)|0;c=Math.imul(O,q);l=l+Math.imul(L,G)|0;u=u+Math.imul(L,W)|0;u=u+Math.imul(I,G)|0;c=c+Math.imul(I,W)|0;l=l+Math.imul(S,X)|0;u=u+Math.imul(S,Z)|0;u=u+Math.imul(E,X)|0;c=c+Math.imul(E,Z)|0;l=l+Math.imul(M,J)|0;u=u+Math.imul(M,K)|0;u=u+Math.imul(A,J)|0;c=c+Math.imul(A,K)|0;l=l+Math.imul(_,tt)|0;u=u+Math.imul(_,et)|0;u=u+Math.imul(w,tt)|0;c=c+Math.imul(w,et)|0;l=l+Math.imul(y,nt)|0;u=u+Math.imul(y,at)|0;u=u+Math.imul(x,nt)|0;c=c+Math.imul(x,at)|0;l=l+Math.imul(v,ot)|0;u=u+Math.imul(v,st)|0;u=u+Math.imul(g,ot)|0;c=c+Math.imul(g,st)|0;l=l+Math.imul(h,ut)|0;u=u+Math.imul(h,ct)|0;u=u+Math.imul(p,ut)|0;c=c+Math.imul(p,ct)|0;var Mt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Mt>>>26)|0;Mt&=67108863;l=Math.imul(R,U);u=Math.imul(R,q);u=u+Math.imul(B,U)|0;c=Math.imul(B,q);l=l+Math.imul(P,G)|0;u=u+Math.imul(P,W)|0;u=u+Math.imul(O,G)|0;c=c+Math.imul(O,W)|0;l=l+Math.imul(L,X)|0;u=u+Math.imul(L,Z)|0;u=u+Math.imul(I,X)|0;c=c+Math.imul(I,Z)|0;l=l+Math.imul(S,J)|0;u=u+Math.imul(S,K)|0;u=u+Math.imul(E,J)|0;c=c+Math.imul(E,K)|0;l=l+Math.imul(M,tt)|0;u=u+Math.imul(M,et)|0;u=u+Math.imul(A,tt)|0;c=c+Math.imul(A,et)|0;l=l+Math.imul(_,nt)|0;u=u+Math.imul(_,at)|0;u=u+Math.imul(w,nt)|0;c=c+Math.imul(w,at)|0;l=l+Math.imul(y,ot)|0;u=u+Math.imul(y,st)|0;u=u+Math.imul(x,ot)|0;c=c+Math.imul(x,st)|0;l=l+Math.imul(v,ut)|0;u=u+Math.imul(v,ct)|0;u=u+Math.imul(g,ut)|0;c=c+Math.imul(g,ct)|0;l=l+Math.imul(h,ht)|0;u=u+Math.imul(h,pt)|0;u=u+Math.imul(p,ht)|0;c=c+Math.imul(p,pt)|0;var At=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(At>>>26)|0;At&=67108863;l=Math.imul(N,U);u=Math.imul(N,q);u=u+Math.imul(j,U)|0;c=Math.imul(j,q);l=l+Math.imul(R,G)|0;u=u+Math.imul(R,W)|0;u=u+Math.imul(B,G)|0;c=c+Math.imul(B,W)|0;l=l+Math.imul(P,X)|0;u=u+Math.imul(P,Z)|0;u=u+Math.imul(O,X)|0;c=c+Math.imul(O,Z)|0;l=l+Math.imul(L,J)|0;u=u+Math.imul(L,K)|0;u=u+Math.imul(I,J)|0;c=c+Math.imul(I,K)|0;l=l+Math.imul(S,tt)|0;u=u+Math.imul(S,et)|0;u=u+Math.imul(E,tt)|0;c=c+Math.imul(E,et)|0;l=l+Math.imul(M,nt)|0;u=u+Math.imul(M,at)|0;u=u+Math.imul(A,nt)|0;c=c+Math.imul(A,at)|0;l=l+Math.imul(_,ot)|0;u=u+Math.imul(_,st)|0;u=u+Math.imul(w,ot)|0;c=c+Math.imul(w,st)|0;l=l+Math.imul(y,ut)|0;u=u+Math.imul(y,ct)|0;u=u+Math.imul(x,ut)|0;c=c+Math.imul(x,ct)|0;l=l+Math.imul(v,ht)|0;u=u+Math.imul(v,pt)|0;u=u+Math.imul(g,ht)|0;c=c+Math.imul(g,pt)|0;l=l+Math.imul(h,vt)|0;u=u+Math.imul(h,gt)|0;u=u+Math.imul(p,vt)|0;c=c+Math.imul(p,gt)|0;var Tt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Tt>>>26)|0;Tt&=67108863;l=Math.imul(N,G);u=Math.imul(N,W);u=u+Math.imul(j,G)|0;c=Math.imul(j,W);l=l+Math.imul(R,X)|0;u=u+Math.imul(R,Z)|0;u=u+Math.imul(B,X)|0;c=c+Math.imul(B,Z)|0;l=l+Math.imul(P,J)|0;u=u+Math.imul(P,K)|0;u=u+Math.imul(O,J)|0;c=c+Math.imul(O,K)|0;l=l+Math.imul(L,tt)|0;u=u+Math.imul(L,et)|0;u=u+Math.imul(I,tt)|0;c=c+Math.imul(I,et)|0;l=l+Math.imul(S,nt)|0;u=u+Math.imul(S,at)|0;u=u+Math.imul(E,nt)|0;c=c+Math.imul(E,at)|0;l=l+Math.imul(M,ot)|0;u=u+Math.imul(M,st)|0;u=u+Math.imul(A,ot)|0;c=c+Math.imul(A,st)|0;l=l+Math.imul(_,ut)|0;u=u+Math.imul(_,ct)|0;u=u+Math.imul(w,ut)|0;c=c+Math.imul(w,ct)|0;l=l+Math.imul(y,ht)|0;u=u+Math.imul(y,pt)|0;u=u+Math.imul(x,ht)|0;c=c+Math.imul(x,pt)|0;l=l+Math.imul(v,vt)|0;u=u+Math.imul(v,gt)|0;u=u+Math.imul(g,vt)|0;c=c+Math.imul(g,gt)|0;var St=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(St>>>26)|0;St&=67108863;l=Math.imul(N,X);u=Math.imul(N,Z);u=u+Math.imul(j,X)|0;c=Math.imul(j,Z);l=l+Math.imul(R,J)|0;u=u+Math.imul(R,K)|0;u=u+Math.imul(B,J)|0;c=c+Math.imul(B,K)|0;l=l+Math.imul(P,tt)|0;u=u+Math.imul(P,et)|0;u=u+Math.imul(O,tt)|0;c=c+Math.imul(O,et)|0;l=l+Math.imul(L,nt)|0;u=u+Math.imul(L,at)|0;u=u+Math.imul(I,nt)|0;c=c+Math.imul(I,at)|0;l=l+Math.imul(S,ot)|0;u=u+Math.imul(S,st)|0;u=u+Math.imul(E,ot)|0;c=c+Math.imul(E,st)|0;l=l+Math.imul(M,ut)|0;u=u+Math.imul(M,ct)|0;u=u+Math.imul(A,ut)|0;c=c+Math.imul(A,ct)|0;l=l+Math.imul(_,ht)|0;u=u+Math.imul(_,pt)|0;u=u+Math.imul(w,ht)|0;c=c+Math.imul(w,pt)|0;l=l+Math.imul(y,vt)|0;u=u+Math.imul(y,gt)|0;u=u+Math.imul(x,vt)|0;c=c+Math.imul(x,gt)|0;var Et=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Et>>>26)|0;Et&=67108863;l=Math.imul(N,J);u=Math.imul(N,K);u=u+Math.imul(j,J)|0;c=Math.imul(j,K);l=l+Math.imul(R,tt)|0;u=u+Math.imul(R,et)|0;u=u+Math.imul(B,tt)|0;c=c+Math.imul(B,et)|0;l=l+Math.imul(P,nt)|0;u=u+Math.imul(P,at)|0;u=u+Math.imul(O,nt)|0;c=c+Math.imul(O,at)|0;l=l+Math.imul(L,ot)|0;u=u+Math.imul(L,st)|0;u=u+Math.imul(I,ot)|0;c=c+Math.imul(I,st)|0;l=l+Math.imul(S,ut)|0;u=u+Math.imul(S,ct)|0;u=u+Math.imul(E,ut)|0;c=c+Math.imul(E,ct)|0;l=l+Math.imul(M,ht)|0;u=u+Math.imul(M,pt)|0;u=u+Math.imul(A,ht)|0;c=c+Math.imul(A,pt)|0;l=l+Math.imul(_,vt)|0;u=u+Math.imul(_,gt)|0;u=u+Math.imul(w,vt)|0;c=c+Math.imul(w,gt)|0;var Ct=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Ct>>>26)|0;Ct&=67108863;l=Math.imul(N,tt);u=Math.imul(N,et);u=u+Math.imul(j,tt)|0;c=Math.imul(j,et);l=l+Math.imul(R,nt)|0;u=u+Math.imul(R,at)|0;u=u+Math.imul(B,nt)|0;c=c+Math.imul(B,at)|0;l=l+Math.imul(P,ot)|0;u=u+Math.imul(P,st)|0;u=u+Math.imul(O,ot)|0;c=c+Math.imul(O,st)|0;l=l+Math.imul(L,ut)|0;u=u+Math.imul(L,ct)|0;u=u+Math.imul(I,ut)|0;c=c+Math.imul(I,ct)|0;l=l+Math.imul(S,ht)|0;u=u+Math.imul(S,pt)|0;u=u+Math.imul(E,ht)|0;c=c+Math.imul(E,pt)|0;l=l+Math.imul(M,vt)|0;u=u+Math.imul(M,gt)|0;u=u+Math.imul(A,vt)|0;c=c+Math.imul(A,gt)|0;var Lt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Lt>>>26)|0;Lt&=67108863;l=Math.imul(N,nt);u=Math.imul(N,at);u=u+Math.imul(j,nt)|0;c=Math.imul(j,at);l=l+Math.imul(R,ot)|0;u=u+Math.imul(R,st)|0;u=u+Math.imul(B,ot)|0;c=c+Math.imul(B,st)|0;l=l+Math.imul(P,ut)|0;u=u+Math.imul(P,ct)|0;u=u+Math.imul(O,ut)|0;c=c+Math.imul(O,ct)|0;l=l+Math.imul(L,ht)|0;u=u+Math.imul(L,pt)|0;u=u+Math.imul(I,ht)|0;c=c+Math.imul(I,pt)|0;l=l+Math.imul(S,vt)|0;u=u+Math.imul(S,gt)|0;u=u+Math.imul(E,vt)|0;c=c+Math.imul(E,gt)|0;var It=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(It>>>26)|0;It&=67108863;l=Math.imul(N,ot);u=Math.imul(N,st);u=u+Math.imul(j,ot)|0;c=Math.imul(j,st);l=l+Math.imul(R,ut)|0;u=u+Math.imul(R,ct)|0;u=u+Math.imul(B,ut)|0;c=c+Math.imul(B,ct)|0;l=l+Math.imul(P,ht)|0;u=u+Math.imul(P,pt)|0;u=u+Math.imul(O,ht)|0;c=c+Math.imul(O,pt)|0;l=l+Math.imul(L,vt)|0;u=u+Math.imul(L,gt)|0;u=u+Math.imul(I,vt)|0;c=c+Math.imul(I,gt)|0;var zt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(zt>>>26)|0;zt&=67108863;l=Math.imul(N,ut);u=Math.imul(N,ct);u=u+Math.imul(j,ut)|0;c=Math.imul(j,ct);l=l+Math.imul(R,ht)|0;u=u+Math.imul(R,pt)|0;u=u+Math.imul(B,ht)|0;c=c+Math.imul(B,pt)|0;l=l+Math.imul(P,vt)|0;u=u+Math.imul(P,gt)|0;u=u+Math.imul(O,vt)|0;c=c+Math.imul(O,gt)|0;var Pt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Pt>>>26)|0;Pt&=67108863;l=Math.imul(N,ht);u=Math.imul(N,pt);u=u+Math.imul(j,ht)|0;c=Math.imul(j,pt);l=l+Math.imul(R,vt)|0;u=u+Math.imul(R,gt)|0;u=u+Math.imul(B,vt)|0;c=c+Math.imul(B,gt)|0;var Ot=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Ot>>>26)|0;Ot&=67108863;l=Math.imul(N,vt);u=Math.imul(N,gt);u=u+Math.imul(j,vt)|0;c=Math.imul(j,gt);var Dt=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Dt>>>26)|0;Dt&=67108863;o[0]=mt;o[1]=yt;o[2]=xt;o[3]=bt;o[4]=_t;o[5]=wt;o[6]=kt;o[7]=Mt;o[8]=At;o[9]=Tt;o[10]=St;o[11]=Et;o[12]=Ct;o[13]=Lt;o[14]=It;o[15]=zt;o[16]=Pt;o[17]=Ot;o[18]=Dt;if(s!==0){o[19]=s;n.length++}return n};if(!Math.imul){d=p}function v(t,e,r){r.negative=e.negative^t.negative;r.length=t.length+e.length;var n=0;var a=0;for(var i=0;i<r.length-1;i++){var o=a;a=0;var s=n&67108863;var l=Math.min(i,e.length-1);for(var u=Math.max(0,i-t.length+1);u<=l;u++){var c=i-u;var f=t.words[c]|0;var h=e.words[u]|0;var p=f*h;var d=p&67108863;o=o+(p/67108864|0)|0;d=d+s|0;s=d&67108863;o=o+(d>>>26)|0;a+=o>>>26;o&=67108863}r.words[i]=s;n=o;o=a}if(n!==0){r.words[i]=n}else{r.length--}return r.strip()}function g(t,e,r){var n=new m;return n.mulp(t,e,r)}i.prototype.mulTo=function t(e,r){var n;var a=this.length+e.length;if(this.length===10&&e.length===10){n=d(this,e,r)}else if(a<63){n=p(this,e,r)}else if(a<1024){n=v(this,e,r)}else{n=g(this,e,r)}return n};function m(t,e){this.x=t;this.y=e}m.prototype.makeRBT=function t(e){var r=new Array(e);var n=i.prototype._countBits(e)-1;for(var a=0;a<e;a++){r[a]=this.revBin(a,n,e)}return r};m.prototype.revBin=function t(e,r,n){if(e===0||e===n-1)return e;var a=0;for(var i=0;i<r;i++){a|=(e&1)<<r-i-1;e>>=1}return a};m.prototype.permute=function t(e,r,n,a,i,o){for(var s=0;s<o;s++){a[s]=r[e[s]];i[s]=n[e[s]]}};m.prototype.transform=function t(e,r,n,a,i,o){this.permute(o,e,r,n,a,i);for(var s=1;s<i;s<<=1){var l=s<<1;var u=Math.cos(2*Math.PI/l);var c=Math.sin(2*Math.PI/l);for(var f=0;f<i;f+=l){var h=u;var p=c;for(var d=0;d<s;d++){var v=n[f+d];var g=a[f+d];var m=n[f+d+s];var y=a[f+d+s];var x=h*m-p*y;y=h*y+p*m;m=x;n[f+d]=v+m;a[f+d]=g+y;n[f+d+s]=v-m;a[f+d+s]=g-y;if(d!==l){x=u*h-c*p;p=u*p+c*h;h=x}}}}};m.prototype.guessLen13b=function t(e,r){var n=Math.max(r,e)|1;var a=n&1;var i=0;for(n=n/2|0;n;n=n>>>1){i++}return 1<<i+1+a};m.prototype.conjugate=function t(e,r,n){if(n<=1)return;for(var a=0;a<n/2;a++){var i=e[a];e[a]=e[n-a-1];e[n-a-1]=i;i=r[a];r[a]=-r[n-a-1];r[n-a-1]=-i}};m.prototype.normalize13b=function t(e,r){var n=0;for(var a=0;a<r/2;a++){var i=Math.round(e[2*a+1]/r)*8192+Math.round(e[2*a]/r)+n;e[a]=i&67108863;if(i<67108864){n=0}else{n=i/67108864|0}}return e};m.prototype.convert13b=function t(e,r,a,i){var o=0;for(var s=0;s<r;s++){o=o+(e[s]|0);a[2*s]=o&8191;o=o>>>13;a[2*s+1]=o&8191;o=o>>>13}for(s=2*r;s<i;++s){a[s]=0}n(o===0);n((o&~8191)===0)};m.prototype.stub=function t(e){var r=new Array(e);for(var n=0;n<e;n++){r[n]=0}return r};m.prototype.mulp=function t(e,r,n){var a=2*this.guessLen13b(e.length,r.length);var i=this.makeRBT(a);var o=this.stub(a);var s=new Array(a);var l=new Array(a);var u=new Array(a);var c=new Array(a);var f=new Array(a);var h=new Array(a);var p=n.words;p.length=a;this.convert13b(e.words,e.length,s,a);this.convert13b(r.words,r.length,c,a);this.transform(s,o,l,u,a,i);this.transform(c,o,f,h,a,i);for(var d=0;d<a;d++){var v=l[d]*f[d]-u[d]*h[d];u[d]=l[d]*h[d]+u[d]*f[d];l[d]=v}this.conjugate(l,u,a);this.transform(l,u,p,o,a,i);this.conjugate(p,o,a);this.normalize13b(p,a);n.negative=e.negative^r.negative;n.length=e.length+r.length;return n.strip()};i.prototype.mul=function t(e){var r=new i(null);r.words=new Array(this.length+e.length);return this.mulTo(e,r)};i.prototype.mulf=function t(e){var r=new i(null);r.words=new Array(this.length+e.length);return g(this,e,r)};i.prototype.imul=function t(e){return this.clone().mulTo(e,this)};i.prototype.imuln=function t(e){n(typeof e==="number");n(e<67108864);var r=0;for(var a=0;a<this.length;a++){var i=(this.words[a]|0)*e;var o=(i&67108863)+(r&67108863);r>>=26;r+=i/67108864|0;r+=o>>>26;this.words[a]=o&67108863}if(r!==0){this.words[a]=r;this.length++}return this};i.prototype.muln=function t(e){return this.clone().imuln(e)};i.prototype.sqr=function t(){return this.mul(this)};i.prototype.isqr=function t(){return this.imul(this.clone())};i.prototype.pow=function t(e){var r=h(e);if(r.length===0)return new i(1);var n=this;for(var a=0;a<r.length;a++,n=n.sqr()){if(r[a]!==0)break}if(++a<r.length){for(var o=n.sqr();a<r.length;a++,o=o.sqr()){if(r[a]===0)continue;n=n.mul(o)}}return n};i.prototype.iushln=function t(e){n(typeof e==="number"&&e>=0);var r=e%26;var a=(e-r)/26;var i=67108863>>>26-r<<26-r;var o;if(r!==0){var s=0;for(o=0;o<this.length;o++){var l=this.words[o]&i;var u=(this.words[o]|0)-l<<r;this.words[o]=u|s;s=l>>>26-r}if(s){this.words[o]=s;this.length++}}if(a!==0){for(o=this.length-1;o>=0;o--){this.words[o+a]=this.words[o]}for(o=0;o<a;o++){this.words[o]=0}this.length+=a}return this.strip()};i.prototype.ishln=function t(e){n(this.negative===0);return this.iushln(e)};i.prototype.iushrn=function t(e,r,a){n(typeof e==="number"&&e>=0);var i;if(r){i=(r-r%26)/26}else{i=0}var o=e%26;var s=Math.min((e-o)/26,this.length);var l=67108863^67108863>>>o<<o;var u=a;i-=s;i=Math.max(0,i);if(u){for(var c=0;c<s;c++){u.words[c]=this.words[c]}u.length=s}if(s===0){}else if(this.length>s){this.length-=s;for(c=0;c<this.length;c++){this.words[c]=this.words[c+s]}}else{this.words[0]=0;this.length=1}var f=0;for(c=this.length-1;c>=0&&(f!==0||c>=i);c--){var h=this.words[c]|0;this.words[c]=f<<26-o|h>>>o;f=h&l}if(u&&f!==0){u.words[u.length++]=f}if(this.length===0){this.words[0]=0;this.length=1}return this.strip()};i.prototype.ishrn=function t(e,r,a){n(this.negative===0);return this.iushrn(e,r,a)};i.prototype.shln=function t(e){return this.clone().ishln(e)};i.prototype.ushln=function t(e){return this.clone().iushln(e)};i.prototype.shrn=function t(e){return this.clone().ishrn(e)};i.prototype.ushrn=function t(e){return this.clone().iushrn(e)};i.prototype.testn=function t(e){n(typeof e==="number"&&e>=0);var r=e%26;var a=(e-r)/26;var i=1<<r;if(this.length<=a)return false;var o=this.words[a];return!!(o&i)};i.prototype.imaskn=function t(e){n(typeof e==="number"&&e>=0);var r=e%26;var a=(e-r)/26;n(this.negative===0,"imaskn works only with positive numbers");if(this.length<=a){return this}if(r!==0){a++}this.length=Math.min(a,this.length);if(r!==0){var i=67108863^67108863>>>r<<r;this.words[this.length-1]&=i}return this.strip()};i.prototype.maskn=function t(e){return this.clone().imaskn(e)};i.prototype.iaddn=function t(e){n(typeof e==="number");n(e<67108864);if(e<0)return this.isubn(-e);if(this.negative!==0){if(this.length===1&&(this.words[0]|0)<e){this.words[0]=e-(this.words[0]|0);this.negative=0;return this}this.negative=0;this.isubn(e);this.negative=1;return this}return this._iaddn(e)};i.prototype._iaddn=function t(e){this.words[0]+=e;for(var r=0;r<this.length&&this.words[r]>=67108864;r++){this.words[r]-=67108864;if(r===this.length-1){this.words[r+1]=1}else{this.words[r+1]++}}this.length=Math.max(this.length,r+1);return this};i.prototype.isubn=function t(e){n(typeof e==="number");n(e<67108864);if(e<0)return this.iaddn(-e);if(this.negative!==0){this.negative=0;this.iaddn(e);this.negative=1;return this}this.words[0]-=e;if(this.length===1&&this.words[0]<0){this.words[0]=-this.words[0];this.negative=1}else{for(var r=0;r<this.length&&this.words[r]<0;r++){this.words[r]+=67108864;this.words[r+1]-=1}}return this.strip()};i.prototype.addn=function t(e){return this.clone().iaddn(e)};i.prototype.subn=function t(e){return this.clone().isubn(e)};i.prototype.iabs=function t(){this.negative=0;return this};i.prototype.abs=function t(){return this.clone().iabs()};i.prototype._ishlnsubmul=function t(e,r,a){var i=e.length+a;var o;this._expand(i);var s;var l=0;for(o=0;o<e.length;o++){s=(this.words[o+a]|0)+l;var u=(e.words[o]|0)*r;s-=u&67108863;l=(s>>26)-(u/67108864|0);this.words[o+a]=s&67108863}for(;o<this.length-a;o++){s=(this.words[o+a]|0)+l;l=s>>26;this.words[o+a]=s&67108863}if(l===0)return this.strip();n(l===-1);l=0;for(o=0;o<this.length;o++){s=-(this.words[o]|0)+l;l=s>>26;this.words[o]=s&67108863}this.negative=1;return this.strip()};i.prototype._wordDiv=function t(e,r){var n=this.length-e.length;var a=this.clone();var o=e;var s=o.words[o.length-1]|0;var l=this._countBits(s);n=26-l;if(n!==0){o=o.ushln(n);a.iushln(n);s=o.words[o.length-1]|0}var u=a.length-o.length;var c;if(r!=="mod"){c=new i(null);c.length=u+1;c.words=new Array(c.length);for(var f=0;f<c.length;f++){c.words[f]=0}}var h=a.clone()._ishlnsubmul(o,1,u);if(h.negative===0){a=h;if(c){c.words[u]=1}}for(var p=u-1;p>=0;p--){var d=(a.words[o.length+p]|0)*67108864+(a.words[o.length+p-1]|0);d=Math.min(d/s|0,67108863);a._ishlnsubmul(o,d,p);while(a.negative!==0){d--;a.negative=0;a._ishlnsubmul(o,1,p);if(!a.isZero()){a.negative^=1}}if(c){c.words[p]=d}}if(c){c.strip()}a.strip();if(r!=="div"&&n!==0){a.iushrn(n)}return{div:c||null,mod:a}};i.prototype.divmod=function t(e,r,a){n(!e.isZero());if(this.isZero()){return{div:new i(0),mod:new i(0)}}var o,s,l;if(this.negative!==0&&e.negative===0){l=this.neg().divmod(e,r);if(r!=="mod"){o=l.div.neg()}if(r!=="div"){s=l.mod.neg();if(a&&s.negative!==0){s.iadd(e)}}return{div:o,mod:s}}if(this.negative===0&&e.negative!==0){l=this.divmod(e.neg(),r);if(r!=="mod"){o=l.div.neg()}return{div:o,mod:l.mod}}if((this.negative&e.negative)!==0){l=this.neg().divmod(e.neg(),r);if(r!=="div"){s=l.mod.neg();if(a&&s.negative!==0){s.isub(e)}}return{div:l.div,mod:s}}if(e.length>this.length||this.cmp(e)<0){return{div:new i(0),mod:this}}if(e.length===1){if(r==="div"){return{div:this.divn(e.words[0]),mod:null}}if(r==="mod"){return{div:null,mod:new i(this.modn(e.words[0]))}}return{div:this.divn(e.words[0]),mod:new i(this.modn(e.words[0]))}}return this._wordDiv(e,r)};i.prototype.div=function t(e){return this.divmod(e,"div",false).div};i.prototype.mod=function t(e){return this.divmod(e,"mod",false).mod};i.prototype.umod=function t(e){return this.divmod(e,"mod",true).mod};i.prototype.divRound=function t(e){var r=this.divmod(e);if(r.mod.isZero())return r.div;var n=r.div.negative!==0?r.mod.isub(e):r.mod;var a=e.ushrn(1);var i=e.andln(1);var o=n.cmp(a);if(o<0||i===1&&o===0)return r.div;return r.div.negative!==0?r.div.isubn(1):r.div.iaddn(1)};i.prototype.modn=function t(e){n(e<=67108863);var r=(1<<26)%e;var a=0;for(var i=this.length-1;i>=0;i--){a=(r*a+(this.words[i]|0))%e}return a};i.prototype.idivn=function t(e){n(e<=67108863);var r=0;for(var a=this.length-1;a>=0;a--){var i=(this.words[a]|0)+r*67108864;this.words[a]=i/e|0;r=i%e}return this.strip()};i.prototype.divn=function t(e){return this.clone().idivn(e)};i.prototype.egcd=function t(e){n(e.negative===0);n(!e.isZero());var r=this;var a=e.clone();if(r.negative!==0){r=r.umod(e)}else{r=r.clone()}var o=new i(1);var s=new i(0);var l=new i(0);var u=new i(1);var c=0;while(r.isEven()&&a.isEven()){r.iushrn(1);a.iushrn(1);++c}var f=a.clone();var h=r.clone();while(!r.isZero()){for(var p=0,d=1;(r.words[0]&d)===0&&p<26;++p,d<<=1);if(p>0){r.iushrn(p);while(p-- >0){if(o.isOdd()||s.isOdd()){o.iadd(f);s.isub(h)}o.iushrn(1);s.iushrn(1)}}for(var v=0,g=1;(a.words[0]&g)===0&&v<26;++v,g<<=1);if(v>0){a.iushrn(v);while(v-- >0){if(l.isOdd()||u.isOdd()){l.iadd(f);u.isub(h)}l.iushrn(1);u.iushrn(1)}}if(r.cmp(a)>=0){r.isub(a);o.isub(l);s.isub(u)}else{a.isub(r);l.isub(o);u.isub(s)}}return{a:l,b:u,gcd:a.iushln(c)}};i.prototype._invmp=function t(e){n(e.negative===0);n(!e.isZero());var r=this;var a=e.clone();if(r.negative!==0){r=r.umod(e)}else{r=r.clone()}var o=new i(1);var s=new i(0);var l=a.clone();while(r.cmpn(1)>0&&a.cmpn(1)>0){for(var u=0,c=1;(r.words[0]&c)===0&&u<26;++u,c<<=1);if(u>0){r.iushrn(u);while(u-- >0){if(o.isOdd()){o.iadd(l)}o.iushrn(1)}}for(var f=0,h=1;(a.words[0]&h)===0&&f<26;++f,h<<=1);if(f>0){a.iushrn(f);while(f-- >0){if(s.isOdd()){s.iadd(l)}s.iushrn(1)}}if(r.cmp(a)>=0){r.isub(a);o.isub(s)}else{a.isub(r);s.isub(o)}}var p;if(r.cmpn(1)===0){p=o}else{p=s}if(p.cmpn(0)<0){p.iadd(e)}return p};i.prototype.gcd=function t(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var r=this.clone();var n=e.clone();r.negative=0;n.negative=0;for(var a=0;r.isEven()&&n.isEven();a++){r.iushrn(1);n.iushrn(1)}do{while(r.isEven()){r.iushrn(1)}while(n.isEven()){n.iushrn(1)}var i=r.cmp(n);if(i<0){var o=r;r=n;n=o}else if(i===0||n.cmpn(1)===0){break}r.isub(n)}while(true);return n.iushln(a)};i.prototype.invm=function t(e){return this.egcd(e).a.umod(e)};i.prototype.isEven=function t(){return(this.words[0]&1)===0};i.prototype.isOdd=function t(){return(this.words[0]&1)===1};i.prototype.andln=function t(e){return this.words[0]&e};i.prototype.bincn=function t(e){n(typeof e==="number");var r=e%26;var a=(e-r)/26;var i=1<<r;if(this.length<=a){this._expand(a+1);this.words[a]|=i;return this}var o=i;for(var s=a;o!==0&&s<this.length;s++){var l=this.words[s]|0;l+=o;o=l>>>26;l&=67108863;this.words[s]=l}if(o!==0){this.words[s]=o;this.length++}return this};i.prototype.isZero=function t(){return this.length===1&&this.words[0]===0};i.prototype.cmpn=function t(e){var r=e<0;if(this.negative!==0&&!r)return-1;if(this.negative===0&&r)return 1;this.strip();var a;if(this.length>1){a=1}else{if(r){e=-e}n(e<=67108863,"Number is too big");var i=this.words[0]|0;a=i===e?0:i<e?-1:1}if(this.negative!==0)return-a|0;return a};i.prototype.cmp=function t(e){if(this.negative!==0&&e.negative===0)return-1;if(this.negative===0&&e.negative!==0)return 1;var r=this.ucmp(e);if(this.negative!==0)return-r|0;return r};i.prototype.ucmp=function t(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;var r=0;for(var n=this.length-1;n>=0;n--){var a=this.words[n]|0;var i=e.words[n]|0;if(a===i)continue;if(a<i){r=-1}else if(a>i){r=1}break}return r};i.prototype.gtn=function t(e){return this.cmpn(e)===1};i.prototype.gt=function t(e){return this.cmp(e)===1};i.prototype.gten=function t(e){return this.cmpn(e)>=0};i.prototype.gte=function t(e){return this.cmp(e)>=0};i.prototype.ltn=function t(e){return this.cmpn(e)===-1};i.prototype.lt=function t(e){return this.cmp(e)===-1};i.prototype.lten=function t(e){return this.cmpn(e)<=0};i.prototype.lte=function t(e){return this.cmp(e)<=0};i.prototype.eqn=function t(e){return this.cmpn(e)===0};i.prototype.eq=function t(e){return this.cmp(e)===0};i.red=function t(e){return new M(e)};i.prototype.toRed=function t(e){n(!this.red,"Already a number in reduction context");n(this.negative===0,"red works only with positives");return e.convertTo(this)._forceRed(e)};i.prototype.fromRed=function t(){n(this.red,"fromRed works only with numbers in reduction context");return this.red.convertFrom(this)};i.prototype._forceRed=function t(e){this.red=e;return this};i.prototype.forceRed=function t(e){n(!this.red,"Already a number in reduction context");return this._forceRed(e)};i.prototype.redAdd=function t(e){n(this.red,"redAdd works only with red numbers");return this.red.add(this,e)};i.prototype.redIAdd=function t(e){n(this.red,"redIAdd works only with red numbers");return this.red.iadd(this,e)};i.prototype.redSub=function t(e){n(this.red,"redSub works only with red numbers");return this.red.sub(this,e)};i.prototype.redISub=function t(e){n(this.red,"redISub works only with red numbers");return this.red.isub(this,e)};i.prototype.redShl=function t(e){n(this.red,"redShl works only with red numbers");return this.red.shl(this,e)};i.prototype.redMul=function t(e){n(this.red,"redMul works only with red numbers");this.red._verify2(this,e);return this.red.mul(this,e)};i.prototype.redIMul=function t(e){n(this.red,"redMul works only with red numbers");this.red._verify2(this,e);return this.red.imul(this,e)};i.prototype.redSqr=function t(){n(this.red,"redSqr works only with red numbers");this.red._verify1(this);return this.red.sqr(this)};i.prototype.redISqr=function t(){n(this.red,"redISqr works only with red numbers");this.red._verify1(this);return this.red.isqr(this)};i.prototype.redSqrt=function t(){n(this.red,"redSqrt works only with red numbers");this.red._verify1(this);return this.red.sqrt(this)};i.prototype.redInvm=function t(){n(this.red,"redInvm works only with red numbers");this.red._verify1(this);return this.red.invm(this)};i.prototype.redNeg=function t(){n(this.red,"redNeg works only with red numbers");this.red._verify1(this);return this.red.neg(this)};i.prototype.redPow=function t(e){n(this.red&&!e.red,"redPow(normalNum)");this.red._verify1(this);return this.red.pow(this,e)};var y={k256:null,p224:null,p192:null,p25519:null};function x(t,e){this.name=t;this.p=new i(e,16);this.n=this.p.bitLength();this.k=new i(1).iushln(this.n).isub(this.p);this.tmp=this._tmp()}x.prototype._tmp=function t(){var e=new i(null);e.words=new Array(Math.ceil(this.n/13));return e};x.prototype.ireduce=function t(e){var r=e;var n;do{this.split(r,this.tmp);r=this.imulK(r);r=r.iadd(this.tmp);n=r.bitLength()}while(n>this.n);var a=n<this.n?-1:r.ucmp(this.p);if(a===0){r.words[0]=0;r.length=1}else if(a>0){r.isub(this.p)}else{r.strip()}return r};x.prototype.split=function t(e,r){e.iushrn(this.n,0,r)};x.prototype.imulK=function t(e){return e.imul(this.k)};function b(){x.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(b,x);b.prototype.split=function t(e,r){var n=4194303;var a=Math.min(e.length,9);for(var i=0;i<a;i++){r.words[i]=e.words[i]}r.length=a;if(e.length<=9){e.words[0]=0;e.length=1;return}var o=e.words[9];r.words[r.length++]=o&n;for(i=10;i<e.length;i++){var s=e.words[i]|0;e.words[i-10]=(s&n)<<4|o>>>22;o=s}o>>>=22;e.words[i-10]=o;if(o===0&&e.length>10){e.length-=10}else{e.length-=9}};b.prototype.imulK=function t(e){e.words[e.length]=0;e.words[e.length+1]=0;e.length+=2;var r=0;for(var n=0;n<e.length;n++){var a=e.words[n]|0;r+=a*977;e.words[n]=r&67108863;r=a*64+(r/67108864|0)}if(e.words[e.length-1]===0){e.length--;if(e.words[e.length-1]===0){e.length--}}return e};function _(){x.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(_,x);function w(){x.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(w,x);function k(){x.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(k,x);k.prototype.imulK=function t(e){var r=0;for(var n=0;n<e.length;n++){var a=(e.words[n]|0)*19+r;var i=a&67108863;a>>>=26;e.words[n]=i;r=a}if(r!==0){e.words[e.length++]=r}return e};i._prime=function t(e){if(y[e])return y[e];var t;if(e==="k256"){t=new b}else if(e==="p224"){t=new _}else if(e==="p192"){t=new w}else if(e==="p25519"){t=new k}else{throw new Error("Unknown prime "+e)}y[e]=t;return t};function M(t){if(typeof t==="string"){var e=i._prime(t);this.m=e.p;this.prime=e}else{n(t.gtn(1),"modulus must be greater than 1");this.m=t;this.prime=null}}M.prototype._verify1=function t(e){n(e.negative===0,"red works only with positives");n(e.red,"red works only with red numbers")};M.prototype._verify2=function t(e,r){n((e.negative|r.negative)===0,"red works only with positives");n(e.red&&e.red===r.red,"red works only with red numbers")};M.prototype.imod=function t(e){if(this.prime)return this.prime.ireduce(e)._forceRed(this);return e.umod(this.m)._forceRed(this)};M.prototype.neg=function t(e){if(e.isZero()){return e.clone()}return this.m.sub(e)._forceRed(this)};M.prototype.add=function t(e,r){this._verify2(e,r);var n=e.add(r);if(n.cmp(this.m)>=0){n.isub(this.m)}return n._forceRed(this)};M.prototype.iadd=function t(e,r){this._verify2(e,r);var n=e.iadd(r);if(n.cmp(this.m)>=0){n.isub(this.m)}return n};M.prototype.sub=function t(e,r){this._verify2(e,r);var n=e.sub(r);if(n.cmpn(0)<0){n.iadd(this.m)}return n._forceRed(this)};M.prototype.isub=function t(e,r){this._verify2(e,r);var n=e.isub(r);if(n.cmpn(0)<0){n.iadd(this.m)}return n};M.prototype.shl=function t(e,r){this._verify1(e);return this.imod(e.ushln(r))};M.prototype.imul=function t(e,r){this._verify2(e,r);return this.imod(e.imul(r))};M.prototype.mul=function t(e,r){this._verify2(e,r);return this.imod(e.mul(r))};M.prototype.isqr=function t(e){return this.imul(e,e.clone())};M.prototype.sqr=function t(e){return this.mul(e,e)};M.prototype.sqrt=function t(e){if(e.isZero())return e.clone();var r=this.m.andln(3);n(r%2===1);if(r===3){var a=this.m.add(new i(1)).iushrn(2);return this.pow(e,a)}var o=this.m.subn(1);var s=0;while(!o.isZero()&&o.andln(1)===0){s++;o.iushrn(1)}n(!o.isZero());var l=new i(1).toRed(this);var u=l.redNeg();var c=this.m.subn(1).iushrn(1);var f=this.m.bitLength();f=new i(2*f*f).toRed(this);while(this.pow(f,c).cmp(u)!==0){f.redIAdd(u)}var h=this.pow(f,o);var p=this.pow(e,o.addn(1).iushrn(1));var d=this.pow(e,o);var v=s;while(d.cmp(l)!==0){var g=d;for(var m=0;g.cmp(l)!==0;m++){g=g.redSqr()}n(m<v);var y=this.pow(h,new i(1).iushln(v-m-1));p=p.redMul(y);h=y.redSqr();d=d.redMul(h);v=m}return p};M.prototype.invm=function t(e){var r=e._invmp(this.m);if(r.negative!==0){r.negative=0;return this.imod(r).redNeg()}else{return this.imod(r)}};M.prototype.pow=function t(e,r){if(r.isZero())return new i(1).toRed(this);if(r.cmpn(1)===0)return e.clone();var n=4;var a=new Array(1<<n);a[0]=new i(1).toRed(this);a[1]=e;for(var o=2;o<a.length;o++){a[o]=this.mul(a[o-1],e)}var s=a[0];var l=0;var u=0;var c=r.bitLength()%26;if(c===0){c=26}for(o=r.length-1;o>=0;o--){var f=r.words[o];for(var h=c-1;h>=0;h--){var p=f>>h&1;if(s!==a[0]){s=this.sqr(s)}if(p===0&&l===0){u=0;continue}l<<=1;l|=p;u++;if(u!==n&&(o!==0||h!==0))continue;s=this.mul(s,a[l]);u=0;l=0}c=26}return s};M.prototype.convertTo=function t(e){var r=e.umod(this.m);return r===e?r.clone():r};M.prototype.convertFrom=function t(e){var r=e.clone();r.red=null;return r};i.mont=function t(e){return new A(e)};function A(t){M.call(this,t);this.shift=this.m.bitLength();if(this.shift%26!==0){this.shift+=26-this.shift%26}this.r=new i(1).iushln(this.shift);this.r2=this.imod(this.r.sqr());this.rinv=this.r._invmp(this.m);this.minv=this.rinv.mul(this.r).isubn(1).div(this.m);this.minv=this.minv.umod(this.r);this.minv=this.r.sub(this.minv)}a(A,M);A.prototype.convertTo=function t(e){return this.imod(e.ushln(this.shift))};A.prototype.convertFrom=function t(e){var r=this.imod(e.mul(this.rinv));r.red=null;return r};A.prototype.imul=function t(e,r){if(e.isZero()||r.isZero()){e.words[0]=0;e.length=1;return e}var n=e.imul(r);var a=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var i=n.isub(a).iushrn(this.shift);var o=i;if(i.cmp(this.m)>=0){o=i.isub(this.m)}else if(i.cmpn(0)<0){o=i.iadd(this.m)}return o._forceRed(this)};A.prototype.mul=function t(e,r){if(e.isZero()||r.isZero())return new i(0)._forceRed(this);var n=e.mul(r);var a=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var o=n.isub(a).iushrn(this.shift);var s=o;if(o.cmp(this.m)>=0){s=o.isub(this.m)}else if(o.cmpn(0)<0){s=o.iadd(this.m)}return s._forceRed(this)};A.prototype.invm=function t(e){var r=this.imod(e._invmp(this.m).mul(this.r2));return r._forceRed(this)}})(typeof e==="undefined"||e,this)},{buffer:91}],83:[function(t,e,r){"use strict";e.exports=n;function n(t){var e,r,n;var a=t.length;var i=0;for(e=0;e<a;++e){i+=t[e].length}var o=new Array(i);var s=0;for(e=0;e<a;++e){var l=t[e];var u=l.length;for(r=0;r<u;++r){var c=o[s++]=new Array(u-1);var f=0;for(n=0;n<u;++n){if(n===r){continue}c[f++]=l[n]}if(r&1){var h=c[1];c[1]=c[0];c[0]=h}}}return o}},{}],84:[function(t,e,r){"use strict";e.exports=p;var n=t("typedarray-pool");var a=t("./lib/sweep");var i=t("./lib/intersect");function o(t,e){for(var r=0;r<t;++r){if(!(e[r]<=e[r+t])){return true}}return false}function s(t,e,r,n){var a=0;var i=0;for(var s=0,l=t.length;s<l;++s){var u=t[s];if(o(e,u)){continue}for(var c=0;c<2*e;++c){r[a++]=u[c]}n[i++]=s}return i}function l(t,e,r,o){var l=t.length;var u=e.length;if(l<=0||u<=0){return}var c=t[0].length>>>1;if(c<=0){return}var f;var h=n.mallocDouble(2*c*l);var p=n.mallocInt32(l);l=s(t,c,h,p);if(l>0){if(c===1&&o){a.init(l);f=a.sweepComplete(c,r,0,l,h,p,0,l,h,p)}else{var d=n.mallocDouble(2*c*u);var v=n.mallocInt32(u);u=s(e,c,d,v);if(u>0){a.init(l+u);if(c===1){f=a.sweepBipartite(c,r,0,l,h,p,0,u,d,v)}else{f=i(c,r,o,l,h,p,u,d,v)}n.free(d);n.free(v)}}n.free(h);n.free(p)}return f}var u;function c(t,e){u.push([t,e])}function f(t){u=[];l(t,t,c,true);return u}function h(t,e){u=[];l(t,e,c,false);return u}function p(t,e,r){var n;switch(arguments.length){case 1:return f(t);case 2:if(typeof e==="function"){return l(t,t,e,true)}else{return h(t,e)}case 3:return l(t,e,r,false);default:throw new Error("box-intersect: Invalid arguments")}}},{"./lib/intersect":86,"./lib/sweep":90,"typedarray-pool":507}],85:[function(t,e,r){"use strict";var n="d";var a="ax";var i="vv";var o="fp";var s="es";var l="rs";var u="re";var c="rb";var f="ri";var h="rp";var p="bs";var d="be";var v="bb";var g="bi";var m="bp";var y="rv";var x="Q";var b=[n,a,i,l,u,c,f,p,d,v,g];function _(t,e,r){var o="bruteForce"+(t?"Red":"Blue")+(e?"Flip":"")+(r?"Full":"");var _=["function ",o,"(",b.join(),"){","var ",s,"=2*",n,";"];var w="for(var i="+l+","+h+"="+s+"*"+l+";"+"i<"+u+";"+"++i,"+h+"+="+s+"){"+"var x0="+c+"["+a+"+"+h+"],"+"x1="+c+"["+a+"+"+h+"+"+n+"],"+"xi="+f+"[i];";var k="for(var j="+p+","+m+"="+s+"*"+p+";"+"j<"+d+";"+"++j,"+m+"+="+s+"){"+"var y0="+v+"["+a+"+"+m+"],"+(r?"y1="+v+"["+a+"+"+m+"+"+n+"],":"")+"yi="+g+"[j];";if(t){_.push(w,x,":",k)}else{_.push(k,x,":",w)}if(r){_.push("if(y1<x0||x1<y0)continue;")}else if(e){_.push("if(y0<=x0||x1<y0)continue;")}else{_.push("if(y0<x0||x1<y0)continue;")}_.push("for(var k="+a+"+1;k<"+n+";++k){"+"var r0="+c+"[k+"+h+"],"+"r1="+c+"[k+"+n+"+"+h+"],"+"b0="+v+"[k+"+m+"],"+"b1="+v+"[k+"+n+"+"+m+"];"+"if(r1<b0||b1<r0)continue "+x+";}"+"var "+y+"="+i+"(");if(e){_.push("yi,xi")}else{_.push("xi,yi")}_.push(");if("+y+"!==void 0)return "+y+";}}}");return{name:o,code:_.join("")}}function w(t){var e="bruteForce"+(t?"Full":"Partial");var r=[];var n=b.slice();if(!t){n.splice(3,0,o)}var a=["function "+e+"("+n.join()+"){"];function i(e,n){var i=_(e,n,t);r.push(i.code);a.push("return "+i.name+"("+b.join()+");")}a.push("if("+u+"-"+l+">"+d+"-"+p+"){");if(t){i(true,false);a.push("}else{");i(false,false)}else{a.push("if("+o+"){");i(true,true);a.push("}else{");i(true,false);a.push("}}else{if("+o+"){");i(false,true);a.push("}else{");i(false,false);a.push("}")}a.push("}}return "+e);var s=r.join("")+a.join("");var c=new Function(s);return c()}r.partial=w(false);r.full=w(true)},{}],86:[function(t,e,r){"use strict";e.exports=C;var n=t("typedarray-pool");var a=t("bit-twiddle");var i=t("./brute");var o=i.partial;var s=i.full;var l=t("./sweep");var u=t("./median");var c=t("./partition");var f=128;var h=1<<22;var p=1<<22;var d=c("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]);var v=c("lo===p0",["p0"]);var g=c("lo<p0",["p0"]);var m=c("hi<=p0",["p0"]);var y=c("lo<=p0&&p0<=hi",["p0"]);var x=c("lo<p0&&p0<=hi",["p0"]);var b=6;var _=2;var w=1024;var k=n.mallocInt32(w);var M=n.mallocDouble(w);function A(t,e){var r=8*a.log2(e+1)*(t+1)|0;var i=a.nextPow2(b*r);if(k.length<i){n.free(k);k=n.mallocInt32(i)}var o=a.nextPow2(_*r);if(M<o){n.free(M);M=n.mallocDouble(o)}}function T(t,e,r,n,a,i,o,s,l){var u=b*t;k[u]=e;k[u+1]=r;k[u+2]=n;k[u+3]=a;k[u+4]=i;k[u+5]=o;var c=_*t;M[c]=s;M[c+1]=l}function S(t,e,r,n,a,i,o,s,l,u,c){var f=2*t;var h=l*f;var p=u[h+e];t:for(var d=a,v=a*f;d<i;++d,v+=f){var g=o[v+e];var m=o[v+e+t];if(p<g||m<p){continue}if(n&&p===g){continue}var y=s[d];for(var x=e+1;x<t;++x){var g=o[v+x];var m=o[v+x+t];var b=u[h+x];var _=u[h+x+t];if(m<b||_<g){continue t}}var w;if(n){w=r(c,y)}else{w=r(y,c)}if(w!==void 0){return w}}}function E(t,e,r,n,a,i,o,s,l,u){var c=2*t;var f=s*c;var h=l[f+e];t:for(var p=n,d=n*c;p<a;++p,d+=c){var v=o[p];if(v===u){continue}var g=i[d+e];var m=i[d+e+t];if(h<g||m<h){continue}for(var y=e+1;y<t;++y){var g=i[d+y];var m=i[d+y+t];var x=l[f+y];var b=l[f+y+t];if(m<x||b<g){continue t}}var _=r(v,u);if(_!==void 0){return _}}}function C(t,e,r,n,a,i,c,w,C){A(t,n+c);var L=0;var I=2*t;var z;T(L++,0,0,n,0,c,r?16:0,-Infinity,Infinity);if(!r){T(L++,0,0,c,0,n,1,-Infinity,Infinity)}while(L>0){L-=1;var P=L*b;var O=k[P];var D=k[P+1];var R=k[P+2];var B=k[P+3];var F=k[P+4];var N=k[P+5];var j=L*_;var V=M[j];var U=M[j+1];var q=N&1;var H=!!(N&16);var G=a;var W=i;var Y=w;var X=C;if(q){G=w;W=C;Y=a;X=i}if(N&2){R=g(t,O,D,R,G,W,U);if(D>=R){continue}}if(N&4){D=m(t,O,D,R,G,W,V);if(D>=R){continue}}var Z=R-D;var $=F-B;if(H){if(t*Z*(Z+$)<p){z=l.scanComplete(t,O,e,D,R,G,W,B,F,Y,X);if(z!==void 0){return z}continue}}else{if(t*Math.min(Z,$)<f){z=o(t,O,e,q,D,R,G,W,B,F,Y,X);if(z!==void 0){return z}continue}else if(t*Z*$<h){z=l.scanBipartite(t,O,e,q,D,R,G,W,B,F,Y,X);if(z!==void 0){return z}continue}}var J=d(t,O,D,R,G,W,V,U);if(D<J){if(t*(J-D)<f){z=s(t,O+1,e,D,J,G,W,B,F,Y,X);if(z!==void 0){return z}}else if(O===t-2){if(q){z=l.sweepBipartite(t,e,B,F,Y,X,D,J,G,W)}else{z=l.sweepBipartite(t,e,D,J,G,W,B,F,Y,X)}if(z!==void 0){return z}}else{T(L++,O+1,D,J,B,F,q,-Infinity,Infinity);T(L++,O+1,B,F,D,J,q^1,-Infinity,Infinity)}}if(J<R){var K=u(t,O,B,F,Y,X);var Q=Y[I*K+O];var tt=v(t,O,K,F,Y,X,Q);if(tt<F){T(L++,O,J,R,tt,F,(q|4)+(H?16:0),Q,U)}if(B<K){T(L++,O,J,R,B,K,(q|2)+(H?16:0),V,Q)}if(K+1===tt){if(H){z=E(t,O,e,J,R,G,W,K,Y,X[K])}else{z=S(t,O,e,q,J,R,G,W,K,Y,X[K])}if(z!==void 0){return z}}else if(K<tt){var et;if(H){et=y(t,O,J,R,G,W,Q);if(J<et){var rt=v(t,O,J,et,G,W,Q);if(O===t-2){if(J<rt){z=l.sweepComplete(t,e,J,rt,G,W,K,tt,Y,X);if(z!==void 0){return z}}if(rt<et){z=l.sweepBipartite(t,e,rt,et,G,W,K,tt,Y,X);if(z!==void 0){return z}}}else{if(J<rt){T(L++,O+1,J,rt,K,tt,16,-Infinity,Infinity)}if(rt<et){T(L++,O+1,rt,et,K,tt,0,-Infinity,Infinity);T(L++,O+1,K,tt,rt,et,1,-Infinity,Infinity)}}}}else{if(q){et=x(t,O,J,R,G,W,Q)}else{et=y(t,O,J,R,G,W,Q)}if(J<et){if(O===t-2){if(q){z=l.sweepBipartite(t,e,K,tt,Y,X,J,et,G,W)}else{z=l.sweepBipartite(t,e,J,et,G,W,K,tt,Y,X)}}else{T(L++,O+1,J,et,K,tt,q,-Infinity,Infinity);T(L++,O+1,K,tt,J,et,q^1,-Infinity,Infinity)}}}}}}}},{"./brute":85,"./median":87,"./partition":88,"./sweep":90,"bit-twiddle":80,"typedarray-pool":507}],87:[function(t,e,r){"use strict";e.exports=s;var n=t("./partition");var a=n("lo<p0",["p0"]);var i=8;function o(t,e,r,n,a,i){var o=2*t;var s=o*(r+1)+e;for(var l=r+1;l<n;++l,s+=o){var u=a[s];for(var c=l,f=o*(l-1);c>r&&a[f+e]>u;--c,f-=o){var h=f;var p=f+o;for(var d=0;d<o;++d,++h,++p){var v=a[h];a[h]=a[p];a[p]=v}var g=i[c];i[c]=i[c-1];i[c-1]=g}}}function s(t,e,r,n,s,l){if(n<=r+1){return r}var u=r;var c=n;var f=n+r>>>1;var h=2*t;var p=f;var d=s[h*f+e];while(u<c){if(c-u<i){o(t,e,u,c,s,l);d=s[h*f+e];break}var v=c-u;var g=Math.random()*v+u|0;var m=s[h*g+e];var y=Math.random()*v+u|0;var x=s[h*y+e];var b=Math.random()*v+u|0;var _=s[h*b+e];if(m<=x){if(_>=x){p=y;d=x}else if(m>=_){p=g;d=m}else{p=b;d=_}}else{if(x>=_){p=y;d=x}else if(_>=m){p=g;d=m}else{p=b;d=_}}var w=h*(c-1);var k=h*p;for(var M=0;M<h;++M,++w,++k){var A=s[w];s[w]=s[k];s[k]=A}var T=l[c-1];l[c-1]=l[p];l[p]=T;p=a(t,e,u,c-1,s,l,d);var w=h*(c-1);var k=h*p;for(var M=0;M<h;++M,++w,++k){var A=s[w];s[w]=s[k];s[k]=A}var T=l[c-1];l[c-1]=l[p];l[p]=T;if(f<p){c=p-1;while(u<c&&s[h*(c-1)+e]===d){c-=1}c+=1}else if(p<f){u=p+1;while(u<c&&s[h*u+e]===d){u+=1}}else{break}}return a(t,e,r,f,s,l,s[h*f+e])}},{"./partition":88}],88:[function(t,e,r){"use strict";e.exports=a;var n="for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m";function a(t,e){var r="abcdef".split("").concat(e);var a=[];if(t.indexOf("lo")>=0){a.push("lo=e[k+n]")}if(t.indexOf("hi")>=0){a.push("hi=e[k+o]")}r.push(n.replace("_",a.join()).replace("$",t));return Function.apply(void 0,r)}},{}],89:[function(t,e,r){"use strict";e.exports=a;var n=32;function a(t,e){if(e<=4*n){i(0,e-1,t)}else{h(0,e-1,t)}}function i(t,e,r){var n=2*(t+1);for(var a=t+1;a<=e;++a){var i=r[n++];var o=r[n++];var s=a;var l=n-2;while(s-- >t){var u=r[l-2];var c=r[l-1];if(u<i){break}else if(u===i&&c<o){break}r[l]=u;r[l+1]=c;l-=2}r[l]=i;r[l+1]=o}}function o(t,e,r){t*=2;e*=2;var n=r[t];var a=r[t+1];r[t]=r[e];r[t+1]=r[e+1];r[e]=n;r[e+1]=a}function s(t,e,r){t*=2;e*=2;r[t]=r[e];r[t+1]=r[e+1]}function l(t,e,r,n){t*=2;e*=2;r*=2;var a=n[t];var i=n[t+1];n[t]=n[e];n[t+1]=n[e+1];n[e]=n[r];n[e+1]=n[r+1];n[r]=a;n[r+1]=i}function u(t,e,r,n,a){t*=2;e*=2;a[t]=a[e];a[e]=r;a[t+1]=a[e+1];a[e+1]=n}function c(t,e,r){t*=2;e*=2;var n=r[t],a=r[e];if(n<a){return false}else if(n===a){return r[t+1]>r[e+1]}return true}function f(t,e,r,n){t*=2;var a=n[t];if(a<e){return true}else if(a===e){return n[t+1]<r}return false}function h(t,e,r){var a=(e-t+1)/6|0,p=t+a,d=e-a,v=t+e>>1,g=v-a,m=v+a,y=p,x=g,b=v,_=m,w=d,k=t+1,M=e-1,A=0;if(c(y,x,r)){A=y;y=x;x=A}if(c(_,w,r)){A=_;_=w;w=A}if(c(y,b,r)){A=y;y=b;b=A}if(c(x,b,r)){A=x;x=b;b=A}if(c(y,_,r)){A=y;y=_;_=A}if(c(b,_,r)){A=b;b=_;_=A}if(c(x,w,r)){A=x;x=w;w=A}if(c(x,b,r)){A=x;x=b;b=A}if(c(_,w,r)){A=_;_=w;w=A}var T=r[2*x];var S=r[2*x+1];var E=r[2*_];var C=r[2*_+1];var L=2*y;var I=2*b;var z=2*w;var P=2*p;var O=2*v;var D=2*d;for(var R=0;R<2;++R){var B=r[L+R];var F=r[I+R];var N=r[z+R];r[P+R]=B;r[O+R]=F;r[D+R]=N}s(g,t,r);s(m,e,r);for(var j=k;j<=M;++j){if(f(j,T,S,r)){if(j!==k){o(j,k,r)}++k}else{if(!f(j,E,C,r)){while(true){if(!f(M,E,C,r)){if(--M<j){break}continue}else{if(f(M,T,S,r)){l(j,k,M,r);++k;--M}else{o(j,M,r);--M}break}}}}}u(t,k-1,T,S,r);u(e,M+1,E,C,r);if(k-2-t<=n){i(t,k-2,r)}else{h(t,k-2,r)}if(e-(M+2)<=n){i(M+2,e,r)}else{h(M+2,e,r)}if(M-k<=n){i(k,M,r)}else{h(k,M,r)}}},{}],90:[function(t,e,r){"use strict";e.exports={init:v,sweepBipartite:y,sweepComplete:x,scanBipartite:b,scanComplete:_};var n=t("typedarray-pool");var a=t("bit-twiddle");var i=t("./sort");var o=1<<28;var s=1024;var l=n.mallocInt32(s);var u=n.mallocInt32(s);var c=n.mallocInt32(s);var f=n.mallocInt32(s);var h=n.mallocInt32(s);var p=n.mallocInt32(s);var d=n.mallocDouble(s*8);function v(t){var e=a.nextPow2(t);if(l.length<e){n.free(l);l=n.mallocInt32(e)}if(u.length<e){n.free(u);u=n.mallocInt32(e)}if(c.length<e){n.free(c);c=n.mallocInt32(e)}if(f.length<e){n.free(f);f=n.mallocInt32(e)}if(h.length<e){n.free(h);h=n.mallocInt32(e)}if(p.length<e){n.free(p);p=n.mallocInt32(e)}var r=8*e;if(d.length<r){n.free(d);d=n.mallocDouble(r)}}function g(t,e,r,n){var a=e[n];var i=t[r-1];t[a]=i;e[i]=a}function m(t,e,r,n){t[r]=n;e[n]=r}function y(t,e,r,n,a,s,h,p,v,y){var x=0;var b=2*t;var _=t-1;var w=b-1;for(var k=r;k<n;++k){var M=s[k];var A=b*k;d[x++]=a[A+_];d[x++]=-(M+1);d[x++]=a[A+w];d[x++]=M}for(var k=h;k<p;++k){var M=y[k]+o;var T=b*k;d[x++]=v[T+_];d[x++]=-M;d[x++]=v[T+w];d[x++]=M}var S=x>>>1;i(d,S);var E=0;var C=0;for(var k=0;k<S;++k){var L=d[2*k+1]|0;if(L>=o){L=L-o|0;g(c,f,C--,L)}else if(L>=0){g(l,u,E--,L)}else if(L<=-o){L=-L-o|0;for(var I=0;I<E;++I){var z=e(l[I],L);if(z!==void 0){return z}}m(c,f,C++,L)}else{L=-L-1|0;for(var I=0;I<C;++I){var z=e(L,c[I]);if(z!==void 0){return z}}m(l,u,E++,L)}}}function x(t,e,r,n,a,o,s,v,y,x){var b=0;var _=2*t;var w=t-1;var k=_-1;for(var M=r;M<n;++M){var A=o[M]+1<<1;var T=_*M;d[b++]=a[T+w];d[b++]=-A;d[b++]=a[T+k];d[b++]=A}for(var M=s;M<v;++M){var A=x[M]+1<<1;var S=_*M;d[b++]=y[S+w];d[b++]=-A|1;d[b++]=y[S+k];d[b++]=A|1}var E=b>>>1;i(d,E);var C=0;var L=0;var I=0;for(var M=0;M<E;++M){var z=d[2*M+1]|0;var P=z&1;if(M<E-1&&z>>1===d[2*M+3]>>1){P=2;M+=1}if(z<0){var O=-(z>>1)-1;for(var D=0;D<I;++D){var R=e(h[D],O);if(R!==void 0){return R}}if(P!==0){for(var D=0;D<C;++D){var R=e(l[D],O);if(R!==void 0){return R}}}if(P!==1){for(var D=0;D<L;++D){var R=e(c[D],O);if(R!==void 0){return R}}}if(P===0){m(l,u,C++,O)}else if(P===1){m(c,f,L++,O)}else if(P===2){m(h,p,I++,O)}}else{var O=(z>>1)-1;if(P===0){g(l,u,C--,O)}else if(P===1){g(c,f,L--,O)}else if(P===2){g(h,p,I--,O)}}}}function b(t,e,r,n,a,s,c,f,h,p,v,y){var x=0;var b=2*t;var _=e;var w=e+t;var k=1;var M=1;if(n){M=o}else{k=o}for(var A=a;A<s;++A){var T=A+k;var S=b*A;d[x++]=c[S+_];d[x++]=-T;d[x++]=c[S+w];d[x++]=T}for(var A=h;A<p;++A){var T=A+M;var E=b*A;d[x++]=v[E+_];d[x++]=-T}var C=x>>>1;i(d,C);var L=0;for(var A=0;A<C;++A){var I=d[2*A+1]|0;if(I<0){var T=-I;var z=false;if(T>=o){z=!n;T-=o}else{z=!!n;T-=1}if(z){m(l,u,L++,T)}else{var P=y[T];var O=b*T;var D=v[O+e+1];var R=v[O+e+1+t];t:for(var B=0;B<L;++B){var F=l[B];var N=b*F;if(R<c[N+e+1]||c[N+e+1+t]<D){continue}for(var j=e+2;j<t;++j){if(v[O+j+t]<c[N+j]||c[N+j+t]<v[O+j]){continue t}}var V=f[F];var U;if(n){U=r(P,V)}else{U=r(V,P)}if(U!==void 0){return U}}}}else{g(l,u,L--,I-k)}}}function _(t,e,r,n,a,s,u,c,f,h,p){var v=0;var g=2*t;var m=e;var y=e+t;for(var x=n;x<a;++x){var b=x+o;var _=g*x;d[v++]=s[_+m];d[v++]=-b;d[v++]=s[_+y];d[v++]=b}for(var x=c;x<f;++x){var b=x+1;var w=g*x;d[v++]=h[w+m];d[v++]=-b}var k=v>>>1;i(d,k);var M=0;for(var x=0;x<k;++x){var A=d[2*x+1]|0;if(A<0){var b=-A;if(b>=o){l[M++]=b-o}else{b-=1;var T=p[b];var S=g*b;var E=h[S+e+1];var C=h[S+e+1+t];t:for(var L=0;L<M;++L){var I=l[L];var z=u[I];if(z===T){break}var P=g*I;if(C<s[P+e+1]||s[P+e+1+t]<E){continue}for(var O=e+2;O<t;++O){if(h[S+O+t]<s[P+O]||s[P+O+t]<h[S+O]){continue t}}var D=r(z,T);if(D!==void 0){return D}}}}else{var b=A-o;for(var L=M-1;L>=0;--L){if(l[L]===b){for(var O=L+1;O<M;++O){l[O-1]=l[O]}break}}--M}}}},{"./sort":89,"bit-twiddle":80,"typedarray-pool":507}],91:[function(t,e,r){},{}],92:[function(t,e,r){"use strict";var n=t("base64-js");var a=t("ieee754");r.Buffer=l;r.SlowBuffer=y;r.INSPECT_MAX_BYTES=50;var i=2147483647;r.kMaxLength=i;l.TYPED_ARRAY_SUPPORT=o();if(!l.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function o(){try{var t=new Uint8Array(1);t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return t.foo()===42}catch(t){return false}}Object.defineProperty(l.prototype,"parent",{get:function(){if(!(this instanceof l)){return undefined}return this.buffer}});Object.defineProperty(l.prototype,"offset",{get:function(){if(!(this instanceof l)){return undefined}return this.byteOffset}});function s(t){if(t>i){throw new RangeError("Invalid typed array length")}var e=new Uint8Array(t);e.__proto__=l.prototype;return e}function l(t,e,r){if(typeof t==="number"){if(typeof e==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return h(t)}return u(t,e,r)}if(typeof Symbol!=="undefined"&&Symbol.species&&l[Symbol.species]===l){Object.defineProperty(l,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}l.poolSize=8192;function u(t,e,r){if(typeof t==="number"){throw new TypeError('"value" argument must not be a number')}if(J(t)||t&&J(t.buffer)){return v(t,e,r)}if(typeof t==="string"){return p(t,e)}return g(t)}l.from=function(t,e,r){return u(t,e,r)};l.prototype.__proto__=Uint8Array.prototype;l.__proto__=Uint8Array;function c(t){if(typeof t!=="number"){throw new TypeError('"size" argument must be of type number')}else if(t<0){throw new RangeError('"size" argument must not be negative')}}function f(t,e,r){c(t);if(t<=0){return s(t)}if(e!==undefined){return typeof r==="string"?s(t).fill(e,r):s(t).fill(e)}return s(t)}l.alloc=function(t,e,r){return f(t,e,r)};function h(t){c(t);return s(t<0?0:m(t)|0)}l.allocUnsafe=function(t){return h(t)};l.allocUnsafeSlow=function(t){return h(t)};function p(t,e){if(typeof e!=="string"||e===""){e="utf8"}if(!l.isEncoding(e)){throw new TypeError("Unknown encoding: "+e)}var r=x(t,e)|0;var n=s(r);var a=n.write(t,e);if(a!==r){n=n.slice(0,a)}return n}function d(t){var e=t.length<0?0:m(t.length)|0;var r=s(e);for(var n=0;n<e;n+=1){r[n]=t[n]&255}return r}function v(t,e,r){if(e<0||t.byteLength<e){throw new RangeError('"offset" is outside of buffer bounds')}if(t.byteLength<e+(r||0)){throw new RangeError('"length" is outside of buffer bounds')}var n;if(e===undefined&&r===undefined){n=new Uint8Array(t)}else if(r===undefined){n=new Uint8Array(t,e)}else{n=new Uint8Array(t,e,r)}n.__proto__=l.prototype;return n}function g(t){if(l.isBuffer(t)){var e=m(t.length)|0;var r=s(e);if(r.length===0){return r}t.copy(r,0,0,e);return r}if(t){if(ArrayBuffer.isView(t)||"length"in t){if(typeof t.length!=="number"||K(t.length)){return s(0)}return d(t)}if(t.type==="Buffer"&&Array.isArray(t.data)){return d(t.data)}}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}function m(t){if(t>=i){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+i.toString(16)+" bytes")}return t|0}function y(t){if(+t!=t){t=0}return l.alloc(+t)}l.isBuffer=function t(e){return e!=null&&e._isBuffer===true};l.compare=function t(e,r){if(!l.isBuffer(e)||!l.isBuffer(r)){throw new TypeError("Arguments must be Buffers")}if(e===r)return 0;var n=e.length;var a=r.length;for(var i=0,o=Math.min(n,a);i<o;++i){if(e[i]!==r[i]){n=e[i];a=r[i];break}}if(n<a)return-1;if(a<n)return 1;return 0};l.isEncoding=function t(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};l.concat=function t(e,r){if(!Array.isArray(e)){throw new TypeError('"list" argument must be an Array of Buffers')}if(e.length===0){return l.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<e.length;++n){r+=e[n].length}}var a=l.allocUnsafe(r);var i=0;for(n=0;n<e.length;++n){var o=e[n];if(ArrayBuffer.isView(o)){o=l.from(o)}if(!l.isBuffer(o)){throw new TypeError('"list" argument must be an Array of Buffers')}o.copy(a,i);i+=o.length}return a};function x(t,e){if(l.isBuffer(t)){return t.length}if(ArrayBuffer.isView(t)||J(t)){return t.byteLength}if(typeof t!=="string"){t=""+t}var r=t.length;if(r===0)return 0;var n=false;for(;;){switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case undefined:return W(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Z(t).length;default:if(n)return W(t).length;e=(""+e).toLowerCase();n=true}}}l.byteLength=x;function b(t,e,r){var n=false;if(e===undefined||e<0){e=0}if(e>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;e>>>=0;if(r<=e){return""}if(!t)t="utf8";while(true){switch(t){case"hex":return R(this,e,r);case"utf8":case"utf-8":return I(this,e,r);case"ascii":return O(this,e,r);case"latin1":case"binary":return D(this,e,r);case"base64":return L(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase();n=true}}}l.prototype._isBuffer=true;function _(t,e,r){var n=t[e];t[e]=t[r];t[r]=n}l.prototype.swap16=function t(){var e=this.length;if(e%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<e;r+=2){_(this,r,r+1)}return this};l.prototype.swap32=function t(){var e=this.length;if(e%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<e;r+=4){_(this,r,r+3);_(this,r+1,r+2)}return this};l.prototype.swap64=function t(){var e=this.length;if(e%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<e;r+=8){_(this,r,r+7);_(this,r+1,r+6);_(this,r+2,r+5);_(this,r+3,r+4)}return this};l.prototype.toString=function t(){var e=this.length;if(e===0)return"";if(arguments.length===0)return I(this,0,e);return b.apply(this,arguments)};l.prototype.toLocaleString=l.prototype.toString;l.prototype.equals=function t(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(this===e)return true;return l.compare(this,e)===0};l.prototype.inspect=function t(){var e="";var n=r.INSPECT_MAX_BYTES;if(this.length>0){e=this.toString("hex",0,n).match(/.{2}/g).join(" ");if(this.length>n)e+=" ... "}return"<Buffer "+e+">"};l.prototype.compare=function t(e,r,n,a,i){if(!l.isBuffer(e)){throw new TypeError("Argument must be a Buffer")}if(r===undefined){r=0}if(n===undefined){n=e?e.length:0}if(a===undefined){a=0}if(i===undefined){i=this.length}if(r<0||n>e.length||a<0||i>this.length){throw new RangeError("out of range index")}if(a>=i&&r>=n){return 0}if(a>=i){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;a>>>=0;i>>>=0;if(this===e)return 0;var o=i-a;var s=n-r;var u=Math.min(o,s);var c=this.slice(a,i);var f=e.slice(r,n);for(var h=0;h<u;++h){if(c[h]!==f[h]){o=c[h];s=f[h];break}}if(o<s)return-1;if(s<o)return 1;return 0};function w(t,e,r,n,a){if(t.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(K(r)){r=a?0:t.length-1}if(r<0)r=t.length+r;if(r>=t.length){if(a)return-1;else r=t.length-1}else if(r<0){if(a)r=0;else return-1}if(typeof e==="string"){e=l.from(e,n)}if(l.isBuffer(e)){if(e.length===0){return-1}return k(t,e,r,n,a)}else if(typeof e==="number"){e=e&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(a){return Uint8Array.prototype.indexOf.call(t,e,r)}else{return Uint8Array.prototype.lastIndexOf.call(t,e,r)}}return k(t,[e],r,n,a)}throw new TypeError("val must be string, number or Buffer")}function k(t,e,r,n,a){var i=1;var o=t.length;var s=e.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(t.length<2||e.length<2){return-1}i=2;o/=2;s/=2;r/=2}}function l(t,e){if(i===1){return t[e]}else{return t.readUInt16BE(e*i)}}var u;if(a){var c=-1;for(u=r;u<o;u++){if(l(t,u)===l(e,c===-1?0:u-c)){if(c===-1)c=u;if(u-c+1===s)return c*i}else{if(c!==-1)u-=u-c;c=-1}}}else{if(r+s>o)r=o-s;for(u=r;u>=0;u--){var f=true;for(var h=0;h<s;h++){if(l(t,u+h)!==l(e,h)){f=false;break}}if(f)return u}}return-1}l.prototype.includes=function t(e,r,n){return this.indexOf(e,r,n)!==-1};l.prototype.indexOf=function t(e,r,n){return w(this,e,r,n,true)};l.prototype.lastIndexOf=function t(e,r,n){return w(this,e,r,n,false)};function M(t,e,r,n){r=Number(r)||0;var a=t.length-r;if(!n){n=a}else{n=Number(n);if(n>a){n=a}}var i=e.length;if(n>i/2){n=i/2}for(var o=0;o<n;++o){var s=parseInt(e.substr(o*2,2),16);if(K(s))return o;t[r+o]=s}return o}function A(t,e,r,n){return $(W(e,t.length-r),t,r,n)}function T(t,e,r,n){return $(Y(e),t,r,n)}function S(t,e,r,n){return T(t,e,r,n)}function E(t,e,r,n){return $(Z(e),t,r,n)}function C(t,e,r,n){return $(X(e,t.length-r),t,r,n)}l.prototype.write=function t(e,r,n,a){if(r===undefined){a="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){a=r;n=this.length;r=0}else if(isFinite(r)){r=r>>>0;if(isFinite(n)){n=n>>>0;if(a===undefined)a="utf8"}else{a=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var i=this.length-r;if(n===undefined||n>i)n=i;if(e.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!a)a="utf8";var o=false;for(;;){switch(a){case"hex":return M(this,e,r,n);case"utf8":case"utf-8":return A(this,e,r,n);case"ascii":return T(this,e,r,n);case"latin1":case"binary":return S(this,e,r,n);case"base64":return E(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,r,n);default:if(o)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase();o=true}}};l.prototype.toJSON=function t(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function L(t,e,r){if(e===0&&r===t.length){return n.fromByteArray(t)}else{return n.fromByteArray(t.slice(e,r))}}function I(t,e,r){r=Math.min(t.length,r);var n=[];var a=e;while(a<r){var i=t[a];var o=null;var s=i>239?4:i>223?3:i>191?2:1;if(a+s<=r){var l,u,c,f;switch(s){case 1:if(i<128){o=i}break;case 2:l=t[a+1];if((l&192)===128){f=(i&31)<<6|l&63;if(f>127){o=f}}break;case 3:l=t[a+1];u=t[a+2];if((l&192)===128&&(u&192)===128){f=(i&15)<<12|(l&63)<<6|u&63;if(f>2047&&(f<55296||f>57343)){o=f}}break;case 4:l=t[a+1];u=t[a+2];c=t[a+3];if((l&192)===128&&(u&192)===128&&(c&192)===128){f=(i&15)<<18|(l&63)<<12|(u&63)<<6|c&63;if(f>65535&&f<1114112){o=f}}}}if(o===null){o=65533;s=1}else if(o>65535){o-=65536;n.push(o>>>10&1023|55296);o=56320|o&1023}n.push(o);a+=s}return P(n)}var z=4096;function P(t){var e=t.length;if(e<=z){return String.fromCharCode.apply(String,t)}var r="";var n=0;while(n<e){r+=String.fromCharCode.apply(String,t.slice(n,n+=z))}return r}function O(t,e,r){var n="";r=Math.min(t.length,r);for(var a=e;a<r;++a){n+=String.fromCharCode(t[a]&127)}return n}function D(t,e,r){var n="";r=Math.min(t.length,r);for(var a=e;a<r;++a){n+=String.fromCharCode(t[a])}return n}function R(t,e,r){var n=t.length;if(!e||e<0)e=0;if(!r||r<0||r>n)r=n;var a="";for(var i=e;i<r;++i){a+=G(t[i])}return a}function B(t,e,r){var n=t.slice(e,r);var a="";for(var i=0;i<n.length;i+=2){a+=String.fromCharCode(n[i]+n[i+1]*256)}return a}l.prototype.slice=function t(e,r){var n=this.length;e=~~e;r=r===undefined?n:~~r;if(e<0){e+=n;if(e<0)e=0}else if(e>n){e=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<e)r=e;var a=this.subarray(e,r);a.__proto__=l.prototype;return a};function F(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUIntLE=function t(e,r,n){e=e>>>0;r=r>>>0;if(!n)F(e,r,this.length);var a=this[e];var i=1;var o=0;while(++o<r&&(i*=256)){a+=this[e+o]*i}return a};l.prototype.readUIntBE=function t(e,r,n){e=e>>>0;r=r>>>0;if(!n){F(e,r,this.length)}var a=this[e+--r];var i=1;while(r>0&&(i*=256)){a+=this[e+--r]*i}return a};l.prototype.readUInt8=function t(e,r){e=e>>>0;if(!r)F(e,1,this.length);return this[e]};l.prototype.readUInt16LE=function t(e,r){e=e>>>0;if(!r)F(e,2,this.length);return this[e]|this[e+1]<<8};l.prototype.readUInt16BE=function t(e,r){e=e>>>0;if(!r)F(e,2,this.length);return this[e]<<8|this[e+1]};l.prototype.readUInt32LE=function t(e,r){e=e>>>0;if(!r)F(e,4,this.length);return(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};l.prototype.readUInt32BE=function t(e,r){e=e>>>0;if(!r)F(e,4,this.length);return this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};l.prototype.readIntLE=function t(e,r,n){e=e>>>0;r=r>>>0;if(!n)F(e,r,this.length);var a=this[e];var i=1;var o=0;while(++o<r&&(i*=256)){a+=this[e+o]*i}i*=128;if(a>=i)a-=Math.pow(2,8*r);return a};l.prototype.readIntBE=function t(e,r,n){e=e>>>0;r=r>>>0;if(!n)F(e,r,this.length);var a=r;var i=1;var o=this[e+--a];while(a>0&&(i*=256)){o+=this[e+--a]*i}i*=128;if(o>=i)o-=Math.pow(2,8*r);return o};l.prototype.readInt8=function t(e,r){e=e>>>0;if(!r)F(e,1,this.length);if(!(this[e]&128))return this[e];return(255-this[e]+1)*-1};l.prototype.readInt16LE=function t(e,r){e=e>>>0;if(!r)F(e,2,this.length);var n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};l.prototype.readInt16BE=function t(e,r){e=e>>>0;if(!r)F(e,2,this.length);var n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};l.prototype.readInt32LE=function t(e,r){e=e>>>0;if(!r)F(e,4,this.length);return this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};l.prototype.readInt32BE=function t(e,r){e=e>>>0;if(!r)F(e,4,this.length);return this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};l.prototype.readFloatLE=function t(e,r){e=e>>>0;if(!r)F(e,4,this.length);return a.read(this,e,true,23,4)};l.prototype.readFloatBE=function t(e,r){e=e>>>0;if(!r)F(e,4,this.length);return a.read(this,e,false,23,4)};l.prototype.readDoubleLE=function t(e,r){e=e>>>0;if(!r)F(e,8,this.length);return a.read(this,e,true,52,8)};l.prototype.readDoubleBE=function t(e,r){e=e>>>0;if(!r)F(e,8,this.length);return a.read(this,e,false,52,8)};function N(t,e,r,n,a,i){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>a||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}l.prototype.writeUIntLE=function t(e,r,n,a){e=+e;r=r>>>0;n=n>>>0;if(!a){var i=Math.pow(2,8*n)-1;N(this,e,r,n,i,0)}var o=1;var s=0;this[r]=e&255;while(++s<n&&(o*=256)){this[r+s]=e/o&255}return r+n};l.prototype.writeUIntBE=function t(e,r,n,a){e=+e;r=r>>>0;n=n>>>0;if(!a){var i=Math.pow(2,8*n)-1;N(this,e,r,n,i,0)}var o=n-1;var s=1;this[r+o]=e&255;while(--o>=0&&(s*=256)){this[r+o]=e/s&255}return r+n};l.prototype.writeUInt8=function t(e,r,n){e=+e;r=r>>>0;if(!n)N(this,e,r,1,255,0);this[r]=e&255;return r+1};l.prototype.writeUInt16LE=function t(e,r,n){e=+e;r=r>>>0;if(!n)N(this,e,r,2,65535,0);this[r]=e&255;this[r+1]=e>>>8;return r+2};l.prototype.writeUInt16BE=function t(e,r,n){e=+e;r=r>>>0;if(!n)N(this,e,r,2,65535,0);this[r]=e>>>8;this[r+1]=e&255;return r+2};l.prototype.writeUInt32LE=function t(e,r,n){e=+e;r=r>>>0;if(!n)N(this,e,r,4,4294967295,0);this[r+3]=e>>>24;this[r+2]=e>>>16;this[r+1]=e>>>8;this[r]=e&255;return r+4};l.prototype.writeUInt32BE=function t(e,r,n){e=+e;r=r>>>0;if(!n)N(this,e,r,4,4294967295,0);this[r]=e>>>24;this[r+1]=e>>>16;this[r+2]=e>>>8;this[r+3]=e&255;return r+4};l.prototype.writeIntLE=function t(e,r,n,a){e=+e;r=r>>>0;if(!a){var i=Math.pow(2,8*n-1);N(this,e,r,n,i-1,-i)}var o=0;var s=1;var l=0;this[r]=e&255;while(++o<n&&(s*=256)){if(e<0&&l===0&&this[r+o-1]!==0){l=1}this[r+o]=(e/s>>0)-l&255}return r+n};l.prototype.writeIntBE=function t(e,r,n,a){e=+e;r=r>>>0;if(!a){var i=Math.pow(2,8*n-1);N(this,e,r,n,i-1,-i)}var o=n-1;var s=1;var l=0;this[r+o]=e&255;while(--o>=0&&(s*=256)){if(e<0&&l===0&&this[r+o+1]!==0){l=1}this[r+o]=(e/s>>0)-l&255}return r+n};l.prototype.writeInt8=function t(e,r,n){e=+e;r=r>>>0;if(!n)N(this,e,r,1,127,-128);if(e<0)e=255+e+1;this[r]=e&255;return r+1};l.prototype.writeInt16LE=function t(e,r,n){e=+e;r=r>>>0;if(!n)N(this,e,r,2,32767,-32768);this[r]=e&255;this[r+1]=e>>>8;return r+2};l.prototype.writeInt16BE=function t(e,r,n){e=+e;r=r>>>0;if(!n)N(this,e,r,2,32767,-32768);this[r]=e>>>8;this[r+1]=e&255;return r+2};l.prototype.writeInt32LE=function t(e,r,n){e=+e;r=r>>>0;if(!n)N(this,e,r,4,2147483647,-2147483648);this[r]=e&255;this[r+1]=e>>>8;this[r+2]=e>>>16;this[r+3]=e>>>24;return r+4};l.prototype.writeInt32BE=function t(e,r,n){e=+e;r=r>>>0;if(!n)N(this,e,r,4,2147483647,-2147483648);if(e<0)e=4294967295+e+1;this[r]=e>>>24;this[r+1]=e>>>16;this[r+2]=e>>>8;this[r+3]=e&255;return r+4};function j(t,e,r,n,a,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function V(t,e,r,n,i){e=+e;r=r>>>0;if(!i){j(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38)}a.write(t,e,r,n,23,4);return r+4}l.prototype.writeFloatLE=function t(e,r,n){return V(this,e,r,true,n)};l.prototype.writeFloatBE=function t(e,r,n){return V(this,e,r,false,n)};function U(t,e,r,n,i){e=+e;r=r>>>0;if(!i){j(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308)}a.write(t,e,r,n,52,8);return r+8}l.prototype.writeDoubleLE=function t(e,r,n){return U(this,e,r,true,n)};l.prototype.writeDoubleBE=function t(e,r,n){return U(this,e,r,false,n)};l.prototype.copy=function t(e,r,n,a){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(!n)n=0;if(!a&&a!==0)a=this.length;if(r>=e.length)r=e.length;if(!r)r=0;if(a>0&&a<n)a=n;if(a===n)return 0;if(e.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");if(a>this.length)a=this.length;if(e.length-r<a-n){a=e.length-r+n}var i=a-n;if(this===e&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(r,n,a)}else if(this===e&&n<r&&r<a){for(var o=i-1;o>=0;--o){e[o+r]=this[o+n]}}else{Uint8Array.prototype.set.call(e,this.subarray(n,a),r)}return i};l.prototype.fill=function t(e,r,n,a){if(typeof e==="string"){if(typeof r==="string"){a=r;r=0;n=this.length}else if(typeof n==="string"){a=n;n=this.length}if(a!==undefined&&typeof a!=="string"){throw new TypeError("encoding must be a string")}if(typeof a==="string"&&!l.isEncoding(a)){throw new TypeError("Unknown encoding: "+a)}if(e.length===1){var i=e.charCodeAt(0);if(a==="utf8"&&i<128||a==="latin1"){e=i}}}else if(typeof e==="number"){e=e&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!e)e=0;var o;if(typeof e==="number"){for(o=r;o<n;++o){this[o]=e}}else{var s=l.isBuffer(e)?e:new l(e,a);var u=s.length;if(u===0){throw new TypeError('The value "'+e+'" is invalid for argument "value"')}for(o=0;o<n-r;++o){this[o+r]=s[o%u]}}return this};var q=/[^+/0-9A-Za-z-_]/g;function H(t){t=t.split("=")[0];t=t.trim().replace(q,"");if(t.length<2)return"";while(t.length%4!==0){t=t+"="}return t}function G(t){if(t<16)return"0"+t.toString(16);return t.toString(16)}function W(t,e){e=e||Infinity;var r;var n=t.length;var a=null;var i=[];for(var o=0;o<n;++o){r=t.charCodeAt(o);if(r>55295&&r<57344){if(!a){if(r>56319){if((e-=3)>-1)i.push(239,191,189);continue}else if(o+1===n){if((e-=3)>-1)i.push(239,191,189);continue}a=r;continue}if(r<56320){if((e-=3)>-1)i.push(239,191,189);a=r;continue}r=(a-55296<<10|r-56320)+65536}else if(a){if((e-=3)>-1)i.push(239,191,189)}a=null;if(r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return i}function Y(t){var e=[];for(var r=0;r<t.length;++r){e.push(t.charCodeAt(r)&255)}return e}function X(t,e){var r,n,a;var i=[];for(var o=0;o<t.length;++o){if((e-=2)<0)break;r=t.charCodeAt(o);n=r>>8;a=r%256;i.push(a);i.push(n)}return i}function Z(t){return n.toByteArray(H(t))}function $(t,e,r,n){for(var a=0;a<n;++a){if(a+r>=e.length||a>=t.length)break;e[a+r]=t[a]}return a}function J(t){return t instanceof ArrayBuffer||t!=null&&t.constructor!=null&&t.constructor.name==="ArrayBuffer"&&typeof t.byteLength==="number"}function K(t){return t!==t}},{"base64-js":62,ieee754:380}],93:[function(t,e,r){"use strict";var n=t("./lib/monotone");var a=t("./lib/triangulation");var i=t("./lib/delaunay");var o=t("./lib/filter");e.exports=f;function s(t){return[Math.min(t[0],t[1]),Math.max(t[0],t[1])]}function l(t,e){return t[0]-e[0]||t[1]-e[1]}function u(t){return t.map(s).sort(l)}function c(t,e,r){if(e in t){return t[e]}return r}function f(t,e,r){if(!Array.isArray(e)){r=e||{};e=[]}else{r=r||{};e=e||[]}var s=!!c(r,"delaunay",true);var l=!!c(r,"interior",true);var f=!!c(r,"exterior",true);var h=!!c(r,"infinity",false);if(!l&&!f||t.length===0){return[]}var p=n(t,e);if(s||l!==f||h){var d=a(t.length,u(e));for(var v=0;v<p.length;++v){var g=p[v];d.addTriangle(g[0],g[1],g[2])}if(s){i(t,d)}if(!f){return o(d,-1)}else if(!l){return o(d,1,h)}else if(h){return o(d,0,h)}else{return d.cells()}}else{return p}}},{"./lib/delaunay":94,"./lib/filter":95,"./lib/monotone":96,"./lib/triangulation":97}],94:[function(t,e,r){"use strict";var n=t("robust-in-sphere")[4];var a=t("binary-search-bounds");e.exports=o;function i(t,e,r,a,i,o){var s=e.opposite(a,i);if(s<0){return}if(i<a){var l=a;a=i;i=l;l=o;o=s;s=l}if(e.isConstraint(a,i)){return}if(n(t[a],t[i],t[o],t[s])<0){r.push(a,i)}}function o(t,e){var r=[];var a=t.length;var o=e.stars;for(var s=0;s<a;++s){var l=o[s];for(var u=1;u<l.length;u+=2){var c=l[u];if(c<s){continue}if(e.isConstraint(s,c)){continue}var f=l[u-1],h=-1;for(var p=1;p<l.length;p+=2){if(l[p-1]===c){h=l[p];break}}if(h<0){continue}if(n(t[s],t[c],t[f],t[h])<0){r.push(s,c)}}}while(r.length>0){var c=r.pop();var s=r.pop();var f=-1,h=-1;var l=o[s];for(var d=1;d<l.length;d+=2){var v=l[d-1];var g=l[d];if(v===c){h=g}else if(g===c){f=v}}if(f<0||h<0){continue}if(n(t[s],t[c],t[f],t[h])>=0){continue}e.flip(s,c);i(t,e,r,f,s,h);i(t,e,r,s,h,f);i(t,e,r,h,c,f);i(t,e,r,c,f,h)}}},{"binary-search-bounds":98,"robust-in-sphere":469}],95:[function(t,e,r){"use strict";var n=t("binary-search-bounds");e.exports=u;function a(t,e,r,n,a,i,o){this.cells=t;this.neighbor=e;this.flags=n;this.constraint=r;this.active=a;this.next=i;this.boundary=o}var i=a.prototype;function o(t,e){return t[0]-e[0]||t[1]-e[1]||t[2]-e[2]}i.locate=function(){var t=[0,0,0];return function(e,r,a){var i=e,s=r,l=a;if(r<a){if(r<e){i=r;s=a;l=e}}else if(a<e){i=a;s=e;l=r}if(i<0){return-1}t[0]=i;t[1]=s;t[2]=l;return n.eq(this.cells,t,o)}}();function s(t,e){var r=t.cells();var n=r.length;for(var i=0;i<n;++i){var s=r[i];var l=s[0],u=s[1],c=s[2];if(u<c){if(u<l){s[0]=u;s[1]=c;s[2]=l}}else if(c<l){s[0]=c;s[1]=l;s[2]=u}}r.sort(o);var f=new Array(n);for(var i=0;i<f.length;++i){f[i]=0}var h=[];var p=[];var d=new Array(3*n);var v=new Array(3*n);var g=null;if(e){g=[]}var m=new a(r,d,v,f,h,p,g);for(var i=0;i<n;++i){var s=r[i];for(var y=0;y<3;++y){var l=s[y],u=s[(y+1)%3];var x=d[3*i+y]=m.locate(u,l,t.opposite(u,l));var b=v[3*i+y]=t.isConstraint(l,u);if(x<0){if(b){p.push(i)}else{h.push(i);f[i]=1}if(e){g.push([u,l,-1])}}}}return m}function l(t,e,r){var n=0;for(var a=0;a<t.length;++a){if(e[a]===r){t[n++]=t[a]}}t.length=n;return t}function u(t,e,r){var n=s(t,r);if(e===0){if(r){return n.cells.concat(n.boundary)}else{return n.cells}}var a=1;var i=n.active;var o=n.next;var u=n.flags;var c=n.cells;var f=n.constraint;var h=n.neighbor;while(i.length>0||o.length>0){while(i.length>0){var p=i.pop();if(u[p]===-a){continue}u[p]=a;var d=c[p];for(var v=0;v<3;++v){var g=h[3*p+v];if(g>=0&&u[g]===0){if(f[3*p+v]){o.push(g)}else{i.push(g);u[g]=a}}}}var m=o;o=i;i=m;o.length=0;a=-a}var y=l(c,u,e);if(r){return y.concat(n.boundary)}return y}},{"binary-search-bounds":98}],96:[function(t,e,r){"use strict";var n=t("binary-search-bounds");var a=t("robust-orientation")[3];var i=0;var o=1;var s=2;e.exports=g;function l(t,e,r,n,a){this.a=t;this.b=e;this.idx=r;this.lowerIds=n;this.upperIds=a}function u(t,e,r,n){this.a=t;this.b=e;this.type=r;this.idx=n}function c(t,e){var r=t.a[0]-e.a[0]||t.a[1]-e.a[1]||t.type-e.type;if(r){return r}if(t.type!==i){r=a(t.a,t.b,e.b);if(r){return r}}return t.idx-e.idx}function f(t,e){return a(t.a,t.b,e)}function h(t,e,r,i,o){var s=n.lt(e,i,f);var l=n.gt(e,i,f);for(var u=s;u<l;++u){var c=e[u];var h=c.lowerIds;var p=h.length;while(p>1&&a(r[h[p-2]],r[h[p-1]],i)>0){t.push([h[p-1],h[p-2],o]);p-=1}h.length=p;h.push(o);var d=c.upperIds;var p=d.length;while(p>1&&a(r[d[p-2]],r[d[p-1]],i)<0){t.push([d[p-2],d[p-1],o]);p-=1}d.length=p;d.push(o)}}function p(t,e){var r;if(t.a[0]<e.a[0]){r=a(t.a,t.b,e.a)}else{r=a(e.b,e.a,t.a)}if(r){return r}if(e.b[0]<t.b[0]){r=a(t.a,t.b,e.b)}else{r=a(e.b,e.a,t.b)}return r||t.idx-e.idx}function d(t,e,r){var a=n.le(t,r,p);var i=t[a];var o=i.upperIds;var s=o[o.length-1];i.upperIds=[s];t.splice(a+1,0,new l(r.a,r.b,r.idx,[s],o))}function v(t,e,r){var a=r.a;r.a=r.b;r.b=a;var i=n.eq(t,r,p);var o=t[i];var s=t[i-1];s.upperIds=o.upperIds;t.splice(i,1)}function g(t,e){var r=t.length;var n=e.length;var a=[];for(var f=0;f<r;++f){a.push(new u(t[f],null,i,f))}for(var f=0;f<n;++f){var p=e[f];var g=t[p[0]];var m=t[p[1]];if(g[0]<m[0]){a.push(new u(g,m,s,f),new u(m,g,o,f))}else if(g[0]>m[0]){a.push(new u(m,g,s,f),new u(g,m,o,f))}}a.sort(c);var y=a[0].a[0]-(1+Math.abs(a[0].a[0]))*Math.pow(2,-52);var x=[new l([y,1],[y,0],-1,[],[],[],[])];var b=[];for(var f=0,_=a.length;f<_;++f){var w=a[f];var k=w.type;if(k===i){h(b,x,t,w.a,w.idx)}else if(k===s){d(x,t,w)}else{v(x,t,w)}}return b}},{"binary-search-bounds":98,"robust-orientation":471}],97:[function(t,e,r){"use strict";var n=t("binary-search-bounds");e.exports=s;function a(t,e){this.stars=t;this.edges=e}var i=a.prototype;function o(t,e,r){for(var n=1,a=t.length;n<a;n+=2){if(t[n-1]===e&&t[n]===r){t[n-1]=t[a-2];t[n]=t[a-1];t.length=a-2;return}}}i.isConstraint=function(){var t=[0,0];function e(t,e){return t[0]-e[0]||t[1]-e[1]}return function(r,a){t[0]=Math.min(r,a);t[1]=Math.max(r,a);return n.eq(this.edges,t,e)>=0}}();i.removeTriangle=function(t,e,r){var n=this.stars;o(n[t],e,r);o(n[e],r,t);o(n[r],t,e)};i.addTriangle=function(t,e,r){var n=this.stars;n[t].push(e,r);n[e].push(r,t);n[r].push(t,e)};i.opposite=function(t,e){var r=this.stars[e];for(var n=1,a=r.length;n<a;n+=2){if(r[n]===t){return r[n-1]}}return-1};i.flip=function(t,e){var r=this.opposite(t,e);var n=this.opposite(e,t);this.removeTriangle(t,e,r);this.removeTriangle(e,t,n);this.addTriangle(t,n,r);this.addTriangle(e,r,n)};i.edges=function(){var t=this.stars;var e=[];for(var r=0,n=t.length;r<n;++r){var a=t[r];for(var i=0,o=a.length;i<o;i+=2){e.push([a[i],a[i+1]])}}return e};i.cells=function(){var t=this.stars;var e=[];for(var r=0,n=t.length;r<n;++r){var a=t[r];for(var i=0,o=a.length;i<o;i+=2){var s=a[i];var l=a[i+1];if(r<Math.min(s,l)){e.push([r,s,l])}}}return e};function s(t,e){var r=new Array(t);for(var n=0;n<t;++n){r[n]=[]}return new a(r,e)}},{"binary-search-bounds":98}],98:[function(t,e,r){"use strict";function n(t,e,r,n,a){var i=["function ",t,"(a,l,h,",n.join(","),"){",a?"":"var i=",r?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];if(a){if(e.indexOf("c")<0){i.push(";if(x===y){return m}else if(x<=y){")}else{i.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){")}}else{i.push(";if(",e,"){i=m;")}if(r){i.push("l=m+1}else{h=m-1}")}else{i.push("h=m-1}else{l=m+1}")}i.push("}");if(a){i.push("return -1};")}else{i.push("return i};")}return i.join("")}function a(t,e,r,a){var i=new Function([n("A","x"+t+"y",e,["y"],a),n("P","c(x,y)"+t+"0",e,["y","c"],a),"function dispatchBsearch",r,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",r].join(""));return i()}e.exports={ge:a(">=",false,"GE"),gt:a(">",false,"GT"),lt:a("<",true,"LT"),le:a("<=",true,"LE"),eq:a("-",true,"EQ",true)}},{}],99:[function(t,e,r){"use strict";e.exports=n;function n(t){var e=1;for(var r=1;r<t.length;++r){for(var n=0;n<r;++n){if(t[r]<t[n]){e=-e}else if(t[n]===t[r]){return 0}}}return e}},{}],100:[function(t,e,r){"use strict";var n=t("dup");var a=t("robust-linear-solve");function i(t,e){var r=0;var n=t.length;for(var a=0;a<n;++a){r+=t[a]*e[a]}return r}function o(t){var e=t.length;if(e===0){return[]}var r=t[0].length;var o=n([t.length+1,t.length+1],1);var s=n([t.length+1],1);o[e][e]=0;for(var l=0;l<e;++l){for(var u=0;u<=l;++u){o[u][l]=o[l][u]=2*i(t[l],t[u])}s[l]=i(t[l],t[l])}var c=a(o,s);var f=0;var h=c[e+1];for(var l=0;l<h.length;++l){f+=h[l]}var p=new Array(e);for(var l=0;l<e;++l){var h=c[l];var d=0;for(var u=0;u<h.length;++u){d+=h[u]}p[l]=d/f}return p}function s(t){if(t.length===0){return[]}var e=t[0].length;var r=n([e]);var a=o(t);for(var i=0;i<t.length;++i){for(var s=0;s<e;++s){r[s]+=t[i][s]*a[i]}}return r}s.barycenetric=o;e.exports=s},{dup:154,"robust-linear-solve":470}],101:[function(t,e,r){e.exports=a;var n=t("circumcenter");function a(t){var e=n(t);var r=0;for(var a=0;a<t.length;++a){var i=t[a];for(var o=0;o<e.length;++o){r+=Math.pow(i[o]-e[o],2)}}return Math.sqrt(r/t.length)}},{circumcenter:100}],102:[function(t,e,r){e.exports=n;function n(t,e,r){return e<r?t<e?e:t>r?r:t:t<r?r:t>e?e:t}},{}],103:[function(t,e,r){"use strict";e.exports=M;var n=t("union-find");var a=t("box-intersect");var i=t("robust-segment-intersect");var o=t("big-rat");var s=t("big-rat/cmp");var l=t("big-rat/to-float");var u=t("rat-vec");var c=t("nextafter");var f=t("./lib/rat-seg-intersect");function h(t){var e=l(t);return[c(e,-Infinity),c(e,Infinity)]}function p(t,e){var r=new Array(e.length);for(var n=0;n<e.length;++n){var a=e[n];var i=t[a[0]];var o=t[a[1]];r[n]=[c(Math.min(i[0],o[0]),-Infinity),c(Math.min(i[1],o[1]),-Infinity),c(Math.max(i[0],o[0]),Infinity),c(Math.max(i[1],o[1]),Infinity)]}return r}function d(t){var e=new Array(t.length);for(var r=0;r<t.length;++r){var n=t[r];e[r]=[c(n[0],-Infinity),c(n[1],-Infinity),c(n[0],Infinity),c(n[1],Infinity)]}return e}function v(t,e,r){var n=[];a(r,function(r,a){var o=e[r];var s=e[a];if(o[0]===s[0]||o[0]===s[1]||o[1]===s[0]||o[1]===s[1]){return}var l=t[o[0]];var u=t[o[1]];var c=t[s[0]];var f=t[s[1]];if(i(l,u,c,f)){n.push([r,a])}});return n}function g(t,e,r,n){var o=[];a(r,n,function(r,n){var a=e[r];if(a[0]===n||a[1]===n){return}var s=t[n];var l=t[a[0]];var u=t[a[1]];if(i(l,u,s,s)){o.push([r,n])}});return o}function m(t,e,r,n,a){var i,c;var h=t.map(function(t){return[o(t[0]),o(t[1])]});for(i=0;i<r.length;++i){var p=r[i];c=p[0];var d=p[1];var v=e[c];var g=e[d];var m=f(u(t[v[0]]),u(t[v[1]]),u(t[g[0]]),u(t[g[1]]));if(!m){continue}var y=t.length;t.push([l(m[0]),l(m[1])]);h.push(m);n.push([c,y],[d,y])}n.sort(function(t,e){if(t[0]!==e[0]){return t[0]-e[0]}var r=h[t[1]];var n=h[e[1]];return s(r[0],n[0])||s(r[1],n[1])});for(i=n.length-1;i>=0;--i){var x=n[i];c=x[0];var b=e[c];var _=b[0];var w=b[1];var k=t[_];var M=t[w];if((k[0]-M[0]||k[1]-M[1])<0){var A=_;_=w;w=A}b[0]=_;var T=b[1]=x[1];var S;if(a){S=b[2]}while(i>0&&n[i-1][0]===c){var x=n[--i];var E=x[1];if(a){e.push([T,E,S])}else{e.push([T,E])}T=E}if(a){e.push([T,w,S])}else{e.push([T,w])}}return h}function y(t,e,r){var i=e.length;var o=new n(i);var s=[];for(var l=0;l<e.length;++l){var u=e[l];var f=h(u[0]);var p=h(u[1]);s.push([c(f[0],-Infinity),c(p[0],-Infinity),c(f[1],Infinity),c(p[1],Infinity)])}a(s,function(t,e){o.link(t,e)});var d=true;var v=new Array(i);for(var l=0;l<i;++l){var g=o.find(l);if(g!==l){d=false;t[g]=[Math.min(t[l][0],t[g][0]),Math.min(t[l][1],t[g][1])]}}if(d){return null}var m=0;for(var l=0;l<i;++l){var g=o.find(l);if(g===l){v[l]=m;t[m++]=t[l]}else{v[l]=-1}}t.length=m;for(var l=0;l<i;++l){if(v[l]<0){v[l]=v[o.find(l)]}}return v}function x(t,e){return t[0]-e[0]||t[1]-e[1]}function b(t,e){var r=t[0]-e[0]||t[1]-e[1];if(r){return r}if(t[2]<e[2]){return-1}else if(t[2]>e[2]){return 1}return 0}function _(t,e,r){if(t.length===0){return}if(e){for(var n=0;n<t.length;++n){var a=t[n];var i=e[a[0]];var o=e[a[1]];a[0]=Math.min(i,o);a[1]=Math.max(i,o)}}else{for(var n=0;n<t.length;++n){var a=t[n];var i=a[0];var o=a[1];a[0]=Math.min(i,o);a[1]=Math.max(i,o)}}if(r){t.sort(b)}else{t.sort(x)}var s=1;for(var n=1;n<t.length;++n){var l=t[n-1];var u=t[n];if(u[0]===l[0]&&u[1]===l[1]&&(!r||u[2]===l[2])){continue}t[s++]=u}t.length=s}function w(t,e,r){var n=y(t,[],d(t));_(e,n,r);return!!n}function k(t,e,r){var n=p(t,e);var a=v(t,e,n);var i=d(t);var o=g(t,e,n,i);var s=m(t,e,a,o,r);var l=y(t,s,i);_(e,l,r);if(!l){return a.length>0||o.length>0}return true}function M(t,e,r){var n;if(r){n=e;var a=new Array(e.length);for(var i=0;i<e.length;++i){var o=e[i];a[i]=[o[0],o[1],r[i]]}e=a}var s=w(t,e,!!r);while(k(t,e,!!r)){s=true}if(!!r&&s){n.length=0;r.length=0;for(var i=0;i<e.length;++i){var o=e[i];n.push([o[0],o[1]]);r.push(o[2])}}return s}},{"./lib/rat-seg-intersect":104,"big-rat":66,"big-rat/cmp":64,"big-rat/to-float":78,"box-intersect":84,nextafter:418,"rat-vec":453,"robust-segment-intersect":474,"union-find":508}],104:[function(t,e,r){"use strict";e.exports=f;var n=t("big-rat/mul");var a=t("big-rat/div");var i=t("big-rat/sub");var o=t("big-rat/sign");var s=t("rat-vec/sub");var l=t("rat-vec/add");var u=t("rat-vec/muls");function c(t,e){return i(n(t[0],e[1]),n(t[1],e[0]))}function f(t,e,r,n){var i=s(e,t);var f=s(n,r);var h=c(i,f);if(o(h)===0){return null}var p=s(t,r);var d=c(f,p);var v=a(d,h);var g=u(i,v);var m=l(t,g);return m}},{"big-rat/div":65,"big-rat/mul":75,"big-rat/sign":76,"big-rat/sub":77,"rat-vec/add":452,"rat-vec/muls":454,"rat-vec/sub":455}],105:[function(t,e,r){"use strict";var n=t("clamp");e.exports=a;e.exports.to=a;e.exports.from=i;function a(t,e){if(e==null)e=true;var r=t[0],a=t[1],i=t[2],o=t[3];if(o==null)o=e?1:255;if(e){r*=255;a*=255;i*=255;o*=255}r=n(r,0,255)&255;a=n(a,0,255)&255;i=n(i,0,255)&255;o=n(o,0,255)&255;var s=r*16777216+(a<<16)+(i<<8)+o;return s}function i(t,e){t=+t;var r=t>>>24;var n=(t&16711680)>>>16;var a=(t&65280)>>>8;var i=t&255;if(e===false)return[r,n,a,i];return[r/255,n/255,a/255,i/255]}},{clamp:102}],106:[function(t,e,r){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],107:[function(t,e,r){"use strict";var n=t("color-rgba");var a=t("clamp");var i=t("dtype");e.exports=function t(e,r){if(r==="float"||!r)r="array";if(r==="uint")r="uint8";if(r==="uint_clamped")r="uint8_clamped";var o=i(r);var s=new o(4);if(e instanceof o){if(Array.isArray(e)){return e.slice()}s.set(e);return s}var t=r!=="uint8"&&r!=="uint8_clamped";if(e instanceof Uint8Array||e instanceof Uint8ClampedArray){s[0]=e[0];s[1]=e[1];s[2]=e[2];s[3]=e[3]!=null?e[3]:255;if(t){s[0]/=255;s[1]/=255;s[2]/=255;s[3]/=255}return s}if(!e.length||typeof e==="string"){e=n(e);e[0]/=255;e[1]/=255;e[2]/=255}if(!t){s[0]=a(Math.round(e[0]*255),0,255);s[1]=a(Math.round(e[1]*255),0,255);s[2]=a(Math.round(e[2]*255),0,255);s[3]=e[3]==null?255:a(Math.floor(e[3]*255),0,255)}else{s[0]=e[0];s[1]=e[1];s[2]=e[2];s[3]=e[3]!=null?e[3]:1}return s}},{clamp:102,"color-rgba":109,dtype:153}],108:[function(t,e,r){(function(r){"use strict";var n=t("color-name");var a=t("is-plain-obj");var i=t("defined");e.exports=s;var o={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function s(t){var e,s=[],l=1,u;if(typeof t==="string"){if(n[t]){s=n[t].slice();u="rgb"}else if(t==="transparent"){l=0;u="rgb";s=[0,0,0]}else if(/^#[A-Fa-f0-9]+$/.test(t)){var c=t.slice(1);var f=c.length;var h=f<=4;l=1;if(h){s=[parseInt(c[0]+c[0],16),parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16)];if(f===4){l=parseInt(c[3]+c[3],16)/255}}else{s=[parseInt(c[0]+c[1],16),parseInt(c[2]+c[3],16),parseInt(c[4]+c[5],16)];if(f===8){l=parseInt(c[6]+c[7],16)/255}}if(!s[0])s[0]=0;if(!s[1])s[1]=0;if(!s[2])s[2]=0;u="rgb"}else if(e=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(t)){var p=e[1];var c=p.replace(/a$/,"");u=c;var f=c==="cmyk"?4:c==="gray"?1:3;s=e[2].trim().split(/\s*,\s*/).map(function(t,e){if(/%$/.test(t)){if(e===f)return parseFloat(t)/100;if(c==="rgb")return parseFloat(t)*255/100;return parseFloat(t)}else if(c[e]==="h"){if(/deg$/.test(t)){return parseFloat(t)}else if(o[t]!==undefined){return o[t]}}return parseFloat(t)});if(p===c)s.push(1);l=s[f]===undefined?1:s[f];s=s.slice(0,f)}else if(t.length>10&&/[0-9](?:\s|\/)/.test(t)){s=t.match(/([0-9]+)/g).map(function(t){return parseFloat(t)});u=t.match(/([a-z])/ig).join("").toLowerCase()}}else if(typeof t==="number"){u="rgb";s=[t>>>16,(t&65280)>>>8,t&255]}else if(a(t)){var d=i(t.r,t.red,t.R,null);if(d!==null){u="rgb";s=[d,i(t.g,t.green,t.G),i(t.b,t.blue,t.B)]}else{u="hsl";s=[i(t.h,t.hue,t.H),i(t.s,t.saturation,t.S),i(t.l,t.lightness,t.L,t.b,t.brightness)]}l=i(t.a,t.alpha,t.opacity,1);if(t.opacity!=null)l/=100}else if(Array.isArray(t)||r.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(t)){s=[t[0],t[1],t[2]];u="rgb";l=t.length===4?t[3]:1}return{space:u,values:s,alpha:l}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"color-name":106,defined:148,"is-plain-obj":390}],109:[function(t,e,r){"use strict";var n=t("color-parse");var a=t("color-space/hsl");var i=t("clamp");e.exports=function t(e){var r,o,s;if(typeof e!=="string")throw Error("Argument should be a string");var l=n(e);if(!l.space)return[];r=Array(3);r[0]=i(l.values[0],0,255);r[1]=i(l.values[1],0,255);r[2]=i(l.values[2],0,255);if(l.space[0]==="h"){r=a.rgb(r)}r.push(i(l.alpha,0,1));return r}},{clamp:102,"color-parse":108,"color-space/hsl":110}],110:[function(t,e,r){"use strict";var n=t("./rgb");e.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e=t[0]/360,r=t[1]/100,n=t[2]/100,a,i,o,s,l;if(r===0){l=n*255;return[l,l,l]}if(n<.5){i=n*(1+r)}else{i=n+r-n*r}a=2*n-i;s=[0,0,0];for(var u=0;u<3;u++){o=e+1/3*-(u-1);if(o<0){o++}else if(o>1){o--}if(6*o<1){l=a+(i-a)*6*o}else if(2*o<1){l=i}else if(3*o<2){l=a+(i-a)*(2/3-o)*6}else{l=a}s[u]=l*255}return s}};n.hsl=function(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.min(e,r,n),i=Math.max(e,r,n),o=i-a,s,l,u;if(i===a){s=0}else if(e===i){s=(r-n)/o}else if(r===i){s=2+(n-e)/o}else if(n===i){s=4+(e-r)/o}s=Math.min(s*60,360);if(s<0){s+=360}u=(a+i)/2;if(i===a){l=0}else if(u<=.5){l=o/(i+a)}else{l=o/(2-i-a)}return[s,l*100,u*100]}},{"./rgb":111}],111:[function(t,e,r){"use strict";e.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],112:[function(t,e,r){e.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],113:[function(t,e,r){"use strict";var n=t("./colorScale");var a=t("lerp");e.exports=i;function i(t){var e,r,i,u,c,f,h,p,d,v,g,m,y,x=[],b=[],_=[],w=[];if(!t)t={};d=(t.nshades||72)-1;p=t.format||"hex";h=t.colormap;if(!h)h="jet";if(typeof h==="string"){h=h.toLowerCase();if(!n[h]){throw Error(h+" not a supported colorscale")}f=n[h]}else if(Array.isArray(h)){f=h.slice()}else{throw Error("unsupported colormap option",h)}if(f.length>d){throw new Error(h+" map requires nshades to be at least size "+f.length)}if(!Array.isArray(t.alpha)){if(typeof t.alpha==="number"){g=[t.alpha,t.alpha]}else{g=[1,1]}}else if(t.alpha.length!==2){g=[1,1]}else{g=t.alpha.slice()}e=f.map(function(t){return Math.round(t.index*d)});g[0]=Math.min(Math.max(g[0],0),1);g[1]=Math.min(Math.max(g[1],0),1);var k=f.map(function(t,e){var r=f[e].index;var n=f[e].rgb.slice();if(n.length===4&&n[3]>=0&&n[3]<=1){return n}n[3]=g[0]+(g[1]-g[0])*r;return n});var v=[];for(y=0;y<e.length-1;++y){c=e[y+1]-e[y];i=k[y];u=k[y+1];for(var M=0;M<c;M++){var A=M/c;v.push([Math.round(a(i[0],u[0],A)),Math.round(a(i[1],u[1],A)),Math.round(a(i[2],u[2],A)),a(i[3],u[3],A)])}}v.push(f[f.length-1].rgb.concat(g[1]));if(p==="hex")v=v.map(s);else if(p==="rgbaString")v=v.map(l);else if(p==="float")v=v.map(o);return v}function o(t){return[t[0]/255,t[1]/255,t[2]/255,t[3]]}function s(t){var e,r="#";for(var n=0;n<3;++n){e=t[n];e=e.toString(16);r+=("00"+e).substr(e.length)}return r}function l(t){return"rgba("+t.join(",")+")"}},{"./colorScale":112,lerp:392}],114:[function(t,e,r){"use strict";e.exports=u;var n=t("robust-orientation");var a=t("signum");var i=t("two-sum");var o=t("robust-product");var s=t("robust-sum");function l(t,e,r){var n=i(t[0],-e[0]);var a=i(t[1],-e[1]);var l=i(r[0],-e[0]);var u=i(r[1],-e[1]);var c=s(o(n,l),o(a,u));return c[c.length-1]>=0}function u(t,e,r,i){var o=n(e,r,i);if(o===0){var s=a(n(t,e,r));var u=a(n(t,e,i));if(s===u){if(s===0){var c=l(t,e,r);var f=l(t,e,i);if(c===f){return 0}else if(c){return 1}else{return-1}}return 0}else if(u===0){if(s>0){return-1}else if(l(t,e,i)){return-1}else{return 1}}else if(s===0){if(u>0){return 1}else if(l(t,e,r)){return 1}else{return-1}}return a(u-s)}var h=n(t,e,r);if(h>0){if(o>0&&n(t,e,i)>0){return 1}return-1}else if(h<0){if(o>0||n(t,e,i)>0){return 1}return-1}else{var p=n(t,e,i);if(p>0){return 1}else{if(l(t,e,r)){return 1}else{return-1}}}}},{"robust-orientation":471,"robust-product":472,"robust-sum":476,signum:477,"two-sum":506}],115:[function(t,e,r){e.exports=i;var n=Math.min;function a(t,e){return t-e}function i(t,e){var r=t.length,i=t.length-e.length;if(i){return i}switch(r){case 0:return 0;case 1:return t[0]-e[0];case 2:return t[0]+t[1]-e[0]-e[1]||n(t[0],t[1])-n(e[0],e[1]);case 3:var o=t[0]+t[1],s=e[0]+e[1];i=o+t[2]-(s+e[2]);if(i){return i}var l=n(t[0],t[1]),u=n(e[0],e[1]);return n(l,t[2])-n(u,e[2])||n(l+t[2],o)-n(u+e[2],s);case 4:var c=t[0],f=t[1],h=t[2],p=t[3],d=e[0],v=e[1],g=e[2],m=e[3];return c+f+h+p-(d+v+g+m)||n(c,f,h,p)-n(d,v,g,m,d)||n(c+f,c+h,c+p,f+h,f+p,h+p)-n(d+v,d+g,d+m,v+g,v+m,g+m)||n(c+f+h,c+f+p,c+h+p,f+h+p)-n(d+v+g,d+v+m,d+g+m,v+g+m);default:var y=t.slice().sort(a);var x=e.slice().sort(a);for(var b=0;b<r;++b){i=y[b]-x[b];if(i){return i}}return 0}}},{}],116:[function(t,e,r){"use strict";var n=t("compare-cell");var a=t("cell-orientation");e.exports=i;function i(t,e){return n(t,e)||a(t)-a(e)}},{"cell-orientation":99,"compare-cell":115}],117:[function(t,e,r){"use strict";var n=t("./lib/ch1d");var a=t("./lib/ch2d");var i=t("./lib/chnd");e.exports=o;function o(t){var e=t.length;if(e===0){return[]}else if(e===1){return[[0]]}var r=t[0].length;if(r===0){return[]}else if(r===1){return n(t)}else if(r===2){return a(t)}return i(t,r)}},{"./lib/ch1d":118,"./lib/ch2d":119,"./lib/chnd":120}],118:[function(t,e,r){"use strict";e.exports=n;function n(t){var e=0;var r=0;for(var n=1;n<t.length;++n){if(t[n][0]<t[e][0]){e=n}if(t[n][0]>t[r][0]){r=n}}if(e<r){return[[e],[r]]}else if(e>r){return[[r],[e]]}else{return[[e]]}}},{}],119:[function(t,e,r){"use strict";e.exports=a;var n=t("monotone-convex-hull-2d");function a(t){var e=n(t);var r=e.length;if(r<=2){return[]}var a=new Array(r);var i=e[r-1];for(var o=0;o<r;++o){var s=e[o];a[o]=[i,s];i=s}return a}},{"monotone-convex-hull-2d":401}],120:[function(t,e,r){"use strict";e.exports=s;var n=t("incremental-convex-hull");var a=t("affine-hull");function i(t,e){var r=t.length;var n=new Array(r);for(var a=0;a<e.length;++a){n[a]=t[e[a]]}var i=e.length;for(var a=0;a<r;++a){if(e.indexOf(a)<0){n[i++]=t[a]}}return n}function o(t,e){var r=t.length;var n=e.length;for(var a=0;a<r;++a){var i=t[a];for(var o=0;o<i.length;++o){var s=i[o];if(s<n){i[o]=e[s]}else{s=s-n;for(var l=0;l<n;++l){if(s>=e[l]){s+=1}}i[o]=s}}}return t}function s(t,e){try{return n(t,true)}catch(u){var r=a(t);if(r.length<=e){return[]}var s=i(t,r);var l=n(s,true);return o(l,r)}}},{"affine-hull":53,"incremental-convex-hull":381}],121:[function(t,e,r){e.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xe7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xe9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xe9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xe3)o.?tom(e|\xe9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],122:[function(t,e,r){e.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],123:[function(t,e,r){e.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],124:[function(t,e,r){e.exports=["normal","italic","oblique"]},{}],125:[function(t,e,r){e.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],126:[function(t,e,r){"use strict";e.exports={parse:t("./parse"),stringify:t("./stringify")}},{"./parse":128,"./stringify":129}],127:[function(t,e,r){"use strict";var n=t("css-font-size-keywords");e.exports={isSize:function t(e){return/^[\d\.]/.test(e)||e.indexOf("/")!==-1||n.indexOf(e)!==-1}}},{"css-font-size-keywords":122}],128:[function(t,e,r){"use strict";var n=t("unquote");var a=t("css-global-keywords");var i=t("css-system-font-keywords");var o=t("css-font-weight-keywords");var s=t("css-font-style-keywords");var l=t("css-font-stretch-keywords");var u=t("string-split-by");var c=t("./lib/util").isSize;e.exports=h;var f=h.cache={};function h(t){if(typeof t!=="string")throw new Error("Font argument must be a string.");if(f[t])return f[t];if(t===""){throw new Error("Cannot parse an empty string.")}if(i.indexOf(t)!==-1){return f[t]={system:t}}var e={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]};var r=u(t,/\s+/);var h;while(h=r.shift()){if(a.indexOf(h)!==-1){["style","variant","weight","stretch"].forEach(function(t){e[t]=h});return f[t]=e}if(s.indexOf(h)!==-1){e.style=h;continue}if(h==="normal"||h==="small-caps"){e.variant=h;continue}if(l.indexOf(h)!==-1){e.stretch=h;continue}if(o.indexOf(h)!==-1){e.weight=h;continue}if(c(h)){var d=u(h,"/");e.size=d[0];if(d[1]!=null){e.lineHeight=p(d[1])}else if(r[0]==="/"){r.shift();e.lineHeight=p(r.shift())}if(!r.length){throw new Error("Missing required font-family.")}e.family=u(r.join(" "),/\s*,\s*/).map(n);return f[t]=e}throw new Error("Unknown or unsupported font token: "+h)}throw new Error("Missing required font-size.")}function p(t){var e=parseFloat(t);if(e.toString()===t){return e}return t}},{"./lib/util":127,"css-font-stretch-keywords":123,"css-font-style-keywords":124,"css-font-weight-keywords":125,"css-global-keywords":130,"css-system-font-keywords":131,"string-split-by":490,unquote:510}],129:[function(t,e,r){"use strict";var n=t("pick-by-alias");var a=t("./lib/util").isSize;var i=d(t("css-global-keywords"));var o=d(t("css-system-font-keywords"));var s=d(t("css-font-weight-keywords"));var l=d(t("css-font-style-keywords"));var u=d(t("css-font-stretch-keywords"));var c={normal:1,"small-caps":1};var f={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1};var h={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};e.exports=function t(e){e=n(e,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"});if(e.system){if(e.system)p(e.system,o);return e.system}p(e.style,l);p(e.variant,c);p(e.weight,s);p(e.stretch,u);if(e.size==null)e.size=h.size;if(typeof e.size==="number")e.size+="px";if(!a)throw Error("Bad size value `"+e.size+"`");if(!e.family)e.family=h.family;if(Array.isArray(e.family)){if(!e.family.length)e.family=[h.family];e.family=e.family.map(function(t){return f[t]?t:'"'+t+'"'}).join(", ")}var r=[];r.push(e.style);if(e.variant!==e.style)r.push(e.variant);if(e.weight!==e.variant&&e.weight!==e.style)r.push(e.weight);if(e.stretch!==e.weight&&e.stretch!==e.variant&&e.stretch!==e.style)r.push(e.stretch);r.push(e.size+(e.lineHeight==null||e.lineHeight==="normal"||e.lineHeight+""==="1"?"":"/"+e.lineHeight));r.push(e.family);return r.filter(Boolean).join(" ")};function p(t,e){if(t&&!e[t]&&!i[t])throw Error("Unknown keyword `"+t+"`");return t}function d(t){var e={};for(var r=0;r<t.length;r++){e[t[r]]=1}return e}},{"./lib/util":127,"css-font-stretch-keywords":123,"css-font-style-keywords":124,"css-font-weight-keywords":125,"css-global-keywords":130,"css-system-font-keywords":131,"pick-by-alias":432}],130:[function(t,e,r){e.exports=["inherit","initial","unset"]},{}],131:[function(t,e,r){e.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],132:[function(t,e,r){"use strict";function n(t,e,r,n,a,i){var o=6*a*a-6*a,s=3*a*a-4*a+1,l=-6*a*a+6*a,u=3*a*a-2*a;if(t.length){if(!i){i=new Array(t.length)}for(var c=t.length-1;c>=0;--c){i[c]=o*t[c]+s*e[c]+l*r[c]+u*n[c]}return i}return o*t+s*e+l*r[c]+u*n}function a(t,e,r,n,a,i){var o=a-1,s=a*a,l=o*o,u=(1+2*a)*l,c=a*l,f=s*(3-2*a),h=s*o;if(t.length){if(!i){i=new Array(t.length)}for(var p=t.length-1;p>=0;--p){i[p]=u*t[p]+c*e[p]+f*r[p]+h*n[p]}return i}return u*t+c*e+f*r+h*n}e.exports=a;e.exports.derivative=n},{}],133:[function(t,e,r){"use strict";var n=t("./lib/thunk.js");function a(){this.argTypes=[];this.shimArgs=[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.pre=null;this.body=null;this.post=null;this.debug=false}function i(t){var e=new a;e.pre=t.pre;e.body=t.body;e.post=t.post;var r=t.args.slice(0);e.argTypes=r;for(var i=0;i<r.length;++i){var o=r[i];if(o==="array"||typeof o==="object"&&o.blockIndices){e.argTypes[i]="array";e.arrayArgs.push(i);e.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0);e.shimArgs.push("array"+i);if(i<e.pre.args.length&&e.pre.args[i].count>0){throw new Error("cwise: pre() block may not reference array args")}if(i<e.post.args.length&&e.post.args[i].count>0){throw new Error("cwise: post() block may not reference array args")}}else if(o==="scalar"){e.scalarArgs.push(i);e.shimArgs.push("scalar"+i)}else if(o==="index"){e.indexArgs.push(i);if(i<e.pre.args.length&&e.pre.args[i].count>0){throw new Error("cwise: pre() block may not reference array index")}if(i<e.body.args.length&&e.body.args[i].lvalue){throw new Error("cwise: body() block may not write to array index")}if(i<e.post.args.length&&e.post.args[i].count>0){throw new Error("cwise: post() block may not reference array index")}}else if(o==="shape"){e.shapeArgs.push(i);if(i<e.pre.args.length&&e.pre.args[i].lvalue){throw new Error("cwise: pre() block may not write to array shape")}if(i<e.body.args.length&&e.body.args[i].lvalue){throw new Error("cwise: body() block may not write to array shape")}if(i<e.post.args.length&&e.post.args[i].lvalue){throw new Error("cwise: post() block may not write to array shape")}}else if(typeof o==="object"&&o.offset){e.argTypes[i]="offset";e.offsetArgs.push({array:o.array,offset:o.offset});e.offsetArgIndex.push(i)}else{throw new Error("cwise: Unknown argument type "+r[i])}}if(e.arrayArgs.length<=0){throw new Error("cwise: No array arguments specified")}if(e.pre.args.length>r.length){throw new Error("cwise: Too many arguments in pre() block")}if(e.body.args.length>r.length){throw new Error("cwise: Too many arguments in body() block")}if(e.post.args.length>r.length){throw new Error("cwise: Too many arguments in post() block")}e.debug=!!t.printCode||!!t.debug;e.funcName=t.funcName||"cwise";e.blockSize=t.blockSize||64;return n(e)}e.exports=i},{"./lib/thunk.js":135}],134:[function(t,e,r){"use strict";var n=t("uniq");function a(t,e,r){var n=t.length,a=e.arrayArgs.length,i=e.indexArgs.length>0,o=[],s=[],l=0,u=0,c,f;for(c=0;c<n;++c){s.push(["i",c,"=0"].join(""))}for(f=0;f<a;++f){for(c=0;c<n;++c){u=l;l=t[c];if(c===0){s.push(["d",f,"s",c,"=t",f,"p",l].join(""))}else{s.push(["d",f,"s",c,"=(t",f,"p",l,"-s",u,"*t",f,"p",u,")"].join(""))}}}if(s.length>0){o.push("var "+s.join(","))}for(c=n-1;c>=0;--c){l=t[c];o.push(["for(i",c,"=0;i",c,"<s",l,";++i",c,"){"].join(""))}o.push(r);for(c=0;c<n;++c){u=l;l=t[c];for(f=0;f<a;++f){o.push(["p",f,"+=d",f,"s",c].join(""))}if(i){if(c>0){o.push(["index[",u,"]-=s",u].join(""))}o.push(["++index[",l,"]"].join(""))}o.push("}")}return o.join("\n")}function i(t,e,r,n){var i=e.length,o=r.arrayArgs.length,s=r.blockSize,l=r.indexArgs.length>0,u=[];for(var c=0;c<o;++c){u.push(["var offset",c,"=p",c].join(""))}for(var c=t;c<i;++c){u.push(["for(var j"+c+"=SS[",e[c],"]|0;j",c,">0;){"].join(""));u.push(["if(j",c,"<",s,"){"].join(""));u.push(["s",e[c],"=j",c].join(""));u.push(["j",c,"=0"].join(""));u.push(["}else{s",e[c],"=",s].join(""));u.push(["j",c,"-=",s,"}"].join(""));if(l){u.push(["index[",e[c],"]=j",c].join(""))}}for(var c=0;c<o;++c){var f=["offset"+c];for(var h=t;h<i;++h){f.push(["j",h,"*t",c,"p",e[h]].join(""))}u.push(["p",c,"=(",f.join("+"),")"].join(""))}u.push(a(e,r,n));for(var c=t;c<i;++c){u.push("}")}return u.join("\n")}function o(t){var e=0,r=t[0].length;while(e<r){for(var n=1;n<t.length;++n){if(t[n][e]!==t[0][e]){return e}}++e}return e}function s(t,e,r){var n=t.body;var a=[];var i=[];for(var o=0;o<t.args.length;++o){var s=t.args[o];if(s.count<=0){continue}var l=new RegExp(s.name,"g");var u="";var c=e.arrayArgs.indexOf(o);switch(e.argTypes[o]){case"offset":var f=e.offsetArgIndex.indexOf(o);var h=e.offsetArgs[f];c=h.array;u="+q"+f;case"array":u="p"+c+u;var p="l"+o;var d="a"+c;if(e.arrayBlockIndices[c]===0){if(s.count===1){if(r[c]==="generic"){if(s.lvalue){a.push(["var ",p,"=",d,".get(",u,")"].join(""));n=n.replace(l,p);i.push([d,".set(",u,",",p,")"].join(""))}else{n=n.replace(l,[d,".get(",u,")"].join(""))}}else{n=n.replace(l,[d,"[",u,"]"].join(""))}}else if(r[c]==="generic"){a.push(["var ",p,"=",d,".get(",u,")"].join(""));n=n.replace(l,p);if(s.lvalue){i.push([d,".set(",u,",",p,")"].join(""))}}else{a.push(["var ",p,"=",d,"[",u,"]"].join(""));n=n.replace(l,p);if(s.lvalue){i.push([d,"[",u,"]=",p].join(""))}}}else{var v=[s.name],g=[u];for(var m=0;m<Math.abs(e.arrayBlockIndices[c]);m++){v.push("\\s*\\[([^\\]]+)\\]");g.push("$"+(m+1)+"*t"+c+"b"+m)}l=new RegExp(v.join(""),"g");u=g.join("+");if(r[c]==="generic"){throw new Error("cwise: Generic arrays not supported in combination with blocks!")}else{n=n.replace(l,[d,"[",u,"]"].join(""))}}break;case"scalar":n=n.replace(l,"Y"+e.scalarArgs.indexOf(o));break;case"index":n=n.replace(l,"index");break;case"shape":n=n.replace(l,"shape");break}}return[a.join("\n"),n,i.join("\n")].join("\n").trim()}function l(t){var e=new Array(t.length);var r=true;for(var n=0;n<t.length;++n){var a=t[n];var i=a.match(/\d+/);if(!i){i=""}else{i=i[0]}if(a.charAt(0)===0){e[n]="u"+a.charAt(1)+i}else{e[n]=a.charAt(0)+i}if(n>0){r=r&&e[n]===e[n-1]}}if(r){return e[0]}return e.join("")}function u(t,e){var r=e[1].length-Math.abs(t.arrayBlockIndices[0])|0;var u=new Array(t.arrayArgs.length);var c=new Array(t.arrayArgs.length);for(var f=0;f<t.arrayArgs.length;++f){c[f]=e[2*f];u[f]=e[2*f+1]}var h=[],p=[];var d=[],v=[];var g=[];for(var f=0;f<t.arrayArgs.length;++f){if(t.arrayBlockIndices[f]<0){d.push(0);v.push(r);h.push(r);p.push(r+t.arrayBlockIndices[f])}else{d.push(t.arrayBlockIndices[f]);v.push(t.arrayBlockIndices[f]+r);h.push(0);p.push(t.arrayBlockIndices[f])}var m=[];for(var y=0;y<u[f].length;y++){if(d[f]<=u[f][y]&&u[f][y]<v[f]){m.push(u[f][y]-d[f])}}g.push(m)}var x=["SS"];var b=["'use strict'"];var _=[];for(var y=0;y<r;++y){_.push(["s",y,"=SS[",y,"]"].join(""))}for(var f=0;f<t.arrayArgs.length;++f){x.push("a"+f);x.push("t"+f);x.push("p"+f);for(var y=0;y<r;++y){_.push(["t",f,"p",y,"=t",f,"[",d[f]+y,"]"].join(""))}for(var y=0;y<Math.abs(t.arrayBlockIndices[f]);++y){_.push(["t",f,"b",y,"=t",f,"[",h[f]+y,"]"].join(""))}}for(var f=0;f<t.scalarArgs.length;++f){x.push("Y"+f)}if(t.shapeArgs.length>0){_.push("shape=SS.slice(0)")}if(t.indexArgs.length>0){var w=new Array(r);for(var f=0;f<r;++f){w[f]="0"}_.push(["index=[",w.join(","),"]"].join(""))}for(var f=0;f<t.offsetArgs.length;++f){var k=t.offsetArgs[f];var M=[];for(var y=0;y<k.offset.length;++y){if(k.offset[y]===0){continue}else if(k.offset[y]===1){M.push(["t",k.array,"p",y].join(""))}else{M.push([k.offset[y],"*t",k.array,"p",y].join(""))}}if(M.length===0){_.push("q"+f+"=0")}else{_.push(["q",f,"=",M.join("+")].join(""))}}var A=n([].concat(t.pre.thisVars).concat(t.body.thisVars).concat(t.post.thisVars));_=_.concat(A);if(_.length>0){b.push("var "+_.join(","))}for(var f=0;f<t.arrayArgs.length;++f){b.push("p"+f+"|=0")}if(t.pre.body.length>3){b.push(s(t.pre,t,c))}var T=s(t.body,t,c);var S=o(g);if(S<r){b.push(i(S,g[0],t,T))}else{b.push(a(g[0],t,T))}if(t.post.body.length>3){b.push(s(t.post,t,c))}if(t.debug){console.log("-----Generated cwise routine for ",e,":\n"+b.join("\n")+"\n----------")}var E=[t.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",S,l(c)].join("");var C=new Function(["function ",E,"(",x.join(","),"){",b.join("\n"),"} return ",E].join(""));return C()}e.exports=u},{uniq:509}],135:[function(t,e,r){"use strict";var n=t("./compile.js");function a(t){var e=["'use strict'","var CACHED={}"];var r=[];var a=t.funcName+"_cwise_thunk";e.push(["return function ",a,"(",t.shimArgs.join(","),"){"].join(""));var i=[];var o=[];var s=[["array",t.arrayArgs[0],".shape.slice(",Math.max(0,t.arrayBlockIndices[0]),t.arrayBlockIndices[0]<0?","+t.arrayBlockIndices[0]+")":")"].join("")];var l=[],u=[];for(var c=0;c<t.arrayArgs.length;++c){var f=t.arrayArgs[c];r.push(["t",f,"=array",f,".dtype,","r",f,"=array",f,".order"].join(""));i.push("t"+f);i.push("r"+f);o.push("t"+f);o.push("r"+f+".join()");s.push("array"+f+".data");s.push("array"+f+".stride");s.push("array"+f+".offset|0");if(c>0){l.push("array"+t.arrayArgs[0]+".shape.length===array"+f+".shape.length+"+(Math.abs(t.arrayBlockIndices[0])-Math.abs(t.arrayBlockIndices[c])));u.push("array"+t.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[0])+"]===array"+f+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[c])+"]")}}if(t.arrayArgs.length>1){e.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')");e.push("for(var shapeIndex=array"+t.arrayArgs[0]+".shape.length-"+Math.abs(t.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {");e.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')");e.push("}")}for(var c=0;c<t.scalarArgs.length;++c){s.push("scalar"+t.scalarArgs[c])}r.push(["type=[",o.join(","),"].join()"].join(""));r.push("proc=CACHED[type]");e.push("var "+r.join(","));e.push(["if(!proc){","CACHED[type]=proc=compile([",i.join(","),"])}","return proc(",s.join(","),")}"].join(""));if(t.debug){console.log("-----Generated thunk:\n"+e.join("\n")+"\n----------")}var h=new Function("compile",e.join("\n"));return h(n.bind(undefined,t))}e.exports=a},{"./compile.js":134}],136:[function(t,e,r){e.exports=t("cwise-compiler")},{"cwise-compiler":133}],137:[function(t,e,r){"use strict";var n=t("es5-ext/object/copy"),a=t("es5-ext/object/normalize-options"),i=t("es5-ext/object/valid-callable"),o=t("es5-ext/object/map"),s=t("es5-ext/object/valid-callable"),l=t("es5-ext/object/valid-value"),u=Function.prototype.bind,c=Object.defineProperty,f=Object.prototype.hasOwnProperty,h;h=function(t,e,r){var a=l(e)&&s(e.value),i;i=n(e);delete i.writable;delete i.value;i.get=function(){if(!r.overwriteDefinition&&f.call(this,t))return a;e.value=u.call(a,r.resolveContext?r.resolveContext(this):this);c(this,t,e);return this[t]};return i};e.exports=function(t){var e=a(arguments[1]);if(e.resolveContext!=null)i(e.resolveContext);return o(t,function(t,r){return h(r,t,e)})}},{"es5-ext/object/copy":173,"es5-ext/object/map":182,"es5-ext/object/normalize-options":183,"es5-ext/object/valid-callable":187,"es5-ext/object/valid-value":189}],138:[function(t,e,r){"use strict";var n=t("es5-ext/object/assign"),a=t("es5-ext/object/normalize-options"),i=t("es5-ext/object/is-callable"),o=t("es5-ext/string/#/contains"),s;s=e.exports=function(t,e){var r,i,s,l,u;if(arguments.length<2||typeof t!=="string"){l=e;e=t;t=null}else{l=arguments[2]}if(t==null){r=s=true;i=false}else{r=o.call(t,"c");i=o.call(t,"e");s=o.call(t,"w")}u={value:e,configurable:r,enumerable:i,writable:s};return!l?u:n(a(l),u)};s.gs=function(t,e,r){var s,l,u,c;if(typeof t!=="string"){u=r;r=e;e=t;t=null}else{u=arguments[3]}if(e==null){e=undefined}else if(!i(e)){u=e;e=r=undefined}else if(r==null){r=undefined}else if(!i(r)){u=r;r=undefined}if(t==null){s=true;l=false}else{s=o.call(t,"c");l=o.call(t,"e")}c={get:e,set:r,configurable:s,enumerable:l};return!u?c:n(a(u),c)}},{"es5-ext/object/assign":170,"es5-ext/object/is-callable":176,"es5-ext/object/normalize-options":183,"es5-ext/string/#/contains":190}],139:[function(e,r,n){(function(e,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof t==="function"&&t.amd?t(["exports"],a):a(e.d3=e.d3||{})})(this,function(t){"use strict";var e=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN};var r=function(t){if(t.length===1)t=n(t);return{left:function(e,r,n,a){if(n==null)n=0;if(a==null)a=e.length;while(n<a){var i=n+a>>>1;if(t(e[i],r)<0)n=i+1;else a=i}return n},right:function(e,r,n,a){if(n==null)n=0;if(a==null)a=e.length;while(n<a){var i=n+a>>>1;if(t(e[i],r)>0)a=i;else n=i+1}return n}}};function n(t){return function(r,n){return e(t(r),n)}}var a=r(e);var i=a.right;var o=a.left;var s=function(t,e){if(e==null)e=l;var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);while(r<n)i[r]=e(a,a=t[++r]);return i};function l(t,e){return[t,e]}var u=function(t,e,r){var n=t.length,a=e.length,i=new Array(n*a),o,s,u,c;if(r==null)r=l;for(o=u=0;o<n;++o){for(c=t[o],s=0;s<a;++s,++u){i[u]=r(c,e[s])}}return i};var c=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN};var f=function(t){return t===null?NaN:+t};var h=function(t,e){var r=t.length,n=0,a=-1,i=0,o,s,l=0;if(e==null){while(++a<r){if(!isNaN(o=f(t[a]))){s=o-i;i+=s/++n;l+=s*(o-i)}}}else{while(++a<r){if(!isNaN(o=f(e(t[a],a,t)))){s=o-i;i+=s/++n;l+=s*(o-i)}}}if(n>1)return l/(n-1)};var p=function(t,e){var r=h(t,e);return r?Math.sqrt(r):r};var d=function(t,e){var r=t.length,n=-1,a,i,o;if(e==null){while(++n<r){if((a=t[n])!=null&&a>=a){i=o=a;while(++n<r){if((a=t[n])!=null){if(i>a)i=a;if(o<a)o=a}}}}}else{while(++n<r){if((a=e(t[n],n,t))!=null&&a>=a){i=o=a;while(++n<r){if((a=e(t[n],n,t))!=null){if(i>a)i=a;if(o<a)o=a}}}}}return[i,o]};var v=Array.prototype;var g=v.slice;var m=v.map;var y=function(t){return function(){return t}};var x=function(t){return t};var b=function(t,e,r){t=+t,e=+e,r=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+r;var n=-1,a=Math.max(0,Math.ceil((e-t)/r))|0,i=new Array(a);while(++n<a){i[n]=t+n*r}return i};var _=Math.sqrt(50);var w=Math.sqrt(10);var k=Math.sqrt(2);var M=function(t,e,r){var n,a=-1,i,o,s;e=+e,t=+t,r=+r;if(t===e&&r>0)return[t];if(n=e<t)i=t,t=e,e=i;if((s=A(t,e,r))===0||!isFinite(s))return[];if(s>0){t=Math.ceil(t/s);e=Math.floor(e/s);o=new Array(i=Math.ceil(e-t+1));while(++a<i)o[a]=(t+a)*s}else{t=Math.floor(t*s);e=Math.ceil(e*s);o=new Array(i=Math.ceil(t-e+1));while(++a<i)o[a]=(t-a)/s}if(n)o.reverse();return o};function A(t,e,r){var n=(e-t)/Math.max(0,r),a=Math.floor(Math.log(n)/Math.LN10),i=n/Math.pow(10,a);return a>=0?(i>=_?10:i>=w?5:i>=k?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(i>=_?10:i>=w?5:i>=k?2:1)}function T(t,e,r){var n=Math.abs(e-t)/Math.max(0,r),a=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),i=n/a;if(i>=_)a*=10;else if(i>=w)a*=5;else if(i>=k)a*=2;return e<t?-a:a}var S=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1};var E=function(){var t=x,e=d,r=S;function n(n){var a,o=n.length,s,l=new Array(o);for(a=0;a<o;++a){l[a]=t(n[a],a,n)}var u=e(l),c=u[0],f=u[1],h=r(l,c,f);if(!Array.isArray(h)){h=T(c,f,h);h=b(Math.ceil(c/h)*h,Math.floor(f/h)*h,h)}var p=h.length;while(h[0]<=c)h.shift(),--p;while(h[p-1]>f)h.pop(),--p;var d=new Array(p+1),v;for(a=0;a<=p;++a){v=d[a]=[];v.x0=a>0?h[a-1]:c;v.x1=a<p?h[a]:f}for(a=0;a<o;++a){s=l[a];if(c<=s&&s<=f){d[i(h,s,0,p)].push(n[a])}}return d}n.value=function(e){return arguments.length?(t=typeof e==="function"?e:y(e),n):t};n.domain=function(t){return arguments.length?(e=typeof t==="function"?t:y([t[0],t[1]]),n):e};n.thresholds=function(t){return arguments.length?(r=typeof t==="function"?t:Array.isArray(t)?y(g.call(t)):y(t),n):r};return n};var C=function(t,e,r){if(r==null)r=f;if(!(n=t.length))return;if((e=+e)<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,a=(n-1)*e,i=Math.floor(a),o=+r(t[i],i,t),s=+r(t[i+1],i+1,t);return o+(s-o)*(a-i)};var L=function(t,r,n){t=m.call(t,f).sort(e);return Math.ceil((n-r)/(2*(C(t,.75)-C(t,.25))*Math.pow(t.length,-1/3)))};var I=function(t,e,r){return Math.ceil((r-e)/(3.5*p(t)*Math.pow(t.length,-1/3)))};var z=function(t,e){var r=t.length,n=-1,a,i;if(e==null){while(++n<r){if((a=t[n])!=null&&a>=a){i=a;while(++n<r){if((a=t[n])!=null&&a>i){i=a}}}}}else{while(++n<r){if((a=e(t[n],n,t))!=null&&a>=a){i=a;while(++n<r){if((a=e(t[n],n,t))!=null&&a>i){i=a}}}}}return i};var P=function(t,e){var r=t.length,n=r,a=-1,i,o=0;if(e==null){while(++a<r){if(!isNaN(i=f(t[a])))o+=i;else--n}}else{while(++a<r){if(!isNaN(i=f(e(t[a],a,t))))o+=i;else--n}}if(n)return o/n};var O=function(t,r){var n=t.length,a=-1,i,o=[];if(r==null){while(++a<n){if(!isNaN(i=f(t[a]))){o.push(i)}}}else{while(++a<n){if(!isNaN(i=f(r(t[a],a,t)))){o.push(i)}}}return C(o.sort(e),.5)};var D=function(t){var e=t.length,r,n=-1,a=0,i,o;while(++n<e)a+=t[n].length;i=new Array(a);while(--e>=0){o=t[e];r=o.length;while(--r>=0){i[--a]=o[r]}}return i};var R=function(t,e){var r=t.length,n=-1,a,i;if(e==null){while(++n<r){if((a=t[n])!=null&&a>=a){i=a;while(++n<r){if((a=t[n])!=null&&i>a){i=a}}}}}else{while(++n<r){if((a=e(t[n],n,t))!=null&&a>=a){i=a;while(++n<r){if((a=e(t[n],n,t))!=null&&i>a){i=a}}}}}return i};var B=function(t,e){var r=e.length,n=new Array(r);while(r--)n[r]=t[e[r]];return n};var F=function(t,r){if(!(n=t.length))return;var n,a=0,i=0,o,s=t[i];if(r==null)r=e;while(++a<n){if(r(o=t[a],s)<0||r(s,s)!==0){s=o,i=a}}if(r(s,s)===0)return i};var N=function(t,e,r){var n=(r==null?t.length:r)-(e=e==null?0:+e),a,i;while(n){i=Math.random()*n--|0;a=t[n+e];t[n+e]=t[i+e];t[i+e]=a}return t};var j=function(t,e){var r=t.length,n=-1,a,i=0;if(e==null){while(++n<r){if(a=+t[n])i+=a}}else{while(++n<r){if(a=+e(t[n],n,t))i+=a}}return i};var V=function(t){if(!(i=t.length))return[];for(var e=-1,r=R(t,U),n=new Array(r);++e<r;){for(var a=-1,i,o=n[e]=new Array(i);++a<i;){o[a]=t[a][e]}}return n};function U(t){return t.length}var q=function(){return V(arguments)};t.bisect=i;t.bisectRight=i;t.bisectLeft=o;t.ascending=e;t.bisector=r;t.cross=u;t.descending=c;t.deviation=p;t.extent=d;t.histogram=E;t.thresholdFreedmanDiaconis=L;t.thresholdScott=I;t.thresholdSturges=S;t.max=z;t.mean=P;t.median=O;t.merge=D;t.min=R;t.pairs=s;t.permute=B;t.quantile=C;t.range=b;t.scan=F;t.shuffle=N;t.sum=j;t.ticks=M;t.tickIncrement=A;t.tickStep=T;t.transpose=V;t.variance=h;t.zip=q;Object.defineProperty(t,"__esModule",{value:true})})},{}],140:[function(e,r,n){(function(e,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof t==="function"&&t.amd?t(["exports"],a):a(e.d3=e.d3||{})})(this,function(t){"use strict";var e="$";function r(){}r.prototype=n.prototype={constructor:r,has:function(t){return e+t in this},get:function(t){return this[e+t]},set:function(t,r){this[e+t]=r;return this},remove:function(t){var r=e+t;return r in this&&delete this[r]},clear:function(){for(var t in this)if(t[0]===e)delete this[t]},keys:function(){var t=[];for(var r in this)if(r[0]===e)t.push(r.slice(1));return t},values:function(){var t=[];for(var r in this)if(r[0]===e)t.push(this[r]);return t},entries:function(){var t=[];for(var r in this)if(r[0]===e)t.push({key:r.slice(1),value:this[r]});return t},size:function(){var t=0;for(var r in this)if(r[0]===e)++t;return t},empty:function(){for(var t in this)if(t[0]===e)return false;return true},each:function(t){for(var r in this)if(r[0]===e)t(this[r],r.slice(1),this)}};function n(t,e){var n=new r;if(t instanceof r)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var a=-1,i=t.length,o;if(e==null)while(++a<i)n.set(a,t[a]);else while(++a<i)n.set(e(o=t[a],a,t),o)}else if(t)for(var s in t)n.set(s,t[s]);return n}var a=function(){var t=[],e=[],r,a,u;function c(e,i,o,s){if(i>=t.length){if(r!=null)e.sort(r);return a!=null?a(e):e}var l=-1,u=e.length,f=t[i++],h,p,d=n(),v,g=o();while(++l<u){if(v=d.get(h=f(p=e[l])+"")){v.push(p)}else{d.set(h,[p])}}d.each(function(t,e){s(g,e,c(t,i,o,s))});return g}function f(r,n){if(++n>t.length)return r;var i,o=e[n-1];if(a!=null&&n>=t.length)i=r.entries();else i=[],r.each(function(t,e){i.push({key:e,values:f(t,n)})});return o!=null?i.sort(function(t,e){return o(t.key,e.key)}):i}return u={object:function(t){return c(t,0,i,o)},map:function(t){return c(t,0,s,l)},entries:function(t){return f(c(t,0,s,l),0)},key:function(e){t.push(e);return u},sortKeys:function(r){e[t.length-1]=r;return u},sortValues:function(t){r=t;return u},rollup:function(t){a=t;return u}}};function i(){return{}}function o(t,e,r){t[e]=r}function s(){return n()}function l(t,e,r){t.set(e,r)}function u(){}var c=n.prototype;u.prototype=f.prototype={constructor:u,has:c.has,add:function(t){t+="";this[e+t]=t;return this},remove:c.remove,clear:c.clear,values:c.keys,size:c.size,empty:c.empty,each:c.each};function f(t,e){var r=new u;if(t instanceof u)t.each(function(t){r.add(t)});else if(t){var n=-1,a=t.length;if(e==null)while(++n<a)r.add(t[n]);else while(++n<a)r.add(e(t[n],n,t))}return r}var h=function(t){var e=[];for(var r in t)e.push(r);return e};var p=function(t){var e=[];for(var r in t)e.push(t[r]);return e};var d=function(t){var e=[];for(var r in t)e.push({key:r,value:t[r]});return e};t.nest=a;t.set=f;t.map=n;t.keys=h;t.values=p;t.entries=d;Object.defineProperty(t,"__esModule",{value:true})})},{}],141:[function(e,r,n){(function(e,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof t==="function"&&t.amd?t(["exports"],a):a(e.d3=e.d3||{})})(this,function(t){"use strict";var e=function(t,e,r){t.prototype=e.prototype=r;r.constructor=t};function r(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function n(){}var a=.7;var i=1/a;var o="\\s*([+-]?\\d+)\\s*";var s="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*";var l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*";var u=/^#([0-9a-f]{3})$/;var c=/^#([0-9a-f]{6})$/;var f=new RegExp("^rgb\\("+[o,o,o]+"\\)$");var h=new RegExp("^rgb\\("+[l,l,l]+"\\)$");var p=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$");var d=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$");var v=new RegExp("^hsl\\("+[s,l,l]+"\\)$");var g=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$");var m={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};e(n,y,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}});function y(t){var e;t=(t+"").trim().toLowerCase();return(e=u.exec(t))?(e=parseInt(e[1],16),new k(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1)):(e=c.exec(t))?x(parseInt(e[1],16)):(e=f.exec(t))?new k(e[1],e[2],e[3],1):(e=h.exec(t))?new k(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=p.exec(t))?b(e[1],e[2],e[3],e[4]):(e=d.exec(t))?b(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=v.exec(t))?M(e[1],e[2]/100,e[3]/100,1):(e=g.exec(t))?M(e[1],e[2]/100,e[3]/100,e[4]):m.hasOwnProperty(t)?x(m[t]):t==="transparent"?new k(NaN,NaN,NaN,0):null}function x(t){return new k(t>>16&255,t>>8&255,t&255,1)}function b(t,e,r,n){if(n<=0)t=e=r=NaN;return new k(t,e,r,n)}function _(t){if(!(t instanceof n))t=y(t);if(!t)return new k;t=t.rgb();return new k(t.r,t.g,t.b,t.opacity)}function w(t,e,r,n){return arguments.length===1?_(t):new k(t,e,r,n==null?1:n)}function k(t,e,r,n){this.r=+t;this.g=+e;this.b=+r;this.opacity=+n}e(k,w,r(n,{brighter:function(t){t=t==null?i:Math.pow(i,t);return new k(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){t=t==null?a:Math.pow(a,t);return new k(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&(0<=this.g&&this.g<=255)&&(0<=this.b&&this.b<=255)&&(0<=this.opacity&&this.opacity<=1)},toString:function(){var t=this.opacity;t=isNaN(t)?1:Math.max(0,Math.min(1,t));return(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}}));function M(t,e,r,n){if(n<=0)t=e=r=NaN;else if(r<=0||r>=1)t=e=NaN;else if(e<=0)t=NaN;return new S(t,e,r,n)}function A(t){if(t instanceof S)return new S(t.h,t.s,t.l,t.opacity);if(!(t instanceof n))t=y(t);if(!t)return new S;if(t instanceof S)return t;t=t.rgb();var e=t.r/255,r=t.g/255,a=t.b/255,i=Math.min(e,r,a),o=Math.max(e,r,a),s=NaN,l=o-i,u=(o+i)/2;if(l){if(e===o)s=(r-a)/l+(r<a)*6;else if(r===o)s=(a-e)/l+2;else s=(e-r)/l+4;l/=u<.5?o+i:2-o-i;s*=60}else{l=u>0&&u<1?0:s}return new S(s,l,u,t.opacity)}function T(t,e,r,n){return arguments.length===1?A(t):new S(t,e,r,n==null?1:n)}function S(t,e,r,n){this.h=+t;this.s=+e;this.l=+r;this.opacity=+n}e(S,T,r(n,{brighter:function(t){t=t==null?i:Math.pow(i,t);return new S(this.h,this.s,this.l*t,this.opacity)},darker:function(t){t=t==null?a:Math.pow(a,t);return new S(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new k(E(t>=240?t-240:t+120,a,n),E(t,a,n),E(t<120?t+240:t-120,a,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&(0<=this.l&&this.l<=1)&&(0<=this.opacity&&this.opacity<=1)}}));function E(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}var C=Math.PI/180;var L=180/Math.PI;var I=18;var z=.95047;var P=1;var O=1.08883;var D=4/29;var R=6/29;var B=3*R*R;var F=R*R*R;function N(t){if(t instanceof V)return new V(t.l,t.a,t.b,t.opacity);if(t instanceof X){var e=t.h*C;return new V(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}if(!(t instanceof k))t=_(t);var r=G(t.r),n=G(t.g),a=G(t.b),i=U((.4124564*r+.3575761*n+.1804375*a)/z),o=U((.2126729*r+.7151522*n+.072175*a)/P),s=U((.0193339*r+.119192*n+.9503041*a)/O);return new V(116*o-16,500*(i-o),200*(o-s),t.opacity)}function j(t,e,r,n){return arguments.length===1?N(t):new V(t,e,r,n==null?1:n)}function V(t,e,r,n){this.l=+t;this.a=+e;this.b=+r;this.opacity=+n}e(V,j,r(n,{brighter:function(t){return new V(this.l+I*(t==null?1:t),this.a,this.b,this.opacity)},darker:function(t){return new V(this.l-I*(t==null?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,r=isNaN(this.b)?t:t-this.b/200;t=P*q(t);e=z*q(e);r=O*q(r);return new k(H(3.2404542*e-1.5371385*t-.4985314*r),H(-.969266*e+1.8760108*t+.041556*r),H(.0556434*e-.2040259*t+1.0572252*r),this.opacity)}}));function U(t){return t>F?Math.pow(t,1/3):t/B+D}function q(t){return t>R?t*t*t:B*(t-D)}function H(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function G(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function W(t){if(t instanceof X)return new X(t.h,t.c,t.l,t.opacity);if(!(t instanceof V))t=N(t);var e=Math.atan2(t.b,t.a)*L;return new X(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Y(t,e,r,n){return arguments.length===1?W(t):new X(t,e,r,n==null?1:n)}function X(t,e,r,n){this.h=+t;this.c=+e;this.l=+r;this.opacity=+n}e(X,Y,r(n,{brighter:function(t){return new X(this.h,this.c,this.l+I*(t==null?1:t),this.opacity)},darker:function(t){return new X(this.h,this.c,this.l-I*(t==null?1:t),this.opacity)},rgb:function(){return N(this).rgb()}}));var Z=-.14861;var $=+1.78277;var J=-.29227;var K=-.90649;var Q=+1.97294;var tt=Q*K;var et=Q*$;var rt=$*J-K*Z;function nt(t){if(t instanceof it)return new it(t.h,t.s,t.l,t.opacity);if(!(t instanceof k))t=_(t);var e=t.r/255,r=t.g/255,n=t.b/255,a=(rt*n+tt*e-et*r)/(rt+tt-et),i=n-a,o=(Q*(r-a)-J*i)/K,s=Math.sqrt(o*o+i*i)/(Q*a*(1-a)),l=s?Math.atan2(o,i)*L-120:NaN;return new it(l<0?l+360:l,s,a,t.opacity)}function at(t,e,r,n){return arguments.length===1?nt(t):new it(t,e,r,n==null?1:n)}function it(t,e,r,n){this.h=+t;this.s=+e;this.l=+r;this.opacity=+n}e(it,at,r(n,{brighter:function(t){t=t==null?i:Math.pow(i,t);return new it(this.h,this.s,this.l*t,this.opacity)},darker:function(t){t=t==null?a:Math.pow(a,t);return new it(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*C,e=+this.l,r=isNaN(this.s)?0:this.s*e*(1-e),n=Math.cos(t),a=Math.sin(t);return new k(255*(e+r*(Z*n+$*a)),255*(e+r*(J*n+K*a)),255*(e+r*(Q*n)),this.opacity)}}));t.color=y;t.rgb=w;t.hsl=T;t.lab=j;t.hcl=Y;t.cubehelix=at;Object.defineProperty(t,"__esModule",{value:true})})},{}],142:[function(e,r,n){(function(e,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof t==="function"&&t.amd?t(["exports"],a):a(e.d3=e.d3||{})})(this,function(t){"use strict";var e={value:function(){}};function r(){for(var t=0,e=arguments.length,r={},a;t<e;++t){if(!(a=arguments[t]+"")||a in r)throw new Error("illegal type: "+a);r[a]=[]}return new n(r)}function n(t){this._=t}function a(t,e){return t.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");if(n>=0)r=t.slice(n+1),t=t.slice(0,n);if(t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:r}})}n.prototype=r.prototype={constructor:n,on:function(t,e){var r=this._,n=a(t+"",r),s,l=-1,u=n.length;if(arguments.length<2){while(++l<u)if((s=(t=n[l]).type)&&(s=i(r[s],t.name)))return s;return}if(e!=null&&typeof e!=="function")throw new Error("invalid callback: "+e);while(++l<u){if(s=(t=n[l]).type)r[s]=o(r[s],t.name,e);else if(e==null)for(s in r)r[s]=o(r[s],t.name,null)}return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new n(t)},call:function(t,e){if((a=arguments.length-2)>0)for(var r=new Array(a),n=0,a,i;n<a;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],n=0,a=i.length;n<a;++n)i[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],a=0,i=n.length;a<i;++a)n[a].value.apply(e,r)}};function i(t,e){for(var r=0,n=t.length,a;r<n;++r){if((a=t[r]).name===e){return a.value}}}function o(t,r,n){for(var a=0,i=t.length;a<i;++a){if(t[a].name===r){t[a]=e,t=t.slice(0,a).concat(t.slice(a+1));break}}if(n!=null)t.push({name:r,value:n});return t}t.dispatch=r;Object.defineProperty(t,"__esModule",{value:true})})},{}],143:[function(e,r,n){(function(a,i){typeof n==="object"&&typeof r!=="undefined"?i(n,e("d3-quadtree"),e("d3-collection"),e("d3-dispatch"),e("d3-timer")):typeof t==="function"&&t.amd?t(["exports","d3-quadtree","d3-collection","d3-dispatch","d3-timer"],i):i(a.d3=a.d3||{},a.d3,a.d3,a.d3,a.d3)})(this,function(t,e,r,n,a){"use strict";var i=function(t,e){var r;if(t==null)t=0;if(e==null)e=0;function n(){var n,a=r.length,i,o=0,s=0;for(n=0;n<a;++n){i=r[n],o+=i.x,s+=i.y}for(o=o/a-t,s=s/a-e,n=0;n<a;++n){i=r[n],i.x-=o,i.y-=s}}n.initialize=function(t){r=t};n.x=function(e){return arguments.length?(t=+e,n):t};n.y=function(t){return arguments.length?(e=+t,n):e};return n};var o=function(t){return function(){return t}};var s=function(){return(Math.random()-.5)*1e-6};function l(t){return t.x+t.vx}function u(t){return t.y+t.vy}var c=function(t){var r,n,a=1,i=1;if(typeof t!=="function")t=o(t==null?1:+t);function c(){var t,o=r.length,c,h,p,d,v,g;for(var m=0;m<i;++m){c=e.quadtree(r,l,u).visitAfter(f);for(t=0;t<o;++t){h=r[t];v=n[h.index],g=v*v;p=h.x+h.vx;d=h.y+h.vy;c.visit(y)}}function y(t,e,r,n,i){var o=t.data,l=t.r,u=v+l;if(o){if(o.index>h.index){var c=p-o.x-o.vx,f=d-o.y-o.vy,m=c*c+f*f;if(m<u*u){if(c===0)c=s(),m+=c*c;if(f===0)f=s(),m+=f*f;m=(u-(m=Math.sqrt(m)))/m*a;h.vx+=(c*=m)*(u=(l*=l)/(g+l));h.vy+=(f*=m)*u;o.vx-=c*(u=1-u);o.vy-=f*u}}return}return e>p+u||n<p-u||r>d+u||i<d-u}}function f(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e){if(t[e]&&t[e].r>t.r){t.r=t[e].r}}}function h(){if(!r)return;var e,a=r.length,i;n=new Array(a);for(e=0;e<a;++e)i=r[e],n[i.index]=+t(i,e,r)}c.initialize=function(t){r=t;h()};c.iterations=function(t){return arguments.length?(i=+t,c):i};c.strength=function(t){return arguments.length?(a=+t,c):a};c.radius=function(e){return arguments.length?(t=typeof e==="function"?e:o(+e),h(),c):t};return c};function f(t){return t.index}function h(t,e){var r=t.get(e);if(!r)throw new Error("missing: "+e);return r}var p=function(t){var e=f,n=v,a,i=o(30),l,u,c,p,d=1;if(t==null)t=[];function v(t){return 1/Math.min(c[t.source.index],c[t.target.index])}function g(e){for(var r=0,n=t.length;r<d;++r){for(var i=0,o,u,c,f,h,v,g;i<n;++i){o=t[i],u=o.source,c=o.target;f=c.x+c.vx-u.x-u.vx||s();h=c.y+c.vy-u.y-u.vy||s();v=Math.sqrt(f*f+h*h);v=(v-l[i])/v*e*a[i];f*=v,h*=v;c.vx-=f*(g=p[i]);c.vy-=h*g;u.vx+=f*(g=1-g);u.vy+=h*g}}}function m(){if(!u)return;var n,i=u.length,o=t.length,s=r.map(u,e),f;for(n=0,c=new Array(i);n<o;++n){f=t[n],f.index=n;if(typeof f.source!=="object")f.source=h(s,f.source);if(typeof f.target!=="object")f.target=h(s,f.target);c[f.source.index]=(c[f.source.index]||0)+1;c[f.target.index]=(c[f.target.index]||0)+1}for(n=0,p=new Array(o);n<o;++n){f=t[n],p[n]=c[f.source.index]/(c[f.source.index]+c[f.target.index])}a=new Array(o),y();l=new Array(o),x()}function y(){if(!u)return;for(var e=0,r=t.length;e<r;++e){a[e]=+n(t[e],e,t)}}function x(){if(!u)return;for(var e=0,r=t.length;e<r;++e){l[e]=+i(t[e],e,t)}}g.initialize=function(t){u=t;m()};g.links=function(e){return arguments.length?(t=e,m(),g):t};g.id=function(t){return arguments.length?(e=t,g):e};g.iterations=function(t){return arguments.length?(d=+t,g):d};g.strength=function(t){return arguments.length?(n=typeof t==="function"?t:o(+t),y(),g):n};g.distance=function(t){return arguments.length?(i=typeof t==="function"?t:o(+t),x(),g):i};return g};function d(t){return t.x}function v(t){return t.y}var g=10;var m=Math.PI*(3-Math.sqrt(5));var y=function(t){var e,i=1,o=.001,s=1-Math.pow(o,1/300),l=0,u=.6,c=r.map(),f=a.timer(p),h=n.dispatch("tick","end");if(t==null)t=[];function p(){d();h.call("tick",e);if(i<o){f.stop();h.call("end",e)}}function d(){var e,r=t.length,n;i+=(l-i)*s;c.each(function(t){t(i)});for(e=0;e<r;++e){n=t[e];if(n.fx==null)n.x+=n.vx*=u;else n.x=n.fx,n.vx=0;if(n.fy==null)n.y+=n.vy*=u;else n.y=n.fy,n.vy=0}}function v(){for(var e=0,r=t.length,n;e<r;++e){n=t[e],n.index=e;if(isNaN(n.x)||isNaN(n.y)){var a=g*Math.sqrt(e),i=e*m;n.x=a*Math.cos(i);n.y=a*Math.sin(i)}if(isNaN(n.vx)||isNaN(n.vy)){n.vx=n.vy=0}}}function y(e){if(e.initialize)e.initialize(t);return e}v();return e={tick:d,restart:function(){return f.restart(p),e},stop:function(){return f.stop(),e},nodes:function(r){return arguments.length?(t=r,v(),c.each(y),e):t},alpha:function(t){return arguments.length?(i=+t,e):i},alphaMin:function(t){return arguments.length?(o=+t,e):o},alphaDecay:function(t){return arguments.length?(s=+t,e):+s},alphaTarget:function(t){return arguments.length?(l=+t,e):l},velocityDecay:function(t){return arguments.length?(u=1-t,e):1-u},force:function(t,r){return arguments.length>1?(r==null?c.remove(t):c.set(t,y(r)),e):c.get(t)},find:function(e,r,n){var a=0,i=t.length,o,s,l,u,c;if(n==null)n=Infinity;else n*=n;for(a=0;a<i;++a){u=t[a];o=e-u.x;s=r-u.y;l=o*o+s*s;if(l<n)c=u,n=l}return c},on:function(t,r){return arguments.length>1?(h.on(t,r),e):h.on(t)}}};var x=function(){var t,r,n,a=o(-30),i,l=1,u=Infinity,c=.81;function f(a){var i,o=t.length,s=e.quadtree(t,d,v).visitAfter(p);for(n=a,i=0;i<o;++i)r=t[i],s.visit(g)}function h(){if(!t)return;var e,r=t.length,n;i=new Array(r);for(e=0;e<r;++e)n=t[e],i[n.index]=+a(n,e,t)}function p(t){var e=0,r,n,a=0,o,s,l;if(t.length){for(o=s=l=0;l<4;++l){if((r=t[l])&&(n=Math.abs(r.value))){e+=r.value,a+=n,o+=n*r.x,s+=n*r.y}}t.x=o/a;t.y=s/a}else{r=t;r.x=r.data.x;r.y=r.data.y;do{e+=i[r.data.index]}while(r=r.next)}t.value=e}function g(t,e,a,o){if(!t.value)return true;var f=t.x-r.x,h=t.y-r.y,p=o-e,d=f*f+h*h;if(p*p/c<d){if(d<u){if(f===0)f=s(),d+=f*f;if(h===0)h=s(),d+=h*h;if(d<l)d=Math.sqrt(l*d);r.vx+=f*t.value*n/d;r.vy+=h*t.value*n/d}return true}else if(t.length||d>=u)return;if(t.data!==r||t.next){if(f===0)f=s(),d+=f*f;if(h===0)h=s(),d+=h*h;if(d<l)d=Math.sqrt(l*d)}do{if(t.data!==r){p=i[t.data.index]*n/d;r.vx+=f*p;r.vy+=h*p}}while(t=t.next)}f.initialize=function(e){t=e;h()};f.strength=function(t){return arguments.length?(a=typeof t==="function"?t:o(+t),h(),f):a};f.distanceMin=function(t){return arguments.length?(l=t*t,f):Math.sqrt(l)};f.distanceMax=function(t){return arguments.length?(u=t*t,f):Math.sqrt(u)};f.theta=function(t){return arguments.length?(c=t*t,f):Math.sqrt(c)};return f};var b=function(t,e,r){var n,a=o(.1),i,s;if(typeof t!=="function")t=o(+t);if(e==null)e=0;if(r==null)r=0;function l(t){for(var a=0,o=n.length;a<o;++a){var l=n[a],u=l.x-e||1e-6,c=l.y-r||1e-6,f=Math.sqrt(u*u+c*c),h=(s[a]-f)*i[a]*t/f;l.vx+=u*h;l.vy+=c*h}}function u(){if(!n)return;var e,r=n.length;i=new Array(r);s=new Array(r);for(e=0;e<r;++e){s[e]=+t(n[e],e,n);i[e]=isNaN(s[e])?0:+a(n[e],e,n)}}l.initialize=function(t){n=t,u()};l.strength=function(t){return arguments.length?(a=typeof t==="function"?t:o(+t),u(),l):a};l.radius=function(e){return arguments.length?(t=typeof e==="function"?e:o(+e),u(),l):t};l.x=function(t){return arguments.length?(e=+t,l):e};l.y=function(t){return arguments.length?(r=+t,l):r};return l};var _=function(t){var e=o(.1),r,n,a;if(typeof t!=="function")t=o(t==null?0:+t);function i(t){for(var e=0,i=r.length,o;e<i;++e){o=r[e],o.vx+=(a[e]-o.x)*n[e]*t}}function s(){if(!r)return;var i,o=r.length;n=new Array(o);a=new Array(o);for(i=0;i<o;++i){n[i]=isNaN(a[i]=+t(r[i],i,r))?0:+e(r[i],i,r)}}i.initialize=function(t){r=t;s()};i.strength=function(t){return arguments.length?(e=typeof t==="function"?t:o(+t),s(),i):e};i.x=function(e){return arguments.length?(t=typeof e==="function"?e:o(+e),s(),i):t};return i};var w=function(t){var e=o(.1),r,n,a;if(typeof t!=="function")t=o(t==null?0:+t);function i(t){for(var e=0,i=r.length,o;e<i;++e){o=r[e],o.vy+=(a[e]-o.y)*n[e]*t}}function s(){if(!r)return;var i,o=r.length;n=new Array(o);a=new Array(o);for(i=0;i<o;++i){n[i]=isNaN(a[i]=+t(r[i],i,r))?0:+e(r[i],i,r)}}i.initialize=function(t){r=t;s()};i.strength=function(t){return arguments.length?(e=typeof t==="function"?t:o(+t),s(),i):e};i.y=function(e){return arguments.length?(t=typeof e==="function"?e:o(+e),s(),i):t};return i};t.forceCenter=i;t.forceCollide=c;t.forceLink=p;t.forceManyBody=x;t.forceRadial=b;t.forceSimulation=y;t.forceX=_;t.forceY=w;Object.defineProperty(t,"__esModule",{value:true})})},{"d3-collection":140,"d3-dispatch":142,"d3-quadtree":145,"d3-timer":146}],144:[function(e,r,n){(function(a,i){typeof n==="object"&&typeof r!=="undefined"?i(n,e("d3-color")):typeof t==="function"&&t.amd?t(["exports","d3-color"],i):i(a.d3=a.d3||{},a.d3)})(this,function(t,e){"use strict";function r(t,e,r,n,a){var i=t*t,o=i*t;return((1-3*t+3*i-o)*e+(4-6*i+3*o)*r+(1+3*t+3*i-3*o)*n+o*a)/6}var n=function(t){var e=t.length-1;return function(n){var a=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[a],o=t[a+1],s=a>0?t[a-1]:2*i-o,l=a<e-1?t[a+2]:2*o-i;return r((n-a/e)*e,s,i,o,l)}};var a=function(t){var e=t.length;return function(n){var a=Math.floor(((n%=1)<0?++n:n)*e),i=t[(a+e-1)%e],o=t[a%e],s=t[(a+1)%e],l=t[(a+2)%e];return r((n-a/e)*e,i,o,s,l)}};var i=function(t){return function(){return t}};function o(t,e){return function(r){return t+r*e}}function s(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function l(t,e){var r=e-t;return r?o(t,r>180||r<-180?r-360*Math.round(r/360):r):i(isNaN(t)?e:t)}function u(t){return(t=+t)===1?c:function(e,r){return r-e?s(e,r,t):i(isNaN(e)?r:e)}}function c(t,e){var r=e-t;return r?o(t,r):i(isNaN(t)?e:t)}var f=function t(r){var n=u(r);function a(t,r){var a=n((t=e.rgb(t)).r,(r=e.rgb(r)).r),i=n(t.g,r.g),o=n(t.b,r.b),s=c(t.opacity,r.opacity);return function(e){t.r=a(e);t.g=i(e);t.b=o(e);t.opacity=s(e);return t+""}}a.gamma=t;return a}(1);function h(t){return function(r){var n=r.length,a=new Array(n),i=new Array(n),o=new Array(n),s,l;for(s=0;s<n;++s){l=e.rgb(r[s]);a[s]=l.r||0;i[s]=l.g||0;o[s]=l.b||0}a=t(a);i=t(i);o=t(o);l.opacity=1;return function(t){l.r=a(t);l.g=i(t);l.b=o(t);return l+""}}}var p=h(n);var d=h(a);var v=function(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=M(t[o],e[o]);for(;o<r;++o)i[o]=e[o];return function(t){for(o=0;o<n;++o)i[o]=a[o](t);return i}};var g=function(t,e){var r=new Date;return t=+t,e-=t,function(n){return r.setTime(t+e*n),r}};var m=function(t,e){return t=+t,e-=t,function(r){return t+e*r}};var y=function(t,e){var r={},n={},a;if(t===null||typeof t!=="object")t={};if(e===null||typeof e!=="object")e={};for(a in e){if(a in t){r[a]=M(t[a],e[a])}else{n[a]=e[a]}}return function(t){for(a in r)n[a]=r[a](t);return n}};var x=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;var b=new RegExp(x.source,"g");function _(t){return function(){return t}}function w(t){return function(e){return t(e)+""}}var k=function(t,e){var r=x.lastIndex=b.lastIndex=0,n,a,i,o=-1,s=[],l=[];t=t+"",e=e+"";while((n=x.exec(t))&&(a=b.exec(e))){if((i=a.index)>r){i=e.slice(r,i);if(s[o])s[o]+=i;else s[++o]=i}if((n=n[0])===(a=a[0])){if(s[o])s[o]+=a;else s[++o]=a}else{s[++o]=null;l.push({i:o,x:m(n,a)})}r=b.lastIndex}if(r<e.length){i=e.slice(r);if(s[o])s[o]+=i;else s[++o]=i}return s.length<2?l[0]?w(l[0].x):_(e):(e=l.length,function(t){for(var r=0,n;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})};var M=function(t,r){var n=typeof r,a;return r==null||n==="boolean"?i(r):(n==="number"?m:n==="string"?(a=e.color(r))?(r=a,f):k:r instanceof e.color?f:r instanceof Date?g:Array.isArray(r)?v:typeof r.valueOf!=="function"&&typeof r.toString!=="function"||isNaN(r)?y:m)(t,r)};var A=function(t,e){return t=+t,e-=t,function(r){return Math.round(t+e*r)}};var T=180/Math.PI;var S={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};var E=function(t,e,r,n,a,i){var o,s,l;if(o=Math.sqrt(t*t+e*e))t/=o,e/=o;if(l=t*r+e*n)r-=t*l,n-=e*l;if(s=Math.sqrt(r*r+n*n))r/=s,n/=s,l/=s;if(t*n<e*r)t=-t,e=-e,l=-l,o=-o;return{translateX:a,translateY:i,rotate:Math.atan2(e,t)*T,skewX:Math.atan(l)*T,scaleX:o,scaleY:s}};var C;var L;var I;var z;function P(t){if(t==="none")return S;if(!C)C=document.createElement("DIV"),L=document.documentElement,I=document.defaultView;C.style.transform=t;t=I.getComputedStyle(L.appendChild(C),null).getPropertyValue("transform");L.removeChild(C);t=t.slice(7,-1).split(",");return E(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5])}function O(t){if(t==null)return S;if(!z)z=document.createElementNS("http://www.w3.org/2000/svg","g");z.setAttribute("transform",t);if(!(t=z.transform.baseVal.consolidate()))return S;t=t.matrix;return E(t.a,t.b,t.c,t.d,t.e,t.f)}function D(t,e,r,n){function a(t){return t.length?t.pop()+" ":""}function i(t,n,a,i,o,s){if(t!==a||n!==i){var l=o.push("translate(",null,e,null,r);s.push({i:l-4,x:m(t,a)},{i:l-2,x:m(n,i)})}else if(a||i){o.push("translate("+a+e+i+r)}}function o(t,e,r,i){if(t!==e){if(t-e>180)e+=360;else if(e-t>180)t+=360;i.push({i:r.push(a(r)+"rotate(",null,n)-2,x:m(t,e)})}else if(e){r.push(a(r)+"rotate("+e+n)}}function s(t,e,r,i){if(t!==e){i.push({i:r.push(a(r)+"skewX(",null,n)-2,x:m(t,e)})}else if(e){r.push(a(r)+"skewX("+e+n)}}function l(t,e,r,n,i,o){if(t!==r||e!==n){var s=i.push(a(i)+"scale(",null,",",null,")");o.push({i:s-4,x:m(t,r)},{i:s-2,x:m(e,n)})}else if(r!==1||n!==1){i.push(a(i)+"scale("+r+","+n+")")}}return function(e,r){var n=[],a=[];e=t(e),r=t(r);i(e.translateX,e.translateY,r.translateX,r.translateY,n,a);o(e.rotate,r.rotate,n,a);s(e.skewX,r.skewX,n,a);l(e.scaleX,e.scaleY,r.scaleX,r.scaleY,n,a);e=r=null;return function(t){var e=-1,r=a.length,i;while(++e<r)n[(i=a[e]).i]=i.x(t);return n.join("")}}}var R=D(P,"px, ","px)","deg)");var B=D(O,", ",")",")");var F=Math.SQRT2;var N=2;var j=4;var V=1e-12;function U(t){return((t=Math.exp(t))+1/t)/2}function q(t){return((t=Math.exp(t))-1/t)/2}function H(t){return((t=Math.exp(2*t))-1)/(t+1)}var G=function(t,e){var r=t[0],n=t[1],a=t[2],i=e[0],o=e[1],s=e[2],l=i-r,u=o-n,c=l*l+u*u,f,h;if(c<V){h=Math.log(s/a)/F;f=function(t){return[r+t*l,n+t*u,a*Math.exp(F*t*h)]}}else{var p=Math.sqrt(c),d=(s*s-a*a+j*c)/(2*a*N*p),v=(s*s-a*a-j*c)/(2*s*N*p),g=Math.log(Math.sqrt(d*d+1)-d),m=Math.log(Math.sqrt(v*v+1)-v);h=(m-g)/F;f=function(t){var e=t*h,i=U(g),o=a/(N*p)*(i*H(F*e+g)-q(g));return[r+o*l,n+o*u,a*i/U(F*e+g)]}}f.duration=h*1e3;return f};function W(t){return function(r,n){var a=t((r=e.hsl(r)).h,(n=e.hsl(n)).h),i=c(r.s,n.s),o=c(r.l,n.l),s=c(r.opacity,n.opacity);return function(t){r.h=a(t);r.s=i(t);r.l=o(t);r.opacity=s(t);return r+""}}}var Y=W(l);var X=W(c);function Z(t,r){var n=c((t=e.lab(t)).l,(r=e.lab(r)).l),a=c(t.a,r.a),i=c(t.b,r.b),o=c(t.opacity,r.opacity);return function(e){t.l=n(e);t.a=a(e);t.b=i(e);t.opacity=o(e);return t+""}}function $(t){return function(r,n){var a=t((r=e.hcl(r)).h,(n=e.hcl(n)).h),i=c(r.c,n.c),o=c(r.l,n.l),s=c(r.opacity,n.opacity);return function(t){r.h=a(t);r.c=i(t);r.l=o(t);r.opacity=s(t);return r+""}}}var J=$(l);var K=$(c);function Q(t){return function r(n){n=+n;function a(r,a){var i=t((r=e.cubehelix(r)).h,(a=e.cubehelix(a)).h),o=c(r.s,a.s),s=c(r.l,a.l),l=c(r.opacity,a.opacity);return function(t){r.h=i(t);r.s=o(t);r.l=s(Math.pow(t,n));r.opacity=l(t);return r+""}}a.gamma=r;return a}(1)}var tt=Q(l);var et=Q(c);var rt=function(t,e){var r=new Array(e);for(var n=0;n<e;++n)r[n]=t(n/(e-1));return r};t.interpolate=M;t.interpolateArray=v;t.interpolateBasis=n;t.interpolateBasisClosed=a;t.interpolateDate=g;t.interpolateNumber=m;t.interpolateObject=y;t.interpolateRound=A;t.interpolateString=k;t.interpolateTransformCss=R;t.interpolateTransformSvg=B;t.interpolateZoom=G;t.interpolateRgb=f;t.interpolateRgbBasis=p;t.interpolateRgbBasisClosed=d;t.interpolateHsl=Y;t.interpolateHslLong=X;t.interpolateLab=Z;t.interpolateHcl=J;t.interpolateHclLong=K;t.interpolateCubehelix=tt;t.interpolateCubehelixLong=et;t.quantize=rt;Object.defineProperty(t,"__esModule",{value:true})})},{"d3-color":141}],145:[function(e,r,n){(function(e,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof t==="function"&&t.amd?t(["exports"],a):a(e.d3=e.d3||{})})(this,function(t){"use strict";var e=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return r(this.cover(e,n),e,n,t)};function r(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var a,i=t._root,o={data:n},s=t._x0,l=t._y0,u=t._x1,c=t._y1,f,h,p,d,v,g,m,y;if(!i)return t._root=o,t;while(i.length){if(v=e>=(f=(s+u)/2))s=f;else u=f;if(g=r>=(h=(l+c)/2))l=h;else c=h;if(a=i,!(i=i[m=g<<1|v]))return a[m]=o,t}p=+t._x.call(null,i.data);d=+t._y.call(null,i.data);if(e===p&&r===d)return o.next=i,a?a[m]=o:t._root=o,t;do{a=a?a[m]=new Array(4):t._root=new Array(4);if(v=e>=(f=(s+u)/2))s=f;else u=f;if(g=r>=(h=(l+c)/2))l=h;else c=h}while((m=g<<1|v)===(y=(d>=h)<<1|p>=f));return a[y]=i,a[m]=o,t}function n(t){var e,n,a=t.length,i,o,s=new Array(a),l=new Array(a),u=Infinity,c=Infinity,f=-Infinity,h=-Infinity;for(n=0;n<a;++n){if(isNaN(i=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e)))continue;s[n]=i;l[n]=o;if(i<u)u=i;if(i>f)f=i;if(o<c)c=o;if(o>h)h=o}if(f<u)u=this._x0,f=this._x1;if(h<c)c=this._y0,h=this._y1;this.cover(u,c).cover(f,h);for(n=0;n<a;++n){r(this,s[n],l[n],t[n])}return this}var a=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,a=this._x1,i=this._y1;if(isNaN(r)){a=(r=Math.floor(t))+1;i=(n=Math.floor(e))+1}else if(r>t||t>a||n>e||e>i){var o=a-r,s=this._root,l,u;switch(u=(e<(n+i)/2)<<1|t<(r+a)/2){case 0:{do{l=new Array(4),l[u]=s,s=l}while(o*=2,a=r+o,i=n+o,t>a||e>i);break}case 1:{do{l=new Array(4),l[u]=s,s=l}while(o*=2,r=a-o,i=n+o,r>t||e>i);break}case 2:{do{l=new Array(4),l[u]=s,s=l}while(o*=2,a=r+o,n=i-o,t>a||n>e);break}case 3:{do{l=new Array(4),l[u]=s,s=l}while(o*=2,r=a-o,n=i-o,r>t||n>e);break}}if(this._root&&this._root.length)this._root=s}else return this;this._x0=r;this._y0=n;this._x1=a;this._y1=i;return this};var i=function(){var t=[];this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)});return t};var o=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?undefined:[[this._x0,this._y0],[this._x1,this._y1]]};var s=function(t,e,r,n,a){this.node=t;this.x0=e;this.y0=r;this.x1=n;this.y1=a};var l=function(t,e,r){var n,a=this._x0,i=this._y0,o,l,u,c,f=this._x1,h=this._y1,p=[],d=this._root,v,g;if(d)p.push(new s(d,a,i,f,h));if(r==null)r=Infinity;else{a=t-r,i=e-r;f=t+r,h=e+r;r*=r}while(v=p.pop()){if(!(d=v.node)||(o=v.x0)>f||(l=v.y0)>h||(u=v.x1)<a||(c=v.y1)<i)continue;if(d.length){var m=(o+u)/2,y=(l+c)/2;p.push(new s(d[3],m,y,u,c),new s(d[2],o,y,m,c),new s(d[1],m,l,u,y),new s(d[0],o,l,m,y));if(g=(e>=y)<<1|t>=m){v=p[p.length-1];p[p.length-1]=p[p.length-1-g];p[p.length-1-g]=v}}else{var x=t-+this._x.call(null,d.data),b=e-+this._y.call(null,d.data),_=x*x+b*b;if(_<r){var w=Math.sqrt(r=_);a=t-w,i=e-w;f=t+w,h=e+w;n=d.data}}}return n};var u=function(t){if(isNaN(c=+this._x.call(null,t))||isNaN(f=+this._y.call(null,t)))return this;var e,r=this._root,n,a,i,o=this._x0,s=this._y0,l=this._x1,u=this._y1,c,f,h,p,d,v,g,m;if(!r)return this;if(r.length)while(true){if(d=c>=(h=(o+l)/2))o=h;else l=h;if(v=f>=(p=(s+u)/2))s=p;else u=p;if(!(e=r,r=r[g=v<<1|d]))return this;if(!r.length)break;if(e[g+1&3]||e[g+2&3]||e[g+3&3])n=e,m=g}while(r.data!==t)if(!(a=r,r=r.next))return this;if(i=r.next)delete r.next;if(a)return i?a.next=i:delete a.next,this;if(!e)return this._root=i,this;i?e[g]=i:delete e[g];if((r=e[0]||e[1]||e[2]||e[3])&&r===(e[3]||e[2]||e[1]||e[0])&&!r.length){if(n)n[m]=r;else this._root=r}return this};function c(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this}var f=function(){return this._root};var h=function(){var t=0;this.visit(function(e){if(!e.length)do{++t}while(e=e.next)});return t};var p=function(t){var e=[],r,n=this._root,a,i,o,l,u;if(n)e.push(new s(n,this._x0,this._y0,this._x1,this._y1));while(r=e.pop()){if(!t(n=r.node,i=r.x0,o=r.y0,l=r.x1,u=r.y1)&&n.length){var c=(i+l)/2,f=(o+u)/2;if(a=n[3])e.push(new s(a,c,f,l,u));if(a=n[2])e.push(new s(a,i,f,c,u));if(a=n[1])e.push(new s(a,c,o,l,f));if(a=n[0])e.push(new s(a,i,o,c,f))}}return this};var d=function(t){var e=[],r=[],n;if(this._root)e.push(new s(this._root,this._x0,this._y0,this._x1,this._y1));while(n=e.pop()){var a=n.node;if(a.length){var i,o=n.x0,l=n.y0,u=n.x1,c=n.y1,f=(o+u)/2,h=(l+c)/2;if(i=a[0])e.push(new s(i,o,l,f,h));if(i=a[1])e.push(new s(i,f,l,u,h));if(i=a[2])e.push(new s(i,o,h,f,c));if(i=a[3])e.push(new s(i,f,h,u,c))}r.push(n)}while(n=r.pop()){t(n.node,n.x0,n.y0,n.x1,n.y1)}return this};function v(t){return t[0]}var g=function(t){return arguments.length?(this._x=t,this):this._x};function m(t){return t[1]}var y=function(t){return arguments.length?(this._y=t,this):this._y};function x(t,e,r){var n=new b(e==null?v:e,r==null?m:r,NaN,NaN,NaN,NaN);return t==null?n:n.addAll(t)}function b(t,e,r,n,a,i){this._x=t;this._y=e;this._x0=r;this._y0=n;this._x1=a;this._y1=i;this._root=undefined}function _(t){var e={data:t.data},r=e;while(t=t.next)r=r.next={data:t.data};return e}var w=x.prototype=b.prototype;w.copy=function(){var t=new b(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,r,n;if(!e)return t;if(!e.length)return t._root=_(e),t;r=[{source:e,target:t._root=new Array(4)}];while(e=r.pop()){for(var a=0;a<4;++a){if(n=e.source[a]){if(n.length)r.push({source:n,target:e.target[a]=new Array(4)});else e.target[a]=_(n)}}}return t};w.add=e;w.addAll=n;w.cover=a;w.data=i;w.extent=o;w.find=l;w.remove=u;w.removeAll=c;w.root=f;w.size=h;w.visit=p;w.visitAfter=d;w.x=g;w.y=y;t.quadtree=x;Object.defineProperty(t,"__esModule",{value:true})})},{}],146:[function(e,r,n){(function(e,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof t==="function"&&t.amd?t(["exports"],a):a(e.d3=e.d3||{})})(this,function(t){"use strict";var e=0;var r=0;var n=0;var a=1e3;var i;var o;var s=0;var l=0;var u=0;var c=typeof performance==="object"&&performance.now?performance:Date;var f=typeof window==="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function h(){return l||(f(p),l=c.now()+u)}function p(){l=0}function d(){this._call=this._time=this._next=null}d.prototype=v.prototype={constructor:d,restart:function(t,e,r){if(typeof t!=="function")throw new TypeError("callback is not a function");r=(r==null?h():+r)+(e==null?0:+e);if(!this._next&&o!==this){if(o)o._next=this;else i=this;o=this}this._call=t;this._time=r;b()},stop:function(){if(this._call){this._call=null;this._time=Infinity;b()}}};function v(t,e,r){var n=new d;n.restart(t,e,r);return n}function g(){h();++e;var t=i,r;while(t){if((r=l-t._time)>=0)t._call.call(null,r);t=t._next}--e}function m(){l=(s=c.now())+u;e=r=0;try{g()}finally{e=0;x();l=0}}function y(){var t=c.now(),e=t-s;if(e>a)u-=e,s=t}function x(){var t,e=i,r,n=Infinity;while(e){if(e._call){if(n>e._time)n=e._time;t=e,e=e._next}else{r=e._next,e._next=null;e=t?t._next=r:i=r}}o=t;b(n)}function b(t){if(e)return;if(r)r=clearTimeout(r);var i=t-l;if(i>24){if(t<Infinity)r=setTimeout(m,t-c.now()-u);if(n)n=clearInterval(n)}else{if(!n)s=c.now(),n=setInterval(y,a);e=1,f(m)}}var _=function(t,e,r){var n=new d;e=e==null?0:+e;n.restart(function(r){n.stop();t(r+e)},e,r);return n};var w=function(t,e,r){var n=new d,a=e;if(e==null)return n.restart(t,e,r),n;e=+e,r=r==null?h():+r;n.restart(function i(o){o+=a;n.restart(i,a+=e,r);t(o)},e,r);return n};t.now=h;t.timer=v;t.timerFlush=g;t.timeout=_;t.interval=w;Object.defineProperty(t,"__esModule",{value:true})})},{}],147:[function(e,r,n){!function(){var e={version:"3.5.17"};var n=[].slice,a=function(t){return n.call(t)};var i=this.document;function o(t){return t&&(t.ownerDocument||t.document||t).documentElement}function s(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}if(i){try{a(i.documentElement.childNodes)[0].nodeType}catch(t){a=function(t){var e=t.length,r=new Array(e);while(e--)r[e]=t[e];return r}}}if(!Date.now)Date.now=function(){return+new Date};if(i){try{i.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var l=this.Element.prototype,u=l.setAttribute,c=l.setAttributeNS,f=this.CSSStyleDeclaration.prototype,h=f.setProperty;l.setAttribute=function(t,e){u.call(this,t,e+"")};l.setAttributeNS=function(t,e,r){c.call(this,t,e,r+"")};f.setProperty=function(t,e,r){h.call(this,t,e+"",r)}}}e.ascending=p;function p(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}e.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN};e.min=function(t,e){var r=-1,n=t.length,a,i;if(arguments.length===1){while(++r<n)if((i=t[r])!=null&&i>=i){a=i;break}while(++r<n)if((i=t[r])!=null&&a>i)a=i}else{while(++r<n)if((i=e.call(t,t[r],r))!=null&&i>=i){a=i;break}while(++r<n)if((i=e.call(t,t[r],r))!=null&&a>i)a=i}return a};e.max=function(t,e){var r=-1,n=t.length,a,i;if(arguments.length===1){while(++r<n)if((i=t[r])!=null&&i>=i){a=i;break}while(++r<n)if((i=t[r])!=null&&i>a)a=i}else{while(++r<n)if((i=e.call(t,t[r],r))!=null&&i>=i){a=i;break}while(++r<n)if((i=e.call(t,t[r],r))!=null&&i>a)a=i}return a};e.extent=function(t,e){var r=-1,n=t.length,a,i,o;if(arguments.length===1){while(++r<n)if((i=t[r])!=null&&i>=i){a=o=i;break}while(++r<n)if((i=t[r])!=null){if(a>i)a=i;if(o<i)o=i}}else{while(++r<n)if((i=e.call(t,t[r],r))!=null&&i>=i){a=o=i;break}while(++r<n)if((i=e.call(t,t[r],r))!=null){if(a>i)a=i;if(o<i)o=i}}return[a,o]};function d(t){return t===null?NaN:+t}function v(t){return!isNaN(t)}e.sum=function(t,e){var r=0,n=t.length,a,i=-1;if(arguments.length===1){while(++i<n)if(v(a=+t[i]))r+=a}else{while(++i<n)if(v(a=+e.call(t,t[i],i)))r+=a}return r};e.mean=function(t,e){var r=0,n=t.length,a,i=-1,o=n;if(arguments.length===1){while(++i<n)if(v(a=d(t[i])))r+=a;else--o}else{while(++i<n)if(v(a=d(e.call(t,t[i],i))))r+=a;else--o}if(o)return r/o};e.quantile=function(t,e){var r=(t.length-1)*e+1,n=Math.floor(r),a=+t[n-1],i=r-n;return i?a+i*(t[n]-a):a};e.median=function(t,r){var n=[],a=t.length,i,o=-1;if(arguments.length===1){while(++o<a)if(v(i=d(t[o])))n.push(i)}else{while(++o<a)if(v(i=d(r.call(t,t[o],o))))n.push(i)}if(n.length)return e.quantile(n.sort(p),.5)};e.variance=function(t,e){var r=t.length,n=0,a,i,o=0,s=-1,l=0;if(arguments.length===1){while(++s<r){if(v(a=d(t[s]))){i=a-n;n+=i/++l;o+=i*(a-n)}}}else{while(++s<r){if(v(a=d(e.call(t,t[s],s)))){i=a-n;n+=i/++l;o+=i*(a-n)}}}if(l>1)return o/(l-1)};e.deviation=function(){var t=e.variance.apply(this,arguments);return t?Math.sqrt(t):t};function g(t){return{left:function(e,r,n,a){if(arguments.length<3)n=0;if(arguments.length<4)a=e.length;while(n<a){var i=n+a>>>1;if(t(e[i],r)<0)n=i+1;else a=i}return n},right:function(e,r,n,a){if(arguments.length<3)n=0;if(arguments.length<4)a=e.length;while(n<a){var i=n+a>>>1;if(t(e[i],r)>0)a=i;else n=i+1}return n}}}var m=g(p);e.bisectLeft=m.left;e.bisect=e.bisectRight=m.right;e.bisector=function(t){return g(t.length===1?function(e,r){return p(t(e),r)}:t)};e.shuffle=function(t,e,r){if((n=arguments.length)<3){r=t.length;if(n<2)e=0}var n=r-e,a,i;while(n){i=Math.random()*n--|0;a=t[n+e],t[n+e]=t[i+e],t[i+e]=a}return t};e.permute=function(t,e){var r=e.length,n=new Array(r);while(r--)n[r]=t[e[r]];return n};e.pairs=function(t){var e=0,r=t.length-1,n,a=t[0],i=new Array(r<0?0:r);while(e<r)i[e]=[n=a,a=t[++e]];return i};e.transpose=function(t){if(!(o=t.length))return[];for(var r=-1,n=e.min(t,y),a=new Array(n);++r<n;){for(var i=-1,o,s=a[r]=new Array(o);++i<o;){s[i]=t[i][r]}}return a};function y(t){return t.length}e.zip=function(){return e.transpose(arguments)};e.keys=function(t){var e=[];for(var r in t)e.push(r);return e};e.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e};e.entries=function(t){var e=[];for(var r in t)e.push({key:r,value:t[r]});return e};e.merge=function(t){var e=t.length,r,n=-1,a=0,i,o;while(++n<e)a+=t[n].length;i=new Array(a);while(--e>=0){o=t[e];r=o.length;while(--r>=0){i[--a]=o[r]}}return i};var x=Math.abs;e.range=function(t,e,r){if(arguments.length<3){r=1;if(arguments.length<2){e=t;t=0}}if((e-t)/r===Infinity)throw new Error("infinite range");var n=[],a=b(x(r)),i=-1,o;t*=a,e*=a,r*=a;if(r<0)while((o=t+r*++i)>e)n.push(o/a);else while((o=t+r*++i)<e)n.push(o/a);return n};function b(t){var e=1;while(t*e%1)e*=10;return e}function _(t,e){for(var r in e){Object.defineProperty(t.prototype,r,{value:e[r],enumerable:false})}}e.map=function(t,e){var r=new w;if(t instanceof w){t.forEach(function(t,e){r.set(t,e)})}else if(Array.isArray(t)){var n=-1,a=t.length,i;if(arguments.length===1)while(++n<a)r.set(n,t[n]);else while(++n<a)r.set(e.call(t,i=t[n],n),i)}else{for(var o in t)r.set(o,t[o])}return r};function w(){this._=Object.create(null)}var k="__proto__",M="\0";_(w,{has:S,get:function(t){return this._[A(t)]},set:function(t,e){return this._[A(t)]=e},remove:E,keys:C,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:T(e),value:this._[e]});return t},size:L,empty:I,forEach:function(t){for(var e in this._)t.call(this,T(e),this._[e])}});function A(t){return(t+="")===k||t[0]===M?M+t:t}function T(t){return(t+="")[0]===M?t.slice(1):t}function S(t){return A(t)in this._}function E(t){return(t=A(t))in this._&&delete this._[t]}function C(){var t=[];for(var e in this._)t.push(T(e));return t}function L(){var t=0;for(var e in this._)++t;return t}function I(){for(var t in this._)return false;return true}e.nest=function(){var t={},r=[],n=[],a,i;function o(e,n,s){if(s>=r.length)return i?i.call(t,n):a?n.sort(a):n;var l=-1,u=n.length,c=r[s++],f,h,p,d=new w,v;while(++l<u){if(v=d.get(f=c(h=n[l]))){v.push(h)}else{d.set(f,[h])}}if(e){h=e();p=function(t,r){h.set(t,o(e,r,s))}}else{h={};p=function(t,r){h[t]=o(e,r,s)}}d.forEach(p);return h}function s(t,e){if(e>=r.length)return t;var a=[],i=n[e++];t.forEach(function(t,r){a.push({key:t,values:s(r,e)})});return i?a.sort(function(t,e){return i(t.key,e.key)}):a}t.map=function(t,e){return o(e,t,0)};t.entries=function(t){return s(o(e.map,t,0),0)};t.key=function(e){r.push(e);return t};t.sortKeys=function(e){n[r.length-1]=e;return t};t.sortValues=function(e){a=e;return t};t.rollup=function(e){i=e;return t};return t};e.set=function(t){var e=new z;if(t)for(var r=0,n=t.length;r<n;++r)e.add(t[r]);return e};function z(){this._=Object.create(null)}_(z,{has:S,add:function(t){this._[A(t+="")]=true;return t},remove:E,values:C,size:L,empty:I,forEach:function(t){for(var e in this._)t.call(this,T(e))}});e.behavior={};function P(t){return t}e.rebind=function(t,e){var r=1,n=arguments.length,a;while(++r<n)t[a=arguments[r]]=O(t,e,e[a]);return t};function O(t,e,r){return function(){var n=r.apply(e,arguments);return n===e?t:n}}function D(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var r=0,n=R.length;r<n;++r){var a=R[r]+e;if(a in t)return a}}var R=["webkit","ms","moz","Moz","o","O"];function B(){}e.dispatch=function(){var t=new F,e=-1,r=arguments.length;while(++e<r)t[arguments[e]]=N(t);return t};function F(){}F.prototype.on=function(t,e){var r=t.indexOf("."),n="";if(r>=0){n=t.slice(r+1);t=t.slice(0,r)}if(t)return arguments.length<2?this[t].on(n):this[t].on(n,e);if(arguments.length===2){if(e==null)for(t in this){if(this.hasOwnProperty(t))this[t].on(n,null)}return this}};function N(t){var e=[],r=new w;function n(){var r=e,n=-1,a=r.length,i;while(++n<a)if(i=r[n].on)i.apply(this,arguments);return t}n.on=function(n,a){var i=r.get(n),o;if(arguments.length<2)return i&&i.on;if(i){i.on=null;e=e.slice(0,o=e.indexOf(i)).concat(e.slice(o+1));r.remove(n)}if(a)e.push(r.set(n,{on:a}));return t};return n}e.event=null;function j(){e.event.preventDefault()}function V(){var t=e.event,r;while(r=t.sourceEvent)t=r;return t}function U(t){var r=new F,n=0,a=arguments.length;while(++n<a)r[arguments[n]]=N(r);r.of=function(n,a){return function(i){try{var o=i.sourceEvent=e.event;i.target=t;e.event=i;r[i.type].apply(n,a)}finally{e.event=o}}};return r}e.requote=function(t){return t.replace(q,"\\$&")};var q=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;var H={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var r in e)t[r]=e[r]};function G(t){H(t,Z);return t}var W=function(t,e){return e.querySelector(t)},Y=function(t,e){return e.querySelectorAll(t)},X=function(t,e){var r=t.matches||t[D(t,"matchesSelector")];X=function(t,e){return r.call(t,e)};return X(t,e)};if(typeof Sizzle==="function"){W=function(t,e){return Sizzle(t,e)[0]||null};Y=Sizzle;X=Sizzle.matchesSelector}e.selection=function(){return e.select(i.documentElement)};var Z=e.selection.prototype=[];Z.select=function(t){var e=[],r,n,a,i;t=$(t);for(var o=-1,s=this.length;++o<s;){e.push(r=[]);r.parentNode=(a=this[o]).parentNode;for(var l=-1,u=a.length;++l<u;){if(i=a[l]){r.push(n=t.call(i,i.__data__,l,o));if(n&&"__data__"in i)n.__data__=i.__data__}else{r.push(null)}}}return G(e)};function $(t){return typeof t==="function"?t:function(){return W(t,this)}}Z.selectAll=function(t){var e=[],r,n;t=J(t);for(var i=-1,o=this.length;++i<o;){for(var s=this[i],l=-1,u=s.length;++l<u;){if(n=s[l]){e.push(r=a(t.call(n,n.__data__,l,i)));r.parentNode=n}}}return G(e)};function J(t){return typeof t==="function"?t:function(){return Y(t,this)}}var K="http://www.w3.org/1999/xhtml";var Q={svg:"http://www.w3.org/2000/svg",xhtml:K,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};e.ns={prefix:Q,qualify:function(t){var e=t.indexOf(":"),r=t;if(e>=0&&(r=t.slice(0,e))!=="xmlns")t=t.slice(e+1);return Q.hasOwnProperty(r)?{space:Q[r],local:t}:t}};Z.attr=function(t,r){if(arguments.length<2){if(typeof t==="string"){var n=this.node();t=e.ns.qualify(t);return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(r in t)this.each(tt(r,t[r]));return this}return this.each(tt(t,r))};function tt(t,r){t=e.ns.qualify(t);function n(){this.removeAttribute(t)}function a(){this.removeAttributeNS(t.space,t.local)}function i(){this.setAttribute(t,r)}function o(){this.setAttributeNS(t.space,t.local,r)}function s(){var e=r.apply(this,arguments);if(e==null)this.removeAttribute(t);else this.setAttribute(t,e)}function l(){var e=r.apply(this,arguments);if(e==null)this.removeAttributeNS(t.space,t.local);else this.setAttributeNS(t.space,t.local,e)}return r==null?t.local?a:n:typeof r==="function"?t.local?l:s:t.local?o:i}function et(t){return t.trim().replace(/\s+/g," ")}Z.classed=function(t,e){if(arguments.length<2){if(typeof t==="string"){var r=this.node(),n=(t=nt(t)).length,a=-1;if(e=r.classList){while(++a<n)if(!e.contains(t[a]))return false}else{e=r.getAttribute("class");while(++a<n)if(!rt(t[a]).test(e))return false}return true}for(e in t)this.each(at(e,t[e]));return this}return this.each(at(t,e))};function rt(t){return new RegExp("(?:^|\\s+)"+e.requote(t)+"(?:\\s+|$)","g")}function nt(t){return(t+"").trim().split(/^|\s+/)}function at(t,e){t=nt(t).map(it);var r=t.length;function n(){var n=-1;while(++n<r)t[n](this,e)}function a(){var n=-1,a=e.apply(this,arguments);while(++n<r)t[n](this,a)}return typeof e==="function"?a:n}function it(t){var e=rt(t);return function(r,n){if(a=r.classList)return n?a.add(t):a.remove(t);var a=r.getAttribute("class")||"";if(n){e.lastIndex=0;if(!e.test(a))r.setAttribute("class",et(a+" "+t))}else{r.setAttribute("class",et(a.replace(e," ")))}}}Z.style=function(t,e,r){var n=arguments.length;if(n<3){if(typeof t!=="string"){if(n<2)e="";for(r in t)this.each(ot(r,t[r],e));return this}if(n<2){var a=this.node();return s(a).getComputedStyle(a,null).getPropertyValue(t)}r=""}return this.each(ot(t,e,r))};function ot(t,e,r){function n(){this.style.removeProperty(t)}function a(){this.style.setProperty(t,e,r)}function i(){var n=e.apply(this,arguments);if(n==null)this.style.removeProperty(t);else this.style.setProperty(t,n,r)}return e==null?n:typeof e==="function"?i:a}Z.property=function(t,e){if(arguments.length<2){if(typeof t==="string")return this.node()[t];for(e in t)this.each(st(e,t[e]));return this}return this.each(st(t,e))};function st(t,e){function r(){delete this[t]}function n(){this[t]=e}function a(){var r=e.apply(this,arguments);if(r==null)delete this[t];else this[t]=r}return e==null?r:typeof e==="function"?a:n}Z.text=function(t){return arguments.length?this.each(typeof t==="function"?function(){var e=t.apply(this,arguments);this.textContent=e==null?"":e}:t==null?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent};Z.html=function(t){return arguments.length?this.each(typeof t==="function"?function(){var e=t.apply(this,arguments);this.innerHTML=e==null?"":e}:t==null?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML};Z.append=function(t){t=lt(t);return this.select(function(){return this.appendChild(t.apply(this,arguments))})};function lt(t){function r(){var e=this.ownerDocument,r=this.namespaceURI;return r===K&&e.documentElement.namespaceURI===K?e.createElement(t):e.createElementNS(r,t)}function n(){return this.ownerDocument.createElementNS(t.space,t.local)}return typeof t==="function"?t:(t=e.ns.qualify(t)).local?n:r}Z.insert=function(t,e){t=lt(t);e=$(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})};Z.remove=function(){return this.each(ut)};function ut(){var t=this.parentNode;if(t)t.removeChild(this)}Z.data=function(t,e){var r=-1,n=this.length,a,i;if(!arguments.length){t=new Array(n=(a=this[0]).length);while(++r<n){if(i=a[r]){t[r]=i.__data__}}return t}function o(t,r){var n,a=t.length,i=r.length,o=Math.min(a,i),c=new Array(i),f=new Array(i),h=new Array(a),p,d;if(e){var v=new w,g=new Array(a),m;for(n=-1;++n<a;){if(p=t[n]){if(v.has(m=e.call(p,p.__data__,n))){h[n]=p}else{v.set(m,p)}g[n]=m}}for(n=-1;++n<i;){if(!(p=v.get(m=e.call(r,d=r[n],n)))){f[n]=ct(d)}else if(p!==true){c[n]=p;p.__data__=d}v.set(m,true)}for(n=-1;++n<a;){if(n in g&&v.get(g[n])!==true){h[n]=t[n]}}}else{for(n=-1;++n<o;){p=t[n];d=r[n];if(p){p.__data__=d;c[n]=p}else{f[n]=ct(d)}}for(;n<i;++n){f[n]=ct(r[n])}for(;n<a;++n){h[n]=t[n]}}f.update=c;f.parentNode=c.parentNode=h.parentNode=t.parentNode;s.push(f);l.push(c);u.push(h)}var s=dt([]),l=G([]),u=G([]);if(typeof t==="function"){while(++r<n){o(a=this[r],t.call(a,a.parentNode.__data__,r))}}else{while(++r<n){o(a=this[r],t)}}l.enter=function(){return s};l.exit=function(){return u};return l};function ct(t){return{__data__:t}}Z.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")};Z.filter=function(t){var e=[],r,n,a;if(typeof t!=="function")t=ft(t);for(var i=0,o=this.length;i<o;i++){e.push(r=[]);r.parentNode=(n=this[i]).parentNode;for(var s=0,l=n.length;s<l;s++){if((a=n[s])&&t.call(a,a.__data__,s,i)){r.push(a)}}}return G(e)};function ft(t){return function(){return X(this,t)}}Z.order=function(){for(var t=-1,e=this.length;++t<e;){for(var r=this[t],n=r.length-1,a=r[n],i;--n>=0;){if(i=r[n]){if(a&&a!==i.nextSibling)a.parentNode.insertBefore(i,a);a=i}}}return this};Z.sort=function(t){t=ht.apply(this,arguments);for(var e=-1,r=this.length;++e<r;)this[e].sort(t);return this.order()};function ht(t){if(!arguments.length)t=p;return function(e,r){return e&&r?t(e.__data__,r.__data__):!e-!r}}Z.each=function(t){return pt(this,function(e,r,n){t.call(e,e.__data__,r,n)})};function pt(t,e){for(var r=0,n=t.length;r<n;r++){for(var a=t[r],i=0,o=a.length,s;i<o;i++){if(s=a[i])e(s,i,r)}}return t}Z.call=function(t){var e=a(arguments);t.apply(e[0]=this,e);return this};Z.empty=function(){return!this.node()};Z.node=function(){for(var t=0,e=this.length;t<e;t++){for(var r=this[t],n=0,a=r.length;n<a;n++){var i=r[n];if(i)return i}}return null};Z.size=function(){var t=0;pt(this,function(){++t});return t};function dt(t){H(t,vt);return t}var vt=[];e.selection.enter=dt;e.selection.enter.prototype=vt;vt.append=Z.append;vt.empty=Z.empty;vt.node=Z.node;vt.call=Z.call;vt.size=Z.size;vt.select=function(t){var e=[],r,n,a,i,o;for(var s=-1,l=this.length;++s<l;){a=(i=this[s]).update;e.push(r=[]);r.parentNode=i.parentNode;for(var u=-1,c=i.length;++u<c;){if(o=i[u]){r.push(a[u]=n=t.call(i.parentNode,o.__data__,u,s));n.__data__=o.__data__}else{r.push(null)}}}return G(e)};vt.insert=function(t,e){if(arguments.length<2)e=gt(this);return Z.insert.call(this,t,e)};function gt(t){var e,r;return function(n,a,i){var o=t[i].update,s=o.length,l;if(i!=r)r=i,e=0;if(a>=e)e=a+1;while(!(l=o[e])&&++e<s);return l}}e.select=function(t){var e;if(typeof t==="string"){e=[W(t,i)];e.parentNode=i.documentElement}else{e=[t];e.parentNode=o(t)}return G([e])};e.selectAll=function(t){var e;if(typeof t==="string"){e=a(Y(t,i));e.parentNode=i.documentElement}else{e=a(t);e.parentNode=null}return G([e])};Z.on=function(t,e,r){var n=arguments.length;if(n<3){if(typeof t!=="string"){if(n<2)e=false;for(r in t)this.each(mt(r,t[r],e));return this}if(n<2)return(n=this.node()["__on"+t])&&n._;r=false}return this.each(mt(t,e,r))};function mt(t,r,n){var i="__on"+t,o=t.indexOf("."),s=xt;if(o>0)t=t.slice(0,o);var l=yt.get(t);if(l)t=l,s=bt;function u(){var e=this[i];if(e){this.removeEventListener(t,e,e.$);delete this[i]}}function c(){var e=s(r,a(arguments));u.call(this);this.addEventListener(t,this[i]=e,e.$=n);e._=r}function f(){var r=new RegExp("^__on([^.]+)"+e.requote(t)+"$"),n;for(var a in this){if(n=a.match(r)){var i=this[a];this.removeEventListener(n[1],i,i.$);delete this[a]}}}return o?r?c:u:r?B:f}var yt=e.map({mouseenter:"mouseover",mouseleave:"mouseout"});if(i){yt.forEach(function(t){if("on"+t in i)yt.remove(t)})}function xt(t,r){return function(n){var a=e.event;e.event=n;r[0]=this.__data__;try{t.apply(this,r)}finally{e.event=a}}}function bt(t,e){var r=xt(t,e);return function(t){var e=this,n=t.relatedTarget;if(!n||n!==e&&!(n.compareDocumentPosition(e)&8)){r.call(e,t)}}}var _t,wt=0;function kt(t){var r=".dragsuppress-"+ ++wt,n="click"+r,a=e.select(s(t)).on("touchmove"+r,j).on("dragstart"+r,j).on("selectstart"+r,j);if(_t==null){_t="onselectstart"in t?false:D(t.style,"userSelect")}if(_t){var i=o(t).style,l=i[_t];i[_t]="none"}return function(t){a.on(r,null);if(_t)i[_t]=l;if(t){var e=function(){a.on(n,null)};a.on(n,function(){j();e()},true);setTimeout(e,0)}}}e.mouse=function(t){return At(t,V())};var Mt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function At(t,r){if(r.changedTouches)r=r.changedTouches[0];var n=t.ownerSVGElement||t;if(n.createSVGPoint){var a=n.createSVGPoint();if(Mt<0){var i=s(t);if(i.scrollX||i.scrollY){n=e.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=n[0][0].getScreenCTM();Mt=!(o.f||o.e);n.remove()}}if(Mt)a.x=r.pageX,a.y=r.pageY;else a.x=r.clientX,a.y=r.clientY;a=a.matrixTransform(t.getScreenCTM().inverse());return[a.x,a.y]}var l=t.getBoundingClientRect();return[r.clientX-l.left-t.clientLeft,r.clientY-l.top-t.clientTop]}e.touch=function(t,e,r){if(arguments.length<3)r=e,e=V().changedTouches;if(e)for(var n=0,a=e.length,i;n<a;++n){if((i=e[n]).identifier===r){return At(t,i)}}};e.behavior.drag=function(){var t=U(i,"drag","dragstart","dragend"),r=null,n=o(B,e.mouse,s,"mousemove","mouseup"),a=o(Tt,e.touch,P,"touchmove","touchend");function i(){this.on("mousedown.drag",n).on("touchstart.drag",a)}function o(n,a,i,o,s){return function(){var l=this,u=e.event.target.correspondingElement||e.event.target,c=l.parentNode,f=t.of(l,arguments),h=0,p=n(),d=".drag"+(p==null?"":"-"+p),v,g=e.select(i(u)).on(o+d,x).on(s+d,b),m=kt(u),y=a(c,p);if(r){v=r.apply(l,arguments);v=[v.x-y[0],v.y-y[1]]}else{v=[0,0]}f({type:"dragstart"});function x(){var t=a(c,p),e,r;if(!t)return;e=t[0]-y[0];r=t[1]-y[1];h|=e|r;y=t;f({type:"drag",x:t[0]+v[0],y:t[1]+v[1],dx:e,dy:r})}function b(){if(!a(c,p))return;g.on(o+d,null).on(s+d,null);m(h);f({type:"dragend"})}}}i.origin=function(t){if(!arguments.length)return r;r=t;return i};return e.rebind(i,t,"on")};function Tt(){return e.event.changedTouches[0].identifier}e.touches=function(t,e){if(arguments.length<2)e=V().touches;return e?a(e).map(function(e){var r=At(t,e);r.identifier=e.identifier;return r}):[]};var St=1e-6,Et=St*St,Ct=Math.PI,Lt=2*Ct,It=Lt-St,zt=Ct/2,Pt=Ct/180,Ot=180/Ct;function Dt(t){return t>0?1:t<0?-1:0}function Rt(t,e,r){return(e[0]-t[0])*(r[1]-t[1])-(e[1]-t[1])*(r[0]-t[0])}function Bt(t){return t>1?0:t<-1?Ct:Math.acos(t)}function Ft(t){return t>1?zt:t<-1?-zt:Math.asin(t)}function Nt(t){return((t=Math.exp(t))-1/t)/2}function jt(t){return((t=Math.exp(t))+1/t)/2}function Vt(t){return((t=Math.exp(2*t))-1)/(t+1)}function Ut(t){return(t=Math.sin(t/2))*t}var qt=Math.SQRT2,Ht=2,Gt=4;e.interpolateZoom=function(t,e){var r=t[0],n=t[1],a=t[2],i=e[0],o=e[1],s=e[2],l=i-r,u=o-n,c=l*l+u*u,f,h;if(c<Et){h=Math.log(s/a)/qt;f=function(t){return[r+t*l,n+t*u,a*Math.exp(qt*t*h)]}}else{var p=Math.sqrt(c),d=(s*s-a*a+Gt*c)/(2*a*Ht*p),v=(s*s-a*a-Gt*c)/(2*s*Ht*p),g=Math.log(Math.sqrt(d*d+1)-d),m=Math.log(Math.sqrt(v*v+1)-v);h=(m-g)/qt;f=function(t){var e=t*h,i=jt(g),o=a/(Ht*p)*(i*Vt(qt*e+g)-Nt(g));return[r+o*l,n+o*u,a*i/jt(qt*e+g)]}}f.duration=h*1e3;return f};e.behavior.zoom=function(){var t={x:0,y:0,k:1},r,n,a,o=[960,500],l=Wt,u=250,c=0,f="mousedown.zoom",h="mousemove.zoom",p="mouseup.zoom",d,v="touchstart.zoom",g,m=U(w,"zoomstart","zoom","zoomend"),y,x,b,_;if(!Xt){Xt="onwheel"in i?(Yt=function(){return-e.event.deltaY*(e.event.deltaMode?120:1)},"wheel"):"onmousewheel"in i?(Yt=function(){return e.event.wheelDelta},"mousewheel"):(Yt=function(){return-e.event.detail},"MozMousePixelScroll")}function w(t){t.on(f,z).on(Xt+".zoom",O).on("dblclick.zoom",D).on(v,P)}w.event=function(r){r.each(function(){var r=m.of(this,arguments),a=t;if(zl){e.select(this).transition().each("start.zoom",function(){t=this.__chart__||{x:0,y:0,k:1};C(r)}).tween("zoom:zoom",function(){var i=o[0],s=o[1],l=n?n[0]:i/2,u=n?n[1]:s/2,c=e.interpolateZoom([(l-t.x)/t.k,(u-t.y)/t.k,i/t.k],[(l-a.x)/a.k,(u-a.y)/a.k,i/a.k]);return function(e){var n=c(e),a=i/n[2];this.__chart__=t={x:l-n[0]*a,y:u-n[1]*a,k:a};L(r)}}).each("interrupt.zoom",function(){I(r)}).each("end.zoom",function(){I(r)})}else{this.__chart__=t;C(r);L(r);I(r)}})};w.translate=function(e){if(!arguments.length)return[t.x,t.y];t={x:+e[0],y:+e[1],k:t.k};E();return w};w.scale=function(e){if(!arguments.length)return t.k;t={x:t.x,y:t.y,k:null};A(+e);E();return w};w.scaleExtent=function(t){if(!arguments.length)return l;l=t==null?Wt:[+t[0],+t[1]];return w};w.center=function(t){if(!arguments.length)return a;a=t&&[+t[0],+t[1]];return w};w.size=function(t){if(!arguments.length)return o;o=t&&[+t[0],+t[1]];return w};w.duration=function(t){if(!arguments.length)return u;u=+t;return w};w.x=function(e){if(!arguments.length)return x;x=e;y=e.copy();t={x:0,y:0,k:1};return w};w.y=function(e){if(!arguments.length)return _;_=e;b=e.copy();t={x:0,y:0,k:1};return w};function k(e){return[(e[0]-t.x)/t.k,(e[1]-t.y)/t.k]}function M(e){return[e[0]*t.k+t.x,e[1]*t.k+t.y]}function A(e){t.k=Math.max(l[0],Math.min(l[1],e))}function T(e,r){r=M(r);t.x+=e[0]-r[0];t.y+=e[1]-r[1]}function S(r,a,i,o){r.__chart__={x:t.x,y:t.y,k:t.k};A(Math.pow(2,o));T(n=a,i);r=e.select(r);if(u>0)r=r.transition().duration(u);r.call(w.event)}function E(){if(x)x.domain(y.range().map(function(e){return(e-t.x)/t.k}).map(y.invert));if(_)_.domain(b.range().map(function(e){return(e-t.y)/t.k}).map(b.invert))}function C(t){if(!c++)t({type:"zoomstart"})}function L(e){E();e({type:"zoom",scale:t.k,translate:[t.x,t.y]})}function I(t){if(!--c)t({type:"zoomend"}),n=null}function z(){var t=this,r=m.of(t,arguments),n=0,a=e.select(s(t)).on(h,l).on(p,u),i=k(e.mouse(t)),o=kt(t);Sl.call(t);C(r);function l(){n=1;T(e.mouse(t),i);L(r)}function u(){a.on(h,null).on(p,null);o(n);I(r)}}function P(){var r=this,n=m.of(r,arguments),a={},i=0,o,s=".zoom-"+e.event.changedTouches[0].identifier,l="touchmove"+s,u="touchend"+s,c=[],h=e.select(r),p=kt(r);y();C(n);h.on(f,null).on(v,y);function d(){var n=e.touches(r);o=t.k;n.forEach(function(t){if(t.identifier in a)a[t.identifier]=k(t)});return n}function y(){var n=e.event.target;e.select(n).on(l,x).on(u,b);c.push(n);var o=e.event.changedTouches;for(var s=0,f=o.length;s<f;++s){a[o[s].identifier]=null}var h=d(),p=Date.now();if(h.length===1){if(p-g<500){var v=h[0];S(r,v,a[v.identifier],Math.floor(Math.log(t.k)/Math.LN2)+1);j()}g=p}else if(h.length>1){var v=h[0],m=h[1],y=v[0]-m[0],_=v[1]-m[1];i=y*y+_*_}}function x(){var t=e.touches(r),s,l,u,c;Sl.call(r);for(var f=0,h=t.length;f<h;++f,c=null){u=t[f];if(c=a[u.identifier]){if(l)break;s=u,l=c}}if(c){var p=(p=u[0]-s[0])*p+(p=u[1]-s[1])*p,d=i&&Math.sqrt(p/i);s=[(s[0]+u[0])/2,(s[1]+u[1])/2];l=[(l[0]+c[0])/2,(l[1]+c[1])/2];A(d*o)}g=null;T(s,l);L(n)}function b(){if(e.event.touches.length){var t=e.event.changedTouches;for(var r=0,i=t.length;r<i;++r){delete a[t[r].identifier]}for(var o in a){return void d()}}e.selectAll(c).on(s,null);h.on(f,z).on(v,P);p();I(n)}}function O(){var i=m.of(this,arguments);if(d)clearTimeout(d);else Sl.call(this),r=k(n=a||e.mouse(this)),C(i);d=setTimeout(function(){d=null;I(i)},50);j();A(Math.pow(2,Yt()*.002)*t.k);T(n,r);L(i)}function D(){var r=e.mouse(this),n=Math.log(t.k)/Math.LN2;S(this,r,k(r),e.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}return e.rebind(w,m,"on")};var Wt=[0,Infinity],Yt,Xt;e.color=Zt;function Zt(){}Zt.prototype.toString=function(){return this.rgb()+""};e.hsl=$t;function $t(t,e,r){return this instanceof $t?void(this.h=+t,this.s=+e,this.l=+r):arguments.length<2?t instanceof $t?new $t(t.h,t.s,t.l):ye(""+t,xe,$t):new $t(t,e,r)}var Jt=$t.prototype=new Zt;Jt.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);return new $t(this.h,this.s,this.l/t)};Jt.darker=function(t){t=Math.pow(.7,arguments.length?t:1);return new $t(this.h,this.s,t*this.l)};Jt.rgb=function(){return Kt(this.h,this.s,this.l)};function Kt(t,e,r){var n,a;t=isNaN(t)?0:(t%=360)<0?t+360:t;e=isNaN(e)?0:e<0?0:e>1?1:e;r=r<0?0:r>1?1:r;a=r<=.5?r*(1+e):r+e-r*e;n=2*r-a;function i(t){if(t>360)t-=360;else if(t<0)t+=360;if(t<60)return n+(a-n)*t/60;if(t<180)return a;if(t<240)return n+(a-n)*(240-t)/60;return n}function o(t){return Math.round(i(t)*255)}return new pe(o(t+120),o(t),o(t-120))}e.hcl=Qt;function Qt(t,r,n){return this instanceof Qt?void(this.h=+t,this.c=+r,this.l=+n):arguments.length<2?t instanceof Qt?new Qt(t.h,t.c,t.l):t instanceof re?ue(t.l,t.a,t.b):ue((t=be((t=e.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new Qt(t,r,n)}var te=Qt.prototype=new Zt;te.brighter=function(t){return new Qt(this.h,this.c,Math.min(100,this.l+ne*(arguments.length?t:1)))};te.darker=function(t){return new Qt(this.h,this.c,Math.max(0,this.l-ne*(arguments.length?t:1)))};te.rgb=function(){return ee(this.h,this.c,this.l).rgb()};function ee(t,e,r){if(isNaN(t))t=0;if(isNaN(e))e=0;return new re(r,Math.cos(t*=Pt)*e,Math.sin(t)*e)}e.lab=re;function re(t,e,r){return this instanceof re?void(this.l=+t,this.a=+e,this.b=+r):arguments.length<2?t instanceof re?new re(t.l,t.a,t.b):t instanceof Qt?ee(t.h,t.c,t.l):be((t=pe(t)).r,t.g,t.b):new re(t,e,r)}var ne=18;var ae=.95047,ie=1,oe=1.08883;var se=re.prototype=new Zt;se.brighter=function(t){return new re(Math.min(100,this.l+ne*(arguments.length?t:1)),this.a,this.b)};se.darker=function(t){return new re(Math.max(0,this.l-ne*(arguments.length?t:1)),this.a,this.b)};se.rgb=function(){return le(this.l,this.a,this.b)};function le(t,e,r){var n=(t+16)/116,a=n+e/500,i=n-r/200;a=ce(a)*ae;n=ce(n)*ie;i=ce(i)*oe;return new pe(he(3.2404542*a-1.5371385*n-.4985314*i),he(-.969266*a+1.8760108*n+.041556*i),he(.0556434*a-.2040259*n+1.0572252*i))}function ue(t,e,r){return t>0?new Qt(Math.atan2(r,e)*Ot,Math.sqrt(e*e+r*r),t):new Qt(NaN,NaN,t)}function ce(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function fe(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function he(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}e.rgb=pe;function pe(t,e,r){return this instanceof pe?void(this.r=~~t,this.g=~~e,this.b=~~r):arguments.length<2?t instanceof pe?new pe(t.r,t.g,t.b):ye(""+t,pe,Kt):new pe(t,e,r)}function de(t){return new pe(t>>16,t>>8&255,t&255)}function ve(t){return de(t)+""}var ge=pe.prototype=new Zt;ge.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,r=this.g,n=this.b,a=30;if(!e&&!r&&!n)return new pe(a,a,a);if(e&&e<a)e=a;if(r&&r<a)r=a;if(n&&n<a)n=a;return new pe(Math.min(255,e/t),Math.min(255,r/t),Math.min(255,n/t))};ge.darker=function(t){t=Math.pow(.7,arguments.length?t:1);return new pe(t*this.r,t*this.g,t*this.b)};ge.hsl=function(){return xe(this.r,this.g,this.b)};ge.toString=function(){return"#"+me(this.r)+me(this.g)+me(this.b)};function me(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function ye(t,e,r){var n=0,a=0,i=0,o,s,l;o=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase());if(o){s=o[2].split(",");switch(o[1]){case"hsl":{return r(parseFloat(s[0]),parseFloat(s[1])/100,parseFloat(s[2])/100)}case"rgb":{return e(we(s[0]),we(s[1]),we(s[2]))}}}if(l=ke.get(t)){return e(l.r,l.g,l.b)}if(t!=null&&t.charAt(0)==="#"&&!isNaN(l=parseInt(t.slice(1),16))){if(t.length===4){n=(l&3840)>>4;n=n>>4|n;a=l&240;a=a>>4|a;i=l&15;i=i<<4|i}else if(t.length===7){n=(l&16711680)>>16;a=(l&65280)>>8;i=l&255}}return e(n,a,i)}function xe(t,e,r){var n=Math.min(t/=255,e/=255,r/=255),a=Math.max(t,e,r),i=a-n,o,s,l=(a+n)/2;if(i){s=l<.5?i/(a+n):i/(2-a-n);if(t==a)o=(e-r)/i+(e<r?6:0);else if(e==a)o=(r-t)/i+2;else o=(t-e)/i+4;o*=60}else{o=NaN;s=l>0&&l<1?0:o}return new $t(o,s,l)}function be(t,e,r){t=_e(t);e=_e(e);r=_e(r);var n=fe((.4124564*t+.3575761*e+.1804375*r)/ae),a=fe((.2126729*t+.7151522*e+.072175*r)/ie),i=fe((.0193339*t+.119192*e+.9503041*r)/oe);return re(116*a-16,500*(n-a),200*(a-i))}function _e(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function we(t){var e=parseFloat(t);return t.charAt(t.length-1)==="%"?Math.round(e*2.55):e}var ke=e.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});ke.forEach(function(t,e){ke.set(t,de(e))});function Me(t){return typeof t==="function"?t:function(){return t}}e.functor=Me;e.xhr=Ae(P);function Ae(t){return function(e,r,n){if(arguments.length===2&&typeof r==="function")n=r,r=null;return Te(e,r,t,n)}}function Te(t,r,n,i){var o={},s=e.dispatch("beforesend","progress","load","error"),l={},u=new XMLHttpRequest,c=null;if(this.XDomainRequest&&!("withCredentials"in u)&&/^(http(s)?:)?\/\//.test(t))u=new XDomainRequest;"onload"in u?u.onload=u.onerror=f:u.onreadystatechange=function(){u.readyState>3&&f()};function f(){var t=u.status,e;if(!t&&Ee(u)||t>=200&&t<300||t===304){try{e=n.call(o,u)}catch(t){s.error.call(o,t);return}s.load.call(o,e)}else{s.error.call(o,u)}}u.onprogress=function(t){var r=e.event;e.event=t;try{s.progress.call(o,u)}finally{e.event=r}};o.header=function(t,e){t=(t+"").toLowerCase();if(arguments.length<2)return l[t];if(e==null)delete l[t];else l[t]=e+"";return o};o.mimeType=function(t){if(!arguments.length)return r;r=t==null?null:t+"";return o};o.responseType=function(t){if(!arguments.length)return c;c=t;return o};o.response=function(t){n=t;return o};["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(a(arguments)))}});o.send=function(e,n,a){if(arguments.length===2&&typeof n==="function")a=n,n=null;u.open(e,t,true);if(r!=null&&!("accept"in l))l["accept"]=r+",*/*";if(u.setRequestHeader)for(var i in l)u.setRequestHeader(i,l[i]);if(r!=null&&u.overrideMimeType)u.overrideMimeType(r);if(c!=null)u.responseType=c;if(a!=null)o.on("error",a).on("load",function(t){a(null,t)});s.beforesend.call(o,u);u.send(n==null?null:n);return o};o.abort=function(){u.abort();return o};e.rebind(o,s,"on");return i==null?o:o.get(Se(i))}function Se(t){return t.length===1?function(e,r){t(e==null?r:null)}:t}function Ee(t){var e=t.responseType;return e&&e!=="text"?t.response:t.responseText}e.dsv=function(t,e){var r=new RegExp('["'+t+"\n]"),n=t.charCodeAt(0);function a(t,r,n){if(arguments.length<3)n=r,r=null;var a=Te(t,e,r==null?i:o(r),n);a.row=function(t){return arguments.length?a.response((r=t)==null?i:o(t)):r};return a}function i(t){return a.parse(t.responseText)}function o(t){return function(e){return a.parse(e.responseText,t)}}a.parse=function(t,e){var r;return a.parseRows(t,function(t,n){if(r)return r(t,n-1);var a=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");r=e?function(t,r){return e(a(t),r)}:a})};a.parseRows=function(t,e){var r={},a={},i=[],o=t.length,s=0,l=0,u,c;function f(){if(s>=o)return a;if(c)return c=false,r;var e=s;if(t.charCodeAt(e)===34){var i=e;while(i++<o){if(t.charCodeAt(i)===34){if(t.charCodeAt(i+1)!==34)break;++i}}s=i+2;var l=t.charCodeAt(i+1);if(l===13){c=true;if(t.charCodeAt(i+2)===10)++s}else if(l===10){c=true}return t.slice(e+1,i).replace(/""/g,'"')}while(s<o){var l=t.charCodeAt(s++),u=1;if(l===10)c=true;else if(l===13){c=true;if(t.charCodeAt(s)===10)++s,++u}else if(l!==n)continue;return t.slice(e,s-u)}return t.slice(e)}while((u=f())!==a){var h=[];while(u!==r&&u!==a){h.push(u);u=f()}if(e&&(h=e(h,l++))==null)continue;i.push(h)}return i};a.format=function(e){if(Array.isArray(e[0]))return a.formatRows(e);var r=new z,n=[];e.forEach(function(t){for(var e in t){if(!r.has(e)){n.push(r.add(e))}}});return[n.map(l).join(t)].concat(e.map(function(e){return n.map(function(t){return l(e[t])}).join(t)})).join("\n")};a.formatRows=function(t){return t.map(s).join("\n")};function s(e){return e.map(l).join(t)}function l(t){return r.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}return a};e.csv=e.dsv(",","text/csv");e.tsv=e.dsv("\t","text/tab-separated-values");var Ce,Le,Ie,ze,Pe=this[D(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};e.timer=function(){Oe.apply(this,arguments)};function Oe(t,e,r){var n=arguments.length;if(n<2)e=0;if(n<3)r=Date.now();var a=r+e,i={c:t,t:a,n:null};if(Le)Le.n=i;else Ce=i;Le=i;if(!Ie){ze=clearTimeout(ze);Ie=1;Pe(De)}return i}function De(){var t=Re(),e=Be()-t;if(e>24){if(isFinite(e)){clearTimeout(ze);ze=setTimeout(De,e)}Ie=0}else{Ie=1;Pe(De)}}e.timer.flush=function(){Re();Be()};function Re(){var t=Date.now(),e=Ce;while(e){if(t>=e.t&&e.c(t-e.t))e.c=null;e=e.n}return t}function Be(){var t,e=Ce,r=Infinity;while(e){if(e.c){if(e.t<r)r=e.t;e=(t=e).n}else{e=t?t.n=e.n:Ce=e.n}}Le=t;return r}function Fe(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}e.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var Ne=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(je);e.formatPrefix=function(t,r){var n=0;if(t=+t){if(t<0)t*=-1;if(r)t=e.round(t,Fe(t,r));n=1+Math.floor(1e-12+Math.log(t)/Math.LN10);n=Math.max(-24,Math.min(24,Math.floor((n-1)/3)*3))}return Ne[8+n/3]};function je(t,e){var r=Math.pow(10,x(8-e)*3);return{scale:e>8?function(t){return t/r}:function(t){return t*r},symbol:t}}function Ve(t){var r=t.decimal,n=t.thousands,a=t.grouping,i=t.currency,o=a&&n?function(t,e){var r=t.length,i=[],o=0,s=a[0],l=0;while(r>0&&s>0){if(l+s+1>e)s=Math.max(1,e-l);i.push(t.substring(r-=s,r+s));if((l+=s+1)>e)break;s=a[o=(o+1)%a.length]}return i.reverse().join(n)}:P;return function(t){var n=Ue.exec(t),a=n[1]||" ",s=n[2]||">",l=n[3]||"-",u=n[4]||"",c=n[5],f=+n[6],h=n[7],p=n[8],d=n[9],v=1,g="",m="",y=false,x=true;if(p)p=+p.substring(1);if(c||a==="0"&&s==="="){c=a="0";s="="}switch(d){case"n":h=true;d="g";break;case"%":v=100;m="%";d="f";break;case"p":v=100;m="%";d="r";break;case"b":case"o":case"x":case"X":if(u==="#")g="0"+d.toLowerCase();case"c":x=false;case"d":y=true;p=0;break;case"s":v=-1;d="r";break}if(u==="$")g=i[0],m=i[1];if(d=="r"&&!p)d="g";if(p!=null){if(d=="g")p=Math.max(1,Math.min(21,p));else if(d=="e"||d=="f")p=Math.max(0,Math.min(20,p))}d=qe.get(d)||He;var b=c&&h;return function(t){var n=m;if(y&&t%1)return"";var i=t<0||t===0&&1/t<0?(t=-t,"-"):l==="-"?"":l;if(v<0){var u=e.formatPrefix(t,p);t=u.scale(t);n=u.symbol+m}else{t*=v}t=d(t,p);var _=t.lastIndexOf("."),w,k;if(_<0){var M=x?t.lastIndexOf("e"):-1;if(M<0)w=t,k="";else w=t.substring(0,M),k=t.substring(M)}else{w=t.substring(0,_);k=r+t.substring(_+1)}if(!c&&h)w=o(w,Infinity);var A=g.length+w.length+k.length+(b?0:i.length),T=A<f?new Array(A=f-A+1).join(a):"";if(b)w=o(T+w,T.length?f-k.length:Infinity);i+=g;t=w+k;return(s==="<"?i+t+T:s===">"?T+i+t:s==="^"?T.substring(0,A>>=1)+i+t+T.substring(A):i+(b?t:T+t))+n}}}var Ue=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;var qe=e.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,r){return(t=e.round(t,Fe(t,r))).toFixed(Math.max(0,Math.min(20,Fe(t*(1+1e-15),r))))}});function He(t){return t+""}var Ge=e.time={},We=Date;function Ye(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}Ye.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Xe.setUTCDate.apply(this._,arguments)},setDay:function(){Xe.setUTCDay.apply(this._,arguments)},setFullYear:function(){Xe.setUTCFullYear.apply(this._,arguments)},setHours:function(){Xe.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Xe.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Xe.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Xe.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Xe.setUTCSeconds.apply(this._,arguments)},setTime:function(){Xe.setTime.apply(this._,arguments)}};var Xe=Date.prototype;function Ze(t,e,r){function n(e){var r=t(e),n=i(r,1);return e-r<n-e?r:n}function a(r){e(r=t(new We(r-1)),1);return r}function i(t,r){e(t=new We(+t),r);return t}function o(t,n,i){var o=a(t),s=[];if(i>1){while(o<n){if(!(r(o)%i))s.push(new Date(+o));e(o,1)}}else{while(o<n)s.push(new Date(+o)),e(o,1)}return s}function s(t,e,r){try{We=Ye;var n=new Ye;n._=t;return o(n,e,r)}finally{We=Date}}t.floor=t;t.round=n;t.ceil=a;t.offset=i;t.range=o;var l=t.utc=$e(t);l.floor=l;l.round=$e(n);l.ceil=$e(a);l.offset=$e(i);l.range=s;return t}function $e(t){return function(e,r){try{We=Ye;var n=new Ye;n._=e;return t(n,r)._}finally{We=Date}}}Ge.year=Ze(function(t){t=Ge.day(t);t.setMonth(0,1);return t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()});Ge.years=Ge.year.range;Ge.years.utc=Ge.year.utc.range;Ge.day=Ze(function(t){var e=new We(2e3,0);e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate());return e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1});Ge.days=Ge.day.range;Ge.days.utc=Ge.day.utc.range;Ge.dayOfYear=function(t){var e=Ge.year(t);return Math.floor((t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5)};["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var r=Ge[t]=Ze(function(t){(t=Ge.day(t)).setDate(t.getDate()-(t.getDay()+e)%7);return t},function(t,e){t.setDate(t.getDate()+Math.floor(e)*7)},function(t){var r=Ge.year(t).getDay();return Math.floor((Ge.dayOfYear(t)+(r+e)%7)/7)-(r!==e)});Ge[t+"s"]=r.range;Ge[t+"s"].utc=r.utc.range;Ge[t+"OfYear"]=function(t){var r=Ge.year(t).getDay();return Math.floor((Ge.dayOfYear(t)+(r+e)%7)/7)}});Ge.week=Ge.sunday;Ge.weeks=Ge.sunday.range;Ge.weeks.utc=Ge.sunday.utc.range;Ge.weekOfYear=Ge.sundayOfYear;function Je(t){var r=t.dateTime,n=t.date,a=t.time,i=t.periods,o=t.days,s=t.shortDays,l=t.months,u=t.shortMonths;function c(t){var e=t.length;function r(r){var n=[],a=-1,i=0,o,s,l;while(++a<e){if(t.charCodeAt(a)===37){n.push(t.slice(i,a));if((s=Ke[o=t.charAt(++a)])!=null)o=t.charAt(++a);if(l=_[o])o=l(r,s==null?o==="e"?" ":"0":s);n.push(o);i=a+1}}n.push(t.slice(i,a));return n.join("")}r.parse=function(e){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},n=f(r,t,e,0);if(n!=e.length)return null;if("p"in r)r.H=r.H%12+r.p*12;var a=r.Z!=null&&We!==Ye,i=new(a?Ye:We);if("j"in r)i.setFullYear(r.y,0,r.j);else if("W"in r||"U"in r){if(!("w"in r))r.w="W"in r?1:0;i.setFullYear(r.y,0,1);i.setFullYear(r.y,0,"W"in r?(r.w+6)%7+r.W*7-(i.getDay()+5)%7:r.w+r.U*7-(i.getDay()+6)%7)}else i.setFullYear(r.y,r.m,r.d);i.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L);return a?i._:i};r.toString=function(){return t};return r}function f(t,e,r,n){var a,i,o,s=0,l=e.length,u=r.length;while(s<l){if(n>=u)return-1;a=e.charCodeAt(s++);if(a===37){o=e.charAt(s++);i=w[o in Ke?e.charAt(s++):o];if(!i||(n=i(t,r,n))<0)return-1}else if(a!=r.charCodeAt(n++)){return-1}}return n}c.utc=function(t){var e=c(t);function r(t){try{We=Ye;var r=new We;r._=t;return e(r)}finally{We=Date}}r.parse=function(t){try{We=Ye;var r=e.parse(t);return r&&r._}finally{We=Date}};r.toString=e.toString;return r};c.multi=c.utc.multi=br;var h=e.map(),p=rr(o),d=nr(o),v=rr(s),g=nr(s),m=rr(l),y=nr(l),x=rr(u),b=nr(u);i.forEach(function(t,e){h.set(t.toLowerCase(),e)});var _={a:function(t){return s[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return l[t.getMonth()]},c:c(r),d:function(t,e){return er(t.getDate(),e,2)},e:function(t,e){return er(t.getDate(),e,2)},H:function(t,e){return er(t.getHours(),e,2)},I:function(t,e){return er(t.getHours()%12||12,e,2)},j:function(t,e){return er(1+Ge.dayOfYear(t),e,3)},L:function(t,e){return er(t.getMilliseconds(),e,3)},m:function(t,e){return er(t.getMonth()+1,e,2)},M:function(t,e){return er(t.getMinutes(),e,2)},p:function(t){return i[+(t.getHours()>=12)]},S:function(t,e){return er(t.getSeconds(),e,2)},U:function(t,e){return er(Ge.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return er(Ge.mondayOfYear(t),e,2)},x:c(n),X:c(a),y:function(t,e){return er(t.getFullYear()%100,e,2)},Y:function(t,e){return er(t.getFullYear()%1e4,e,4)},Z:yr,"%":function(){return"%"}};var w={a:k,A:M,b:A,B:T,c:S,d:hr,e:hr,H:dr,I:dr,j:pr,L:mr,m:fr,M:vr,p:L,S:gr,U:ir,w:ar,W:or,x:E,X:C,y:lr,Y:sr,Z:ur,"%":xr};function k(t,e,r){v.lastIndex=0;var n=v.exec(e.slice(r));return n?(t.w=g.get(n[0].toLowerCase()),r+n[0].length):-1}function M(t,e,r){p.lastIndex=0;var n=p.exec(e.slice(r));return n?(t.w=d.get(n[0].toLowerCase()),r+n[0].length):-1}function A(t,e,r){x.lastIndex=0;var n=x.exec(e.slice(r));return n?(t.m=b.get(n[0].toLowerCase()),r+n[0].length):-1}function T(t,e,r){m.lastIndex=0;var n=m.exec(e.slice(r));return n?(t.m=y.get(n[0].toLowerCase()),r+n[0].length):-1}function S(t,e,r){return f(t,_.c.toString(),e,r)}function E(t,e,r){return f(t,_.x.toString(),e,r)}function C(t,e,r){return f(t,_.X.toString(),e,r)}function L(t,e,r){var n=h.get(e.slice(r,r+=2).toLowerCase());return n==null?-1:(t.p=n,r)}return c}var Ke={"-":"",_:" ",0:"0"},Qe=/^\s*\d+/,tr=/^%/;function er(t,e,r){var n=t<0?"-":"",a=(n?-t:t)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(e)+a:a)}function rr(t){return new RegExp("^(?:"+t.map(e.requote).join("|")+")","i")}function nr(t){var e=new w,r=-1,n=t.length;while(++r<n)e.set(t[r].toLowerCase(),r);return e}function ar(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function ir(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r));return n?(t.U=+n[0],r+n[0].length):-1}function or(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r));return n?(t.W=+n[0],r+n[0].length):-1}function sr(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function lr(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r,r+2));return n?(t.y=cr(+n[0]),r+n[0].length):-1}function ur(t,e,r){return/^[+-]\d{4}$/.test(e=e.slice(r,r+5))?(t.Z=-e,r+5):-1}function cr(t){return t+(t>68?1900:2e3)}function fr(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function hr(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function pr(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r,r+3));return n?(t.j=+n[0],r+n[0].length):-1}function dr(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function vr(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function gr(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function mr(t,e,r){Qe.lastIndex=0;var n=Qe.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function yr(t){var e=t.getTimezoneOffset(),r=e>0?"-":"+",n=x(e)/60|0,a=x(e)%60;return r+er(n,"0",2)+er(a,"0",2)}function xr(t,e,r){tr.lastIndex=0;var n=tr.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function br(t){var e=t.length,r=-1;while(++r<e)t[r][0]=this(t[r][0]);return function(e){var r=0,n=t[r];while(!n[1](e))n=t[++r];return n[0](e)}}e.locale=function(t){return{numberFormat:Ve(t),timeFormat:Je(t)}};var _r=e.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});e.format=_r.numberFormat;e.geo={};function wr(){}wr.prototype={s:0,t:0,add:function(t){Mr(t,this.t,kr);Mr(kr.s,this.s,this);if(this.s)this.t+=kr.t;else this.s=kr.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var kr=new wr;function Mr(t,e,r){var n=r.s=t+e,a=n-t,i=n-a;r.t=t-i+(e-a)}e.geo.stream=function(t,e){if(t&&Tr.hasOwnProperty(t.type)){Tr[t.type](t,e)}else{Ar(t,e)}};function Ar(t,e){if(t&&Sr.hasOwnProperty(t.type)){Sr[t.type](t,e)}}var Tr={Feature:function(t,e){Ar(t.geometry,e)},FeatureCollection:function(t,e){var r=t.features,n=-1,a=r.length;while(++n<a)Ar(r[n].geometry,e)}};var Sr={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates;e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){var r=t.coordinates,n=-1,a=r.length;while(++n<a)t=r[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){Er(t.coordinates,e,0)},MultiLineString:function(t,e){var r=t.coordinates,n=-1,a=r.length;while(++n<a)Er(r[n],e,0)},Polygon:function(t,e){Cr(t.coordinates,e)},MultiPolygon:function(t,e){var r=t.coordinates,n=-1,a=r.length;while(++n<a)Cr(r[n],e)},GeometryCollection:function(t,e){var r=t.geometries,n=-1,a=r.length;while(++n<a)Ar(r[n],e)}};function Er(t,e,r){var n=-1,a=t.length-r,i;e.lineStart();while(++n<a)i=t[n],e.point(i[0],i[1],i[2]);e.lineEnd()}function Cr(t,e){var r=-1,n=t.length;e.polygonStart();while(++r<n)Er(t[r],e,1);e.polygonEnd()}e.geo.area=function(t){Lr=0;e.geo.stream(t,zr);return Lr};var Lr,Ir=new wr;var zr={sphere:function(){Lr+=4*Ct},point:B,lineStart:B,lineEnd:B,polygonStart:function(){Ir.reset();zr.lineStart=Pr},polygonEnd:function(){var t=2*Ir;Lr+=t<0?4*Ct+t:t;zr.lineStart=zr.lineEnd=zr.point=B}};function Pr(){var t,e,r,n,a;zr.point=function(o,s){zr.point=i;r=(t=o)*Pt,n=Math.cos(s=(e=s)*Pt/2+Ct/4),a=Math.sin(s)};function i(t,e){t*=Pt;e=e*Pt/2+Ct/4;var i=t-r,o=i>=0?1:-1,s=o*i,l=Math.cos(e),u=Math.sin(e),c=a*u,f=n*l+c*Math.cos(s),h=c*o*Math.sin(s);Ir.add(Math.atan2(h,f));r=t,n=l,a=u}zr.lineEnd=function(){i(t,e)}}function Or(t){var e=t[0],r=t[1],n=Math.cos(r);return[n*Math.cos(e),n*Math.sin(e),Math.sin(r)]}function Dr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Rr(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Br(t,e){t[0]+=e[0];t[1]+=e[1];t[2]+=e[2]}function Fr(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Nr(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e;t[1]/=e;t[2]/=e}function jr(t){return[Math.atan2(t[1],t[0]),Ft(t[2])]}function Vr(t,e){return x(t[0]-e[0])<St&&x(t[1]-e[1])<St}e.geo.bounds=function(){var t,r,n,a,i,o,s,l,u,c,f;var h={point:p,lineStart:v,lineEnd:g,polygonStart:function(){h.point=m;h.lineStart=y;h.lineEnd=b;u=0;zr.polygonStart()},polygonEnd:function(){zr.polygonEnd();h.point=p;h.lineStart=v;h.lineEnd=g;if(Ir<0)t=-(n=180),r=-(a=90);else if(u>St)a=90;else if(u<-St)r=-90;f[0]=t,f[1]=n}};function p(e,i){c.push(f=[t=e,n=e]);if(i<r)r=i;if(i>a)a=i}function d(e,o){var s=Or([e*Pt,o*Pt]);if(l){var u=Rr(l,s),c=[u[1],-u[0],0],f=Rr(c,u);Nr(f);f=jr(f);var h=e-i,d=h>0?1:-1,v=f[0]*Ot*d,g=x(h)>180;if(g^(d*i<v&&v<d*e)){var m=f[1]*Ot;if(m>a)a=m}else if(v=(v+360)%360-180,g^(d*i<v&&v<d*e)){var m=-f[1]*Ot;if(m<r)r=m}else{if(o<r)r=o;if(o>a)a=o}if(g){if(e<i){if(_(t,e)>_(t,n))n=e}else{if(_(e,n)>_(t,n))t=e}}else{if(n>=t){if(e<t)t=e;if(e>n)n=e}else{if(e>i){if(_(t,e)>_(t,n))n=e}else{if(_(e,n)>_(t,n))t=e}}}}else{p(e,o)}l=s,i=e}function v(){h.point=d}function g(){f[0]=t,f[1]=n;h.point=p;l=null}function m(t,e){if(l){var r=t-i;u+=x(r)>180?r+(r>0?360:-360):r}else o=t,s=e;zr.point(t,e);d(t,e)}function y(){zr.lineStart()}function b(){m(o,s);zr.lineEnd();if(x(u)>St)t=-(n=180);f[0]=t,f[1]=n;l=null}function _(t,e){return(e-=t)<0?e+360:e}function w(t,e){return t[0]-e[0]}function k(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}return function(i){a=n=-(t=r=Infinity);c=[];e.geo.stream(i,h);var o=c.length;if(o){c.sort(w);for(var s=1,l=c[0],u,p=[l];s<o;++s){u=c[s];if(k(u[0],l)||k(u[1],l)){if(_(l[0],u[1])>_(l[0],l[1]))l[1]=u[1];if(_(u[0],l[1])>_(l[0],l[1]))l[0]=u[0]}else{p.push(l=u)}}var d=-Infinity,v;for(var o=p.length-1,s=0,l=p[o],u;s<=o;l=u,++s){u=p[s];if((v=_(l[1],u[0]))>d)d=v,t=u[0],n=l[1]}}c=f=null;return t===Infinity||r===Infinity?[[NaN,NaN],[NaN,NaN]]:[[t,r],[n,a]]}}();e.geo.centroid=function(t){Ur=qr=Hr=Gr=Wr=Yr=Xr=Zr=$r=Jr=Kr=0;e.geo.stream(t,Qr);var r=$r,n=Jr,a=Kr,i=r*r+n*n+a*a;if(i<Et){r=Yr,n=Xr,a=Zr;if(qr<St)r=Hr,n=Gr,a=Wr;i=r*r+n*n+a*a;if(i<Et)return[NaN,NaN]}return[Math.atan2(n,r)*Ot,Ft(a/Math.sqrt(i))*Ot]};var Ur,qr,Hr,Gr,Wr,Yr,Xr,Zr,$r,Jr,Kr;var Qr={sphere:B,point:tn,lineStart:rn,lineEnd:nn,polygonStart:function(){Qr.lineStart=an},polygonEnd:function(){Qr.lineStart=rn}};function tn(t,e){t*=Pt;var r=Math.cos(e*=Pt);en(r*Math.cos(t),r*Math.sin(t),Math.sin(e))}function en(t,e,r){++Ur;Hr+=(t-Hr)/Ur;Gr+=(e-Gr)/Ur;Wr+=(r-Wr)/Ur}function rn(){var t,e,r;Qr.point=function(a,i){a*=Pt;var o=Math.cos(i*=Pt);t=o*Math.cos(a);e=o*Math.sin(a);r=Math.sin(i);Qr.point=n;en(t,e,r)};function n(n,a){n*=Pt;var i=Math.cos(a*=Pt),o=i*Math.cos(n),s=i*Math.sin(n),l=Math.sin(a),u=Math.atan2(Math.sqrt((u=e*l-r*s)*u+(u=r*o-t*l)*u+(u=t*s-e*o)*u),t*o+e*s+r*l);qr+=u;Yr+=u*(t+(t=o));Xr+=u*(e+(e=s));Zr+=u*(r+(r=l));en(t,e,r)}}function nn(){Qr.point=tn}function an(){var t,e,r,n,a;Qr.point=function(o,s){t=o,e=s;Qr.point=i;o*=Pt;var l=Math.cos(s*=Pt);r=l*Math.cos(o);n=l*Math.sin(o);a=Math.sin(s);en(r,n,a)};Qr.lineEnd=function(){i(t,e);Qr.lineEnd=nn;Qr.point=tn};function i(t,e){t*=Pt;var i=Math.cos(e*=Pt),o=i*Math.cos(t),s=i*Math.sin(t),l=Math.sin(e),u=n*l-a*s,c=a*o-r*l,f=r*s-n*o,h=Math.sqrt(u*u+c*c+f*f),p=r*o+n*s+a*l,d=h&&-Bt(p)/h,v=Math.atan2(h,p);$r+=d*u;Jr+=d*c;Kr+=d*f;qr+=v;Yr+=v*(r+(r=o));Xr+=v*(n+(n=s));Zr+=v*(a+(a=l));en(r,n,a)}}function on(t,e){function r(r,n){return r=t(r,n),e(r[0],r[1])}if(t.invert&&e.invert)r.invert=function(r,n){return r=e.invert(r,n),r&&t.invert(r[0],r[1])};return r}function sn(){return true}function ln(t,e,r,n,a){var i=[],o=[];t.forEach(function(t){if((e=t.length-1)<=0)return;var e,r=t[0],n=t[e];if(Vr(r,n)){a.lineStart();for(var s=0;s<e;++s)a.point((r=t[s])[0],r[1]);a.lineEnd();return}var l=new cn(r,t,null,true),u=new cn(r,null,l,false);l.o=u;i.push(l);o.push(u);l=new cn(n,t,null,false);u=new cn(n,null,l,true);l.o=u;i.push(l);o.push(u)});o.sort(e);un(i);un(o);if(!i.length)return;for(var s=0,l=r,u=o.length;s<u;++s){o[s].e=l=!l}var c=i[0],f,h;while(1){var p=c,d=true;while(p.v)if((p=p.n)===c)return;f=p.z;a.lineStart();do{p.v=p.o.v=true;if(p.e){if(d){for(var s=0,u=f.length;s<u;++s)a.point((h=f[s])[0],h[1])}else{n(p.x,p.n.x,1,a)}p=p.n}else{if(d){f=p.p.z;for(var s=f.length-1;s>=0;--s)a.point((h=f[s])[0],h[1])}else{n(p.x,p.p.x,-1,a)}p=p.p}p=p.o;f=p.z;d=!d}while(!p.v);a.lineEnd()}}function un(t){if(!(e=t.length))return;var e,r=0,n=t[0],a;while(++r<e){n.n=a=t[r];a.p=n;n=a}n.n=a=t[0];a.p=n}function cn(t,e,r,n){this.x=t;this.z=e;this.o=r;this.e=n;this.v=false;this.n=this.p=null}function fn(t,r,n,a){return function(i,o){var s=r(o),l=i.invert(a[0],a[1]);var u={point:c,lineStart:h,lineEnd:p,polygonStart:function(){u.point=b;u.lineStart=_;u.lineEnd=w;d=[];y=[]},polygonEnd:function(){u.point=c;u.lineStart=h;u.lineEnd=p;d=e.merge(d);var t=xn(l,y);if(d.length){if(!m)o.polygonStart(),m=true;ln(d,dn,t,n,o)}else if(t){if(!m)o.polygonStart(),m=true;o.lineStart();n(null,null,1,o);o.lineEnd()}if(m)o.polygonEnd(),m=false;d=y=null},sphere:function(){o.polygonStart();o.lineStart();n(null,null,1,o);o.lineEnd();o.polygonEnd()}};function c(e,r){var n=i(e,r);if(t(e=n[0],r=n[1]))o.point(e,r)}function f(t,e){var r=i(t,e);s.point(r[0],r[1])}function h(){u.point=f;s.lineStart()}function p(){u.point=c;s.lineEnd()}var d;var v=pn(),g=r(v),m=false,y,x;function b(t,e){x.push([t,e]);var r=i(t,e);g.point(r[0],r[1])}function _(){g.lineStart();x=[]}function w(){b(x[0][0],x[0][1]);g.lineEnd();var t=g.clean(),e=v.buffer(),r,n=e.length;x.pop();y.push(x);x=null;if(!n)return;if(t&1){r=e[0];var n=r.length-1,a=-1,i;if(n>0){if(!m)o.polygonStart(),m=true;o.lineStart();while(++a<n)o.point((i=r[a])[0],i[1]);o.lineEnd()}return}if(n>1&&t&2)e.push(e.pop().concat(e.shift()));d.push(e.filter(hn))}return u}}function hn(t){return t.length>1}function pn(){var t=[],e;return{lineStart:function(){t.push(e=[])},point:function(t,r){e.push([t,r])},lineEnd:B,buffer:function(){var r=t;t=[];e=null;return r},rejoin:function(){if(t.length>1)t.push(t.pop().concat(t.shift()))}}}function dn(t,e){return((t=t.x)[0]<0?t[1]-zt-St:zt-t[1])-((e=e.x)[0]<0?e[1]-zt-St:zt-e[1])}var vn=fn(sn,gn,yn,[-Ct,-Ct/2]);function gn(t){var e=NaN,r=NaN,n=NaN,a;return{lineStart:function(){t.lineStart();a=1},point:function(i,o){var s=i>0?Ct:-Ct,l=x(i-e);if(x(l-Ct)<St){t.point(e,r=(r+o)/2>0?zt:-zt);t.point(n,r);t.lineEnd();t.lineStart();t.point(s,r);t.point(i,r);a=0}else if(n!==s&&l>=Ct){if(x(e-n)<St)e-=n*St;if(x(i-s)<St)i-=s*St;r=mn(e,r,i,o);t.point(n,r);t.lineEnd();t.lineStart();t.point(s,r);a=0}t.point(e=i,r=o);n=s},lineEnd:function(){t.lineEnd();e=r=NaN},clean:function(){return 2-a}}}function mn(t,e,r,n){var a,i,o=Math.sin(t-r);return x(o)>St?Math.atan((Math.sin(e)*(i=Math.cos(n))*Math.sin(r)-Math.sin(n)*(a=Math.cos(e))*Math.sin(t))/(a*i*o)):(e+n)/2}function yn(t,e,r,n){var a;if(t==null){a=r*zt;n.point(-Ct,a);n.point(0,a);n.point(Ct,a);n.point(Ct,0);n.point(Ct,-a);n.point(0,-a);n.point(-Ct,-a);n.point(-Ct,0);n.point(-Ct,a)}else if(x(t[0]-e[0])>St){var i=t[0]<e[0]?Ct:-Ct;a=r*i/2;n.point(-i,a);n.point(0,a);n.point(i,a)}else{n.point(e[0],e[1])}}function xn(t,e){var r=t[0],n=t[1],a=[Math.sin(r),-Math.cos(r),0],i=0,o=0;Ir.reset();for(var s=0,l=e.length;s<l;++s){var u=e[s],c=u.length;if(!c)continue;var f=u[0],h=f[0],p=f[1]/2+Ct/4,d=Math.sin(p),v=Math.cos(p),g=1;while(true){if(g===c)g=0;t=u[g];var m=t[0],y=t[1]/2+Ct/4,x=Math.sin(y),b=Math.cos(y),_=m-h,w=_>=0?1:-1,k=w*_,M=k>Ct,A=d*x;Ir.add(Math.atan2(A*w*Math.sin(k),v*b+A*Math.cos(k)));i+=M?_+w*Lt:_;if(M^h>=r^m>=r){var T=Rr(Or(f),Or(t));Nr(T);var S=Rr(a,T);Nr(S);var E=(M^_>=0?-1:1)*Ft(S[2]);if(n>E||n===E&&(T[0]||T[1])){o+=M^_>=0?1:-1}}if(!g++)break;h=m,d=x,v=b,f=t}}return(i<-St||i<St&&Ir<-St)^o&1}function bn(t){var e=Math.cos(t),r=e>0,n=x(e)>St,a=na(t,6*Pt);return fn(i,o,a,r?[0,-t]:[-Ct,t-Ct]);function i(t,r){return Math.cos(t)*Math.cos(r)>e}function o(t){var e,a,o,u,c;return{lineStart:function(){u=o=false;c=1},point:function(f,h){var p=[f,h],d,v=i(f,h),g=r?v?0:l(f,h):v?l(f+(f<0?Ct:-Ct),h):0;if(!e&&(u=o=v))t.lineStart();if(v!==o){d=s(e,p);if(Vr(e,d)||Vr(p,d)){p[0]+=St;p[1]+=St;v=i(p[0],p[1])}}if(v!==o){c=0;if(v){t.lineStart();d=s(p,e);t.point(d[0],d[1])}else{d=s(e,p);t.point(d[0],d[1]);t.lineEnd()}e=d}else if(n&&e&&r^v){var m;if(!(g&a)&&(m=s(p,e,true))){c=0;if(r){t.lineStart();t.point(m[0][0],m[0][1]);t.point(m[1][0],m[1][1]);t.lineEnd()}else{t.point(m[1][0],m[1][1]);t.lineEnd();t.lineStart();t.point(m[0][0],m[0][1])}}}if(v&&(!e||!Vr(e,p))){t.point(p[0],p[1])}e=p,o=v,a=g},lineEnd:function(){if(o)t.lineEnd();e=null},clean:function(){return c|(u&&o)<<1}}}function s(t,r,n){var a=Or(t),i=Or(r);var o=[1,0,0],s=Rr(a,i),l=Dr(s,s),u=s[0],c=l-u*u;if(!c)return!n&&t;var f=e*l/c,h=-e*u/c,p=Rr(o,s),d=Fr(o,f),v=Fr(s,h);Br(d,v);var g=p,m=Dr(d,g),y=Dr(g,g),b=m*m-y*(Dr(d,d)-1);if(b<0)return;var _=Math.sqrt(b),w=Fr(g,(-m-_)/y);Br(w,d);w=jr(w);if(!n)return w;var k=t[0],M=r[0],A=t[1],T=r[1],S;if(M<k)S=k,k=M,M=S;var E=M-k,C=x(E-Ct)<St,L=C||E<St;if(!C&&T<A)S=A,A=T,T=S;if(L?C?A+T>0^w[1]<(x(w[0]-k)<St?A:T):A<=w[1]&&w[1]<=T:E>Ct^(k<=w[0]&&w[0]<=M)){var I=Fr(g,(-m+_)/y);Br(I,d);return[w,jr(I)]}}function l(e,n){var a=r?t:Ct-t,i=0;if(e<-a)i|=1;else if(e>a)i|=2;if(n<-a)i|=4;else if(n>a)i|=8;return i}}function _n(t,e,r,n){return function(a){var i=a.a,o=a.b,s=i.x,l=i.y,u=o.x,c=o.y,f=0,h=1,p=u-s,d=c-l,v;v=t-s;if(!p&&v>0)return;v/=p;if(p<0){if(v<f)return;if(v<h)h=v}else if(p>0){if(v>h)return;if(v>f)f=v}v=r-s;if(!p&&v<0)return;v/=p;if(p<0){if(v>h)return;if(v>f)f=v}else if(p>0){if(v<f)return;if(v<h)h=v}v=e-l;if(!d&&v>0)return;v/=d;if(d<0){if(v<f)return;if(v<h)h=v}else if(d>0){if(v>h)return;if(v>f)f=v}v=n-l;if(!d&&v<0)return;v/=d;if(d<0){if(v>h)return;if(v>f)f=v}else if(d>0){if(v<f)return;if(v<h)h=v}if(f>0)a.a={x:s+f*p,y:l+f*d};if(h<1)a.b={x:s+h*p,y:l+h*d};return a}}var wn=1e9;e.geo.clipExtent=function(){var t,e,r,n,a,i,o={stream:function(t){if(a)a.valid=false;a=i(t);a.valid=true;return a},extent:function(s){if(!arguments.length)return[[t,e],[r,n]];i=kn(t=+s[0][0],e=+s[0][1],r=+s[1][0],n=+s[1][1]);if(a)a.valid=false,a=null;return o}};return o.extent([[0,0],[960,500]])};function kn(t,r,n,a){return function(l){var u=l,c=pn(),f=_n(t,r,n,a),h,p,d;var v={point:x,lineStart:E,lineEnd:C,polygonStart:function(){l=c;h=[];p=[];S=true},polygonEnd:function(){l=u;h=e.merge(h);var r=g([t,a]),n=S&&r,i=h.length;if(n||i){l.polygonStart();if(n){l.lineStart();m(null,null,1,l);l.lineEnd()}if(i){ln(h,o,r,m,l)}l.polygonEnd()}h=p=d=null}};function g(t){var e=0,r=p.length,n=t[1];for(var a=0;a<r;++a){for(var i=1,o=p[a],s=o.length,l=o[0],u;i<s;++i){u=o[i];if(l[1]<=n){if(u[1]>n&&Rt(l,u,t)>0)++e}else{if(u[1]<=n&&Rt(l,u,t)<0)--e}l=u}}return e!==0}function m(e,o,l,u){var c=0,f=0;if(e==null||(c=i(e,l))!==(f=i(o,l))||s(e,o)<0^l>0){do{u.point(c===0||c===3?t:n,c>1?a:r)}while((c=(c+l+4)%4)!==f)}else{u.point(o[0],o[1])}}function y(e,i){return t<=e&&e<=n&&r<=i&&i<=a}function x(t,e){if(y(t,e))l.point(t,e)}var b,_,w,k,M,A,T,S;function E(){v.point=L;if(p)p.push(d=[]);T=true;A=false;k=M=NaN}function C(){if(h){L(b,_);if(w&&A)c.rejoin();h.push(c.buffer())}v.point=x;if(A)l.lineEnd()}function L(t,e){t=Math.max(-wn,Math.min(wn,t));e=Math.max(-wn,Math.min(wn,e));var r=y(t,e);if(p)d.push([t,e]);if(T){b=t,_=e,w=r;T=false;if(r){l.lineStart();l.point(t,e)}}else{if(r&&A)l.point(t,e);else{var n={a:{x:k,y:M},b:{x:t,y:e}};if(f(n)){if(!A){l.lineStart();l.point(n.a.x,n.a.y)}l.point(n.b.x,n.b.y);if(!r)l.lineEnd();S=false}else if(r){l.lineStart();l.point(t,e);S=false}}}k=t,M=e,A=r}return v};function i(e,a){return x(e[0]-t)<St?a>0?0:3:x(e[0]-n)<St?a>0?2:1:x(e[1]-r)<St?a>0?1:0:a>0?3:2}function o(t,e){return s(t.x,e.x)}function s(t,e){var r=i(t,1),n=i(e,1);return r!==n?r-n:r===0?e[1]-t[1]:r===1?t[0]-e[0]:r===2?t[1]-e[1]:e[0]-t[0]}}function Mn(t){var e=0,r=Ct/3,n=Zn(t),a=n(e,r);a.parallels=function(t){if(!arguments.length)return[e/Ct*180,r/Ct*180];return n(e=t[0]*Ct/180,r=t[1]*Ct/180)};return a}function An(t,e){var r=Math.sin(t),n=(r+Math.sin(e))/2,a=1+r*(2*n-r),i=Math.sqrt(a)/n;function o(t,e){var r=Math.sqrt(a-2*n*Math.sin(e))/n;return[r*Math.sin(t*=n),i-r*Math.cos(t)]}o.invert=function(t,e){var r=i-e;return[Math.atan2(t,r)/n,Ft((a-(t*t+r*r)*n*n)/(2*n))]};return o}(e.geo.conicEqualArea=function(){return Mn(An)}).raw=An;e.geo.albers=function(){return e.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};e.geo.albersUsa=function(){var t=e.geo.albers();var r=e.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]);var n=e.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]);var a,i={point:function(t,e){a=[t,e]}},o,s,l;function u(t){var e=t[0],r=t[1];a=null;(o(e,r),a)||(s(e,r),a)||l(e,r);return a}u.invert=function(e){var a=t.scale(),i=t.translate(),o=(e[0]-i[0])/a,s=(e[1]-i[1])/a;return(s>=.12&&s<.234&&o>=-.425&&o<-.214?r:s>=.166&&s<.234&&o>=-.214&&o<-.115?n:t).invert(e)};u.stream=function(e){var a=t.stream(e),i=r.stream(e),o=n.stream(e);return{point:function(t,e){a.point(t,e);i.point(t,e);o.point(t,e)},sphere:function(){a.sphere();i.sphere();o.sphere()},lineStart:function(){a.lineStart();i.lineStart();o.lineStart()},lineEnd:function(){a.lineEnd();i.lineEnd();o.lineEnd()},polygonStart:function(){a.polygonStart();i.polygonStart();o.polygonStart()},polygonEnd:function(){a.polygonEnd();i.polygonEnd();o.polygonEnd()}}};u.precision=function(e){if(!arguments.length)return t.precision();t.precision(e);r.precision(e);n.precision(e);return u};u.scale=function(e){if(!arguments.length)return t.scale();t.scale(e);r.scale(e*.35);n.scale(e);return u.translate(t.translate())};u.translate=function(e){if(!arguments.length)return t.translate();var a=t.scale(),c=+e[0],f=+e[1];o=t.translate(e).clipExtent([[c-.455*a,f-.238*a],[c+.455*a,f+.238*a]]).stream(i).point;s=r.translate([c-.307*a,f+.201*a]).clipExtent([[c-.425*a+St,f+.12*a+St],[c-.214*a-St,f+.234*a-St]]).stream(i).point;l=n.translate([c-.205*a,f+.212*a]).clipExtent([[c-.214*a+St,f+.166*a+St],[c-.115*a-St,f+.234*a-St]]).stream(i).point;return u};return u.scale(1070)};var Tn,Sn,En={point:B,lineStart:B,lineEnd:B,polygonStart:function(){Sn=0;En.lineStart=Cn},polygonEnd:function(){En.lineStart=En.lineEnd=En.point=B;Tn+=x(Sn/2)}};function Cn(){var t,e,r,n;En.point=function(i,o){En.point=a;t=r=i,e=n=o};function a(t,e){Sn+=n*t-r*e;r=t,n=e}En.lineEnd=function(){a(t,e)}}var Ln,In,zn,Pn;var On={point:Dn,lineStart:B,lineEnd:B,polygonStart:B,polygonEnd:B};function Dn(t,e){if(t<Ln)Ln=t;if(t>zn)zn=t;if(e<In)In=e;if(e>Pn)Pn=e}function Rn(){var t=Bn(4.5),e=[];var r={point:n,lineStart:function(){r.point=a},lineEnd:o,polygonStart:function(){r.lineEnd=s},polygonEnd:function(){r.lineEnd=o;r.point=n},pointRadius:function(e){t=Bn(e);return r},result:function(){if(e.length){var t=e.join("");e=[];return t}}};function n(r,n){e.push("M",r,",",n,t)}function a(t,n){e.push("M",t,",",n);r.point=i}function i(t,r){e.push("L",t,",",r)}function o(){r.point=n}function s(){e.push("Z")}return r}function Bn(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}var Fn={point:Nn,lineStart:jn,lineEnd:Vn,polygonStart:function(){Fn.lineStart=Un},polygonEnd:function(){Fn.point=Nn;Fn.lineStart=jn;Fn.lineEnd=Vn}};function Nn(t,e){Hr+=t;Gr+=e;++Wr}function jn(){var t,e;Fn.point=function(n,a){Fn.point=r;Nn(t=n,e=a)};function r(r,n){var a=r-t,i=n-e,o=Math.sqrt(a*a+i*i);Yr+=o*(t+r)/2;Xr+=o*(e+n)/2;Zr+=o;Nn(t=r,e=n)}}function Vn(){Fn.point=Nn}function Un(){var t,e,r,n;Fn.point=function(i,o){Fn.point=a;Nn(t=r=i,e=n=o)};function a(t,e){var a=t-r,i=e-n,o=Math.sqrt(a*a+i*i);Yr+=o*(r+t)/2;Xr+=o*(n+e)/2;Zr+=o;o=n*t-r*e;$r+=o*(r+t);Jr+=o*(n+e);Kr+=o*3;Nn(r=t,n=e)}Fn.lineEnd=function(){a(t,e)}}function qn(t){var e=4.5;var r={point:n,lineStart:function(){r.point=a},lineEnd:o,polygonStart:function(){r.lineEnd=s},polygonEnd:function(){r.lineEnd=o;r.point=n},pointRadius:function(t){e=t;return r},result:B};function n(r,n){t.moveTo(r+e,n);t.arc(r,n,e,0,Lt)}function a(e,n){t.moveTo(e,n);r.point=i}function i(e,r){t.lineTo(e,r)}function o(){r.point=n}function s(){t.closePath()}return r}function Hn(t){var e=.5,r=Math.cos(30*Pt),n=16;function a(t){return(n?o:i)(t)}function i(e){return Yn(e,function(r,n){r=t(r,n);e.point(r[0],r[1])})}function o(e){var r,a,i,o,l,u,c,f,h,p,d,v,g;var m={point:y,lineStart:x,lineEnd:_,polygonStart:function(){e.polygonStart();m.lineStart=w},polygonEnd:function(){e.polygonEnd();m.lineStart=x}};function y(r,n){r=t(r,n);e.point(r[0],r[1])}function x(){h=NaN;m.point=b;e.lineStart()}function b(r,a){var i=Or([r,a]),o=t(r,a);s(h,p,f,d,v,g,h=o[0],p=o[1],f=r,d=i[0],v=i[1],g=i[2],n,e);e.point(h,p)}function _(){m.point=y;e.lineEnd()}function w(){x();m.point=k;m.lineEnd=M}function k(t,e){b(r=t,a=e),i=h,o=p,l=d,u=v,c=g;m.point=b}function M(){s(h,p,f,d,v,g,i,o,r,l,u,c,n,e);m.lineEnd=_;_()}return m}function s(n,a,i,o,l,u,c,f,h,p,d,v,g,m){var y=c-n,b=f-a,_=y*y+b*b;if(_>4*e&&g--){var w=o+p,k=l+d,M=u+v,A=Math.sqrt(w*w+k*k+M*M),T=Math.asin(M/=A),S=x(x(M)-1)<St||x(i-h)<St?(i+h)/2:Math.atan2(k,w),E=t(S,T),C=E[0],L=E[1],I=C-n,z=L-a,P=b*I-y*z;if(P*P/_>e||x((y*I+b*z)/_-.5)>.3||o*p+l*d+u*v<r){s(n,a,i,o,l,u,C,L,S,w/=A,k/=A,M,g,m);m.point(C,L);s(C,L,S,w,k,M,c,f,h,p,d,v,g,m)}}}a.precision=function(t){if(!arguments.length)return Math.sqrt(e);n=(e=t*t)>0&&16;return a};return a}e.geo.path=function(){var t=4.5,r,n,a,i,o;function s(r){if(r){if(typeof t==="function")i.pointRadius(+t.apply(this,arguments));if(!o||!o.valid)o=a(i);e.geo.stream(r,o)}return i.result()}s.area=function(t){Tn=0;e.geo.stream(t,a(En));return Tn};s.centroid=function(t){Hr=Gr=Wr=Yr=Xr=Zr=$r=Jr=Kr=0;e.geo.stream(t,a(Fn));return Kr?[$r/Kr,Jr/Kr]:Zr?[Yr/Zr,Xr/Zr]:Wr?[Hr/Wr,Gr/Wr]:[NaN,NaN]};s.bounds=function(t){zn=Pn=-(Ln=In=Infinity);e.geo.stream(t,a(On));return[[Ln,In],[zn,Pn]]};s.projection=function(t){if(!arguments.length)return r;a=(r=t)?t.stream||Gn(t):P;return l()};s.context=function(e){if(!arguments.length)return n;i=(n=e)==null?new Rn:new qn(e);if(typeof t!=="function")i.pointRadius(t);return l()};s.pointRadius=function(e){if(!arguments.length)return t;t=typeof e==="function"?e:(i.pointRadius(+e),+e);return s};function l(){o=null;return s}return s.projection(e.geo.albersUsa()).context(null)};function Gn(t){var e=Hn(function(e,r){return t([e*Ot,r*Ot])});return function(t){return $n(e(t))}}e.geo.transform=function(t){return{stream:function(e){var r=new Wn(e);for(var n in t)r[n]=t[n];return r}}};function Wn(t){this.stream=t}Wn.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Yn(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}e.geo.projection=Xn;e.geo.projectionMutator=Zn;function Xn(t){return Zn(function(){return t})()}function Zn(t){var r,n,a,i=Hn(function(t,e){t=r(t,e);return[t[0]*o+d,v-t[1]*o]}),o=150,s=480,l=250,u=0,c=0,f=0,h=0,p=0,d,v,g=vn,m=P,y=null,x=null,b;function _(t){t=a(t[0]*Pt,t[1]*Pt);return[t[0]*o+d,v-t[1]*o]}function w(t){t=a.invert((t[0]-d)/o,(v-t[1])/o);return t&&[t[0]*Ot,t[1]*Ot]}_.stream=function(t){if(b)b.valid=false;b=$n(g(n,i(m(t))));b.valid=true;return b};_.clipAngle=function(t){if(!arguments.length)return y;g=t==null?(y=t,vn):bn((y=+t)*Pt);return M()};_.clipExtent=function(t){if(!arguments.length)return x;x=t;m=t?kn(t[0][0],t[0][1],t[1][0],t[1][1]):P;return M()};_.scale=function(t){if(!arguments.length)return o;o=+t;return k()};_.translate=function(t){if(!arguments.length)return[s,l];s=+t[0];l=+t[1];return k()};_.center=function(t){if(!arguments.length)return[u*Ot,c*Ot];u=t[0]%360*Pt;c=t[1]%360*Pt;return k()};_.rotate=function(t){if(!arguments.length)return[f*Ot,h*Ot,p*Ot];f=t[0]%360*Pt;h=t[1]%360*Pt;p=t.length>2?t[2]%360*Pt:0;return k()};e.rebind(_,i,"precision");function k(){a=on(n=Qn(f,h,p),r);var t=r(u,c);d=s-t[0]*o;v=l+t[1]*o;return M()}function M(){if(b)b.valid=false,b=null;return _}return function(){r=t.apply(this,arguments);_.invert=r.invert&&w;return k()}}function $n(t){return Yn(t,function(e,r){t.point(e*Pt,r*Pt)})}function Jn(t,e){return[t,e]}(e.geo.equirectangular=function(){return Xn(Jn)}).raw=Jn.invert=Jn;e.geo.rotation=function(t){t=Qn(t[0]%360*Pt,t[1]*Pt,t.length>2?t[2]*Pt:0);function e(e){e=t(e[0]*Pt,e[1]*Pt);return e[0]*=Ot,e[1]*=Ot,e}e.invert=function(e){e=t.invert(e[0]*Pt,e[1]*Pt);return e[0]*=Ot,e[1]*=Ot,e};return e};function Kn(t,e){return[t>Ct?t-Lt:t<-Ct?t+Lt:t,e]}Kn.invert=Jn;function Qn(t,e,r){return t?e||r?on(ea(t),ra(e,r)):ea(t):e||r?ra(e,r):Kn}function ta(t){return function(e,r){return e+=t,[e>Ct?e-Lt:e<-Ct?e+Lt:e,r]}}function ea(t){var e=ta(t);e.invert=ta(-t);return e}function ra(t,e){var r=Math.cos(t),n=Math.sin(t),a=Math.cos(e),i=Math.sin(e);function o(t,e){var o=Math.cos(e),s=Math.cos(t)*o,l=Math.sin(t)*o,u=Math.sin(e),c=u*r+s*n;return[Math.atan2(l*a-c*i,s*r-u*n),Ft(c*a+l*i)]}o.invert=function(t,e){var o=Math.cos(e),s=Math.cos(t)*o,l=Math.sin(t)*o,u=Math.sin(e),c=u*a-l*i;return[Math.atan2(l*a+u*i,s*r+c*n),Ft(c*r-s*n)]};return o}e.geo.circle=function(){var t=[0,0],e,r=6,n;function a(){var e=typeof t==="function"?t.apply(this,arguments):t,r=Qn(-e[0]*Pt,-e[1]*Pt,0).invert,a=[];n(null,null,1,{point:function(t,e){a.push(t=r(t,e));t[0]*=Ot,t[1]*=Ot}});return{type:"Polygon",coordinates:[a]}}a.origin=function(e){if(!arguments.length)return t;t=e;return a};a.angle=function(t){if(!arguments.length)return e;n=na((e=+t)*Pt,r*Pt);return a};a.precision=function(t){if(!arguments.length)return r;n=na(e*Pt,(r=+t)*Pt);return a};return a.angle(90)};function na(t,e){var r=Math.cos(t),n=Math.sin(t);return function(a,i,o,s){var l=o*e;if(a!=null){a=aa(r,a);i=aa(r,i);if(o>0?a<i:a>i)a+=o*Lt}else{a=t+o*Lt;i=t-.5*l}for(var u,c=a;o>0?c>i:c<i;c-=l){s.point((u=jr([r,-n*Math.cos(c),-n*Math.sin(c)]))[0],u[1])}}}function aa(t,e){var r=Or(e);r[0]-=t;Nr(r);var n=Bt(-r[1]);return((-r[2]<0?-n:n)+2*Math.PI-St)%(2*Math.PI)}e.geo.distance=function(t,e){var r=(e[0]-t[0])*Pt,n=t[1]*Pt,a=e[1]*Pt,i=Math.sin(r),o=Math.cos(r),s=Math.sin(n),l=Math.cos(n),u=Math.sin(a),c=Math.cos(a),f;return Math.atan2(Math.sqrt((f=c*i)*f+(f=l*u-s*c*o)*f),s*u+l*c*o)};e.geo.graticule=function(){var t,r,n,a,i,o,s,l,u=10,c=u,f=90,h=360,p,d,v,g,m=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return e.range(Math.ceil(a/f)*f,n,f).map(v).concat(e.range(Math.ceil(l/h)*h,s,h).map(g)).concat(e.range(Math.ceil(r/u)*u,t,u).filter(function(t){return x(t%f)>St}).map(p)).concat(e.range(Math.ceil(o/c)*c,i,c).filter(function(t){return x(t%h)>St}).map(d))}y.lines=function(){return b().map(function(t){return{type:"LineString",coordinates:t}})};y.outline=function(){return{type:"Polygon",coordinates:[v(a).concat(g(s).slice(1),v(n).reverse().slice(1),g(l).reverse().slice(1))]}};y.extent=function(t){if(!arguments.length)return y.minorExtent();return y.majorExtent(t).minorExtent(t)};y.majorExtent=function(t){if(!arguments.length)return[[a,l],[n,s]];a=+t[0][0],n=+t[1][0];l=+t[0][1],s=+t[1][1];if(a>n)t=a,a=n,n=t;if(l>s)t=l,l=s,s=t;return y.precision(m)};y.minorExtent=function(e){if(!arguments.length)return[[r,o],[t,i]];r=+e[0][0],t=+e[1][0];o=+e[0][1],i=+e[1][1];if(r>t)e=r,r=t,t=e;if(o>i)e=o,o=i,i=e;return y.precision(m)};y.step=function(t){if(!arguments.length)return y.minorStep();return y.majorStep(t).minorStep(t)};y.majorStep=function(t){if(!arguments.length)return[f,h];f=+t[0],h=+t[1];return y};y.minorStep=function(t){if(!arguments.length)return[u,c];u=+t[0],c=+t[1];return y};y.precision=function(e){if(!arguments.length)return m;m=+e;p=ia(o,i,90);d=oa(r,t,m);v=ia(l,s,90);g=oa(a,n,m);return y};return y.majorExtent([[-180,-90+St],[180,90-St]]).minorExtent([[-180,-80-St],[180,80+St]])};function ia(t,r,n){var a=e.range(t,r-St,n).concat(r);return function(t){return a.map(function(e){return[t,e]})}}function oa(t,r,n){var a=e.range(t,r-St,n).concat(r);return function(t){return a.map(function(e){return[e,t]})}}function sa(t){return t.source}function la(t){return t.target}e.geo.greatArc=function(){var t=sa,r,n=la,a;function i(){return{type:"LineString",coordinates:[r||t.apply(this,arguments),a||n.apply(this,arguments)]}}i.distance=function(){return e.geo.distance(r||t.apply(this,arguments),a||n.apply(this,arguments))};i.source=function(e){if(!arguments.length)return t;t=e,r=typeof e==="function"?null:e;return i};i.target=function(t){if(!arguments.length)return n;n=t,a=typeof t==="function"?null:t;return i};i.precision=function(){return arguments.length?i:0};return i};e.geo.interpolate=function(t,e){return ua(t[0]*Pt,t[1]*Pt,e[0]*Pt,e[1]*Pt)};function ua(t,e,r,n){var a=Math.cos(e),i=Math.sin(e),o=Math.cos(n),s=Math.sin(n),l=a*Math.cos(t),u=a*Math.sin(t),c=o*Math.cos(r),f=o*Math.sin(r),h=2*Math.asin(Math.sqrt(Ut(n-e)+a*o*Ut(r-t))),p=1/Math.sin(h);var d=h?function(t){var e=Math.sin(t*=h)*p,r=Math.sin(h-t)*p,n=r*l+e*c,a=r*u+e*f,o=r*i+e*s;return[Math.atan2(a,n)*Ot,Math.atan2(o,Math.sqrt(n*n+a*a))*Ot]}:function(){return[t*Ot,e*Ot]};d.distance=h;return d}e.geo.length=function(t){ca=0;e.geo.stream(t,fa);return ca};var ca;var fa={sphere:B,point:B,lineStart:ha,lineEnd:B,polygonStart:B,polygonEnd:B};function ha(){var t,e,r;fa.point=function(a,i){t=a*Pt,e=Math.sin(i*=Pt),r=Math.cos(i);fa.point=n};fa.lineEnd=function(){fa.point=fa.lineEnd=B};function n(n,a){var i=Math.sin(a*=Pt),o=Math.cos(a),s=x((n*=Pt)-t),l=Math.cos(s);ca+=Math.atan2(Math.sqrt((s=o*Math.sin(s))*s+(s=r*i-e*o*l)*s),e*i+r*o*l);t=n,e=i,r=o}}function pa(t,e){function r(e,r){var n=Math.cos(e),a=Math.cos(r),i=t(n*a);return[i*a*Math.sin(e),i*Math.sin(r)]}r.invert=function(t,r){var n=Math.sqrt(t*t+r*r),a=e(n),i=Math.sin(a),o=Math.cos(a);return[Math.atan2(t*i,n*o),Math.asin(n&&r*i/n)]};return r}var da=pa(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(e.geo.azimuthalEqualArea=function(){return Xn(da)}).raw=da;var va=pa(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},P);(e.geo.azimuthalEquidistant=function(){return Xn(va)}).raw=va;function ga(t,e){var r=Math.cos(t),n=function(t){return Math.tan(Ct/4+t/2)},a=t===e?Math.sin(t):Math.log(r/Math.cos(e))/Math.log(n(e)/n(t)),i=r*Math.pow(n(t),a)/a;if(!a)return xa;function o(t,e){if(i>0){if(e<-zt+St)e=-zt+St}else{if(e>zt-St)e=zt-St}var r=i/Math.pow(n(e),a);return[r*Math.sin(a*t),i-r*Math.cos(a*t)]}o.invert=function(t,e){var r=i-e,n=Dt(a)*Math.sqrt(t*t+r*r);return[Math.atan2(t,r)/a,2*Math.atan(Math.pow(i/n,1/a))-zt]};return o}(e.geo.conicConformal=function(){return Mn(ga)}).raw=ga;function ma(t,e){var r=Math.cos(t),n=t===e?Math.sin(t):(r-Math.cos(e))/(e-t),a=r/n+t;if(x(n)<St)return Jn;function i(t,e){var r=a-e;return[r*Math.sin(n*t),a-r*Math.cos(n*t)]}i.invert=function(t,e){var r=a-e;return[Math.atan2(t,r)/n,a-Dt(n)*Math.sqrt(t*t+r*r)]};return i}(e.geo.conicEquidistant=function(){return Mn(ma)}).raw=ma;var ya=pa(function(t){return 1/t},Math.atan);(e.geo.gnomonic=function(){return Xn(ya)}).raw=ya;function xa(t,e){return[t,Math.log(Math.tan(Ct/4+e/2))]}xa.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-zt]};function ba(t){var e=Xn(t),r=e.scale,n=e.translate,a=e.clipExtent,i;e.scale=function(){var t=r.apply(e,arguments);return t===e?i?e.clipExtent(null):e:t};e.translate=function(){var t=n.apply(e,arguments);return t===e?i?e.clipExtent(null):e:t};e.clipExtent=function(t){var o=a.apply(e,arguments);if(o===e){if(i=t==null){var s=Ct*r(),l=n();a([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else if(i){o=null}return o};return e.clipExtent(null)}(e.geo.mercator=function(){return ba(xa)}).raw=xa;var _a=pa(function(){return 1},Math.asin);(e.geo.orthographic=function(){return Xn(_a)}).raw=_a;var wa=pa(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(e.geo.stereographic=function(){return Xn(wa)}).raw=wa;function ka(t,e){return[Math.log(Math.tan(Ct/4+e/2)),-t]}ka.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-zt]};(e.geo.transverseMercator=function(){var t=ba(ka),e=t.center,r=t.rotate;t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])};t.rotate=function(t){return t?r([t[0],t[1],t.length>2?t[2]+90:90]):(t=r(),[t[0],t[1],t[2]-90])};return r([0,0,90])}).raw=ka;e.geom={};function Ma(t){return t[0]}function Aa(t){return t[1]}e.geom.hull=function(t){var e=Ma,r=Aa;if(arguments.length)return n(t);function n(t){if(t.length<3)return[];var n=Me(e),a=Me(r),i,o=t.length,s=[],l=[];for(i=0;i<o;i++){s.push([+n.call(this,t[i],i),+a.call(this,t[i],i),i])}s.sort(Sa);for(i=0;i<o;i++)l.push([s[i][0],-s[i][1]]);var u=Ta(s),c=Ta(l);var f=c[0]===u[0],h=c[c.length-1]===u[u.length-1],p=[];for(i=u.length-1;i>=0;--i)p.push(t[s[u[i]][2]]);for(i=+f;i<c.length-h;++i)p.push(t[s[c[i]][2]]);return p}n.x=function(t){return arguments.length?(e=t,n):e};n.y=function(t){return arguments.length?(r=t,n):r};return n};function Ta(t){var e=t.length,r=[0,1],n=2;for(var a=2;a<e;a++){while(n>1&&Rt(t[r[n-2]],t[r[n-1]],t[a])<=0)--n;r[n++]=a}return r.slice(0,n)}function Sa(t,e){return t[0]-e[0]||t[1]-e[1]}e.geom.polygon=function(t){H(t,Ea);return t};var Ea=e.geom.polygon.prototype=[];Ea.area=function(){var t=-1,e=this.length,r,n=this[e-1],a=0;while(++t<e){r=n;n=this[t];a+=r[1]*n[0]-r[0]*n[1]}return a*.5};Ea.centroid=function(t){var e=-1,r=this.length,n=0,a=0,i,o=this[r-1],s;if(!arguments.length)t=-1/(6*this.area());while(++e<r){i=o;o=this[e];s=i[0]*o[1]-o[0]*i[1];n+=(i[0]+o[0])*s;a+=(i[1]+o[1])*s}return[n*t,a*t]};Ea.clip=function(t){var e,r=Ia(t),n=-1,a=this.length-Ia(this),i,o,s=this[a-1],l,u,c;while(++n<a){e=t.slice();t.length=0;l=this[n];u=e[(o=e.length-r)-1];i=-1;while(++i<o){c=e[i];if(Ca(c,s,l)){if(!Ca(u,s,l)){t.push(La(u,c,s,l))}t.push(c)}else if(Ca(u,s,l)){t.push(La(u,c,s,l))}u=c}if(r)t.push(t[0]);s=l}return t};function Ca(t,e,r){return(r[0]-e[0])*(t[1]-e[1])<(r[1]-e[1])*(t[0]-e[0])}function La(t,e,r,n){var a=t[0],i=r[0],o=e[0]-a,s=n[0]-i,l=t[1],u=r[1],c=e[1]-l,f=n[1]-u,h=(s*(l-u)-f*(a-i))/(f*o-s*c);return[a+h*o,l+h*c]}function Ia(t){var e=t[0],r=t[t.length-1];return!(e[0]-r[0]||e[1]-r[1])}var za,Pa,Oa,Da=[],Ra,Ba,Fa=[];function Na(){oi(this);this.edge=this.site=this.circle=null}function ja(t){var e=Da.pop()||new Na;e.site=t;return e}function Va(t){Ja(t);Oa.remove(t);Da.push(t);oi(t)}function Ua(t){var e=t.circle,r=e.x,n=e.cy,a={x:r,y:n},i=t.P,o=t.N,s=[t];Va(t);var l=i;while(l.circle&&x(r-l.circle.x)<St&&x(n-l.circle.cy)<St){i=l.P;s.unshift(l);Va(l);l=i}s.unshift(l);Ja(l);var u=o;while(u.circle&&x(r-u.circle.x)<St&&x(n-u.circle.cy)<St){o=u.N;s.push(u);Va(u);u=o}s.push(u);Ja(u);var c=s.length,f;for(f=1;f<c;++f){u=s[f];l=s[f-1];ni(u.edge,l.site,u.site,a)}l=s[0];u=s[c-1];u.edge=ei(l.site,u.site,null,a);$a(l);$a(u)}function qa(t){var e=t.x,r=t.y,n,a,i,o,s=Oa._;while(s){i=Ha(s,r)-e;if(i>St)s=s.L;else{o=e-Ga(s,r);if(o>St){if(!s.R){n=s;break}s=s.R}else{if(i>-St){n=s.P;a=s}else if(o>-St){n=s;a=s.N}else{n=a=s}break}}}var l=ja(t);Oa.insert(n,l);if(!n&&!a)return;if(n===a){Ja(n);a=ja(n.site);Oa.insert(l,a);l.edge=a.edge=ei(n.site,l.site);$a(n);$a(a);return}if(!a){l.edge=ei(n.site,l.site);return}Ja(n);Ja(a);var u=n.site,c=u.x,f=u.y,h=t.x-c,p=t.y-f,d=a.site,v=d.x-c,g=d.y-f,m=2*(h*g-p*v),y=h*h+p*p,x=v*v+g*g,b={x:(g*y-p*x)/m+c,y:(h*x-v*y)/m+f};ni(a.edge,u,d,b);l.edge=ei(u,t,null,b);a.edge=ei(t,d,null,b);$a(n);$a(a)}function Ha(t,e){var r=t.site,n=r.x,a=r.y,i=a-e;if(!i)return n;var o=t.P;if(!o)return-Infinity;r=o.site;var s=r.x,l=r.y,u=l-e;if(!u)return s;var c=s-n,f=1/i-1/u,h=c/u;if(f)return(-h+Math.sqrt(h*h-2*f*(c*c/(-2*u)-l+u/2+a-i/2)))/f+n;return(n+s)/2}function Ga(t,e){var r=t.N;if(r)return Ha(r,e);var n=t.site;return n.y===e?n.x:Infinity}function Wa(t){this.site=t;this.edges=[]}Wa.prototype.prepare=function(){var t=this.edges,e=t.length,r;while(e--){r=t[e].edge;if(!r.b||!r.a)t.splice(e,1)}t.sort(Xa);return t.length};function Ya(t){var e=t[0][0],r=t[1][0],n=t[0][1],a=t[1][1],i,o,s,l,u=Pa,c=u.length,f,h,p,d,v,g;while(c--){f=u[c];if(!f||!f.prepare())continue;p=f.edges;d=p.length;h=0;while(h<d){g=p[h].end(),s=g.x,l=g.y;v=p[++h%d].start(),i=v.x,o=v.y;if(x(s-i)>St||x(l-o)>St){p.splice(h,0,new ai(ri(f.site,g,x(s-e)<St&&a-l>St?{x:e,y:x(i-e)<St?o:a}:x(l-a)<St&&r-s>St?{x:x(o-a)<St?i:r,y:a}:x(s-r)<St&&l-n>St?{x:r,y:x(i-r)<St?o:n}:x(l-n)<St&&s-e>St?{x:x(o-n)<St?i:e,y:n}:null),f.site,null));++d}}}}function Xa(t,e){return e.angle-t.angle}function Za(){oi(this);this.x=this.y=this.arc=this.site=this.cy=null}function $a(t){var e=t.P,r=t.N;if(!e||!r)return;var n=e.site,a=t.site,i=r.site;if(n===i)return;var o=a.x,s=a.y,l=n.x-o,u=n.y-s,c=i.x-o,f=i.y-s;var h=2*(l*f-u*c);if(h>=-Et)return;var p=l*l+u*u,d=c*c+f*f,v=(f*p-u*d)/h,g=(l*d-c*p)/h,f=g+s;var m=Fa.pop()||new Za;m.arc=t;m.site=a;m.x=v+o;m.y=f+Math.sqrt(v*v+g*g);m.cy=f;t.circle=m;var y=null,x=Ba._;while(x){if(m.y<x.y||m.y===x.y&&m.x<=x.x){if(x.L)x=x.L;else{y=x.P;break}}else{if(x.R)x=x.R;else{y=x;break}}}Ba.insert(y,m);if(!y)Ra=m}function Ja(t){var e=t.circle;if(e){if(!e.P)Ra=e.N;Ba.remove(e);Fa.push(e);oi(e);t.circle=null}}function Ka(t){var e=za,r=_n(t[0][0],t[0][1],t[1][0],t[1][1]),n=e.length,a;while(n--){a=e[n];if(!Qa(a,t)||!r(a)||x(a.a.x-a.b.x)<St&&x(a.a.y-a.b.y)<St){a.a=a.b=null;e.splice(n,1)}}}function Qa(t,e){var r=t.b;if(r)return true;var n=t.a,a=e[0][0],i=e[1][0],o=e[0][1],s=e[1][1],l=t.l,u=t.r,c=l.x,f=l.y,h=u.x,p=u.y,d=(c+h)/2,v=(f+p)/2,g,m;if(p===f){if(d<a||d>=i)return;if(c>h){if(!n)n={x:d,y:o};else if(n.y>=s)return;r={x:d,y:s}}else{if(!n)n={x:d,y:s};else if(n.y<o)return;r={x:d,y:o}}}else{g=(c-h)/(p-f);m=v-g*d;if(g<-1||g>1){if(c>h){if(!n)n={x:(o-m)/g,y:o};else if(n.y>=s)return;r={x:(s-m)/g,y:s}}else{if(!n)n={x:(s-m)/g,y:s};else if(n.y<o)return;r={x:(o-m)/g,y:o}}}else{if(f<p){if(!n)n={x:a,y:g*a+m};else if(n.x>=i)return;r={x:i,y:g*i+m}}else{if(!n)n={x:i,y:g*i+m};else if(n.x<a)return;r={x:a,y:g*a+m}}}}t.a=n;t.b=r;return true}function ti(t,e){this.l=t;this.r=e;this.a=this.b=null}function ei(t,e,r,n){var a=new ti(t,e);za.push(a);if(r)ni(a,t,e,r);if(n)ni(a,e,t,n);Pa[t.i].edges.push(new ai(a,t,e));Pa[e.i].edges.push(new ai(a,e,t));return a}function ri(t,e,r){var n=new ti(t,null);n.a=e;n.b=r;za.push(n);return n}function ni(t,e,r,n){if(!t.a&&!t.b){t.a=n;t.l=e;t.r=r}else if(t.l===r){t.b=n}else{t.a=n}}function ai(t,e,r){var n=t.a,a=t.b;this.edge=t;this.site=e;this.angle=r?Math.atan2(r.y-e.y,r.x-e.x):t.l===e?Math.atan2(a.x-n.x,n.y-a.y):Math.atan2(n.x-a.x,a.y-n.y)}ai.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function ii(){this._=null}function oi(t){t.U=t.C=t.L=t.R=t.P=t.N=null}ii.prototype={insert:function(t,e){var r,n,a;if(t){e.P=t;e.N=t.N;if(t.N)t.N.P=e;t.N=e;if(t.R){t=t.R;while(t.L)t=t.L;t.L=e}else{t.R=e}r=t}else if(this._){t=ui(this._);e.P=null;e.N=t;t.P=t.L=e;r=t}else{e.P=e.N=null;this._=e;r=null}e.L=e.R=null;e.U=r;e.C=true;t=e;while(r&&r.C){n=r.U;if(r===n.L){a=n.R;if(a&&a.C){r.C=a.C=false;n.C=true;t=n}else{if(t===r.R){si(this,r);t=r;r=t.U}r.C=false;n.C=true;li(this,n)}}else{a=n.L;if(a&&a.C){r.C=a.C=false;n.C=true;t=n}else{if(t===r.L){li(this,r);t=r;r=t.U}r.C=false;n.C=true;si(this,n)}}r=t.U}this._.C=false},remove:function(t){if(t.N)t.N.P=t.P;if(t.P)t.P.N=t.N;t.N=t.P=null;var e=t.U,r,n=t.L,a=t.R,i,o;if(!n)i=a;else if(!a)i=n;else i=ui(a);if(e){if(e.L===t)e.L=i;else e.R=i}else{this._=i}if(n&&a){o=i.C;i.C=t.C;i.L=n;n.U=i;if(i!==a){e=i.U;i.U=t.U;t=i.R;e.L=t;i.R=a;a.U=i}else{i.U=e;e=i;t=i.R}}else{o=t.C;t=i}if(t)t.U=e;if(o)return;if(t&&t.C){t.C=false;return}do{if(t===this._)break;if(t===e.L){r=e.R;if(r.C){r.C=false;e.C=true;si(this,e);r=e.R}if(r.L&&r.L.C||r.R&&r.R.C){if(!r.R||!r.R.C){r.L.C=false;r.C=true;li(this,r);r=e.R}r.C=e.C;e.C=r.R.C=false;si(this,e);t=this._;break}}else{r=e.L;if(r.C){r.C=false;e.C=true;li(this,e);r=e.L}if(r.L&&r.L.C||r.R&&r.R.C){if(!r.L||!r.L.C){r.R.C=false;r.C=true;si(this,r);r=e.L}r.C=e.C;e.C=r.L.C=false;li(this,e);t=this._;break}}r.C=true;t=e;e=e.U}while(!t.C);if(t)t.C=false}};function si(t,e){var r=e,n=e.R,a=r.U;if(a){if(a.L===r)a.L=n;else a.R=n}else{t._=n}n.U=a;r.U=n;r.R=n.L;if(r.R)r.R.U=r;n.L=r}function li(t,e){var r=e,n=e.L,a=r.U;if(a){if(a.L===r)a.L=n;else a.R=n}else{t._=n}n.U=a;r.U=n;r.L=n.R;if(r.L)r.L.U=r;n.R=r}function ui(t){while(t.L)t=t.L;return t}function ci(t,e){var r=t.sort(fi).pop(),n,a,i;za=[];Pa=new Array(t.length);Oa=new ii;Ba=new ii;while(true){i=Ra;if(r&&(!i||r.y<i.y||r.y===i.y&&r.x<i.x)){if(r.x!==n||r.y!==a){Pa[r.i]=new Wa(r);qa(r);n=r.x,a=r.y}r=t.pop()}else if(i){Ua(i.arc)}else{break}}if(e)Ka(e),Ya(e);var o={cells:Pa,edges:za};Oa=Ba=za=Pa=null;return o}function fi(t,e){return e.y-t.y||e.x-t.x}e.geom.voronoi=function(t){var e=Ma,r=Aa,n=e,a=r,i=hi;if(t)return o(t);function o(t){var e=new Array(t.length),r=i[0][0],n=i[0][1],a=i[1][0],o=i[1][1];ci(s(t),i).cells.forEach(function(i,s){var l=i.edges,u=i.site,c=e[s]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=r&&u.x<=a&&u.y>=n&&u.y<=o?[[r,o],[a,o],[a,n],[r,n]]:[];c.point=t[s]});return e}function s(t){return t.map(function(t,e){return{x:Math.round(n(t,e)/St)*St,y:Math.round(a(t,e)/St)*St,i:e}})}o.links=function(t){return ci(s(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})};o.triangles=function(t){var e=[];ci(s(t)).cells.forEach(function(r,n){var a=r.site,i=r.edges.sort(Xa),o=-1,s=i.length,l,u,c=i[s-1].edge,f=c.l===a?c.r:c.l;while(++o<s){l=c;u=f;c=i[o].edge;f=c.l===a?c.r:c.l;if(n<u.i&&n<f.i&&pi(a,u,f)<0){e.push([t[n],t[u.i],t[f.i]])}}});return e};o.x=function(t){return arguments.length?(n=Me(e=t),o):e};o.y=function(t){return arguments.length?(a=Me(r=t),o):r};o.clipExtent=function(t){if(!arguments.length)return i===hi?null:i;i=t==null?hi:t;return o};o.size=function(t){if(!arguments.length)return i===hi?null:i&&i[1];return o.clipExtent(t&&[[0,0],t])};return o};var hi=[[-1e6,-1e6],[1e6,1e6]];function pi(t,e,r){return(t.x-r.x)*(e.y-t.y)-(t.x-e.x)*(r.y-t.y)}e.geom.delaunay=function(t){return e.geom.voronoi().triangles(t)};e.geom.quadtree=function(t,e,r,n,a){var i=Ma,o=Aa,s;if(s=arguments.length){i=di;o=vi;if(s===3){a=r;n=e;r=e=0}return l(t)}function l(t){var l,u=Me(i),c=Me(o),f,h,p,d,v,g,m,y;if(e!=null){v=e,g=r,m=n,y=a}else{m=y=-(v=g=Infinity);f=[],h=[];d=t.length;if(s)for(p=0;p<d;++p){l=t[p];if(l.x<v)v=l.x;if(l.y<g)g=l.y;if(l.x>m)m=l.x;if(l.y>y)y=l.y;f.push(l.x);h.push(l.y)}else for(p=0;p<d;++p){var b=+u(l=t[p],p),_=+c(l,p);if(b<v)v=b;if(_<g)g=_;if(b>m)m=b;if(_>y)y=_;f.push(b);h.push(_)}}var w=m-v,k=y-g;if(w>k)y=g+w;else m=v+k;function M(t,e,r,n,a,i,o,s){if(isNaN(r)||isNaN(n))return;if(t.leaf){var l=t.x,u=t.y;if(l!=null){if(x(l-r)+x(u-n)<.01){A(t,e,r,n,a,i,o,s)}else{var c=t.point;t.x=t.y=t.point=null;A(t,c,l,u,a,i,o,s);A(t,e,r,n,a,i,o,s)}}else{t.x=r,t.y=n,t.point=e}}else{A(t,e,r,n,a,i,o,s)}}function A(t,e,r,n,a,i,o,s){var l=(a+o)*.5,u=(i+s)*.5,c=r>=l,f=n>=u,h=f<<1|c;t.leaf=false;t=t.nodes[h]||(t.nodes[h]=gi());if(c)a=l;else o=l;if(f)i=u;else s=u;M(t,e,r,n,a,i,o,s)}var T=gi();T.add=function(t){M(T,t,+u(t,++p),+c(t,p),v,g,m,y)};T.visit=function(t){mi(t,T,v,g,m,y)};T.find=function(t){return yi(T,t[0],t[1],v,g,m,y)};p=-1;if(e==null){while(++p<d){M(T,t[p],f[p],h[p],v,g,m,y)}--p}else t.forEach(T.add);f=h=t=l=null;return T}l.x=function(t){return arguments.length?(i=t,l):i};l.y=function(t){return arguments.length?(o=t,l):o};l.extent=function(t){if(!arguments.length)return e==null?null:[[e,r],[n,a]];if(t==null)e=r=n=a=null;else e=+t[0][0],r=+t[0][1],n=+t[1][0],a=+t[1][1];return l};l.size=function(t){if(!arguments.length)return e==null?null:[n-e,a-r];if(t==null)e=r=n=a=null;else e=r=0,n=+t[0],a=+t[1];return l};return l};function di(t){return t.x}function vi(t){return t.y}function gi(){return{leaf:true,nodes:[],point:null,x:null,y:null}}function mi(t,e,r,n,a,i){if(!t(e,r,n,a,i)){var o=(r+a)*.5,s=(n+i)*.5,l=e.nodes;if(l[0])mi(t,l[0],r,n,o,s);if(l[1])mi(t,l[1],o,n,a,s);if(l[2])mi(t,l[2],r,s,o,i);if(l[3])mi(t,l[3],o,s,a,i)}}function yi(t,e,r,n,a,i,o){var s=Infinity,l;(function t(u,c,f,h,p){if(c>i||f>o||h<n||p<a)return;if(d=u.point){var d,v=e-u.x,g=r-u.y,m=v*v+g*g;if(m<s){var y=Math.sqrt(s=m);n=e-y,a=r-y;i=e+y,o=r+y;l=d}}var x=u.nodes,b=(c+h)*.5,_=(f+p)*.5,w=e>=b,k=r>=_;for(var M=k<<1|w,A=M+4;M<A;++M){if(u=x[M&3])switch(M&3){case 0:t(u,c,f,b,_);break;case 1:t(u,b,f,h,_);break;case 2:t(u,c,_,b,p);break;case 3:t(u,b,_,h,p);break}}})(t,n,a,i,o);return l}e.interpolateRgb=xi;function xi(t,r){t=e.rgb(t);r=e.rgb(r);var n=t.r,a=t.g,i=t.b,o=r.r-n,s=r.g-a,l=r.b-i;return function(t){return"#"+me(Math.round(n+o*t))+me(Math.round(a+s*t))+me(Math.round(i+l*t))}}e.interpolateObject=bi;function bi(t,e){var r={},n={},a;for(a in t){if(a in e){r[a]=Ai(t[a],e[a])}else{n[a]=t[a]}}for(a in e){if(!(a in t)){n[a]=e[a]}}return function(t){for(a in r)n[a]=r[a](t);return n}}e.interpolateNumber=_i;function _i(t,e){t=+t,e=+e;return function(r){return t*(1-r)+e*r}}e.interpolateString=wi;function wi(t,e){var r=ki.lastIndex=Mi.lastIndex=0,n,a,i,o=-1,s=[],l=[];t=t+"",e=e+"";while((n=ki.exec(t))&&(a=Mi.exec(e))){if((i=a.index)>r){i=e.slice(r,i);if(s[o])s[o]+=i;else s[++o]=i}if((n=n[0])===(a=a[0])){if(s[o])s[o]+=a;else s[++o]=a}else{s[++o]=null;l.push({i:o,x:_i(n,a)})}r=Mi.lastIndex}if(r<e.length){i=e.slice(r);if(s[o])s[o]+=i;else s[++o]=i}return s.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var r=0,n;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}var ki=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Mi=new RegExp(ki.source,"g");e.interpolate=Ai;function Ai(t,r){var n=e.interpolators.length,a;while(--n>=0&&!(a=e.interpolators[n](t,r)));return a}e.interpolators=[function(t,e){var r=typeof e;return(r==="string"?ke.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?xi:wi:e instanceof Zt?xi:Array.isArray(e)?Ti:r==="object"&&isNaN(e)?bi:_i)(t,e)}];e.interpolateArray=Ti;function Ti(t,e){var r=[],n=[],a=t.length,i=e.length,o=Math.min(t.length,e.length),s;for(s=0;s<o;++s)r.push(Ai(t[s],e[s]));for(;s<a;++s)n[s]=t[s];for(;s<i;++s)n[s]=e[s];return function(t){for(s=0;s<o;++s)n[s]=r[s](t);return n}}var Si=function(){return P};var Ei=e.map({linear:Si,poly:Ri,quad:function(){return Pi},cubic:function(){return Oi},sin:function(){return Bi},exp:function(){return Fi},circle:function(){return Ni},elastic:ji,back:Vi,bounce:function(){return Ui}});var Ci=e.map({in:P,out:Ii,"in-out":zi,"out-in":function(t){return zi(Ii(t))}});e.ease=function(t){var e=t.indexOf("-"),r=e>=0?t.slice(0,e):t,a=e>=0?t.slice(e+1):"in";r=Ei.get(r)||Si;a=Ci.get(a)||P;return Li(a(r.apply(null,n.call(arguments,1))))};function Li(t){return function(e){return e<=0?0:e>=1?1:t(e)}}function Ii(t){return function(e){return 1-t(1-e)}}function zi(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function Pi(t){return t*t}function Oi(t){return t*t*t}function Di(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}function Ri(t){return function(e){return Math.pow(e,t)}}function Bi(t){return 1-Math.cos(t*zt)}function Fi(t){return Math.pow(2,10*(t-1))}function Ni(t){return 1-Math.sqrt(1-t*t)}function ji(t,e){var r;if(arguments.length<2)e=.45;if(arguments.length)r=e/Lt*Math.asin(1/t);else t=1,r=e/4;return function(n){return 1+t*Math.pow(2,-10*n)*Math.sin((n-r)*Lt/e)}}function Vi(t){if(!t)t=1.70158;return function(e){return e*e*((t+1)*e-t)}}function Ui(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}e.interpolateHcl=qi;function qi(t,r){t=e.hcl(t);r=e.hcl(r);var n=t.h,a=t.c,i=t.l,o=r.h-n,s=r.c-a,l=r.l-i;if(isNaN(s))s=0,a=isNaN(a)?r.c:a;if(isNaN(o))o=0,n=isNaN(n)?r.h:n;else if(o>180)o-=360;else if(o<-180)o+=360;return function(t){return ee(n+o*t,a+s*t,i+l*t)+""}}e.interpolateHsl=Hi;function Hi(t,r){t=e.hsl(t);r=e.hsl(r);var n=t.h,a=t.s,i=t.l,o=r.h-n,s=r.s-a,l=r.l-i;if(isNaN(s))s=0,a=isNaN(a)?r.s:a;if(isNaN(o))o=0,n=isNaN(n)?r.h:n;else if(o>180)o-=360;else if(o<-180)o+=360;return function(t){return Kt(n+o*t,a+s*t,i+l*t)+""}}e.interpolateLab=Gi;function Gi(t,r){t=e.lab(t);r=e.lab(r);var n=t.l,a=t.a,i=t.b,o=r.l-n,s=r.a-a,l=r.b-i;return function(t){return le(n+o*t,a+s*t,i+l*t)+""}}e.interpolateRound=Wi;function Wi(t,e){e-=t;return function(r){return Math.round(t+e*r)}}e.transform=function(t){var r=i.createElementNS(e.ns.prefix.svg,"g");return(e.transform=function(t){if(t!=null){r.setAttribute("transform",t);var e=r.transform.baseVal.consolidate()}return new Yi(e?e.matrix:Ji)})(t)};function Yi(t){var e=[t.a,t.b],r=[t.c,t.d],n=Zi(e),a=Xi(e,r),i=Zi($i(r,e,-a))||0;if(e[0]*r[1]<r[0]*e[1]){e[0]*=-1;e[1]*=-1;n*=-1;a*=-1}this.rotate=(n?Math.atan2(e[1],e[0]):Math.atan2(-r[0],r[1]))*Ot;this.translate=[t.e,t.f];this.scale=[n,i];this.skew=i?Math.atan2(a,i)*Ot:0}Yi.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function Xi(t,e){return t[0]*e[0]+t[1]*e[1]}function Zi(t){var e=Math.sqrt(Xi(t,t));if(e){t[0]/=e;t[1]/=e}return e}function $i(t,e,r){t[0]+=r*e[0];t[1]+=r*e[1];return t}var Ji={a:1,b:0,c:0,d:1,e:0,f:0};e.interpolateTransform=no;function Ki(t){return t.length?t.pop()+",":""}function Qi(t,e,r,n){if(t[0]!==e[0]||t[1]!==e[1]){var a=r.push("translate(",null,",",null,")");n.push({i:a-4,x:_i(t[0],e[0])},{i:a-2,x:_i(t[1],e[1])})}else if(e[0]||e[1]){r.push("translate("+e+")")}}function to(t,e,r,n){if(t!==e){if(t-e>180)e+=360;else if(e-t>180)t+=360;n.push({i:r.push(Ki(r)+"rotate(",null,")")-2,x:_i(t,e)})}else if(e){r.push(Ki(r)+"rotate("+e+")")}}function eo(t,e,r,n){if(t!==e){n.push({i:r.push(Ki(r)+"skewX(",null,")")-2,x:_i(t,e)})}else if(e){r.push(Ki(r)+"skewX("+e+")")}}function ro(t,e,r,n){if(t[0]!==e[0]||t[1]!==e[1]){var a=r.push(Ki(r)+"scale(",null,",",null,")");n.push({i:a-4,x:_i(t[0],e[0])},{i:a-2,x:_i(t[1],e[1])})}else if(e[0]!==1||e[1]!==1){r.push(Ki(r)+"scale("+e+")")}}function no(t,r){var n=[],a=[];t=e.transform(t),r=e.transform(r);Qi(t.translate,r.translate,n,a);to(t.rotate,r.rotate,n,a);eo(t.skew,r.skew,n,a);ro(t.scale,r.scale,n,a);t=r=null;return function(t){var e=-1,r=a.length,i;while(++e<r)n[(i=a[e]).i]=i.x(t);return n.join("")}}function ao(t,e){e=(e-=t=+t)||1/e;return function(r){return(r-t)/e}}function io(t,e){e=(e-=t=+t)||1/e;return function(r){return Math.max(0,Math.min(1,(r-t)/e))}}e.layout={};e.layout.bundle=function(){return function(t){var e=[],r=-1,n=t.length;while(++r<n)e.push(oo(t[r]));return e}};function oo(t){var e=t.source,r=t.target,n=lo(e,r),a=[e];while(e!==n){e=e.parent;a.push(e)}var i=a.length;while(r!==n){a.splice(i,0,r);r=r.parent}return a}function so(t){var e=[],r=t.parent;while(r!=null){e.push(t);t=r;r=r.parent}e.push(t);return e}function lo(t,e){if(t===e)return t;var r=so(t),n=so(e),a=r.pop(),i=n.pop(),o=null;while(a===i){o=a;a=r.pop();i=n.pop()}return o}e.layout.chord=function(){var t={},r,n,a,i,o=0,s,l,u;function c(){var t={},c=[],h=e.range(i),p=[],d,v,g,m,y;r=[];n=[];d=0,m=-1;while(++m<i){v=0,y=-1;while(++y<i){v+=a[m][y]}c.push(v);p.push(e.range(i));d+=v}if(s){h.sort(function(t,e){return s(c[t],c[e])})}if(l){p.forEach(function(t,e){t.sort(function(t,r){return l(a[e][t],a[e][r])})})}d=(Lt-o*i)/d;v=0,m=-1;while(++m<i){g=v,y=-1;while(++y<i){var x=h[m],b=p[x][y],_=a[x][b],w=v,k=v+=_*d;t[x+"-"+b]={index:x,subindex:b,startAngle:w,endAngle:k,value:_}}n[x]={index:x,startAngle:g,endAngle:v,value:c[x]};v+=o}m=-1;while(++m<i){y=m-1;while(++y<i){var M=t[m+"-"+y],A=t[y+"-"+m];if(M.value||A.value){r.push(M.value<A.value?{source:A,target:M}:{source:M,target:A})}}}if(u)f()}function f(){r.sort(function(t,e){return u((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}t.matrix=function(e){if(!arguments.length)return a;i=(a=e)&&a.length;r=n=null;return t};t.padding=function(e){if(!arguments.length)return o;o=e;r=n=null;return t};t.sortGroups=function(e){if(!arguments.length)return s;s=e;r=n=null;return t};t.sortSubgroups=function(e){if(!arguments.length)return l;l=e;r=null;return t};t.sortChords=function(e){if(!arguments.length)return u;u=e;if(r)f();return t};t.chords=function(){if(!r)c();return r};t.groups=function(){if(!n)c();return n};return t};e.layout.force=function(){var t={},r=e.dispatch("start","tick","end"),n,a=[1,1],i,o,s=.9,l=vo,u=go,c=-30,f=mo,h=.1,p=.64,d=[],v=[],g,m,y;function x(t){return function(e,r,n,a){if(e.point!==t){var i=e.cx-t.x,o=e.cy-t.y,s=a-r,l=i*i+o*o;if(s*s/p<l){if(l<f){var u=e.charge/l;t.px-=i*u;t.py-=o*u}return true}if(e.point&&l&&l<f){var u=e.pointCharge/l;t.px-=i*u;t.py-=o*u}}return!e.charge}}t.tick=function(){if((o*=.99)<.005){n=null;r.end({type:"end",alpha:o=0});return true}var t=d.length,i=v.length,l,u,f,p,b,_,w,k,M;for(u=0;u<i;++u){f=v[u];p=f.source;b=f.target;k=b.x-p.x;M=b.y-p.y;if(_=k*k+M*M){_=o*m[u]*((_=Math.sqrt(_))-g[u])/_;k*=_;M*=_;b.x-=k*(w=p.weight+b.weight?p.weight/(p.weight+b.weight):.5);b.y-=M*w;p.x+=k*(w=1-w);p.y+=M*w}}if(w=o*h){k=a[0]/2;M=a[1]/2;u=-1;if(w)while(++u<t){f=d[u];f.x+=(k-f.x)*w;f.y+=(M-f.y)*w}}if(c){po(l=e.geom.quadtree(d),o,y);u=-1;while(++u<t){if(!(f=d[u]).fixed){l.visit(x(f))}}}u=-1;while(++u<t){f=d[u];if(f.fixed){f.x=f.px;f.y=f.py}else{f.x-=(f.px-(f.px=f.x))*s;f.y-=(f.py-(f.py=f.y))*s}}r.tick({type:"tick",alpha:o})};t.nodes=function(e){if(!arguments.length)return d;d=e;return t};t.links=function(e){if(!arguments.length)return v;v=e;return t};t.size=function(e){if(!arguments.length)return a;a=e;return t};t.linkDistance=function(e){if(!arguments.length)return l;l=typeof e==="function"?e:+e;return t};t.distance=t.linkDistance;t.linkStrength=function(e){if(!arguments.length)return u;u=typeof e==="function"?e:+e;return t};t.friction=function(e){if(!arguments.length)return s;s=+e;return t};t.charge=function(e){if(!arguments.length)return c;c=typeof e==="function"?e:+e;return t};t.chargeDistance=function(e){if(!arguments.length)return Math.sqrt(f);f=e*e;return t};t.gravity=function(e){if(!arguments.length)return h;h=+e;return t};t.theta=function(e){if(!arguments.length)return Math.sqrt(p);p=e*e;return t};t.alpha=function(e){if(!arguments.length)return o;e=+e;if(o){if(e>0){o=e}else{n.c=null,n.t=NaN,n=null;r.end({type:"end",alpha:o=0})}}else if(e>0){r.start({type:"start",alpha:o=e});n=Oe(t.tick)}return t};t.start=function(){var e,r=d.length,n=v.length,i=a[0],o=a[1],s,f;for(e=0;e<r;++e){(f=d[e]).index=e;f.weight=0}for(e=0;e<n;++e){f=v[e];if(typeof f.source=="number")f.source=d[f.source];if(typeof f.target=="number")f.target=d[f.target];++f.source.weight;++f.target.weight}for(e=0;e<r;++e){f=d[e];if(isNaN(f.x))f.x=h("x",i);if(isNaN(f.y))f.y=h("y",o);if(isNaN(f.px))f.px=f.x;if(isNaN(f.py))f.py=f.y}g=[];if(typeof l==="function")for(e=0;e<n;++e)g[e]=+l.call(this,v[e],e);else for(e=0;e<n;++e)g[e]=l;m=[];if(typeof u==="function")for(e=0;e<n;++e)m[e]=+u.call(this,v[e],e);else for(e=0;e<n;++e)m[e]=u;y=[];if(typeof c==="function")for(e=0;e<r;++e)y[e]=+c.call(this,d[e],e);else for(e=0;e<r;++e)y[e]=c;function h(t,a){if(!s){s=new Array(r);for(l=0;l<r;++l){s[l]=[]}for(l=0;l<n;++l){var i=v[l];s[i.source.index].push(i.target);s[i.target.index].push(i.source)}}var o=s[e],l=-1,u=o.length,c;while(++l<u)if(!isNaN(c=o[l][t]))return c;return Math.random()*a}return t.resume()};t.resume=function(){return t.alpha(.1)};t.stop=function(){return t.alpha(0)};t.drag=function(){if(!i)i=e.behavior.drag().origin(P).on("dragstart.force",uo).on("drag.force",b).on("dragend.force",co);if(!arguments.length)return i;this.on("mouseover.force",fo).on("mouseout.force",ho).call(i)};function b(r){r.px=e.event.x,r.py=e.event.y;t.resume()}return e.rebind(t,r,"on")};function uo(t){t.fixed|=2}function co(t){t.fixed&=~6}function fo(t){t.fixed|=4;t.px=t.x,t.py=t.y}function ho(t){t.fixed&=~4}function po(t,e,r){var n=0,a=0;t.charge=0;if(!t.leaf){var i=t.nodes,o=i.length,s=-1,l;while(++s<o){l=i[s];if(l==null)continue;po(l,e,r);t.charge+=l.charge;n+=l.charge*l.cx;a+=l.charge*l.cy}}if(t.point){if(!t.leaf){t.point.x+=Math.random()-.5;t.point.y+=Math.random()-.5}var u=e*r[t.point.index];t.charge+=t.pointCharge=u;n+=u*t.point.x;a+=u*t.point.y}t.cx=n/t.charge;t.cy=a/t.charge}var vo=20,go=1,mo=Infinity;e.layout.hierarchy=function(){var t=ko,e=_o,r=wo;function n(a){var i=[a],o=[],s;a.depth=0;while((s=i.pop())!=null){o.push(s);if((u=e.call(n,s,s.depth))&&(l=u.length)){var l,u,c;while(--l>=0){i.push(c=u[l]);c.parent=s;c.depth=s.depth+1}if(r)s.value=0;s.children=u}else{if(r)s.value=+r.call(n,s,s.depth)||0;delete s.children}}bo(a,function(e){var n,a;if(t&&(n=e.children))n.sort(t);if(r&&(a=e.parent))a.value+=e.value});return o}n.sort=function(e){if(!arguments.length)return t;t=e;return n};n.children=function(t){if(!arguments.length)return e;e=t;return n};n.value=function(t){if(!arguments.length)return r;r=t;return n};n.revalue=function(t){if(r){xo(t,function(t){if(t.children)t.value=0});bo(t,function(t){var e;if(!t.children)t.value=+r.call(n,t,t.depth)||0;if(e=t.parent)e.value+=t.value})}return t};return n};function yo(t,r){e.rebind(t,r,"sort","children","value");t.nodes=t;t.links=Mo;return t}function xo(t,e){var r=[t];while((t=r.pop())!=null){e(t);if((a=t.children)&&(n=a.length)){var n,a;while(--n>=0)r.push(a[n])}}}function bo(t,e){var r=[t],n=[];while((t=r.pop())!=null){n.push(t);if((o=t.children)&&(i=o.length)){var a=-1,i,o;while(++a<i)r.push(o[a])}}while((t=n.pop())!=null){e(t)}}function _o(t){return t.children}function wo(t){return t.value}function ko(t,e){return e.value-t.value}function Mo(t){return e.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}e.layout.partition=function(){var t=e.layout.hierarchy(),r=[1,1];function n(t,e,r,a){var i=t.children;t.x=e;t.y=t.depth*a;t.dx=r;t.dy=a;if(i&&(s=i.length)){var o=-1,s,l,u;r=t.value?r/t.value:0;while(++o<s){n(l=i[o],e,u=l.value*r,a);e+=u}}}function a(t){var e=t.children,r=0;if(e&&(i=e.length)){var n=-1,i;while(++n<i)r=Math.max(r,a(e[n]))}return 1+r}function i(e,i){var o=t.call(this,e,i);n(o[0],0,r[0],r[1]/a(o[0]));return o}i.size=function(t){if(!arguments.length)return r;r=t;return i};return yo(i,t)};e.layout.pie=function(){var t=Number,r=Ao,n=0,a=Lt,i=0;function o(s){var l=s.length,u=s.map(function(e,r){return+t.call(o,e,r)}),c=+(typeof n==="function"?n.apply(this,arguments):n),f=(typeof a==="function"?a.apply(this,arguments):a)-c,h=Math.min(Math.abs(f)/l,+(typeof i==="function"?i.apply(this,arguments):i)),p=h*(f<0?-1:1),d=e.sum(u),v=d?(f-l*p)/d:0,g=e.range(l),m=[],y;if(r!=null)g.sort(r===Ao?function(t,e){return u[e]-u[t]}:function(t,e){return r(s[t],s[e])});g.forEach(function(t){m[t]={data:s[t],value:y=u[t],startAngle:c,endAngle:c+=y*v+p,padAngle:h}});return m}o.value=function(e){if(!arguments.length)return t;t=e;return o};o.sort=function(t){if(!arguments.length)return r;r=t;return o};o.startAngle=function(t){if(!arguments.length)return n;n=t;return o};o.endAngle=function(t){if(!arguments.length)return a;a=t;return o};o.padAngle=function(t){if(!arguments.length)return i;i=t;return o};return o};var Ao={};e.layout.stack=function(){var t=P,r=Io,n=zo,a=Eo,i=To,o=So;function s(l,u){if(!(v=l.length))return l;var c=l.map(function(e,r){return t.call(s,e,r)});var f=c.map(function(t){return t.map(function(t,e){return[i.call(s,t,e),o.call(s,t,e)]})});var h=r.call(s,f,u);c=e.permute(c,h);f=e.permute(f,h);var p=n.call(s,f,u);var d=c[0].length,v,g,m,y;for(m=0;m<d;++m){a.call(s,c[0][m],y=p[m],f[0][m][1]);for(g=1;g<v;++g){a.call(s,c[g][m],y+=f[g-1][m][1],f[g][m][1])}}return l}s.values=function(e){if(!arguments.length)return t;t=e;return s};s.order=function(t){if(!arguments.length)return r;r=typeof t==="function"?t:Co.get(t)||Io;return s};s.offset=function(t){if(!arguments.length)return n;n=typeof t==="function"?t:Lo.get(t)||zo;return s};s.x=function(t){if(!arguments.length)return i;i=t;return s};s.y=function(t){if(!arguments.length)return o;o=t;return s};s.out=function(t){if(!arguments.length)return a;a=t;return s};return s};function To(t){return t.x}function So(t){return t.y}function Eo(t,e,r){t.y0=e;t.y=r}var Co=e.map({"inside-out":function(t){var r=t.length,n,a,i=t.map(Po),o=t.map(Oo),s=e.range(r).sort(function(t,e){return i[t]-i[e]}),l=0,u=0,c=[],f=[];for(n=0;n<r;++n){a=s[n];if(l<u){l+=o[a];c.push(a)}else{u+=o[a];f.push(a)}}return f.reverse().concat(c)},reverse:function(t){return e.range(t.length).reverse()},default:Io});var Lo=e.map({silhouette:function(t){var e=t.length,r=t[0].length,n=[],a=0,i,o,s,l=[];for(o=0;o<r;++o){for(i=0,s=0;i<e;i++)s+=t[i][o][1];if(s>a)a=s;n.push(s)}for(o=0;o<r;++o){l[o]=(a-n[o])/2}return l},wiggle:function(t){var e=t.length,r=t[0],n=r.length,a,i,o,s,l,u,c,f,h,p=[];p[0]=f=h=0;for(i=1;i<n;++i){for(a=0,s=0;a<e;++a)s+=t[a][i][1];for(a=0,l=0,c=r[i][0]-r[i-1][0];a<e;++a){for(o=0,u=(t[a][i][1]-t[a][i-1][1])/(2*c);o<a;++o){u+=(t[o][i][1]-t[o][i-1][1])/c}l+=u*t[a][i][1]}p[i]=f-=s?l/s*c:0;if(f<h)h=f}for(i=0;i<n;++i)p[i]-=h;return p},expand:function(t){var e=t.length,r=t[0].length,n=1/e,a,i,o,s=[];for(i=0;i<r;++i){for(a=0,o=0;a<e;a++)o+=t[a][i][1];if(o)for(a=0;a<e;a++)t[a][i][1]/=o;else for(a=0;a<e;a++)t[a][i][1]=n}for(i=0;i<r;++i)s[i]=0;return s},zero:zo});function Io(t){return e.range(t.length)}function zo(t){var e=-1,r=t[0].length,n=[];while(++e<r)n[e]=0;return n}function Po(t){var e=1,r=0,n=t[0][1],a,i=t.length;for(;e<i;++e){if((a=t[e][1])>n){r=e;n=a}}return r}function Oo(t){return t.reduce(Do,0)}function Do(t,e){return t+e[1]}e.layout.histogram=function(){var t=true,r=Number,n=Fo,a=Ro;function i(i,o){var s=[],l=i.map(r,this),u=n.call(this,l,o),c=a.call(this,u,l,o),f,o=-1,h=l.length,p=c.length-1,d=t?1:1/h,v;while(++o<p){f=s[o]=[];f.dx=c[o+1]-(f.x=c[o]);f.y=0}if(p>0){o=-1;while(++o<h){v=l[o];if(v>=u[0]&&v<=u[1]){f=s[e.bisect(c,v,1,p)-1];f.y+=d;f.push(i[o])}}}return s}i.value=function(t){if(!arguments.length)return r;r=t;return i};i.range=function(t){if(!arguments.length)return n;n=Me(t);return i};i.bins=function(t){if(!arguments.length)return a;a=typeof t==="number"?function(e){return Bo(e,t)}:Me(t);return i};i.frequency=function(e){if(!arguments.length)return t;t=!!e;return i};return i};function Ro(t,e){return Bo(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function Bo(t,e){var r=-1,n=+t[0],a=(t[1]-n)/e,i=[];while(++r<=e)i[r]=a*r+n;return i}function Fo(t){return[e.min(t),e.max(t)]}e.layout.pack=function(){var t=e.layout.hierarchy().sort(No),r=0,n=[1,1],a;function i(e,i){var o=t.call(this,e,i),s=o[0],l=n[0],u=n[1],c=a==null?Math.sqrt:typeof a==="function"?a:function(){return a};s.x=s.y=0;bo(s,function(t){t.r=+c(t.value)});bo(s,qo);if(r){var f=r*(a?1:Math.max(2*s.r/l,2*s.r/u))/2;bo(s,function(t){t.r+=f});bo(s,qo);bo(s,function(t){t.r-=f})}Wo(s,l/2,u/2,a?1:1/Math.max(2*s.r/l,2*s.r/u));return o}i.size=function(t){if(!arguments.length)return n;n=t;return i};i.radius=function(t){if(!arguments.length)return a;a=t==null||typeof t==="function"?t:+t;return i};i.padding=function(t){if(!arguments.length)return r;r=+t;return i};return yo(i,t)};function No(t,e){return t.value-e.value}function jo(t,e){var r=t._pack_next;t._pack_next=e;e._pack_prev=t;e._pack_next=r;r._pack_prev=e}function Vo(t,e){t._pack_next=e;e._pack_prev=t}function Uo(t,e){var r=e.x-t.x,n=e.y-t.y,a=t.r+e.r;return.999*a*a>r*r+n*n}function qo(t){if(!(e=t.children)||!(h=e.length))return;var e,r=Infinity,n=-Infinity,a=Infinity,i=-Infinity,o,s,l,u,c,f,h;function p(t){r=Math.min(t.x-t.r,r);n=Math.max(t.x+t.r,n);a=Math.min(t.y-t.r,a);i=Math.max(t.y+t.r,i)}e.forEach(Ho);o=e[0];o.x=-o.r;o.y=0;p(o);if(h>1){s=e[1];s.x=s.r;s.y=0;p(s);if(h>2){l=e[2];Yo(o,s,l);p(l);jo(o,l);o._pack_prev=l;jo(l,s);s=o._pack_next;for(u=3;u<h;u++){Yo(o,s,l=e[u]);var d=0,v=1,g=1;for(c=s._pack_next;c!==s;c=c._pack_next,v++){if(Uo(c,l)){d=1;break}}if(d==1){for(f=o._pack_prev;f!==c._pack_prev;f=f._pack_prev,g++){if(Uo(f,l)){break}}}if(d){if(v<g||v==g&&s.r<o.r)Vo(o,s=c);else Vo(o=f,s);u--}else{jo(o,l);s=l;p(l)}}}}var m=(r+n)/2,y=(a+i)/2,x=0;for(u=0;u<h;u++){l=e[u];l.x-=m;l.y-=y;x=Math.max(x,l.r+Math.sqrt(l.x*l.x+l.y*l.y))}t.r=x;e.forEach(Go)}function Ho(t){t._pack_next=t._pack_prev=t}function Go(t){delete t._pack_next;delete t._pack_prev}function Wo(t,e,r,n){var a=t.children;t.x=e+=n*t.x;t.y=r+=n*t.y;t.r*=n;if(a){var i=-1,o=a.length;while(++i<o)Wo(a[i],e,r,n)}}function Yo(t,e,r){var n=t.r+r.r,a=e.x-t.x,i=e.y-t.y;if(n&&(a||i)){var o=e.r+r.r,s=a*a+i*i;o*=o;n*=n;var l=.5+(n-o)/(2*s),u=Math.sqrt(Math.max(0,2*o*(n+s)-(n-=s)*n-o*o))/(2*s);r.x=t.x+l*a+u*i;r.y=t.y+l*i-u*a}else{r.x=t.x+n;r.y=t.y}}e.layout.tree=function(){var t=e.layout.hierarchy().sort(null).value(null),r=Xo,n=[1,1],a=null;function i(e,i){var u=t.call(this,e,i),f=u[0],h=o(f);bo(h,s),h.parent.m=-h.z;xo(h,l);if(a)xo(f,c);else{var p=f,d=f,v=f;xo(f,function(t){if(t.x<p.x)p=t;if(t.x>d.x)d=t;if(t.depth>v.depth)v=t});var g=r(p,d)/2-p.x,m=n[0]/(d.x+r(d,p)/2+g),y=n[1]/(v.depth||1);xo(f,function(t){t.x=(t.x+g)*m;t.y=t.depth*y})}return u}function o(t){var e={A:null,children:[t]},r=[e],n;while((n=r.pop())!=null){for(var a=n.children,i,o=0,s=a.length;o<s;++o){r.push((a[o]=i={_:a[o],parent:n,children:(i=a[o].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=i)}}return e.children[0]}function s(t){var e=t.children,n=t.parent.children,a=t.i?n[t.i-1]:null;if(e.length){Ko(t);var i=(e[0].z+e[e.length-1].z)/2;if(a){t.z=a.z+r(t._,a._);t.m=t.z-i}else{t.z=i}}else if(a){t.z=a.z+r(t._,a._)}t.parent.A=u(t,a,t.parent.A||n[0])}function l(t){t._.x=t.z+t.parent.m;t.m+=t.parent.m}function u(t,e,n){if(e){var a=t,i=t,o=e,s=a.parent.children[0],l=a.m,u=i.m,c=o.m,f=s.m,h;while(o=$o(o),a=Zo(a),o&&a){s=Zo(s);i=$o(i);i.a=t;h=o.z+c-a.z-l+r(o._,a._);if(h>0){Jo(Qo(o,t,n),t,h);l+=h;u+=h}c+=o.m;l+=a.m;f+=s.m;u+=i.m}if(o&&!$o(i)){i.t=o;i.m+=c-u}if(a&&!Zo(s)){s.t=a;s.m+=l-f;n=t}}return n}function c(t){t.x*=n[0];t.y=t.depth*n[1]}i.separation=function(t){if(!arguments.length)return r;r=t;return i};i.size=function(t){if(!arguments.length)return a?null:n;a=(n=t)==null?c:null;return i};i.nodeSize=function(t){if(!arguments.length)return a?n:null;a=(n=t)==null?null:c;return i};return yo(i,t)};function Xo(t,e){return t.parent==e.parent?1:2}function Zo(t){var e=t.children;return e.length?e[0]:t.t}function $o(t){var e=t.children,r;return(r=e.length)?e[r-1]:t.t}function Jo(t,e,r){var n=r/(e.i-t.i);e.c-=n;e.s+=r;t.c+=n;e.z+=r;e.m+=r}function Ko(t){var e=0,r=0,n=t.children,a=n.length,i;while(--a>=0){i=n[a];i.z+=e;i.m+=e;e+=i.s+(r+=i.c)}}function Qo(t,e,r){return t.a.parent===e.parent?t.a:r}e.layout.cluster=function(){var t=e.layout.hierarchy().sort(null).value(null),r=Xo,n=[1,1],a=false;function i(e,i){var o=t.call(this,e,i),s=o[0],l,u=0;bo(s,function(t){var e=t.children;if(e&&e.length){t.x=es(e);t.y=ts(e)}else{t.x=l?u+=r(t,l):0;t.y=0;l=t}});var c=rs(s),f=ns(s),h=c.x-r(c,f)/2,p=f.x+r(f,c)/2;bo(s,a?function(t){t.x=(t.x-s.x)*n[0];t.y=(s.y-t.y)*n[1]}:function(t){t.x=(t.x-h)/(p-h)*n[0];t.y=(1-(s.y?t.y/s.y:1))*n[1]});return o}i.separation=function(t){if(!arguments.length)return r;r=t;return i};i.size=function(t){if(!arguments.length)return a?null:n;a=(n=t)==null;return i};i.nodeSize=function(t){if(!arguments.length)return a?n:null;a=(n=t)!=null;return i};return yo(i,t)};function ts(t){return 1+e.max(t,function(t){return t.y})}function es(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function rs(t){var e=t.children;return e&&e.length?rs(e[0]):t}function ns(t){var e=t.children,r;return e&&(r=e.length)?ns(e[r-1]):t}e.layout.treemap=function(){var t=e.layout.hierarchy(),r=Math.round,n=[1,1],a=null,i=as,o=false,s,l="squarify",u=.5*(1+Math.sqrt(5));function c(t,e){var r=-1,n=t.length,a,i;while(++r<n){i=(a=t[r]).value*(e<0?0:e);a.area=isNaN(i)||i<=0?0:i}}function f(t){var e=t.children;if(e&&e.length){var r=i(t),n=[],a=e.slice(),o,s=Infinity,u,h=l==="slice"?r.dx:l==="dice"?r.dy:l==="slice-dice"?t.depth&1?r.dy:r.dx:Math.min(r.dx,r.dy),v;c(a,r.dx*r.dy/t.value);n.area=0;while((v=a.length)>0){n.push(o=a[v-1]);n.area+=o.area;if(l!=="squarify"||(u=p(n,h))<=s){a.pop();s=u}else{n.area-=n.pop().area;d(n,h,r,false);h=Math.min(r.dx,r.dy);n.length=n.area=0;s=Infinity}}if(n.length){d(n,h,r,true);n.length=n.area=0}e.forEach(f)}}function h(t){var e=t.children;if(e&&e.length){var r=i(t),n=e.slice(),a,o=[];c(n,r.dx*r.dy/t.value);o.area=0;while(a=n.pop()){o.push(a);o.area+=a.area;if(a.z!=null){d(o,a.z?r.dx:r.dy,r,!n.length);o.length=o.area=0}}e.forEach(h)}}function p(t,e){var r=t.area,n,a=0,i=Infinity,o=-1,s=t.length;while(++o<s){if(!(n=t[o].area))continue;if(n<i)i=n;if(n>a)a=n}r*=r;e*=e;return r?Math.max(e*a*u/r,r/(e*i*u)):Infinity}function d(t,e,n,a){var i=-1,o=t.length,s=n.x,l=n.y,u=e?r(t.area/e):0,c;if(e==n.dx){if(a||u>n.dy)u=n.dy;while(++i<o){c=t[i];c.x=s;c.y=l;c.dy=u;s+=c.dx=Math.min(n.x+n.dx-s,u?r(c.area/u):0)}c.z=true;c.dx+=n.x+n.dx-s;n.y+=u;n.dy-=u}else{if(a||u>n.dx)u=n.dx;while(++i<o){c=t[i];c.x=s;c.y=l;c.dx=u;l+=c.dy=Math.min(n.y+n.dy-l,u?r(c.area/u):0)}c.z=false;c.dy+=n.y+n.dy-l;n.x+=u;n.dx-=u}}function v(e){var r=s||t(e),a=r[0];a.x=a.y=0;if(a.value)a.dx=n[0],a.dy=n[1];else a.dx=a.dy=0;if(s)t.revalue(a);c([a],a.dx*a.dy/a.value);(s?h:f)(a);if(o)s=r;return r}v.size=function(t){if(!arguments.length)return n;n=t;return v};v.padding=function(t){if(!arguments.length)return a;function e(e){var r=t.call(v,e,e.depth);return r==null?as(e):is(e,typeof r==="number"?[r,r,r,r]:r)}function r(e){return is(e,t)}var n;i=(a=t)==null?as:(n=typeof t)==="function"?e:n==="number"?(t=[t,t,t,t],r):r;return v};v.round=function(t){if(!arguments.length)return r!=Number;r=t?Math.round:Number;return v};v.sticky=function(t){if(!arguments.length)return o;o=t;s=null;return v};v.ratio=function(t){if(!arguments.length)return u;u=t;return v};v.mode=function(t){if(!arguments.length)return l;l=t+"";return v};return yo(v,t)};function as(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function is(t,e){var r=t.x+e[3],n=t.y+e[0],a=t.dx-e[1]-e[3],i=t.dy-e[0]-e[2];if(a<0){r+=a/2;a=0}if(i<0){n+=i/2;i=0}return{x:r,y:n,dx:a,dy:i}}e.random={normal:function(t,e){var r=arguments.length;if(r<2)e=1;if(r<1)t=0;return function(){var r,n,a;do{r=Math.random()*2-1;n=Math.random()*2-1;a=r*r+n*n}while(!a||a>1);return t+e*r*Math.sqrt(-2*Math.log(a)/a)}},logNormal:function(){var t=e.random.normal.apply(e,arguments);return function(){return Math.exp(t())}},bates:function(t){var r=e.random.irwinHall(t);return function(){return r()/t}},irwinHall:function(t){return function(){for(var e=0,r=0;r<t;r++)e+=Math.random();return e}}};e.scale={};function os(t){var e=t[0],r=t[t.length-1];return e<r?[e,r]:[r,e]}function ss(t){return t.rangeExtent?t.rangeExtent():os(t.range())}function ls(t,e,r,n){var a=r(t[0],t[1]),i=n(e[0],e[1]);return function(t){return i(a(t))}}function us(t,e){var r=0,n=t.length-1,a=t[r],i=t[n],o;if(i<a){o=r,r=n,n=o;o=a,a=i,i=o}t[r]=e.floor(a);t[n]=e.ceil(i);return t}function cs(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:fs}var fs={floor:P,ceil:P};function hs(t,r,n,a){var i=[],o=[],s=0,l=Math.min(t.length,r.length)-1;if(t[l]<t[0]){t=t.slice().reverse();r=r.slice().reverse()}while(++s<=l){i.push(n(t[s-1],t[s]));o.push(a(r[s-1],r[s]))}return function(r){var n=e.bisect(t,r,1,l)-1;return o[n](i[n](r))}}e.scale.linear=function(){return ps([0,1],[0,1],Ai,false)};function ps(t,e,r,n){var a,i;function o(){var o=Math.min(t.length,e.length)>2?hs:ls,l=n?io:ao;a=o(t,e,l,r);i=o(e,t,l,Ai);return s}function s(t){return a(t)}s.invert=function(t){return i(t)};s.domain=function(e){if(!arguments.length)return t;t=e.map(Number);return o()};s.range=function(t){if(!arguments.length)return e;e=t;return o()};s.rangeRound=function(t){return s.range(t).interpolate(Wi)};s.clamp=function(t){if(!arguments.length)return n;n=t;return o()};s.interpolate=function(t){if(!arguments.length)return r;r=t;return o()};s.ticks=function(e){return ms(t,e)};s.tickFormat=function(e,r){return ys(t,e,r)};s.nice=function(e){vs(t,e);return o()};s.copy=function(){return ps(t,e,r,n)};return o()}function ds(t,r){return e.rebind(t,r,"range","rangeRound","interpolate","clamp")}function vs(t,e){us(t,cs(gs(t,e)[2]));us(t,cs(gs(t,e)[2]));return t}function gs(t,e){if(e==null)e=10;var r=os(t),n=r[1]-r[0],a=Math.pow(10,Math.floor(Math.log(n/e)/Math.LN10)),i=e/n*a;if(i<=.15)a*=10;else if(i<=.35)a*=5;else if(i<=.75)a*=2;r[0]=Math.ceil(r[0]/a)*a;r[1]=Math.floor(r[1]/a)*a+a*.5;r[2]=a;return r}function ms(t,r){return e.range.apply(e,gs(t,r))}function ys(t,r,n){var a=gs(t,r);if(n){var i=Ue.exec(n);i.shift();if(i[8]==="s"){var o=e.formatPrefix(Math.max(x(a[0]),x(a[1])));if(!i[7])i[7]="."+bs(o.scale(a[2]));i[8]="f";n=e.format(i.join(""));return function(t){return n(o.scale(t))+o.symbol}}if(!i[7])i[7]="."+_s(i[8],a);n=i.join("")}else{n=",."+bs(a[2])+"f"}return e.format(n)}var xs={s:1,g:1,p:1,r:1,e:1};function bs(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function _s(t,e){var r=bs(e[2]);return t in xs?Math.abs(r-bs(Math.max(x(e[0]),x(e[1]))))+ +(t!=="e"):r-(t==="%")*2}e.scale.log=function(){return ws(e.scale.linear().domain([0,1]),10,true,[1,10])};function ws(t,r,n,a){function i(t){return(n?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(r)}function o(t){return n?Math.pow(r,t):-Math.pow(r,-t)}function s(e){return t(i(e))}s.invert=function(e){return o(t.invert(e))};s.domain=function(e){if(!arguments.length)return a;n=e[0]>=0;t.domain((a=e.map(Number)).map(i));return s};s.base=function(e){if(!arguments.length)return r;r=+e;t.domain(a.map(i));return s};s.nice=function(){var e=us(a.map(i),n?Math:Ms);t.domain(e);a=e.map(o);return s};s.ticks=function(){var t=os(a),e=[],s=t[0],l=t[1],u=Math.floor(i(s)),c=Math.ceil(i(l)),f=r%1?2:r;if(isFinite(c-u)){if(n){for(;u<c;u++)for(var h=1;h<f;h++)e.push(o(u)*h);e.push(o(u))}else{e.push(o(u));for(;u++<c;)for(var h=f-1;h>0;h--)e.push(o(u)*h)}for(u=0;e[u]<s;u++){}for(c=e.length;e[c-1]>l;c--){}e=e.slice(u,c)}return e};s.tickFormat=function(t,n){if(!arguments.length)return ks;if(arguments.length<2)n=ks;else if(typeof n!=="function")n=e.format(n);var a=Math.max(1,r*t/s.ticks().length);return function(t){var e=t/o(Math.round(i(t)));if(e*r<r-.5)e*=r;return e<=a?n(t):""}};s.copy=function(){return ws(t.copy(),r,n,a)};return ds(s,t)}var ks=e.format(".0e"),Ms={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};e.scale.pow=function(){return As(e.scale.linear(),1,[0,1])};function As(t,e,r){var n=Ts(e),a=Ts(1/e);function i(e){return t(n(e))}i.invert=function(e){return a(t.invert(e))};i.domain=function(e){if(!arguments.length)return r;t.domain((r=e.map(Number)).map(n));return i};i.ticks=function(t){return ms(r,t)};i.tickFormat=function(t,e){return ys(r,t,e)};i.nice=function(t){return i.domain(vs(r,t))};i.exponent=function(o){if(!arguments.length)return e;n=Ts(e=o);a=Ts(1/e);t.domain(r.map(n));return i};i.copy=function(){return As(t.copy(),e,r)};return ds(i,t)}function Ts(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}e.scale.sqrt=function(){return e.scale.pow().exponent(.5)};e.scale.ordinal=function(){return Ss([],{t:"range",a:[[]]})};function Ss(t,r){var n,a,i;function o(e){return a[((n.get(e)||(r.t==="range"?n.set(e,t.push(e)):NaN))-1)%a.length]}function s(r,n){return e.range(t.length).map(function(t){return r+n*t})}o.domain=function(e){if(!arguments.length)return t;t=[];n=new w;var a=-1,i=e.length,s;while(++a<i)if(!n.has(s=e[a]))n.set(s,t.push(s));return o[r.t].apply(o,r.a)};o.range=function(t){if(!arguments.length)return a;a=t;i=0;r={t:"range",a:arguments};return o};o.rangePoints=function(e,n){if(arguments.length<2)n=0;var l=e[0],u=e[1],c=t.length<2?(l=(l+u)/2,0):(u-l)/(t.length-1+n);a=s(l+c*n/2,c);i=0;r={t:"rangePoints",a:arguments};return o};o.rangeRoundPoints=function(e,n){if(arguments.length<2)n=0;var l=e[0],u=e[1],c=t.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(t.length-1+n)|0;a=s(l+Math.round(c*n/2+(u-l-(t.length-1+n)*c)/2),c);i=0;r={t:"rangeRoundPoints",a:arguments};return o};o.rangeBands=function(e,n,l){if(arguments.length<2)n=0;if(arguments.length<3)l=n;var u=e[1]<e[0],c=e[u-0],f=e[1-u],h=(f-c)/(t.length-n+2*l);a=s(c+h*l,h);if(u)a.reverse();i=h*(1-n);r={t:"rangeBands",a:arguments};return o};o.rangeRoundBands=function(e,n,l){if(arguments.length<2)n=0;if(arguments.length<3)l=n;var u=e[1]<e[0],c=e[u-0],f=e[1-u],h=Math.floor((f-c)/(t.length-n+2*l));a=s(c+Math.round((f-c-(t.length-n)*h)/2),h);if(u)a.reverse();i=Math.round(h*(1-n));r={t:"rangeRoundBands",a:arguments};return o};o.rangeBand=function(){return i};o.rangeExtent=function(){return os(r.a[0])};o.copy=function(){return Ss(t,r)};return o.domain(t)}e.scale.category10=function(){return e.scale.ordinal().range(Es)};e.scale.category20=function(){return e.scale.ordinal().range(Cs)};e.scale.category20b=function(){return e.scale.ordinal().range(Ls)};e.scale.category20c=function(){return e.scale.ordinal().range(Is)};var Es=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ve);var Cs=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ve);var Ls=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ve);var Is=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ve);e.scale.quantile=function(){return zs([],[])};function zs(t,r){var n;function a(){var a=0,o=r.length;n=[];while(++a<o)n[a-1]=e.quantile(t,a/o);return i}function i(t){if(!isNaN(t=+t))return r[e.bisect(n,t)]}i.domain=function(e){if(!arguments.length)return t;t=e.map(d).filter(v).sort(p);return a()};i.range=function(t){if(!arguments.length)return r;r=t;return a()};i.quantiles=function(){return n};i.invertExtent=function(e){e=r.indexOf(e);return e<0?[NaN,NaN]:[e>0?n[e-1]:t[0],e<n.length?n[e]:t[t.length-1]]};i.copy=function(){return zs(t,r)};return a()}e.scale.quantize=function(){return Ps(0,1,[0,1])};function Ps(t,e,r){var n,a;function i(e){return r[Math.max(0,Math.min(a,Math.floor(n*(e-t))))]}function o(){n=r.length/(e-t);a=r.length-1;return i}i.domain=function(r){if(!arguments.length)return[t,e];t=+r[0];e=+r[r.length-1];return o()};i.range=function(t){if(!arguments.length)return r;r=t;return o()};i.invertExtent=function(e){e=r.indexOf(e);e=e<0?NaN:e/n+t;return[e,e+1/n]};i.copy=function(){return Ps(t,e,r)};return o()}e.scale.threshold=function(){return Os([.5],[0,1])};function Os(t,r){function n(n){if(n<=n)return r[e.bisect(t,n)]}n.domain=function(e){if(!arguments.length)return t;t=e;return n};n.range=function(t){if(!arguments.length)return r;r=t;return n};n.invertExtent=function(e){e=r.indexOf(e);return[t[e-1],t[e]]};n.copy=function(){return Os(t,r)};return n}e.scale.identity=function(){return Ds([0,1])};function Ds(t){function e(t){return+t}e.invert=e;e.domain=e.range=function(r){if(!arguments.length)return t;t=r.map(e);return e};e.ticks=function(e){return ms(t,e)};e.tickFormat=function(e,r){return ys(t,e,r)};e.copy=function(){return Ds(t)};return e}e.svg={};function Rs(){return 0}e.svg.arc=function(){var t=Fs,e=Ns,r=Rs,n=Bs,a=js,i=Vs,o=Us;function s(){var s=Math.max(0,+t.apply(this,arguments)),u=Math.max(0,+e.apply(this,arguments)),c=a.apply(this,arguments)-zt,f=i.apply(this,arguments)-zt,h=Math.abs(f-c),p=c>f?0:1;if(u<s)d=u,u=s,s=d;if(h>=It)return l(u,p)+(s?l(s,1-p):"")+"Z";var d,v,g,m,y=0,x=0,b,_,w,k,M,A,T,S,E=[];if(m=(+o.apply(this,arguments)||0)/2){g=n===Bs?Math.sqrt(s*s+u*u):+n.apply(this,arguments);if(!p)x*=-1;if(u)x=Ft(g/u*Math.sin(m));if(s)y=Ft(g/s*Math.sin(m))}if(u){b=u*Math.cos(c+x);_=u*Math.sin(c+x);w=u*Math.cos(f-x);k=u*Math.sin(f-x);var C=Math.abs(f-c-2*x)<=Ct?0:1;if(x&&qs(b,_,w,k)===p^C){var L=(c+f)/2;b=u*Math.cos(L);_=u*Math.sin(L);w=k=null}}else{b=_=0}if(s){M=s*Math.cos(f-y);A=s*Math.sin(f-y);T=s*Math.cos(c+y);S=s*Math.sin(c+y);var I=Math.abs(c-f+2*y)<=Ct?0:1;if(y&&qs(M,A,T,S)===1-p^I){var z=(c+f)/2;M=s*Math.cos(z);A=s*Math.sin(z);T=S=null}}else{M=A=0}if(h>St&&(d=Math.min(Math.abs(u-s)/2,+r.apply(this,arguments)))>.001){v=s<u^p?0:1;var P=d,O=d;if(h<Ct){var D=T==null?[M,A]:w==null?[b,_]:La([b,_],[T,S],[w,k],[M,A]),R=b-D[0],B=_-D[1],F=w-D[0],N=k-D[1],j=1/Math.sin(Math.acos((R*F+B*N)/(Math.sqrt(R*R+B*B)*Math.sqrt(F*F+N*N)))/2),V=Math.sqrt(D[0]*D[0]+D[1]*D[1]);O=Math.min(d,(s-V)/(j-1));P=Math.min(d,(u-V)/(j+1))}if(w!=null){var U=Hs(T==null?[M,A]:[T,S],[b,_],u,P,p),q=Hs([w,k],[M,A],u,P,p);if(d===P){E.push("M",U[0],"A",P,",",P," 0 0,",v," ",U[1],"A",u,",",u," 0 ",1-p^qs(U[1][0],U[1][1],q[1][0],q[1][1]),",",p," ",q[1],"A",P,",",P," 0 0,",v," ",q[0])}else{E.push("M",U[0],"A",P,",",P," 0 1,",v," ",q[0])}}else{E.push("M",b,",",_)}if(T!=null){var H=Hs([b,_],[T,S],s,-O,p),G=Hs([M,A],w==null?[b,_]:[w,k],s,-O,p);if(d===O){E.push("L",G[0],"A",O,",",O," 0 0,",v," ",G[1],"A",s,",",s," 0 ",p^qs(G[1][0],G[1][1],H[1][0],H[1][1]),",",1-p," ",H[1],"A",O,",",O," 0 0,",v," ",H[0])}else{E.push("L",G[0],"A",O,",",O," 0 0,",v," ",H[0])}}else{E.push("L",M,",",A)}}else{E.push("M",b,",",_);if(w!=null)E.push("A",u,",",u," 0 ",C,",",p," ",w,",",k);E.push("L",M,",",A);if(T!=null)E.push("A",s,",",s," 0 ",I,",",1-p," ",T,",",S)}E.push("Z");return E.join("")}function l(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}s.innerRadius=function(e){if(!arguments.length)return t;t=Me(e);return s};s.outerRadius=function(t){if(!arguments.length)return e;e=Me(t);return s};s.cornerRadius=function(t){if(!arguments.length)return r;r=Me(t);return s};s.padRadius=function(t){if(!arguments.length)return n;n=t==Bs?Bs:Me(t);return s};s.startAngle=function(t){if(!arguments.length)return a;a=Me(t);return s};s.endAngle=function(t){if(!arguments.length)return i;i=Me(t);return s};s.padAngle=function(t){if(!arguments.length)return o;o=Me(t);return s};s.centroid=function(){var r=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,n=(+a.apply(this,arguments)+ +i.apply(this,arguments))/2-zt;return[Math.cos(n)*r,Math.sin(n)*r]};return s};var Bs="auto";function Fs(t){return t.innerRadius}function Ns(t){return t.outerRadius}function js(t){return t.startAngle}function Vs(t){return t.endAngle}function Us(t){return t&&t.padAngle}function qs(t,e,r,n){return(t-r)*e-(e-n)*t>0?0:1}function Hs(t,e,r,n,a){var i=t[0]-e[0],o=t[1]-e[1],s=(a?n:-n)/Math.sqrt(i*i+o*o),l=s*o,u=-s*i,c=t[0]+l,f=t[1]+u,h=e[0]+l,p=e[1]+u,d=(c+h)/2,v=(f+p)/2,g=h-c,m=p-f,y=g*g+m*m,x=r-n,b=c*p-h*f,_=(m<0?-1:1)*Math.sqrt(Math.max(0,x*x*y-b*b)),w=(b*m-g*_)/y,k=(-b*g-m*_)/y,M=(b*m+g*_)/y,A=(-b*g+m*_)/y,T=w-d,S=k-v,E=M-d,C=A-v;if(T*T+S*S>E*E+C*C)w=M,k=A;return[[w-l,k-u],[w*r/x,k*r/x]]}function Gs(t){var e=Ma,r=Aa,n=sn,a=Ys,i=a.key,o=.7;function s(i){var s=[],l=[],u=-1,c=i.length,f,h=Me(e),p=Me(r);function d(){s.push("M",a(t(l),o))}while(++u<c){if(n.call(this,f=i[u],u)){l.push([+h.call(this,f,u),+p.call(this,f,u)])}else if(l.length){d();l=[]}}if(l.length)d();return s.length?s.join(""):null}s.x=function(t){if(!arguments.length)return e;e=t;return s};s.y=function(t){if(!arguments.length)return r;r=t;return s};s.defined=function(t){if(!arguments.length)return n;n=t;return s};s.interpolate=function(t){if(!arguments.length)return i;if(typeof t==="function")i=a=t;else i=(a=Ws.get(t)||Ys).key;return s};s.tension=function(t){if(!arguments.length)return o;o=t;return s};return s}e.svg.line=function(){return Gs(P)};var Ws=e.map({linear:Ys,"linear-closed":Xs,step:Zs,"step-before":$s,"step-after":Js,basis:nl,"basis-open":al,"basis-closed":il,bundle:ol,cardinal:tl,"cardinal-open":Ks,"cardinal-closed":Qs,monotone:vl});Ws.forEach(function(t,e){e.key=t;e.closed=/-closed$/.test(t)});function Ys(t){return t.length>1?t.join("L"):t+"Z"}function Xs(t){return t.join("L")+"Z"}function Zs(t){var e=0,r=t.length,n=t[0],a=[n[0],",",n[1]];while(++e<r)a.push("H",(n[0]+(n=t[e])[0])/2,"V",n[1]);if(r>1)a.push("H",n[0]);return a.join("")}function $s(t){var e=0,r=t.length,n=t[0],a=[n[0],",",n[1]];while(++e<r)a.push("V",(n=t[e])[1],"H",n[0]);return a.join("")}function Js(t){var e=0,r=t.length,n=t[0],a=[n[0],",",n[1]];while(++e<r)a.push("H",(n=t[e])[0],"V",n[1]);return a.join("")}function Ks(t,e){return t.length<4?Ys(t):t[1]+el(t.slice(1,-1),rl(t,e))}function Qs(t,e){return t.length<3?Xs(t):t[0]+el((t.push(t[0]),t),rl([t[t.length-2]].concat(t,[t[1]]),e))}function tl(t,e){return t.length<3?Ys(t):t[0]+el(t,rl(t,e))}function el(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2){return Ys(t)}var r=t.length!=e.length,n="",a=t[0],i=t[1],o=e[0],s=o,l=1;if(r){n+="Q"+(i[0]-o[0]*2/3)+","+(i[1]-o[1]*2/3)+","+i[0]+","+i[1];a=t[1];l=2}if(e.length>1){s=e[1];i=t[l];l++;n+="C"+(a[0]+o[0])+","+(a[1]+o[1])+","+(i[0]-s[0])+","+(i[1]-s[1])+","+i[0]+","+i[1];for(var u=2;u<e.length;u++,l++){i=t[l];s=e[u];n+="S"+(i[0]-s[0])+","+(i[1]-s[1])+","+i[0]+","+i[1]}}if(r){var c=t[l];n+="Q"+(i[0]+s[0]*2/3)+","+(i[1]+s[1]*2/3)+","+c[0]+","+c[1]}return n}function rl(t,e){var r=[],n=(1-e)/2,a,i=t[0],o=t[1],s=1,l=t.length;while(++s<l){a=i;i=o;o=t[s];r.push([n*(o[0]-a[0]),n*(o[1]-a[1])])}return r}function nl(t){if(t.length<3)return Ys(t);var e=1,r=t.length,n=t[0],a=n[0],i=n[1],o=[a,a,a,(n=t[1])[0]],s=[i,i,i,n[1]],l=[a,",",i,"L",sl(cl,o),",",sl(cl,s)];t.push(t[r-1]);while(++e<=r){n=t[e];o.shift();o.push(n[0]);s.shift();s.push(n[1]);fl(l,o,s)}t.pop();l.push("L",n);return l.join("")}function al(t){if(t.length<4)return Ys(t);var e=[],r=-1,n=t.length,a,i=[0],o=[0];while(++r<3){a=t[r];i.push(a[0]);o.push(a[1])}e.push(sl(cl,i)+","+sl(cl,o));--r;while(++r<n){a=t[r];i.shift();i.push(a[0]);o.shift();o.push(a[1]);fl(e,i,o)}return e.join("")}function il(t){var e,r=-1,n=t.length,a=n+4,i,o=[],s=[];while(++r<4){i=t[r%n];o.push(i[0]);s.push(i[1])}e=[sl(cl,o),",",sl(cl,s)];--r;while(++r<a){i=t[r%n];o.shift();o.push(i[0]);s.shift();s.push(i[1]);fl(e,o,s)}return e.join("")}function ol(t,e){var r=t.length-1;if(r){var n=t[0][0],a=t[0][1],i=t[r][0]-n,o=t[r][1]-a,s=-1,l,u;while(++s<=r){l=t[s];u=s/r;l[0]=e*l[0]+(1-e)*(n+u*i);l[1]=e*l[1]+(1-e)*(a+u*o)}}return nl(t)}function sl(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}var ll=[0,2/3,1/3,0],ul=[0,1/3,2/3,0],cl=[0,1/6,2/3,1/6];function fl(t,e,r){t.push("C",sl(ll,e),",",sl(ll,r),",",sl(ul,e),",",sl(ul,r),",",sl(cl,e),",",sl(cl,r))}function hl(t,e){return(e[1]-t[1])/(e[0]-t[0])}function pl(t){var e=0,r=t.length-1,n=[],a=t[0],i=t[1],o=n[0]=hl(a,i);while(++e<r){n[e]=(o+(o=hl(a=i,i=t[e+1])))/2}n[e]=o;return n}function dl(t){var e=[],r,n,a,i,o=pl(t),s=-1,l=t.length-1;while(++s<l){r=hl(t[s],t[s+1]);if(x(r)<St){o[s]=o[s+1]=0}else{n=o[s]/r;a=o[s+1]/r;i=n*n+a*a;if(i>9){i=r*3/Math.sqrt(i);o[s]=i*n;o[s+1]=i*a}}}s=-1;while(++s<=l){i=(t[Math.min(l,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+o[s]*o[s]));e.push([i||0,o[s]*i||0])}return e}function vl(t){return t.length<3?Ys(t):t[0]+el(t,dl(t))}e.svg.line.radial=function(){var t=Gs(gl);t.radius=t.x,delete t.x;t.angle=t.y,delete t.y;return t};function gl(t){var e,r=-1,n=t.length,a,i;while(++r<n){e=t[r];a=e[0];i=e[1]-zt;e[0]=a*Math.cos(i);e[1]=a*Math.sin(i)}return t}function ml(t){var e=Ma,r=Ma,n=0,a=Aa,i=sn,o=Ys,s=o.key,l=o,u="L",c=.7;function f(s){var f=[],h=[],p=[],d=-1,v=s.length,g,m=Me(e),y=Me(n),x=e===r?function(){return _}:Me(r),b=n===a?function(){return w}:Me(a),_,w;function k(){f.push("M",o(t(p),c),u,l(t(h.reverse()),c),"Z")}while(++d<v){if(i.call(this,g=s[d],d)){h.push([_=+m.call(this,g,d),w=+y.call(this,g,d)]);p.push([+x.call(this,g,d),+b.call(this,g,d)])}else if(h.length){k();h=[];p=[]}}if(h.length)k();return f.length?f.join(""):null}f.x=function(t){if(!arguments.length)return r;e=r=t;return f};f.x0=function(t){if(!arguments.length)return e;e=t;return f};f.x1=function(t){if(!arguments.length)return r;r=t;return f};f.y=function(t){if(!arguments.length)return a;n=a=t;return f};f.y0=function(t){if(!arguments.length)return n;n=t;return f};f.y1=function(t){if(!arguments.length)return a;a=t;return f};f.defined=function(t){if(!arguments.length)return i;i=t;return f};f.interpolate=function(t){if(!arguments.length)return s;if(typeof t==="function")s=o=t;else s=(o=Ws.get(t)||Ys).key;l=o.reverse||o;u=o.closed?"M":"L";return f};f.tension=function(t){if(!arguments.length)return c;c=t;return f};return f}$s.reverse=Js;Js.reverse=$s;e.svg.area=function(){return ml(P)};e.svg.area.radial=function(){var t=ml(gl);t.radius=t.x,delete t.x;t.innerRadius=t.x0,delete t.x0;t.outerRadius=t.x1,delete t.x1;t.angle=t.y,delete t.y;t.startAngle=t.y0,delete t.y0;t.endAngle=t.y1,delete t.y1;return t};e.svg.chord=function(){var t=sa,e=la,r=yl,n=js,a=Vs;function i(r,n){var a=o(this,t,r,n),i=o(this,e,r,n);return"M"+a.p0+l(a.r,a.p1,a.a1-a.a0)+(s(a,i)?u(a.r,a.p1,a.r,a.p0):u(a.r,a.p1,i.r,i.p0)+l(i.r,i.p1,i.a1-i.a0)+u(i.r,i.p1,a.r,a.p0))+"Z"}function o(t,e,i,o){var s=e.call(t,i,o),l=r.call(t,s,o),u=n.call(t,s,o)-zt,c=a.call(t,s,o)-zt;return{r:l,a0:u,a1:c,p0:[l*Math.cos(u),l*Math.sin(u)],p1:[l*Math.cos(c),l*Math.sin(c)]}}function s(t,e){return t.a0==e.a0&&t.a1==e.a1}function l(t,e,r){return"A"+t+","+t+" 0 "+ +(r>Ct)+",1 "+e}function u(t,e,r,n){return"Q 0,0 "+n}i.radius=function(t){if(!arguments.length)return r;r=Me(t);return i};i.source=function(e){if(!arguments.length)return t;t=Me(e);return i};i.target=function(t){if(!arguments.length)return e;e=Me(t);return i};i.startAngle=function(t){if(!arguments.length)return n;n=Me(t);return i};i.endAngle=function(t){if(!arguments.length)return a;a=Me(t);return i};return i};function yl(t){return t.radius}e.svg.diagonal=function(){var t=sa,e=la,r=xl;function n(n,a){var i=t.call(this,n,a),o=e.call(this,n,a),s=(i.y+o.y)/2,l=[i,{x:i.x,y:s},{x:o.x,y:s},o];l=l.map(r);return"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}n.source=function(e){if(!arguments.length)return t;t=Me(e);return n};n.target=function(t){if(!arguments.length)return e;e=Me(t);return n};n.projection=function(t){if(!arguments.length)return r;r=t;return n};return n};function xl(t){return[t.x,t.y]}e.svg.diagonal.radial=function(){var t=e.svg.diagonal(),r=xl,n=t.projection;t.projection=function(t){return arguments.length?n(bl(r=t)):r};return t};function bl(t){return function(){var e=t.apply(this,arguments),r=e[0],n=e[1]-zt;return[r*Math.cos(n),r*Math.sin(n)]}}e.svg.symbol=function(){var t=wl,e=_l;function r(r,n){return(Ml.get(t.call(this,r,n))||kl)(e.call(this,r,n))}r.type=function(e){if(!arguments.length)return t;t=Me(e);return r};r.size=function(t){if(!arguments.length)return e;e=Me(t);return r};return r};function _l(){return 64}function wl(){return"circle"}function kl(t){var e=Math.sqrt(t/Ct);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}var Ml=e.map({circle:kl,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Tl)),r=e*Tl;return"M0,"+-e+"L"+r+",0"+" 0,"+e+" "+-r+",0"+"Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Al),r=e*Al/2;return"M0,"+r+"L"+e+","+-r+" "+-e+","+-r+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Al),r=e*Al/2;return"M0,"+-r+"L"+e+","+r+" "+-e+","+r+"Z"}});e.svg.symbolTypes=Ml.keys();var Al=Math.sqrt(3),Tl=Math.tan(30*Pt);Z.transition=function(t){var e=zl||++Il,r=Rl(t),n=[],a,i,o=Pl||{time:Date.now(),ease:Di,delay:0,duration:250};for(var s=-1,l=this.length;++s<l;){n.push(a=[]);for(var u=this[s],c=-1,f=u.length;++c<f;){if(i=u[c])Bl(i,c,r,e,o);a.push(i)}}return Cl(n,r,e)};Z.interrupt=function(t){return this.each(t==null?Sl:El(Rl(t)))};var Sl=El(Rl());function El(t){return function(){var e,r,n;if((e=this[t])&&(n=e[r=e.active])){n.timer.c=null;n.timer.t=NaN;if(--e.count)delete e[r];else delete this[t];e.active+=.5;n.event&&n.event.interrupt.call(this,this.__data__,n.index)}}}function Cl(t,e,r){H(t,Ll);t.namespace=e;t.id=r;return t}var Ll=[],Il=0,zl,Pl;Ll.call=Z.call;Ll.empty=Z.empty;Ll.node=Z.node;Ll.size=Z.size;e.transition=function(t,r){return t&&t.transition?zl?t.transition(r):t:e.selection().transition(t)};e.transition.prototype=Ll;Ll.select=function(t){var e=this.id,r=this.namespace,n=[],a,i,o;t=$(t);for(var s=-1,l=this.length;++s<l;){n.push(a=[]);for(var u=this[s],c=-1,f=u.length;++c<f;){if((o=u[c])&&(i=t.call(o,o.__data__,c,s))){if("__data__"in o)i.__data__=o.__data__;Bl(i,c,r,e,o[r][e]);a.push(i)}else{a.push(null)}}}return Cl(n,r,e)};Ll.selectAll=function(t){var e=this.id,r=this.namespace,n=[],a,i,o,s,l;t=J(t);for(var u=-1,c=this.length;++u<c;){for(var f=this[u],h=-1,p=f.length;++h<p;){if(o=f[h]){l=o[r][e];i=t.call(o,o.__data__,h,u);n.push(a=[]);for(var d=-1,v=i.length;++d<v;){if(s=i[d])Bl(s,d,r,e,l);a.push(s)}}}}return Cl(n,r,e)};Ll.filter=function(t){var e=[],r,n,a;if(typeof t!=="function")t=ft(t);for(var i=0,o=this.length;i<o;i++){e.push(r=[]);for(var n=this[i],s=0,l=n.length;s<l;s++){if((a=n[s])&&t.call(a,a.__data__,s,i)){r.push(a)}}}return Cl(e,this.namespace,this.id)};Ll.tween=function(t,e){var r=this.id,n=this.namespace;if(arguments.length<2)return this.node()[n][r].tween.get(t);return pt(this,e==null?function(e){e[n][r].tween.remove(t)}:function(a){a[n][r].tween.set(t,e)})};function Ol(t,e,r,n){var a=t.id,i=t.namespace;return pt(t,typeof r==="function"?function(t,o,s){t[i][a].tween.set(e,n(r.call(t,t.__data__,o,s)))}:(r=n(r),function(t){t[i][a].tween.set(e,r)}))}Ll.attr=function(t,r){if(arguments.length<2){for(r in t)this.attr(r,t[r]);return this}var n=t=="transform"?no:Ai,a=e.ns.qualify(t);function i(){this.removeAttribute(a)}function o(){this.removeAttributeNS(a.space,a.local)}function s(t){return t==null?i:(t+="",function(){var e=this.getAttribute(a),r;return e!==t&&(r=n(e,t),function(t){this.setAttribute(a,r(t))})})}function l(t){return t==null?o:(t+="",function(){var e=this.getAttributeNS(a.space,a.local),r;return e!==t&&(r=n(e,t),function(t){this.setAttributeNS(a.space,a.local,r(t))})})}return Ol(this,"attr."+t,r,a.local?l:s)};Ll.attrTween=function(t,r){var n=e.ns.qualify(t);function a(t,e){var a=r.call(this,t,e,this.getAttribute(n));return a&&function(t){this.setAttribute(n,a(t))}}function i(t,e){var a=r.call(this,t,e,this.getAttributeNS(n.space,n.local));return a&&function(t){this.setAttributeNS(n.space,n.local,a(t))}}return this.tween("attr."+t,n.local?i:a)};Ll.style=function(t,e,r){var n=arguments.length;if(n<3){if(typeof t!=="string"){if(n<2)e="";for(r in t)this.style(r,t[r],e);return this}r=""}function a(){this.style.removeProperty(t)}function i(e){return e==null?a:(e+="",function(){var n=s(this).getComputedStyle(this,null).getPropertyValue(t),a;return n!==e&&(a=Ai(n,e),function(e){this.style.setProperty(t,a(e),r)})})}return Ol(this,"style."+t,e,i)};Ll.styleTween=function(t,e,r){if(arguments.length<3)r="";function n(n,a){var i=e.call(this,n,a,s(this).getComputedStyle(this,null).getPropertyValue(t));return i&&function(e){this.style.setProperty(t,i(e),r)}}return this.tween("style."+t,n)};Ll.text=function(t){return Ol(this,"text",t,Dl)};function Dl(t){if(t==null)t="";return function(){this.textContent=t}}Ll.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;if(this[t].count<2&&(e=this.parentNode))e.removeChild(this)})};Ll.ease=function(t){var r=this.id,n=this.namespace;if(arguments.length<1)return this.node()[n][r].ease;if(typeof t!=="function")t=e.ease.apply(e,arguments);return pt(this,function(e){e[n][r].ease=t})};Ll.delay=function(t){var e=this.id,r=this.namespace;if(arguments.length<1)return this.node()[r][e].delay;return pt(this,typeof t==="function"?function(n,a,i){n[r][e].delay=+t.call(n,n.__data__,a,i)}:(t=+t,function(n){n[r][e].delay=t}))};Ll.duration=function(t){var e=this.id,r=this.namespace;if(arguments.length<1)return this.node()[r][e].duration;return pt(this,typeof t==="function"?function(n,a,i){n[r][e].duration=Math.max(1,t.call(n,n.__data__,a,i))}:(t=Math.max(1,t),function(n){n[r][e].duration=t}))};Ll.each=function(t,r){var n=this.id,a=this.namespace;if(arguments.length<2){var i=Pl,o=zl;try{zl=n;pt(this,function(e,r,i){Pl=e[a][n];t.call(e,e.__data__,r,i)})}finally{Pl=i;zl=o}}else{pt(this,function(i){var o=i[a][n];(o.event||(o.event=e.dispatch("start","end","interrupt"))).on(t,r)})}return this};Ll.transition=function(){var t=this.id,e=++Il,r=this.namespace,n=[],a,i,o,s;for(var l=0,u=this.length;l<u;l++){n.push(a=[]);for(var i=this[l],c=0,f=i.length;c<f;c++){if(o=i[c]){s=o[r][t];Bl(o,c,r,e,{time:s.time,ease:s.ease,delay:s.delay+s.duration,duration:s.duration})}a.push(o)}}return Cl(n,r,e)};function Rl(t){return t==null?"__transition__":"__transition_"+t+"__"}function Bl(t,e,r,n,a){var i=t[r]||(t[r]={active:0,count:0}),o=i[n],s,l,u,c,f;function h(t){var e=o.delay;l.t=e+s;if(e<=t)return p(t-e);l.c=p}function p(r){var a=i.active,h=i[a];if(h){h.timer.c=null;h.timer.t=NaN;--i.count;delete i[a];h.event&&h.event.interrupt.call(t,t.__data__,h.index)}for(var p in i){if(+p<n){var v=i[p];v.timer.c=null;v.timer.t=NaN;--i.count;delete i[p]}}l.c=d;Oe(function(){if(l.c&&d(r||1)){l.c=null;l.t=NaN}return 1},0,s);i.active=n;o.event&&o.event.start.call(t,t.__data__,e);f=[];o.tween.forEach(function(r,n){if(n=n.call(t,t.__data__,e)){f.push(n)}});c=o.ease;u=o.duration}function d(a){var s=a/u,l=c(s),h=f.length;while(h>0){f[--h].call(t,l)}if(s>=1){o.event&&o.event.end.call(t,t.__data__,e);if(--i.count)delete i[n];else delete t[r];return 1}}if(!o){s=a.time;l=Oe(h,0,s);o=i[n]={tween:new w,time:s,timer:l,delay:a.delay,duration:a.duration,ease:a.ease,index:e};a=null;++i.count}}e.svg.axis=function(){var t=e.scale.linear(),r=Fl,n=6,i=6,o=3,s=[10],l=null,u;function c(a){a.each(function(){var a=e.select(this);var c=this.__chart__||t,f=this.__chart__=t.copy();var h=l==null?f.ticks?f.ticks.apply(f,s):f.domain():l,p=u==null?f.tickFormat?f.tickFormat.apply(f,s):P:u,d=a.selectAll(".tick").data(h,f),v=d.enter().insert("g",".domain").attr("class","tick").style("opacity",St),g=e.transition(d.exit()).style("opacity",St).remove(),m=e.transition(d.order()).style("opacity",1),y=Math.max(n,0)+o,x;var b=ss(f),_=a.selectAll(".domain").data([0]),w=(_.enter().append("path").attr("class","domain"),e.transition(_));v.append("line");v.append("text");var k=v.select("line"),M=m.select("line"),A=d.select("text").text(p),T=v.select("text"),S=m.select("text"),E=r==="top"||r==="left"?-1:1,C,L,I,z;if(r==="bottom"||r==="top"){x=jl,C="x",I="y",L="x2",z="y2";A.attr("dy",E<0?"0em":".71em").style("text-anchor","middle");w.attr("d","M"+b[0]+","+E*i+"V0H"+b[1]+"V"+E*i)}else{x=Vl,C="y",I="x",L="y2",z="x2";A.attr("dy",".32em").style("text-anchor",E<0?"end":"start");w.attr("d","M"+E*i+","+b[0]+"H0V"+b[1]+"H"+E*i)}k.attr(z,E*n);T.attr(I,E*y);M.attr(L,0).attr(z,E*n);S.attr(C,0).attr(I,E*y);if(f.rangeBand){var O=f,D=O.rangeBand()/2;c=f=function(t){return O(t)+D}}else if(c.rangeBand){c=f}else{g.call(x,f,c)}v.call(x,c,f);m.call(x,f,f)})}c.scale=function(e){if(!arguments.length)return t;t=e;return c};c.orient=function(t){if(!arguments.length)return r;r=t in Nl?t+"":Fl;return c};c.ticks=function(){if(!arguments.length)return s;s=a(arguments);return c};c.tickValues=function(t){if(!arguments.length)return l;l=t;return c};c.tickFormat=function(t){if(!arguments.length)return u;u=t;return c};c.tickSize=function(t){var e=arguments.length;if(!e)return n;n=+t;i=+arguments[e-1];return c};c.innerTickSize=function(t){if(!arguments.length)return n;n=+t;return c};c.outerTickSize=function(t){if(!arguments.length)return i;i=+t;return c};c.tickPadding=function(t){if(!arguments.length)return o;o=+t;return c};c.tickSubdivide=function(){return arguments.length&&c};return c};var Fl="bottom",Nl={top:1,right:1,bottom:1,left:1};function jl(t,e,r){t.attr("transform",function(t){var n=e(t);return"translate("+(isFinite(n)?n:r(t))+",0)"})}function Vl(t,e,r){t.attr("transform",function(t){var n=e(t);return"translate(0,"+(isFinite(n)?n:r(t))+")"})}e.svg.brush=function(){var t=U(h,"brushstart","brush","brushend"),r=null,n=null,a=[0,0],i=[0,0],o,l,u=true,c=true,f=ql[0];function h(t){t.each(function(){var t=e.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",g).on("touchstart.brush",g);var a=t.selectAll(".background").data([0]);a.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var i=t.selectAll(".resize").data(f,P);i.exit().remove();i.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Ul[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");i.style("display",h.empty()?"none":null);var o=e.transition(t),s=e.transition(a),l;if(r){l=ss(r);s.attr("x",l[0]).attr("width",l[1]-l[0]);d(o)}if(n){l=ss(n);s.attr("y",l[0]).attr("height",l[1]-l[0]);v(o)}p(o)})}h.event=function(r){r.each(function(){var r=t.of(this,arguments),n={x:a,y:i,i:o,j:l},s=this.__chart__||n;this.__chart__=n;if(zl){e.select(this).transition().each("start.brush",function(){o=s.i;l=s.j;a=s.x;i=s.y;r({type:"brushstart"})}).tween("brush:brush",function(){var t=Ti(a,n.x),e=Ti(i,n.y);o=l=null;return function(o){a=n.x=t(o);i=n.y=e(o);r({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=n.i;l=n.j;r({type:"brush",mode:"resize"});r({type:"brushend"})})}else{r({type:"brushstart"});r({type:"brush",mode:"resize"});r({type:"brushend"})}})};function p(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+a[+/e$/.test(t)]+","+i[+/^s/.test(t)]+")"})}function d(t){t.select(".extent").attr("x",a[0]);t.selectAll(".extent,.n>rect,.s>rect").attr("width",a[1]-a[0])}function v(t){t.select(".extent").attr("y",i[0]);t.selectAll(".extent,.e>rect,.w>rect").attr("height",i[1]-i[0])}function g(){var f=this,g=e.select(e.event.target),m=t.of(f,arguments),y=e.select(f),x=g.datum(),b=!/^(n|s)$/.test(x)&&r,_=!/^(e|w)$/.test(x)&&n,w=g.classed("extent"),k=kt(f),M,A=e.mouse(f),T;var S=e.select(s(f)).on("keydown.brush",L).on("keyup.brush",I);if(e.event.changedTouches){S.on("touchmove.brush",z).on("touchend.brush",O)}else{S.on("mousemove.brush",z).on("mouseup.brush",O)}y.interrupt().selectAll("*").interrupt();if(w){A[0]=a[0]-A[0];A[1]=i[0]-A[1]}else if(x){var E=+/w$/.test(x),C=+/^n/.test(x);T=[a[1-E]-A[0],i[1-C]-A[1]];A[0]=a[E];A[1]=i[C]}else if(e.event.altKey)M=A.slice();y.style("pointer-events","none").selectAll(".resize").style("display",null);e.select("body").style("cursor",g.style("cursor"));m({type:"brushstart"});z();function L(){if(e.event.keyCode==32){if(!w){M=null;A[0]-=a[1];A[1]-=i[1];w=2}j()}}function I(){if(e.event.keyCode==32&&w==2){A[0]+=a[1];A[1]+=i[1];w=0;j()}}function z(){var t=e.mouse(f),o=false;if(T){t[0]+=T[0];t[1]+=T[1]}if(!w){if(e.event.altKey){if(!M)M=[(a[0]+a[1])/2,(i[0]+i[1])/2];A[0]=a[+(t[0]<M[0])];A[1]=i[+(t[1]<M[1])]}else M=null}if(b&&P(t,r,0)){d(y);o=true}if(_&&P(t,n,1)){v(y);o=true}if(o){p(y);m({type:"brush",mode:w?"move":"resize"})}}function P(t,e,r){var n=ss(e),s=n[0],f=n[1],h=A[r],p=r?i:a,d=p[1]-p[0],v,g;if(w){s-=h;f-=d+h}v=(r?c:u)?Math.max(s,Math.min(f,t[r])):t[r];if(w){g=(v+=h)+d}else{if(M)h=Math.max(s,Math.min(f,2*M[r]-v));if(h<v){g=v;v=h}else{g=h}}if(p[0]!=v||p[1]!=g){if(r)l=null;else o=null;p[0]=v;p[1]=g;return true}}function O(){z();y.style("pointer-events","all").selectAll(".resize").style("display",h.empty()?"none":null);e.select("body").style("cursor",null);S.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);k();m({type:"brushend"})}}h.x=function(t){if(!arguments.length)return r;r=t;f=ql[!r<<1|!n];return h};h.y=function(t){if(!arguments.length)return n;n=t;f=ql[!r<<1|!n];return h};h.clamp=function(t){if(!arguments.length)return r&&n?[u,c]:r?u:n?c:null;if(r&&n)u=!!t[0],c=!!t[1];else if(r)u=!!t;else if(n)c=!!t;return h};h.extent=function(t){var e,s,u,c,f;if(!arguments.length){if(r){if(o){e=o[0],s=o[1]}else{e=a[0],s=a[1];if(r.invert)e=r.invert(e),s=r.invert(s);if(s<e)f=e,e=s,s=f}}if(n){if(l){u=l[0],c=l[1]}else{u=i[0],c=i[1];if(n.invert)u=n.invert(u),c=n.invert(c);if(c<u)f=u,u=c,c=f}}return r&&n?[[e,u],[s,c]]:r?[e,s]:n&&[u,c]}if(r){e=t[0],s=t[1];if(n)e=e[0],s=s[0];o=[e,s];if(r.invert)e=r(e),s=r(s);if(s<e)f=e,e=s,s=f;if(e!=a[0]||s!=a[1])a=[e,s]}if(n){u=t[0],c=t[1];if(r)u=u[1],c=c[1];l=[u,c];if(n.invert)u=n(u),c=n(c);if(c<u)f=u,u=c,c=f;if(u!=i[0]||c!=i[1])i=[u,c]}return h};h.clear=function(){if(!h.empty()){a=[0,0],i=[0,0];o=l=null}return h};h.empty=function(){return!!r&&a[0]==a[1]||!!n&&i[0]==i[1]};return e.rebind(h,t,"on")};var Ul={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};var ql=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];var Hl=Ge.format=_r.timeFormat;var Gl=Hl.utc;var Wl=Gl("%Y-%m-%dT%H:%M:%S.%LZ");Hl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Yl:Wl;function Yl(t){return t.toISOString()}Yl.parse=function(t){var e=new Date(t);return isNaN(e)?null:e};Yl.toString=Wl.toString;Ge.second=Ze(function(t){return new We(Math.floor(t/1e3)*1e3)},function(t,e){t.setTime(t.getTime()+Math.floor(e)*1e3)},function(t){return t.getSeconds()});Ge.seconds=Ge.second.range;Ge.seconds.utc=Ge.second.utc.range;Ge.minute=Ze(function(t){return new We(Math.floor(t/6e4)*6e4)},function(t,e){t.setTime(t.getTime()+Math.floor(e)*6e4)},function(t){return t.getMinutes()});Ge.minutes=Ge.minute.range;Ge.minutes.utc=Ge.minute.utc.range;Ge.hour=Ze(function(t){var e=t.getTimezoneOffset()/60;return new We((Math.floor(t/36e5-e)+e)*36e5)},function(t,e){t.setTime(t.getTime()+Math.floor(e)*36e5)},function(t){return t.getHours()});Ge.hours=Ge.hour.range;Ge.hours.utc=Ge.hour.utc.range;Ge.month=Ze(function(t){t=Ge.day(t);t.setDate(1);return t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()});Ge.months=Ge.month.range;Ge.months.utc=Ge.month.utc.range;function Xl(t,r,n){function a(e){return t(e)}a.invert=function(e){return Zl(t.invert(e))};a.domain=function(e){if(!arguments.length)return t.domain().map(Zl);t.domain(e);return a};function i(t,n){var a=t[1]-t[0],i=a/n,o=e.bisect($l,i);return o==$l.length?[r.year,gs(t.map(function(t){return t/31536e6}),n)[2]]:!o?[Ql,gs(t,n)[2]]:r[i/$l[o-1]<$l[o]/i?o-1:o]}a.nice=function(t,e){var r=a.domain(),n=os(r),o=t==null?i(n,10):typeof t==="number"&&i(n,t);if(o)t=o[0],e=o[1];function s(r){return!isNaN(r)&&!t.range(r,Zl(+r+1),e).length}return a.domain(us(r,e>1?{floor:function(e){while(s(e=t.floor(e)))e=Zl(e-1);return e},ceil:function(e){while(s(e=t.ceil(e)))e=Zl(+e+1);return e}}:t))};a.ticks=function(t,e){var r=os(a.domain()),n=t==null?i(r,10):typeof t==="number"?i(r,t):!t.range&&[{range:t},e];if(n)t=n[0],e=n[1];return t.range(r[0],Zl(+r[1]+1),e<1?1:e)};a.tickFormat=function(){return n};a.copy=function(){return Xl(t.copy(),r,n)};return ds(a,t)}function Zl(t){return new Date(t)}var $l=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6];var Jl=[[Ge.second,1],[Ge.second,5],[Ge.second,15],[Ge.second,30],[Ge.minute,1],[Ge.minute,5],[Ge.minute,15],[Ge.minute,30],[Ge.hour,1],[Ge.hour,3],[Ge.hour,6],[Ge.hour,12],[Ge.day,1],[Ge.day,2],[Ge.week,1],[Ge.month,1],[Ge.month,3],[Ge.year,1]];var Kl=Hl.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&t.getDate()!=1}],["%b %d",function(t){return t.getDate()!=1}],["%B",function(t){return t.getMonth()}],["%Y",sn]]);var Ql={range:function(t,r,n){return e.range(Math.ceil(t/n)*n,+r,n).map(Zl)},floor:P,ceil:P};Jl.year=Ge.year;Ge.scale=function(){return Xl(e.scale.linear(),Jl,Kl)};var tu=Jl.map(function(t){return[t[0].utc,t[1]]});var eu=Gl.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&t.getUTCDate()!=1}],["%b %d",function(t){return t.getUTCDate()!=1}],["%B",function(t){return t.getUTCMonth()}],["%Y",sn]]);tu.year=Ge.year.utc;Ge.scale.utc=function(){return Xl(e.scale.linear(),tu,eu)};e.text=Ae(function(t){return t.responseText});e.json=function(t,e){return Te(t,"application/json",ru,e)};function ru(t){return JSON.parse(t.responseText)}e.html=function(t,e){return Te(t,"text/html",nu,e)};function nu(t){var e=i.createRange();e.selectNode(i.body);return e.createContextualFragment(t.responseText)}e.xml=Ae(function(t){return t.responseXML});if(typeof t==="function"&&t.amd)this.d3=e,t(e);else if(typeof r==="object"&&r.exports)r.exports=e;else this.d3=e}()},{}],148:[function(t,e,r){e.exports=function(){for(var t=0;t<arguments.length;t++){if(arguments[t]!==undefined)return arguments[t]}}},{}],149:[function(t,e,r){"use strict";var n=t("incremental-convex-hull");var a=t("uniq");e.exports=l;function i(t,e){this.point=t;this.index=e}function o(t,e){var r=t.point;var n=e.point;var a=r.length;for(var i=0;i<a;++i){var o=n[i]-r[i];if(o){return o}}return 0}function s(t,e,r){if(t===1){if(r){return[[-1,0]]}else{return[]}}var n=e.map(function(t,e){return[t[0],e]});n.sort(function(t,e){return t[0]-e[0]});var a=new Array(t-1);for(var i=1;i<t;++i){var o=n[i-1];var s=n[i];a[i-1]=[o[1],s[1]]}if(r){a.push([-1,a[0][1]],[a[t-1][1],-1])}return a}function l(t,e){var r=t.length;if(r===0){return[]}var l=t[0].length;if(l<1){return[]}if(l===1){return s(r,t,e)}var u=new Array(r);var c=1;for(var f=0;f<r;++f){var h=t[f];var p=new Array(l+1);var d=0;for(var v=0;v<l;++v){var g=h[v];p[v]=g;d+=g*g}p[l]=d;u[f]=new i(p,f);c=Math.max(d,c)}a(u,o);r=u.length;var m=new Array(r+l+1);var y=new Array(r+l+1);var x=(l+1)*(l+1)*c;var b=new Array(l+1);for(var f=0;f<=l;++f){b[f]=0}b[l]=x;m[0]=b.slice();y[0]=-1;for(var f=0;f<=l;++f){var p=b.slice();p[f]=1;m[f+1]=p;y[f+1]=-1}for(var f=0;f<r;++f){var _=u[f];m[f+l+1]=_.point;y[f+l+1]=_.index}var w=n(m,false);if(e){w=w.filter(function(t){var e=0;for(var r=0;r<=l;++r){var n=y[t[r]];if(n<0){if(++e>=2){return false}}t[r]=n}return true})}else{w=w.filter(function(t){for(var e=0;e<=l;++e){var r=y[t[e]];if(r<0){return false}t[e]=r}return true})}if(l&1){for(var f=0;f<w.length;++f){var _=w[f];var p=_[0];_[0]=_[1];_[1]=p}}return w}},{"incremental-convex-hull":381,uniq:509}],150:[function(t,e,r){"use strict";e.exports=o;var n=o.canvas=document.createElement("canvas");var a=n.getContext("2d");var i=s([32,126]);o.createPairs=s;o.ascii=i;function o(t,e){if(Array.isArray(t))t=t.join(", ");var r={},n,o=16,l=.05;if(e){if(e.length===2&&typeof e[0]==="number"){n=s(e)}else if(Array.isArray(e)){n=e}else{if(e.o)n=s(e.o);else if(e.pairs)n=e.pairs;if(e.fontSize)o=e.fontSize;if(e.threshold!=null)l=e.threshold}}if(!n)n=i;a.font=o+"px "+t;for(var u=0;u<n.length;u++){var c=n[u];var f=a.measureText(c[0]).width+a.measureText(c[1]).width;var h=a.measureText(c).width;if(Math.abs(f-h)>o*l){var p=(h-f)/o;r[c]=p*1e3}}return r}function s(t){var e=[];for(var r=t[0];r<=t[1];r++){var n=String.fromCharCode(r);for(var a=t[0];a<t[1];a++){var i=String.fromCharCode(a);var o=n+i;e.push(o)}}return e}},{}],151:[function(t,e,r){(function(t){var r=false;if(typeof Float64Array!=="undefined"){var n=new Float64Array(1),a=new Uint32Array(n.buffer);n[0]=1;r=true;if(a[1]===1072693248){e.exports=function t(e){n[0]=e;return[a[0],a[1]]};function i(t,e){a[0]=t;a[1]=e;return n[0]}e.exports.pack=i;function o(t){n[0]=t;return a[0]}e.exports.lo=o;function s(t){n[0]=t;return a[1]}e.exports.hi=s}else if(a[0]===1072693248){e.exports=function t(e){n[0]=e;return[a[1],a[0]]};function l(t,e){a[1]=t;a[0]=e;return n[0]}e.exports.pack=l;function u(t){n[0]=t;return a[1]}e.exports.lo=u;function c(t){n[0]=t;return a[0]}e.exports.hi=c}else{r=false}}if(!r){var f=new t(8);e.exports=function t(e){f.writeDoubleLE(e,0,true);return[f.readUInt32LE(0,true),f.readUInt32LE(4,true)]};function h(t,e){f.writeUInt32LE(t,0,true);f.writeUInt32LE(e,4,true);return f.readDoubleLE(0,true)}e.exports.pack=h;function p(t){f.writeDoubleLE(t,0,true);return f.readUInt32LE(0,true)}e.exports.lo=p;function d(t){f.writeDoubleLE(t,0,true);return f.readUInt32LE(4,true)}e.exports.hi=d}e.exports.sign=function(t){return e.exports.hi(t)>>>31};e.exports.exponent=function(t){var r=e.exports.hi(t);return(r<<1>>>21)-1023};e.exports.fraction=function(t){var r=e.exports.lo(t);var n=e.exports.hi(t);var a=n&(1<<20)-1;if(n&2146435072){a+=1<<20}return[r,a]};e.exports.denormalized=function(t){var r=e.exports.hi(t);return!(r&2146435072)}}).call(this,t("buffer").Buffer)},{buffer:92}],152:[function(t,e,r){var n=t("abs-svg-path");var a=t("normalize-svg-path");var i={M:"moveTo",C:"bezierCurveTo"};e.exports=function(t,e){t.beginPath();a(n(e)).forEach(function(e){var r=e[0];var n=e.slice(1);t[i[r]].apply(t,n)});t.closePath()}},{"abs-svg-path":51,"normalize-svg-path":419}],153:[function(t,e,r){e.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],154:[function(t,e,r){"use strict";function n(t,e,r){var a=t[r]|0;if(a<=0){return[]}var i=new Array(a),o;if(r===t.length-1){for(o=0;o<a;++o){i[o]=e}}else{for(o=0;o<a;++o){i[o]=n(t,e,r+1)}}return i}function a(t,e){var r,n;r=new Array(t);for(n=0;n<t;++n){r[n]=e}return r}function i(t,e){if(typeof e==="undefined"){e=0}switch(typeof t){case"number":if(t>0){return a(t|0,e)}break;case"object":if(typeof t.length==="number"){return n(t,e,0)}break}return[]}e.exports=i},{}],155:[function(t,e,r){"use strict";e.exports=n;e.exports.default=n;function n(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,s=a(t,0,i,r,true),l=[];if(!s)return l;var u,c,h,p,d,v,g;if(n)s=f(t,e,s,r);if(t.length>80*r){u=h=t[0];c=p=t[1];for(var m=r;m<i;m+=r){d=t[m];v=t[m+1];if(d<u)u=d;if(v<c)c=v;if(d>h)h=d;if(v>p)p=v}g=Math.max(h-u,p-c);g=g!==0?1/g:0}o(s,l,r,u,c,g);return l}function a(t,e,r,n,a){var i,o;if(a===I(t,e,r,n)>0){for(i=e;i<r;i+=n)o=E(i,t[i],t[i+1],o)}else{for(i=r-n;i>=e;i-=n)o=E(i,t[i],t[i+1],o)}if(o&&w(o,o.next)){C(o);o=o.next}return o}function i(t,e){if(!t)return t;if(!e)e=t;var r=t,n;do{n=false;if(!r.steiner&&(w(r,r.next)||_(r.prev,r,r.next)===0)){C(r);r=e=r.prev;if(r===r.next)break;n=true}else{r=r.next}}while(n||r!==e);return e}function o(t,e,r,n,a,f,h){if(!t)return;if(!h&&f)v(t,n,a,f);var p=t,d,g;while(t.prev!==t.next){d=t.prev;g=t.next;if(f?l(t,n,a,f):s(t)){e.push(d.i/r);e.push(t.i/r);e.push(g.i/r);C(t);t=g.next;p=g.next;continue}t=g;if(t===p){if(!h){o(i(t),e,r,n,a,f,1)}else if(h===1){t=u(t,e,r);o(t,e,r,n,a,f,2)}else if(h===2){c(t,e,r,n,a,f)}break}}}function s(t){var e=t.prev,r=t,n=t.next;if(_(e,r,n)>=0)return false;var a=t.next.next;while(a!==t.prev){if(x(e.x,e.y,r.x,r.y,n.x,n.y,a.x,a.y)&&_(a.prev,a,a.next)>=0)return false;a=a.next}return true}function l(t,e,r,n){var a=t.prev,i=t,o=t.next;if(_(a,i,o)>=0)return false;var s=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,l=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,u=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,c=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y;var f=m(s,l,e,r,n),h=m(u,c,e,r,n);var p=t.prevZ,d=t.nextZ;while(p&&p.z>=f&&d&&d.z<=h){if(p!==t.prev&&p!==t.next&&x(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&_(p.prev,p,p.next)>=0)return false;p=p.prevZ;if(d!==t.prev&&d!==t.next&&x(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&_(d.prev,d,d.next)>=0)return false;d=d.nextZ}while(p&&p.z>=f){if(p!==t.prev&&p!==t.next&&x(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&_(p.prev,p,p.next)>=0)return false;p=p.prevZ}while(d&&d.z<=h){if(d!==t.prev&&d!==t.next&&x(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&_(d.prev,d,d.next)>=0)return false;d=d.nextZ}return true}function u(t,e,r){var n=t;do{var a=n.prev,i=n.next.next;if(!w(a,i)&&k(a,n,n.next,i)&&A(a,i)&&A(i,a)){e.push(a.i/r);e.push(n.i/r);e.push(i.i/r);C(n);C(n.next);n=t=i}n=n.next}while(n!==t);return n}function c(t,e,r,n,a,s){var l=t;do{var u=l.next.next;while(u!==l.prev){if(l.i!==u.i&&b(l,u)){var c=S(l,u);l=i(l,l.next);c=i(c,c.next);o(l,e,r,n,a,s);o(c,e,r,n,a,s);return}u=u.next}l=l.next}while(l!==t)}function f(t,e,r,n){var o=[],s,l,u,c,f;for(s=0,l=e.length;s<l;s++){u=e[s]*n;c=s<l-1?e[s+1]*n:t.length;f=a(t,u,c,n,false);if(f===f.next)f.steiner=true;o.push(y(f))}o.sort(h);for(s=0;s<o.length;s++){p(o[s],r);r=i(r,r.next)}return r}function h(t,e){return t.x-e.x}function p(t,e){e=d(t,e);if(e){var r=S(e,t);i(r,r.next)}}function d(t,e){var r=e,n=t.x,a=t.y,i=-Infinity,o;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>i){i=s;if(s===n){if(a===r.y)return r;if(a===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!o)return null;if(n===i)return o.prev;var l=o,u=o.x,c=o.y,f=Infinity,h;r=o.next;while(r!==l){if(n>=r.x&&r.x>=u&&n!==r.x&&x(a<c?n:i,a,u,c,a<c?i:n,a,r.x,r.y)){h=Math.abs(a-r.y)/(n-r.x);if((h<f||h===f&&r.x>o.x)&&A(r,t)){o=r;f=h}}r=r.next}return o}function v(t,e,r,n){var a=t;do{if(a.z===null)a.z=m(a.x,a.y,e,r,n);a.prevZ=a.prev;a.nextZ=a.next;a=a.next}while(a!==t);a.prevZ.nextZ=null;a.prevZ=null;g(a)}function g(t){var e,r,n,a,i,o,s,l,u=1;do{r=t;t=null;i=null;o=0;while(r){o++;n=r;s=0;for(e=0;e<u;e++){s++;n=n.nextZ;if(!n)break}l=u;while(s>0||l>0&&n){if(s!==0&&(l===0||!n||r.z<=n.z)){a=r;r=r.nextZ;s--}else{a=n;n=n.nextZ;l--}if(i)i.nextZ=a;else t=a;a.prevZ=i;i=a}r=n}i.nextZ=null;u*=2}while(o>1);return t}function m(t,e,r,n,a){t=32767*(t-r)*a;e=32767*(e-n)*a;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;return t|e<<1}function y(t){var e=t,r=t;do{if(e.x<r.x)r=e;e=e.next}while(e!==t);return r}function x(t,e,r,n,a,i,o,s){return(a-o)*(e-s)-(t-o)*(i-s)>=0&&(t-o)*(n-s)-(r-o)*(e-s)>=0&&(r-o)*(i-s)-(a-o)*(n-s)>=0}function b(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!M(t,e)&&A(t,e)&&A(e,t)&&T(t,e)}function _(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function w(t,e){return t.x===e.x&&t.y===e.y}function k(t,e,r,n){if(w(t,e)&&w(r,n)||w(t,n)&&w(r,e))return true;return _(t,e,r)>0!==_(t,e,n)>0&&_(r,n,t)>0!==_(r,n,e)>0}function M(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&k(r,r.next,t,e))return true;r=r.next}while(r!==t);return false}function A(t,e){return _(t.prev,t,t.next)<0?_(t,e,t.next)>=0&&_(t,t.prev,e)>=0:_(t,e,t.prev)<0||_(t,t.next,e)<0}function T(t,e){var r=t,n=false,a=(t.x+e.x)/2,i=(t.y+e.y)/2;do{if(r.y>i!==r.next.y>i&&r.next.y!==r.y&&a<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x)n=!n;r=r.next}while(r!==t);return n}function S(t,e){var r=new L(t.i,t.x,t.y),n=new L(e.i,e.x,e.y),a=t.next,i=e.prev;t.next=e;e.prev=t;r.next=a;a.prev=r;n.next=r;r.prev=n;i.next=n;n.prev=i;return n}function E(t,e,r,n){var a=new L(t,e,r);if(!n){a.prev=a;a.next=a}else{a.next=n.next;a.prev=n;n.next.prev=a;n.next=a}return a}function C(t){t.next.prev=t.prev;t.prev.next=t.next;if(t.prevZ)t.prevZ.nextZ=t.nextZ;if(t.nextZ)t.nextZ.prevZ=t.prevZ}function L(t,e,r){this.i=t;this.x=e;this.y=r;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}n.deviation=function(t,e,r,n){var a=e&&e.length;var i=a?e[0]*r:t.length;var o=Math.abs(I(t,0,i,r));if(a){for(var s=0,l=e.length;s<l;s++){var u=e[s]*r;var c=s<l-1?e[s+1]*r:t.length;o-=Math.abs(I(t,u,c,r))}}var f=0;for(s=0;s<n.length;s+=3){var h=n[s]*r;var p=n[s+1]*r;var d=n[s+2]*r;f+=Math.abs((t[h]-t[d])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[d+1]-t[h+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function I(t,e,r,n){var a=0;for(var i=e,o=r-n;i<r;i+=n){a+=(t[o]-t[i])*(t[i+1]+t[o+1]);o=i}return a}n.flatten=function(t){var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0;for(var a=0;a<t.length;a++){for(var i=0;i<t[a].length;i++){for(var o=0;o<e;o++)r.vertices.push(t[a][i][o])}if(a>0){n+=t[a-1].length;r.holes.push(n)}}return r}},{}],156:[function(t,e,r){"use strict";e.exports=a;var n=t("uniq");function a(t,e){var r=t.length;if(typeof e!=="number"){e=0;for(var a=0;a<r;++a){var i=t[a];e=Math.max(e,i[0],i[1])}e=(e|0)+1}e=e|0;var o=new Array(e);for(var a=0;a<e;++a){o[a]=[]}for(var a=0;a<r;++a){var i=t[a];o[i[0]].push(i[1]);o[i[1]].push(i[0])}for(var s=0;s<e;++s){n(o[s],function(t,e){return t-e})}return o}},{uniq:509}],157:[function(t,e,r){"use strict";var n=t("../../object/valid-value");e.exports=function(){n(this).length=0;return this}},{"../../object/valid-value":189}],158:[function(t,e,r){"use strict";e.exports=t("./is-implemented")()?Array.from:t("./shim")},{"./is-implemented":159,"./shim":160}],159:[function(t,e,r){"use strict";e.exports=function(){var t=Array.from,e,r;if(typeof t!=="function")return false;e=["raz","dwa"];r=t(e);return Boolean(r&&r!==e&&r[1]==="dwa")}},{}],160:[function(t,e,r){"use strict";var n=t("es6-symbol").iterator,a=t("../../function/is-arguments"),i=t("../../function/is-function"),o=t("../../number/to-pos-integer"),s=t("../../object/valid-callable"),l=t("../../object/valid-value"),u=t("../../object/is-value"),c=t("../../string/is-string"),f=Array.isArray,h=Function.prototype.call,p={configurable:true,enumerable:true,writable:true,value:null},d=Object.defineProperty;e.exports=function(t){var e=arguments[1],r=arguments[2],v,g,m,y,x,b,_,w,k,M;t=Object(l(t));if(u(e))s(e);if(!this||this===Array||!i(this)){if(!e){if(a(t)){x=t.length;if(x!==1)return Array.apply(null,t);y=new Array(1);y[0]=t[0];return y}if(f(t)){y=new Array(x=t.length);for(g=0;g<x;++g)y[g]=t[g];return y}}y=[]}else{v=this}if(!f(t)){if((k=t[n])!==undefined){_=s(k).call(t);if(v)y=new v;w=_.next();g=0;while(!w.done){M=e?h.call(e,r,w.value,g):w.value;if(v){p.value=M;d(y,g,p)}else{y[g]=M}w=_.next();++g}x=g}else if(c(t)){x=t.length;if(v)y=new v;for(g=0,m=0;g<x;++g){M=t[g];if(g+1<x){b=M.charCodeAt(0);if(b>=55296&&b<=56319)M+=t[++g]}M=e?h.call(e,r,M,m):M;if(v){p.value=M;d(y,m,p)}else{y[m]=M}++m}x=m}}if(x===undefined){x=o(t.length);if(v)y=new v(x);for(g=0;g<x;++g){M=e?h.call(e,r,t[g],g):t[g];if(v){p.value=M;d(y,g,p)}else{y[g]=M}}}if(v){p.value=null;y.length=x}return y}},{"../../function/is-arguments":161,"../../function/is-function":162,"../../number/to-pos-integer":168,"../../object/is-value":178,"../../object/valid-callable":187,"../../object/valid-value":189,"../../string/is-string":193,"es6-symbol":203}],161:[function(t,e,r){"use strict";var n=Object.prototype.toString,a=n.call(function(){return arguments}());e.exports=function(t){return n.call(t)===a}},{}],162:[function(t,e,r){"use strict";var n=Object.prototype.toString,a=n.call(t("./noop"));e.exports=function(t){return typeof t==="function"&&n.call(t)===a}},{"./noop":163}],163:[function(t,e,r){"use strict";e.exports=function(){}},{}],164:[function(t,e,r){"use strict";e.exports=t("./is-implemented")()?Math.sign:t("./shim")},{"./is-implemented":165,"./shim":166}],165:[function(t,e,r){"use strict";e.exports=function(){var t=Math.sign;if(typeof t!=="function")return false;return t(10)===1&&t(-20)===-1}},{}],166:[function(t,e,r){"use strict";e.exports=function(t){t=Number(t);if(isNaN(t)||t===0)return t;return t>0?1:-1}},{}],167:[function(t,e,r){"use strict";var n=t("../math/sign"),a=Math.abs,i=Math.floor;e.exports=function(t){if(isNaN(t))return 0;t=Number(t);if(t===0||!isFinite(t))return t;return n(t)*i(a(t))}},{"../math/sign":164}],168:[function(t,e,r){"use strict";var n=t("./to-integer"),a=Math.max;e.exports=function(t){return a(0,n(t))}},{"./to-integer":167}],169:[function(t,e,r){"use strict";var n=t("./valid-callable"),a=t("./valid-value"),i=Function.prototype.bind,o=Function.prototype.call,s=Object.keys,l=Object.prototype.propertyIsEnumerable;e.exports=function(t,e){return function(r,u){var c,f=arguments[2],h=arguments[3];r=Object(a(r));n(u);c=s(r);if(h){c.sort(typeof h==="function"?i.call(h,r):undefined)}if(typeof t!=="function")t=c[t];return o.call(t,c,function(t,n){if(!l.call(r,t))return e;return o.call(u,f,r[t],t,r,n)})}}},{"./valid-callable":187,"./valid-value":189}],170:[function(t,e,r){"use strict";e.exports=t("./is-implemented")()?Object.assign:t("./shim")},{"./is-implemented":171,"./shim":172}],171:[function(t,e,r){"use strict";e.exports=function(){var t=Object.assign,e;if(typeof t!=="function")return false;e={foo:"raz"};t(e,{bar:"dwa"},{trzy:"trzy"});return e.foo+e.bar+e.trzy==="razdwatrzy"}},{}],172:[function(t,e,r){"use strict";var n=t("../keys"),a=t("../valid-value"),i=Math.max;e.exports=function(t,e){var r,o,s=i(arguments.length,2),l;t=Object(a(t));l=function(n){try{t[n]=e[n]}catch(t){if(!r)r=t}};for(o=1;o<s;++o){e=arguments[o];n(e).forEach(l)}if(r!==undefined)throw r;return t}},{"../keys":179,"../valid-value":189}],173:[function(t,e,r){"use strict";var n=t("../array/from"),a=t("./assign"),i=t("./valid-value");e.exports=function(t){var e=Object(i(t)),r=arguments[1],o=Object(arguments[2]);if(e!==t&&!r)return e;var s={};if(r){n(r,function(e){if(o.ensure||e in t)s[e]=t[e]})}else{a(s,t)}return s}},{"../array/from":158,"./assign":170,"./valid-value":189}],174:[function(t,e,r){"use strict";var n=Object.create,a;if(!t("./set-prototype-of/is-implemented")()){a=t("./set-prototype-of/shim")}e.exports=function(){var t,e,r;if(!a)return n;if(a.level!==1)return n;t={};e={};r={configurable:false,enumerable:false,writable:true,value:undefined};Object.getOwnPropertyNames(Object.prototype).forEach(function(t){if(t==="__proto__"){e[t]={configurable:true,enumerable:false,writable:true,value:undefined};return}e[t]=r});Object.defineProperties(t,e);Object.defineProperty(a,"nullPolyfill",{configurable:false,enumerable:false,writable:false,value:t});return function(e,r){return n(e===null?t:e,r)}}()},{"./set-prototype-of/is-implemented":185,"./set-prototype-of/shim":186}],175:[function(t,e,r){"use strict";e.exports=t("./_iterate")("forEach")},{"./_iterate":169}],176:[function(t,e,r){"use strict";e.exports=function(t){return typeof t==="function"}},{}],177:[function(t,e,r){"use strict";var n=t("./is-value");var a={function:true,object:true};e.exports=function(t){return n(t)&&a[typeof t]||false}},{"./is-value":178}],178:[function(t,e,r){"use strict";var n=t("../function/noop")();e.exports=function(t){return t!==n&&t!==null}},{"../function/noop":163}],179:[function(t,e,r){"use strict";e.exports=t("./is-implemented")()?Object.keys:t("./shim")},{"./is-implemented":180,"./shim":181}],180:[function(t,e,r){"use strict";e.exports=function(){try{Object.keys("primitive");return true}catch(t){return false}}},{}],181:[function(t,e,r){"use strict";var n=t("../is-value");var a=Object.keys;e.exports=function(t){return a(n(t)?Object(t):t)}},{"../is-value":178}],182:[function(t,e,r){"use strict";var n=t("./valid-callable"),a=t("./for-each"),i=Function.prototype.call;e.exports=function(t,e){var r={},o=arguments[2];n(e);a(t,function(t,n,a,s){r[n]=i.call(e,o,t,n,a,s)});return r}},{"./for-each":175,"./valid-callable":187}],183:[function(t,e,r){"use strict";var n=t("./is-value");var a=Array.prototype.forEach,i=Object.create;var o=function(t,e){var r;for(r in t)e[r]=t[r]};e.exports=function(t){var e=i(null);a.call(arguments,function(t){if(!n(t))return;o(Object(t),e)});return e}},{"./is-value":178}],184:[function(t,e,r){"use strict";e.exports=t("./is-implemented")()?Object.setPrototypeOf:t("./shim")},{"./is-implemented":185,"./shim":186}],185:[function(t,e,r){"use strict";var n=Object.create,a=Object.getPrototypeOf,i={};e.exports=function(){var t=Object.setPrototypeOf,e=arguments[0]||n;if(typeof t!=="function")return false;return a(t(e(null),i))===i}},{}],186:[function(t,e,r){"use strict";var n=t("../is-object"),a=t("../valid-value"),i=Object.prototype.isPrototypeOf,o=Object.defineProperty,s={configurable:true,enumerable:false,writable:true,value:undefined},l;l=function(t,e){a(t);if(e===null||n(e))return t;throw new TypeError("Prototype must be null or an object")};e.exports=function(t){var e,r;if(!t)return null;if(t.level===2){if(t.set){r=t.set;e=function(t,e){r.call(l(t,e),e);return t}}else{e=function(t,e){l(t,e).__proto__=e;return t}}}else{e=function t(e,r){var n;l(e,r);n=i.call(t.nullPolyfill,e);if(n)delete t.nullPolyfill.__proto__;if(r===null)r=t.nullPolyfill;e.__proto__=r;if(n)o(t.nullPolyfill,"__proto__",s);return e}}return Object.defineProperty(e,"level",{configurable:false,enumerable:false,writable:false,value:t.level})}(function(){var t=Object.create(null),e={},r,n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(n){try{r=n.set;r.call(t,e)}catch(t){}if(Object.getPrototypeOf(t)===e)return{set:r,level:2}}t.__proto__=e;if(Object.getPrototypeOf(t)===e)return{level:2};t={};t.__proto__=e;if(Object.getPrototypeOf(t)===e)return{level:1};return false}());t("../create")},{"../create":174,"../is-object":177,"../valid-value":189}],187:[function(t,e,r){"use strict";e.exports=function(t){if(typeof t!=="function")throw new TypeError(t+" is not a function");return t}},{}],188:[function(t,e,r){"use strict";var n=t("./is-object");e.exports=function(t){if(!n(t))throw new TypeError(t+" is not an Object");return t}},{"./is-object":177}],189:[function(t,e,r){"use strict";var n=t("./is-value");e.exports=function(t){if(!n(t))throw new TypeError("Cannot use null or undefined");return t}},{"./is-value":178}],190:[function(t,e,r){"use strict";e.exports=t("./is-implemented")()?String.prototype.contains:t("./shim")},{"./is-implemented":191,"./shim":192}],191:[function(t,e,r){"use strict";var n="razdwatrzy";e.exports=function(){if(typeof n.contains!=="function")return false;return n.contains("dwa")===true&&n.contains("foo")===false}},{}],192:[function(t,e,r){"use strict";var n=String.prototype.indexOf;e.exports=function(t){return n.call(this,t,arguments[1])>-1}},{}],193:[function(t,e,r){"use strict";var n=Object.prototype.toString,a=n.call("");e.exports=function(t){return typeof t==="string"||t&&typeof t==="object"&&(t instanceof String||n.call(t)===a)||false}},{}],194:[function(t,e,r){"use strict";var n=Object.create(null),a=Math.random;e.exports=function(){var t;do{t=a().toString(36).slice(2)}while(n[t]);return t}},{}],195:[function(t,e,r){"use strict";var n=t("es5-ext/object/set-prototype-of"),a=t("es5-ext/string/#/contains"),i=t("d"),o=t("es6-symbol"),s=t("./");var l=Object.defineProperty,u;u=e.exports=function(t,e){if(!(this instanceof u))throw new TypeError("Constructor requires 'new'");s.call(this,t);if(!e)e="value";else if(a.call(e,"key+value"))e="key+value";else if(a.call(e,"key"))e="key";else e="value";l(this,"__kind__",i("",e))};if(n)n(u,s);delete u.prototype.constructor;u.prototype=Object.create(s.prototype,{_resolve:i(function(t){if(this.__kind__==="value")return this.__list__[t];if(this.__kind__==="key+value")return[t,this.__list__[t]];return t})});l(u.prototype,o.toStringTag,i("c","Array Iterator"))},{"./":198,d:138,"es5-ext/object/set-prototype-of":184,"es5-ext/string/#/contains":190,"es6-symbol":203}],196:[function(t,e,r){"use strict";var n=t("es5-ext/function/is-arguments"),a=t("es5-ext/object/valid-callable"),i=t("es5-ext/string/is-string"),o=t("./get");var s=Array.isArray,l=Function.prototype.call,u=Array.prototype.some;e.exports=function(t,e){var r,c=arguments[2],f,h,p,d,v,g,m;if(s(t)||n(t))r="array";else if(i(t))r="string";else t=o(t);a(e);h=function(){p=true};if(r==="array"){u.call(t,function(t){l.call(e,c,t,h);return p});return}if(r==="string"){v=t.length;for(d=0;d<v;++d){g=t[d];if(d+1<v){m=g.charCodeAt(0);if(m>=55296&&m<=56319)g+=t[++d]}l.call(e,c,g,h);if(p)break}return}f=t.next();while(!f.done){l.call(e,c,f.value,h);if(p)return;f=t.next()}}},{"./get":197,"es5-ext/function/is-arguments":161,"es5-ext/object/valid-callable":187,"es5-ext/string/is-string":193}],197:[function(t,e,r){"use strict";var n=t("es5-ext/function/is-arguments"),a=t("es5-ext/string/is-string"),i=t("./array"),o=t("./string"),s=t("./valid-iterable"),l=t("es6-symbol").iterator;e.exports=function(t){if(typeof s(t)[l]==="function")return t[l]();if(n(t))return new i(t);if(a(t))return new o(t);return new i(t)}},{"./array":195,"./string":200,"./valid-iterable":201,"es5-ext/function/is-arguments":161,"es5-ext/string/is-string":193,"es6-symbol":203}],198:[function(t,e,r){"use strict";var n=t("es5-ext/array/#/clear"),a=t("es5-ext/object/assign"),i=t("es5-ext/object/valid-callable"),o=t("es5-ext/object/valid-value"),s=t("d"),l=t("d/auto-bind"),u=t("es6-symbol");var c=Object.defineProperty,f=Object.defineProperties,h;e.exports=h=function(t,e){if(!(this instanceof h))throw new TypeError("Constructor requires 'new'");f(this,{__list__:s("w",o(t)),__context__:s("w",e),__nextIndex__:s("w",0)});if(!e)return;i(e.on);e.on("_add",this._onAdd);e.on("_delete",this._onDelete);e.on("_clear",this._onClear)};delete h.prototype.constructor;f(h.prototype,a({_next:s(function(){var t;if(!this.__list__)return undefined;if(this.__redo__){t=this.__redo__.shift();if(t!==undefined)return t}if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind();return undefined}),next:s(function(){return this._createResult(this._next())}),_createResult:s(function(t){if(t===undefined)return{done:true,value:undefined};return{done:false,value:this._resolve(t)}}),_resolve:s(function(t){return this.__list__[t]}),_unBind:s(function(){this.__list__=null;delete this.__redo__;if(!this.__context__)return;this.__context__.off("_add",this._onAdd);this.__context__.off("_delete",this._onDelete);this.__context__.off("_clear",this._onClear);this.__context__=null}),toString:s(function(){return"[object "+(this[u.toStringTag]||"Object")+"]"})},l({_onAdd:s(function(t){if(t>=this.__nextIndex__)return;++this.__nextIndex__;if(!this.__redo__){c(this,"__redo__",s("c",[t]));return}this.__redo__.forEach(function(e,r){if(e>=t)this.__redo__[r]=++e},this);this.__redo__.push(t)}),_onDelete:s(function(t){var e;if(t>=this.__nextIndex__)return;--this.__nextIndex__;if(!this.__redo__)return;e=this.__redo__.indexOf(t);if(e!==-1)this.__redo__.splice(e,1);this.__redo__.forEach(function(e,r){if(e>t)this.__redo__[r]=--e},this)}),_onClear:s(function(){if(this.__redo__)n.call(this.__redo__);this.__nextIndex__=0})})));c(h.prototype,u.iterator,s(function(){return this}))},{d:138,"d/auto-bind":137,"es5-ext/array/#/clear":157,"es5-ext/object/assign":170,"es5-ext/object/valid-callable":187,"es5-ext/object/valid-value":189,"es6-symbol":203}],199:[function(t,e,r){"use strict";var n=t("es5-ext/function/is-arguments"),a=t("es5-ext/object/is-value"),i=t("es5-ext/string/is-string");var o=t("es6-symbol").iterator,s=Array.isArray;e.exports=function(t){if(!a(t))return false;if(s(t))return true;if(i(t))return true;if(n(t))return true;return typeof t[o]==="function"}},{"es5-ext/function/is-arguments":161,"es5-ext/object/is-value":178,"es5-ext/string/is-string":193,"es6-symbol":203}],200:[function(t,e,r){"use strict";var n=t("es5-ext/object/set-prototype-of"),a=t("d"),i=t("es6-symbol"),o=t("./");var s=Object.defineProperty,l;l=e.exports=function(t){if(!(this instanceof l))throw new TypeError("Constructor requires 'new'");t=String(t);o.call(this,t);s(this,"__length__",a("",t.length))};if(n)n(l,o);delete l.prototype.constructor;l.prototype=Object.create(o.prototype,{_next:a(function(){if(!this.__list__)return undefined;if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind();return undefined}),_resolve:a(function(t){var e=this.__list__[t],r;if(this.__nextIndex__===this.__length__)return e;r=e.charCodeAt(0);if(r>=55296&&r<=56319)return e+this.__list__[this.__nextIndex__++];return e})});s(l.prototype,i.toStringTag,a("c","String Iterator"))},{"./":198,d:138,"es5-ext/object/set-prototype-of":184,"es6-symbol":203}],201:[function(t,e,r){"use strict";var n=t("./is-iterable");e.exports=function(t){if(!n(t))throw new TypeError(t+" is not iterable");return t}},{"./is-iterable":199}],202:[function(e,r,n){(function(a,i){(function(e,a){typeof n==="object"&&typeof r!=="undefined"?r.exports=a():typeof t==="function"&&t.amd?t(a):e.ES6Promise=a()})(this,function(){"use strict";function t(t){return typeof t==="function"||typeof t==="object"&&t!==null}function r(t){return typeof t==="function"}var n=undefined;if(!Array.isArray){n=function(t){return Object.prototype.toString.call(t)==="[object Array]"}}else{n=Array.isArray}var o=n;var s=0;var l=undefined;var u=undefined;var c=function t(e,r){k[s]=e;k[s+1]=r;s+=2;if(s===2){if(u){u(M)}else{T()}}};function f(t){u=t}function h(t){c=t}var p=typeof window!=="undefined"?window:undefined;var d=p||{};var v=d.MutationObserver||d.WebKitMutationObserver;var g=typeof self==="undefined"&&typeof a!=="undefined"&&{}.toString.call(a)==="[object process]";var m=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function y(){return function(){return a.nextTick(M)}}function x(){return function(){l(M)}}function b(){var t=0;var e=new v(M);var r=document.createTextNode("");e.observe(r,{characterData:true});return function(){r.data=t=++t%2}}function _(){var t=new MessageChannel;t.port1.onmessage=M;return function(){return t.port2.postMessage(0)}}function w(){var t=setTimeout;return function(){return t(M,1)}}var k=new Array(1e3);function M(){for(var t=0;t<s;t+=2){var e=k[t];var r=k[t+1];e(r);k[t]=undefined;k[t+1]=undefined}s=0}function A(){try{var t=e;var r=t("vertx");l=r.runOnLoop||r.runOnContext;return x()}catch(t){return w()}}var T=undefined;if(g){T=y()}else if(v){T=b()}else if(m){T=_()}else if(p===undefined&&typeof e==="function"){T=A()}else{T=w()}function S(t,e){var r=arguments;var n=this;var a=new this.constructor(L);if(a[C]===undefined){et(a)}var i=n._state;if(i){(function(){var t=r[i-1];c(function(){return J(i,a,t,n._result)})})()}else{W(n,a,t,e)}return a}function E(t){var e=this;if(t&&typeof t==="object"&&t.constructor===e){return t}var r=new e(L);U(r,t);return r}var C=Math.random().toString(36).substring(16);function L(){}var I=void 0;var z=1;var P=2;var O=new X;function D(){return new TypeError("You cannot resolve a promise with itself")}function R(){return new TypeError("A promises callback cannot return that same promise.")}function B(t){try{return t.then}catch(t){O.error=t;return O}}function F(t,e,r,n){try{t.call(e,r,n)}catch(t){return t}}function N(t,e,r){c(function(t){var n=false;var a=F(r,e,function(r){if(n){return}n=true;if(e!==r){U(t,r)}else{H(t,r)}},function(e){if(n){return}n=true;G(t,e)},"Settle: "+(t._label||" unknown promise"));if(!n&&a){n=true;G(t,a)}},t)}function j(t,e){if(e._state===z){H(t,e._result)}else if(e._state===P){G(t,e._result)}else{W(e,undefined,function(e){return U(t,e)},function(e){return G(t,e)})}}function V(t,e,n){if(e.constructor===t.constructor&&n===S&&e.constructor.resolve===E){j(t,e)}else{if(n===O){G(t,O.error)}else if(n===undefined){H(t,e)}else if(r(n)){N(t,e,n)}else{H(t,e)}}}function U(e,r){if(e===r){G(e,D())}else if(t(r)){V(e,r,B(r))}else{H(e,r)}}function q(t){if(t._onerror){t._onerror(t._result)}Y(t)}function H(t,e){if(t._state!==I){return}t._result=e;t._state=z;if(t._subscribers.length!==0){c(Y,t)}}function G(t,e){if(t._state!==I){return}t._state=P;t._result=e;c(q,t)}function W(t,e,r,n){var a=t._subscribers;var i=a.length;t._onerror=null;a[i]=e;a[i+z]=r;a[i+P]=n;if(i===0&&t._state){c(Y,t)}}function Y(t){var e=t._subscribers;var r=t._state;if(e.length===0){return}var n=undefined,a=undefined,i=t._result;for(var o=0;o<e.length;o+=3){n=e[o];a=e[o+r];if(n){J(r,n,a,i)}else{a(i)}}t._subscribers.length=0}function X(){this.error=null}var Z=new X;function $(t,e){try{return t(e)}catch(t){Z.error=t;return Z}}function J(t,e,n,a){var i=r(n),o=undefined,s=undefined,l=undefined,u=undefined;if(i){o=$(n,a);if(o===Z){u=true;s=o.error;o=null}else{l=true}if(e===o){G(e,R());return}}else{o=a;l=true}if(e._state!==I){}else if(i&&l){U(e,o)}else if(u){G(e,s)}else if(t===z){H(e,o)}else if(t===P){G(e,o)}}function K(t,e){try{e(function e(r){U(t,r)},function e(r){G(t,r)})}catch(e){G(t,e)}}var Q=0;function tt(){return Q++}function et(t){t[C]=Q++;t._state=undefined;t._result=undefined;t._subscribers=[]}function rt(t,e){this._instanceConstructor=t;this.promise=new t(L);if(!this.promise[C]){et(this.promise)}if(o(e)){this._input=e;this.length=e.length;this._remaining=e.length;this._result=new Array(this.length);if(this.length===0){H(this.promise,this._result)}else{this.length=this.length||0;this._enumerate();if(this._remaining===0){H(this.promise,this._result)}}}else{G(this.promise,nt())}}function nt(){return new Error("Array Methods must be provided an Array")}rt.prototype._enumerate=function(){var t=this.length;var e=this._input;for(var r=0;this._state===I&&r<t;r++){this._eachEntry(e[r],r)}};rt.prototype._eachEntry=function(t,e){var r=this._instanceConstructor;var n=r.resolve;if(n===E){var a=B(t);if(a===S&&t._state!==I){this._settledAt(t._state,e,t._result)}else if(typeof a!=="function"){this._remaining--;this._result[e]=t}else if(r===ut){var i=new r(L);V(i,t,a);this._willSettleAt(i,e)}else{this._willSettleAt(new r(function(e){return e(t)}),e)}}else{this._willSettleAt(n(t),e)}};rt.prototype._settledAt=function(t,e,r){var n=this.promise;if(n._state===I){this._remaining--;if(t===P){G(n,r)}else{this._result[e]=r}}if(this._remaining===0){H(n,this._result)}};rt.prototype._willSettleAt=function(t,e){var r=this;W(t,undefined,function(t){return r._settledAt(z,e,t)},function(t){return r._settledAt(P,e,t)})};function at(t){return new rt(this,t).promise}function it(t){var e=this;if(!o(t)){return new e(function(t,e){return e(new TypeError("You must pass an array to race."))})}else{return new e(function(r,n){var a=t.length;for(var i=0;i<a;i++){e.resolve(t[i]).then(r,n)}})}}function ot(t){var e=this;var r=new e(L);G(r,t);return r}function st(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function lt(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function ut(t){this[C]=tt();this._result=this._state=undefined;this._subscribers=[];if(L!==t){typeof t!=="function"&&st();this instanceof ut?K(this,t):lt()}}ut.all=at;ut.race=it;ut.resolve=E;ut.reject=ot;ut._setScheduler=f;ut._setAsap=h;ut._asap=c;ut.prototype={constructor:ut,then:S,catch:function t(e){return this.then(null,e)}};function ct(){var t=undefined;if(typeof i!=="undefined"){t=i}else if(typeof self!=="undefined"){t=self}else{try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if(r==="[object Promise]"&&!e.cast){return}}t.Promise=ut}ct();ut.polyfill=ct;ut.Promise=ut;return ut})}).call(this,e("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:449}],203:[function(t,e,r){"use strict";e.exports=t("./is-implemented")()?Symbol:t("./polyfill")},{"./is-implemented":204,"./polyfill":206}],204:[function(t,e,r){"use strict";var n={object:true,symbol:true};e.exports=function(){var t;if(typeof Symbol!=="function")return false;t=Symbol("test symbol");try{String(t)}catch(t){return false}if(!n[typeof Symbol.iterator])return false;if(!n[typeof Symbol.toPrimitive])return false;if(!n[typeof Symbol.toStringTag])return false;return true}},{}],205:[function(t,e,r){"use strict";e.exports=function(t){if(!t)return false;if(typeof t==="symbol")return true;if(!t.constructor)return false;if(t.constructor.name!=="Symbol")return false;return t[t.constructor.toStringTag]==="Symbol"}},{}],206:[function(t,e,r){"use strict";var n=t("d"),a=t("./validate-symbol"),i=Object.create,o=Object.defineProperties,s=Object.defineProperty,l=Object.prototype,u,c,f,h=i(null),p;if(typeof Symbol==="function"){u=Symbol;try{String(u());p=true}catch(t){}}var d=function(){var t=i(null);return function(e){var r=0,a,i;while(t[e+(r||"")])++r;e+=r||"";t[e]=true;a="@@"+e;s(l,a,n.gs(null,function(t){if(i)return;i=true;s(this,a,n(t));i=false}));return a}}();f=function t(e){if(this instanceof f)throw new TypeError("Symbol is not a constructor");return c(e)};e.exports=c=function t(e){var r;if(this instanceof t)throw new TypeError("Symbol is not a constructor");if(p)return u(e);r=i(f.prototype);e=e===undefined?"":String(e);return o(r,{__description__:n("",e),__name__:n("",d(e))})};o(c,{for:n(function(t){if(h[t])return h[t];return h[t]=c(String(t))}),keyFor:n(function(t){var e;a(t);for(e in h)if(h[e]===t)return e}),hasInstance:n("",u&&u.hasInstance||c("hasInstance")),isConcatSpreadable:n("",u&&u.isConcatSpreadable||c("isConcatSpreadable")),iterator:n("",u&&u.iterator||c("iterator")),match:n("",u&&u.match||c("match")),replace:n("",u&&u.replace||c("replace")),search:n("",u&&u.search||c("search")),species:n("",u&&u.species||c("species")),split:n("",u&&u.split||c("split")),toPrimitive:n("",u&&u.toPrimitive||c("toPrimitive")),toStringTag:n("",u&&u.toStringTag||c("toStringTag")),unscopables:n("",u&&u.unscopables||c("unscopables"))});o(f.prototype,{constructor:n(c),toString:n("",function(){return this.__name__})});o(c.prototype,{toString:n(function(){return"Symbol ("+a(this).__description__+")"}),valueOf:n(function(){return a(this)})});s(c.prototype,c.toPrimitive,n("",function(){var t=a(this);if(typeof t==="symbol")return t;return t.toString()}));s(c.prototype,c.toStringTag,n("c","Symbol"));s(f.prototype,c.toStringTag,n("c",c.prototype[c.toStringTag]));s(f.prototype,c.toPrimitive,n("c",c.prototype[c.toPrimitive]))},{"./validate-symbol":207,d:138}],207:[function(t,e,r){"use strict";var n=t("./is-symbol");e.exports=function(t){if(!n(t))throw new TypeError(t+" is not a symbol");return t}},{"./is-symbol":205}],208:[function(t,e,r){"use strict";e.exports=t("./is-implemented")()?WeakMap:t("./polyfill")},{"./is-implemented":209,"./polyfill":211}],209:[function(t,e,r){"use strict";e.exports=function(){var t,e;if(typeof WeakMap!=="function")return false;try{t=new WeakMap([[e={},"one"],[{},"two"],[{},"three"]])}catch(t){return false}if(String(t)!=="[object WeakMap]")return false;if(typeof t.set!=="function")return false;if(t.set({},1)!==t)return false;if(typeof t.delete!=="function")return false;if(typeof t.has!=="function")return false;if(t.get(e)!=="one")return false;return true}},{}],210:[function(t,e,r){"use strict";e.exports=function(){if(typeof WeakMap!=="function")return false;return Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"}()},{}],211:[function(t,e,r){"use strict";var n=t("es5-ext/object/set-prototype-of"),a=t("es5-ext/object/valid-object"),i=t("es5-ext/object/valid-value"),o=t("es5-ext/string/random-uniq"),s=t("d"),l=t("es6-iterator/get"),u=t("es6-iterator/for-of"),c=t("es6-symbol").toStringTag,f=t("./is-native-implemented"),h=Array.isArray,p=Object.defineProperty,d=Object.prototype.hasOwnProperty,v=Object.getPrototypeOf,g;e.exports=g=function(){var t=arguments[0],e;if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");if(f&&n&&WeakMap!==g){e=n(new WeakMap,v(this))}else{e=this}if(t!=null){if(!h(t))t=l(t)}p(e,"__weakMapData__",s("c","$weakMap$"+o()));if(!t)return e;u(t,function(t){i(t);e.set(t[0],t[1])});return e};if(f){if(n)n(g,WeakMap);g.prototype=Object.create(WeakMap.prototype,{constructor:s(g)})}Object.defineProperties(g.prototype,{delete:s(function(t){if(d.call(a(t),this.__weakMapData__)){delete t[this.__weakMapData__];return true}return false}),get:s(function(t){if(d.call(a(t),this.__weakMapData__)){return t[this.__weakMapData__]}}),has:s(function(t){return d.call(a(t),this.__weakMapData__)}),set:s(function(t,e){p(a(t),this.__weakMapData__,s("c",e));return this}),toString:s(function(){return"[object WeakMap]"})});p(g.prototype,c,s("c","WeakMap"))},{"./is-native-implemented":210,d:138,"es5-ext/object/set-prototype-of":184,"es5-ext/object/valid-object":188,"es5-ext/object/valid-value":189,"es5-ext/string/random-uniq":194,"es6-iterator/for-of":196,"es6-iterator/get":197,"es6-symbol":203}],212:[function(t,e,r){function n(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}e.exports=n;n.EventEmitter=n;n.prototype._events=undefined;n.prototype._maxListeners=undefined;n.defaultMaxListeners=10;n.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");this._maxListeners=t;return this};n.prototype.emit=function(t){var e,r,n,i,l,u;if(!this._events)this._events={};if(t==="error"){if(!this._events.error||o(this._events.error)&&!this._events.error.length){e=arguments[1];if(e instanceof Error){throw e}else{var c=new Error('Uncaught, unspecified "error" event. ('+e+")");c.context=e;throw c}}}r=this._events[t];if(s(r))return false;if(a(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1);r.apply(this,i)}}else if(o(r)){i=Array.prototype.slice.call(arguments,1);u=r.slice();n=u.length;for(l=0;l<n;l++)u[l].apply(this,i)}return true};n.prototype.addListener=function(t,e){var r;if(!a(e))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",t,a(e.listener)?e.listener:e);if(!this._events[t])this._events[t]=e;else if(o(this._events[t]))this._events[t].push(e);else this._events[t]=[this._events[t],e];if(o(this._events[t])&&!this._events[t].warned){if(!s(this._maxListeners)){r=this._maxListeners}else{r=n.defaultMaxListeners}if(r&&r>0&&this._events[t].length>r){this._events[t].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[t].length);if(typeof console.trace==="function"){console.trace()}}}return this};n.prototype.on=n.prototype.addListener;n.prototype.once=function(t,e){if(!a(e))throw TypeError("listener must be a function");var r=false;function n(){this.removeListener(t,n);if(!r){r=true;e.apply(this,arguments)}}n.listener=e;this.on(t,n);return this};n.prototype.removeListener=function(t,e){var r,n,i,s;if(!a(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;r=this._events[t];i=r.length;n=-1;if(r===e||a(r.listener)&&r.listener===e){delete this._events[t];if(this._events.removeListener)this.emit("removeListener",t,e)}else if(o(r)){for(s=i;s-- >0;){if(r[s]===e||r[s].listener&&r[s].listener===e){n=s;break}}if(n<0)return this;if(r.length===1){r.length=0;delete this._events[t]}else{r.splice(n,1)}if(this._events.removeListener)this.emit("removeListener",t,e)}return this};n.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[t])delete this._events[t];return this}if(arguments.length===0){for(e in this._events){if(e==="removeListener")continue;this.removeAllListeners(e)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[t];if(a(r)){this.removeListener(t,r)}else if(r){while(r.length)this.removeListener(t,r[r.length-1])}delete this._events[t];return this};n.prototype.listeners=function(t){var e;if(!this._events||!this._events[t])e=[];else if(a(this._events[t]))e=[this._events[t]];else e=this._events[t].slice();return e};n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(a(e))return 1;else if(e)return e.length}return 0};n.listenerCount=function(t,e){return t.listenerCount(e)};function a(t){return typeof t==="function"}function i(t){return typeof t==="number"}function o(t){return typeof t==="object"&&t!==null}function s(t){return t===void 0}},{}],213:[function(t,e,r){"use strict";e.exports=n;function n(t,e,r){var n=e||0;var a=r||1;return[[t[12]+t[0],t[13]+t[1],t[14]+t[2],t[15]+t[3]],[t[12]-t[0],t[13]-t[1],t[14]-t[2],t[15]-t[3]],[t[12]+t[4],t[13]+t[5],t[14]+t[6],t[15]+t[7]],[t[12]-t[4],t[13]-t[5],t[14]-t[6],t[15]-t[7]],[n*t[12]+t[8],n*t[13]+t[9],n*t[14]+t[10],n*t[15]+t[11]],[a*t[12]-t[8],a*t[13]-t[9],a*t[14]-t[10],a*t[15]-t[11]]]}},{}],214:[function(t,e,r){"use strict";function n(t){var e=t.length,r;for(var n=0;n<e;n++){r=t.charCodeAt(n);if((r<9||r>13)&&r!==32&&r!==133&&r!==160&&r!==5760&&r!==6158&&(r<8192||r>8205)&&r!==8232&&r!==8233&&r!==8239&&r!==8287&&r!==8288&&r!==12288&&r!==65279){return false}}return true}e.exports=function(t){var e=typeof t;if(e==="string"){var r=t;t=+t;if(t===0&&n(r))return false}else if(e!=="number")return false;return t-t<1}},{}],215:[function(t,e,r){"use strict";e.exports=u;var n=t("cubic-hermite");var a=t("binary-search-bounds");function i(t,e,r){return Math.min(e,Math.max(t,r))}function o(t,e,r){this.dimension=t.length;this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var n=0;n<this.dimension;++n){this.bounds[0][n]=-Infinity;this.bounds[1][n]=Infinity}this._state=t.slice().reverse();this._velocity=e.slice().reverse();this._time=[r];this._scratch=[t.slice(),t.slice(),t.slice(),t.slice(),t.slice()]}var s=o.prototype;s.flush=function(t){var e=a.gt(this._time,t)-1;if(e<=0){return}this._time.splice(0,e);this._state.splice(0,e*this.dimension);this._velocity.splice(0,e*this.dimension)};s.curve=function(t){var e=this._time;var r=e.length;var o=a.le(e,t);var s=this._scratch[0];var l=this._state;var u=this._velocity;var c=this.dimension;var f=this.bounds;if(o<0){var h=c-1;for(var p=0;p<c;++p,--h){s[p]=l[h]}}else if(o>=r-1){var h=l.length-1;var d=t-e[r-1];for(var p=0;p<c;++p,--h){s[p]=l[h]+d*u[h]}}else{var h=c*(o+1)-1;var v=e[o];var g=e[o+1];var m=g-v||1;var y=this._scratch[1];var x=this._scratch[2];var b=this._scratch[3];var _=this._scratch[4];var w=true;for(var p=0;p<c;++p,--h){y[p]=l[h];b[p]=u[h]*m;x[p]=l[h+c];_[p]=u[h+c]*m;w=w&&(y[p]===x[p]&&b[p]===_[p]&&b[p]===0)}if(w){for(var p=0;p<c;++p){s[p]=y[p]}}else{n(y,b,x,_,(t-v)/m,s)}}var k=f[0];var M=f[1];for(var p=0;p<c;++p){s[p]=i(k[p],M[p],s[p])}return s};s.dcurve=function(t){var e=this._time;var r=e.length;var i=a.le(e,t);var o=this._scratch[0];var s=this._state;var l=this._velocity;var u=this.dimension;if(i>=r-1){var c=s.length-1;var f=t-e[r-1];for(var h=0;h<u;++h,--c){o[h]=l[c]}}else{var c=u*(i+1)-1;var p=e[i];var d=e[i+1];var v=d-p||1;var g=this._scratch[1];var m=this._scratch[2];var y=this._scratch[3];var x=this._scratch[4];var b=true;for(var h=0;h<u;++h,--c){g[h]=s[c];y[h]=l[c]*v;m[h]=s[c+u];x[h]=l[c+u]*v;b=b&&(g[h]===m[h]&&y[h]===x[h]&&y[h]===0)}if(b){for(var h=0;h<u;++h){o[h]=0}}else{n.derivative(g,y,m,x,(t-p)/v,o);for(var h=0;h<u;++h){o[h]/=v}}}return o};s.lastT=function(){var t=this._time;return t[t.length-1]};s.stable=function(){var t=this._velocity;var e=t.length;for(var r=this.dimension-1;r>=0;--r){if(t[--e]){return false}}return true};s.jump=function(t){var e=this.lastT();var r=this.dimension;if(t<e||arguments.length!==r+1){return}var n=this._state;var a=this._velocity;var o=n.length-this.dimension;var s=this.bounds;var l=s[0];var u=s[1];this._time.push(e,t);for(var c=0;c<2;++c){for(var f=0;f<r;++f){n.push(n[o++]);a.push(0)}}this._time.push(t);for(var f=r;f>0;--f){n.push(i(l[f-1],u[f-1],arguments[f]));a.push(0)}};s.push=function(t){var e=this.lastT();var r=this.dimension;if(t<e||arguments.length!==r+1){return}var n=this._state;var a=this._velocity;var o=n.length-this.dimension;var s=t-e;var l=this.bounds;var u=l[0];var c=l[1];var f=s>1e-6?1/s:0;this._time.push(t);for(var h=r;h>0;--h){var p=i(u[h-1],c[h-1],arguments[h]);n.push(p);a.push((p-n[o++])*f)}};s.set=function(t){var e=this.dimension;if(t<this.lastT()||arguments.length!==e+1){return}var r=this._state;var n=this._velocity;var a=this.bounds;var o=a[0];var s=a[1];this._time.push(t);for(var l=e;l>0;--l){r.push(i(o[l-1],s[l-1],arguments[l]));n.push(0)}};s.move=function(t){var e=this.lastT();var r=this.dimension;if(t<=e||arguments.length!==r+1){return}var n=this._state;var a=this._velocity;var o=n.length-this.dimension;var s=this.bounds;var l=s[0];var u=s[1];var c=t-e;var f=c>1e-6?1/c:0;this._time.push(t);for(var h=r;h>0;--h){var p=arguments[h];n.push(i(l[h-1],u[h-1],n[o++]+p));a.push(p*f)}};s.idle=function(t){var e=this.lastT();if(t<e){return}var r=this.dimension;var n=this._state;var a=this._velocity;var o=n.length-r;var s=this.bounds;var l=s[0];var u=s[1];var c=t-e;this._time.push(t);for(var f=r-1;f>=0;--f){n.push(i(l[f],u[f],n[o]+c*a[o]));a.push(0);o+=1}};function l(t){var e=new Array(t);for(var r=0;r<t;++r){e[r]=0}return e}function u(t,e,r){switch(arguments.length){case 0:return new o([0],[0],0);case 1:if(typeof t==="number"){var n=l(t);return new o(n,n,0)}else{return new o(t,l(t.length),0)}case 2:if(typeof e==="number"){var n=l(t.length);return new o(t,n,+e)}else{r=0}case 3:if(t.length!==e.length){throw new Error("state and velocity lengths must match")}return new o(t,e,r)}}},{"binary-search-bounds":79,"cubic-hermite":132}],216:[function(t,e,r){var n=t("dtype");e.exports=a;function a(t,e,r){if(!t)throw new TypeError("must specify data as first parameter");r=+(r||0)|0;if(Array.isArray(t)&&Array.isArray(t[0])){var a=t[0].length;var i=t.length*a;if(!e||typeof e==="string"){e=new(n(e||"float32"))(i+r)}var o=e.length-r;if(i!==o){throw new Error("source length "+i+" ("+a+"x"+t.length+")"+" does not match destination length "+o)}for(var s=0,l=r;s<t.length;s++){for(var u=0;u<a;u++){e[l++]=t[s][u]}}}else{if(!e||typeof e==="string"){var c=n(e||"float32");if(r===0){e=new c(t)}else{e=new c(t.length+r);e.set(t,r)}}else{e.set(t,r)}}return e}},{dtype:153}],217:[function(t,e,r){"use strict";var n=t("css-font/stringify");var a=[32,126];e.exports=i;function i(t){t=t||{};var e=t.shape?t.shape:t.canvas?[t.canvas.width,t.canvas.height]:[512,512];var r=t.canvas||document.createElement("canvas");var i=t.font;var o=typeof t.step==="number"?[t.step,t.step]:t.step||[32,32];var s=t.chars||a;if(i&&typeof i!=="string")i=n(i);if(!Array.isArray(s)){s=String(s).split("")}else if(s.length===2&&typeof s[0]==="number"&&typeof s[1]==="number"){var l=[];for(var u=s[0],c=0;u<=s[1];u++){l[c++]=String.fromCharCode(u)}s=l}e=e.slice();r.width=e[0];r.height=e[1];var f=r.getContext("2d");f.fillStyle="#000";f.fillRect(0,0,r.width,r.height);f.font=i;f.textAlign="center";f.textBaseline="middle";f.fillStyle="#fff";var h=o[0]/2;var p=o[1]/2;for(var u=0;u<s.length;u++){f.fillText(s[u],h,p);if((h+=o[0])>e[0]-o[0]/2)h=o[0]/2,p+=o[1]}return r}},{"css-font/stringify":129}],218:[function(t,e,r){"use strict";e.exports=n;n.canvas=document.createElement("canvas");n.cache={};function n(t,e){if(!e)e={};if(typeof t==="string"||Array.isArray(t)){e.family=t}var r=Array.isArray(e.family)?e.family.join(", "):e.family;if(!r)throw Error("`family` must be defined");var s=e.size||e.fontSize||e.em||48;var l=e.weight||e.fontWeight||"";var u=e.style||e.fontStyle||"";var t=[u,l,s].join(" ")+"px "+r;var c=e.origin||"top";if(n.cache[r]){if(s<=n.cache[r].em){return a(n.cache[r],c)}}var f=e.canvas||n.canvas;var h=f.getContext("2d");var p={upper:e.upper!==undefined?e.upper:"H",lower:e.lower!==undefined?e.lower:"x",descent:e.descent!==undefined?e.descent:"p",ascent:e.ascent!==undefined?e.ascent:"h",tittle:e.tittle!==undefined?e.tittle:"i",overshoot:e.overshoot!==undefined?e.overshoot:"O"};var d=Math.ceil(s*1.5);f.height=d;f.width=d*.5;h.font=t;var v="H";var g={top:0};h.clearRect(0,0,d,d);h.textBaseline="top";h.fillStyle="black";h.fillText(v,0,0);var m=i(h.getImageData(0,0,d,d));h.clearRect(0,0,d,d);h.textBaseline="bottom";h.fillText(v,0,d);var y=i(h.getImageData(0,0,d,d));g.lineHeight=g.bottom=d-y+m;h.clearRect(0,0,d,d);h.textBaseline="alphabetic";h.fillText(v,0,d);var x=i(h.getImageData(0,0,d,d));var b=d-x-1+m;g.baseline=g.alphabetic=b;h.clearRect(0,0,d,d);h.textBaseline="middle";h.fillText(v,0,d*.5);var _=i(h.getImageData(0,0,d,d));g.median=g.middle=d-_-1+m-d*.5;h.clearRect(0,0,d,d);h.textBaseline="hanging";h.fillText(v,0,d*.5);var w=i(h.getImageData(0,0,d,d));g.hanging=d-w-1+m-d*.5;h.clearRect(0,0,d,d);h.textBaseline="ideographic";h.fillText(v,0,d);var k=i(h.getImageData(0,0,d,d));g.ideographic=d-k-1+m;if(p.upper){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.upper,0,0);g.upper=i(h.getImageData(0,0,d,d));g.capHeight=g.baseline-g.upper}if(p.lower){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.lower,0,0);g.lower=i(h.getImageData(0,0,d,d));g.xHeight=g.baseline-g.lower}if(p.tittle){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.tittle,0,0);g.tittle=i(h.getImageData(0,0,d,d))}if(p.ascent){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.ascent,0,0);g.ascent=i(h.getImageData(0,0,d,d))}if(p.descent){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.descent,0,0);g.descent=o(h.getImageData(0,0,d,d))}if(p.overshoot){h.clearRect(0,0,d,d);h.textBaseline="top";h.fillText(p.overshoot,0,0);var M=o(h.getImageData(0,0,d,d));g.overshoot=M-b}for(var A in g){g[A]/=s}g.em=s;n.cache[r]=g;return a(g,c)}function a(t,e){var r={};if(typeof e==="string")e=t[e];for(var n in t){if(n==="em")continue;r[n]=t[n]-e}return r}function i(t){var e=t.height;var r=t.data;for(var n=3;n<r.length;n+=4){if(r[n]!==0){return Math.floor((n-3)*.25/e)}}}function o(t){var e=t.height;var r=t.data;for(var n=r.length-1;n>0;n-=4){if(r[n]!==0){return Math.floor((n-3)*.25/e)}}}},{}],219:[function(t,e,r){"use strict";e.exports=x;var n=0;var a=1;function i(t,e,r,n,a,i){this._color=t;this.key=e;this.value=r;this.left=n;this.right=a;this._count=i}function o(t){return new i(t._color,t.key,t.value,t.left,t.right,t._count)}function s(t,e){return new i(t,e.key,e.value,e.left,e.right,e._count)}function l(t){t._count=1+(t.left?t.left._count:0)+(t.right?t.right._count:0)}function u(t,e){this._compare=t;this.root=e}var c=u.prototype;Object.defineProperty(c,"keys",{get:function(){var t=[];this.forEach(function(e,r){t.push(e)});return t}});Object.defineProperty(c,"values",{get:function(){var t=[];this.forEach(function(e,r){t.push(r)});return t}});Object.defineProperty(c,"length",{get:function(){if(this.root){return this.root._count}return 0}});c.insert=function(t,e){var r=this._compare;var o=this.root;var c=[];var f=[];while(o){var h=r(t,o.key);c.push(o);f.push(h);if(h<=0){o=o.left}else{o=o.right}}c.push(new i(n,t,e,null,null,1));for(var p=c.length-2;p>=0;--p){var o=c[p];if(f[p]<=0){c[p]=new i(o._color,o.key,o.value,c[p+1],o.right,o._count+1)}else{c[p]=new i(o._color,o.key,o.value,o.left,c[p+1],o._count+1)}}for(var p=c.length-1;p>1;--p){var d=c[p-1];var o=c[p];if(d._color===a||o._color===a){break}var v=c[p-2];if(v.left===d){if(d.left===o){var g=v.right;if(g&&g._color===n){d._color=a;v.right=s(a,g);v._color=n;p-=1}else{v._color=n;v.left=d.right;d._color=a;d.right=v;c[p-2]=d;c[p-1]=o;l(v);l(d);if(p>=3){var m=c[p-3];if(m.left===v){m.left=d}else{m.right=d}}break}}else{var g=v.right;if(g&&g._color===n){d._color=a;v.right=s(a,g);v._color=n;p-=1}else{d.right=o.left;v._color=n;v.left=o.right;o._color=a;o.left=d;o.right=v;c[p-2]=o;c[p-1]=d;l(v);l(d);l(o);if(p>=3){var m=c[p-3];if(m.left===v){m.left=o}else{m.right=o}}break}}}else{if(d.right===o){var g=v.left;if(g&&g._color===n){d._color=a;v.left=s(a,g);v._color=n;p-=1}else{v._color=n;v.right=d.left;d._color=a;d.left=v;c[p-2]=d;c[p-1]=o;l(v);l(d);if(p>=3){var m=c[p-3];if(m.right===v){m.right=d}else{m.left=d}}break}}else{var g=v.left;if(g&&g._color===n){d._color=a;v.left=s(a,g);v._color=n;p-=1}else{d.left=o.right;v._color=n;v.right=o.left;o._color=a;o.right=d;o.left=v;c[p-2]=o;c[p-1]=d;l(v);l(d);l(o);if(p>=3){var m=c[p-3];if(m.right===v){m.right=o}else{m.left=o}}break}}}}c[0]._color=a;return new u(r,c[0])};function f(t,e){if(e.left){var r=f(t,e.left);if(r){return r}}var r=t(e.key,e.value);if(r){return r}if(e.right){return f(t,e.right)}}function h(t,e,r,n){var a=e(t,n.key);if(a<=0){if(n.left){var i=h(t,e,r,n.left);if(i){return i}}var i=r(n.key,n.value);if(i){return i}}if(n.right){return h(t,e,r,n.right)}}function p(t,e,r,n,a){var i=r(t,a.key);var o=r(e,a.key);var s;if(i<=0){if(a.left){s=p(t,e,r,n,a.left);if(s){return s}}if(o>0){s=n(a.key,a.value);if(s){return s}}}if(o>0&&a.right){return p(t,e,r,n,a.right)}}c.forEach=function t(e,r,n){if(!this.root){return}switch(arguments.length){case 1:return f(e,this.root);break;case 2:return h(r,this._compare,e,this.root);break;case 3:if(this._compare(r,n)>=0){return}return p(r,n,this._compare,e,this.root);break}};Object.defineProperty(c,"begin",{get:function(){var t=[];var e=this.root;while(e){t.push(e);e=e.left}return new d(this,t)}});Object.defineProperty(c,"end",{get:function(){var t=[];var e=this.root;while(e){t.push(e);e=e.right}return new d(this,t)}});c.at=function(t){if(t<0){return new d(this,[])}var e=this.root;var r=[];while(true){r.push(e);if(e.left){if(t<e.left._count){e=e.left;continue}t-=e.left._count}if(!t){return new d(this,r)}t-=1;if(e.right){if(t>=e.right._count){break}e=e.right}else{break}}return new d(this,[])};c.ge=function(t){var e=this._compare;var r=this.root;var n=[];var a=0;while(r){var i=e(t,r.key);n.push(r);if(i<=0){a=n.length}if(i<=0){r=r.left}else{r=r.right}}n.length=a;return new d(this,n)};c.gt=function(t){var e=this._compare;var r=this.root;var n=[];var a=0;while(r){var i=e(t,r.key);n.push(r);if(i<0){a=n.length}if(i<0){r=r.left}else{r=r.right}}n.length=a;return new d(this,n)};c.lt=function(t){var e=this._compare;var r=this.root;var n=[];var a=0;while(r){var i=e(t,r.key);n.push(r);if(i>0){a=n.length}if(i<=0){r=r.left}else{r=r.right}}n.length=a;return new d(this,n)};c.le=function(t){var e=this._compare;var r=this.root;var n=[];var a=0;while(r){var i=e(t,r.key);n.push(r);if(i>=0){a=n.length}if(i<0){r=r.left}else{r=r.right}}n.length=a;return new d(this,n)};c.find=function(t){var e=this._compare;var r=this.root;var n=[];while(r){var a=e(t,r.key);n.push(r);if(a===0){return new d(this,n)}if(a<=0){r=r.left}else{r=r.right}}return new d(this,[])};c.remove=function(t){var e=this.find(t);if(e){return e.remove()}return this};c.get=function(t){var e=this._compare;var r=this.root;while(r){var n=e(t,r.key);if(n===0){return r.value}if(n<=0){r=r.left}else{r=r.right}}return};function d(t,e){this.tree=t;this._stack=e}var v=d.prototype;Object.defineProperty(v,"valid",{get:function(){return this._stack.length>0}});Object.defineProperty(v,"node",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1]}return null},enumerable:true});v.clone=function(){return new d(this.tree,this._stack.slice())};function g(t,e){t.key=e.key;t.value=e.value;t.left=e.left;t.right=e.right;t._color=e._color;t._count=e._count}function m(t){var e,r,i,u;for(var c=t.length-1;c>=0;--c){e=t[c];if(c===0){e._color=a;return}r=t[c-1];if(r.left===e){i=r.right;if(i.right&&i.right._color===n){i=r.right=o(i);u=i.right=o(i.right);r.right=i.left;i.left=r;i.right=u;i._color=r._color;e._color=a;r._color=a;u._color=a;l(r);l(i);if(c>1){var f=t[c-2];if(f.left===r){f.left=i}else{f.right=i}}t[c-1]=i;return}else if(i.left&&i.left._color===n){i=r.right=o(i);u=i.left=o(i.left);r.right=u.left;i.left=u.right;u.left=r;u.right=i;u._color=r._color;r._color=a;i._color=a;e._color=a;l(r);l(i);l(u);if(c>1){var f=t[c-2];if(f.left===r){f.left=u}else{f.right=u}}t[c-1]=u;return}if(i._color===a){if(r._color===n){r._color=a;r.right=s(n,i);return}else{r.right=s(n,i);continue}}else{i=o(i);r.right=i.left;i.left=r;i._color=r._color;r._color=n;l(r);l(i);if(c>1){var f=t[c-2];if(f.left===r){f.left=i}else{f.right=i}}t[c-1]=i;t[c]=r;if(c+1<t.length){t[c+1]=e}else{t.push(e)}c=c+2}}else{i=r.left;if(i.left&&i.left._color===n){i=r.left=o(i);u=i.left=o(i.left);r.left=i.right;i.right=r;i.left=u;i._color=r._color;e._color=a;r._color=a;u._color=a;l(r);l(i);if(c>1){var f=t[c-2];if(f.right===r){f.right=i}else{f.left=i}}t[c-1]=i;return}else if(i.right&&i.right._color===n){i=r.left=o(i);u=i.right=o(i.right);r.left=u.right;i.right=u.left;u.right=r;u.left=i;u._color=r._color;r._color=a;i._color=a;e._color=a;l(r);l(i);l(u);if(c>1){var f=t[c-2];if(f.right===r){f.right=u}else{f.left=u}}t[c-1]=u;return}if(i._color===a){if(r._color===n){r._color=a;r.left=s(n,i);return}else{r.left=s(n,i);continue}}else{i=o(i);r.left=i.right;i.right=r;i._color=r._color;r._color=n;l(r);l(i);if(c>1){var f=t[c-2];if(f.right===r){f.right=i}else{f.left=i}}t[c-1]=i;t[c]=r;if(c+1<t.length){t[c+1]=e}else{t.push(e)}c=c+2}}}}v.remove=function(){var t=this._stack;if(t.length===0){return this.tree}var e=new Array(t.length);var r=t[t.length-1];e[e.length-1]=new i(r._color,r.key,r.value,r.left,r.right,r._count);for(var o=t.length-2;o>=0;--o){var r=t[o];if(r.left===t[o+1]){e[o]=new i(r._color,r.key,r.value,e[o+1],r.right,r._count)}else{e[o]=new i(r._color,r.key,r.value,r.left,e[o+1],r._count)}}r=e[e.length-1];if(r.left&&r.right){var s=e.length;r=r.left;while(r.right){e.push(r);r=r.right}var l=e[s-1];e.push(new i(r._color,l.key,l.value,r.left,r.right,r._count));e[s-1].key=r.key;e[s-1].value=r.value;for(var o=e.length-2;o>=s;--o){r=e[o];e[o]=new i(r._color,r.key,r.value,r.left,e[o+1],r._count)}e[s-1].left=e[s]}r=e[e.length-1];if(r._color===n){var c=e[e.length-2];if(c.left===r){c.left=null}else if(c.right===r){c.right=null}e.pop();for(var o=0;o<e.length;++o){e[o]._count--}return new u(this.tree._compare,e[0])}else{if(r.left||r.right){if(r.left){g(r,r.left)}else if(r.right){g(r,r.right)}r._color=a;for(var o=0;o<e.length-1;++o){e[o]._count--}return new u(this.tree._compare,e[0])}else if(e.length===1){return new u(this.tree._compare,null)}else{for(var o=0;o<e.length;++o){e[o]._count--}var f=e[e.length-2];m(e);if(f.left===r){f.left=null}else{f.right=null}}}return new u(this.tree._compare,e[0])};Object.defineProperty(v,"key",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1].key}return},enumerable:true});Object.defineProperty(v,"value",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1].value}return},enumerable:true});Object.defineProperty(v,"index",{get:function(){var t=0;var e=this._stack;if(e.length===0){var r=this.tree.root;if(r){return r._count}return 0}else if(e[e.length-1].left){t=e[e.length-1].left._count}for(var n=e.length-2;n>=0;--n){if(e[n+1]===e[n].right){++t;if(e[n].left){t+=e[n].left._count}}}return t},enumerable:true});v.next=function(){var t=this._stack;if(t.length===0){return}var e=t[t.length-1];if(e.right){e=e.right;while(e){t.push(e);e=e.left}}else{t.pop();while(t.length>0&&t[t.length-1].right===e){e=t[t.length-1];t.pop()}}};Object.defineProperty(v,"hasNext",{get:function(){var t=this._stack;if(t.length===0){return false}if(t[t.length-1].right){return true}for(var e=t.length-1;e>0;--e){if(t[e-1].left===t[e]){return true}}return false}});v.update=function(t){var e=this._stack;if(e.length===0){throw new Error("Can't update empty node!")}var r=new Array(e.length);var n=e[e.length-1];r[r.length-1]=new i(n._color,n.key,t,n.left,n.right,n._count);for(var a=e.length-2;a>=0;--a){n=e[a];if(n.left===e[a+1]){r[a]=new i(n._color,n.key,n.value,r[a+1],n.right,n._count)}else{r[a]=new i(n._color,n.key,n.value,n.left,r[a+1],n._count)}}return new u(this.tree._compare,r[0])};v.prev=function(){var t=this._stack;if(t.length===0){return}var e=t[t.length-1];if(e.left){e=e.left;while(e){t.push(e);e=e.right}}else{t.pop();while(t.length>0&&t[t.length-1].left===e){e=t[t.length-1];t.pop()}}};Object.defineProperty(v,"hasPrev",{get:function(){var t=this._stack;if(t.length===0){return false}if(t[t.length-1].left){return true}for(var e=t.length-1;e>0;--e){if(t[e-1].right===t[e]){return true}}return false}});function y(t,e){if(t<e){return-1}if(t>e){return 1}return 0}function x(t){return new u(t||y,null)}},{}],220:[function(t,e,r){var n=7;var a=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];var i=607/128;var o=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function s(t){if(t<0)return Number("0/0");var e=o[0];for(var r=o.length-1;r>0;--r)e+=o[r]/(t+r);var n=t+i+.5;return.5*Math.log(2*Math.PI)+(t+.5)*Math.log(n)-n+Math.log(e)-Math.log(t)}e.exports=function t(e){if(e<.5){return Math.PI/(Math.sin(Math.PI*e)*t(1-e))}else if(e>100)return Math.exp(s(e));else{e-=1;var r=a[0];for(var i=1;i<n+2;i++){r+=a[i]/(e+i)}var o=e+n+.5;return Math.sqrt(2*Math.PI)*Math.pow(o,e+.5)*Math.exp(-o)*r}};e.exports.log=s},{}],221:[function(t,e,r){e.exports=n;function n(t,e){if(typeof t!=="string"){throw new TypeError("must specify type string")}e=e||{};if(typeof document==="undefined"&&!e.canvas){return null}var r=e.canvas||document.createElement("canvas");if(typeof e.width==="number"){r.width=e.width}if(typeof e.height==="number"){r.height=e.height}var n=e;var a;try{var i=[t];if(t.indexOf("webgl")===0){i.push("experimental-"+t)}for(var o=0;o<i.length;o++){a=r.getContext(i[o],n);if(a)return a}}catch(t){a=null}return a||null}},{}],222:[function(t,e,r){"use strict";e.exports=b;var n=t("./lib/text.js");var a=t("./lib/lines.js");var i=t("./lib/background.js");var o=t("./lib/cube.js");var s=t("./lib/ticks.js");var l=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function u(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];return t}function c(t){this.gl=t;this.pixelRatio=1;this.bounds=[[-10,-10,-10],[10,10,10]];this.ticks=[[],[],[]];this.autoTicks=true;this.tickSpacing=[1,1,1];this.tickEnable=[true,true,true];this.tickFont=["sans-serif","sans-serif","sans-serif"];this.tickSize=[12,12,12];this.tickAngle=[0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[10,10,10];this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]};this.labels=["x","y","z"];this.labelEnable=[true,true,true];this.labelFont="sans-serif";this.labelSize=[20,20,20];this.labelAngle=[0,0,0];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[10,10,10];this.lineEnable=[true,true,true];this.lineMirror=[false,false,false];this.lineWidth=[1,1,1];this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.lineTickEnable=[true,true,true];this.lineTickMirror=[false,false,false];this.lineTickLength=[0,0,0];this.lineTickWidth=[1,1,1];this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.gridEnable=[true,true,true];this.gridWidth=[1,1,1];this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroEnable=[true,true,true];this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroLineWidth=[2,2,2];this.backgroundEnable=[false,false,false];this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this._firstInit=true;this._text=null;this._lines=null;this._background=i(t)}var f=c.prototype;f.update=function(t){t=t||{};function e(e,r,n){if(n in t){var a=t[n];var i=this[n];var o;if(e?Array.isArray(a)&&Array.isArray(a[0]):Array.isArray(a)){this[n]=o=[r(a[0]),r(a[1]),r(a[2])]}else{this[n]=o=[r(a),r(a),r(a)]}for(var s=0;s<3;++s){if(o[s]!==i[s]){return true}}}return false}var r=e.bind(this,false,Number);var i=e.bind(this,false,Boolean);var o=e.bind(this,false,String);var l=e.bind(this,true,function(t){if(Array.isArray(t)){if(t.length===3){return[+t[0],+t[1],+t[2],1]}else if(t.length===4){return[+t[0],+t[1],+t[2],+t[3]]}}return[0,0,0,1]});var u;var c=false;var f=false;if("bounds"in t){var h=t.bounds;t:for(var p=0;p<2;++p){for(var d=0;d<3;++d){if(h[p][d]!==this.bounds[p][d]){f=true}this.bounds[p][d]=h[p][d]}}}if("ticks"in t){u=t.ticks;c=true;this.autoTicks=false;for(var p=0;p<3;++p){this.tickSpacing[p]=0}}else if(r("tickSpacing")){this.autoTicks=true;f=true}if(this._firstInit){if(!("ticks"in t||"tickSpacing"in t)){this.autoTicks=true}f=true;c=true;this._firstInit=false}if(f&&this.autoTicks){u=s.create(this.bounds,this.tickSpacing);c=true}if(c){for(var p=0;p<3;++p){u[p].sort(function(t,e){return t.x-e.x})}if(s.equal(u,this.ticks)){c=false}else{this.ticks=u}}i("tickEnable");if(o("tickFont")){c=true}r("tickSize");r("tickAngle");r("tickPad");l("tickColor");var v=o("labels");if(o("labelFont")){v=true}i("labelEnable");r("labelSize");r("labelPad");l("labelColor");i("lineEnable");i("lineMirror");r("lineWidth");l("lineColor");i("lineTickEnable");i("lineTickMirror");r("lineTickLength");r("lineTickWidth");l("lineTickColor");i("gridEnable");r("gridWidth");l("gridColor");i("zeroEnable");l("zeroLineColor");r("zeroLineWidth");i("backgroundEnable");l("backgroundColor");if(!this._text){this._text=n(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont)}else if(this._text&&(v||c)){this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont)}if(this._lines&&c){this._lines.dispose();this._lines=null}if(!this._lines){this._lines=a(this.gl,this.bounds,this.ticks)}};function h(){this.primalOffset=[0,0,0];this.primalMinor=[0,0,0];this.mirrorOffset=[0,0,0];this.mirrorMinor=[0,0,0]}var p=[new h,new h,new h];function d(t,e,r,n,a){var i=t.primalOffset;var o=t.primalMinor;var s=t.mirrorOffset;var l=t.mirrorMinor;var u=n[e];for(var c=0;c<3;++c){if(e===c){continue}var f=i,h=s,p=o,d=l;if(u&1<<c){f=s;h=i;p=l;d=o}f[c]=r[0][c];h[c]=r[1][c];if(a[c]>0){p[c]=-1;d[c]=0}else{p[c]=0;d[c]=+1}}}var v=[0,0,0];var g={model:l,view:l,projection:l};f.isOpaque=function(){return true};f.isTransparent=function(){return false};f.drawTransparent=function(t){};var m=[0,0,0];var y=[0,0,0];var x=[0,0,0];f.draw=function(t){t=t||g;var e=this.gl;var r=t.model||l;var n=t.view||l;var a=t.projection||l;var i=this.bounds;var s=o(r,n,a,i);var c=s.cubeEdges;var f=s.axis;var h=n[12];var b=n[13];var _=n[14];var w=n[15];var k=this.pixelRatio*(a[3]*h+a[7]*b+a[11]*_+a[15]*w)/e.drawingBufferHeight;for(var M=0;M<3;++M){this.lastCubeProps.cubeEdges[M]=c[M];this.lastCubeProps.axis[M]=f[M]}var A=p;for(var M=0;M<3;++M){d(p[M],M,this.bounds,c,f)}var e=this.gl;var T=v;for(var M=0;M<3;++M){if(this.backgroundEnable[M]){T[M]=f[M]}else{T[M]=0}}this._background.draw(r,n,a,i,T,this.backgroundColor);this._lines.bind(r,n,a,this);for(var M=0;M<3;++M){var S=[0,0,0];if(f[M]>0){S[M]=i[1][M]}else{S[M]=i[0][M]}for(var E=0;E<2;++E){var C=(M+1+E)%3;var L=(M+1+(E^1))%3;if(this.gridEnable[C]){this._lines.drawGrid(C,L,this.bounds,S,this.gridColor[C],this.gridWidth[C]*this.pixelRatio)}}for(var E=0;E<2;++E){var C=(M+1+E)%3;var L=(M+1+(E^1))%3;if(this.zeroEnable[L]){if(i[0][L]<=0&&i[1][L]>=0){this._lines.drawZero(C,L,this.bounds,S,this.zeroLineColor[L],this.zeroLineWidth[L]*this.pixelRatio)}}}}for(var M=0;M<3;++M){if(this.lineEnable[M]){this._lines.drawAxisLine(M,this.bounds,A[M].primalOffset,this.lineColor[M],this.lineWidth[M]*this.pixelRatio)}if(this.lineMirror[M]){this._lines.drawAxisLine(M,this.bounds,A[M].mirrorOffset,this.lineColor[M],this.lineWidth[M]*this.pixelRatio)}var I=u(m,A[M].primalMinor);var z=u(y,A[M].mirrorMinor);var P=this.lineTickLength;var O=0;for(var E=0;E<3;++E){var D=k/r[5*E];I[E]*=P[E]*D;z[E]*=P[E]*D}if(this.lineTickEnable[M]){this._lines.drawAxisTicks(M,A[M].primalOffset,I,this.lineTickColor[M],this.lineTickWidth[M]*this.pixelRatio)}if(this.lineTickMirror[M]){this._lines.drawAxisTicks(M,A[M].mirrorOffset,z,this.lineTickColor[M],this.lineTickWidth[M]*this.pixelRatio)}}this._lines.unbind();this._text.bind(r,n,a,this.pixelRatio);for(var M=0;M<3;++M){var R=A[M].primalMinor;var B=u(x,A[M].primalOffset);for(var E=0;E<3;++E){if(this.lineTickEnable[M]){B[E]+=k*R[E]*Math.max(this.lineTickLength[E],0)/r[5*E]}}if(this.tickEnable[M]){for(var E=0;E<3;++E){B[E]+=k*R[E]*this.tickPad[E]/r[5*E]}this._text.drawTicks(M,this.tickSize[M],this.tickAngle[M],B,this.tickColor[M])}if(this.labelEnable[M]){for(var E=0;E<3;++E){B[E]+=k*R[E]*this.labelPad[E]/r[5*E]}B[M]+=.5*(i[0][M]+i[1][M]);this._text.drawLabel(M,this.labelSize[M],this.labelAngle[M],B,this.labelColor[M])}}this._text.unbind()};f.dispose=function(){this._text.dispose();this._lines.dispose();this._background.dispose();this._lines=null;this._text=null;this._background=null;this.gl=null};function b(t,e){var r=new c(t);r.update(e);return r}},{"./lib/background.js":223,"./lib/cube.js":224,"./lib/lines.js":225,"./lib/text.js":227,"./lib/ticks.js":228}],223:[function(t,e,r){"use strict";e.exports=l;var n=t("gl-buffer");var a=t("gl-vao");var i=t("./shaders").bg;function o(t,e,r,n){this.gl=t;this.buffer=e;this.vao=r;this.shader=n}var s=o.prototype;s.draw=function(t,e,r,n,a,i){var o=false;for(var s=0;s<3;++s){o=o||a[s]}if(!o){return}var l=this.gl;l.enable(l.POLYGON_OFFSET_FILL);l.polygonOffset(1,2);this.shader.bind();this.shader.uniforms={model:t,view:e,projection:r,bounds:n,enable:a,colors:i};this.vao.bind();this.vao.draw(this.gl.TRIANGLES,36);this.vao.unbind();l.disable(l.POLYGON_OFFSET_FILL)};s.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()};function l(t){var e=[];var r=[];var s=0;for(var l=0;l<3;++l){var u=(l+1)%3;var c=(l+2)%3;var f=[0,0,0];var h=[0,0,0];for(var p=-1;p<=1;p+=2){r.push(s,s+2,s+1,s+1,s+2,s+3);f[l]=p;h[l]=p;for(var d=-1;d<=1;d+=2){f[u]=d;for(var v=-1;v<=1;v+=2){f[c]=v;e.push(f[0],f[1],f[2],h[0],h[1],h[2]);s+=1}}var g=u;u=c;c=g}}var m=n(t,new Float32Array(e));var y=n(t,new Uint16Array(r),t.ELEMENT_ARRAY_BUFFER);var x=a(t,[{buffer:m,type:t.FLOAT,size:3,offset:0,stride:24},{buffer:m,type:t.FLOAT,size:3,offset:12,stride:24}],y);var b=i(t);b.attributes.position.location=0;b.attributes.normal.location=1;return new o(t,m,x,b)}},{"./shaders":226,"gl-buffer":230,"gl-vao":308}],224:[function(t,e,r){"use strict";e.exports=b;var n=t("bit-twiddle");var a=t("gl-mat4/multiply");var i=t("gl-mat4/invert");var o=t("split-polygon");var s=t("robust-orientation");var l=new Array(16);var u=new Array(16);var c=new Array(8);var f=new Array(8);var h=new Array(3);var p=[0,0,0];(function(){for(var t=0;t<8;++t){c[t]=[1,1,1,1];f[t]=[1,1,1]}})();function d(t,e,r){for(var n=0;n<4;++n){t[n]=r[12+n];for(var a=0;a<3;++a){t[n]+=e[a]*r[4*a+n]}}}var v=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function g(t){for(var e=0;e<v.length;++e){t=o.positive(t,v[e]);if(t.length<3){return 0}}var r=t[0];var n=r[0]/r[3];var a=r[1]/r[3];var i=0;for(var e=1;e+1<t.length;++e){var s=t[e];var l=t[e+1];var u=s[0]/s[3];var c=s[1]/s[3];var f=l[0]/l[3];var h=l[1]/l[3];var p=u-n;var d=c-a;var g=f-n;var m=h-a;i+=Math.abs(p*m-d*g)}return i}var m=[1,1,1];var y=[0,0,0];var x={cubeEdges:m,axis:y};function b(t,e,r,i){a(l,e,t);a(l,r,l);var o=0;for(var u=0;u<2;++u){h[2]=i[u][2];for(var v=0;v<2;++v){h[1]=i[v][1];for(var b=0;b<2;++b){h[0]=i[b][0];d(c[o],h,l);o+=1}}}var _=-1;for(var u=0;u<8;++u){var w=c[u][3];for(var k=0;k<3;++k){f[u][k]=c[u][k]/w}if(w<0){if(_<0){_=u}else if(f[u][2]<f[_][2]){_=u}}}if(_<0){_=0;for(var M=0;M<3;++M){var A=(M+2)%3;var T=(M+1)%3;var S=-1;var E=-1;for(var C=0;C<2;++C){var L=C<<M;var I=L+(C<<A)+(1-C<<T);var z=L+(1-C<<A)+(C<<T);if(s(f[L],f[I],f[z],p)<0){continue}if(C){S=1}else{E=1}}if(S<0||E<0){if(E>S){_|=1<<M}continue}for(var C=0;C<2;++C){var L=C<<M;var I=L+(C<<A)+(1-C<<T);var z=L+(1-C<<A)+(C<<T);var P=g([c[L],c[I],c[z],c[L+(1<<A)+(1<<T)]]);if(C){S=P}else{E=P}}if(E>S){_|=1<<M;continue}}}var O=7^_;var D=-1;for(var u=0;u<8;++u){if(u===_||u===O){continue}if(D<0){D=u}else if(f[D][1]>f[u][1]){D=u}}var R=-1;for(var u=0;u<3;++u){var B=D^1<<u;if(B===_||B===O){continue}if(R<0){R=B}var T=f[B];if(T[0]<f[R][0]){R=B}}var F=-1;for(var u=0;u<3;++u){var B=D^1<<u;if(B===_||B===O||B===R){continue}if(F<0){F=B}var T=f[B];if(T[0]>f[F][0]){F=B}}var N=m;N[0]=N[1]=N[2]=0;N[n.log2(R^D)]=D&R;N[n.log2(D^F)]=D&F;var j=F^7;if(j===_||j===O){j=R^7;N[n.log2(F^j)]=j&F}else{N[n.log2(R^j)]=j&R}var V=y;var U=_;for(var M=0;M<3;++M){if(U&1<<M){V[M]=-1}else{V[M]=1}}return x}},{"bit-twiddle":80,"gl-mat4/invert":254,"gl-mat4/multiply":256,"robust-orientation":471,"split-polygon":488}],225:[function(t,e,r){"use strict";e.exports=v;var n=t("gl-buffer");var a=t("gl-vao");var i=t("./shaders").line;var o=[0,0,0];var s=[0,0,0];var l=[0,0,0];var u=[0,0,0];var c=[1,1];function f(t){t[0]=t[1]=t[2]=0;return t}function h(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];return t}function p(t,e,r,n,a,i,o,s){this.gl=t;this.vertBuffer=e;this.vao=r;this.shader=n;this.tickCount=a;this.tickOffset=i;this.gridCount=o;this.gridOffset=s}var d=p.prototype;d.bind=function(t,e,r){this.shader.bind();this.shader.uniforms.model=t;this.shader.uniforms.view=e;this.shader.uniforms.projection=r;c[0]=this.gl.drawingBufferWidth;c[1]=this.gl.drawingBufferHeight;this.shader.uniforms.screenShape=c;this.vao.bind()};d.unbind=function(){this.vao.unbind()};d.drawAxisLine=function(t,e,r,n,a){var i=f(s);this.shader.uniforms.majorAxis=s;i[t]=e[1][t]-e[0][t];this.shader.uniforms.minorAxis=i;var o=h(u,r);o[t]+=e[0][t];this.shader.uniforms.offset=o;this.shader.uniforms.lineWidth=a;this.shader.uniforms.color=n;var c=f(l);c[(t+2)%3]=1;this.shader.uniforms.screenAxis=c;this.vao.draw(this.gl.TRIANGLES,6);var c=f(l);c[(t+1)%3]=1;this.shader.uniforms.screenAxis=c;this.vao.draw(this.gl.TRIANGLES,6)};d.drawAxisTicks=function(t,e,r,n,a){if(!this.tickCount[t]){return}var i=f(o);i[t]=1;this.shader.uniforms.majorAxis=i;this.shader.uniforms.offset=e;this.shader.uniforms.minorAxis=r;this.shader.uniforms.color=n;this.shader.uniforms.lineWidth=a;var s=f(l);s[t]=1;this.shader.uniforms.screenAxis=s;this.vao.draw(this.gl.TRIANGLES,this.tickCount[t],this.tickOffset[t])};d.drawGrid=function(t,e,r,n,a,i){if(!this.gridCount[t]){return}var c=f(s);c[e]=r[1][e]-r[0][e];this.shader.uniforms.minorAxis=c;var p=h(u,n);p[e]+=r[0][e];this.shader.uniforms.offset=p;var d=f(o);d[t]=1;this.shader.uniforms.majorAxis=d;var v=f(l);v[t]=1;this.shader.uniforms.screenAxis=v;this.shader.uniforms.lineWidth=i;this.shader.uniforms.color=a;this.vao.draw(this.gl.TRIANGLES,this.gridCount[t],this.gridOffset[t])};d.drawZero=function(t,e,r,n,a,i){var o=f(s);this.shader.uniforms.majorAxis=o;o[t]=r[1][t]-r[0][t];this.shader.uniforms.minorAxis=o;var c=h(u,n);c[t]+=r[0][t];this.shader.uniforms.offset=c;var p=f(l);p[e]=1;this.shader.uniforms.screenAxis=p;this.shader.uniforms.lineWidth=i;this.shader.uniforms.color=a;this.vao.draw(this.gl.TRIANGLES,6)};d.dispose=function(){this.vao.dispose();this.vertBuffer.dispose();this.shader.dispose()};function v(t,e,r){var o=[];var s=[0,0,0];var l=[0,0,0];var u=[0,0,0];var c=[0,0,0];o.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var f=0;f<3;++f){var h=o.length/3|0;for(var d=0;d<r[f].length;++d){var v=+r[f][d].x;o.push(v,0,1,v,1,1,v,0,-1,v,0,-1,v,1,1,v,1,-1)}var g=o.length/3|0;s[f]=h;l[f]=g-h;var h=o.length/3|0;for(var m=0;m<r[f].length;++m){var v=+r[f][m].x;o.push(v,0,1,v,1,1,v,0,-1,v,0,-1,v,1,1,v,1,-1)}var g=o.length/3|0;u[f]=h;c[f]=g-h}var y=n(t,new Float32Array(o));var x=a(t,[{buffer:y,type:t.FLOAT,size:3,stride:0,offset:0}]);var b=i(t);b.attributes.position.location=0;return new p(t,y,x,b,l,s,c,u)}},{"./shaders":226,"gl-buffer":230,"gl-vao":308}],226:[function(t,e,r){"use strict";var n=t("glslify");var a=t("gl-shader");var i=n(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);r.line=function(t){return a(t,i,o,null,[{name:"position",type:"vec3"}])};var s=n(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvoid main() {  \n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n  mat2 planeXform = scale * mat2(cos(angle), sin(angle),\n                                -sin(angle), cos(angle));\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n  vec4 worldPosition = model * vec4(dataPosition, 1);\n  \n  //Compute clip position\n  vec4 viewPosition = view * worldPosition;\n  vec4 clipPosition = projection * viewPosition;\n  clipPosition /= clipPosition.w;\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec4(viewOffset, 0, 0);\n\n  //Done\n  gl_Position = clipPosition;\n}"]);var l=n(["precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);r.text=function(t){return a(t,s,l,null,[{name:"position",type:"vec3"}])};var u=n(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  if(dot(normal, enable) > 0.0) {\n    vec3 nPosition = mix(bounds[0], bounds[1], 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n  colorChannel = abs(normal);\n}"]);var c=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] + \n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);r.bg=function(t){return a(t,u,c,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":287,glslify:377}],227:[function(t,e,r){(function(r){"use strict";e.exports=m;var n=t("gl-buffer");var a=t("gl-vao");var i=t("vectorize-text");var o=t("./shaders").text;var s=window||r.global||{};var l=s.__TEXT_CACHE||{};s.__TEXT_CACHE={};var u=3;var c=u*4;function f(t,e,r,n){this.gl=t;this.shader=e;this.buffer=r;this.vao=n;this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var h=f.prototype;var p=[0,0];h.bind=function(t,e,r,n){this.vao.bind();this.shader.bind();var a=this.shader.uniforms;a.model=t;a.view=e;a.projection=r;a.pixelScale=n;p[0]=this.gl.drawingBufferWidth;p[1]=this.gl.drawingBufferHeight;this.shader.uniforms.resolution=p};h.unbind=function(){this.vao.unbind()};h.update=function(t,e,r,n,a){var i=this.gl;var o=[];function s(t,e,r,n){var a=l[r];if(!a){a=l[r]={}}var i=a[e];if(!i){i=a[e]=g(e,{triangles:true,font:r,textAlign:"center",textBaseline:"middle"})}var s=(n||12)/12;var u=i.positions;var c=i.cells;var f=[Infinity,Infinity];var h=[-Infinity,-Infinity];for(var p=0,d=c.length;p<d;++p){var v=c[p];for(var m=2;m>=0;--m){var y=u[v[m]];o.push(s*y[0],-s*y[1],t)}}}var c=[0,0,0];var f=[0,0,0];var h=[0,0,0];var p=[0,0,0];for(var d=0;d<3;++d){h[d]=o.length/u|0;s(.5*(t[0][d]+t[1][d]),e[d],r);p[d]=(o.length/u|0)-h[d];c[d]=o.length/u|0;for(var v=0;v<n[d].length;++v){if(!n[d][v].text){continue}s(n[d][v].x,n[d][v].text,n[d][v].font||a,n[d][v].fontSize||12)}f[d]=(o.length/u|0)-c[d]}this.buffer.update(o);this.tickOffset=c;this.tickCount=f;this.labelOffset=h;this.labelCount=p};var d=[0,0,0];h.drawTicks=function(t,e,r,n,a){if(!this.tickCount[t]){return}var i=d;i[0]=i[1]=i[2]=0;i[t]=1;this.shader.uniforms.axis=i;this.shader.uniforms.color=a;this.shader.uniforms.angle=r;this.shader.uniforms.scale=e;this.shader.uniforms.offset=n;this.vao.draw(this.gl.TRIANGLES,this.tickCount[t],this.tickOffset[t])};var v=[0,0,0];h.drawLabel=function(t,e,r,n,a){if(!this.labelCount[t]){return}this.shader.uniforms.axis=v;this.shader.uniforms.color=a;this.shader.uniforms.angle=r;this.shader.uniforms.scale=e;this.shader.uniforms.offset=n;this.vao.draw(this.gl.TRIANGLES,this.labelCount[t],this.labelOffset[t])};h.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()};function g(t,e){try{return i(t,e)}catch(t){console.warn("error vectorizing text:",t);return{cells:[],positions:[]}}}function m(t,e,r,i,s,l){var u=n(t);var c=a(t,[{buffer:u,size:3}]);var h=o(t);h.attributes.position.location=0;var p=new f(t,h,u,c);p.update(e,r,i,s,l);return p}}).call(this,t("_process"))},{"./shaders":226,_process:449,"gl-buffer":230,"gl-vao":308,"vectorize-text":515}],228:[function(t,e,r){"use strict";r.create=a;r.equal=i;function n(t,e){var r=t+"";var n=r.indexOf(".");var a=0;if(n>=0){a=r.length-n-1}var i=Math.pow(10,a);var o=Math.round(t*e*i);var s=o+"";if(s.indexOf("e")>=0){return s}var l=o/i,u=o%i;if(o<0){l=-Math.ceil(l)|0;u=-u|0}else{l=Math.floor(l)|0;u=u|0}var c=""+l;if(o<0){c="-"+c}if(a){var f=""+u;while(f.length<a){f="0"+f}return c+"."+f}else{return c}}function a(t,e){var r=[];for(var a=0;a<3;++a){var i=[];var o=.5*(t[0][a]+t[1][a]);for(var s=0;s*e[a]<=t[1][a];++s){i.push({x:s*e[a],text:n(e[a],s)})}for(var s=-1;s*e[a]>=t[0][a];--s){i.push({x:s*e[a],text:n(e[a],s)})}r.push(i)}return r}function i(t,e){for(var r=0;r<3;++r){if(t[r].length!==e[r].length){return false}for(var n=0;n<t[r].length;++n){var a=t[r][n];var i=e[r][n];if(a.x!==i.x||a.text!==i.text||a.font!==i.font||a.fontColor!==i.fontColor||a.fontSize!==i.fontSize||a.dx!==i.dx||a.dy!==i.dy){return false}}}return true}},{}],229:[function(t,e,r){"use strict";e.exports=m;var n=t("extract-frustum-planes");var a=t("split-polygon");var i=t("./lib/cube.js");var o=t("gl-mat4/multiply");var s=t("gl-mat4/transpose");var l=t("gl-vec4/transformMat4");var u=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);var c=new Float32Array(16);function f(t,e,r){this.lo=t;this.hi=e;this.pixelsPerDataUnit=r}var h=[0,0,0,1];var p=[0,0,0,1];function d(t,e,r,n,a){for(var i=0;i<3;++i){var o=h;var s=p;for(var u=0;u<3;++u){s[u]=o[u]=r[u]}s[3]=o[3]=1;s[i]+=1;l(s,s,e);if(s[3]<0){t[i]=Infinity}o[i]-=1;l(o,o,e);if(o[3]<0){t[i]=Infinity}var c=(o[0]/o[3]-s[0]/s[3])*n;var f=(o[1]/o[3]-s[1]/s[3])*a;t[i]=.25*Math.sqrt(c*c+f*f)}return t}var v=[new f(Infinity,-Infinity,Infinity),new f(Infinity,-Infinity,Infinity),new f(Infinity,-Infinity,Infinity)];var g=[0,0,0];function m(t,e,r,l,f){var h=e.model||u;var p=e.view||u;var m=e.projection||u;var y=t.bounds;var f=f||i(h,p,m,y);var x=f.axis;var b=f.edges;o(c,p,h);o(c,m,c);var _=v;for(var w=0;w<3;++w){_[w].lo=Infinity;_[w].hi=-Infinity;_[w].pixelsPerDataUnit=Infinity}var k=n(s(c,c));s(c,c);for(var M=0;M<3;++M){var A=(M+1)%3;var T=(M+2)%3;var S=g;t:for(var w=0;w<2;++w){var E=[];if(x[M]<0===!!w){continue}S[M]=y[w][M];for(var C=0;C<2;++C){S[A]=y[C^w][A];for(var L=0;L<2;++L){S[T]=y[L^C^w][T];E.push(S.slice())}}for(var C=0;C<k.length;++C){if(E.length===0){continue t}E=a.positive(E,k[C])}for(var C=0;C<E.length;++C){var T=E[C];var I=d(g,c,T,r,l);for(var L=0;L<3;++L){_[L].lo=Math.min(_[L].lo,T[L]);_[L].hi=Math.max(_[L].hi,T[L]);if(L!==M){_[L].pixelsPerDataUnit=Math.min(_[L].pixelsPerDataUnit,Math.abs(I[L]))}}}}}return _}},{"./lib/cube.js":224,"extract-frustum-planes":213,"gl-mat4/multiply":256,"gl-mat4/transpose":264,"gl-vec4/transformMat4":366,"split-polygon":488}],230:[function(t,e,r){"use strict";var n=t("typedarray-pool");var a=t("ndarray-ops");var i=t("ndarray");var o=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function s(t,e,r,n,a){this.gl=t;this.type=e;this.handle=r;this.length=n;this.usage=a}var l=s.prototype;l.bind=function(){this.gl.bindBuffer(this.type,this.handle)};l.unbind=function(){this.gl.bindBuffer(this.type,null)};l.dispose=function(){this.gl.deleteBuffer(this.handle)};function u(t,e,r,n,a,i){var o=a.length*a.BYTES_PER_ELEMENT;if(i<0){t.bufferData(e,a,n);return o}if(o+i>r){throw new Error("gl-buffer: If resizing buffer, must not specify offset")}t.bufferSubData(e,i,a);return r}function c(t,e){var r=n.malloc(t.length,e);var a=t.length;for(var i=0;i<a;++i){r[i]=t[i]}return r}function f(t,e){var r=1;for(var n=e.length-1;n>=0;--n){if(e[n]!==r){return false}r*=t[n]}return true}l.update=function(t,e){if(typeof e!=="number"){e=-1}this.bind();if(typeof t==="object"&&typeof t.shape!=="undefined"){var r=t.dtype;if(o.indexOf(r)<0){r="float32"}if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){var s=gl.getExtension("OES_element_index_uint");if(s&&r!=="uint16"){r="uint32"}else{r="uint16"}}if(r===t.dtype&&f(t.shape,t.stride)){if(t.offset===0&&t.data.length===t.shape[0]){this.length=u(this.gl,this.type,this.length,this.usage,t.data,e)}else{this.length=u(this.gl,this.type,this.length,this.usage,t.data.subarray(t.offset,t.shape[0]),e)}}else{var l=n.malloc(t.size,r);var h=i(l,t.shape);a.assign(h,t);if(e<0){this.length=u(this.gl,this.type,this.length,this.usage,l,e)}else{this.length=u(this.gl,this.type,this.length,this.usage,l.subarray(0,t.size),e)}n.free(l)}}else if(Array.isArray(t)){var p;if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){p=c(t,"uint16")}else{p=c(t,"float32")}if(e<0){this.length=u(this.gl,this.type,this.length,this.usage,p,e)}else{this.length=u(this.gl,this.type,this.length,this.usage,p.subarray(0,t.length),e)}n.free(p)}else if(typeof t==="object"&&typeof t.length==="number"){this.length=u(this.gl,this.type,this.length,this.usage,t,e)}else if(typeof t==="number"||t===undefined){if(e>=0){throw new Error("gl-buffer: Cannot specify offset when resizing buffer")}t=t|0;if(t<=0){t=1}this.gl.bufferData(this.type,t|0,this.usage);this.length=t}else{throw new Error("gl-buffer: Invalid data type")}};function h(t,e,r,n){r=r||t.ARRAY_BUFFER;n=n||t.DYNAMIC_DRAW;if(r!==t.ARRAY_BUFFER&&r!==t.ELEMENT_ARRAY_BUFFER){throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER")}if(n!==t.DYNAMIC_DRAW&&n!==t.STATIC_DRAW&&n!==t.STREAM_DRAW){throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW")}var a=t.createBuffer();var i=new s(t,r,a,0,n);i.update(e);return i}e.exports=h},{ndarray:417,"ndarray-ops":411,"typedarray-pool":507}],231:[function(t,e,r){"use strict";var n=t("gl-vec3");var a=t("gl-vec4");var i=function(t,e,r){var a=n.create();if(t!==undefined){n.set(a,t,e,r)}return a};var o=function(t){var e=t[0],r=t[1],n=t[2];var a=[];for(var i=0;i<n.length;i++){for(var o=0;o<r.length;o++){for(var s=0;s<e.length;s++){a.push([n[i],r[o],e[s]])}}}return a};var s=function(t,e){for(var r=0;r<t.length;r++){if(t[r]>=e){return r-1}}return r};var l=n.create();var u=n.create();var c=function(t,e,r){return t<e?e:t>r?r:t};var f=function(t,e,r,a){var i=t[0];var o=t[1];var f=t[2];var h=r[0].length;var p=r[1].length;var d=r[2].length;var v=s(r[0],i);var g=s(r[1],o);var m=s(r[2],f);var y=v+1;var x=g+1;var b=m+1;if(a){v=c(v,0,h-1);y=c(y,0,h-1);g=c(g,0,p-1);x=c(x,0,p-1);m=c(m,0,d-1);b=c(b,0,d-1)}if(v<0||g<0||m<0||y>=h||x>=p||b>=d){return n.create()}var _=(i-r[0][v])/(r[0][y]-r[0][v]);var w=(o-r[1][g])/(r[1][x]-r[1][g]);var k=(f-r[2][m])/(r[2][b]-r[2][m]);if(_<0||_>1||isNaN(_))_=0;if(w<0||w>1||isNaN(w))w=0;if(k<0||k>1||isNaN(k))k=0;var M=m*h*p;var A=b*h*p;var T=g*h;var S=x*h;var E=v;var C=y;var L=e[T+M+E];var I=e[T+M+C];var z=e[S+M+E];var P=e[S+M+C];var O=e[T+A+E];var D=e[T+A+C];var R=e[S+A+E];var B=e[S+A+C];var F=n.create();n.lerp(F,L,I,_);n.lerp(l,z,P,_);n.lerp(F,F,l,w);n.lerp(l,O,D,_);n.lerp(u,R,B,_);n.lerp(l,l,u,w);n.lerp(F,F,l,k);return F};var h=function(t,e){if(e[0]===0&&e[1]===0){n.set(t,0,1,0)}else{n.set(t,-e[1],e[0],0)}return t};e.exports=function(t,e){var r;if(t.positions){r=t.positions}else{r=o(t.meshgrid)}var a=t.meshgrid;var s=t.vectors;var l={positions:[],vertexIntensity:[],vertexIntensityBounds:t.vertexIntensityBounds,vertexNormals:[],vectors:[],cells:[],coneOffset:t.coneOffset,colormap:t.colormap};if(t.positions.length===0){if(e){e[0]=[0,0,0];e[1]=[0,0,0]}return l}var u=0;var c=1/0,h=-1/0;var p=1/0,d=-1/0;var v=1/0,g=-1/0;var m=null;var y=null;var x=[];var b=1/0;for(var _=0;_<r.length;_++){var w=r[_];c=Math.min(w[0],c);h=Math.max(w[0],h);p=Math.min(w[1],p);d=Math.max(w[1],d);v=Math.min(w[2],v);g=Math.max(w[2],g);var k;if(a){k=f(w,s,a,true)}else{k=s[_]}if(n.length(k)>u){u=n.length(k)}if(_){b=Math.min(b,2*n.distance(m,w)/(n.length(y)+n.length(k)))}m=w;y=k;x.push(k)}var M=[c,p,v];var A=[h,d,g];if(e){e[0]=M;e[1]=A}if(u===0){u=1}var T=1/u;if(!isFinite(b)||isNaN(b)){b=1}l.vectorScale=b;var S=i(0,1,0);var E=t.coneSize||.5;if(t.absoluteConeSize){E=t.absoluteConeSize*T}l.coneScale=E;for(var _=0,C=0;_<r.length;_++){var w=r[_];var L=w[0],I=w[1],z=w[2];var P=x[_];var O=n.length(P)*T;for(var D=0,R=8;D<R;D++){l.positions.push([L,I,z,C++]);l.positions.push([L,I,z,C++]);l.positions.push([L,I,z,C++]);l.positions.push([L,I,z,C++]);l.positions.push([L,I,z,C++]);l.positions.push([L,I,z,C++]);l.vectors.push(P);l.vectors.push(P);l.vectors.push(P);l.vectors.push(P);l.vectors.push(P);l.vectors.push(P);l.vertexIntensity.push(O,O,O);l.vertexIntensity.push(O,O,O);l.vertexNormals.push(S,S,S);l.vertexNormals.push(S,S,S);var B=l.positions.length;l.cells.push([B-6,B-5,B-4],[B-3,B-2,B-1])}}return l};e.exports.createConeMesh=t("./lib/conemesh")},{"./lib/conemesh":233,"gl-vec3":320,"gl-vec4":350}],232:[function(t,e,r){"use strict";var n=t("barycentric");var a=t("polytope-closest-point/lib/closest_point_2d.js");e.exports=u;function i(t,e){var r=[0,0,0,0];for(var n=0;n<4;++n){for(var a=0;a<4;++a){r[a]+=t[4*n+a]*e[n]}}return r}function o(t,e,r,n,a){var o=i(n,i(r,i(e,[t[0],t[1],t[2],1])));for(var s=0;s<3;++s){o[s]/=o[3]}return[.5*a[0]*(1+o[0]),.5*a[1]*(1-o[1])]}function s(t,e){if(t.length===2){var r=0;var i=0;for(var o=0;o<2;++o){r+=Math.pow(e[o]-t[0][o],2);i+=Math.pow(e[o]-t[1][o],2)}r=Math.sqrt(r);i=Math.sqrt(i);if(r+i<1e-6){return[1,0]}return[i/(r+i),r/(i+r)]}else if(t.length===3){var s=[0,0];a(t[0],t[1],t[2],e,s);return n(t,s)}return[]}function l(t,e){var r=[0,0,0];for(var n=0;n<t.length;++n){var a=t[n];var i=e[n];for(var o=0;o<3;++o){r[o]+=i*a[o]}}return r}function u(t,e,r,n,a,i){if(t.length===1){return[0,t[0].slice()]}var u=new Array(t.length);for(var c=0;c<t.length;++c){u[c]=o(t[c],r,n,a,i)}var f=0;var h=Infinity;for(var c=0;c<u.length;++c){var p=0;for(var d=0;d<2;++d){p+=Math.pow(u[c][d]-e[d],2)}if(p<h){h=p;f=c}}var v=s(u,e);var g=0;for(var c=0;c<3;++c){if(v[c]<-.001||v[c]>1.0001){return null}g+=v[c]}if(Math.abs(g-1)>.001){return null}return[f,l(t,v),v]}},{barycentric:61,"polytope-closest-point/lib/closest_point_2d.js":448}],233:[function(t,e,r){"use strict";var n=1e-6;var a=1e-6;var i=t("gl-shader");var o=t("gl-buffer");var s=t("gl-vao");var l=t("gl-texture2d");var u=t("normals");var c=t("gl-mat4/multiply");var f=t("gl-mat4/invert");var h=t("ndarray");var p=t("colormap");var d=t("simplicial-complex-contour");var v=t("typedarray-pool");var g=t("./shaders");var m=t("./closest-point");var y=g.meshShader;var x=g.pickShader;var b=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function _(t,e,r,n,a,i,o,s,l,u,c,f,h,p,d,v,g,m,y,x,_,w,k,M,A,T,S,E){this.gl=t;this.cells=[];this.positions=[];this.intensity=[];this.texture=e;this.dirty=true;this.triShader=r;this.lineShader=n;this.pointShader=a;this.pickShader=i;this.pointPickShader=o;this.contourShader=s;this.trianglePositions=l;this.triangleVectors=u;this.triangleColors=f;this.triangleNormals=p;this.triangleUVs=h;this.triangleIds=c;this.triangleVAO=d;this.triangleCount=0;this.lineWidth=1;this.edgePositions=v;this.edgeColors=m;this.edgeUVs=y;this.edgeIds=g;this.edgeVAO=x;this.edgeCount=0;this.pointPositions=_;this.pointColors=k;this.pointUVs=M;this.pointSizes=A;this.pointIds=w;this.pointVAO=T;this.pointCount=0;this.contourLineWidth=1;this.contourPositions=S;this.contourVAO=E;this.contourCount=0;this.contourColor=[0,0,0];this.contourEnable=true;this.pickId=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[1e5,1e5,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.opacity=1;this.coneScale=2;this.vectorScale=1;this.coneOffset=1/4;this._model=b;this._view=b;this._projection=b;this._resolution=[1,1]}var w=_.prototype;w.isOpaque=function(){return this.opacity>=1};w.isTransparent=function(){return this.opacity<1};w.pickSlots=1;w.setPickBase=function(t){this.pickId=t};function k(t){var e=p({colormap:t,nshades:256,format:"rgba"});var r=new Uint8Array(256*4);for(var n=0;n<256;++n){var a=e[n];for(var i=0;i<3;++i){r[4*n+i]=a[i]}r[4*n+3]=a[3]*255}return h(r,[256,256,4],[4,0,1])}function M(t,e,r){var n=new Array(e);for(var a=0;a<e;++a){n[a]=0}var i=t.length;for(var a=0;a<i;++a){var o=t[a];for(var s=0;s<o.length;++s){n[o[s]]=r[a]}}return n}function A(t){var e=t.length;var r=new Array(e);for(var n=0;n<e;++n){r[n]=t[n][2]}return r}w.highlight=function(t){if(!t||!this.contourEnable){this.contourCount=0;return}var e=d(this.cells,this.intensity,t.intensity);var r=e.cells;var n=e.vertexIds;var a=e.vertexWeights;var i=r.length;var o=v.mallocFloat32(2*3*i);var s=0;for(var l=0;l<i;++l){var u=r[l];for(var c=0;c<2;++c){var f=u[0];if(u.length===2){f=u[c]}var h=n[f][0];var p=n[f][1];var g=a[f];var m=1-g;var y=this.positions[h];var x=this.positions[p];for(var b=0;b<3;++b){o[s++]=g*y[b]+m*x[b]}}}this.contourCount=s/3|0;this.contourPositions.update(o.subarray(0,s));v.free(o)};w.update=function(t){t=t||{};var e=this.gl;this.dirty=true;if("contourEnable"in t){this.contourEnable=t.contourEnable}if("contourColor"in t){this.contourColor=t.contourColor}if("lineWidth"in t){this.lineWidth=t.lineWidth}if("lightPosition"in t){this.lightPosition=t.lightPosition}if("opacity"in t){this.opacity=t.opacity}if("ambient"in t){this.ambientLight=t.ambient}if("diffuse"in t){this.diffuseLight=t.diffuse}if("specular"in t){this.specularLight=t.specular}if("roughness"in t){this.roughness=t.roughness}if("fresnel"in t){this.fresnel=t.fresnel}if(t.vectorScale!==undefined){this.vectorScale=t.vectorScale}if(t.coneScale!==undefined){this.coneScale=t.coneScale}if(t.coneOffset!==undefined){this.coneOffset=t.coneOffset}if(t.texture){this.texture.dispose();this.texture=l(e,t.texture)}else if(t.colormap){this.texture.shape=[256,256];this.texture.minFilter=e.LINEAR_MIPMAP_LINEAR;this.texture.magFilter=e.LINEAR;this.texture.setPixels(k(t.colormap));this.texture.generateMipmap()}var r=t.cells;var i=t.positions;var o=t.vectors;if(!i||!r||!o){return}var s=[];var c=[];var f=[];var h=[];var p=[];var d=[];var v=[];var g=[];var m=[];var y=[];var x=[];var b=[];var _=[];var w=[];var T=[];this.cells=r;this.positions=i;var S=t.vertexNormals;var E=t.cellNormals;var C=t.vertexNormalsEpsilon===void 0?n:t.vertexNormalsEpsilon;var L=t.faceNormalsEpsilon===void 0?a:t.faceNormalsEpsilon;if(t.useFacetNormals&&!E){E=u.faceNormals(r,i,L)}if(!E&&!S){S=u.vertexNormals(r,i,C)}var I=t.vertexColors;var z=t.cellColors;var P=t.meshColor||[1,1,1,1];var O=t.vertexUVs;var D=t.vertexIntensity;var R=t.cellUVs;var B=t.cellIntensity;var F=Infinity;var N=-Infinity;if(!O&&!R){if(D){if(t.vertexIntensityBounds){F=+t.vertexIntensityBounds[0];N=+t.vertexIntensityBounds[1]}else{for(var j=0;j<D.length;++j){var V=D[j];F=Math.min(F,V);N=Math.max(N,V)}}}else if(B){for(var j=0;j<B.length;++j){var V=B[j];F=Math.min(F,V);N=Math.max(N,V)}}else{for(var j=0;j<i.length;++j){var V=i[j][2];F=Math.min(F,V);N=Math.max(N,V)}}}if(D){this.intensity=D}else if(B){this.intensity=M(r,i.length,B)}else{this.intensity=A(i)}var U=t.pointSizes;var q=t.pointSize||1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(var j=0;j<i.length;++j){var H=i[j];for(var G=0;G<3;++G){if(isNaN(H[G])||!isFinite(H[G])){continue}this.bounds[0][G]=Math.min(this.bounds[0][G],H[G]);this.bounds[1][G]=Math.max(this.bounds[1][G],H[G])}}var W=0;var Y=0;var X=0;t:for(var j=0;j<r.length;++j){var Z=r[j];switch(Z.length){case 1:var $=Z[0];var H=i[$];for(var G=0;G<3;++G){if(isNaN(H[G])||!isFinite(H[G])){continue t}}x.push(H[0],H[1],H[2],H[3]);var J;if(I){J=I[$]}else if(z){J=z[j]}else{J=P}if(J.length===3){b.push(J[0],J[1],J[2],1)}else{b.push(J[0],J[1],J[2],J[3])}var K;if(O){K=O[$]}else if(D){K=[(D[$]-F)/(N-F),0]}else if(R){K=R[j]}else if(B){K=[(B[j]-F)/(N-F),0]}else{K=[(H[2]-F)/(N-F),0]}_.push(K[0],K[1]);if(U){w.push(U[$])}else{w.push(q)}T.push(j);X+=1;break;case 2:for(var G=0;G<2;++G){var $=Z[G];var H=i[$];for(var Q=0;Q<3;++Q){if(isNaN(H[Q])||!isFinite(H[Q])){continue t}}}for(var G=0;G<2;++G){var $=Z[G];var H=i[$];v.push(H[0],H[1],H[2]);var J;if(I){J=I[$]}else if(z){J=z[j]}else{J=P}if(J.length===3){g.push(J[0],J[1],J[2],1)}else{g.push(J[0],J[1],J[2],J[3])}var K;if(O){K=O[$]}else if(D){K=[(D[$]-F)/(N-F),0]}else if(R){K=R[j]}else if(B){K=[(B[j]-F)/(N-F),0]}else{K=[(H[2]-F)/(N-F),0]}m.push(K[0],K[1]);y.push(j)}Y+=1;break;case 3:for(var G=0;G<3;++G){var $=Z[G];var H=i[$];for(var Q=0;Q<3;++Q){if(isNaN(H[Q])||!isFinite(H[Q])){continue t}}}for(var G=0;G<3;++G){var $=Z[G];var H=i[$];s.push(H[0],H[1],H[2],H[3]);var tt=o[$];c.push(tt[0],tt[1],tt[2]);var J;if(I){J=I[$]}else if(z){J=z[j]}else{J=P}if(J.length===3){f.push(J[0],J[1],J[2],1)}else{f.push(J[0],J[1],J[2],J[3])}var K;if(O){K=O[$]}else if(D){K=[(D[$]-F)/(N-F),0]}else if(R){K=R[j]}else if(B){K=[(B[j]-F)/(N-F),0]}else{K=[(H[2]-F)/(N-F),0]}p.push(K[0],K[1]);var et;if(S){et=S[$]}else{et=E[j]}h.push(et[0],et[1],et[2]);d.push(j)}W+=1;break;default:break}}this.pointCount=X;this.edgeCount=Y;this.triangleCount=W;this.pointPositions.update(x);this.pointColors.update(b);this.pointUVs.update(_);this.pointSizes.update(w);this.pointIds.update(new Uint32Array(T));this.edgePositions.update(v);this.edgeColors.update(g);this.edgeUVs.update(m);this.edgeIds.update(new Uint32Array(y));this.trianglePositions.update(s);this.triangleVectors.update(c);this.triangleColors.update(f);this.triangleUVs.update(p);this.triangleNormals.update(h);this.triangleIds.update(new Uint32Array(d))};w.drawTransparent=w.draw=function(t){t=t||{};var e=this.gl;var r=t.model||b;var n=t.view||b;var a=t.projection||b;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}var s={model:r,view:n,projection:a,clipBounds:i,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,contourColor:this.contourColor,texture:0};this.texture.bind(0);var l=new Array(16);c(l,s.view,s.model);c(l,s.projection,l);f(l,l);for(var o=0;o<3;++o){s.eyePosition[o]=l[12+o]/l[15]}var u=l[15];for(var o=0;o<3;++o){u+=this.lightPosition[o]*l[4*o+3]}for(var o=0;o<3;++o){var h=l[12+o];for(var p=0;p<3;++p){h+=l[4*p+o]*this.lightPosition[p]}s.lightPosition[o]=h/u}if(this.triangleCount>0){var d=this.triShader;d.bind();d.uniforms=s;this.triangleVAO.bind();e.drawArrays(e.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var d=this.lineShader;d.bind();d.uniforms=s;this.edgeVAO.bind();e.lineWidth(this.lineWidth);e.drawArrays(e.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var d=this.pointShader;d.bind();d.uniforms=s;this.pointVAO.bind();e.drawArrays(e.POINTS,0,this.pointCount);this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var d=this.contourShader;d.bind();d.uniforms=s;this.contourVAO.bind();e.drawArrays(e.LINES,0,this.contourCount);this.contourVAO.unbind()}};w.drawPick=function(t){t=t||{};var e=this.gl;var r=t.model||b;var n=t.view||b;var a=t.projection||b;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}this._model=[].slice.call(r);this._view=[].slice.call(n);this._projection=[].slice.call(a);this._resolution=[e.drawingBufferWidth,e.drawingBufferHeight];var s={model:r,view:n,projection:a,clipBounds:i,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255};var l=this.pickShader;l.bind();l.uniforms=s;if(this.triangleCount>0){this.triangleVAO.bind();e.drawArrays(e.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0){this.edgeVAO.bind();e.lineWidth(this.lineWidth);e.drawArrays(e.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var l=this.pointPickShader;l.bind();l.uniforms=s;this.pointVAO.bind();e.drawArrays(e.POINTS,0,this.pointCount);this.pointVAO.unbind()}};w.pick=function(t){if(!t){return null}if(t.id!==this.pickId){return null}var e=t.value[0]+256*t.value[1]+65536*t.value[2];var r=this.cells[e];var n=this.positions[r[1]].slice(0,3);return{index:Math.floor(r[1]/48),position:n,dataCoordinate:n}};w.dispose=function(){this.texture.dispose();this.triShader.dispose();this.pickShader.dispose();this.triangleVAO.dispose();this.trianglePositions.dispose();this.triangleVectors.dispose();this.triangleColors.dispose();this.triangleUVs.dispose();this.triangleNormals.dispose();this.triangleIds.dispose();this.edgeVAO.dispose();this.edgePositions.dispose();this.edgeColors.dispose();this.edgeUVs.dispose();this.edgeIds.dispose();this.pointVAO.dispose();this.pointPositions.dispose();this.pointColors.dispose();this.pointUVs.dispose();this.pointSizes.dispose();this.pointIds.dispose();this.contourVAO.dispose();this.contourPositions.dispose()};function T(t){var e=i(t,y.vertex,y.fragment,null,y.attributes);e.attributes.position.location=0;e.attributes.color.location=2;e.attributes.uv.location=3;e.attributes.vector.location=5;return e}function S(t){var e=i(t,wireShader.vertex,wireShader.fragment);e.attributes.position.location=0;e.attributes.color.location=2;e.attributes.uv.location=3;return e}function E(t){var e=i(t,pointShader.vertex,pointShader.fragment);e.attributes.position.location=0;e.attributes.color.location=2;e.attributes.uv.location=3;e.attributes.pointSize.location=4;return e}function C(t){var e=i(t,x.vertex,x.fragment,null,x.attributes);e.attributes.position.location=0;e.attributes.id.location=1;e.attributes.vector.location=5;return e}function L(t){var e=i(t,pointPickShader.vertex,pointPickShader.fragment);e.attributes.position.location=0;e.attributes.id.location=1;e.attributes.pointSize.location=4;return e}function I(t){var e=i(t,contourShader.vertex,contourShader.fragment);e.attributes.position.location=0;return e}function z(t,e){if(arguments.length===1){e=t;t=e.gl}var r=e.triShader||T(t);var n=null;var a=null;var i=C(t);var u=null;var c=null;var f=l(t,h(new Uint8Array([255,255,255,255]),[1,1,4]));f.generateMipmap();f.minFilter=t.LINEAR_MIPMAP_LINEAR;f.magFilter=t.LINEAR;var p=o(t);var d=o(t);var v=o(t);var g=o(t);var m=o(t);var y=o(t);var x=s(t,[{buffer:p,type:t.FLOAT,size:4},{buffer:y,type:t.UNSIGNED_BYTE,size:4,normalized:true},{buffer:v,type:t.FLOAT,size:4},{buffer:g,type:t.FLOAT,size:2},{buffer:m,type:t.FLOAT,size:3},{buffer:d,type:t.FLOAT,size:3}]);var b=o(t);var w=o(t);var k=o(t);var M=o(t);var A=s(t,[{buffer:b,type:t.FLOAT,size:3},{buffer:M,type:t.UNSIGNED_BYTE,size:4,normalized:true},{buffer:w,type:t.FLOAT,size:4},{buffer:k,type:t.FLOAT,size:2}]);var S=o(t);var E=o(t);var L=o(t);var I=o(t);var z=o(t);var P=s(t,[{buffer:S,type:t.FLOAT,size:3},{buffer:z,type:t.UNSIGNED_BYTE,size:4,normalized:true},{buffer:E,type:t.FLOAT,size:4},{buffer:L,type:t.FLOAT,size:2},{buffer:I,type:t.FLOAT,size:1}]);var O=o(t);var D=s(t,[{buffer:O,type:t.FLOAT,size:3}]);var R=new _(t,f,r,n,a,i,u,c,p,d,y,v,g,m,x,b,M,w,k,A,S,z,E,L,I,P,O,D);R.update(e);return R}e.exports=z},{"./closest-point":232,"./shaders":234,colormap:113,"gl-buffer":230,"gl-mat4/invert":254,"gl-mat4/multiply":256,"gl-shader":287,"gl-texture2d":303,"gl-vao":308,ndarray:417,normals:420,"simplicial-complex-contour":479,"typedarray-pool":507}],234:[function(t,e,r){var n=t("glslify");var a=n(["precision mediump float;\n#define GLSLIFY 1\n\nfloat inverse(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float index, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  index = mod(index, segmentCount * 6.0);\n\n  float segment = floor(index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex == 3.0) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  // angle = 2pi * ((segment + ((segmentIndex == 1.0 || segmentIndex == 5.0) ? 1.0 : 0.0)) / segmentCount)\n  float nextAngle = float(segmentIndex == 1.0 || segmentIndex == 5.0);\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex <= 2.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\nuniform float vectorScale;\nuniform float coneScale;\n\nuniform float coneOffset;\n\nuniform mat4 model\n           , view\n           , projection;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal), 0.0);\n  normal = normalize(normal * inverse(mat3(model)));\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n  f_color          = color; //vec4(position.w, color.r, 0, 0);\n  f_normal         = normal;\n  f_data           = conePosition.xyz;\n  f_eyeDirection   = eyePosition   - conePosition.xyz;\n  f_lightDirection = lightPosition - conePosition.xyz;\n  f_uv             = uv;\n}\n"]);var i=n(["precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  //if(any(lessThan(f_data, clipBounds[0])) || \n  //   any(greaterThan(f_data, clipBounds[1]))) {\n  //  discard;\n  //}\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n  \n  if(!gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor =  texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float index, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  index = mod(index, segmentCount * 6.0);\n\n  float segment = floor(index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex == 3.0) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  // angle = 2pi * ((segment + ((segmentIndex == 1.0 || segmentIndex == 5.0) ? 1.0 : 0.0)) / segmentCount)\n  float nextAngle = float(segmentIndex == 1.0 || segmentIndex == 5.0);\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex <= 2.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nuniform float vectorScale;\nuniform float coneScale;\nuniform float coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal), 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]);var s=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if(any(lessThan(f_position, clipBounds[0])) || \n     any(greaterThan(f_position, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);r.meshShader={vertex:a,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]};r.pickShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:377}],235:[function(t,e,r){e.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34000:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],236:[function(t,e,r){var n=t("./1.0/numbers");e.exports=function t(e){return n[e]}},{"./1.0/numbers":235}],237:[function(t,e,r){"use strict";e.exports=h;var n=t("gl-buffer");var a=t("gl-vao");var i=t("./shaders/index");var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(t,e,r,n){this.gl=t;this.shader=n;this.buffer=e;this.vao=r;this.pixelRatio=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lineWidth=[1,1,1];this.capSize=[10,10,10];this.lineCount=[0,0,0];this.lineOffset=[0,0,0];this.opacity=1}var l=s.prototype;l.isOpaque=function(){return this.opacity>=1};l.isTransparent=function(){return this.opacity<1};l.drawTransparent=l.draw=function(t){var e=this.gl;var r=this.shader.uniforms;this.shader.bind();var n=r.view=t.view||o;var a=r.projection=t.projection||o;r.model=t.model||o;r.clipBounds=this.clipBounds;r.opacity=this.opacity;var i=n[12];var s=n[13];var l=n[14];var u=n[15];var c=this.pixelRatio*(a[3]*i+a[7]*s+a[11]*l+a[15]*u)/e.drawingBufferHeight;this.vao.bind();for(var f=0;f<3;++f){e.lineWidth(this.lineWidth[f]);r.capSize=this.capSize[f]*c;if(this.lineCount[f]){e.drawArrays(e.LINES,this.lineOffset[f],this.lineCount[f])}}this.vao.unbind()};function u(t,e){for(var r=0;r<3;++r){t[0][r]=Math.min(t[0][r],e[r]);t[1][r]=Math.max(t[1][r],e[r])}}var c=function(){var t=new Array(3);for(var e=0;e<3;++e){var r=[];for(var n=1;n<=2;++n){for(var a=-1;a<=1;a+=2){var i=(n+e)%3;var o=[0,0,0];o[i]=a;r.push(o)}}t[e]=r}return t}();function f(t,e,r,n){var a=c[n];for(var i=0;i<a.length;++i){var o=a[i];t.push(e[0],e[1],e[2],r[0],r[1],r[2],r[3],o[0],o[1],o[2])}return a.length}l.update=function(t){t=t||{};if("lineWidth"in t){this.lineWidth=t.lineWidth;if(!Array.isArray(this.lineWidth)){this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth]}}if("capSize"in t){this.capSize=t.capSize;if(!Array.isArray(this.capSize)){this.capSize=[this.capSize,this.capSize,this.capSize]}}if("opacity"in t){this.opacity=t.opacity}var e=t.color||[[0,0,0],[0,0,0],[0,0,0]];var r=t.position;var n=t.error;if(!Array.isArray(e[0])){e=[e,e,e]}if(r&&n){var a=[];var i=r.length;var o=0;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.lineCount=[0,0,0];for(var s=0;s<3;++s){this.lineOffset[s]=o;t:for(var l=0;l<i;++l){var c=r[l];for(var h=0;h<3;++h){if(isNaN(c[h])||!isFinite(c[h])){continue t}}var p=n[l];var d=e[s];if(Array.isArray(d[0])){d=e[l]}if(d.length===3){d=[d[0],d[1],d[2],1]}if(isNaN(p[0][s])||isNaN(p[1][s])){continue}if(p[0][s]<0){var v=c.slice();v[s]+=p[0][s];a.push(c[0],c[1],c[2],d[0],d[1],d[2],d[3],0,0,0,v[0],v[1],v[2],d[0],d[1],d[2],d[3],0,0,0);u(this.bounds,v);o+=2+f(a,v,d,s)}if(p[1][s]>0){var v=c.slice();v[s]+=p[1][s];a.push(c[0],c[1],c[2],d[0],d[1],d[2],d[3],0,0,0,v[0],v[1],v[2],d[0],d[1],d[2],d[3],0,0,0);u(this.bounds,v);o+=2+f(a,v,d,s)}}this.lineCount[s]=o-this.lineOffset[s]}this.buffer.update(a)}};l.dispose=function(){this.shader.dispose();this.buffer.dispose();this.vao.dispose()};function h(t){var e=t.gl;var r=n(e);var o=a(e,[{buffer:r,type:e.FLOAT,size:3,offset:0,stride:40},{buffer:r,type:e.FLOAT,size:4,offset:12,stride:40},{buffer:r,type:e.FLOAT,size:3,offset:28,stride:40}]);var l=i(e);l.attributes.position.location=0;l.attributes.color.location=1;l.attributes.offset.location=2;var u=new s(e,r,o,l);u.update(t);return u}},{"./shaders/index":238,"gl-buffer":230,"gl-vao":308}],238:[function(t,e,r){"use strict";var n=t("glslify");var a=t("gl-shader");var i=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if(any(lessThan(fragPosition, clipBounds[0])) || any(greaterThan(fragPosition, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = opacity * fragColor;\n}"]);e.exports=function(t){return a(t,i,o,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":287,glslify:377}],239:[function(t,e,r){"use strict";var n=t("gl-texture2d");e.exports=x;var a=null;var i;var o;var s;var l;function u(t){var e=t.getParameter(t.FRAMEBUFFER_BINDING);var r=t.getParameter(t.RENDERBUFFER_BINDING);var n=t.getParameter(t.TEXTURE_BINDING_2D);return[e,r,n]}function c(t,e){t.bindFramebuffer(t.FRAMEBUFFER,e[0]);t.bindRenderbuffer(t.RENDERBUFFER,e[1]);t.bindTexture(t.TEXTURE_2D,e[2])}function f(t,e){var r=t.getParameter(e.MAX_COLOR_ATTACHMENTS_WEBGL);a=new Array(r+1);for(var n=0;n<=r;++n){var i=new Array(r);for(var o=0;o<n;++o){i[o]=t.COLOR_ATTACHMENT0+o}for(var o=n;o<r;++o){i[o]=t.NONE}a[n]=i}}function h(t){switch(t){case i:throw new Error("gl-fbo: Framebuffer unsupported");case o:throw new Error("gl-fbo: Framebuffer incomplete attachment");case s:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case l:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function p(t,e,r,a,i,o){if(!a){return null}var s=n(t,e,r,i,a);s.magFilter=t.NEAREST;s.minFilter=t.NEAREST;s.mipSamples=1;s.bind();t.framebufferTexture2D(t.FRAMEBUFFER,o,t.TEXTURE_2D,s.handle,0);return s}function d(t,e,r,n,a){var i=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,i);t.renderbufferStorage(t.RENDERBUFFER,n,e,r);t.framebufferRenderbuffer(t.FRAMEBUFFER,a,t.RENDERBUFFER,i);return i}function v(t){var e=u(t.gl);var r=t.gl;var n=t.handle=r.createFramebuffer();var i=t._shape[0];var o=t._shape[1];var s=t.color.length;var l=t._ext;var f=t._useStencil;var v=t._useDepth;var g=t._colorType;r.bindFramebuffer(r.FRAMEBUFFER,n);for(var m=0;m<s;++m){t.color[m]=p(r,i,o,g,r.RGBA,r.COLOR_ATTACHMENT0+m)}if(s===0){t._color_rb=d(r,i,o,r.RGBA4,r.COLOR_ATTACHMENT0);if(l){l.drawBuffersWEBGL(a[0])}}else if(s>1){l.drawBuffersWEBGL(a[s])}var y=r.getExtension("WEBGL_depth_texture");if(y){if(f){t.depth=p(r,i,o,y.UNSIGNED_INT_24_8_WEBGL,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT)}else if(v){t.depth=p(r,i,o,r.UNSIGNED_SHORT,r.DEPTH_COMPONENT,r.DEPTH_ATTACHMENT)}}else{if(v&&f){t._depth_rb=d(r,i,o,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT)}else if(v){t._depth_rb=d(r,i,o,r.DEPTH_COMPONENT16,r.DEPTH_ATTACHMENT)}else if(f){t._depth_rb=d(r,i,o,r.STENCIL_INDEX,r.STENCIL_ATTACHMENT)}}var x=r.checkFramebufferStatus(r.FRAMEBUFFER);if(x!==r.FRAMEBUFFER_COMPLETE){t._destroyed=true;r.bindFramebuffer(r.FRAMEBUFFER,null);r.deleteFramebuffer(t.handle);t.handle=null;if(t.depth){t.depth.dispose();t.depth=null}if(t._depth_rb){r.deleteRenderbuffer(t._depth_rb);t._depth_rb=null}for(var m=0;m<t.color.length;++m){t.color[m].dispose();t.color[m]=null}if(t._color_rb){r.deleteRenderbuffer(t._color_rb);t._color_rb=null}c(r,e);h(x)}c(r,e)}function g(t,e,r,n,a,i,o,s){this.gl=t;this._shape=[e|0,r|0];this._destroyed=false;this._ext=s;this.color=new Array(a);for(var l=0;l<a;++l){this.color[l]=null}this._color_rb=null;this.depth=null;this._depth_rb=null;this._colorType=n;this._useDepth=i;this._useStencil=o;var u=this;var c=[e|0,r|0];Object.defineProperties(c,{0:{get:function(){return u._shape[0]},set:function(t){return u.width=t}},1:{get:function(){return u._shape[1]},set:function(t){return u.height=t}}});this._shapeVector=c;v(this)}var m=g.prototype;function y(t,e,r){if(t._destroyed){throw new Error("gl-fbo: Can't resize destroyed FBO")}if(t._shape[0]===e&&t._shape[1]===r){return}var n=t.gl;var a=n.getParameter(n.MAX_RENDERBUFFER_SIZE);if(e<0||e>a||r<0||r>a){throw new Error("gl-fbo: Can't resize FBO, invalid dimensions")}t._shape[0]=e;t._shape[1]=r;var i=u(n);for(var o=0;o<t.color.length;++o){t.color[o].shape=t._shape}if(t._color_rb){n.bindRenderbuffer(n.RENDERBUFFER,t._color_rb);n.renderbufferStorage(n.RENDERBUFFER,n.RGBA4,t._shape[0],t._shape[1])}if(t.depth){t.depth.shape=t._shape}if(t._depth_rb){n.bindRenderbuffer(n.RENDERBUFFER,t._depth_rb);if(t._useDepth&&t._useStencil){n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t._shape[0],t._shape[1])}else if(t._useDepth){n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,t._shape[0],t._shape[1])}else if(t._useStencil){n.renderbufferStorage(n.RENDERBUFFER,n.STENCIL_INDEX,t._shape[0],t._shape[1])}}n.bindFramebuffer(n.FRAMEBUFFER,t.handle);var s=n.checkFramebufferStatus(n.FRAMEBUFFER);if(s!==n.FRAMEBUFFER_COMPLETE){t.dispose();c(n,i);h(s)}c(n,i)}Object.defineProperties(m,{shape:{get:function(){if(this._destroyed){return[0,0]}return this._shapeVector},set:function(t){if(!Array.isArray(t)){t=[t|0,t|0]}if(t.length!==2){throw new Error("gl-fbo: Shape vector must be length 2")}var e=t[0]|0;var r=t[1]|0;y(this,e,r);return[e,r]},enumerable:false},width:{get:function(){if(this._destroyed){return 0}return this._shape[0]},set:function(t){t=t|0;y(this,t,this._shape[1]);return t},enumerable:false},height:{get:function(){if(this._destroyed){return 0}return this._shape[1]},set:function(t){t=t|0;y(this,this._shape[0],t);return t},enumerable:false}});m.bind=function(){if(this._destroyed){return}var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.handle);t.viewport(0,0,this._shape[0],this._shape[1])};m.dispose=function(){if(this._destroyed){return}this._destroyed=true;var t=this.gl;t.deleteFramebuffer(this.handle);this.handle=null;if(this.depth){this.depth.dispose();this.depth=null}if(this._depth_rb){t.deleteRenderbuffer(this._depth_rb);this._depth_rb=null}for(var e=0;e<this.color.length;++e){this.color[e].dispose();this.color[e]=null}if(this._color_rb){t.deleteRenderbuffer(this._color_rb);this._color_rb=null}};function x(t,e,r,n){if(!i){i=t.FRAMEBUFFER_UNSUPPORTED;o=t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT;s=t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS;l=t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT}var u=t.getExtension("WEBGL_draw_buffers");if(!a&&u){f(t,u)}if(Array.isArray(e)){n=r;r=e[1]|0;e=e[0]|0}if(typeof e!=="number"){throw new Error("gl-fbo: Missing shape parameter")}var c=t.getParameter(t.MAX_RENDERBUFFER_SIZE);if(e<0||e>c||r<0||r>c){throw new Error("gl-fbo: Parameters are too large for FBO")}n=n||{};var h=1;if("color"in n){h=Math.max(n.color|0,0);if(h<0){throw new Error("gl-fbo: Must specify a nonnegative number of colors")}if(h>1){if(!u){throw new Error("gl-fbo: Multiple draw buffer extension not supported")}else if(h>t.getParameter(u.MAX_COLOR_ATTACHMENTS_WEBGL)){throw new Error("gl-fbo: Context does not support "+h+" draw buffers")}}}var p=t.UNSIGNED_BYTE;var d=t.getExtension("OES_texture_float");if(n.float&&h>0){if(!d){throw new Error("gl-fbo: Context does not support floating point textures")}p=t.FLOAT}else if(n.preferFloat&&h>0){if(d){p=t.FLOAT}}var v=true;if("depth"in n){v=!!n.depth}var m=false;if("stencil"in n){m=!!n.stencil}return new g(t,e,r,p,h,v,m,u)}},{"gl-texture2d":303}],240:[function(t,e,r){var n=t("sprintf-js").sprintf;var a=t("gl-constants/lookup");var i=t("glsl-shader-name");var o=t("add-line-numbers");e.exports=s;function s(t,e,r){"use strict";var s=i(e)||"of unknown name (see npm glsl-shader-name)";var l="unknown type";if(r!==undefined){l=r===a.FRAGMENT_SHADER?"fragment":"vertex"}var u=n("Error compiling %s shader %s:\n",l,s);var c=n("%s%s",u,t);var f=t.split("\n");var h={};for(var p=0;p<f.length;p++){var d=f[p];if(d===""||d==="\0")continue;var v=parseInt(d.split(":")[2]);if(isNaN(v)){throw new Error(n("Could not parse error: %s",d))}h[v]=d}var g=o(e).split("\n");for(var p=0;p<g.length;p++){if(!h[p+3]&&!h[p+2]&&!h[p+1])continue;var m=g[p];u+=m+"\n";if(h[p+1]){var y=h[p+1];y=y.substr(y.split(":",3).join(":").length+1).trim();u+=n("^^^ %s\n\n",y)}}return{long:u.trim(),short:c.trim()}}},{"add-line-numbers":52,"gl-constants/lookup":236,"glsl-shader-name":369,"sprintf-js":489}],241:[function(t,e,r){"use strict";e.exports=h;var n=t("binary-search-bounds");var a=t("iota-array");var i=t("typedarray-pool");var o=t("gl-shader");var s=t("gl-buffer");var l=t("./lib/shaders");function u(t,e,r,n,a,i,o){this.plot=t;this.shader=e;this.pickShader=r;this.positionBuffer=n;this.weightBuffer=a;this.colorBuffer=i;this.idBuffer=o;this.xData=[];this.yData=[];this.shape=[0,0];this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.pickOffset=0}var c=u.prototype;var f=[0,0,1,0,0,1,1,0,1,1,0,1];c.draw=function(){var t=[1,0,0,0,1,0,0,0,1];return function(){var e=this.plot;var r=this.shader;var n=this.bounds;var a=this.numVertices;if(a<=0){return}var i=e.gl;var o=e.dataBox;var s=n[2]-n[0];var l=n[3]-n[1];var u=o[2]-o[0];var c=o[3]-o[1];t[0]=2*s/u;t[4]=2*l/c;t[6]=2*(n[0]-o[0])/u-1;t[7]=2*(n[1]-o[1])/c-1;r.bind();var f=r.uniforms;f.viewTransform=t;f.shape=this.shape;var h=r.attributes;this.positionBuffer.bind();h.position.pointer();this.weightBuffer.bind();h.weight.pointer(i.UNSIGNED_BYTE,false);this.colorBuffer.bind();h.color.pointer(i.UNSIGNED_BYTE,true);i.drawArrays(i.TRIANGLES,0,a)}}();c.drawPick=function(){var t=[1,0,0,0,1,0,0,0,1];var e=[0,0,0,0];return function(r){var n=this.plot;var a=this.pickShader;var i=this.bounds;var o=this.numVertices;if(o<=0){return}var s=n.gl;var l=n.dataBox;var u=i[2]-i[0];var c=i[3]-i[1];var f=l[2]-l[0];var h=l[3]-l[1];t[0]=2*u/f;t[4]=2*c/h;t[6]=2*(i[0]-l[0])/f-1;t[7]=2*(i[1]-l[1])/h-1;for(var p=0;p<4;++p){e[p]=r>>p*8&255}this.pickOffset=r;a.bind();var d=a.uniforms;d.viewTransform=t;d.pickOffset=e;d.shape=this.shape;var v=a.attributes;this.positionBuffer.bind();v.position.pointer();this.weightBuffer.bind();v.weight.pointer(s.UNSIGNED_BYTE,false);this.idBuffer.bind();v.pickId.pointer(s.UNSIGNED_BYTE,false);s.drawArrays(s.TRIANGLES,0,o);return r+this.shape[0]*this.shape[1]}}();c.pick=function(t,e,r){var n=this.pickOffset;var a=this.shape[0]*this.shape[1];if(r<n||r>=n+a){return null}var i=r-n;var o=this.xData;var s=this.yData;return{object:this,pointId:i,dataCoord:[o[i%this.shape[0]],s[i/this.shape[0]|0]]}};c.update=function(t){t=t||{};var e=t.shape||[0,0];var r=t.x||a(e[0]);var o=t.y||a(e[1]);var s=t.z||new Float32Array(e[0]*e[1]);this.xData=r;this.yData=o;var l=t.colorLevels||[0];var u=t.colorValues||[0,0,0,1];var c=l.length;var h=this.bounds;var p=h[0]=r[0];var d=h[1]=o[0];var v=h[2]=r[r.length-1];var g=h[3]=o[o.length-1];var m=1/(v-p);var y=1/(g-d);var x=e[0];var b=e[1];this.shape=[x,b];var _=(x-1)*(b-1)*(f.length>>>1);this.numVertices=_;var w=i.mallocUint8(_*4);var k=i.mallocFloat32(_*2);var M=i.mallocUint8(_*2);var A=i.mallocUint32(_);var T=0;for(var S=0;S<b-1;++S){var E=y*(o[S]-d);var C=y*(o[S+1]-d);for(var L=0;L<x-1;++L){var I=m*(r[L]-p);var z=m*(r[L+1]-p);for(var P=0;P<f.length;P+=2){var O=f[P];var D=f[P+1];var R=(S+D)*x+(L+O);var B=s[R];var F=n.le(l,B);var N,j,V,U;if(F<0){N=u[0];j=u[1];V=u[2];U=u[3]}else if(F===c-1){N=u[4*c-4];j=u[4*c-3];V=u[4*c-2];U=u[4*c-1]}else{var q=(B-l[F])/(l[F+1]-l[F]);var H=1-q;var G=4*F;var W=4*(F+1);N=H*u[G]+q*u[W];j=H*u[G+1]+q*u[W+1];V=H*u[G+2]+q*u[W+2];U=H*u[G+3]+q*u[W+3]}w[4*T]=255*N;w[4*T+1]=255*j;w[4*T+2]=255*V;w[4*T+3]=255*U;k[2*T]=I*.5+z*.5;k[2*T+1]=E*.5+C*.5;M[2*T]=O;M[2*T+1]=D;A[T]=S*x+L;T+=1}}}this.positionBuffer.update(k);this.weightBuffer.update(M);this.colorBuffer.update(w);this.idBuffer.update(A);i.free(k);i.free(w);i.free(M);i.free(A)};c.dispose=function(){this.shader.dispose();this.pickShader.dispose();this.positionBuffer.dispose();this.weightBuffer.dispose();this.colorBuffer.dispose();this.idBuffer.dispose();this.plot.removeObject(this)};function h(t,e){var r=t.gl;var n=o(r,l.vertex,l.fragment);var a=o(r,l.pickVertex,l.pickFragment);var i=s(r);var c=s(r);var f=s(r);var h=s(r);var p=new u(t,n,a,i,c,f,h);p.update(e);t.addObject(p);return p}},{"./lib/shaders":242,"binary-search-bounds":243,"gl-buffer":230,"gl-shader":287,"iota-array":384,"typedarray-pool":507}],242:[function(t,e,r){"use strict";var n=t("glslify");e.exports={fragment:n(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:n(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:377}],243:[function(t,e,r){arguments[4][98][0].apply(r,arguments)},{dup:98}],244:[function(t,e,r){var n=t("glslify");var a=t("gl-shader");var i=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvoid main() {\n  vec4 projected = projection * view * model * vec4(position, 1.0);\n  vec4 tangentClip = projection * view * model * vec4(nextPosition - position, 0.0);\n  vec2 tangent = normalize(screenShape * tangentClip.xy);\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(tangent.y, -tangent.x) / screenShape;\n\n  gl_Position = vec4(projected.xy + projected.w * offset, projected.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if(any(lessThan(worldPosition, clipBounds[0])) || any(greaterThan(worldPosition, clipBounds[1]))) {\n    discard;\n  }\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]);var s=n(["precision mediump float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\nlowp vec4 encode_float_1540259130(highp float v) {\n  highp float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n  \n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n  \n  //Unpack exponent\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0; \n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if(any(lessThan(worldPosition, clipBounds[0])) || any(greaterThan(worldPosition, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId/255.0, encode_float_1540259130(pixelArcLength).xyz);\n}"]);var l=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];r.createShader=function(t){return a(t,i,o,null,l)};r.createPickShader=function(t){return a(t,i,s,null,l)}},{"gl-shader":287,glslify:377}],245:[function(t,e,r){"use strict";e.exports=y;var n=t("gl-buffer");var a=t("gl-vao");var i=t("gl-texture2d");var o=t("glsl-read-float");var s=t("binary-search-bounds");var l=t("ndarray");var u=t("./lib/shaders");var c=u.createShader;var f=u.createPickShader;var h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function p(t,e){var r=0;for(var n=0;n<3;++n){var a=t[n]-e[n];r+=a*a}return Math.sqrt(r)}function d(t){var e=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var r=0;r<3;++r){e[0][r]=Math.max(t[0][r],e[0][r]);e[1][r]=Math.min(t[1][r],e[1][r])}return e}function v(t,e,r,n){this.arcLength=t;this.position=e;this.index=r;this.dataCoordinate=n}function g(t,e,r,n,a,i){this.gl=t;this.shader=e;this.pickShader=r;this.buffer=n;this.vao=a;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.points=[];this.arcLength=[];this.vertexCount=0;this.bounds=[[0,0,0],[0,0,0]];this.pickId=0;this.lineWidth=1;this.texture=i;this.dashScale=1;this.opacity=1;this.dirty=true;this.pixelRatio=1}var m=g.prototype;m.isTransparent=function(){return this.opacity<1};m.isOpaque=function(){return this.opacity>=1};m.pickSlots=1;m.setPickBase=function(t){this.pickId=t};m.drawTransparent=m.draw=function(t){var e=this.gl;var r=this.shader;var n=this.vao;r.bind();r.uniforms={model:t.model||h,view:t.view||h,projection:t.projection||h,clipBounds:d(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[e.drawingBufferWidth,e.drawingBufferHeight],pixelRatio:this.pixelRatio};n.bind();n.draw(e.TRIANGLE_STRIP,this.vertexCount);n.unbind()};m.drawPick=function(t){var e=this.gl;var r=this.pickShader;var n=this.vao;r.bind();r.uniforms={model:t.model||h,view:t.view||h,projection:t.projection||h,pickId:this.pickId,clipBounds:d(this.clipBounds),screenShape:[e.drawingBufferWidth,e.drawingBufferHeight],pixelRatio:this.pixelRatio};n.bind();n.draw(e.TRIANGLE_STRIP,this.vertexCount);n.unbind()};m.update=function(t){var e,r;this.dirty=true;var n=!!t.connectGaps;if("dashScale"in t){this.dashScale=t.dashScale}if("opacity"in t){this.opacity=+t.opacity}var a=t.position||t.positions;if(!a){return}var i=t.color||t.colors||[0,0,0,1];var o=t.lineWidth||1;var u=[];var c=[];var f=[];var h=0;var d=0;var v=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];var g=false;t:for(e=1;e<a.length;++e){var m=a[e-1];var y=a[e];c.push(h);f.push(m.slice());for(r=0;r<3;++r){if(isNaN(m[r])||isNaN(y[r])||!isFinite(m[r])||!isFinite(y[r])){if(!n&&u.length>0){for(var x=0;x<24;++x){u.push(u[u.length-12])}d+=2;g=true}continue t}v[0][r]=Math.min(v[0][r],m[r],y[r]);v[1][r]=Math.max(v[1][r],m[r],y[r])}var b,_;if(Array.isArray(i[0])){b=i[e-1];_=i[e]}else{b=_=i}if(b.length===3){b=[b[0],b[1],b[2],1]}if(_.length===3){_=[_[0],_[1],_[2],1]}var w;if(Array.isArray(o)){w=o[e-1]}else{w=o}var k=h;h+=p(m,y);if(g){for(r=0;r<2;++r){u.push(m[0],m[1],m[2],y[0],y[1],y[2],k,w,b[0],b[1],b[2],b[3])}d+=2;g=false}u.push(m[0],m[1],m[2],y[0],y[1],y[2],k,w,b[0],b[1],b[2],b[3],m[0],m[1],m[2],y[0],y[1],y[2],k,-w,b[0],b[1],b[2],b[3],y[0],y[1],y[2],m[0],m[1],m[2],h,-w,_[0],_[1],_[2],_[3],y[0],y[1],y[2],m[0],m[1],m[2],h,w,_[0],_[1],_[2],_[3]);d+=4}this.buffer.update(u);c.push(h);f.push(a[a.length-1].slice());this.bounds=v;this.vertexCount=d;this.points=f;this.arcLength=c;if("dashes"in t){var M=t.dashes;var A=M.slice();A.unshift(0);for(e=1;e<A.length;++e){A[e]=A[e-1]+A[e]}var T=l(new Array(256*4),[256,1,4]);for(e=0;e<256;++e){for(r=0;r<4;++r){T.set(e,0,r,0)}if(s.le(A,A[A.length-1]*e/255)&1){T.set(e,0,0,0)}else{T.set(e,0,0,255)}}this.texture.setPixels(T)}};m.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()};m.pick=function(t){if(!t){return null}if(t.id!==this.pickId){return null}var e=o(t.value[0],t.value[1],t.value[2],0);var r=s.le(this.arcLength,e);if(r<0){return null}if(r===this.arcLength.length-1){return new v(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),r)}var n=this.points[r];var a=this.points[Math.min(r+1,this.points.length-1)];var i=(e-this.arcLength[r])/(this.arcLength[r+1]-this.arcLength[r]);var l=1-i;var u=[0,0,0];for(var c=0;c<3;++c){u[c]=l*n[c]+i*a[c]}var f=Math.min(i<.5?r:r+1,this.points.length-1);return new v(e,u,f,this.points[f])};function y(t){var e=t.gl||t.scene&&t.scene.gl;var r=c(e);r.attributes.position.location=0;r.attributes.nextPosition.location=1;r.attributes.arcLength.location=2;r.attributes.lineWidth.location=3;r.attributes.color.location=4;var o=f(e);o.attributes.position.location=0;o.attributes.nextPosition.location=1;o.attributes.arcLength.location=2;o.attributes.lineWidth.location=3;o.attributes.color.location=4;var s=n(e);var u=a(e,[{buffer:s,size:3,offset:0,stride:48},{buffer:s,size:3,offset:12,stride:48},{buffer:s,size:1,offset:24,stride:48},{buffer:s,size:1,offset:28,stride:48},{buffer:s,size:4,offset:32,stride:48}]);var h=l(new Array(256*4),[256,1,4]);for(var p=0;p<256*4;++p){h.data[p]=255}var d=i(e,h);d.wrap=e.REPEAT;var v=new g(e,r,o,s,u,d);v.update(t);return v}},{"./lib/shaders":244,"binary-search-bounds":79,"gl-buffer":230,"gl-texture2d":303,"gl-vao":308,"glsl-read-float":368,ndarray:417}],246:[function(t,e,r){e.exports=n;function n(t,e){var r=e[0];var n=e[1];var a=e[2];var i=e[3];var o=r*i-a*n;if(!o)return null;o=1/o;t[0]=i*o;t[1]=-n*o;t[2]=-a*o;t[3]=r*o;return t}},{}],247:[function(t,e,r){e.exports=n;function n(t,e){var r=e[0],n=e[1],a=e[2];var i=e[3],o=e[4],s=e[5];var l=e[6],u=e[7],c=e[8];var f=c*o-s*u;var h=-c*i+s*l;var p=u*i-o*l;var d=r*f+n*h+a*p;if(!d)return null;d=1/d;t[0]=f*d;t[1]=(-c*n+a*u)*d;t[2]=(s*n-a*o)*d;t[3]=h*d;t[4]=(c*r-a*l)*d;t[5]=(-s*r+a*i)*d;t[6]=p*d;t[7]=(-u*r+n*l)*d;t[8]=(o*r-n*i)*d;return t}},{}],248:[function(t,e,r){e.exports=n;function n(t){var e=new Float32Array(16);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e}},{}],249:[function(t,e,r){e.exports=n;function n(){var t=new Float32Array(16);t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t}},{}],250:[function(t,e,r){e.exports=n;function n(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],f=t[10],h=t[11],p=t[12],d=t[13],v=t[14],g=t[15],m=e*o-r*i,y=e*s-n*i,x=e*l-a*i,b=r*s-n*o,_=r*l-a*o,w=n*l-a*s,k=u*d-c*p,M=u*v-f*p,A=u*g-h*p,T=c*v-f*d,S=c*g-h*d,E=f*g-h*v;return m*E-y*S+x*T+b*A-_*M+w*k}},{}],251:[function(t,e,r){e.exports=n;function n(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r+r,s=n+n,l=a+a,u=r*o,c=n*o,f=n*s,h=a*o,p=a*s,d=a*l,v=i*o,g=i*s,m=i*l;t[0]=1-f-d;t[1]=c+m;t[2]=h-g;t[3]=0;t[4]=c-m;t[5]=1-u-d;t[6]=p+v;t[7]=0;t[8]=h+g;t[9]=p-v;t[10]=1-u-f;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t}},{}],252:[function(t,e,r){e.exports=n;function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=n+n,l=a+a,u=i+i,c=n*s,f=n*l,h=n*u,p=a*l,d=a*u,v=i*u,g=o*s,m=o*l,y=o*u;t[0]=1-(p+v);t[1]=f+y;t[2]=h-m;t[3]=0;t[4]=f-y;t[5]=1-(c+v);t[6]=d+g;t[7]=0;t[8]=h+m;t[9]=d-g;t[10]=1-(c+p);t[11]=0;t[12]=r[0];t[13]=r[1];t[14]=r[2];t[15]=1;return t}},{}],253:[function(t,e,r){e.exports=n;function n(t){t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t}},{}],254:[function(t,e,r){e.exports=n;function n(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],p=e[11],d=e[12],v=e[13],g=e[14],m=e[15],y=r*s-n*o,x=r*l-a*o,b=r*u-i*o,_=n*l-a*s,w=n*u-i*s,k=a*u-i*l,M=c*v-f*d,A=c*g-h*d,T=c*m-p*d,S=f*g-h*v,E=f*m-p*v,C=h*m-p*g,L=y*C-x*E+b*S+_*T-w*A+k*M;if(!L){return null}L=1/L;t[0]=(s*C-l*E+u*S)*L;t[1]=(a*E-n*C-i*S)*L;t[2]=(v*k-g*w+m*_)*L;t[3]=(h*w-f*k-p*_)*L;t[4]=(l*T-o*C-u*A)*L;t[5]=(r*C-a*T+i*A)*L;t[6]=(g*b-d*k-m*x)*L;t[7]=(c*k-h*b+p*x)*L;t[8]=(o*E-s*T+u*M)*L;t[9]=(n*T-r*E-i*M)*L;t[10]=(d*w-v*b+m*y)*L;t[11]=(f*b-c*w-p*y)*L;t[12]=(s*A-o*S-l*M)*L;t[13]=(r*S-n*A+a*M)*L;t[14]=(v*x-d*_-g*y)*L;t[15]=(c*_-f*x+h*y)*L;return t}},{}],255:[function(t,e,r){var n=t("./identity");e.exports=a;function a(t,e,r,a){var i,o,s,l,u,c,f,h,p,d,v=e[0],g=e[1],m=e[2],y=a[0],x=a[1],b=a[2],_=r[0],w=r[1],k=r[2];if(Math.abs(v-_)<1e-6&&Math.abs(g-w)<1e-6&&Math.abs(m-k)<1e-6){return n(t)}f=v-_;h=g-w;p=m-k;d=1/Math.sqrt(f*f+h*h+p*p);f*=d;h*=d;p*=d;i=x*p-b*h;o=b*f-y*p;s=y*h-x*f;d=Math.sqrt(i*i+o*o+s*s);if(!d){i=0;o=0;s=0}else{d=1/d;i*=d;o*=d;s*=d}l=h*s-p*o;u=p*i-f*s;c=f*o-h*i;d=Math.sqrt(l*l+u*u+c*c);if(!d){l=0;u=0;c=0}else{d=1/d;l*=d;u*=d;c*=d}t[0]=i;t[1]=l;t[2]=f;t[3]=0;t[4]=o;t[5]=u;t[6]=h;t[7]=0;t[8]=s;t[9]=c;t[10]=p;t[11]=0;t[12]=-(i*v+o*g+s*m);t[13]=-(l*v+u*g+c*m);t[14]=-(f*v+h*g+p*m);t[15]=1;return t}},{"./identity":253}],256:[function(t,e,r){e.exports=n;function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],p=e[10],d=e[11],v=e[12],g=e[13],m=e[14],y=e[15];var x=r[0],b=r[1],_=r[2],w=r[3];t[0]=x*n+b*s+_*f+w*v;t[1]=x*a+b*l+_*h+w*g;t[2]=x*i+b*u+_*p+w*m;t[3]=x*o+b*c+_*d+w*y;x=r[4];b=r[5];_=r[6];w=r[7];t[4]=x*n+b*s+_*f+w*v;t[5]=x*a+b*l+_*h+w*g;t[6]=x*i+b*u+_*p+w*m;t[7]=x*o+b*c+_*d+w*y;x=r[8];b=r[9];_=r[10];w=r[11];t[8]=x*n+b*s+_*f+w*v;t[9]=x*a+b*l+_*h+w*g;t[10]=x*i+b*u+_*p+w*m;t[11]=x*o+b*c+_*d+w*y;x=r[12];b=r[13];_=r[14];w=r[15];t[12]=x*n+b*s+_*f+w*v;t[13]=x*a+b*l+_*h+w*g;t[14]=x*i+b*u+_*p+w*m;t[15]=x*o+b*c+_*d+w*y;return t}},{}],257:[function(t,e,r){e.exports=n;function n(t,e,r,n,a){var i=1/Math.tan(e/2),o=1/(n-a);t[0]=i/r;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=i;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=(a+n)*o;t[11]=-1;t[12]=0;t[13]=0;t[14]=2*a*n*o;t[15]=0;return t}},{}],258:[function(t,e,r){e.exports=n;function n(t,e,r,n){var a=n[0],i=n[1],o=n[2],s=Math.sqrt(a*a+i*i+o*o),l,u,c,f,h,p,d,v,g,m,y,x,b,_,w,k,M,A,T,S,E,C,L,I;if(Math.abs(s)<1e-6){return null}s=1/s;a*=s;i*=s;o*=s;l=Math.sin(r);u=Math.cos(r);c=1-u;f=e[0];h=e[1];p=e[2];d=e[3];v=e[4];g=e[5];m=e[6];y=e[7];x=e[8];b=e[9];_=e[10];w=e[11];k=a*a*c+u;M=i*a*c+o*l;A=o*a*c-i*l;T=a*i*c-o*l;S=i*i*c+u;E=o*i*c+a*l;C=a*o*c+i*l;L=i*o*c-a*l;I=o*o*c+u;t[0]=f*k+v*M+x*A;t[1]=h*k+g*M+b*A;t[2]=p*k+m*M+_*A;t[3]=d*k+y*M+w*A;t[4]=f*T+v*S+x*E;t[5]=h*T+g*S+b*E;t[6]=p*T+m*S+_*E;t[7]=d*T+y*S+w*E;t[8]=f*C+v*L+x*I;t[9]=h*C+g*L+b*I;t[10]=p*C+m*L+_*I;t[11]=d*C+y*L+w*I;if(e!==t){t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}return t}},{}],259:[function(t,e,r){e.exports=n;function n(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],f=e[10],h=e[11];if(e!==t){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}t[4]=i*a+u*n;t[5]=o*a+c*n;t[6]=s*a+f*n;t[7]=l*a+h*n;t[8]=u*a-i*n;t[9]=c*a-o*n;t[10]=f*a-s*n;t[11]=h*a-l*n;return t}},{}],260:[function(t,e,r){e.exports=n;function n(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],s=e[2],l=e[3],u=e[8],c=e[9],f=e[10],h=e[11];if(e!==t){t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}t[0]=i*a-u*n;t[1]=o*a-c*n;t[2]=s*a-f*n;t[3]=l*a-h*n;t[8]=i*n+u*a;t[9]=o*n+c*a;t[10]=s*n+f*a;t[11]=l*n+h*a;return t}},{}],261:[function(t,e,r){e.exports=n;function n(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],f=e[6],h=e[7];if(e!==t){t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}t[0]=i*a+u*n;t[1]=o*a+c*n;t[2]=s*a+f*n;t[3]=l*a+h*n;t[4]=u*a-i*n;t[5]=c*a-o*n;t[6]=f*a-s*n;t[7]=h*a-l*n;return t}},{}],262:[function(t,e,r){e.exports=n;function n(t,e,r){var n=r[0],a=r[1],i=r[2];t[0]=e[0]*n;t[1]=e[1]*n;t[2]=e[2]*n;t[3]=e[3]*n;t[4]=e[4]*a;t[5]=e[5]*a;t[6]=e[6]*a;t[7]=e[7]*a;t[8]=e[8]*i;t[9]=e[9]*i;t[10]=e[10]*i;t[11]=e[11]*i;t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t}},{}],263:[function(t,e,r){e.exports=n;function n(t,e,r){var n=r[0],a=r[1],i=r[2],o,s,l,u,c,f,h,p,d,v,g,m;if(e===t){t[12]=e[0]*n+e[4]*a+e[8]*i+e[12];t[13]=e[1]*n+e[5]*a+e[9]*i+e[13];t[14]=e[2]*n+e[6]*a+e[10]*i+e[14];t[15]=e[3]*n+e[7]*a+e[11]*i+e[15]}else{o=e[0];s=e[1];l=e[2];u=e[3];c=e[4];f=e[5];h=e[6];p=e[7];d=e[8];v=e[9];g=e[10];m=e[11];t[0]=o;t[1]=s;t[2]=l;t[3]=u;t[4]=c;t[5]=f;t[6]=h;t[7]=p;t[8]=d;t[9]=v;t[10]=g;t[11]=m;t[12]=o*n+c*a+d*i+e[12];t[13]=s*n+f*a+v*i+e[13];t[14]=l*n+h*a+g*i+e[14];t[15]=u*n+p*a+m*i+e[15]}return t}},{}],264:[function(t,e,r){e.exports=n;function n(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],i=e[6],o=e[7],s=e[11];t[1]=e[4];t[2]=e[8];t[3]=e[12];t[4]=r;t[6]=e[9];t[7]=e[13];t[8]=n;t[9]=i;t[11]=e[14];t[12]=a;t[13]=o;t[14]=s}else{t[0]=e[0];t[1]=e[4];t[2]=e[8];t[3]=e[12];t[4]=e[1];t[5]=e[5];t[6]=e[9];t[7]=e[13];t[8]=e[2];t[9]=e[6];t[10]=e[10];t[11]=e[14];t[12]=e[3];t[13]=e[7];t[14]=e[11];t[15]=e[15]}return t}},{}],265:[function(t,e,r){"use strict";e.exports=o;var n=t("gl-mat2/invert");var a=t("gl-mat3/invert");var i=t("gl-mat4/invert");function o(t,e){switch(e.length){case 0:break;case 1:t[0]=1/e[0];break;case 4:n(t,e);break;case 9:a(t,e);break;case 16:i(t,e);break;default:throw new Error("currently supports matrices up to 4x4");break}return t}},{"gl-mat2/invert":246,"gl-mat3/invert":247,"gl-mat4/invert":254}],266:[function(t,e,r){"use strict";var n=t("barycentric");var a=t("polytope-closest-point/lib/closest_point_2d.js");e.exports=u;function i(t,e){var r=[0,0,0,0];for(var n=0;n<4;++n){for(var a=0;a<4;++a){r[a]+=t[4*n+a]*e[n]}}return r}function o(t,e,r,n,a){var o=i(n,i(r,i(e,[t[0],t[1],t[2],1])));for(var s=0;s<3;++s){o[s]/=o[3]}return[.5*a[0]*(1+o[0]),.5*a[1]*(1-o[1])]}function s(t,e){if(t.length===2){var r=0;var i=0;for(var o=0;o<2;++o){r+=Math.pow(e[o]-t[0][o],2);i+=Math.pow(e[o]-t[1][o],2)}r=Math.sqrt(r);i=Math.sqrt(i);if(r+i<1e-6){return[1,0]}return[i/(r+i),r/(i+r)]}else if(t.length===3){var s=[0,0];a(t[0],t[1],t[2],e,s);return n(t,s)}return[]}function l(t,e){var r=[0,0,0];for(var n=0;n<t.length;++n){var a=t[n];var i=e[n];for(var o=0;o<3;++o){r[o]+=i*a[o]}}return r}function u(t,e,r,n,a,i){if(t.length===1){return[0,t[0].slice()]}var u=new Array(t.length);for(var c=0;c<t.length;++c){u[c]=o(t[c],r,n,a,i)}var f=0;var h=Infinity;for(var c=0;c<u.length;++c){var p=0;for(var d=0;d<2;++d){p+=Math.pow(u[c][d]-e[d],2)}if(p<h){h=p;f=c}}var v=s(u,e);var g=0;for(var c=0;c<3;++c){if(v[c]<-.001||v[c]>1.0001){return null}g+=v[c]}if(Math.abs(g-1)>.001){return null}return[f,l(t,v),v]}},{barycentric:61,"polytope-closest-point/lib/closest_point_2d.js":448}],267:[function(t,e,r){var n=t("glslify");var a=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec4 m_position  = model * vec4(position, 1.0);\n  vec4 t_position  = view * m_position;\n  gl_Position      = projection * t_position;\n  f_color          = color;\n  f_normal         = normal;\n  f_data           = position;\n  f_eyeDirection   = eyePosition   - position;\n  f_lightDirection = lightPosition - position;\n  f_uv             = uv;\n}\n"]);var i=n(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nvec3 normals(vec3 pos) {\n  vec3 fdx = dFdx(pos);\n  vec3 fdy = dFdy(pos);\n  return normalize(cross(fdx, fdy));\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(f_data, clipBounds[0])) ||\n     any(greaterThan(f_data, clipBounds[1]))) {\n    discard;\n  }\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  vec3 normal = normals(f_data);\n\n  if (\n    dot(N, normal) < 0.0\n    ) {\n      N = -N;\n  }\n\n  float specular = cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]);var s=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(f_data, clipBounds[0])) || \n     any(greaterThan(f_data, clipBounds[1]))) {\n    discard;\n  }\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]);var l=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || \n     any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]);var u=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5,0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]);var c=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]);var f=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if(any(lessThan(f_position, clipBounds[0])) || \n     any(greaterThan(f_position, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);var h=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || \n     any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]);var p=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]);var d=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor,1);\n}\n"]);r.meshShader={vertex:a,fragment:i,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]};r.wireShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]};r.pointShader={vertex:l,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]};r.pickShader={vertex:c,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]};r.pointPickShader={vertex:h,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]};r.contourShader={vertex:p,fragment:d,attributes:[{name:"position",type:"vec3"}]}},{glslify:377}],268:[function(t,e,r){"use strict";var n=1e-6;var a=1e-6;var i=t("gl-shader");var o=t("gl-buffer");var s=t("gl-vao");var l=t("gl-texture2d");var u=t("normals");var c=t("gl-mat4/multiply");var f=t("gl-mat4/invert");var h=t("ndarray");var p=t("colormap");var d=t("simplicial-complex-contour");var v=t("typedarray-pool");var g=t("./lib/shaders");var m=t("./lib/closest-point");var y=g.meshShader;var x=g.wireShader;var b=g.pointShader;var _=g.pickShader;var w=g.pointPickShader;var k=g.contourShader;var M=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function A(t,e,r,n,a,i,o,s,l,u,c,f,h,p,d,v,g,m,y,x,b,_,w,k,A,T,S){this.gl=t;this.cells=[];this.positions=[];this.intensity=[];this.texture=e;this.dirty=true;this.triShader=r;this.lineShader=n;this.pointShader=a;this.pickShader=i;this.pointPickShader=o;this.contourShader=s;this.trianglePositions=l;this.triangleColors=c;this.triangleNormals=h;this.triangleUVs=f;this.triangleIds=u;this.triangleVAO=p;this.triangleCount=0;this.lineWidth=1;this.edgePositions=d;this.edgeColors=g;this.edgeUVs=m;this.edgeIds=v;this.edgeVAO=y;this.edgeCount=0;this.pointPositions=x;this.pointColors=_;this.pointUVs=w;this.pointSizes=k;this.pointIds=b;this.pointVAO=A;this.pointCount=0;this.contourLineWidth=1;this.contourPositions=T;this.contourVAO=S;this.contourCount=0;this.contourColor=[0,0,0];this.contourEnable=true;this.pickId=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[1e5,1e5,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.opacity=1;this._model=M;this._view=M;this._projection=M;this._resolution=[1,1]}var T=A.prototype;T.isOpaque=function(){return this.opacity>=1};T.isTransparent=function(){return this.opacity<1};T.pickSlots=1;T.setPickBase=function(t){this.pickId=t};function S(t){var e=p({colormap:t,nshades:256,format:"rgba"});var r=new Uint8Array(256*4);for(var n=0;n<256;++n){var a=e[n];for(var i=0;i<3;++i){r[4*n+i]=a[i]}r[4*n+3]=a[3]*255}return h(r,[256,256,4],[4,0,1])}function E(t,e,r){var n=new Array(e);for(var a=0;a<e;++a){n[a]=0}var i=t.length;for(var a=0;a<i;++a){var o=t[a];for(var s=0;s<o.length;++s){n[o[s]]=r[a]}}return n}function C(t){var e=t.length;var r=new Array(e);for(var n=0;n<e;++n){r[n]=t[n][2]}return r}T.highlight=function(t){if(!t||!this.contourEnable){this.contourCount=0;return}var e=d(this.cells,this.intensity,t.intensity);var r=e.cells;var n=e.vertexIds;var a=e.vertexWeights;var i=r.length;var o=v.mallocFloat32(2*3*i);var s=0;for(var l=0;l<i;++l){var u=r[l];for(var c=0;c<2;++c){var f=u[0];if(u.length===2){f=u[c]}var h=n[f][0];var p=n[f][1];var g=a[f];var m=1-g;var y=this.positions[h];var x=this.positions[p];for(var b=0;b<3;++b){o[s++]=g*y[b]+m*x[b]}}}this.contourCount=s/3|0;this.contourPositions.update(o.subarray(0,s));v.free(o)};T.update=function(t){t=t||{};var e=this.gl;this.dirty=true;if("contourEnable"in t){this.contourEnable=t.contourEnable}if("contourColor"in t){this.contourColor=t.contourColor}if("lineWidth"in t){this.lineWidth=t.lineWidth}if("lightPosition"in t){this.lightPosition=t.lightPosition}if("opacity"in t){this.opacity=t.opacity}if("ambient"in t){this.ambientLight=t.ambient}if("diffuse"in t){this.diffuseLight=t.diffuse}if("specular"in t){this.specularLight=t.specular}if("roughness"in t){this.roughness=t.roughness}if("fresnel"in t){this.fresnel=t.fresnel}if(t.texture){this.texture.dispose();this.texture=l(e,t.texture)}else if(t.colormap){this.texture.shape=[256,256];this.texture.minFilter=e.LINEAR_MIPMAP_LINEAR;this.texture.magFilter=e.LINEAR;this.texture.setPixels(S(t.colormap));this.texture.generateMipmap()}var r=t.cells;var i=t.positions;if(!i||!r){return}var o=[];var s=[];var c=[];var f=[];var h=[];var p=[];var d=[];var v=[];var g=[];var m=[];var y=[];var x=[];var b=[];var _=[];this.cells=r;this.positions=i;var w=t.vertexNormals;var k=t.cellNormals;var M=t.vertexNormalsEpsilon===void 0?n:t.vertexNormalsEpsilon;var A=t.faceNormalsEpsilon===void 0?a:t.faceNormalsEpsilon;if(t.useFacetNormals&&!k){k=u.faceNormals(r,i,A)}if(!k&&!w){w=u.vertexNormals(r,i,M)}var T=t.vertexColors;var L=t.cellColors;var I=t.meshColor||[1,1,1,1];var z=t.vertexUVs;var P=t.vertexIntensity;var O=t.cellUVs;var D=t.cellIntensity;var R=Infinity;var B=-Infinity;if(!z&&!O){if(P){if(t.vertexIntensityBounds){R=+t.vertexIntensityBounds[0];B=+t.vertexIntensityBounds[1]}else{for(var F=0;F<P.length;++F){var N=P[F];R=Math.min(R,N);B=Math.max(B,N)}}}else if(D){for(var F=0;F<D.length;++F){var N=D[F];R=Math.min(R,N);B=Math.max(B,N)}}else{for(var F=0;F<i.length;++F){var N=i[F][2];R=Math.min(R,N);B=Math.max(B,N)}}}if(P){this.intensity=P}else if(D){this.intensity=E(r,i.length,D)}else{this.intensity=C(i)}var j=t.pointSizes;var V=t.pointSize||1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(var F=0;F<i.length;++F){var U=i[F];for(var q=0;q<3;++q){if(isNaN(U[q])||!isFinite(U[q])){continue}this.bounds[0][q]=Math.min(this.bounds[0][q],U[q]);this.bounds[1][q]=Math.max(this.bounds[1][q],U[q])}}var H=0;var G=0;var W=0;t:for(var F=0;F<r.length;++F){var Y=r[F];switch(Y.length){case 1:var X=Y[0];var U=i[X];for(var q=0;q<3;++q){if(isNaN(U[q])||!isFinite(U[q])){continue t}}m.push(U[0],U[1],U[2]);var Z;if(T){Z=T[X]}else if(L){Z=L[F]}else{Z=I}if(Z.length===3){y.push(Z[0],Z[1],Z[2],1)}else{y.push(Z[0],Z[1],Z[2],Z[3])}var $;if(z){$=z[X]}else if(P){$=[(P[X]-R)/(B-R),0]}else if(O){$=O[F]}else if(D){$=[(D[F]-R)/(B-R),0]}else{$=[(U[2]-R)/(B-R),0]}x.push($[0],$[1]);if(j){b.push(j[X])}else{b.push(V)}_.push(F);W+=1;break;case 2:for(var q=0;q<2;++q){var X=Y[q];var U=i[X];for(var J=0;J<3;++J){if(isNaN(U[J])||!isFinite(U[J])){continue t}}}for(var q=0;q<2;++q){var X=Y[q];var U=i[X];p.push(U[0],U[1],U[2]);var Z;if(T){Z=T[X]}else if(L){Z=L[F]}else{Z=I}if(Z.length===3){d.push(Z[0],Z[1],Z[2],1)}else{d.push(Z[0],Z[1],Z[2],Z[3])}var $;if(z){$=z[X]}else if(P){$=[(P[X]-R)/(B-R),0]}else if(O){$=O[F]}else if(D){$=[(D[F]-R)/(B-R),0]}else{$=[(U[2]-R)/(B-R),0]}v.push($[0],$[1]);g.push(F)}G+=1;break;case 3:for(var q=0;q<3;++q){var X=Y[q];var U=i[X];for(var J=0;J<3;++J){if(isNaN(U[J])||!isFinite(U[J])){continue t}}}for(var q=0;q<3;++q){var X=Y[q];var U=i[X];o.push(U[0],U[1],U[2]);var Z;if(T){Z=T[X]}else if(L){Z=L[F]}else{Z=I}if(Z.length===3){s.push(Z[0],Z[1],Z[2],1)}else{s.push(Z[0],Z[1],Z[2],Z[3])}var $;if(z){$=z[X]}else if(P){$=[(P[X]-R)/(B-R),0]}else if(O){$=O[F]}else if(D){$=[(D[F]-R)/(B-R),0]}else{$=[(U[2]-R)/(B-R),0]}f.push($[0],$[1]);var K;if(w){K=w[X]}else{K=k[F]}c.push(K[0],K[1],K[2]);h.push(F)}H+=1;break;default:break}}this.pointCount=W;this.edgeCount=G;this.triangleCount=H;this.pointPositions.update(m);this.pointColors.update(y);this.pointUVs.update(x);this.pointSizes.update(b);this.pointIds.update(new Uint32Array(_));this.edgePositions.update(p);this.edgeColors.update(d);this.edgeUVs.update(v);this.edgeIds.update(new Uint32Array(g));this.trianglePositions.update(o);this.triangleColors.update(s);this.triangleUVs.update(f);this.triangleNormals.update(c);this.triangleIds.update(new Uint32Array(h))};T.drawTransparent=T.draw=function(t){t=t||{};var e=this.gl;var r=t.model||M;var n=t.view||M;var a=t.projection||M;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}var s={model:r,view:n,projection:a,clipBounds:i,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,contourColor:this.contourColor,texture:0};this.texture.bind(0);var l=new Array(16);c(l,s.view,s.model);c(l,s.projection,l);f(l,l);for(var o=0;o<3;++o){s.eyePosition[o]=l[12+o]/l[15]}var u=l[15];for(var o=0;o<3;++o){u+=this.lightPosition[o]*l[4*o+3]}for(var o=0;o<3;++o){var h=l[12+o];for(var p=0;p<3;++p){h+=l[4*p+o]*this.lightPosition[p]}s.lightPosition[o]=h/u}if(this.triangleCount>0){var d=this.triShader;d.bind();d.uniforms=s;this.triangleVAO.bind();e.drawArrays(e.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var d=this.lineShader;d.bind();d.uniforms=s;this.edgeVAO.bind();e.lineWidth(this.lineWidth);e.drawArrays(e.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var d=this.pointShader;d.bind();d.uniforms=s;this.pointVAO.bind();e.drawArrays(e.POINTS,0,this.pointCount);this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var d=this.contourShader;d.bind();d.uniforms=s;this.contourVAO.bind();e.drawArrays(e.LINES,0,this.contourCount);this.contourVAO.unbind()}};T.drawPick=function(t){t=t||{};var e=this.gl;var r=t.model||M;var n=t.view||M;var a=t.projection||M;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}this._model=[].slice.call(r);this._view=[].slice.call(n);this._projection=[].slice.call(a);this._resolution=[e.drawingBufferWidth,e.drawingBufferHeight];var s={model:r,view:n,projection:a,clipBounds:i,pickId:this.pickId/255};var l=this.pickShader;l.bind();l.uniforms=s;if(this.triangleCount>0){this.triangleVAO.bind();e.drawArrays(e.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0){this.edgeVAO.bind();e.lineWidth(this.lineWidth);e.drawArrays(e.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var l=this.pointPickShader;l.bind();l.uniforms=s;this.pointVAO.bind();e.drawArrays(e.POINTS,0,this.pointCount);this.pointVAO.unbind()}};T.pick=function(t){if(!t){return null}if(t.id!==this.pickId){return null}var e=t.value[0]+256*t.value[1]+65536*t.value[2];var r=this.cells[e];var n=this.positions;var a=new Array(r.length);for(var i=0;i<r.length;++i){a[i]=n[r[i]]}var o=m(a,[t.coord[0],this._resolution[1]-t.coord[1]],this._model,this._view,this._projection,this._resolution);if(!o){return null}var s=o[2];var l=0;for(var i=0;i<r.length;++i){l+=s[i]*this.intensity[r[i]]}return{position:o[1],index:r[o[0]],cell:r,cellId:e,intensity:l,dataCoordinate:this.positions[r[o[0]]]}};T.dispose=function(){this.texture.dispose();this.triShader.dispose();this.lineShader.dispose();this.pointShader.dispose();this.pickShader.dispose();this.pointPickShader.dispose();this.triangleVAO.dispose();this.trianglePositions.dispose();this.triangleColors.dispose();this.triangleUVs.dispose();this.triangleNormals.dispose();this.triangleIds.dispose();this.edgeVAO.dispose();this.edgePositions.dispose();this.edgeColors.dispose();this.edgeUVs.dispose();this.edgeIds.dispose();this.pointVAO.dispose();this.pointPositions.dispose();this.pointColors.dispose();this.pointUVs.dispose();this.pointSizes.dispose();this.pointIds.dispose();this.contourVAO.dispose();this.contourPositions.dispose();this.contourShader.dispose()};function L(t){var e=i(t,y.vertex,y.fragment);e.attributes.position.location=0;e.attributes.color.location=2;e.attributes.uv.location=3;e.attributes.normal.location=4;return e}function I(t){var e=i(t,x.vertex,x.fragment);e.attributes.position.location=0;e.attributes.color.location=2;e.attributes.uv.location=3;return e}function z(t){var e=i(t,b.vertex,b.fragment);e.attributes.position.location=0;e.attributes.color.location=2;e.attributes.uv.location=3;e.attributes.pointSize.location=4;return e}function P(t){var e=i(t,_.vertex,_.fragment);e.attributes.position.location=0;e.attributes.id.location=1;return e}function O(t){var e=i(t,w.vertex,w.fragment);e.attributes.position.location=0;e.attributes.id.location=1;e.attributes.pointSize.location=4;return e}function D(t){var e=i(t,k.vertex,k.fragment);e.attributes.position.location=0;return e}function R(t,e){if(arguments.length===1){e=t;t=e.gl}var r=t.getExtension("OES_standard_derivatives")||t.getExtension("MOZ_OES_standard_derivatives")||t.getExtension("WEBKIT_OES_standard_derivatives");if(!r)throw new Error("derivatives not supported");var n=L(t);var a=I(t);var i=z(t);var u=P(t);var c=O(t);var f=D(t);var p=l(t,h(new Uint8Array([255,255,255,255]),[1,1,4]));p.generateMipmap();p.minFilter=t.LINEAR_MIPMAP_LINEAR;p.magFilter=t.LINEAR;var d=o(t);var v=o(t);var g=o(t);var m=o(t);var y=o(t);var x=s(t,[{buffer:d,type:t.FLOAT,size:3},{buffer:y,type:t.UNSIGNED_BYTE,size:4,normalized:true},{buffer:v,type:t.FLOAT,size:4},{buffer:g,type:t.FLOAT,size:2},{buffer:m,type:t.FLOAT,size:3}]);var b=o(t);var _=o(t);var w=o(t);var k=o(t);var M=s(t,[{buffer:b,type:t.FLOAT,size:3},{buffer:k,type:t.UNSIGNED_BYTE,size:4,normalized:true},{buffer:_,type:t.FLOAT,size:4},{buffer:w,type:t.FLOAT,size:2}]);var T=o(t);var S=o(t);var E=o(t);var C=o(t);var R=o(t);var B=s(t,[{buffer:T,type:t.FLOAT,size:3},{buffer:R,type:t.UNSIGNED_BYTE,size:4,normalized:true},{buffer:S,type:t.FLOAT,size:4},{buffer:E,type:t.FLOAT,size:2},{buffer:C,type:t.FLOAT,size:1}]);var F=o(t);var N=s(t,[{buffer:F,type:t.FLOAT,size:3}]);var j=new A(t,p,n,a,i,u,c,f,d,y,v,g,m,x,b,k,_,w,M,T,R,S,E,C,B,F,N);j.update(e);return j}e.exports=R},{"./lib/closest-point":266,"./lib/shaders":267,colormap:113,"gl-buffer":230,"gl-mat4/invert":254,"gl-mat4/multiply":256,"gl-shader":287,"gl-texture2d":303,"gl-vao":308,ndarray:417,normals:420,"simplicial-complex-contour":479,"typedarray-pool":507}],269:[function(t,e,r){"use strict";e.exports=l;var n=t("gl-buffer");var a=t("gl-shader");var i=t("./shaders");function o(t,e,r){this.plot=t;this.vbo=e;this.shader=r}var s=o.prototype;s.bind=function(){var t=this.shader;this.vbo.bind();this.shader.bind();t.attributes.coord.pointer();t.uniforms.screenBox=this.plot.screenBox};s.drawBox=function(){var t=[0,0];var e=[0,0];return function(r,n,a,i,o){var s=this.plot;var l=this.shader;var u=s.gl;t[0]=r;t[1]=n;e[0]=a;e[1]=i;l.uniforms.lo=t;l.uniforms.hi=e;l.uniforms.color=o;u.drawArrays(u.TRIANGLE_STRIP,0,4)}}();s.dispose=function(){this.vbo.dispose();this.shader.dispose()};function l(t){var e=t.gl;var r=n(e,[0,0,0,1,1,0,1,1]);var s=a(e,i.boxVert,i.lineFrag);return new o(t,r,s)}},{"./shaders":272,"gl-buffer":230,"gl-shader":287}],270:[function(t,e,r){"use strict";e.exports=c;var n=t("gl-buffer");var a=t("gl-shader");var i=t("binary-search-bounds");var o=t("./shaders");function s(t,e,r,n){this.plot=t;this.vbo=e;this.shader=r;this.tickShader=n;this.ticks=[[],[]]}function l(t,e){return t-e}var u=s.prototype;u.draw=function(){var t=[0,0];var e=[0,0];var r=[0,0];return function(){var n=this.plot;var a=this.vbo;var i=this.shader;var o=this.ticks;var s=n.gl;var l=n._tickBounds;var u=n.dataBox;var c=n.viewBox;var f=n.gridLineWidth;var h=n.gridLineColor;var p=n.gridLineEnable;var d=n.pixelRatio;for(var v=0;v<2;++v){var g=l[v];var m=l[v+2];var y=m-g;var x=.5*(u[v+2]+u[v]);var b=u[v+2]-u[v];e[v]=2*y/b;t[v]=2*(g-x)/b}i.bind();a.bind();i.attributes.dataCoord.pointer();i.uniforms.dataShift=t;i.uniforms.dataScale=e;var _=0;for(var v=0;v<2;++v){r[0]=r[1]=0;r[v]=1;i.uniforms.dataAxis=r;i.uniforms.lineWidth=f[v]/(c[v+2]-c[v])*d;i.uniforms.color=h[v];var w=o[v].length*6;if(p[v]&&w){s.drawArrays(s.TRIANGLES,_,w)}_+=w}}}();u.drawTickMarks=function(){var t=[0,0];var e=[0,0];var r=[1,0];var n=[0,1];var a=[0,0];var o=[0,0];return function(){var s=this.plot;var u=this.vbo;var c=this.tickShader;var f=this.ticks;var h=s.gl;var p=s._tickBounds;var d=s.dataBox;var v=s.viewBox;var g=s.pixelRatio;var m=s.screenBox;var y=m[2]-m[0];var x=m[3]-m[1];var b=v[2]-v[0];var _=v[3]-v[1];for(var w=0;w<2;++w){var k=p[w];var M=p[w+2];var A=M-k;var T=.5*(d[w+2]+d[w]);var S=d[w+2]-d[w];e[w]=2*A/S;t[w]=2*(k-T)/S}e[0]*=b/y;t[0]*=b/y;e[1]*=_/x;t[1]*=_/x;c.bind();u.bind();c.attributes.dataCoord.pointer();var E=c.uniforms;E.dataShift=t;E.dataScale=e;var C=s.tickMarkLength;var L=s.tickMarkWidth;var I=s.tickMarkColor;var z=0;var P=f[0].length*6;var O=Math.min(i.ge(f[0],(d[0]-p[0])/(p[2]-p[0]),l),f[0].length);var D=Math.min(i.gt(f[0],(d[2]-p[0])/(p[2]-p[0]),l),f[0].length);var R=z+6*O;var B=6*Math.max(0,D-O);var F=Math.min(i.ge(f[1],(d[1]-p[1])/(p[3]-p[1]),l),f[1].length);var N=Math.min(i.gt(f[1],(d[3]-p[1])/(p[3]-p[1]),l),f[1].length);var j=P+6*F;var V=6*Math.max(0,N-F);a[0]=2*(v[0]-C[1])/y-1;a[1]=(v[3]+v[1])/x-1;o[0]=C[1]*g/y;o[1]=L[1]*g/x;if(V){E.color=I[1];E.tickScale=o;E.dataAxis=n;E.screenOffset=a;h.drawArrays(h.TRIANGLES,j,V)}a[0]=(v[2]+v[0])/y-1;a[1]=2*(v[1]-C[0])/x-1;o[0]=L[0]*g/y;o[1]=C[0]*g/x;if(B){E.color=I[0];E.tickScale=o;E.dataAxis=r;E.screenOffset=a;h.drawArrays(h.TRIANGLES,R,B)}a[0]=2*(v[2]+C[3])/y-1;a[1]=(v[3]+v[1])/x-1;o[0]=C[3]*g/y;o[1]=L[3]*g/x;if(V){E.color=I[3];E.tickScale=o;E.dataAxis=n;E.screenOffset=a;h.drawArrays(h.TRIANGLES,j,V)}a[0]=(v[2]+v[0])/y-1;a[1]=2*(v[3]+C[2])/x-1;o[0]=L[2]*g/y;o[1]=C[2]*g/x;if(B){E.color=I[2];E.tickScale=o;E.dataAxis=r;E.screenOffset=a;h.drawArrays(h.TRIANGLES,R,B)}}}();u.update=function(){var t=[1,1,-1,-1,1,-1];var e=[1,-1,1,1,-1,-1];return function(r){var n=r.ticks;var a=r.bounds;var i=new Float32Array(6*3*(n[0].length+n[1].length));var o=this.plot.zeroLineEnable;var s=0;var l=[[],[]];for(var u=0;u<2;++u){var c=l[u];var f=n[u];var h=a[u];var p=a[u+2];for(var d=0;d<f.length;++d){var v=(f[d].x-h)/(p-h);c.push(v);for(var g=0;g<6;++g){i[s++]=v;i[s++]=t[g];i[s++]=e[g]}}}this.ticks=l;this.vbo.update(i)}}();u.dispose=function(){this.vbo.dispose();this.shader.dispose();this.tickShader.dispose()};function c(t){var e=t.gl;var r=n(e);var i=a(e,o.gridVert,o.gridFrag);var l=a(e,o.tickVert,o.gridFrag);var u=new s(t,r,i,l);return u}},{"./shaders":272,"binary-search-bounds":274,"gl-buffer":230,"gl-shader":287}],271:[function(t,e,r){"use strict";e.exports=l;var n=t("gl-buffer");var a=t("gl-shader");var i=t("./shaders");function o(t,e,r){this.plot=t;this.vbo=e;this.shader=r}var s=o.prototype;s.bind=function(){var t=this.shader;this.vbo.bind();this.shader.bind();t.attributes.coord.pointer();t.uniforms.screenBox=this.plot.screenBox};s.drawLine=function(){var t=[0,0];var e=[0,0];return function(r,n,a,i,o,s){var l=this.plot;var u=this.shader;var c=l.gl;t[0]=r;t[1]=n;e[0]=a;e[1]=i;u.uniforms.start=t;u.uniforms.end=e;u.uniforms.width=o*l.pixelRatio;u.uniforms.color=s;c.drawArrays(c.TRIANGLE_STRIP,0,4)}}();s.dispose=function(){this.vbo.dispose();this.shader.dispose()};function l(t){var e=t.gl;var r=n(e,[-1,-1,-1,1,1,-1,1,1]);var s=a(e,i.lineVert,i.lineFrag);var l=new o(t,r,s);return l}},{"./shaders":272,"gl-buffer":230,"gl-shader":287}],272:[function(t,e,r){"use strict";var n=t("glslify");var a=n(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);e.exports={lineVert:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:a,textVert:n(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:a,gridVert:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:a,boxVert:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:377}],273:[function(t,e,r){"use strict";e.exports=c;var n=t("gl-buffer");var a=t("gl-shader");var i=t("text-cache");var o=t("binary-search-bounds");var s=t("./shaders");function l(t,e,r){this.plot=t;this.vbo=e;this.shader=r;this.tickOffset=[[],[]];this.tickX=[[],[]];this.labelOffset=[0,0];this.labelCount=[0,0]}var u=l.prototype;u.drawTicks=function(){var t=[0,0];var e=[0,0];var r=[0,0];return function(n){var a=this.plot;var i=this.shader;var s=this.tickX[n];var l=this.tickOffset[n];var u=a.gl;var c=a.viewBox;var f=a.dataBox;var h=a.screenBox;var p=a.pixelRatio;var d=a.tickEnable;var v=a.tickPad;var g=a.tickColor;var m=a.tickAngle;var y=a.labelEnable;var x=a.labelPad;var b=a.labelColor;var _=a.labelAngle;var w=this.labelOffset[n];var k=this.labelCount[n];var M=o.lt(s,f[n]);var A=o.le(s,f[n+2]);t[0]=t[1]=0;t[n]=1;e[n]=(c[2+n]+c[n])/(h[2+n]-h[n])-1;var T=2/h[2+(n^1)]-h[n^1];e[n^1]=T*c[n^1]-1;if(d[n]){e[n^1]-=T*p*v[n];if(M<A&&l[A]>l[M]){i.uniforms.dataAxis=t;i.uniforms.screenOffset=e;i.uniforms.color=g[n];i.uniforms.angle=m[n];u.drawArrays(u.TRIANGLES,l[M],l[A]-l[M])}}if(y[n]&&k){e[n^1]-=T*p*x[n];i.uniforms.dataAxis=r;i.uniforms.screenOffset=e;i.uniforms.color=b[n];i.uniforms.angle=_[n];u.drawArrays(u.TRIANGLES,w,k)}e[n^1]=T*c[2+(n^1)]-1;if(d[n+2]){e[n^1]+=T*p*v[n+2];if(M<A&&l[A]>l[M]){i.uniforms.dataAxis=t;i.uniforms.screenOffset=e;i.uniforms.color=g[n+2];i.uniforms.angle=m[n+2];u.drawArrays(u.TRIANGLES,l[M],l[A]-l[M])}}if(y[n+2]&&k){e[n^1]+=T*p*x[n+2];i.uniforms.dataAxis=r;i.uniforms.screenOffset=e;i.uniforms.color=b[n+2];i.uniforms.angle=_[n+2];u.drawArrays(u.TRIANGLES,w,k)}}}();u.drawTitle=function(){var t=[0,0];var e=[0,0];return function(){var r=this.plot;var n=this.shader;var a=r.gl;var i=r.screenBox;var o=r.titleCenter;var s=r.titleAngle;var l=r.titleColor;var u=r.pixelRatio;if(!this.titleCount){return}for(var c=0;c<2;++c){e[c]=2*(o[c]*u-i[c])/(i[2+c]-i[c])-1}n.bind();n.uniforms.dataAxis=t;n.uniforms.screenOffset=e;n.uniforms.angle=s;n.uniforms.color=l;a.drawArrays(a.TRIANGLES,this.titleOffset,this.titleCount)}}();u.bind=function(){var t=[0,0];var e=[0,0];var r=[0,0];return function(){var n=this.plot;var a=this.shader;var i=n._tickBounds;var o=n.dataBox;var s=n.screenBox;var l=n.viewBox;a.bind();for(var u=0;u<2;++u){var c=i[u];var f=i[u+2];var h=f-c;var p=.5*(o[u+2]+o[u]);var d=o[u+2]-o[u];var v=l[u];var g=l[u+2];var m=g-v;var y=s[u];var x=s[u+2];var b=x-y;e[u]=2*h/d*m/b;t[u]=2*(c-p)/d*m/b}r[1]=2*n.pixelRatio/(s[3]-s[1]);r[0]=r[1]*(s[3]-s[1])/(s[2]-s[0]);a.uniforms.dataScale=e;a.uniforms.dataShift=t;a.uniforms.textScale=r;this.vbo.bind();a.attributes.textCoordinate.pointer()}}();u.update=function(t){var e=[];var r=t.ticks;var n=t.bounds;var a,o,s,l,u,c;for(c=0;c<2;++c){var f=[Math.floor(e.length/3)],h=[-Infinity];var p=r[c];for(a=0;a<p.length;++a){var d=p[a];var v=d.x;var g=d.text;var m=d.font||"sans-serif";u=d.fontSize||12;var y=1/(n[c+2]-n[c]);var x=n[c];var b=g.split("\n");for(var _=0;_<b.length;_++){l=i(m,b[_]).data;for(o=0;o<l.length;o+=2){e.push(l[o]*u,-l[o+1]*u-_*u*1.2,(v-x)*y)}}f.push(Math.floor(e.length/3));h.push(v)}this.tickOffset[c]=f;this.tickX[c]=h}for(c=0;c<2;++c){this.labelOffset[c]=Math.floor(e.length/3);l=i(t.labelFont[c],t.labels[c],{textAlign:"center"}).data;u=t.labelSize[c];for(a=0;a<l.length;a+=2){e.push(l[a]*u,-l[a+1]*u,0)}this.labelCount[c]=Math.floor(e.length/3)-this.labelOffset[c]}this.titleOffset=Math.floor(e.length/3);l=i(t.titleFont,t.title).data;u=t.titleSize;for(a=0;a<l.length;a+=2){e.push(l[a]*u,-l[a+1]*u,0)}this.titleCount=Math.floor(e.length/3)-this.titleOffset;this.vbo.update(e)};u.dispose=function(){this.vbo.dispose();this.shader.dispose()};function c(t){var e=t.gl;var r=n(e);var i=a(e,s.textVert,s.textFrag);var o=new l(t,r,i);return o}},{"./shaders":272,"binary-search-bounds":274,"gl-buffer":230,"gl-shader":287,"text-cache":498}],274:[function(t,e,r){arguments[4][98][0].apply(r,arguments)},{dup:98}],275:[function(t,e,r){"use strict";e.exports=p;var n=t("gl-select-static");var a=t("./lib/grid");var i=t("./lib/text");var o=t("./lib/line");var s=t("./lib/box");function l(t,e){this.gl=t;this.pickBuffer=e;this.screenBox=[0,0,t.drawingBufferWidth,t.drawingBufferHeight];this.viewBox=[0,0,0,0];this.dataBox=[-10,-10,10,10];this.gridLineEnable=[true,true];this.gridLineWidth=[1,1];this.gridLineColor=[[0,0,0,1],[0,0,0,1]];this.pixelRatio=1;this.tickMarkLength=[0,0,0,0];this.tickMarkWidth=[0,0,0,0];this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[15,15,15,15];this.tickAngle=[0,0,0,0];this.tickEnable=[true,true,true,true];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[15,15,15,15];this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2];this.labelEnable=[true,true,true,true];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.titleCenter=[0,0];this.titleEnable=true;this.titleAngle=0;this.titleColor=[0,0,0,1];this.borderColor=[0,0,0,0];this.backgroundColor=[0,0,0,0];this.zeroLineEnable=[true,true];this.zeroLineWidth=[4,4];this.zeroLineColor=[[0,0,0,1],[0,0,0,1]];this.borderLineEnable=[true,true,true,true];this.borderLineWidth=[2,2,2,2];this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.grid=null;this.text=null;this.line=null;this.box=null;this.objects=[];this.overlays=[];this._tickBounds=[Infinity,Infinity,-Infinity,-Infinity];this.static=false;this.dirty=false;this.pickDirty=false;this.pickDelay=120;this.pickRadius=10;this._pickTimeout=null;this._drawPick=this.drawPick.bind(this);this._depthCounter=0}var u=l.prototype;u.setDirty=function(){this.dirty=this.pickDirty=true};u.setOverlayDirty=function(){this.dirty=true};u.nextDepthValue=function(){return this._depthCounter++/65536};function c(t,e,r){var n=.5*(r+1);return Math.floor((1-n)*t+n*e)|0}u.draw=function(){var t=[0,0,0,0];return function(){var t=this.gl;var e=this.screenBox;var r=this.viewBox;var n=this.dataBox;var a=this.pixelRatio;var i=this.grid;var o=this.line;var s=this.text;var l=this.objects;this._depthCounter=0;if(this.pickDirty){if(this._pickTimeout){clearTimeout(this._pickTimeout)}this.pickDirty=false;this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)}if(!this.dirty){return}this.dirty=false;t.bindFramebuffer(t.FRAMEBUFFER,null);t.enable(t.SCISSOR_TEST);t.disable(t.DEPTH_TEST);t.depthFunc(t.LESS);t.depthMask(false);t.enable(t.BLEND);t.blendEquation(t.FUNC_ADD,t.FUNC_ADD);t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA);if(this.borderColor){t.scissor(e[0],e[1],e[2]-e[0],e[3]-e[1]);var u=this.borderColor;t.clearColor(u[0]*u[3],u[1]*u[3],u[2]*u[3],u[3]);t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}t.scissor(r[0],r[1],r[2]-r[0],r[3]-r[1]);t.viewport(r[0],r[1],r[2]-r[0],r[3]-r[1]);var c=this.backgroundColor;t.clearColor(c[0]*c[3],c[1]*c[3],c[2]*c[3],c[3]);t.clear(t.COLOR_BUFFER_BIT);i.draw();var f=this.zeroLineEnable;var h=this.zeroLineColor;var p=this.zeroLineWidth;if(f[0]||f[1]){o.bind();for(var d=0;d<2;++d){if(!f[d]||!(n[d]<=0&&n[d+2]>=0)){continue}var v=e[d]-n[d]*(e[d+2]-e[d])/(n[d+2]-n[d]);if(d===0){o.drawLine(v,e[1],v,e[3],p[d],h[d])}else{o.drawLine(e[0],v,e[2],v,p[d],h[d])}}}for(var d=0;d<l.length;++d){l[d].draw()}t.viewport(e[0],e[1],e[2]-e[0],e[3]-e[1]);t.scissor(e[0],e[1],e[2]-e[0],e[3]-e[1]);this.grid.drawTickMarks();o.bind();var g=this.borderLineEnable;var m=this.borderLineWidth;var y=this.borderLineColor;if(g[1]){o.drawLine(r[0],r[1]-.5*m[1]*a,r[0],r[3]+.5*m[3]*a,m[1],y[1])}if(g[0]){o.drawLine(r[0]-.5*m[0]*a,r[1],r[2]+.5*m[2]*a,r[1],m[0],y[0])}if(g[3]){o.drawLine(r[2],r[1]-.5*m[1]*a,r[2],r[3]+.5*m[3]*a,m[3],y[3])}if(g[2]){o.drawLine(r[0]-.5*m[0]*a,r[3],r[2]+.5*m[2]*a,r[3],m[2],y[2])}s.bind();for(var d=0;d<2;++d){s.drawTicks(d)}if(this.titleEnable){s.drawTitle()}var x=this.overlays;for(var d=0;d<x.length;++d){x[d].draw()}t.disable(t.SCISSOR_TEST);t.disable(t.BLEND);t.depthMask(true)}}();u.drawPick=function(){return function(){if(this.static)return;var t=this.pickBuffer;var e=this.gl;this._pickTimeout=null;t.begin();var r=1;var n=this.objects;for(var a=0;a<n.length;++a){r=n[a].drawPick(r)}t.end()}}();u.pick=function(){return function(t,e){if(this.static)return;var r=this.pixelRatio;var n=this.pickPixelRatio;var a=this.viewBox;var i=Math.round((t-a[0]/r)*n)|0;var o=Math.round((e-a[1]/r)*n)|0;var s=this.pickBuffer.query(i,o,this.pickRadius);if(!s){return null}var l=s.id+(s.value[0]<<8)+(s.value[1]<<16)+(s.value[2]<<24);var u=this.objects;for(var c=0;c<u.length;++c){var f=u[c].pick(i,o,l);if(f){return f}}return null}}();function f(t){var e=t.slice();for(var r=0;r<e.length;++r){e[r]=e[r].slice()}return e}function h(t,e){return t.x-e.x}u.setScreenBox=function(t){var e=this.screenBox;var r=this.pixelRatio;e[0]=Math.round(t[0]*r)|0;e[1]=Math.round(t[1]*r)|0;e[2]=Math.round(t[2]*r)|0;e[3]=Math.round(t[3]*r)|0;this.setDirty()};u.setDataBox=function(t){var e=this.dataBox;var r=e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3];if(r){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];this.setDirty()}};u.setViewBox=function(t){var e=this.pixelRatio;var r=this.viewBox;r[0]=Math.round(t[0]*e)|0;r[1]=Math.round(t[1]*e)|0;r[2]=Math.round(t[2]*e)|0;r[3]=Math.round(t[3]*e)|0;var n=this.pickPixelRatio;this.pickBuffer.shape=[Math.round((t[2]-t[0])*n)|0,Math.round((t[3]-t[1])*n)|0];this.setDirty()};u.update=function(t){t=t||{};var e=this.gl;this.pixelRatio=t.pixelRatio||1;var r=this.pixelRatio;this.pickPixelRatio=Math.max(r,1);this.setScreenBox(t.screenBox||[0,0,e.drawingBufferWidth/r,e.drawingBufferHeight/r]);var n=this.screenBox;this.setViewBox(t.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/r,.125*(this.screenBox[3]-this.screenBox[1])/r,.875*(this.screenBox[2]-this.screenBox[0])/r,.875*(this.screenBox[3]-this.screenBox[1])/r]);var a=this.viewBox;var i=(a[2]-a[0])/(a[3]-a[1]);this.setDataBox(t.dataBox||[-10,-10/i,10,10/i]);this.borderColor=t.borderColor!==false?(t.borderColor||[0,0,0,0]).slice():false;this.backgroundColor=(t.backgroundColor||[0,0,0,0]).slice();this.gridLineEnable=(t.gridLineEnable||[true,true]).slice();this.gridLineWidth=(t.gridLineWidth||[1,1]).slice();this.gridLineColor=f(t.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]);this.zeroLineEnable=(t.zeroLineEnable||[true,true]).slice();this.zeroLineWidth=(t.zeroLineWidth||[4,4]).slice();this.zeroLineColor=f(t.zeroLineColor||[[0,0,0,1],[0,0,0,1]]);this.tickMarkLength=(t.tickMarkLength||[0,0,0,0]).slice();this.tickMarkWidth=(t.tickMarkWidth||[0,0,0,0]).slice();this.tickMarkColor=f(t.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);this.titleCenter=(t.titleCenter||[.5*(a[0]+a[2])/r,(a[3]+120)/r]).slice();this.titleEnable=!("titleEnable"in t)||!!t.titleEnable;this.titleAngle=t.titleAngle||0;this.titleColor=(t.titleColor||[0,0,0,1]).slice();this.labelPad=(t.labelPad||[15,15,15,15]).slice();this.labelAngle=(t.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice();this.labelEnable=(t.labelEnable||[true,true,true,true]).slice();this.labelColor=f(t.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);this.tickPad=(t.tickPad||[15,15,15,15]).slice();this.tickAngle=(t.tickAngle||[0,0,0,0]).slice();this.tickEnable=(t.tickEnable||[true,true,true,true]).slice();this.tickColor=f(t.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);this.borderLineEnable=(t.borderLineEnable||[true,true,true,true]).slice();this.borderLineWidth=(t.borderLineWidth||[2,2,2,2]).slice();this.borderLineColor=f(t.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var o=t.ticks||[[],[]];var s=this._tickBounds;s[0]=s[1]=Infinity;s[2]=s[3]=-Infinity;for(var l=0;l<2;++l){var u=o[l].slice(0);if(u.length===0){continue}u.sort(h);s[l]=Math.min(s[l],u[0].x);s[l+2]=Math.max(s[l+2],u[u.length-1].x)}this.grid.update({bounds:s,ticks:o});this.text.update({bounds:s,ticks:o,labels:t.labels||["x","y"],labelSize:t.labelSize||[12,12],labelFont:t.labelFont||["sans-serif","sans-serif"],title:t.title||"",titleSize:t.titleSize||18,titleFont:t.titleFont||"sans-serif"});this.static=!!t.static;this.setDirty()};u.dispose=function(){this.box.dispose();this.grid.dispose();this.text.dispose();this.line.dispose();for(var t=this.objects.length-1;t>=0;--t){this.objects[t].dispose()}this.objects.length=0;for(var t=this.overlays.length-1;t>=0;--t){this.overlays[t].dispose()}this.overlays.length=0;this.gl=null};u.addObject=function(t){if(this.objects.indexOf(t)<0){this.objects.push(t);this.setDirty()}};u.removeObject=function(t){var e=this.objects;for(var r=0;r<e.length;++r){if(e[r]===t){e.splice(r,1);this.setDirty();break}}};u.addOverlay=function(t){if(this.overlays.indexOf(t)<0){this.overlays.push(t);this.setOverlayDirty()}};u.removeOverlay=function(t){var e=this.overlays;for(var r=0;r<e.length;++r){if(e[r]===t){e.splice(r,1);this.setOverlayDirty();break}}};function p(t){var e=t.gl;var r=n(e,[e.drawingBufferWidth,e.drawingBufferHeight]);var u=new l(e,r);u.grid=a(u);u.text=i(u);u.line=o(u);u.box=s(u);u.update(t);return u}},{"./lib/box":269,"./lib/grid":270,"./lib/line":271,"./lib/text":273,"gl-select-static":286}],276:[function(t,e,r){var n=t("glslify");var a=t("gl-shader");var i=n(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);e.exports=function(t){return a(t,i,o,null,[{name:"position",type:"vec2"}])}},{"gl-shader":287,glslify:377}],277:[function(t,e,r){"use strict";e.exports=y;var n=t("3d-view-controls");var a=t("gl-axes3d");var i=t("gl-axes3d/properties");var o=t("gl-spikes3d");var s=t("gl-select-static");var l=t("gl-fbo");var u=t("a-big-triangle");var c=t("mouse-change");var f=t("gl-mat4/perspective");var h=t("./lib/shader");var p=t("is-mobile")();function d(){this.mouse=[-1,-1];this.screen=null;this.distance=Infinity;this.index=null;this.dataCoordinate=null;this.dataPosition=null;this.object=null;this.data=null}function v(t,e){var r=null;try{r=t.getContext("webgl",e);if(!r){r=t.getContext("experimental-webgl",e)}}catch(t){return null}return r}function g(t){var e=Math.round(Math.log(Math.abs(t))/Math.log(10));if(e<0){var r=Math.round(Math.pow(10,-e));return Math.ceil(t*r)/r}else if(e>0){var r=Math.round(Math.pow(10,e));return Math.ceil(t/r)*r}return Math.ceil(t)}function m(t){if(typeof t==="boolean"){return t}return true}function y(t){t=t||{};var e=false;var r=t.pixelRatio||parseFloat(window.devicePixelRatio);var y=t.canvas;if(!y){y=document.createElement("canvas");if(t.container){var x=t.container;x.appendChild(y)}else{document.body.appendChild(y)}}var b=t.gl;if(!b){b=v(y,t.glOptions||{premultipliedAlpha:true,antialias:true})}if(!b){throw new Error("webgl not supported")}var _=t.bounds||[[-10,-10,-10],[10,10,10]];var w=new d;var k=l(b,[b.drawingBufferWidth,b.drawingBufferHeight],{preferFloat:!p});var M=h(b);var A=t.camera||{eye:[2,0,0],center:[0,0,0],up:[0,1,0],zoomMin:.1,zoomMax:100,mode:"turntable"};var T=t.axes||{};var S=a(b,T);S.enable=!T.disable;var E=t.spikes||{};var C=o(b,E);var L=[];var I=[];var z=[];var P=[];var O=true;var D=true;var R=new Array(16);var B=new Array(16);var F={view:null,projection:R,model:B};var D=true;var N=[b.drawingBufferWidth,b.drawingBufferHeight];var j={gl:b,contextLost:false,pixelRatio:t.pixelRatio||parseFloat(window.devicePixelRatio),canvas:y,selection:w,camera:n(y,A),axes:S,axesPixels:null,spikes:C,bounds:_,objects:L,shape:N,aspect:t.aspectRatio||[1,1,1],pickRadius:t.pickRadius||10,zNear:t.zNear||.01,zFar:t.zFar||1e3,fovy:t.fovy||Math.PI/4,clearColor:t.clearColor||[0,0,0,0],autoResize:m(t.autoResize),autoBounds:m(t.autoBounds),autoScale:!!t.autoScale,autoCenter:m(t.autoCenter),clipToBounds:m(t.clipToBounds),snapToData:!!t.snapToData,onselect:t.onselect||null,onrender:t.onrender||null,onclick:t.onclick||null,cameraParams:F,oncontextloss:null,mouseListener:null};var V=[b.drawingBufferWidth/j.pixelRatio|0,b.drawingBufferHeight/j.pixelRatio|0];function U(){if(e){return}if(!j.autoResize){return}var t=y.parentNode;var r=1;var n=1;if(t&&t!==document.body){r=t.clientWidth;n=t.clientHeight}else{r=window.innerWidth;n=window.innerHeight}var a=Math.ceil(r*j.pixelRatio)|0;var i=Math.ceil(n*j.pixelRatio)|0;if(a!==y.width||i!==y.height){y.width=a;y.height=i;var o=y.style;o.position=o.position||"absolute";o.left="0px";o.top="0px";o.width=r+"px";o.height=n+"px";O=true}}if(j.autoResize){U()}window.addEventListener("resize",U);function q(){var t=L.length;var e=P.length;for(var r=0;r<e;++r){z[r]=0}t:for(var r=0;r<t;++r){var n=L[r];var a=n.pickSlots;if(!a){I[r]=-1;continue}for(var i=0;i<e;++i){if(z[i]+a<255){I[r]=i;n.setPickBase(z[i]+1);z[i]+=a;continue t}}var o=s(b,N);I[r]=e;P.push(o);z.push(a);n.setPickBase(1);e+=1}while(e>0&&z[e-1]===0){z.pop();P.pop().dispose()}}j.update=function(t){if(e){return}t=t||{};O=true;D=true};j.add=function(t){if(e){return}t.axes=S;L.push(t);I.push(-1);O=true;D=true;q()};j.remove=function(t){if(e){return}var r=L.indexOf(t);if(r<0){return}L.splice(r,1);I.pop();O=true;D=true;q()};j.dispose=function(){if(e){return}e=true;window.removeEventListener("resize",U);y.removeEventListener("webglcontextlost",W);j.mouseListener.enabled=false;if(j.contextLost){return}S.dispose();C.dispose();for(var t=0;t<L.length;++t){L[t].dispose()}k.dispose();for(var t=0;t<P.length;++t){P[t].dispose()}M.dispose();b=null;S=null;C=null;L=[]};var H=false;var G=0;j.mouseListener=c(y,function(t,r,n){if(e){return}var a=P.length;var i=L.length;var o=w.object;w.distance=Infinity;w.mouse[0]=r;w.mouse[1]=n;w.object=null;w.screen=null;w.dataCoordinate=w.dataPosition=null;var s=false;if(t&&G){H=true}else{if(H){D=true}H=false;for(var l=0;l<a;++l){var u=P[l].query(r,V[1]-n-1,j.pickRadius);if(u){if(u.distance>w.distance){continue}for(var c=0;c<i;++c){var f=L[c];if(I[c]!==l){continue}var h=f.pick(u);if(h){w.buttons=t;w.screen=u.coord;w.distance=u.distance;w.object=f;w.index=h.distance;w.dataPosition=h.position;w.dataCoordinate=h.dataCoordinate;w.data=h;s=true}}}}}if(o&&o!==w.object){if(o.highlight){o.highlight(null)}O=true}if(w.object){if(w.object.highlight){w.object.highlight(w.data)}O=true}s=s||w.object!==o;if(s&&j.onselect){j.onselect(w)}if(t&1&&!(G&1)&&j.onclick){j.onclick(w)}G=t});function W(){if(j.contextLost){return true}if(b.isContextLost()){j.contextLost=true;j.mouseListener.enabled=false;j.selection.object=null;if(j.oncontextloss){j.oncontextloss()}}}y.addEventListener("webglcontextlost",W);function Y(){if(W()){return}b.colorMask(true,true,true,true);b.depthMask(true);b.disable(b.BLEND);b.enable(b.DEPTH_TEST);var t=L.length;var e=P.length;for(var r=0;r<e;++r){var n=P[r];n.shape=V;n.begin();for(var a=0;a<t;++a){if(I[a]!==r){continue}var i=L[a];if(i.drawPick){i.pixelRatio=1;i.drawPick(F)}}n.end()}}var X=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];var Z=[X[0].slice(),X[1].slice()];function $(){if(W()){return}U();var t=j.camera.tick();F.view=j.camera.matrix;O=O||t;D=D||t;S.pixelRatio=j.pixelRatio;C.pixelRatio=j.pixelRatio;var e=L.length;var r=X[0];var n=X[1];r[0]=r[1]=r[2]=Infinity;n[0]=n[1]=n[2]=-Infinity;for(var a=0;a<e;++a){var o=L[a];o.pixelRatio=j.pixelRatio;o.axes=j.axes;O=O||!!o.dirty;D=D||!!o.dirty;var s=o.bounds;if(s){var l=s[0];var c=s[1];for(var h=0;h<3;++h){r[h]=Math.min(r[h],l[h]);n[h]=Math.max(n[h],c[h])}}}var p=j.bounds;if(j.autoBounds){for(var h=0;h<3;++h){if(n[h]<r[h]){r[h]=-1;n[h]=1}else{if(r[h]===n[h]){r[h]-=1;n[h]+=1}var d=.05*(n[h]-r[h]);r[h]=r[h]-d;n[h]=n[h]+d}p[0][h]=r[h];p[1][h]=n[h]}}var v=false;for(var h=0;h<3;++h){v=v||Z[0][h]!==p[0][h]||Z[1][h]!==p[1][h];Z[0][h]=p[0][h];Z[1][h]=p[1][h]}D=D||v;O=O||v;if(!O){return}if(v){var m=[0,0,0];for(var a=0;a<3;++a){m[a]=g((p[1][a]-p[0][a])/10)}if(S.autoTicks){S.update({bounds:p,tickSpacing:m})}else{S.update({bounds:p})}}var y=b.drawingBufferWidth;var x=b.drawingBufferHeight;N[0]=y;N[1]=x;V[0]=Math.max(y/j.pixelRatio,1)|0;V[1]=Math.max(x/j.pixelRatio,1)|0;f(R,j.fovy,y/x,j.zNear,j.zFar);for(var a=0;a<16;++a){B[a]=0}B[15]=1;var _=0;for(var a=0;a<3;++a){_=Math.max(_,p[1][a]-p[0][a])}for(var a=0;a<3;++a){if(j.autoScale){B[5*a]=j.aspect[a]/(p[1][a]-p[0][a])}else{B[5*a]=1/_}if(j.autoCenter){B[12+a]=-B[5*a]*.5*(p[0][a]+p[1][a])}}for(var a=0;a<e;++a){var o=L[a];o.axesBounds=p;if(j.clipToBounds){o.clipBounds=p}}if(w.object){if(j.snapToData){C.position=w.dataCoordinate}else{C.position=w.dataPosition}C.bounds=p}if(D){D=false;Y()}j.axesPixels=i(j.axes,F,y,x);if(j.onrender){j.onrender()}b.bindFramebuffer(b.FRAMEBUFFER,null);b.viewport(0,0,y,x);var A=j.clearColor;b.clearColor(A[0],A[1],A[2],A[3]);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);b.depthMask(true);b.colorMask(true,true,true,true);b.enable(b.DEPTH_TEST);b.depthFunc(b.LEQUAL);b.disable(b.BLEND);b.disable(b.CULL_FACE);var T=false;if(S.enable){T=T||S.isTransparent();S.draw(F)}C.axes=S;if(w.object){C.draw(F)}b.disable(b.CULL_FACE);for(var a=0;a<e;++a){var o=L[a];o.axes=S;o.pixelRatio=j.pixelRatio;if(o.isOpaque&&o.isOpaque()){o.draw(F)}if(o.isTransparent&&o.isTransparent()){T=true}}if(T){k.shape=N;k.bind();b.clear(b.DEPTH_BUFFER_BIT);b.colorMask(false,false,false,false);b.depthMask(true);b.depthFunc(b.LESS);if(S.enable&&S.isTransparent()){S.drawTransparent(F)}for(var a=0;a<e;++a){var o=L[a];if(o.isOpaque&&o.isOpaque()){o.draw(F)}}b.enable(b.BLEND);b.blendEquation(b.FUNC_ADD);b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA);b.colorMask(true,true,true,true);b.depthMask(false);b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT);if(S.isTransparent()){S.drawTransparent(F)}for(var a=0;a<e;++a){var o=L[a];if(o.isTransparent&&o.isTransparent()){o.drawTransparent(F)}}b.bindFramebuffer(b.FRAMEBUFFER,null);b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA);b.disable(b.DEPTH_TEST);M.bind();k.color[0].bind(0);M.uniforms.accumBuffer=0;u(b);b.disable(b.BLEND)}O=false;for(var a=0;a<e;++a){L[a].dirty=false}}function J(){if(e||j.contextLost){return}requestAnimationFrame(J);$()}J();j.redraw=function(){if(e){return}O=true;$()};return j}},{"./lib/shader":276,"3d-view-controls":42,"a-big-triangle":50,"gl-axes3d":222,"gl-axes3d/properties":229,"gl-fbo":239,"gl-mat4/perspective":257,"gl-select-static":286,"gl-spikes3d":296,"is-mobile":388,"mouse-change":402}],278:[function(t,e,r){var n=t("glslify");r.pointVertex=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]);r.pointFragment=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]);r.pickVertex=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]);r.pickFragment=n(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:377}],279:[function(t,e,r){"use strict";var n=t("gl-shader");var a=t("gl-buffer");var i=t("typedarray-pool");var o=t("./lib/shader");e.exports=c;function s(t,e,r,n,a){this.plot=t;this.offsetBuffer=e;this.pickBuffer=r;this.shader=n;this.pickShader=a;this.sizeMin=.5;this.sizeMinCap=2;this.sizeMax=20;this.areaRatio=1;this.pointCount=0;this.color=[1,0,0,1];this.borderColor=[0,0,0,1];this.blend=false;this.pickOffset=0;this.points=null}var l=s.prototype;l.dispose=function(){this.shader.dispose();this.pickShader.dispose();this.offsetBuffer.dispose();this.pickBuffer.dispose();this.plot.removeObject(this)};l.update=function(t){var e;t=t||{};function r(e,r){if(e in t){return t[e]}return r}this.sizeMin=r("sizeMin",.5);this.sizeMax=r("sizeMax",20);this.color=r("color",[1,0,0,1]).slice();this.areaRatio=r("areaRatio",1);this.borderColor=r("borderColor",[0,0,0,1]).slice();this.blend=r("blend",false);var n=t.positions.length>>>1;var a=t.positions instanceof Float32Array;var o=t.idToIndex instanceof Int32Array&&t.idToIndex.length>=n;var s=t.positions;var l=a?s:i.mallocFloat32(s.length);var u=o?t.idToIndex:i.mallocInt32(n);if(!a){l.set(s)}if(!o){l.set(s);for(e=0;e<n;e++){u[e]=e}}this.points=s;this.offsetBuffer.update(l);this.pickBuffer.update(u);if(!a){i.free(l)}if(!o){i.free(u)}this.pointCount=n;this.pickOffset=0};function u(t,e){var r=0;var n=t.length>>>1;var a;for(a=0;a<n;a++){var i=t[a*2];var o=t[a*2+1];if(i>=e[0]&&i<=e[2]&&o>=e[1]&&o<=e[3])r++}return r}l.unifiedDraw=function(){var t=[1,0,0,0,1,0,0,0,1];var e=[0,0,0,0];return function(r){var n=r!==void 0;var a=n?this.pickShader:this.shader;var i=this.plot.gl;var o=this.plot.dataBox;if(this.pointCount===0){return r}var s=o[2]-o[0];var l=o[3]-o[1];var c=u(this.points,o);var f=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(c,.33333)));t[0]=2/s;t[4]=2/l;t[6]=-2*o[0]/s-1;t[7]=-2*o[1]/l-1;this.offsetBuffer.bind();a.bind();a.attributes.position.pointer();a.uniforms.matrix=t;a.uniforms.color=this.color;a.uniforms.borderColor=this.borderColor;a.uniforms.pointCloud=f<5;a.uniforms.pointSize=f;a.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio)));if(n){e[0]=r&255;e[1]=r>>8&255;e[2]=r>>16&255;e[3]=r>>24&255;this.pickBuffer.bind();a.attributes.pickId.pointer(i.UNSIGNED_BYTE);a.uniforms.pickOffset=e;this.pickOffset=r}var h=i.getParameter(i.BLEND);var p=i.getParameter(i.DITHER);if(h&&!this.blend)i.disable(i.BLEND);if(p)i.disable(i.DITHER);i.drawArrays(i.POINTS,0,this.pointCount);if(h&&!this.blend)i.enable(i.BLEND);if(p)i.enable(i.DITHER);return r+this.pointCount}}();l.draw=l.unifiedDraw;l.drawPick=l.unifiedDraw;l.pick=function(t,e,r){var n=this.pickOffset;var a=this.pointCount;if(r<n||r>=n+a){return null}var i=r-n;var o=this.points;return{object:this,pointId:i,dataCoord:[o[2*i],o[2*i+1]]}};function c(t,e){var r=t.gl;var i=a(r);var l=a(r);var u=n(r,o.pointVertex,o.pointFragment);var c=n(r,o.pickVertex,o.pickFragment);var f=new s(t,i,l,u,c);f.update(e);t.addObject(f);return f}},{"./lib/shader":278,"gl-buffer":230,"gl-shader":287,"typedarray-pool":507}],280:[function(t,e,r){e.exports=n;function n(t,e,r,n){var a=e[0],i=e[1],o=e[2],s=e[3],l=r[0],u=r[1],c=r[2],f=r[3];var h,p,d,v,g;p=a*l+i*u+o*c+s*f;if(p<0){p=-p;l=-l;u=-u;c=-c;f=-f}if(1-p>1e-6){h=Math.acos(p);d=Math.sin(h);v=Math.sin((1-n)*h)/d;g=Math.sin(n*h)/d}else{v=1-n;g=n}t[0]=v*a+g*l;t[1]=v*i+g*u;t[2]=v*o+g*c;t[3]=v*s+g*f;return t}},{}],281:[function(t,e,r){"use strict";var n=t("vectorize-text");e.exports=i;var a={};function i(t,e){var r=a[e];if(!r){r=a[e]={}}if(t in r){return r[t]}var i=n(t,{textAlign:"center",textBaseline:"middle",lineHeight:1,font:e});var o=n(t,{triangles:true,textAlign:"center",textBaseline:"middle",lineHeight:1,font:e});var s=[[Infinity,Infinity],[-Infinity,-Infinity]];for(var l=0;l<i.positions.length;++l){var u=i.positions[l];for(var c=0;c<2;++c){s[0][c]=Math.min(s[0][c],u[c]);s[1][c]=Math.max(s[1][c],u[c])}}return r[t]=[o,i,s]}},{"vectorize-text":515}],282:[function(t,e,r){var n=t("gl-shader");var a=t("glslify");var i=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0]))   || \n     any(greaterThan(position, clipBounds[1])) ) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n    \n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]);var o=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n    \n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]);var s=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0]))   ||\n     any(greaterThan(position, clipBounds[1])) ) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]);var l=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0]))   ||\n     any(greaterThan(dataCoordinate, fragClipBounds[1])) ) {\n    discard;\n  } else {\n    gl_FragColor = interpColor * opacity;\n  }\n}\n"]);var u=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0]))   || \n     any(greaterThan(dataCoordinate, fragClipBounds[1])) ) {\n    discard;\n  } else {\n    gl_FragColor = vec4(pickGroup, pickId.bgr);\n  }\n}"]);var c=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}];var f={vertex:i,fragment:l,attributes:c},h={vertex:o,fragment:l,attributes:c},p={vertex:s,fragment:l,attributes:c},d={vertex:i,fragment:u,attributes:c},v={vertex:o,fragment:u,attributes:c},g={vertex:s,fragment:u,attributes:c};function m(t,e){var r=n(t,e);var a=r.attributes;a.position.location=0;a.color.location=1;a.glyph.location=2;a.id.location=3;return r}r.createPerspective=function(t){return m(t,f)};r.createOrtho=function(t){return m(t,h)};r.createProject=function(t){return m(t,p)};r.createPickPerspective=function(t){return m(t,d)};r.createPickOrtho=function(t){return m(t,v)};r.createPickProject=function(t){return m(t,g)}},{"gl-shader":287,glslify:377}],283:[function(t,e,r){"use strict";var n=t("gl-buffer");var a=t("gl-vao");var i=t("typedarray-pool");var o=t("gl-mat4/multiply");var s=t("./lib/shaders");var l=t("./lib/glyphs");var u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];e.exports=P;function c(t,e){var r=t[0];var n=t[1];var a=t[2];var i=t[3];t[0]=e[0]*r+e[4]*n+e[8]*a+e[12]*i;t[1]=e[1]*r+e[5]*n+e[9]*a+e[13]*i;t[2]=e[2]*r+e[6]*n+e[10]*a+e[14]*i;t[3]=e[3]*r+e[7]*n+e[11]*a+e[15]*i;return t}function f(t,e,r,n){c(n,n,r);c(n,n,e);return c(n,n,t)}function h(t){var e=new Array(3);for(var r=0;r<3;++r){e[r]=Math.min(Math.max(t[r],-1e8),1e8)}return e}function p(t,e){this.index=t;this.dataCoordinate=this.position=e}function d(t,e,r,n,a,i,o,s,l,u,c,f){this.gl=t;this.pixelRatio=1;this.shader=e;this.orthoShader=r;this.projectShader=n;this.pointBuffer=a;this.colorBuffer=i;this.glyphBuffer=o;this.idBuffer=s;this.vao=l;this.vertexCount=0;this.lineVertexCount=0;this.opacity=1;this.lineWidth=0;this.projectScale=[2/3,2/3,2/3];this.projectOpacity=[1,1,1];this.pickId=0;this.pickPerspectiveShader=u;this.pickOrthoShader=c;this.pickProjectShader=f;this.points=[];this._selectResult=new p(0,[0,0,0]);this.useOrtho=true;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.axesProject=[true,true,true];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.highlightId=[1,1,1,1];this.highlightScale=2;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.dirty=true}var v=d.prototype;v.pickSlots=1;v.setPickBase=function(t){this.pickId=t};v.isTransparent=function(){if(this.opacity<1){return true}for(var t=0;t<3;++t){if(this.axesProject[t]&&this.projectOpacity[t]<1){return true}}return false};v.isOpaque=function(){if(this.opacity>=1){return true}for(var t=0;t<3;++t){if(this.axesProject[t]&&this.projectOpacity[t]>=1){return true}}return false};var g=[0,0];var m=[0,0,0];var y=[0,0,0];var x=[0,0,0,1];var b=[0,0,0,1];var _=u.slice();var w=[0,0,0];var k=[[0,0,0],[0,0,0]];function M(t){t[0]=t[1]=t[2]=0;return t}function A(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=1;return t}function T(t,e,r,n){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[r]=n;return t}function S(t){var e=k;for(var r=0;r<2;++r){for(var n=0;n<3;++n){e[r][n]=Math.max(Math.min(t[r][n],1e8),-1e8)}}return e}function E(t,e,r,n,a){var i=e.axesProject;var s=e.gl;var l=t.uniforms;var c=r.model||u;var h=r.view||u;var p=r.projection||u;var d=e.axesBounds;var v=S(e.clipBounds);var k;if(e.axes&&e.axes.lastCubeProps){k=e.axes.lastCubeProps.axis}else{k=[1,1,1]}g[0]=2/s.drawingBufferWidth;g[1]=2/s.drawingBufferHeight;t.bind();l.view=h;l.projection=p;l.screenSize=g;l.highlightId=e.highlightId;l.highlightScale=e.highlightScale;l.clipBounds=v;l.pickGroup=e.pickId/255;l.pixelRatio=e.pixelRatio;for(var E=0;E<3;++E){if(!i[E]){continue}if(e.projectOpacity[E]<1!==n){continue}l.scale=e.projectScale[E];l.opacity=e.projectOpacity[E];var C=_;for(var L=0;L<16;++L){C[L]=0}for(var L=0;L<4;++L){C[5*L]=1}C[5*E]=0;if(k[E]<0){C[12+E]=d[0][E]}else{C[12+E]=d[1][E]}o(C,c,C);l.model=C;var I=(E+1)%3;var z=(E+2)%3;var P=M(m);var O=M(y);P[I]=1;O[z]=1;var D=f(p,h,c,A(x,P));var R=f(p,h,c,A(b,O));if(Math.abs(D[1])>Math.abs(R[1])){var B=D;D=R;R=B;B=P;P=O;O=B;var F=I;I=z;z=F}if(D[0]<0){P[I]=-1}if(R[1]>0){O[z]=-1}var N=0;var j=0;for(var L=0;L<4;++L){N+=Math.pow(c[4*I+L],2);j+=Math.pow(c[4*z+L],2)}P[I]/=Math.sqrt(N);O[z]/=Math.sqrt(j);l.axes[0]=P;l.axes[1]=O;l.fragClipBounds[0]=T(w,v[0],E,-1e8);l.fragClipBounds[1]=T(w,v[1],E,1e8);e.vao.draw(s.TRIANGLES,e.vertexCount);if(e.lineWidth>0){s.lineWidth(e.lineWidth);e.vao.draw(s.LINES,e.lineVertexCount,e.vertexCount)}}}var C=[-1e8,-1e8,-1e8];var L=[1e8,1e8,1e8];var I=[C,L];function z(t,e,r,n,a,i){var o=r.gl;r.vao.bind();if(a===r.opacity<1||i){t.bind();var s=t.uniforms;s.model=n.model||u;s.view=n.view||u;s.projection=n.projection||u;g[0]=2/o.drawingBufferWidth;g[1]=2/o.drawingBufferHeight;s.screenSize=g;s.highlightId=r.highlightId;s.highlightScale=r.highlightScale;s.fragClipBounds=I;s.clipBounds=r.axes.bounds;s.opacity=r.opacity;s.pickGroup=r.pickId/255;s.pixelRatio=r.pixelRatio;r.vao.draw(o.TRIANGLES,r.vertexCount);if(r.lineWidth>0){o.lineWidth(r.lineWidth);r.vao.draw(o.LINES,r.lineVertexCount,r.vertexCount)}}E(e,r,n,a,i);r.vao.unbind()}v.draw=function(t){var e=this.useOrtho?this.orthoShader:this.shader;z(e,this.projectShader,this,t,false,false)};v.drawTransparent=function(t){var e=this.useOrtho?this.orthoShader:this.shader;z(e,this.projectShader,this,t,true,false)};v.drawPick=function(t){var e=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;z(e,this.pickProjectShader,this,t,false,true)};v.pick=function(t){if(!t){return null}if(t.id!==this.pickId){return null}var e=t.value[2]+(t.value[1]<<8)+(t.value[0]<<16);if(e>=this.pointCount||e<0){return null}var r=this.points[e];var n=this._selectResult;n.index=e;for(var a=0;a<3;++a){n.position[a]=n.dataCoordinate[a]=r[a]}return n};v.highlight=function(t){if(!t){this.highlightId=[1,1,1,1]}else{var e=t.index;var r=e&255;var n=e>>8&255;var a=e>>16&255;this.highlightId=[r/255,n/255,a/255,0]}};v.update=function(t){t=t||{};if("perspective"in t){this.useOrtho=!t.perspective}if("orthographic"in t){this.useOrtho=!!t.orthographic}if("lineWidth"in t){this.lineWidth=t.lineWidth}if("project"in t){if(Array.isArray(t.project)){this.axesProject=t.project}else{var e=!!t.project;this.axesProject=[e,e,e]}}if("projectScale"in t){if(Array.isArray(t.projectScale)){this.projectScale=t.projectScale.slice()}else{var r=+t.projectScale;this.projectScale=[r,r,r]}}if("projectOpacity"in t){if(Array.isArray(t.projectOpacity)){this.projectOpacity=t.projectOpacity.slice()}else{var r=+t.projectOpacity;this.projectOpacity=[r,r,r]}}if("opacity"in t){this.opacity=t.opacity}this.dirty=true;var n=t.position;if(!n){return}var a=t.font||"normal";var o=t.alignment||[0,0];var s=[Infinity,Infinity,Infinity];var u=[-Infinity,-Infinity,-Infinity];var c=t.glyph;var f=t.color;var h=t.size;var p=t.angle;var d=t.lineColor;var v=0;var g=0;var m=0;var y=n.length;t:for(var x=0;x<y;++x){var b=n[x];for(var _=0;_<3;++_){if(isNaN(b[_])||!isFinite(b[_])){continue t}}var w;if(Array.isArray(c)){w=l(c[x],a)}else if(c){w=l(c,a)}else{w=l("\u25cf",a)}var k=w[0];var M=w[1];var A=w[2];g+=k.cells.length*3;m+=M.edges.length*2}var T=g+m;var S=i.mallocFloat(3*T);var E=i.mallocFloat(4*T);var C=i.mallocFloat(2*T);var L=i.mallocUint32(T);var I=[0,o[1]];var z=0;var P=g;var O=[0,0,0,1];var D=[0,0,0,1];var R=Array.isArray(f)&&Array.isArray(f[0]);var B=Array.isArray(d)&&Array.isArray(d[0]);t:for(var x=0;x<y;++x){var b=n[x];for(var _=0;_<3;++_){if(isNaN(b[_])||!isFinite(b[_])){v+=1;continue t}u[_]=Math.max(u[_],b[_]);s[_]=Math.min(s[_],b[_])}var w;if(Array.isArray(c)){w=l(c[x],a)}else if(c){w=l(c,a)}else{w=l("\u25cf",a)}var k=w[0];var M=w[1];var A=w[2];if(Array.isArray(f)){var F;if(R){F=f[x]}else{F=f}if(F.length===3){for(var _=0;_<3;++_){O[_]=F[_]}O[3]=1}else if(F.length===4){for(var _=0;_<4;++_){O[_]=F[_]}}}else{O[0]=O[1]=O[2]=0;O[3]=1}if(Array.isArray(d)){var F;if(B){F=d[x]}else{F=d}if(F.length===3){for(var _=0;_<3;++_){D[_]=F[_]}D[_]=1}else if(F.length===4){for(var _=0;_<4;++_){D[_]=F[_]}}}else{D[0]=D[1]=D[2]=0;D[3]=1}var N=.5;if(Array.isArray(h)){N=+h[x]}else if(h){N=+h}else if(this.useOrtho){N=12}var j=0;if(Array.isArray(p)){j=+p[x]}else if(p){j=+p}var V=Math.cos(j);var U=Math.sin(j);var b=n[x];for(var _=0;_<3;++_){u[_]=Math.max(u[_],b[_]);s[_]=Math.min(s[_],b[_])}if(o[0]<0){I[0]=o[0]*(1+A[1][0])}else if(o[0]>0){I[0]=-o[0]*(1+A[0][0])}var q=k.cells;var H=k.positions;for(var _=0;_<q.length;++_){var G=q[_];for(var W=0;W<3;++W){for(var Y=0;Y<3;++Y){S[3*z+Y]=b[Y]}for(var Y=0;Y<4;++Y){E[4*z+Y]=O[Y]}L[z]=v;var X=H[G[W]];C[2*z]=N*(V*X[0]-U*X[1]+I[0]);C[2*z+1]=N*(U*X[0]+V*X[1]+I[1]);z+=1}}var q=M.edges;var H=M.positions;for(var _=0;_<q.length;++_){var G=q[_];for(var W=0;W<2;++W){for(var Y=0;Y<3;++Y){S[3*P+Y]=b[Y]}for(var Y=0;Y<4;++Y){E[4*P+Y]=D[Y]}L[P]=v;var X=H[G[W]];C[2*P]=N*(V*X[0]-U*X[1]+I[0]);C[2*P+1]=N*(U*X[0]+V*X[1]+I[1]);P+=1}}v+=1}this.vertexCount=g;this.lineVertexCount=m;this.pointBuffer.update(S);this.colorBuffer.update(E);this.glyphBuffer.update(C);this.idBuffer.update(new Uint32Array(L));i.free(S);i.free(E);i.free(C);i.free(L);this.bounds=[s,u];this.points=n;this.pointCount=n.length};v.dispose=function(){this.shader.dispose();this.orthoShader.dispose();this.pickPerspectiveShader.dispose();this.pickOrthoShader.dispose();this.vao.dispose();this.pointBuffer.dispose();this.colorBuffer.dispose();this.glyphBuffer.dispose();this.idBuffer.dispose()};function P(t){var e=t.gl;var r=s.createPerspective(e);var i=s.createOrtho(e);var o=s.createProject(e);var l=s.createPickPerspective(e);var u=s.createPickOrtho(e);var c=s.createPickProject(e);var f=n(e);var h=n(e);var p=n(e);var v=n(e);var g=a(e,[{buffer:f,size:3,type:e.FLOAT},{buffer:h,size:4,type:e.FLOAT},{buffer:p,size:2,type:e.FLOAT},{buffer:v,size:4,type:e.UNSIGNED_BYTE,normalized:true}]);var m=new d(e,r,i,o,f,h,p,v,g,l,u,c);m.update(t);return m}},{"./lib/glyphs":281,"./lib/shaders":282,"gl-buffer":230,"gl-mat4/multiply":256,"gl-vao":308,"typedarray-pool":507}],284:[function(t,e,r){"use strict";var n=t("glslify");r.boxVertex=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]);r.boxFragment=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:377}],285:[function(t,e,r){"use strict";var n=t("gl-shader");var a=t("gl-buffer");var i=t("./lib/shaders");e.exports=l;function o(t,e,r){this.plot=t;this.boxBuffer=e;this.boxShader=r;this.enabled=true;this.selectBox=[Infinity,Infinity,-Infinity,-Infinity];this.borderColor=[0,0,0,1];this.innerFill=false;this.innerColor=[0,0,0,.25];this.outerFill=true;this.outerColor=[0,0,0,.5];this.borderWidth=10}var s=o.prototype;s.draw=function(){if(!this.enabled){return}var t=this.plot;var e=this.selectBox;var r=this.borderWidth;var n=this.innerFill;var a=this.innerColor;var i=this.outerFill;var o=this.outerColor;var s=this.borderColor;var l=t.box;var u=t.screenBox;var c=t.dataBox;var f=t.viewBox;var h=t.pixelRatio;var p=(e[0]-c[0])*(f[2]-f[0])/(c[2]-c[0])+f[0];var d=(e[1]-c[1])*(f[3]-f[1])/(c[3]-c[1])+f[1];var v=(e[2]-c[0])*(f[2]-f[0])/(c[2]-c[0])+f[0];var g=(e[3]-c[1])*(f[3]-f[1])/(c[3]-c[1])+f[1];p=Math.max(p,f[0]);d=Math.max(d,f[1]);v=Math.min(v,f[2]);g=Math.min(g,f[3]);if(v<p||g<d){return}l.bind();var m=u[2]-u[0];var y=u[3]-u[1];if(this.outerFill){l.drawBox(0,0,m,d,o);l.drawBox(0,d,p,g,o);l.drawBox(0,g,m,y,o);l.drawBox(v,d,m,g,o)}if(this.innerFill){l.drawBox(p,d,v,g,a)}if(r>0){var x=r*h;l.drawBox(p-x,d-x,v+x,d+x,s);l.drawBox(p-x,g-x,v+x,g+x,s);l.drawBox(p-x,d-x,p+x,g+x,s);l.drawBox(v-x,d-x,v+x,g+x,s)}};s.update=function(t){t=t||{};this.innerFill=!!t.innerFill;this.outerFill=!!t.outerFill;this.innerColor=(t.innerColor||[0,0,0,.5]).slice();this.outerColor=(t.outerColor||[0,0,0,.5]).slice();this.borderColor=(t.borderColor||[0,0,0,1]).slice();this.borderWidth=t.borderWidth||0;this.selectBox=(t.selectBox||this.selectBox).slice()};s.dispose=function(){this.boxBuffer.dispose();this.boxShader.dispose();this.plot.removeOverlay(this)};function l(t,e){var r=t.gl;var s=a(r,[0,0,0,1,1,0,1,1]);var l=n(r,i.boxVertex,i.boxFragment);var u=new o(t,s,l);u.update(e);t.addOverlay(u);return u}},{"./lib/shaders":284,"gl-buffer":230,"gl-shader":287}],286:[function(t,e,r){"use strict";e.exports=f;var n=t("gl-fbo");var a=t("typedarray-pool");var i=t("ndarray");var o=t("bit-twiddle").nextPow2;var s=t("cwise/lib/wrapper")({args:["array",{offset:[0,0,1],array:0},{offset:[0,0,2],array:0},{offset:[0,0,3],array:0},"scalar","scalar","index"],pre:{body:"{this_closestD2=1e8,this_closestX=-1,this_closestY=-1}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},body:{body:"{if(_inline_16_arg0_<255||_inline_16_arg1_<255||_inline_16_arg2_<255||_inline_16_arg3_<255){var _inline_16_l=_inline_16_arg4_-_inline_16_arg6_[0],_inline_16_a=_inline_16_arg5_-_inline_16_arg6_[1],_inline_16_f=_inline_16_l*_inline_16_l+_inline_16_a*_inline_16_a;_inline_16_f<this_closestD2&&(this_closestD2=_inline_16_f,this_closestX=_inline_16_arg6_[0],this_closestY=_inline_16_arg6_[1])}}",args:[{name:"_inline_16_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_16_arg1_",lvalue:false,rvalue:true,count:1},{name:"_inline_16_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_16_arg3_",lvalue:false,rvalue:true,count:1},{name:"_inline_16_arg4_",lvalue:false,rvalue:true,count:1},{name:"_inline_16_arg5_",lvalue:false,rvalue:true,count:1},{name:"_inline_16_arg6_",lvalue:false,rvalue:true,count:4}],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:["_inline_16_a","_inline_16_f","_inline_16_l"]},post:{body:"{return[this_closestX,this_closestY,this_closestD2]}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},debug:false,funcName:"cwise",blockSize:64});function l(t,e,r,n,a){this.coord=[t,e];this.id=r;this.value=n;this.distance=a}function u(t,e,r){this.gl=t;this.fbo=e;this.buffer=r;this._readTimeout=null;var n=this;this._readCallback=function(){if(!n.gl){return}e.bind();t.readPixels(0,0,e.shape[0],e.shape[1],t.RGBA,t.UNSIGNED_BYTE,n.buffer);n._readTimeout=null}}var c=u.prototype;Object.defineProperty(c,"shape",{get:function(){if(!this.gl){return[0,0]}return this.fbo.shape.slice()},set:function(t){if(!this.gl){return}this.fbo.shape=t;var e=this.fbo.shape[0];var r=this.fbo.shape[1];if(r*e*4>this.buffer.length){a.free(this.buffer);var n=this.buffer=a.mallocUint8(o(r*e*4));for(var i=0;i<r*e*4;++i){n[i]=255}}return t}});c.begin=function(){var t=this.gl;var e=this.shape;if(!t){return}this.fbo.bind();t.clearColor(1,1,1,1);t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)};c.end=function(){var t=this.gl;if(!t){return}t.bindFramebuffer(t.FRAMEBUFFER,null);if(!this._readTimeout){clearTimeout(this._readTimeout)}this._readTimeout=setTimeout(this._readCallback,1)};c.query=function(t,e,r){if(!this.gl){return null}var n=this.fbo.shape.slice();t=t|0;e=e|0;if(typeof r!=="number"){r=1}var a=Math.min(Math.max(t-r,0),n[0])|0;var o=Math.min(Math.max(t+r,0),n[0])|0;var u=Math.min(Math.max(e-r,0),n[1])|0;var c=Math.min(Math.max(e+r,0),n[1])|0;if(o<=a||c<=u){return null}var f=[o-a,c-u];var h=i(this.buffer,[f[0],f[1],4],[4,n[0]*4,1],4*(a+n[0]*u));var p=s(h.hi(f[0],f[1],1),r,r);var d=p[0];var v=p[1];if(d<0||Math.pow(this.radius,2)<p[2]){return null}var g=h.get(d,v,0);var m=h.get(d,v,1);var y=h.get(d,v,2);var x=h.get(d,v,3);return new l(d+a|0,v+u|0,g,[m,y,x],Math.sqrt(p[2]))};c.dispose=function(){if(!this.gl){return}this.fbo.dispose();a.free(this.buffer);this.gl=null;if(this._readTimeout){clearTimeout(this._readTimeout)}};function f(t,e){var r=n(t,e);var i=a.mallocUint8(e[0]*e[1]*4);return new u(t,r,i)}},{"bit-twiddle":80,"cwise/lib/wrapper":136,"gl-fbo":239,ndarray:417,"typedarray-pool":507}],287:[function(t,e,r){"use strict";var n=t("./lib/create-uniforms");var a=t("./lib/create-attributes");var i=t("./lib/reflect");var o=t("./lib/shader-cache");var s=t("./lib/runtime-reflect");var l=t("./lib/GLError");function u(t){this.gl=t;this.gl.lastAttribCount=0;this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var c=u.prototype;c.bind=function(){if(!this.program){this._relink()}var t;var e=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);var r=this.gl.lastAttribCount;if(e>r){for(t=r;t<e;t++){this.gl.enableVertexAttribArray(t)}}else if(r>e){for(t=e;t<r;t++){this.gl.disableVertexAttribArray(t)}}this.gl.lastAttribCount=e;this.gl.useProgram(this.program)};c.dispose=function(){var t=this.gl.lastAttribCount;for(var e=0;e<t;e++){this.gl.disableVertexAttribArray(e)}this.gl.lastAttribCount=0;if(this._fref){this._fref.dispose()}if(this._vref){this._vref.dispose()}this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};function f(t,e){if(t.name<e.name){return-1}return 1}c.update=function(t,e,r,u){if(!e||arguments.length===1){var c=t;t=c.vertex;e=c.fragment;r=c.uniforms;u=c.attributes}var h=this;var p=h.gl;var d=h._vref;h._vref=o.shader(p,p.VERTEX_SHADER,t);if(d){d.dispose()}h.vertShader=h._vref.shader;var v=this._fref;h._fref=o.shader(p,p.FRAGMENT_SHADER,e);if(v){v.dispose()}h.fragShader=h._fref.shader;if(!r||!u){var g=p.createProgram();p.attachShader(g,h.fragShader);p.attachShader(g,h.vertShader);p.linkProgram(g);if(!p.getProgramParameter(g,p.LINK_STATUS)){var m=p.getProgramInfoLog(g);throw new l(m,"Error linking program:"+m)}r=r||s.uniforms(p,g);u=u||s.attributes(p,g);p.deleteProgram(g)}u=u.slice();u.sort(f);var y=[];var x=[];var b=[];var _;for(_=0;_<u.length;++_){var w=u[_];if(w.type.indexOf("mat")>=0){var k=w.type.charAt(w.type.length-1)|0;var M=new Array(k);for(var A=0;A<k;++A){M[A]=b.length;x.push(w.name+"["+A+"]");if(typeof w.location==="number"){b.push(w.location+A)}else if(Array.isArray(w.location)&&w.location.length===k&&typeof w.location[A]==="number"){b.push(w.location[A]|0)}else{b.push(-1)}}y.push({name:w.name,type:w.type,locations:M})}else{y.push({name:w.name,type:w.type,locations:[b.length]});x.push(w.name);if(typeof w.location==="number"){b.push(w.location|0)}else{b.push(-1)}}}var T=0;for(_=0;_<b.length;++_){if(b[_]<0){while(b.indexOf(T)>=0){T+=1}b[_]=T}}var S=new Array(r.length);function E(){h.program=o.program(p,h._vref,h._fref,x,b);for(var t=0;t<r.length;++t){S[t]=p.getUniformLocation(h.program,r[t].name)}}E();h._relink=E;h.types={uniforms:i(r),attributes:i(u)};h.attributes=a(p,h,y,b);Object.defineProperty(h,"uniforms",n(p,h,r,S))};function h(t,e,r,n,a){var i=new u(t);i.update(e,r,n,a);return i}e.exports=h},{"./lib/GLError":288,"./lib/create-attributes":289,"./lib/create-uniforms":290,"./lib/reflect":291,"./lib/runtime-reflect":292,"./lib/shader-cache":293}],288:[function(t,e,r){function n(t,e,r){this.shortMessage=e||"";this.longMessage=r||"";this.rawError=t||"";this.message="gl-shader: "+(e||t||"")+(r?"\n"+r:"");this.stack=(new Error).stack}n.prototype=new Error;n.prototype.name="GLError";n.prototype.constructor=n;e.exports=n},{}],289:[function(t,e,r){"use strict";e.exports=l;var n=t("./GLError");function a(t,e,r,n,a,i){this._gl=t;this._wrapper=e;this._index=r;this._locations=n;this._dimension=a;this._constFunc=i}var i=a.prototype;i.pointer=function t(e,r,n,a){var i=this;var o=i._gl;var s=i._locations[i._index];o.vertexAttribPointer(s,i._dimension,e||o.FLOAT,!!r,n||0,a||0);o.enableVertexAttribArray(s)};i.set=function(t,e,r,n){return this._constFunc(this._locations[this._index],t,e,r,n)};Object.defineProperty(i,"location",{get:function(){return this._locations[this._index]},set:function(t){if(t!==this._locations[this._index]){this._locations[this._index]=t|0;this._wrapper.program=null}return t|0}});function o(t,e,r,n,i,o,s){var l=["gl","v"];var u=[];for(var c=0;c<i;++c){l.push("x"+c);u.push("x"+c)}l.push("if(x0.length===void 0){return gl.vertexAttrib"+i+"f(v,"+u.join()+")}else{return gl.vertexAttrib"+i+"fv(v,x0)}");var f=Function.apply(null,l);var h=new a(t,e,r,n,i,f);Object.defineProperty(o,s,{set:function(e){t.disableVertexAttribArray(n[r]);f(t,n[r],e);return e},get:function(){return h},enumerable:true})}function s(t,e,r,n,a,i,s){var l=new Array(a);var u=new Array(a);for(var c=0;c<a;++c){o(t,e,r[c],n,a,l,c);u[c]=l[c]}Object.defineProperty(l,"location",{set:function(t){if(Array.isArray(t)){for(var e=0;e<a;++e){u[e].location=t[e]}}else{for(var e=0;e<a;++e){u[e].location=t+e}}return t},get:function(){var t=new Array(a);for(var e=0;e<a;++e){t[e]=n[r[e]]}return t},enumerable:true});l.pointer=function(e,i,o,s){e=e||t.FLOAT;i=!!i;o=o||a*a;s=s||0;for(var l=0;l<a;++l){var u=n[r[l]];t.vertexAttribPointer(u,a,e,i,o,s+l*a);t.enableVertexAttribArray(u)}};var f=new Array(a);var h=t["vertexAttrib"+a+"fv"];Object.defineProperty(i,s,{set:function(e){for(var i=0;i<a;++i){var o=n[r[i]];t.disableVertexAttribArray(o);if(Array.isArray(e[0])){h.call(t,o,e[i])}else{for(var s=0;s<a;++s){f[s]=e[a*i+s]}h.call(t,o,f)}}return e},get:function(){return l},enumerable:true})}function l(t,e,r,a){var i={};for(var l=0,u=r.length;l<u;++l){var c=r[l];var f=c.name;var h=c.type;var p=c.locations;switch(h){case"bool":case"int":case"float":o(t,e,p[0],a,1,i,f);break;default:if(h.indexOf("vec")>=0){var d=h.charCodeAt(h.length-1)-48;if(d<2||d>4){throw new n("","Invalid data type for attribute "+f+": "+h)}o(t,e,p[0],a,d,i,f)}else if(h.indexOf("mat")>=0){var d=h.charCodeAt(h.length-1)-48;if(d<2||d>4){throw new n("","Invalid data type for attribute "+f+": "+h)}s(t,e,p,a,d,i,f)}else{throw new n("","Unknown data type for attribute "+f+": "+h)}break}}return i}},{"./GLError":288}],290:[function(t,e,r){"use strict";var n=t("./reflect");var a=t("./GLError");e.exports=s;function i(t){var e=new Function("y","return function(){return y}");return e(t)}function o(t,e){var r=new Array(t);for(var n=0;n<t;++n){r[n]=e}return r}function s(t,e,r,s){function l(r){var n=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+r+"])}");return n(t,e,s)}function u(t,e,r){switch(r){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+e+"],obj"+t+")";case"float":return"gl.uniform1f(locations["+e+"],obj"+t+")";default:var n=r.indexOf("vec");if(0<=n&&n<=1&&r.length===4+n){var i=r.charCodeAt(r.length-1)-48;if(i<2||i>4){throw new a("","Invalid data type")}switch(r.charAt(0)){case"b":case"i":return"gl.uniform"+i+"iv(locations["+e+"],obj"+t+")";case"v":return"gl.uniform"+i+"fv(locations["+e+"],obj"+t+")";default:throw new a("","Unrecognized data type for vector "+name+": "+r)}}else if(r.indexOf("mat")===0&&r.length===4){var i=r.charCodeAt(r.length-1)-48;if(i<2||i>4){throw new a("","Invalid uniform dimension type for matrix "+name+": "+r)}return"gl.uniformMatrix"+i+"fv(locations["+e+"],false,obj"+t+")"}else{throw new a("","Unknown uniform data type for "+name+": "+r)}break}}function c(t,e){if(typeof e!=="object"){return[[t,e]]}var r=[];for(var n in e){var a=e[n];var i=t;if(parseInt(n)+""===n){i+="["+n+"]"}else{i+="."+n}if(typeof a==="object"){r.push.apply(r,c(i,a))}else{r.push([i,a])}}return r}function f(e){var n=["return function updateProperty(obj){"];var a=c("",e);for(var i=0;i<a.length;++i){var o=a[i];var l=o[0];var f=o[1];if(s[f]){n.push(u(l,f,r[f].type))}}n.push("return obj}");var h=new Function("gl","locations",n.join("\n"));return h(t,s)}function h(t){switch(t){case"bool":return false;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var e=t.indexOf("vec");if(0<=e&&e<=1&&t.length===4+e){var r=t.charCodeAt(t.length-1)-48;if(r<2||r>4){throw new a("","Invalid data type")}if(t.charAt(0)==="b"){return o(r,false)}return o(r,0)}else if(t.indexOf("mat")===0&&t.length===4){var r=t.charCodeAt(t.length-1)-48;if(r<2||r>4){throw new a("","Invalid uniform dimension type for matrix "+name+": "+t)}return o(r*r,0)}else{throw new a("","Unknown uniform data type for "+name+": "+t)}break}}function p(t,e,n){if(typeof n==="object"){var a=d(n);Object.defineProperty(t,e,{get:i(a),set:f(n),enumerable:true,configurable:false})}else{if(s[n]){Object.defineProperty(t,e,{get:l(n),set:f(n),enumerable:true,configurable:false})}else{t[e]=h(r[n].type)}}}function d(t){var e;if(Array.isArray(t)){e=new Array(t.length);for(var r=0;r<t.length;++r){p(e,r,t[r])}}else{e={};for(var n in t){p(e,n,t[n])}}return e}var v=n(r,true);return{get:i(d(v)),set:f(v),enumerable:true,configurable:true}}},{"./GLError":288,"./reflect":291}],291:[function(t,e,r){"use strict";e.exports=n;function n(t,e){var r={};for(var n=0;n<t.length;++n){var a=t[n].name;var i=a.split(".");var o=r;for(var s=0;s<i.length;++s){var l=i[s].split("[");if(l.length>1){if(!(l[0]in o)){o[l[0]]=[]}o=o[l[0]];for(var u=1;u<l.length;++u){var c=parseInt(l[u]);if(u<l.length-1||s<i.length-1){if(!(c in o)){if(u<l.length-1){o[c]=[]}else{o[c]={}}}o=o[c]}else{if(e){o[c]=n}else{o[c]=t[n].type}}}}else if(s<i.length-1){if(!(l[0]in o)){o[l[0]]={}}o=o[l[0]]}else{if(e){o[l[0]]=n}else{o[l[0]]=t[n].type}}}}return r}},{}],292:[function(t,e,r){"use strict";r.uniforms=o;r.attributes=s;var n={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"};var a=null;function i(t,e){if(!a){var r=Object.keys(n);a={};for(var i=0;i<r.length;++i){var o=r[i];a[t[o]]=n[o]}}return a[e]}function o(t,e){var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);var n=[];for(var a=0;a<r;++a){var o=t.getActiveUniform(e,a);if(o){var s=i(t,o.type);if(o.size>1){for(var l=0;l<o.size;++l){n.push({name:o.name.replace("[0]","["+l+"]"),type:s})}}else{n.push({name:o.name,type:s})}}}return n}function s(t,e){var r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);var n=[];for(var a=0;a<r;++a){var o=t.getActiveAttrib(e,a);if(o){n.push({name:o.name,type:i(t,o.type)})}}return n}},{}],293:[function(t,e,r){"use strict";r.shader=d;r.program=v;var n=t("./GLError");var a=t("gl-format-compiler-error");var i=typeof WeakMap==="undefined"?t("weakmap-shim"):WeakMap;var o=new i;var s=0;function l(t,e,r,n,a,i,o){this.id=t;this.src=e;this.type=r;this.shader=n;this.count=i;this.programs=[];this.cache=o}l.prototype.dispose=function(){if(--this.count===0){var t=this.cache;var e=t.gl;var r=this.programs;for(var n=0,a=r.length;n<a;++n){var i=t.programs[r[n]];if(i){delete t.programs[n];e.deleteProgram(i)}}e.deleteShader(this.shader);delete t.shaders[this.type===e.FRAGMENT_SHADER|0][this.src]}};function u(t){this.gl=t;this.shaders=[{},{}];this.programs={}}var c=u.prototype;function f(t,e,r){var i=t.createShader(e);t.shaderSource(i,r);t.compileShader(i);if(!t.getShaderParameter(i,t.COMPILE_STATUS)){var o=t.getShaderInfoLog(i);try{var s=a(o,r,e)}catch(t){console.warn("Failed to format compiler error: "+t);throw new n(o,"Error compiling shader:\n"+o)}throw new n(o,s.short,s.long)}return i}c.getShaderReference=function(t,e){var r=this.gl;var n=this.shaders[t===r.FRAGMENT_SHADER|0];var a=n[e];if(!a||!r.isShader(a.shader)){var i=f(r,t,e);a=n[e]=new l(s++,e,t,i,[],1,this)}else{a.count+=1}return a};function h(t,e,r,a,i){var o=t.createProgram();t.attachShader(o,e);t.attachShader(o,r);for(var s=0;s<a.length;++s){t.bindAttribLocation(o,i[s],a[s])}t.linkProgram(o);if(!t.getProgramParameter(o,t.LINK_STATUS)){var l=t.getProgramInfoLog(o);throw new n(l,"Error linking program: "+l)}return o}c.getProgram=function(t,e,r,n){var a=[t.id,e.id,r.join(":"),n.join(":")].join("@");var i=this.programs[a];if(!i||!this.gl.isProgram(i)){this.programs[a]=i=h(this.gl,t.shader,e.shader,r,n);t.programs.push(a);e.programs.push(a)}return i};function p(t){var e=o.get(t);if(!e){e=new u(t);o.set(t,e)}return e}function d(t,e,r){return p(t).getShaderReference(e,r)}function v(t,e,r,n,a){return p(t).getProgram(e,r,n,a)}},{"./GLError":288,"gl-format-compiler-error":240,"weakmap-shim":520}],294:[function(t,e,r){"use strict";e.exports=i;function n(t){this.plot=t;this.enable=[true,true,false,false];this.width=[1,1,1,1];this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.center=[Infinity,Infinity]}var a=n.prototype;a.update=function(t){t=t||{};this.enable=(t.enable||[true,true,false,false]).slice();this.width=(t.width||[1,1,1,1]).slice();this.color=(t.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(t){return t.slice()});this.center=(t.center||[Infinity,Infinity]).slice();this.plot.setOverlayDirty()};a.draw=function(){var t=this.enable;var e=this.width;var r=this.color;var n=this.center;var a=this.plot;var i=a.line;var o=a.dataBox;var s=a.viewBox;i.bind();if(o[0]<=n[0]&&n[0]<=o[2]&&o[1]<=n[1]&&n[1]<=o[3]){var l=s[0]+(n[0]-o[0])/(o[2]-o[0])*(s[2]-s[0]);var u=s[1]+(n[1]-o[1])/(o[3]-o[1])*(s[3]-s[1]);if(t[0]){i.drawLine(l,u,s[0],u,e[0],r[0])}if(t[1]){i.drawLine(l,u,l,s[1],e[1],r[1])}if(t[2]){i.drawLine(l,u,s[2],u,e[2],r[2])}if(t[3]){i.drawLine(l,u,l,s[3],e[3],r[3])}}};a.dispose=function(){this.plot.removeOverlay(this)};function i(t,e){var r=new n(t);r.update(e);t.addOverlay(r);return r}},{}],295:[function(t,e,r){"use strict";var n=t("glslify");var a=t("gl-shader");var i=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);e.exports=function(t){return a(t,i,o,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":287,glslify:377}],296:[function(t,e,r){"use strict";var n=t("gl-buffer");var a=t("gl-vao");var i=t("./shaders/index");e.exports=h;var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(t,e,r,n){this.gl=t;this.buffer=e;this.vao=r;this.shader=n;this.pixelRatio=1;this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]];this.position=[0,0,0];this.lineWidth=[2,2,2];this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.enabled=[true,true,true];this.drawSides=[true,true,true];this.axes=null}var l=s.prototype;var u=[0,0,0];var c=[0,0,0];var f=[0,0];l.isTransparent=function(){return false};l.drawTransparent=function(t){};l.draw=function(t){var e=this.gl;var r=this.vao;var n=this.shader;r.bind();n.bind();var a=t.model||o;var i=t.view||o;var s=t.projection||o;var l;if(this.axes){l=this.axes.lastCubeProps.axis}var h=u;var p=c;for(var d=0;d<3;++d){if(l&&l[d]<0){h[d]=this.bounds[0][d];p[d]=this.bounds[1][d]}else{h[d]=this.bounds[1][d];p[d]=this.bounds[0][d]}}f[0]=e.drawingBufferWidth;f[1]=e.drawingBufferHeight;n.uniforms.model=a;n.uniforms.view=i;n.uniforms.projection=s;n.uniforms.coordinates=[this.position,h,p];n.uniforms.colors=this.colors;n.uniforms.screenShape=f;for(var d=0;d<3;++d){n.uniforms.lineWidth=this.lineWidth[d]*this.pixelRatio;if(this.enabled[d]){r.draw(e.TRIANGLES,6,6*d);if(this.drawSides[d]){r.draw(e.TRIANGLES,12,18+12*d)}}}r.unbind()};l.update=function(t){if(!t){return}if("bounds"in t){this.bounds=t.bounds}if("position"in t){this.position=t.position}if("lineWidth"in t){this.lineWidth=t.lineWidth}if("colors"in t){this.colors=t.colors}if("enabled"in t){this.enabled=t.enabled}if("drawSides"in t){this.drawSides=t.drawSides}};l.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()};function h(t,e){var r=[];function o(t,e,n,a,i,o){var s=[t,e,n,0,0,0,1];s[a+3]=1;s[a]=i;r.push.apply(r,s);s[6]=-1;r.push.apply(r,s);s[a]=o;r.push.apply(r,s);r.push.apply(r,s);s[6]=1;r.push.apply(r,s);s[a]=i;r.push.apply(r,s)}o(0,0,0,0,0,1);o(0,0,0,1,0,1);o(0,0,0,2,0,1);o(1,0,0,1,-1,1);o(1,0,0,2,-1,1);o(0,1,0,0,-1,1);o(0,1,0,2,-1,1);o(0,0,1,0,-1,1);o(0,0,1,1,-1,1);var l=n(t,r);var u=a(t,[{type:t.FLOAT,buffer:l,size:3,offset:0,stride:28},{type:t.FLOAT,buffer:l,size:3,offset:12,stride:28},{type:t.FLOAT,buffer:l,size:1,offset:24,stride:28}]);var c=i(t);c.attributes.position.location=0;c.attributes.color.location=1;c.attributes.weight.location=2;var f=new s(t,l,u,c);f.update(e);return f}},{"./shaders/index":295,"gl-buffer":230,"gl-vao":308}],297:[function(t,e,r){arguments[4][232][0].apply(r,arguments)},{barycentric:61,dup:232,"polytope-closest-point/lib/closest_point_2d.js":448}],298:[function(t,e,r){var n=t("glslify");var a=n(["precision mediump float;\n#define GLSLIFY 1\n\nfloat inverse(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\nuniform float tubeScale;\n\nuniform mat4 model\n           , view\n           , projection;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal), 0.0);\n  normal = normalize(normal * inverse(mat3(model)));\n\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n  f_color          = color;\n  f_normal         = normal;\n  f_data           = tubePosition.xyz;\n  f_eyeDirection   = eyePosition   - tubePosition.xyz;\n  f_lightDirection = lightPosition - tubePosition.xyz;\n  f_uv             = uv;\n}\n"]);var i=n(["precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n  \n  if(!gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor =  texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal), 0.0);\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]);var s=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);r.meshShader={vertex:a,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]};r.pickShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:377}],299:[function(t,e,r){"use strict";var n=1e-6;var a=1e-6;var i=t("gl-shader");var o=t("gl-buffer");var s=t("gl-vao");var l=t("gl-texture2d");var u=t("normals");var c=t("gl-mat4/multiply");var f=t("gl-mat4/invert");var h=t("ndarray");var p=t("colormap");var d=t("simplicial-complex-contour");var v=t("typedarray-pool");var g=t("./shaders");var m=t("./closest-point");var y=g.meshShader;var x=g.pickShader;var b=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function _(t,e,r,n,a,i,o,s,l,u,c,f,h,p,d,v,g,m,y,x,_,w,k,M,A,T,S,E){this.gl=t;this.cells=[];this.positions=[];this.intensity=[];this.texture=e;this.dirty=true;this.triShader=r;this.lineShader=n;this.pointShader=a;this.pickShader=i;this.pointPickShader=o;this.contourShader=s;this.trianglePositions=l;this.triangleVectors=u;this.triangleColors=f;this.triangleNormals=p;this.triangleUVs=h;this.triangleIds=c;this.triangleVAO=d;this.triangleCount=0;this.lineWidth=1;this.edgePositions=v;this.edgeColors=m;this.edgeUVs=y;this.edgeIds=g;this.edgeVAO=x;this.edgeCount=0;this.pointPositions=_;this.pointColors=k;this.pointUVs=M;this.pointSizes=A;this.pointIds=w;this.pointVAO=T;this.pointCount=0;this.contourLineWidth=1;this.contourPositions=S;this.contourVAO=E;this.contourCount=0;this.contourColor=[0,0,0];this.contourEnable=false;this.pickId=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[1e5,1e5,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.opacity=1;this.tubeScale=1;this._model=b;this._view=b;this._projection=b;this._resolution=[1,1]}var w=_.prototype;w.isOpaque=function(){return this.opacity>=1};w.isTransparent=function(){return this.opacity<1};w.pickSlots=1;w.setPickBase=function(t){this.pickId=t};function k(t){var e=p({colormap:t,nshades:256,format:"rgba"});var r=new Uint8Array(256*4);for(var n=0;n<256;++n){var a=e[n];for(var i=0;i<3;++i){r[4*n+i]=a[i]}r[4*n+3]=a[3]*255}return h(r,[256,256,4],[4,0,1])}function M(t,e,r){var n=new Array(e);for(var a=0;a<e;++a){n[a]=0}var i=t.length;for(var a=0;a<i;++a){var o=t[a];for(var s=0;s<o.length;++s){n[o[s]]=r[a]}}return n}function A(t){var e=t.length;var r=new Array(e);for(var n=0;n<e;++n){r[n]=t[n][2]}return r}w.highlight=function(t){if(!t||!this.contourEnable){this.contourCount=0;return}var e=d(this.cells,this.intensity,t.intensity);var r=e.cells;var n=e.vertexIds;var a=e.vertexWeights;var i=r.length;var o=v.mallocFloat32(2*3*i);var s=0;for(var l=0;l<i;++l){var u=r[l];for(var c=0;c<2;++c){var f=u[0];if(u.length===2){f=u[c]}var h=n[f][0];var p=n[f][1];var g=a[f];var m=1-g;var y=this.positions[h];var x=this.positions[p];for(var b=0;b<3;++b){o[s++]=g*y[b]+m*x[b]}}}this.contourCount=s/3|0;this.contourPositions.update(o.subarray(0,s));v.free(o)};w.update=function(t){t=t||{};var e=this.gl;this.dirty=true;if("contourEnable"in t){this.contourEnable=t.contourEnable}if("contourColor"in t){this.contourColor=t.contourColor}if("lineWidth"in t){this.lineWidth=t.lineWidth}if("lightPosition"in t){this.lightPosition=t.lightPosition}if("opacity"in t){this.opacity=t.opacity}if("ambient"in t){this.ambientLight=t.ambient}if("diffuse"in t){this.diffuseLight=t.diffuse}if("specular"in t){this.specularLight=t.specular}if("roughness"in t){this.roughness=t.roughness}if("fresnel"in t){this.fresnel=t.fresnel}if(t.texture){this.texture.dispose();this.texture=l(e,t.texture)}else if(t.colormap){this.texture.shape=[256,256];this.texture.minFilter=e.LINEAR_MIPMAP_LINEAR;this.texture.magFilter=e.LINEAR;this.texture.setPixels(k(t.colormap));this.texture.generateMipmap()}var r=t.cells;var i=t.positions;var o=t.vectors;if(!i||!r||!o){return}if(t.tubeScale!==undefined){this.tubeScale=t.tubeScale}var s=[];var c=[];var f=[];var h=[];var p=[];var d=[];var v=[];var g=[];var m=[];var y=[];var x=[];var b=[];var _=[];var w=[];var T=[];this.cells=r;this.positions=i;this.vectors=o;var S=t.vertexNormals;var E=t.cellNormals;var C=t.vertexNormalsEpsilon===void 0?n:t.vertexNormalsEpsilon;var L=t.faceNormalsEpsilon===void 0?a:t.faceNormalsEpsilon;if(t.useFacetNormals&&!E){E=u.faceNormals(r,i,L)}if(!E&&!S){S=u.vertexNormals(r,i,C)}var I=t.vertexColors;var z=t.cellColors;var P=t.meshColor||[1,1,1,1];var O=t.vertexUVs;var D=t.vertexIntensity;var R=t.cellUVs;var B=t.cellIntensity;var F=Infinity;var N=-Infinity;if(!O&&!R){if(D){if(t.vertexIntensityBounds){F=+t.vertexIntensityBounds[0];N=+t.vertexIntensityBounds[1]}else{for(var j=0;j<D.length;++j){var V=D[j];F=Math.min(F,V);N=Math.max(N,V)}}}else if(B){for(var j=0;j<B.length;++j){var V=B[j];F=Math.min(F,V);N=Math.max(N,V)}}else{for(var j=0;j<i.length;++j){var V=i[j][2];F=Math.min(F,V);N=Math.max(N,V)}}}if(D){this.intensity=D}else if(B){this.intensity=M(r,i.length,B)}else{this.intensity=A(i)}var U=t.pointSizes;var q=t.pointSize||1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(var j=0;j<i.length;++j){var H=i[j];for(var G=0;G<3;++G){if(isNaN(H[G])||!isFinite(H[G])){continue}this.bounds[0][G]=Math.min(this.bounds[0][G],H[G]);this.bounds[1][G]=Math.max(this.bounds[1][G],H[G])}}var W=0;var Y=0;var X=0;t:for(var j=0;j<r.length;++j){var Z=r[j];switch(Z.length){case 1:var $=Z[0];var H=i[$];for(var G=0;G<3;++G){if(isNaN(H[G])||!isFinite(H[G])){continue t}}x.push(H[0],H[1],H[2],H[3]);var J;if(I){J=I[$]}else if(z){J=z[j]}else{J=P}if(J.length===3){b.push(J[0],J[1],J[2],1)}else{b.push(J[0],J[1],J[2],J[3])}var K;if(O){K=O[$]}else if(D){K=[(D[$]-F)/(N-F),0]}else if(R){K=R[j]}else if(B){K=[(B[j]-F)/(N-F),0]}else{K=[(H[2]-F)/(N-F),0]}_.push(K[0],K[1]);if(U){w.push(U[$])}else{w.push(q)}T.push(j);X+=1;break;case 2:for(var G=0;G<2;++G){var $=Z[G];var H=i[$];for(var Q=0;Q<3;++Q){if(isNaN(H[Q])||!isFinite(H[Q])){continue t}}}for(var G=0;G<2;++G){var $=Z[G];var H=i[$];v.push(H[0],H[1],H[2]);var J;if(I){J=I[$]}else if(z){J=z[j]}else{J=P}if(J.length===3){g.push(J[0],J[1],J[2],1)}else{g.push(J[0],J[1],J[2],J[3])}var K;if(O){K=O[$]}else if(D){K=[(D[$]-F)/(N-F),0]}else if(R){K=R[j]}else if(B){K=[(B[j]-F)/(N-F),0]}else{K=[(H[2]-F)/(N-F),0]}m.push(K[0],K[1]);y.push(j)}Y+=1;break;case 3:for(var G=0;G<3;++G){var $=Z[G];var H=i[$];for(var Q=0;Q<3;++Q){if(isNaN(H[Q])||!isFinite(H[Q])){continue t}}}for(var G=0;G<3;++G){var $=Z[G];var H=i[$];s.push(H[0],H[1],H[2],H[3]);var tt=o[$];c.push(tt[0],tt[1],tt[2],tt[3]);var J;if(I){J=I[$]}else if(z){J=z[j]}else{J=P}if(J.length===3){f.push(J[0],J[1],J[2],1)}else{f.push(J[0],J[1],J[2],J[3])}var K;if(O){K=O[$]}else if(D){K=[(D[$]-F)/(N-F),0]}else if(R){K=R[j]}else if(B){K=[(B[j]-F)/(N-F),0]}else{K=[(H[2]-F)/(N-F),0]}p.push(K[0],K[1]);var et;if(S){et=S[$]}else{et=E[j]}h.push(et[0],et[1],et[2]);d.push(j)}W+=1;break;default:break}}this.pointCount=X;this.edgeCount=Y;this.triangleCount=W;this.pointPositions.update(x);this.pointColors.update(b);this.pointUVs.update(_);this.pointSizes.update(w);this.pointIds.update(new Uint32Array(T));this.edgePositions.update(v);this.edgeColors.update(g);this.edgeUVs.update(m);this.edgeIds.update(new Uint32Array(y));this.trianglePositions.update(s);this.triangleVectors.update(c);this.triangleColors.update(f);this.triangleUVs.update(p);this.triangleNormals.update(h);this.triangleIds.update(new Uint32Array(d))};w.drawTransparent=w.draw=function(t){t=t||{};var e=this.gl;var r=t.model||b;var n=t.view||b;var a=t.projection||b;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}var s={model:r,view:n,projection:a,clipBounds:i,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,contourColor:this.contourColor,texture:0};this.texture.bind(0);var l=new Array(16);c(l,s.view,s.model);c(l,s.projection,l);f(l,l);for(var o=0;o<3;++o){s.eyePosition[o]=l[12+o]/l[15]}var u=l[15];for(var o=0;o<3;++o){u+=this.lightPosition[o]*l[4*o+3]}for(var o=0;o<3;++o){var h=l[12+o];for(var p=0;p<3;++p){h+=l[4*p+o]*this.lightPosition[p]}s.lightPosition[o]=h/u}if(this.triangleCount>0){var d=this.triShader;d.bind();d.uniforms=s;this.triangleVAO.bind();e.drawArrays(e.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var d=this.lineShader;d.bind();d.uniforms=s;this.edgeVAO.bind();e.lineWidth(this.lineWidth);e.drawArrays(e.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var d=this.pointShader;d.bind();d.uniforms=s;this.pointVAO.bind();e.drawArrays(e.POINTS,0,this.pointCount);this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var d=this.contourShader;d.bind();d.uniforms=s;this.contourVAO.bind();e.drawArrays(e.LINES,0,this.contourCount);this.contourVAO.unbind()}};w.drawPick=function(t){t=t||{};var e=this.gl;var r=t.model||b;var n=t.view||b;var a=t.projection||b;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}this._model=[].slice.call(r);this._view=[].slice.call(n);this._projection=[].slice.call(a);this._resolution=[e.drawingBufferWidth,e.drawingBufferHeight];var s={model:r,view:n,projection:a,clipBounds:i,tubeScale:this.tubeScale,pickId:this.pickId/255};var l=this.pickShader;l.bind();l.uniforms=s;if(this.triangleCount>0){this.triangleVAO.bind();e.drawArrays(e.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0){this.edgeVAO.bind();e.lineWidth(this.lineWidth);e.drawArrays(e.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var l=this.pointPickShader;l.bind();l.uniforms=s;this.pointVAO.bind();e.drawArrays(e.POINTS,0,this.pointCount);this.pointVAO.unbind()}};w.pick=function(t){if(!t){return null}if(t.id!==this.pickId){return null}var e=t.value[0]+256*t.value[1]+65536*t.value[2];var r=this.cells[e];var n=this.positions[r[1]].slice(0,3);var a=this.intensity[r[1]];var i=this.vectors[r[1]].slice(0,3);var o=this.vectors[r[1]][3];return{index:e,position:n,intensity:a,velocity:i,divergence:o,dataCoordinate:n}};w.dispose=function(){this.texture.dispose();this.triShader.dispose();this.pickShader.dispose();this.triangleVAO.dispose();this.trianglePositions.dispose();this.triangleVectors.dispose();this.triangleColors.dispose();this.triangleUVs.dispose();this.triangleNormals.dispose();this.triangleIds.dispose();this.edgeVAO.dispose();this.edgePositions.dispose();this.edgeColors.dispose();this.edgeUVs.dispose();this.edgeIds.dispose();this.pointVAO.dispose();this.pointPositions.dispose();this.pointColors.dispose();this.pointUVs.dispose();this.pointSizes.dispose();this.pointIds.dispose();this.contourVAO.dispose();this.contourPositions.dispose()};function T(t){var e=i(t,y.vertex,y.fragment,null,y.attributes);e.attributes.position.location=0;e.attributes.color.location=2;e.attributes.uv.location=3;e.attributes.vector.location=5;return e}function S(t){var e=i(t,wireShader.vertex,wireShader.fragment);e.attributes.position.location=0;e.attributes.color.location=2;e.attributes.uv.location=3;return e}function E(t){var e=i(t,pointShader.vertex,pointShader.fragment);e.attributes.position.location=0;e.attributes.color.location=2;e.attributes.uv.location=3;e.attributes.pointSize.location=4;return e}function C(t){var e=i(t,x.vertex,x.fragment,null,x.attributes);e.attributes.position.location=0;e.attributes.id.location=1;e.attributes.vector.location=5;return e}function L(t){var e=i(t,pointPickShader.vertex,pointPickShader.fragment);e.attributes.position.location=0;e.attributes.id.location=1;e.attributes.pointSize.location=4;return e}function I(t){var e=i(t,contourShader.vertex,contourShader.fragment);e.attributes.position.location=0;return e}function z(t,e){if(arguments.length===1){e=t;t=e.gl}var r=e.triShader||T(t);var n=null;var a=null;var i=C(t);var u=null;var c=null;var f=l(t,h(new Uint8Array([255,255,255,255]),[1,1,4]));f.generateMipmap();f.minFilter=t.LINEAR_MIPMAP_LINEAR;f.magFilter=t.LINEAR;var p=o(t);var d=o(t);var v=o(t);var g=o(t);var m=o(t);var y=o(t);var x=s(t,[{buffer:p,type:t.FLOAT,size:4},{buffer:y,type:t.UNSIGNED_BYTE,size:4,normalized:true},{buffer:v,type:t.FLOAT,size:4},{buffer:g,type:t.FLOAT,size:2},{buffer:m,type:t.FLOAT,size:3},{buffer:d,type:t.FLOAT,size:4}]);var b=o(t);var w=o(t);var k=o(t);var M=o(t);var A=s(t,[{buffer:b,type:t.FLOAT,size:3},{buffer:M,type:t.UNSIGNED_BYTE,size:4,normalized:true},{buffer:w,type:t.FLOAT,size:4},{buffer:k,type:t.FLOAT,size:2}]);var S=o(t);var E=o(t);var L=o(t);var I=o(t);var z=o(t);var P=s(t,[{buffer:S,type:t.FLOAT,size:3},{buffer:z,type:t.UNSIGNED_BYTE,size:4,normalized:true},{buffer:E,type:t.FLOAT,size:4},{buffer:L,type:t.FLOAT,size:2},{buffer:I,type:t.FLOAT,size:1}]);var O=o(t);var D=s(t,[{buffer:O,type:t.FLOAT,size:3}]);var R=new _(t,f,r,n,a,i,u,c,p,d,y,v,g,m,x,b,M,w,k,A,S,z,E,L,I,P,O,D);R.update(e);return R}e.exports=z},{"./closest-point":297,"./shaders":298,colormap:113,"gl-buffer":230,"gl-mat4/invert":254,"gl-mat4/multiply":256,"gl-shader":287,"gl-texture2d":303,"gl-vao":308,ndarray:417,normals:420,"simplicial-complex-contour":479,"typedarray-pool":507}],300:[function(t,e,r){"use strict";var n=t("gl-vec3");var a=t("gl-vec4");var i=function(t,e,r,i){var o=t.points;var s=t.velocities;var l=t.divergences;var u,c,f,h,p,d;d=n.set(n.create(),0,1,0);h=n.create();p=n.create();var v=n.create();var g=[];var m=[];var y=[];var x=[];var b=[];var _=[];var w=0;var k=0;var M=a.create();var A=a.create();var T=8;for(var S=0;S<o.length;S++){u=o[S];c=s[S];f=l[S];if(e===0){f=r*.05}k=n.length(c)/i;M=a.create();n.copy(M,c);M[3]=f;for(var E=0;E<T;E++){b[E]=[u[0],u[1],u[2],E]}if(x.length>0){for(var E=0;E<T;E++){var C=(E+1)%T;g.push(x[E],b[E],b[C],b[C],x[C],x[E]);y.push(A,M,M,M,A,A);_.push(w,k,k,k,w,w);m.push([g.length-6,g.length-5,g.length-4],[g.length-3,g.length-2,g.length-1])}}var L=x;x=b;b=L;L=A;A=M;M=L;L=w;w=k;k=L}return{positions:g,cells:m,vectors:y,vertexIntensity:_}};var o=function(t,e,r,a){var o=0;for(var s=0;s<t.length;s++){var l=t[s].velocities;for(var u=0;u<l.length;u++){var c=n.length(l[u]);if(c>o){o=c}}}var f=t.map(function(t){return i(t,r,a,o)});var h=[];var p=[];var d=[];var v=[];for(var s=0;s<f.length;s++){var g=f[s];var m=h.length;h=h.concat(g.positions);d=d.concat(g.vectors);v=v.concat(g.vertexIntensity);for(var u=0;u<g.cells.length;u++){var y=g.cells[u];var x=[];p.push(x);for(var b=0;b<y.length;b++){x.push(y[b]+m)}}}return{positions:h,cells:p,vectors:d,vertexIntensity:v,colormap:e}};var s=function(t,e){var r=n.create();var a=1/1e4;n.add(r,t,[a,0,0]);var i=this.getVelocity(r);n.subtract(i,i,e);n.scale(i,i,1/a);n.add(r,t,[0,a,0]);var o=this.getVelocity(r);n.subtract(o,o,e);n.scale(o,o,1/a);n.add(r,t,[0,0,a]);var s=this.getVelocity(r);n.subtract(s,s,e);n.scale(s,s,1/a);n.add(r,i,o);n.add(r,r,s);return r};var l=function(t){var e=p(t,this.vectors,this.meshgrid,this.clampBorders);return e};var u=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(n===e)return r;if(n>e)return r-1}return r};var c=n.create();var f=n.create();var h=function(t,e,r){return t<e?e:t>r?r:t};var p=function(t,e,r,a){var i=t[0];var o=t[1];var s=t[2];var l=r[0].length;var p=r[1].length;var d=r[2].length;var v=u(r[0],i);var g=u(r[1],o);var m=u(r[2],s);var y=v+1;var x=g+1;var b=m+1;if(r[0][v]===i)y=v;if(r[1][g]===o)x=g;if(r[2][m]===s)b=m;if(a){v=h(v,0,l-1);y=h(y,0,l-1);g=h(g,0,p-1);x=h(x,0,p-1);m=h(m,0,d-1);b=h(b,0,d-1)}if(v<0||g<0||m<0||y>=l||x>=p||b>=d){return n.create()}var _=(i-r[0][v])/(r[0][y]-r[0][v]);var w=(o-r[1][g])/(r[1][x]-r[1][g]);var k=(s-r[2][m])/(r[2][b]-r[2][m]);if(_<0||_>1||isNaN(_))_=0;if(w<0||w>1||isNaN(w))w=0;if(k<0||k>1||isNaN(k))k=0;var M=m*l*p;var A=b*l*p;var T=g*l;var S=x*l;var E=v;var C=y;var L=e[T+M+E];var I=e[T+M+C];var z=e[S+M+E];var P=e[S+M+C];var O=e[T+A+E];var D=e[T+A+C];var R=e[S+A+E];var B=e[S+A+C];var F=n.create();n.lerp(F,L,I,_);n.lerp(c,z,P,_);n.lerp(F,F,c,w);n.lerp(c,O,D,_);n.lerp(f,R,B,_);n.lerp(c,c,f,w);n.lerp(F,F,c,k);return F};var d=function(t,e){var r=e[0];var n=e[1];var a=e[2];t[0]=r>=0?r:-r;t[1]=n>=0?n:-n;t[2]=a>=0?a:-a;return t};var v=function(t){var e=1/0;t.sort(function(t,e){return t-e});for(var r=1;r<t.length;r++){var n=Math.abs(t[r]-t[r-1]);if(n<e){e=n}}return e};var g=function(t){var e=[],r=[],n=[];var a={},i={},o={};for(var s=0;s<t.length;s++){var l=t[s];var u=l[0],c=l[1],f=l[2];if(!a[u]){e.push(u);a[u]=true}if(!i[c]){r.push(c);i[c]=true}if(!o[f]){n.push(f);o[f]=true}}var h=v(e);var p=v(r);var d=v(n);var g=Math.min(h,p,d);if(!isFinite(g)){return 1}return g};e.exports=function(t,e){var r=t.startingPositions;var a=t.maxLength||1e3;var i=t.tubeSize||1;var u=t.absoluteTubeSize;if(!t.getDivergence){t.getDivergence=s}if(!t.getVelocity){t.getVelocity=l}if(t.clampBorders===undefined){t.clampBorders=true}var c=[];var f=e[0][0],h=e[0][1],p=e[0][2];var d=e[1][0],v=e[1][1],m=e[1][2];var y=function(t,e){var r=e[0];var n=e[1];var a=e[2];return r>=f&&r<=d&&n>=h&&n<=v&&a>=p&&a<=m};var x=n.distance(e[0],e[1]);var b=10*x/a;var _=b*b;var w=1;var k=0;var M=n.create();if(r.length>=2){w=g(r)}for(var A=0;A<r.length;A++){var T=n.create();n.copy(T,r[A]);var S=[T];var E=[];var C=t.getVelocity(T);var L=T;E.push(C);var I=[];var z=t.getDivergence(T,C);var P=n.length(z);if(P>k&&!isNaN(P)&&isFinite(P)){k=P}I.push(P);c.push({points:S,velocities:E,divergences:I});var O=0;while(O<a*100&&S.length<a&&y(e,T)){O++;var D=n.clone(C);var R=n.squaredLength(D);if(R===0){break}else if(R>_){n.scale(D,D,b/Math.sqrt(R))}n.add(D,D,T);C=t.getVelocity(D);if(n.squaredDistance(L,D)-_>-1e-4*_){S.push(D);L=D;E.push(C);var z=t.getDivergence(D,C);var P=n.length(z);if(P>k&&!isNaN(P)&&isFinite(P)){k=P}I.push(P)}T=D}}for(var A=0;A<I.length;A++){var P=I[A];if(isNaN(P)||!isFinite(P)){I[A]=k}}var B=o(c,t.colormap,k,w);if(u){B.tubeScale=u}else{if(k===0){k=1}B.tubeScale=i*.5*w/k}return B};e.exports.createTubeMesh=t("./lib/tubemesh")},{"./lib/tubemesh":299,"gl-vec3":320,"gl-vec4":350}],301:[function(t,e,r){var n=t("gl-shader");var a=t("glslify");var i=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  worldCoordinate = vec3(uv.zw, f.x);\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]);var o=a(["precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (kill > 0.0 ||\n    any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\n    discard;\n  }\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color \u2014 in vertex or in fragment\n  vec4 surfaceColor = step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) + step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]);var s=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  vec4 worldPosition = model * vec4(dataCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z = clipPosition.z + zOffset;\n\n  gl_Position = clipPosition;\n  value = f;\n  kill = -1.0;\n  worldCoordinate = dataCoordinate;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]);var l=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if(kill > 0.0 ||\n    any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\n    discard;\n  }\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);r.createShader=function(t){var e=n(t,i,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);e.attributes.uv.location=0;e.attributes.f.location=1;e.attributes.normal.location=2;return e};r.createPickShader=function(t){var e=n(t,i,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);e.attributes.uv.location=0;e.attributes.f.location=1;e.attributes.normal.location=2;return e};r.createContourShader=function(t){var e=n(t,s,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);e.attributes.uv.location=0;e.attributes.f.location=1;return e};r.createPickContourShader=function(t){var e=n(t,s,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);e.attributes.uv.location=0;e.attributes.f.location=1;return e}},{"gl-shader":287,glslify:377}],302:[function(t,e,r){"use strict";e.exports=q;var n=t("bit-twiddle");var a=t("gl-buffer");var i=t("gl-vao");var o=t("gl-texture2d");var s=t("typedarray-pool");var l=t("colormap");var u=t("ndarray-ops");var c=t("ndarray-pack");var f=t("ndarray");var h=t("surface-nets");var p=t("gl-mat4/multiply");var d=t("gl-mat4/invert");var v=t("binary-search-bounds");var g=t("ndarray-gradient");var m=t("./lib/shaders");var y=m.createShader;var x=m.createContourShader;var b=m.createPickShader;var _=m.createPickContourShader;var w=4*(4+3+3);var k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var M=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]];var A=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var t=0;t<3;++t){var e=A[t];var r=(t+1)%3;var n=(t+2)%3;e[r+0]=1;e[n+3]=1;e[t+6]=1}})();function T(t,e,r,n,a){this.position=t;this.index=e;this.uv=r;this.level=n;this.dataCoordinate=a}var S=256;function E(t){var e=c([l({colormap:t,nshades:S,format:"rgba"}).map(function(t){return[t[0],t[1],t[2],255*t[3]]})]);u.divseq(e,255);return e}function C(t,e,r,n,a,i,o,l,u,c,h,p,d,v){this.gl=t;this.shape=e;this.bounds=r;this.intensityBounds=[];this._shader=n;this._pickShader=a;this._coordinateBuffer=i;this._vao=o;this._colorMap=l;this._contourShader=u;this._contourPickShader=c;this._contourBuffer=h;this._contourVAO=p;this._contourOffsets=[[],[],[]];this._contourCounts=[[],[],[]];this._vertexCount=0;this._pickResult=new T([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]);this._dynamicBuffer=d;this._dynamicVAO=v;this._dynamicOffsets=[0,0,0];this._dynamicCounts=[0,0,0];this.contourWidth=[1,1,1];this.contourLevels=[[1],[1],[1]];this.contourTint=[0,0,0];this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]];this.showContour=true;this.showSurface=true;this.enableHighlight=[true,true,true];this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.highlightTint=[1,1,1];this.highlightLevel=[-1,-1,-1];this.enableDynamic=[true,true,true];this.dynamicLevel=[NaN,NaN,NaN];this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.dynamicTint=[1,1,1];this.dynamicWidth=[1,1,1];this.axesBounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.surfaceProject=[false,false,false];this.contourProject=[[false,false,false],[false,false,false],[false,false,false]];this.colorBounds=[false,false];this._field=[f(s.mallocFloat(1024),[0,0]),f(s.mallocFloat(1024),[0,0]),f(s.mallocFloat(1024),[0,0])];this.pickId=1;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.snapToData=false;this.opacity=1;this.lightPosition=[10,1e4,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.vertexColor=0;this.dirty=true}var L=C.prototype;L.isTransparent=function(){return this.opacity<1};L.isOpaque=function(){if(this.opacity>=1){return true}for(var t=0;t<3;++t){if(this._contourCounts[t].length>0||this._dynamicCounts[t]>0){return true}}return false};L.pickSlots=1;L.setPickBase=function(t){this.pickId=t};var I=[0,0,0];var z={showSurface:false,showContour:false,projections:[k.slice(),k.slice(),k.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function P(t,e){var r,n,a;var i=e.axes&&e.axes.lastCubeProps.axis||I;var o=e.showSurface;var s=e.showContour;for(r=0;r<3;++r){o=o||e.surfaceProject[r];for(n=0;n<3;++n){s=s||e.contourProject[r][n]}}for(r=0;r<3;++r){var l=z.projections[r];for(n=0;n<16;++n){l[n]=0}for(n=0;n<4;++n){l[5*n]=1}l[5*r]=0;l[12+r]=e.axesBounds[+(i[r]>0)][r];p(l,t.model,l);var u=z.clipBounds[r];for(a=0;a<2;++a){for(n=0;n<3;++n){u[a][n]=t.clipBounds[a][n]}}u[0][r]=-1e8;u[1][r]=1e8}z.showSurface=o;z.showContour=s;return z}var O={model:k,view:k,projection:k,inverseModel:k.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0};var D=k.slice();var R=[1,0,0,0,1,0,0,0,1];function B(t,e){t=t||{};var r=this.gl;r.disable(r.CULL_FACE);this._colorMap.bind(0);var n=O;n.model=t.model||k;n.view=t.view||k;n.projection=t.projection||k;n.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]];n.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]];n.contourColor=this.contourColor[0];n.inverseModel=d(n.inverseModel,n.model);for(var a=0;a<2;++a){var i=n.clipBounds[a];for(var o=0;o<3;++o){i[o]=Math.min(Math.max(this.clipBounds[a][o],-1e8),1e8)}}n.kambient=this.ambientLight;n.kdiffuse=this.diffuseLight;n.kspecular=this.specularLight;n.roughness=this.roughness;n.fresnel=this.fresnel;n.opacity=this.opacity;n.height=0;n.permutation=R;n.vertexColor=this.vertexColor;var s=D;p(s,n.view,n.model);p(s,n.projection,s);d(s,s);for(a=0;a<3;++a){n.eyePosition[a]=s[12+a]/s[15]}var l=s[15];for(a=0;a<3;++a){l+=this.lightPosition[a]*s[4*a+3]}for(a=0;a<3;++a){var u=s[12+a];for(o=0;o<3;++o){u+=s[4*o+a]*this.lightPosition[o]}n.lightPosition[a]=u/l}var c=P(n,this);if(c.showSurface&&e===this.opacity<1){this._shader.bind();this._shader.uniforms=n;this._vao.bind();if(this.showSurface&&this._vertexCount){this._vao.draw(r.TRIANGLES,this._vertexCount)}for(a=0;a<3;++a){if(!this.surfaceProject[a]||!this.vertexCount){continue}this._shader.uniforms.model=c.projections[a];this._shader.uniforms.clipBounds=c.clipBounds[a];this._vao.draw(r.TRIANGLES,this._vertexCount)}this._vao.unbind()}if(c.showContour&&!e){var f=this._contourShader;n.kambient=1;n.kdiffuse=0;n.kspecular=0;n.opacity=1;f.bind();f.uniforms=n;var h=this._contourVAO;h.bind();for(a=0;a<3;++a){f.uniforms.permutation=A[a];r.lineWidth(this.contourWidth[a]);for(o=0;o<this.contourLevels[a].length;++o){if(o===this.highlightLevel[a]){f.uniforms.contourColor=this.highlightColor[a];f.uniforms.contourTint=this.highlightTint[a]}else if(o===0||o-1===this.highlightLevel[a]){f.uniforms.contourColor=this.contourColor[a];f.uniforms.contourTint=this.contourTint[a]}if(!this._contourCounts[a][o]){continue}f.uniforms.height=this.contourLevels[a][o];h.draw(r.LINES,this._contourCounts[a][o],this._contourOffsets[a][o])}}for(a=0;a<3;++a){f.uniforms.model=c.projections[a];f.uniforms.clipBounds=c.clipBounds[a];for(o=0;o<3;++o){if(!this.contourProject[a][o]){continue}f.uniforms.permutation=A[o];r.lineWidth(this.contourWidth[o]);for(var v=0;v<this.contourLevels[o].length;++v){if(v===this.highlightLevel[o]){f.uniforms.contourColor=this.highlightColor[o];f.uniforms.contourTint=this.highlightTint[o]}else if(v===0||v-1===this.highlightLevel[o]){f.uniforms.contourColor=this.contourColor[o];f.uniforms.contourTint=this.contourTint[o]}f.uniforms.height=this.contourLevels[o][v];h.draw(r.LINES,this._contourCounts[o][v],this._contourOffsets[o][v])}}}h.unbind();h=this._dynamicVAO;h.bind();for(a=0;a<3;++a){if(this._dynamicCounts[a]===0){continue}f.uniforms.model=n.model;f.uniforms.clipBounds=n.clipBounds;f.uniforms.permutation=A[a];r.lineWidth(this.dynamicWidth[a]);f.uniforms.contourColor=this.dynamicColor[a];f.uniforms.contourTint=this.dynamicTint[a];f.uniforms.height=this.dynamicLevel[a];h.draw(r.LINES,this._dynamicCounts[a],this._dynamicOffsets[a]);for(o=0;o<3;++o){if(!this.contourProject[o][a]){continue}f.uniforms.model=c.projections[o];f.uniforms.clipBounds=c.clipBounds[o];h.draw(r.LINES,this._dynamicCounts[a],this._dynamicOffsets[a])}}h.unbind()}}L.draw=function(t){return B.call(this,t,false)};L.drawTransparent=function(t){return B.call(this,t,true)};var F={model:k,view:k,projection:k,inverseModel:k,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};L.drawPick=function(t){t=t||{};var e=this.gl;e.disable(e.CULL_FACE);var r=F;r.model=t.model||k;r.view=t.view||k;r.projection=t.projection||k;r.shape=this._field[2].shape;r.pickId=this.pickId/255;r.lowerBound=this.bounds[0];r.upperBound=this.bounds[1];r.permutation=R;for(var n=0;n<2;++n){var a=r.clipBounds[n];for(var i=0;i<3;++i){a[i]=Math.min(Math.max(this.clipBounds[n][i],-1e8),1e8)}}var o=P(r,this);if(o.showSurface){this._pickShader.bind();this._pickShader.uniforms=r;this._vao.bind();this._vao.draw(e.TRIANGLES,this._vertexCount);for(n=0;n<3;++n){if(!this.surfaceProject[n]){continue}this._pickShader.uniforms.model=o.projections[n];this._pickShader.uniforms.clipBounds=o.clipBounds[n];this._vao.draw(e.TRIANGLES,this._vertexCount)}this._vao.unbind()}if(o.showContour){var s=this._contourPickShader;s.bind();s.uniforms=r;var l=this._contourVAO;l.bind();for(i=0;i<3;++i){e.lineWidth(this.contourWidth[i]);s.uniforms.permutation=A[i];for(n=0;n<this.contourLevels[i].length;++n){if(this._contourCounts[i][n]){s.uniforms.height=this.contourLevels[i][n];l.draw(e.LINES,this._contourCounts[i][n],this._contourOffsets[i][n])}}}for(n=0;n<3;++n){s.uniforms.model=o.projections[n];s.uniforms.clipBounds=o.clipBounds[n];for(i=0;i<3;++i){if(!this.contourProject[n][i]){continue}s.uniforms.permutation=A[i];e.lineWidth(this.contourWidth[i]);for(var u=0;u<this.contourLevels[i].length;++u){if(this._contourCounts[i][u]){s.uniforms.height=this.contourLevels[i][u];l.draw(e.LINES,this._contourCounts[i][u],this._contourOffsets[i][u])}}}}l.unbind()}};L.pick=function(t){if(!t){return null}if(t.id!==this.pickId){return null}var e=this._field[2].shape;var r=this._pickResult;var n=e[0]*(t.value[0]+(t.value[2]>>4)/16)/255;var a=Math.floor(n);var i=n-a;var o=e[1]*(t.value[1]+(t.value[2]&15)/16)/255;var s=Math.floor(o);var l=o-s;a+=1;s+=1;var u=r.position;u[0]=u[1]=u[2]=0;for(var c=0;c<2;++c){var f=c?i:1-i;for(var h=0;h<2;++h){var p=h?l:1-l;var d=a+c;var g=s+h;var m=f*p;for(var y=0;y<3;++y){u[y]+=this._field[y].get(d,g)*m}}}var x=this._pickResult.level;for(var b=0;b<3;++b){x[b]=v.le(this.contourLevels[b],u[b]);if(x[b]<0){if(this.contourLevels[b].length>0){x[b]=0}}else if(x[b]<this.contourLevels[b].length-1){var _=this.contourLevels[b][x[b]];var w=this.contourLevels[b][x[b]+1];if(Math.abs(_-u[b])>Math.abs(w-u[b])){x[b]+=1}}}r.index[0]=i<.5?a:a+1;r.index[1]=l<.5?s:s+1;r.uv[0]=n/e[0];r.uv[1]=o/e[1];for(y=0;y<3;++y){r.dataCoordinate[y]=this._field[y].get(r.index[0],r.index[1])}return r};function N(t,e){var r=e.shape.slice();var n=t.shape.slice();u.assign(t.lo(1,1).hi(r[0],r[1]),e);u.assign(t.lo(1).hi(r[0],1),e.hi(r[0],1));u.assign(t.lo(1,n[1]-1).hi(r[0],1),e.lo(0,r[1]-1).hi(r[0],1));u.assign(t.lo(0,1).hi(1,r[1]),e.hi(1));u.assign(t.lo(n[0]-1,1).hi(1,r[1]),e.lo(r[0]-1));t.set(0,0,e.get(0,0));t.set(0,n[1]-1,e.get(0,r[1]-1));t.set(n[0]-1,0,e.get(r[0]-1,0));t.set(n[0]-1,n[1]-1,e.get(r[0]-1,r[1]-1))}function j(t,e){if(Array.isArray(t)){return[e(t[0]),e(t[1]),e(t[2])]}return[e(t),e(t),e(t)]}function V(t){if(Array.isArray(t)){if(t.length===3){return[t[0],t[1],t[2],1]}return[t[0],t[1],t[2],t[3]]}return[0,0,0,1]}function U(t){if(Array.isArray(t)){if(Array.isArray(t)){return[V(t[0]),V(t[1]),V(t[2])]}else{var e=V(t);return[e.slice(),e.slice(),e.slice()]}}}L.update=function(t){t=t||{};this.dirty=true;if("contourWidth"in t){this.contourWidth=j(t.contourWidth,Number)}if("showContour"in t){this.showContour=j(t.showContour,Boolean)}if("showSurface"in t){this.showSurface=!!t.showSurface}if("contourTint"in t){this.contourTint=j(t.contourTint,Boolean)}if("contourColor"in t){this.contourColor=U(t.contourColor)}if("contourProject"in t){this.contourProject=j(t.contourProject,function(t){return j(t,Boolean)})}if("surfaceProject"in t){this.surfaceProject=t.surfaceProject}if("dynamicColor"in t){this.dynamicColor=U(t.dynamicColor)}if("dynamicTint"in t){this.dynamicTint=j(t.dynamicTint,Number)}if("dynamicWidth"in t){this.dynamicWidth=j(t.dynamicWidth,Number)}if("opacity"in t){this.opacity=t.opacity}if("colorBounds"in t){this.colorBounds=t.colorBounds}if("vertexColor"in t){this.vertexColor=t.vertexColor?1:0}var e=t.field||t.coords&&t.coords[2]||null;var r=false;if(!e){if(this._field[2].shape[0]||this._field[2].shape[2]){e=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2)}else{e=this._field[2].hi(0,0)}}if("field"in t||"coords"in t){var a=(e.shape[0]+2)*(e.shape[1]+2);if(a>this._field[2].data.length){s.freeFloat(this._field[2].data);this._field[2].data=s.mallocFloat(n.nextPow2(a))}this._field[2]=f(this._field[2].data,[e.shape[0]+2,e.shape[1]+2]);N(this._field[2],e);this.shape=e.shape.slice();var i=this.shape;for(var o=0;o<2;++o){if(this._field[2].size>this._field[o].data.length){s.freeFloat(this._field[o].data);this._field[o].data=s.mallocFloat(this._field[2].size)}this._field[o]=f(this._field[o].data,[i[0]+2,i[1]+2])}if(t.coords){var l=t.coords;if(!Array.isArray(l)||l.length!==3){throw new Error("gl-surface: invalid coordinates for x/y")}for(o=0;o<2;++o){var u=l[o];for(m=0;m<2;++m){if(u.shape[m]!==i[m]){throw new Error("gl-surface: coords have incorrect shape")}}N(this._field[o],u)}}else if(t.ticks){var c=t.ticks;if(!Array.isArray(c)||c.length!==2){throw new Error("gl-surface: invalid ticks")}for(o=0;o<2;++o){var p=c[o];if(Array.isArray(p)||p.length){p=f(p)}if(p.shape[0]!==i[o]){throw new Error("gl-surface: invalid tick length")}var d=f(p.data,i);d.stride[o]=p.stride[0];d.stride[o^1]=0;N(this._field[o],d)}}else{for(o=0;o<2;++o){var v=[0,0];v[o]=1;this._field[o]=f(this._field[o].data,[i[0]+2,i[1]+2],v,0)}this._field[0].set(0,0,0);for(var m=0;m<i[0];++m){this._field[0].set(m+1,0,m)}this._field[0].set(i[0]+1,0,i[0]-1);this._field[1].set(0,0,0);for(m=0;m<i[1];++m){this._field[1].set(0,m+1,m)}this._field[1].set(0,i[1]+1,i[1]-1)}var y=this._field;var x=f(s.mallocFloat(y[2].size*3*2),[3,i[0]+2,i[1]+2,2]);for(o=0;o<3;++o){g(x.pick(o),y[o],"mirror")}var b=f(s.mallocFloat(y[2].size*3),[i[0]+2,i[1]+2,3]);for(o=0;o<i[0]+2;++o){for(m=0;m<i[1]+2;++m){var _=x.get(0,o,m,0);var w=x.get(0,o,m,1);var k=x.get(1,o,m,0);var A=x.get(1,o,m,1);var T=x.get(2,o,m,0);var S=x.get(2,o,m,1);var C=k*S-A*T;var L=T*w-S*_;var I=_*A-w*k;var z=Math.sqrt(C*C+L*L+I*I);if(z<1e-8){z=Math.max(Math.abs(C),Math.abs(L),Math.abs(I));if(z<1e-8){I=1;L=C=0;z=1}else{z=1/z}}else{z=1/Math.sqrt(z)}b.set(o,m,0,C*z);b.set(o,m,1,L*z);b.set(o,m,2,I*z)}}s.free(x.data);var P=[Infinity,Infinity,Infinity];var O=[-Infinity,-Infinity,-Infinity];var D=Infinity;var R=-Infinity;var B=(i[0]-1)*(i[1]-1)*6;var F=s.mallocFloat(n.nextPow2(10*B));var V=0;var q=0;for(o=0;o<i[0]-1;++o){t:for(m=0;m<i[1]-1;++m){for(var H=0;H<2;++H){for(var G=0;G<2;++G){for(var W=0;W<3;++W){var Y=this._field[W].get(1+o+H,1+m+G);if(isNaN(Y)||!isFinite(Y)){continue t}}}}for(W=0;W<6;++W){var X=o+M[W][0];var Z=m+M[W][1];var $=this._field[0].get(X+1,Z+1);var J=this._field[1].get(X+1,Z+1);Y=this._field[2].get(X+1,Z+1);var K=Y;C=b.get(X+1,Z+1,0);L=b.get(X+1,Z+1,1);I=b.get(X+1,Z+1,2);if(t.intensity){K=t.intensity.get(X,Z)}F[V++]=X;F[V++]=Z;F[V++]=$;F[V++]=J;F[V++]=Y;F[V++]=0;F[V++]=K;F[V++]=C;F[V++]=L;F[V++]=I;P[0]=Math.min(P[0],$);P[1]=Math.min(P[1],J);P[2]=Math.min(P[2],Y);D=Math.min(D,K);O[0]=Math.max(O[0],$);O[1]=Math.max(O[1],J);O[2]=Math.max(O[2],Y);R=Math.max(R,K);q+=1}}}if(t.intensityBounds){D=+t.intensityBounds[0];R=+t.intensityBounds[1]}for(o=6;o<V;o+=10){F[o]=(F[o]-D)/(R-D)}this._vertexCount=q;this._coordinateBuffer.update(F.subarray(0,V));s.freeFloat(F);s.free(b.data);this.bounds=[P,O];this.intensity=t.intensity||this._field[2];if(this.intensityBounds[0]!==D||this.intensityBounds[1]!==R){r=true}this.intensityBounds=[D,R]}if("levels"in t){var Q=t.levels;if(!Array.isArray(Q[0])){Q=[[],[],Q]}else{Q=Q.slice()}for(o=0;o<3;++o){Q[o]=Q[o].slice();Q.sort(function(t,e){return t-e})}t:for(o=0;o<3;++o){if(Q[o].length!==this.contourLevels[o].length){r=true;break}for(m=0;m<Q[o].length;++m){if(Q[o][m]!==this.contourLevels[o][m]){r=true;break t}}}this.contourLevels=Q}if(r){y=this._field;i=this.shape;var tt=[];for(var et=0;et<3;++et){Q=this.contourLevels[et];var rt=[];var nt=[];var at=[0,0,0];for(o=0;o<Q.length;++o){var it=h(this._field[et],Q[o]);rt.push(tt.length/5|0);q=0;t:for(m=0;m<it.cells.length;++m){var ot=it.cells[m];for(W=0;W<2;++W){var st=it.positions[ot[W]];var lt=st[0];var ut=Math.floor(lt)|0;var ct=lt-ut;var ft=st[1];var ht=Math.floor(ft)|0;var pt=ft-ht;var dt=false;e:for(var vt=0;vt<3;++vt){at[vt]=0;var gt=(et+vt+1)%3;for(H=0;H<2;++H){var mt=H?ct:1-ct;X=Math.min(Math.max(ut+H,0),i[0])|0;for(G=0;G<2;++G){var yt=G?pt:1-pt;Z=Math.min(Math.max(ht+G,0),i[1])|0;if(vt<2){Y=this._field[gt].get(X,Z)}else{Y=(this.intensity.get(X,Z)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0])}if(!isFinite(Y)||isNaN(Y)){dt=true;break e}var xt=mt*yt;at[vt]+=xt*Y}}}if(!dt){tt.push(at[0],at[1],st[0],st[1],at[2]);q+=1}else{if(W>0){for(var bt=0;bt<5;++bt){tt.pop()}q-=1}continue t}}}nt.push(q)}this._contourOffsets[et]=rt;this._contourCounts[et]=nt}var _t=s.mallocFloat(tt.length);for(o=0;o<tt.length;++o){_t[o]=tt[o]}this._contourBuffer.update(_t);s.freeFloat(_t)}if(t.colormap){this._colorMap.setPixels(E(t.colormap))}};L.dispose=function(){this._shader.dispose();this._vao.dispose();this._coordinateBuffer.dispose();this._colorMap.dispose();this._contourBuffer.dispose();this._contourVAO.dispose();this._contourShader.dispose();this._contourPickShader.dispose();this._dynamicBuffer.dispose();this._dynamicVAO.dispose();for(var t=0;t<3;++t){s.freeFloat(this._field[t].data)}};L.highlight=function(t){if(!t){this._dynamicCounts=[0,0,0];this.dyanamicLevel=[NaN,NaN,NaN];this.highlightLevel=[-1,-1,-1];return}for(var e=0;e<3;++e){if(this.enableHighlight[e]){this.highlightLevel[e]=t.level[e]}else{this.highlightLevel[e]=-1}}var r;if(this.snapToData){r=t.dataCoordinate}else{r=t.position}if((!this.enableDynamic[0]||r[0]===this.dynamicLevel[0])&&(!this.enableDynamic[1]||r[1]===this.dynamicLevel[1])&&(!this.enableDynamic[2]||r[2]===this.dynamicLevel[2])){return}var n=0;var a=this.shape;var i=s.mallocFloat(12*a[0]*a[1]);for(var o=0;o<3;++o){if(!this.enableDynamic[o]){this.dynamicLevel[o]=NaN;this._dynamicCounts[o]=0;continue}this.dynamicLevel[o]=r[o];var l=(o+1)%3;var u=(o+2)%3;var c=this._field[o];var f=this._field[l];var p=this._field[u];var d=this.intensity;var v=h(c,r[o]);var g=v.cells;var m=v.positions;this._dynamicOffsets[o]=n;for(e=0;e<g.length;++e){var y=g[e];for(var x=0;x<2;++x){var b=m[y[x]];var _=+b[0];var w=_|0;var k=Math.min(w+1,a[0])|0;var M=_-w;var A=1-M;var T=+b[1];var S=T|0;var E=Math.min(S+1,a[1])|0;var C=T-S;var L=1-C;var I=A*L;var z=A*C;var P=M*L;var O=M*C;var D=I*f.get(w,S)+z*f.get(w,E)+P*f.get(k,S)+O*f.get(k,E);var R=I*p.get(w,S)+z*p.get(w,E)+P*p.get(k,S)+O*p.get(k,E);if(isNaN(D)||isNaN(R)){if(x){n-=1}break}i[2*n+0]=D;i[2*n+1]=R;n+=1}}this._dynamicCounts[o]=n-this._dynamicOffsets[o]}this._dynamicBuffer.update(i.subarray(0,2*n));s.freeFloat(i)};function q(t){var e=t.gl;var r=y(e);var n=b(e);var s=x(e);var l=_(e);var u=a(e);var c=i(e,[{buffer:u,size:4,stride:w,offset:0},{buffer:u,size:3,stride:w,offset:16},{buffer:u,size:3,stride:w,offset:28}]);var f=a(e);var h=i(e,[{buffer:f,size:4,stride:20,offset:0},{buffer:f,size:1,stride:20,offset:16}]);var p=a(e);var d=i(e,[{buffer:p,size:2,type:e.FLOAT}]);var v=o(e,1,S,e.RGBA,e.UNSIGNED_BYTE);v.minFilter=e.LINEAR;v.magFilter=e.LINEAR;var g=new C(e,[0,0],[[0,0,0],[0,0,0]],r,n,u,c,v,s,l,f,h,p,d);var m={levels:[[],[],[]]};for(var k in t){m[k]=t[k]}m.colormap=m.colormap||"jet";g.update(m);return g}},{"./lib/shaders":301,"binary-search-bounds":79,"bit-twiddle":80,colormap:113,"gl-buffer":230,"gl-mat4/invert":254,"gl-mat4/multiply":256,"gl-texture2d":303,"gl-vao":308,ndarray:417,"ndarray-gradient":408,"ndarray-ops":411,"ndarray-pack":412,"surface-nets":493,"typedarray-pool":507}],303:[function(t,e,r){"use strict";var n=t("ndarray");var a=t("ndarray-ops");var i=t("typedarray-pool");e.exports=_;var o=null;var s=null;var l=null;function u(t){o=[t.LINEAR,t.NEAREST_MIPMAP_LINEAR,t.LINEAR_MIPMAP_NEAREST,t.LINEAR_MIPMAP_NEAREST];s=[t.NEAREST,t.LINEAR,t.NEAREST_MIPMAP_NEAREST,t.NEAREST_MIPMAP_LINEAR,t.LINEAR_MIPMAP_NEAREST,t.LINEAR_MIPMAP_LINEAR];l=[t.REPEAT,t.CLAMP_TO_EDGE,t.MIRRORED_REPEAT]}function c(t){return"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&t instanceof ImageData}var f=function(t,e){a.muls(t,e,255)};function h(t,e,r){var n=t.gl;var a=n.getParameter(n.MAX_TEXTURE_SIZE);if(e<0||e>a||r<0||r>a){throw new Error("gl-texture2d: Invalid texture size")}t._shape=[e,r];t.bind();n.texImage2D(n.TEXTURE_2D,0,t.format,e,r,0,t.format,t.type,null);t._mipLevels=[0];return t}function p(t,e,r,n,a,i){this.gl=t;this.handle=e;this.format=a;this.type=i;this._shape=[r,n];this._mipLevels=[0];this._magFilter=t.NEAREST;this._minFilter=t.NEAREST;this._wrapS=t.CLAMP_TO_EDGE;this._wrapT=t.CLAMP_TO_EDGE;this._anisoSamples=1;var o=this;var s=[this._wrapS,this._wrapT];Object.defineProperties(s,[{get:function(){return o._wrapS},set:function(t){return o.wrapS=t}},{get:function(){return o._wrapT},set:function(t){return o.wrapT=t}}]);this._wrapVector=s;var l=[this._shape[0],this._shape[1]];Object.defineProperties(l,[{get:function(){return o._shape[0]},set:function(t){return o.width=t}},{get:function(){return o._shape[1]},set:function(t){return o.height=t}}]);this._shapeVector=l}var d=p.prototype;Object.defineProperties(d,{minFilter:{get:function(){return this._minFilter},set:function(t){this.bind();var e=this.gl;if(this.type===e.FLOAT&&o.indexOf(t)>=0){if(!e.getExtension("OES_texture_float_linear")){t=e.NEAREST}}if(s.indexOf(t)<0){throw new Error("gl-texture2d: Unknown filter mode "+t)}e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t);return this._minFilter=t}},magFilter:{get:function(){return this._magFilter},set:function(t){this.bind();var e=this.gl;if(this.type===e.FLOAT&&o.indexOf(t)>=0){if(!e.getExtension("OES_texture_float_linear")){t=e.NEAREST}}if(s.indexOf(t)<0){throw new Error("gl-texture2d: Unknown filter mode "+t)}e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t);return this._magFilter=t}},mipSamples:{get:function(){return this._anisoSamples},set:function(t){var e=this._anisoSamples;this._anisoSamples=Math.max(t,1)|0;if(e!==this._anisoSamples){var r=this.gl.getExtension("EXT_texture_filter_anisotropic");if(r){this.gl.texParameterf(this.gl.TEXTURE_2D,r.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(t){this.bind();if(l.indexOf(t)<0){throw new Error("gl-texture2d: Unknown wrap mode "+t)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,t);return this._wrapS=t}},wrapT:{get:function(){return this._wrapT},set:function(t){this.bind();if(l.indexOf(t)<0){throw new Error("gl-texture2d: Unknown wrap mode "+t)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,t);return this._wrapT=t}},wrap:{get:function(){return this._wrapVector},set:function(t){if(!Array.isArray(t)){t=[t,t]}if(t.length!==2){throw new Error("gl-texture2d: Must specify wrap mode for rows and columns")}for(var e=0;e<2;++e){if(l.indexOf(t[e])<0){throw new Error("gl-texture2d: Unknown wrap mode "+t)}}this._wrapS=t[0];this._wrapT=t[1];var r=this.gl;this.bind();r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,this._wrapS);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,this._wrapT);return t}},shape:{get:function(){return this._shapeVector},set:function(t){if(!Array.isArray(t)){t=[t|0,t|0]}else{if(t.length!==2){throw new Error("gl-texture2d: Invalid texture shape")}}h(this,t[0]|0,t[1]|0);return[t[0]|0,t[1]|0]}},width:{get:function(){return this._shape[0]},set:function(t){t=t|0;h(this,t,this._shape[1]);return t}},height:{get:function(){return this._shape[1]},set:function(t){t=t|0;h(this,this._shape[0],t);return t}}});d.bind=function(t){var e=this.gl;if(t!==undefined){e.activeTexture(e.TEXTURE0+(t|0))}e.bindTexture(e.TEXTURE_2D,this.handle);if(t!==undefined){return t|0}return e.getParameter(e.ACTIVE_TEXTURE)-e.TEXTURE0};d.dispose=function(){this.gl.deleteTexture(this.handle)};d.generateMipmap=function(){this.bind();this.gl.generateMipmap(this.gl.TEXTURE_2D);var t=Math.min(this._shape[0],this._shape[1]);for(var e=0;t>0;++e,t>>>=1){if(this._mipLevels.indexOf(e)<0){this._mipLevels.push(e)}}};d.setPixels=function(t,e,r,n){var a=this.gl;this.bind();if(Array.isArray(e)){n=r;r=e[1]|0;e=e[0]|0}else{e=e||0;r=r||0}n=n||0;var i=c(t)?t:t.raw;if(i){var o=this._mipLevels.indexOf(n)<0;if(o){a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,this.type,i);this._mipLevels.push(n)}else{a.texSubImage2D(a.TEXTURE_2D,n,e,r,this.format,this.type,i)}}else if(t.shape&&t.stride&&t.data){if(t.shape.length<2||e+t.shape[1]>this._shape[1]>>>n||r+t.shape[0]>this._shape[0]>>>n||e<0||r<0){throw new Error("gl-texture2d: Texture dimensions are out of bounds")}g(a,e,r,n,this.format,this.type,this._mipLevels,t)}else{throw new Error("gl-texture2d: Unsupported data type")}};function v(t,e){if(t.length===3){return e[2]===1&&e[1]===t[0]*t[2]&&e[0]===t[2]}return e[0]===1&&e[1]===t[0]}function g(t,e,r,o,s,l,u,c){var h=c.dtype;var p=c.shape.slice();if(p.length<2||p.length>3){throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d")}var d=0,g=0;var m=v(p,c.stride.slice());if(h==="float32"){d=t.FLOAT}else if(h==="float64"){d=t.FLOAT;m=false;h="float32"}else if(h==="uint8"){d=t.UNSIGNED_BYTE}else{d=t.UNSIGNED_BYTE;m=false;h="uint8"}var y=1;if(p.length===2){g=t.LUMINANCE;p=[p[0],p[1],1];c=n(c.data,p,[c.stride[0],c.stride[1],1],c.offset)}else if(p.length===3){if(p[2]===1){g=t.ALPHA}else if(p[2]===2){g=t.LUMINANCE_ALPHA}else if(p[2]===3){g=t.RGB}else if(p[2]===4){g=t.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}y=p[2]}else{throw new Error("gl-texture2d: Invalid shape for texture")}if((g===t.LUMINANCE||g===t.ALPHA)&&(s===t.LUMINANCE||s===t.ALPHA)){g=s}if(g!==s){throw new Error("gl-texture2d: Incompatible texture format for setPixels")}var x=c.size;var b=u.indexOf(o)<0;if(b){u.push(o)}if(d===l&&m){if(c.offset===0&&c.data.length===x){if(b){t.texImage2D(t.TEXTURE_2D,o,s,p[0],p[1],0,s,l,c.data)}else{t.texSubImage2D(t.TEXTURE_2D,o,e,r,p[0],p[1],s,l,c.data)}}else{if(b){t.texImage2D(t.TEXTURE_2D,o,s,p[0],p[1],0,s,l,c.data.subarray(c.offset,c.offset+x))}else{t.texSubImage2D(t.TEXTURE_2D,o,e,r,p[0],p[1],s,l,c.data.subarray(c.offset,c.offset+x))}}}else{var _;if(l===t.FLOAT){_=i.mallocFloat32(x)}else{_=i.mallocUint8(x)}var w=n(_,p,[p[2],p[2]*p[0],1]);if(d===t.FLOAT&&l===t.UNSIGNED_BYTE){f(w,c)}else{a.assign(w,c)}if(b){t.texImage2D(t.TEXTURE_2D,o,s,p[0],p[1],0,s,l,_.subarray(0,x))}else{t.texSubImage2D(t.TEXTURE_2D,o,e,r,p[0],p[1],s,l,_.subarray(0,x))}if(l===t.FLOAT){i.freeFloat32(_)}else{i.freeUint8(_)}}}function m(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);return e}function y(t,e,r,n,a){var i=t.getParameter(t.MAX_TEXTURE_SIZE);if(e<0||e>i||r<0||r>i){throw new Error("gl-texture2d: Invalid texture shape")}if(a===t.FLOAT&&!t.getExtension("OES_texture_float")){throw new Error("gl-texture2d: Floating point textures not supported on this platform")}var o=m(t);t.texImage2D(t.TEXTURE_2D,0,n,e,r,0,n,a,null);return new p(t,o,e,r,n,a)}function x(t,e,r,n,a,i){var o=m(t);t.texImage2D(t.TEXTURE_2D,0,a,a,i,e);return new p(t,o,r,n,a,i)}function b(t,e){var r=e.dtype;var o=e.shape.slice();var s=t.getParameter(t.MAX_TEXTURE_SIZE);if(o[0]<0||o[0]>s||o[1]<0||o[1]>s){throw new Error("gl-texture2d: Invalid texture size")}var l=v(o,e.stride.slice());var u=0;if(r==="float32"){u=t.FLOAT}else if(r==="float64"){u=t.FLOAT;l=false;r="float32"}else if(r==="uint8"){u=t.UNSIGNED_BYTE}else{u=t.UNSIGNED_BYTE;l=false;r="uint8"}var c=0;if(o.length===2){c=t.LUMINANCE;o=[o[0],o[1],1];e=n(e.data,o,[e.stride[0],e.stride[1],1],e.offset)}else if(o.length===3){if(o[2]===1){c=t.ALPHA}else if(o[2]===2){c=t.LUMINANCE_ALPHA}else if(o[2]===3){c=t.RGB}else if(o[2]===4){c=t.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}}else{throw new Error("gl-texture2d: Invalid shape for texture")}if(u===t.FLOAT&&!t.getExtension("OES_texture_float")){u=t.UNSIGNED_BYTE;l=false}var h,d;var g=e.size;if(!l){var y=[o[2],o[2]*o[0],1];d=i.malloc(g,r);var x=n(d,o,y,0);if((r==="float32"||r==="float64")&&u===t.UNSIGNED_BYTE){f(x,e)}else{a.assign(x,e)}h=d.subarray(0,g)}else if(e.offset===0&&e.data.length===g){h=e.data}else{h=e.data.subarray(e.offset,e.offset+g)}var b=m(t);t.texImage2D(t.TEXTURE_2D,0,c,o[0],o[1],0,c,u,h);if(!l){i.free(d)}return new p(t,b,o[0],o[1],c,u)}function _(t){if(arguments.length<=1){throw new Error("gl-texture2d: Missing arguments for texture2d constructor")}if(!o){u(t)}if(typeof arguments[1]==="number"){return y(t,arguments[1],arguments[2],arguments[3]||t.RGBA,arguments[4]||t.UNSIGNED_BYTE)}if(Array.isArray(arguments[1])){return y(t,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||t.RGBA,arguments[3]||t.UNSIGNED_BYTE)}if(typeof arguments[1]==="object"){var e=arguments[1];var r=c(e)?e:e.raw;if(r){return x(t,r,e.width|0,e.height|0,arguments[2]||t.RGBA,arguments[3]||t.UNSIGNED_BYTE)}else if(e.shape&&e.data&&e.stride){return b(t,e)}}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:417,"ndarray-ops":411,"typedarray-pool":507}],304:[function(t,e,r){"use strict";var n=t("pick-by-alias");e.exports=function t(e){if(!e)e={};else if(typeof e==="string")e={container:e};if(i(e)){e={container:e}}else if(o(e)){e={container:e}}else if(s(e)){e={gl:e}}else{e=n(e,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio"},true)}if(!e.pixelRatio)e.pixelRatio=window.pixelRatio||1;if(e.gl){return e.gl}if(e.canvas){e.container=e.canvas.parentNode}if(e.container){if(typeof e.container==="string"){var r=document.querySelector(e.container);if(!r)throw Error("Element "+e.container+" is not found");e.container=r}if(i(e.container)){e.canvas=e.container;e.container=e.canvas.parentNode}else if(!e.canvas){e.canvas=document.createElement("canvas");e.container.appendChild(e.canvas);a(e)}}else if(!e.canvas){e.container=document.body||document.documentElement;e.canvas=document.createElement("canvas");e.canvas.style.position="absolute";e.canvas.style.top=0;e.canvas.style.left=0;e.container.appendChild(e.canvas);a(e)}if(!e.gl){try{e.gl=e.canvas.getContext("webgl",e.attrs)}catch(t){try{e.gl=e.canvas.getContext("experimental-webgl",e.attrs)}catch(t){e.gl=e.canvas.getContext("webgl-experimental",e.attrs)}}}return e.gl};function a(t){if(t.container){if(t.container==document.body){if(!document.body.style.width)t.canvas.width=t.width||t.pixelRatio*window.innerWidth;if(!document.body.style.height)t.canvas.height=t.height||t.pixelRatio*window.innerHeight}else{var e=t.container.getBoundingClientRect();t.canvas.width=t.width||e.right-e.left;t.canvas.height=t.height||e.bottom-e.top}}}function i(t){return typeof t.getContext==="function"&&"width"in t&&"height"in t}function o(t){return typeof t.nodeName==="string"&&typeof t.appendChild==="function"&&typeof t.getBoundingClientRect==="function"}function s(t){return typeof t.drawArrays==="function"||typeof t.drawElements==="function"}},{"pick-by-alias":432}],305:[function(t,e,r){"use strict";function n(t,e,r){if(e){e.bind()}else{t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}var n=t.getParameter(t.MAX_VERTEX_ATTRIBS)|0;if(r){if(r.length>n){throw new Error("gl-vao: Too many vertex attributes")}for(var a=0;a<r.length;++a){var i=r[a];if(i.buffer){var o=i.buffer;var s=i.size||4;var l=i.type||t.FLOAT;var u=!!i.normalized;var c=i.stride||0;var f=i.offset||0;o.bind();t.enableVertexAttribArray(a);t.vertexAttribPointer(a,s,l,u,c,f)}else{if(typeof i==="number"){t.vertexAttrib1f(a,i)}else if(i.length===1){t.vertexAttrib1f(a,i[0])}else if(i.length===2){t.vertexAttrib2f(a,i[0],i[1])}else if(i.length===3){t.vertexAttrib3f(a,i[0],i[1],i[2])}else if(i.length===4){t.vertexAttrib4f(a,i[0],i[1],i[2],i[3])}else{throw new Error("gl-vao: Invalid vertex attribute")}t.disableVertexAttribArray(a)}}for(;a<n;++a){t.disableVertexAttribArray(a)}}else{t.bindBuffer(t.ARRAY_BUFFER,null);for(var a=0;a<n;++a){t.disableVertexAttribArray(a)}}}e.exports=n},{}],306:[function(t,e,r){"use strict";var n=t("./do-bind.js");function a(t){this.gl=t;this._elements=null;this._attributes=null;this._elementsType=t.UNSIGNED_SHORT}a.prototype.bind=function(){n(this.gl,this._elements,this._attributes)};a.prototype.update=function(t,e,r){this._elements=e;this._attributes=t;this._elementsType=r||this.gl.UNSIGNED_SHORT};a.prototype.dispose=function(){};a.prototype.unbind=function(){};a.prototype.draw=function(t,e,r){r=r||0;var n=this.gl;if(this._elements){n.drawElements(t,e,this._elementsType,r)}else{n.drawArrays(t,r,e)}};function i(t){return new a(t)}e.exports=i},{"./do-bind.js":305}],307:[function(t,e,r){"use strict";var n=t("./do-bind.js");function a(t,e,r,n,a,i){this.location=t;this.dimension=e;this.a=r;this.b=n;this.c=a;this.d=i}a.prototype.bind=function(t){switch(this.dimension){case 1:t.vertexAttrib1f(this.location,this.a);break;case 2:t.vertexAttrib2f(this.location,this.a,this.b);break;case 3:t.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:t.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function i(t,e,r){this.gl=t;this._ext=e;this.handle=r;this._attribs=[];this._useElements=false;this._elementsType=t.UNSIGNED_SHORT}i.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var t=0;t<this._attribs.length;++t){this._attribs[t].bind(this.gl)}};i.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)};i.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)};i.prototype.update=function(t,e,r){this.bind();n(this.gl,e,t);this.unbind();this._attribs.length=0;if(t)for(var i=0;i<t.length;++i){var o=t[i];if(typeof o==="number"){this._attribs.push(new a(i,1,o))}else if(Array.isArray(o)){this._attribs.push(new a(i,o.length,o[0],o[1],o[2],o[3]))}}this._useElements=!!e;this._elementsType=r||this.gl.UNSIGNED_SHORT};i.prototype.draw=function(t,e,r){r=r||0;var n=this.gl;if(this._useElements){n.drawElements(t,e,this._elementsType,r)}else{n.drawArrays(t,r,e)}};function o(t,e){return new i(t,e,e.createVertexArrayOES())}e.exports=o},{"./do-bind.js":305}],308:[function(t,e,r){"use strict";var n=t("./lib/vao-native.js");var a=t("./lib/vao-emulated.js");function i(t){this.bindVertexArrayOES=t.bindVertexArray.bind(t);this.createVertexArrayOES=t.createVertexArray.bind(t);this.deleteVertexArrayOES=t.deleteVertexArray.bind(t)}function o(t,e,r,o){var s=t.createVertexArray?new i(t):t.getExtension("OES_vertex_array_object");var l;if(s){l=n(t,s)}else{l=a(t)}l.update(e,r,o);return l}e.exports=o},{"./lib/vao-emulated.js":306,"./lib/vao-native.js":307}],309:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];return t}},{}],310:[function(t,e,r){e.exports=o;var n=t("./fromValues");var a=t("./normalize");var i=t("./dot");function o(t,e){var r=n(t[0],t[1],t[2]);var o=n(e[0],e[1],e[2]);a(r,r);a(o,o);var s=i(r,o);if(s>1){return 0}else{return Math.acos(s)}}},{"./dot":317,"./fromValues":319,"./normalize":328}],311:[function(t,e,r){e.exports=n;function n(t){var e=new Float32Array(3);e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}},{}],312:[function(t,e,r){e.exports=n;function n(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];return t}},{}],313:[function(t,e,r){e.exports=n;function n(){var t=new Float32Array(3);t[0]=0;t[1]=0;t[2]=0;return t}},{}],314:[function(t,e,r){e.exports=n;function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],l=r[2];t[0]=a*l-i*s;t[1]=i*o-n*l;t[2]=n*s-a*o;return t}},{}],315:[function(t,e,r){e.exports=n;function n(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(r*r+n*n+a*a)}},{}],316:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=e[0]/r[0];t[1]=e[1]/r[1];t[2]=e[2]/r[2];return t}},{}],317:[function(t,e,r){e.exports=n;function n(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}},{}],318:[function(t,e,r){e.exports=a;var n=t("./create")();function a(t,e,r,a,i,o){var s,l;if(!e){e=3}if(!r){r=0}if(a){l=Math.min(a*e+r,t.length)}else{l=t.length}for(s=r;s<l;s+=e){n[0]=t[s];n[1]=t[s+1];n[2]=t[s+2];i(n,n,o);t[s]=n[0];t[s+1]=n[1];t[s+2]=n[2]}return t}},{"./create":313}],319:[function(t,e,r){e.exports=n;function n(t,e,r){var n=new Float32Array(3);n[0]=t;n[1]=e;n[2]=r;return n}},{}],320:[function(t,e,r){e.exports={create:t("./create"),clone:t("./clone"),angle:t("./angle"),fromValues:t("./fromValues"),copy:t("./copy"),set:t("./set"),add:t("./add"),subtract:t("./subtract"),multiply:t("./multiply"),divide:t("./divide"),min:t("./min"),max:t("./max"),scale:t("./scale"),scaleAndAdd:t("./scaleAndAdd"),distance:t("./distance"),squaredDistance:t("./squaredDistance"),length:t("./length"),squaredLength:t("./squaredLength"),negate:t("./negate"),inverse:t("./inverse"),normalize:t("./normalize"),dot:t("./dot"),cross:t("./cross"),lerp:t("./lerp"),random:t("./random"),transformMat4:t("./transformMat4"),transformMat3:t("./transformMat3"),transformQuat:t("./transformQuat"),rotateX:t("./rotateX"),rotateY:t("./rotateY"),rotateZ:t("./rotateZ"),forEach:t("./forEach")}},{"./add":309,"./angle":310,"./clone":311,"./copy":312,"./create":313,"./cross":314,"./distance":315,"./divide":316,"./dot":317,"./forEach":318,"./fromValues":319,"./inverse":321,"./length":322,"./lerp":323,"./max":324,"./min":325,"./multiply":326,"./negate":327,"./normalize":328,"./random":329,"./rotateX":330,"./rotateY":331,"./rotateZ":332,"./scale":333,"./scaleAndAdd":334,"./set":335,"./squaredDistance":336,"./squaredLength":337,"./subtract":338,"./transformMat3":339,"./transformMat4":340,"./transformQuat":341}],321:[function(t,e,r){e.exports=n;function n(t,e){t[0]=1/e[0];t[1]=1/e[1];t[2]=1/e[2];return t}},{}],322:[function(t,e,r){e.exports=n;function n(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}},{}],323:[function(t,e,r){e.exports=n;function n(t,e,r,n){var a=e[0],i=e[1],o=e[2];t[0]=a+n*(r[0]-a);t[1]=i+n*(r[1]-i);t[2]=o+n*(r[2]-o);return t}},{}],324:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=Math.max(e[0],r[0]);t[1]=Math.max(e[1],r[1]);t[2]=Math.max(e[2],r[2]);return t}},{}],325:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=Math.min(e[0],r[0]);t[1]=Math.min(e[1],r[1]);t[2]=Math.min(e[2],r[2]);return t}},{}],326:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=e[0]*r[0];t[1]=e[1]*r[1];t[2]=e[2]*r[2];return t}},{}],327:[function(t,e,r){e.exports=n;function n(t,e){t[0]=-e[0];t[1]=-e[1];t[2]=-e[2];return t}},{}],328:[function(t,e,r){e.exports=n;function n(t,e){var r=e[0],n=e[1],a=e[2];var i=r*r+n*n+a*a;if(i>0){i=1/Math.sqrt(i);t[0]=e[0]*i;t[1]=e[1]*i;t[2]=e[2]*i}return t}},{}],329:[function(t,e,r){e.exports=n;function n(t,e){e=e||1;var r=Math.random()*2*Math.PI;var n=Math.random()*2-1;var a=Math.sqrt(1-n*n)*e;t[0]=Math.cos(r)*a;t[1]=Math.sin(r)*a;t[2]=n*e;return t}},{}],330:[function(t,e,r){e.exports=n;function n(t,e,r,n){var a=[],i=[];a[0]=e[0]-r[0];a[1]=e[1]-r[1];a[2]=e[2]-r[2];i[0]=a[0];i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n);i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n);t[0]=i[0]+r[0];t[1]=i[1]+r[1];t[2]=i[2]+r[2];return t}},{}],331:[function(t,e,r){e.exports=n;function n(t,e,r,n){var a=[],i=[];a[0]=e[0]-r[0];a[1]=e[1]-r[1];a[2]=e[2]-r[2];i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n);i[1]=a[1];i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n);t[0]=i[0]+r[0];t[1]=i[1]+r[1];t[2]=i[2]+r[2];return t}},{}],332:[function(t,e,r){e.exports=n;function n(t,e,r,n){var a=[],i=[];a[0]=e[0]-r[0];a[1]=e[1]-r[1];a[2]=e[2]-r[2];i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n);i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n);i[2]=a[2];t[0]=i[0]+r[0];t[1]=i[1]+r[1];t[2]=i[2]+r[2];return t}},{}],333:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;return t}},{}],334:[function(t,e,r){e.exports=n;function n(t,e,r,n){t[0]=e[0]+r[0]*n;t[1]=e[1]+r[1]*n;t[2]=e[2]+r[2]*n;return t}},{}],335:[function(t,e,r){e.exports=n;function n(t,e,r,n){t[0]=e;t[1]=r;t[2]=n;return t}},{}],336:[function(t,e,r){e.exports=n;function n(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return r*r+n*n+a*a}},{}],337:[function(t,e,r){e.exports=n;function n(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}},{}],338:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];return t}},{}],339:[function(t,e,r){e.exports=n;function n(t,e,r){var n=e[0],a=e[1],i=e[2];t[0]=n*r[0]+a*r[3]+i*r[6];t[1]=n*r[1]+a*r[4]+i*r[7];t[2]=n*r[2]+a*r[5]+i*r[8];return t}},{}],340:[function(t,e,r){e.exports=n;function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[3]*n+r[7]*a+r[11]*i+r[15];o=o||1;t[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/o;t[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/o;t[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/o;return t}},{}],341:[function(t,e,r){e.exports=n;function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*i-l*a,f=u*a+l*n-o*i,h=u*i+o*a-s*n,p=-o*n-s*a-l*i;t[0]=c*u+p*-o+f*-l-h*-s;t[1]=f*u+p*-s+h*-o-c*-l;t[2]=h*u+p*-l+c*-s-f*-o;return t}},{}],342:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];t[3]=e[3]+r[3];return t}},{}],343:[function(t,e,r){e.exports=n;function n(t){var e=new Float32Array(4);e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e}},{}],344:[function(t,e,r){e.exports=n;function n(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t}},{}],345:[function(t,e,r){e.exports=n;function n(){var t=new Float32Array(4);t[0]=0;t[1]=0;t[2]=0;t[3]=0;return t}},{}],346:[function(t,e,r){e.exports=n;function n(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(r*r+n*n+a*a+i*i)}},{}],347:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=e[0]/r[0];t[1]=e[1]/r[1];t[2]=e[2]/r[2];t[3]=e[3]/r[3];return t}},{}],348:[function(t,e,r){e.exports=n;function n(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}},{}],349:[function(t,e,r){e.exports=n;function n(t,e,r,n){var a=new Float32Array(4);a[0]=t;a[1]=e;a[2]=r;a[3]=n;return a}},{}],350:[function(t,e,r){e.exports={create:t("./create"),clone:t("./clone"),fromValues:t("./fromValues"),copy:t("./copy"),set:t("./set"),add:t("./add"),subtract:t("./subtract"),multiply:t("./multiply"),divide:t("./divide"),min:t("./min"),max:t("./max"),scale:t("./scale"),scaleAndAdd:t("./scaleAndAdd"),distance:t("./distance"),squaredDistance:t("./squaredDistance"),length:t("./length"),squaredLength:t("./squaredLength"),negate:t("./negate"),inverse:t("./inverse"),normalize:t("./normalize"),dot:t("./dot"),lerp:t("./lerp"),random:t("./random"),transformMat4:t("./transformMat4"),transformQuat:t("./transformQuat")}},{"./add":342,"./clone":343,"./copy":344,"./create":345,"./distance":346,"./divide":347,"./dot":348,"./fromValues":349,"./inverse":351,"./length":352,"./lerp":353,"./max":354,"./min":355,"./multiply":356,"./negate":357,"./normalize":358,"./random":359,"./scale":360,"./scaleAndAdd":361,"./set":362,"./squaredDistance":363,"./squaredLength":364,"./subtract":365,"./transformMat4":366,"./transformQuat":367}],351:[function(t,e,r){e.exports=n;function n(t,e){t[0]=1/e[0];t[1]=1/e[1];t[2]=1/e[2];t[3]=1/e[3];return t}},{}],352:[function(t,e,r){e.exports=n;function n(t){var e=t[0],r=t[1],n=t[2],a=t[3];return Math.sqrt(e*e+r*r+n*n+a*a)}},{}],353:[function(t,e,r){e.exports=n;function n(t,e,r,n){var a=e[0],i=e[1],o=e[2],s=e[3];t[0]=a+n*(r[0]-a);t[1]=i+n*(r[1]-i);t[2]=o+n*(r[2]-o);t[3]=s+n*(r[3]-s);return t}},{}],354:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=Math.max(e[0],r[0]);t[1]=Math.max(e[1],r[1]);t[2]=Math.max(e[2],r[2]);t[3]=Math.max(e[3],r[3]);return t}},{}],355:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=Math.min(e[0],r[0]);t[1]=Math.min(e[1],r[1]);t[2]=Math.min(e[2],r[2]);t[3]=Math.min(e[3],r[3]);return t}},{}],356:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=e[0]*r[0];t[1]=e[1]*r[1];t[2]=e[2]*r[2];t[3]=e[3]*r[3];return t}},{}],357:[function(t,e,r){e.exports=n;function n(t,e){t[0]=-e[0];t[1]=-e[1];t[2]=-e[2];t[3]=-e[3];return t}},{}],358:[function(t,e,r){e.exports=n;function n(t,e){var r=e[0],n=e[1],a=e[2],i=e[3];var o=r*r+n*n+a*a+i*i;if(o>0){o=1/Math.sqrt(o);t[0]=r*o;t[1]=n*o;t[2]=a*o;t[3]=i*o}return t}},{}],359:[function(t,e,r){var n=t("./normalize");var a=t("./scale");e.exports=i;function i(t,e){e=e||1;t[0]=Math.random();t[1]=Math.random();t[2]=Math.random();t[3]=Math.random();n(t,t);a(t,t,e);return t}},{"./normalize":358,"./scale":360}],360:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;t[3]=e[3]*r;return t}},{}],361:[function(t,e,r){e.exports=n;function n(t,e,r,n){t[0]=e[0]+r[0]*n;t[1]=e[1]+r[1]*n;t[2]=e[2]+r[2]*n;t[3]=e[3]+r[3]*n;return t}},{}],362:[function(t,e,r){e.exports=n;function n(t,e,r,n,a){t[0]=e;t[1]=r;t[2]=n;t[3]=a;return t}},{}],363:[function(t,e,r){e.exports=n;function n(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return r*r+n*n+a*a+i*i}},{}],364:[function(t,e,r){e.exports=n;function n(t){var e=t[0],r=t[1],n=t[2],a=t[3];return e*e+r*r+n*n+a*a}},{}],365:[function(t,e,r){e.exports=n;function n(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];t[3]=e[3]-r[3];return t}},{}],366:[function(t,e,r){e.exports=n;function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3];t[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o;t[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o;t[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o;t[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o;return t}},{}],367:[function(t,e,r){e.exports=n;function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*i-l*a,f=u*a+l*n-o*i,h=u*i+o*a-s*n,p=-o*n-s*a-l*i;t[0]=c*u+p*-o+f*-l-h*-s;t[1]=f*u+p*-s+h*-o-c*-l;t[2]=h*u+p*-l+c*-s-f*-o;t[3]=e[3];return t}},{}],368:[function(t,e,r){e.exports=i;var n=new Uint8Array(4);var a=new Float32Array(n.buffer);function i(t,e,r,i){n[0]=i;n[1]=r;n[2]=e;n[3]=t;return a[0]}},{}],369:[function(t,e,r){var n=t("glsl-tokenizer");var a=t("atob-lite");e.exports=i;function i(t){var e=Array.isArray(t)?t:n(t);for(var r=0;r<e.length;r++){var i=e[r];if(i.type!=="preprocessor")continue;var o=i.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(!o)continue;if(!o[2])continue;var s=o[1];var l=o[2];return(s?a(l):l).trim()}}},{"atob-lite":60,"glsl-tokenizer":376}],370:[function(t,e,r){e.exports=k;var n=t("./lib/literals"),a=t("./lib/operators"),i=t("./lib/builtins"),o=t("./lib/literals-300es"),s=t("./lib/builtins-300es");var l=999,u=9999,c=0,f=1,h=2,p=3,d=4,v=5,g=6,m=7,y=8,x=9,b=10,_=11;var w=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function k(t){var e=0,r=0,k=l,M,A,T=[],S=[],E=0,C=0,L=1,I=0,z=0,P=false,O=false,D="",R;t=t||{};var B=i;var F=n;if(t.version==="300 es"){B=s;F=o}return function(t){S=[];if(t!==null)return j(t.replace?t.replace(/\r\n/g,"\n"):t);return V()};function N(t){if(t.length){S.push({type:w[k],data:t,position:z,line:L,column:I})}}function j(t){e=0;D+=t;R=D.length;var n;while(M=D[e],e<R){n=e;switch(k){case c:e=W();break;case f:e=G();break;case h:e=H();break;case p:e=Y();break;case d:e=$();break;case _:e=Z();break;case v:e=J();break;case u:e=K();break;case x:e=q();break;case l:e=U();break}if(n!==e){switch(D[n]){case"\n":I=0;++L;break;default:++I;break}}}r+=e;D=D.slice(e);return S}function V(t){if(T.length){N(T.join(""))}k=b;N("(eof)");return S}function U(){T=T.length?[]:T;if(A==="/"&&M==="*"){z=r+e-1;k=c;A=M;return e+1}if(A==="/"&&M==="/"){z=r+e-1;k=f;A=M;return e+1}if(M==="#"){k=h;z=r+e;return e}if(/\s/.test(M)){k=x;z=r+e;return e}P=/\d/.test(M);O=/[^\w_]/.test(M);z=r+e;k=P?d:O?p:u;return e}function q(){if(/[^\s]/g.test(M)){N(T.join(""));k=l;return e}T.push(M);A=M;return e+1}function H(){if((M==="\r"||M==="\n")&&A!=="\\"){N(T.join(""));k=l;return e}T.push(M);A=M;return e+1}function G(){return H()}function W(){if(M==="/"&&A==="*"){T.push(M);N(T.join(""));k=l;return e+1}T.push(M);A=M;return e+1}function Y(){if(A==="."&&/\d/.test(M)){k=v;return e}if(A==="/"&&M==="*"){k=c;return e}if(A==="/"&&M==="/"){k=f;return e}if(M==="."&&T.length){while(X(T));k=v;return e}if(M===";"||M===")"||M==="("){if(T.length)while(X(T));N(M);k=l;return e+1}var t=T.length===2&&M!=="=";if(/[\w_\d\s]/.test(M)||t){while(X(T));k=l;return e}T.push(M);A=M;return e+1}function X(t){var e=0,r,n;do{r=a.indexOf(t.slice(0,t.length+e).join(""));n=a[r];if(r===-1){if(e--+t.length>0)continue;n=t.slice(0,1).join("")}N(n);z+=n.length;T=T.slice(n.length);return T.length}while(1)}function Z(){if(/[^a-fA-F0-9]/.test(M)){N(T.join(""));k=l;return e}T.push(M);A=M;return e+1}function $(){if(M==="."){T.push(M);k=v;A=M;return e+1}if(/[eE]/.test(M)){T.push(M);k=v;A=M;return e+1}if(M==="x"&&T.length===1&&T[0]==="0"){k=_;T.push(M);A=M;return e+1}if(/[^\d]/.test(M)){N(T.join(""));k=l;return e}T.push(M);A=M;return e+1}function J(){if(M==="f"){T.push(M);A=M;e+=1}if(/[eE]/.test(M)){T.push(M);A=M;return e+1}if(M==="-"&&/[eE]/.test(A)){T.push(M);A=M;return e+1}if(/[^\d]/.test(M)){N(T.join(""));k=l;return e}T.push(M);A=M;return e+1}function K(){if(/[^\d\w_]/.test(M)){var t=T.join("");if(F.indexOf(t)>-1){k=y}else if(B.indexOf(t)>-1){k=m}else{k=g}N(T.join(""));k=l;return e}T.push(M);A=M;return e+1}}},{"./lib/builtins":372,"./lib/builtins-300es":371,"./lib/literals":374,"./lib/literals-300es":373,"./lib/operators":375}],371:[function(t,e,r){var n=t("./builtins");n=n.slice().filter(function(t){return!/^(gl\_|texture)/.test(t)});e.exports=n.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":372}],372:[function(t,e,r){e.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],373:[function(t,e,r){var n=t("./literals");e.exports=n.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":374}],374:[function(t,e,r){e.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],375:[function(t,e,r){e.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],376:[function(t,e,r){var n=t("./index");e.exports=a;function a(t,e){var r=n(e);var a=[];a=a.concat(r(t));a=a.concat(r(null));return a}},{"./index":370}],377:[function(t,e,r){e.exports=function(t){if(typeof t==="string")t=[t];var e=[].slice.call(arguments,1);var r=[];for(var n=0;n<t.length-1;n++){r.push(t[n],e[n]||"")}r.push(t[n]);return r.join("")}},{}],378:[function(t,e,r){(function(r){"use strict";var n=t("is-browser");var a;if(typeof r.matchMedia==="function"){a=!r.matchMedia("(hover: none)").matches}else{a=n}e.exports=a}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"is-browser":385}],379:[function(t,e,r){"use strict";var n=t("is-browser");function a(){var t=false;try{var e=Object.defineProperty({},"passive",{get:function(){t=true}});window.addEventListener("test",null,e);window.removeEventListener("test",null,e)}catch(e){t=false}return t}e.exports=n&&a()},{"is-browser":385}],380:[function(t,e,r){r.read=function(t,e,r,n,a){var i,o;var s=a*8-n-1;var l=(1<<s)-1;var u=l>>1;var c=-7;var f=r?a-1:0;var h=r?-1:1;var p=t[e+f];f+=h;i=p&(1<<-c)-1;p>>=-c;c+=s;for(;c>0;i=i*256+t[e+f],f+=h,c-=8){}o=i&(1<<-c)-1;i>>=-c;c+=n;for(;c>0;o=o*256+t[e+f],f+=h,c-=8){}if(i===0){i=1-u}else if(i===l){return o?NaN:(p?-1:1)*Infinity}else{o=o+Math.pow(2,n);i=i-u}return(p?-1:1)*o*Math.pow(2,i-n)};r.write=function(t,e,r,n,a,i){var o,s,l;var u=i*8-a-1;var c=(1<<u)-1;var f=c>>1;var h=a===23?Math.pow(2,-24)-Math.pow(2,-77):0;var p=n?0:i-1;var d=n?1:-1;var v=e<0||e===0&&1/e<0?1:0;e=Math.abs(e);if(isNaN(e)||e===Infinity){s=isNaN(e)?1:0;o=c}else{o=Math.floor(Math.log(e)/Math.LN2);if(e*(l=Math.pow(2,-o))<1){o--;l*=2}if(o+f>=1){e+=h/l}else{e+=h*Math.pow(2,1-f)}if(e*l>=2){o++;l/=2}if(o+f>=c){s=0;o=c}else if(o+f>=1){s=(e*l-1)*Math.pow(2,a);o=o+f}else{s=e*Math.pow(2,f-1)*Math.pow(2,a);o=0}}for(;a>=8;t[r+p]=s&255,p+=d,s/=256,a-=8){}o=o<<a|s;u+=a;for(;u>0;t[r+p]=o&255,p+=d,o/=256,u-=8){}t[r+p-d]|=v*128}},{}],381:[function(t,e,r){"use strict";e.exports=p;var n=t("robust-orientation");var a=t("simplicial-complex").compareCells;function i(t,e){return t-e}function o(t,e,r){this.vertices=t;this.adjacent=e;this.boundary=r;this.lastVisited=-1}o.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1];this.vertices[1]=t;var e=this.adjacent[0];this.adjacent[0]=this.adjacent[1];this.adjacent[1]=e};function s(t,e,r){this.vertices=t;this.cell=e;this.index=r}function l(t,e){return a(t.vertices,e.vertices)}function u(t){var e=["function orient(){var tuple=this.tuple;return test("];for(var r=0;r<=t;++r){if(r>0){e.push(",")}e.push("tuple[",r,"]")}e.push(")}return orient");var a=new Function("test",e.join(""));var i=n[t+1];if(!i){i=n}return a(i)}var c=[];function f(t,e,r){this.dimension=t;this.vertices=e;this.simplices=r;this.interior=r.filter(function(t){return!t.boundary});this.tuple=new Array(t+1);for(var n=0;n<=t;++n){this.tuple[n]=this.vertices[n]}var a=c[t];if(!a){a=c[t]=u(t)}this.orient=a}var h=f.prototype;h.handleBoundaryDegeneracy=function(t,e){var r=this.dimension;var n=this.vertices.length-1;var a=this.tuple;var i=this.vertices;var o=[t];t.lastVisited=-n;while(o.length>0){t=o.pop();var s=t.vertices;var l=t.adjacent;for(var u=0;u<=r;++u){var c=l[u];if(!c.boundary||c.lastVisited<=-n){continue}var f=c.vertices;for(var h=0;h<=r;++h){var p=f[h];if(p<0){a[h]=e}else{a[h]=i[p]}}var d=this.orient();if(d>0){return c}c.lastVisited=-n;if(d===0){o.push(c)}}}return null};h.walk=function(t,e){var r=this.vertices.length-1;var n=this.dimension;var a=this.vertices;var i=this.tuple;var o=e?this.interior.length*Math.random()|0:this.interior.length-1;var s=this.interior[o];t:while(!s.boundary){var l=s.vertices;var u=s.adjacent;for(var c=0;c<=n;++c){i[c]=a[l[c]]}s.lastVisited=r;for(var c=0;c<=n;++c){var f=u[c];if(f.lastVisited>=r){continue}var h=i[c];i[c]=t;var p=this.orient();i[c]=h;if(p<0){s=f;continue t}else{if(!f.boundary){f.lastVisited=r}else{f.lastVisited=-r}}}return}return s};h.addPeaks=function(t,e){var r=this.vertices.length-1;var n=this.dimension;var a=this.vertices;var i=this.tuple;var u=this.interior;var c=this.simplices;var f=[e];e.lastVisited=r;e.vertices[e.vertices.indexOf(-1)]=r;e.boundary=false;u.push(e);var h=[];while(f.length>0){var e=f.pop();var p=e.vertices;var d=e.adjacent;var v=p.indexOf(r);if(v<0){continue}for(var g=0;g<=n;++g){if(g===v){continue}var m=d[g];if(!m.boundary||m.lastVisited>=r){continue}var y=m.vertices;if(m.lastVisited!==-r){var x=0;for(var b=0;b<=n;++b){if(y[b]<0){x=b;i[b]=t}else{i[b]=a[y[b]]}}var _=this.orient();if(_>0){y[x]=r;m.boundary=false;u.push(m);f.push(m);m.lastVisited=r;continue}else{m.lastVisited=-r}}var w=m.adjacent;var k=p.slice();var M=d.slice();var A=new o(k,M,true);c.push(A);var T=w.indexOf(e);if(T<0){continue}w[T]=A;M[v]=m;k[g]=-1;M[g]=e;d[g]=A;A.flip();for(var b=0;b<=n;++b){var S=k[b];if(S<0||S===r){continue}var E=new Array(n-1);var C=0;for(var L=0;L<=n;++L){var I=k[L];if(I<0||L===b){continue}E[C++]=I}h.push(new s(E,A,b))}}}h.sort(l);for(var g=0;g+1<h.length;g+=2){var z=h[g];var P=h[g+1];var O=z.index;var D=P.index;if(O<0||D<0){continue}z.cell.adjacent[z.index]=P.cell;P.cell.adjacent[P.index]=z.cell}};h.insert=function(t,e){var r=this.vertices;r.push(t);var n=this.walk(t,e);if(!n){return}var a=this.dimension;var i=this.tuple;for(var o=0;o<=a;++o){var s=n.vertices[o];if(s<0){i[o]=t}else{i[o]=r[s]}}var l=this.orient(i);if(l<0){return}else if(l===0){n=this.handleBoundaryDegeneracy(n,t);if(!n){return}}this.addPeaks(t,n)};h.boundary=function(){var t=this.dimension;var e=[];var r=this.simplices;var n=r.length;for(var a=0;a<n;++a){var i=r[a];if(i.boundary){var o=new Array(t);var s=i.vertices;var l=0;var u=0;for(var c=0;c<=t;++c){if(s[c]>=0){o[l++]=s[c]}else{u=c&1}}if(u===(t&1)){var f=o[0];o[0]=o[1];o[1]=f}e.push(o)}}return e};function p(t,e){var r=t.length;if(r===0){throw new Error("Must have at least d+1 points")}var a=t[0].length;if(r<=a){throw new Error("Must input at least d+1 points")}var i=t.slice(0,a+1);var s=n.apply(void 0,i);if(s===0){throw new Error("Input not in general position")}var l=new Array(a+1);for(var u=0;u<=a;++u){l[u]=u}if(s<0){l[0]=1;l[1]=0}var c=new o(l,new Array(a+1),false);var h=c.adjacent;var p=new Array(a+2);for(var u=0;u<=a;++u){var d=l.slice();for(var v=0;v<=a;++v){if(v===u){d[v]=-1}}var g=d[0];d[0]=d[1];d[1]=g;var m=new o(d,new Array(a+1),true);h[u]=m;p[u]=m}p[a+1]=c;for(var u=0;u<=a;++u){var d=h[u].vertices;var y=h[u].adjacent;for(var v=0;v<=a;++v){var x=d[v];if(x<0){y[v]=c;continue}for(var b=0;b<=a;++b){if(h[b].vertices.indexOf(x)<0){y[v]=h[b]}}}}var _=new f(a,i,p);var w=!!e;for(var u=a+1;u<r;++u){_.insert(t[u],w)}return _.boundary()}},{"robust-orientation":471,"simplicial-complex":481}],382:[function(t,e,r){"use strict";var n=t("binary-search-bounds");var a=0;var i=1;var o=2;e.exports=w;function s(t,e,r,n,a){this.mid=t;this.left=e;this.right=r;this.leftPoints=n;this.rightPoints=a;this.count=(e?e.count:0)+(r?r.count:0)+n.length}var l=s.prototype;function u(t,e){t.mid=e.mid;t.left=e.left;t.right=e.right;t.leftPoints=e.leftPoints;t.rightPoints=e.rightPoints;t.count=e.count}function c(t,e){var r=x(e);t.mid=r.mid;t.left=r.left;t.right=r.right;t.leftPoints=r.leftPoints;t.rightPoints=r.rightPoints;t.count=r.count}function f(t,e){var r=t.intervals([]);r.push(e);c(t,r)}function h(t,e){var r=t.intervals([]);var n=r.indexOf(e);if(n<0){return a}r.splice(n,1);c(t,r);return i}l.intervals=function(t){t.push.apply(t,this.leftPoints);if(this.left){this.left.intervals(t)}if(this.right){this.right.intervals(t)}return t};l.insert=function(t){var e=this.count-this.leftPoints.length;this.count+=1;if(t[1]<this.mid){if(this.left){if(4*(this.left.count+1)>3*(e+1)){f(this,t)}else{this.left.insert(t)}}else{this.left=x([t])}}else if(t[0]>this.mid){if(this.right){if(4*(this.right.count+1)>3*(e+1)){f(this,t)}else{this.right.insert(t)}}else{this.right=x([t])}}else{var r=n.ge(this.leftPoints,t,m);var a=n.ge(this.rightPoints,t,y);this.leftPoints.splice(r,0,t);this.rightPoints.splice(a,0,t)}};l.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid){if(!this.left){return a}var r=this.right?this.right.count:0;if(4*r>3*(e-1)){return h(this,t)}var s=this.left.remove(t);if(s===o){this.left=null;this.count-=1;return i}else if(s===i){this.count-=1}return s}else if(t[0]>this.mid){if(!this.right){return a}var l=this.left?this.left.count:0;if(4*l>3*(e-1)){return h(this,t)}var s=this.right.remove(t);if(s===o){this.right=null;this.count-=1;return i}else if(s===i){this.count-=1}return s}else{if(this.count===1){if(this.leftPoints[0]===t){return o}else{return a}}if(this.leftPoints.length===1&&this.leftPoints[0]===t){if(this.left&&this.right){var c=this;var f=this.left;while(f.right){c=f;f=f.right}if(c===this){f.right=this.right}else{var p=this.left;var s=this.right;c.count-=f.count;c.right=f.left;f.left=p;f.right=s}u(this,f);this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else if(this.left){u(this,this.left)}else{u(this,this.right)}return i}for(var p=n.ge(this.leftPoints,t,m);p<this.leftPoints.length;++p){if(this.leftPoints[p][0]!==t[0]){break}if(this.leftPoints[p]===t){this.count-=1;this.leftPoints.splice(p,1);for(var s=n.ge(this.rightPoints,t,y);s<this.rightPoints.length;++s){if(this.rightPoints[s][1]!==t[1]){break}else if(this.rightPoints[s]===t){this.rightPoints.splice(s,1);return i}}}}return a}};function p(t,e,r){for(var n=0;n<t.length&&t[n][0]<=e;++n){var a=r(t[n]);if(a){return a}}}function d(t,e,r){for(var n=t.length-1;n>=0&&t[n][1]>=e;--n){var a=r(t[n]);if(a){return a}}}function v(t,e){for(var r=0;r<t.length;++r){var n=e(t[r]);if(n){return n}}}l.queryPoint=function(t,e){if(t<this.mid){if(this.left){var r=this.left.queryPoint(t,e);if(r){return r}}return p(this.leftPoints,t,e)}else if(t>this.mid){if(this.right){var r=this.right.queryPoint(t,e);if(r){return r}}return d(this.rightPoints,t,e)}else{return v(this.leftPoints,e)}};l.queryInterval=function(t,e,r){if(t<this.mid&&this.left){var n=this.left.queryInterval(t,e,r);if(n){return n}}if(e>this.mid&&this.right){var n=this.right.queryInterval(t,e,r);if(n){return n}}if(e<this.mid){return p(this.leftPoints,e,r)}else if(t>this.mid){return d(this.rightPoints,t,r)}else{return v(this.leftPoints,r)}};function g(t,e){return t-e}function m(t,e){var r=t[0]-e[0];if(r){return r}return t[1]-e[1]}function y(t,e){var r=t[1]-e[1];if(r){return r}return t[0]-e[0]}function x(t){if(t.length===0){return null}var e=[];for(var r=0;r<t.length;++r){e.push(t[r][0],t[r][1])}e.sort(g);var n=e[e.length>>1];var a=[];var i=[];var o=[];for(var r=0;r<t.length;++r){var l=t[r];if(l[1]<n){a.push(l)}else if(n<l[0]){i.push(l)}else{o.push(l)}}var u=o;var c=o.slice();u.sort(m);c.sort(y);return new s(n,x(a),x(i),u,c)}function b(t){this.root=t}var _=b.prototype;_.insert=function(t){if(this.root){this.root.insert(t)}else{this.root=new s(t[0],null,null,[t],[t])}};_.remove=function(t){if(this.root){var e=this.root.remove(t);if(e===o){this.root=null}return e!==a}return false};_.queryPoint=function(t,e){if(this.root){return this.root.queryPoint(t,e)}};_.queryInterval=function(t,e,r){if(t<=e&&this.root){return this.root.queryInterval(t,e,r)}};Object.defineProperty(_,"count",{get:function(){if(this.root){return this.root.count}return 0}});Object.defineProperty(_,"intervals",{get:function(){if(this.root){return this.root.intervals([])}return[]}});function w(t){if(!t||t.length===0){return new b(null)}return new b(x(t))}},{"binary-search-bounds":79}],383:[function(t,e,r){"use strict";function n(t,e){e=e||new Array(t.length);for(var r=0;r<t.length;++r){e[t[r]]=r}return e}e.exports=n},{}],384:[function(t,e,r){"use strict";function n(t){var e=new Array(t);for(var r=0;r<t;++r){e[r]=r}return e}e.exports=n},{}],385:[function(t,e,r){e.exports=true},{}],386:[function(t,e,r){e.exports=function(t){return t!=null&&(n(t)||a(t)||!!t._isBuffer)};function n(t){return!!t.constructor&&typeof t.constructor.isBuffer==="function"&&t.constructor.isBuffer(t)}function a(t){return typeof t.readFloatLE==="function"&&typeof t.slice==="function"&&n(t.slice(0,0))}},{}],387:[function(t,e,r){"use strict";e.exports=typeof navigator!=="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],388:[function(t,e,r){e.exports=n;function n(t){if(!t&&typeof navigator!="undefined")t=navigator.userAgent;if(t&&t.headers&&typeof t.headers["user-agent"]=="string"){t=t.headers["user-agent"]}if(typeof t!="string")return false;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}},{}],389:[function(t,e,r){"use strict";e.exports=function(t){var e=typeof t;return t!==null&&(e==="object"||e==="function")}},{}],390:[function(t,e,r){"use strict";var n=Object.prototype.toString;e.exports=function(t){var e;return n.call(t)==="[object Object]"&&(e=Object.getPrototypeOf(t),e===null||e===Object.getPrototypeOf({}))}},{}],391:[function(t,e,r){"use strict";e.exports=function t(e){if(typeof e!=="string")return false;e=e.trim();if(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&e.length>4)return true;return false}},{}],392:[function(t,e,r){function n(t,e,r){return t*(1-r)+e*r}e.exports=n},{}],393:[function(e,r,n){(function(e){(function(e,a){typeof n==="object"&&typeof r!=="undefined"?r.exports=a():typeof t==="function"&&t.amd?t(a):e.mapboxgl=a()})(this,function(){"use strict";var t,r,n;function a(e,a){if(!t){t=a}else if(!r){r=a}else{var i="var sharedChunk = {}; ("+t+")(sharedChunk); ("+r+")(sharedChunk);";var o={};t(o);n=a(o);n.workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"}))}}a(["exports"],function(t){"use strict";var r="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{};function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function a(t,e){return t(e={exports:{}},e.exports),e.exports}var i=o;function o(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=r,this.p2y=n}o.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},o.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},o.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},o.prototype.solveCurveX=function(t,e){var r,n,a,i,o;for(void 0===e&&(e=1e-6),a=t,o=0;o<8;o++){if(i=this.sampleCurveX(a)-t,Math.abs(i)<e)return a;var s=this.sampleCurveDerivativeX(a);if(Math.abs(s)<1e-6)break;a-=i/s}if((a=t)<(r=0))return r;if(a>(n=1))return n;for(;r<n;){if(i=this.sampleCurveX(a),Math.abs(i-t)<e)return a;t>i?r=a:n=a,a=.5*(n-r)+r}return a},o.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var s=function(t,e,r){this.column=t,this.row=e,this.zoom=r};s.prototype.clone=function(){return new s(this.column,this.row,this.zoom)},s.prototype.zoomTo=function(t){return this.clone()._zoomTo(t)},s.prototype.sub=function(t){return this.clone()._sub(t)},s.prototype._zoomTo=function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},s.prototype._sub=function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this};var l=u;function u(t,e){this.x=t,this.y=e}function c(t,e,r,n){var a=new i(t,e,r,n);return function(t){return a.solve(t)}}u.prototype={clone:function(){return new u(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,a=r*this.x+e*this.y;return this.x=n,this.y=a,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),a=e.x+r*(this.x-e.x)-n*(this.y-e.y),i=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=a,this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},u.convert=function(t){return t instanceof u?t:Array.isArray(t)?new u(t[0],t[1]):t};var f=c(.25,.1,.25,1);function h(t,e,r){return Math.min(r,Math.max(e,t))}function p(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var n=0,a=e;n<a.length;n+=1){var i=a[n];for(var o in i)t[o]=i[o]}return t}var d=1;function v(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})}function g(t,e){return-1!==t.indexOf(e,t.length-e.length)}function m(t,e,r){var n={};for(var a in t)n[a]=e.call(r||this,t[a],a,t);return n}function y(t,e,r){var n={};for(var a in t)e.call(r||this,t[a],a,t)&&(n[a]=t[a]);return n}function x(t){return Array.isArray(t)?t.map(x):"object"==typeof t&&t?m(t,x):t}var b={};function _(t){b[t]||("undefined"!=typeof console&&console.warn(t),b[t]=!0)}function w(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function k(t){for(var e=0,r=0,n=t.length,a=n-1,i=void 0,o=void 0;r<n;a=r++)i=t[r],e+=((o=t[a]).x-i.x)*(i.y+o.y);return e}var M={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(M);var A=function(t){function e(e,r,n){t.call(this,e),this.status=r,this.url=n,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error);function T(t){var e=new self.XMLHttpRequest;for(var r in e.open("GET",t.url,!0),t.headers)e.setRequestHeader(r,t.headers[r]);return e.withCredentials="include"===t.credentials,e}var S=function(t,e){var r=T(t);return r.responseType="arraybuffer",r.onerror=function(){e(new Error(r.statusText))},r.onload=function(){var n=r.response;if(0===n.byteLength&&200===r.status)return e(new Error("http status 200 returned without content."));r.status>=200&&r.status<300&&r.response?e(null,{data:n,cacheControl:r.getResponseHeader("Cache-Control"),expires:r.getResponseHeader("Expires")}):e(new A(r.statusText,r.status,t.url))},r.send(),r};function E(t,e,r){r[t]=r[t]||[],r[t].push(e)}function C(t,e,r){if(r&&r[t]){var n=r[t].indexOf(e);-1!==n&&r[t].splice(n,1)}}var L=function(t,e){void 0===e&&(e={}),p(this,e),this.type=t},I=function(t){function e(e,r){void 0===r&&(r={}),t.call(this,"error",p({error:e},r))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(L),z=function(){};z.prototype.on=function(t,e){return this._listeners=this._listeners||{},E(t,e,this._listeners),this},z.prototype.off=function(t,e){return C(t,e,this._listeners),C(t,e,this._oneTimeListeners),this},z.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},E(t,e,this._oneTimeListeners),this},z.prototype.fire=function(t){"string"==typeof t&&(t=new L(t,arguments[1]||{}));var e=t.type;if(this.listens(e)){t.target=this;for(var r=0,n=this._listeners&&this._listeners[e]?this._listeners[e].slice():[];r<n.length;r+=1){n[r].call(this,t)}for(var a=0,i=this._oneTimeListeners&&this._oneTimeListeners[e]?this._oneTimeListeners[e].slice():[];a<i.length;a+=1){var o=i[a];C(e,o,this._oneTimeListeners),o.call(this,t)}var s=this._eventedParent;s&&(p(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),s.fire(t))}else g(e,"error")?console.error(t&&t.error||t||"Empty error event"):g(e,"warning")&&console.warn(t&&t.warning||t||"Empty warning event");return this},z.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},z.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var P={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},lineMetrics:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{butt:{},round:{},square:{}},default:"butt"},"line-join":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{bevel:{},round:{},miter:{}},default:"miter"},"line-miter-limit":{type:"number",default:2,function:"interpolated","zoom-function":!0,requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated","zoom-function":!0,requires:[{"line-join":"round"}]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{point:{},line:{}},default:"point"},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated","zoom-function":!0,units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,units:"factor of the original icon size",requires:["icon-image"]},"icon-text-fit":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"]},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",function:"interpolated","zoom-function":!0,requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}]},"icon-image":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated","zoom-function":!0,units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"icon-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"]},"icon-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"text-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:"",tokens:!0},"text-font":{type:"array",value:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{left:{},center:{},right:{}},default:"center",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated","zoom-function":!0,requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field","icon-image"]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Heatmap"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},transition:!1,"zoom-function":!0,"property-function":!1,function:"piecewise-constant"},position:{type:"array",default:[1.15,210,30],length:3,value:"number",transition:!0,function:"interpolated","zoom-function":!0,"property-function":!1},color:{type:"color",default:"#ffffff",function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},intensity:{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0},"fill-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},paint_line:{"line-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-gap-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant","zoom-function":!0,minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"line-gradient":{type:"color",function:"interpolated","zoom-function":!1,"property-function":!1,transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}]}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-blur":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["circle-translate"]},"circle-pitch-scale":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map"},"circle-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"circle-stroke-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-stroke-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"heatmap-weight":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!1},"heatmap-intensity":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],function:"interpolated","zoom-function":!1,"property-function":!1,transition:!1},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,transition:!0,units:"degrees"},"raster-brightness-min":{type:"number",function:"interpolated","zoom-function":!0,default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated","zoom-function":!0,default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated","zoom-function":!0,transition:!1,units:"milliseconds"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,function:"interpolated","zoom-function":!0,transition:!1},"hillshade-illumination-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"hillshade-shadow-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",function:"interpolated","zoom-function":!0,transition:!0},"hillshade-accent-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0}},paint_background:{"background-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!1,default:1,minimum:0,maximum:1,transition:!0},"fill-extrusion-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-extrusion-pattern"}]},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-extrusion-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"]},"fill-extrusion-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"fill-extrusion-height":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,units:"meters",transition:!0},"fill-extrusion-base":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"]}}},O=function(t,e,r,n){this.message=(t?t+": ":"")+r,n&&(this.identifier=n),null!=e&&e.__line__&&(this.line=e.__line__)};function D(t){var e=t.key,r=t.value;return r?[new O(e,r,"constants have been deprecated as of v8")]:[]}function R(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var n=0,a=e;n<a.length;n+=1){var i=a[n];for(var o in i)t[o]=i[o]}return t}function B(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function F(t){return Array.isArray(t)?t.map(F):B(t)}var N=function(t){function e(e,r){t.call(this,r),this.message=r,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),j=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var r=0,n=e;r<n.length;r+=1){var a=n[r],i=a[0],o=a[1];this.bindings[i]=o}};j.prototype.concat=function(t){return new j(this,t)},j.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},j.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var V={kind:"null"},U={kind:"number"},q={kind:"string"},H={kind:"boolean"},G={kind:"color"},W={kind:"object"},Y={kind:"value"},X={kind:"collator"};function Z(t,e){return{kind:"array",itemType:t,N:e}}function $(t){if("array"===t.kind){var e=$(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var J=[V,U,q,H,G,W,Z(Y)];function K(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&!K(t.itemType,e.itemType)&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var r=0,n=J;r<n.length;r+=1){if(!K(n[r],e))return null}}return"Expected "+$(t)+" but found "+$(e)+" instead."}var Q=a(function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(t){return(t=Math.round(t))<0?0:t>255?255:t}function a(t){return t<0?0:t>1?1:t}function i(t){return"%"===t[t.length-1]?n(parseFloat(t)/100*255):n(parseInt(t))}function o(t){return"%"===t[t.length-1]?a(parseFloat(t)/100):a(parseFloat(t))}function s(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.parseCSSColor=function(t){var e,a=t.replace(/ /g,"").toLowerCase();if(a in r)return r[a].slice();if("#"===a[0])return 4===a.length?(e=parseInt(a.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===a.length&&(e=parseInt(a.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=a.indexOf("("),u=a.indexOf(")");if(-1!==l&&u+1===a.length){var c=a.substr(0,l),f=a.substr(l+1,u-(l+1)).split(","),h=1;switch(c){case"rgba":if(4!==f.length)return null;h=o(f.pop());case"rgb":return 3!==f.length?null:[i(f[0]),i(f[1]),i(f[2]),h];case"hsla":if(4!==f.length)return null;h=o(f.pop());case"hsl":if(3!==f.length)return null;var p=(parseFloat(f[0])%360+360)%360/360,d=o(f[1]),v=o(f[2]),g=v<=.5?v*(d+1):v+d-v*d,m=2*v-g;return[n(255*s(m,g,p+1/3)),n(255*s(m,g,p)),n(255*s(m,g,p-1/3)),h];default:return null}}return null}}catch(t){}}).parseCSSColor,tt=function(t,e,r,n){void 0===n&&(n=1),this.r=t,this.g=e,this.b=r,this.a=n};tt.parse=function(t){if(t){if(t instanceof tt)return t;if("string"==typeof t){var e=Q(t);if(e)return new tt(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},tt.prototype.toString=function(){var t=this.toArray(),e=t[0],r=t[1],n=t[2],a=t[3];return"rgba("+Math.round(e)+","+Math.round(r)+","+Math.round(n)+","+a+")"},tt.prototype.toArray=function(){var t=this.r,e=this.g,r=this.b,n=this.a;return 0===n?[0,0,0,0]:[255*t/n,255*e/n,255*r/n,n]},tt.black=new tt(0,0,0,1),tt.white=new tt(1,1,1,1),tt.transparent=new tt(0,0,0,0);var et=function(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};et.prototype.compare=function(t,e){return this.collator.compare(t,e)},et.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var rt=function(t,e,r){this.type=X,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e};function nt(t,e,r,n){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value ["+[t,e,r,n].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof n?[t,e,r,n]:[t,e,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function at(t){if(null===t)return V;if("string"==typeof t)return q;if("boolean"==typeof t)return H;if("number"==typeof t)return U;if(t instanceof tt)return G;if(t instanceof et)return X;if(Array.isArray(t)){for(var e,r=t.length,n=0,a=t;n<a.length;n+=1){var i=at(a[n]);if(e){if(e===i)continue;e=Y;break}e=i}return Z(e||Y,r)}return W}rt.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var r=t[1];if("object"!=typeof r||Array.isArray(r))return e.error("Collator options argument must be an object.");var n=e.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,H);if(!n)return null;var a=e.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,H);if(!a)return null;var i=null;return r.locale&&!(i=e.parse(r.locale,1,q))?null:new rt(n,a,i)},rt.prototype.evaluate=function(t){return new et(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},rt.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},rt.prototype.possibleOutputs=function(){return[void 0]},rt.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var it=function(t,e){this.type=t,this.value=e};it.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!function t(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof tt)return!0;if(e instanceof et)return!0;if(Array.isArray(e)){for(var r=0,n=e;r<n.length;r+=1)if(!t(n[r]))return!1;return!0}if("object"==typeof e){for(var a in e)if(!t(e[a]))return!1;return!0}return!1}(t[1]))return e.error("invalid value");var r=t[1],n=at(r),a=e.expectedType;return"array"!==n.kind||0!==n.N||!a||"array"!==a.kind||"number"==typeof a.N&&0!==a.N||(n=a),new it(n,r)},it.prototype.evaluate=function(){return this.value},it.prototype.eachChild=function(){},it.prototype.possibleOutputs=function(){return[this.value]},it.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof tt?["rgba"].concat(this.value.toArray()):this.value};var ot=function(t){this.name="ExpressionEvaluationError",this.message=t};ot.prototype.toJSON=function(){return this.message};var st={string:q,number:U,boolean:H,object:W},lt=function(t,e){this.type=t,this.args=e};lt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");for(var r=t[0],n=st[r],a=[],i=1;i<t.length;i++){var o=e.parse(t[i],i,Y);if(!o)return null;a.push(o)}return new lt(n,a)},lt.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var r=this.args[e].evaluate(t);if(!K(this.type,at(r)))return r;if(e===this.args.length-1)throw new ot("Expected value to be of type "+$(this.type)+", but found "+$(at(r))+" instead.")}return null},lt.prototype.eachChild=function(t){this.args.forEach(t)},lt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},lt.prototype.serialize=function(){return[this.type.kind].concat(this.args.map(function(t){return t.serialize()}))};var ut={string:q,number:U,boolean:H},ct=function(t,e){this.type=t,this.input=e};ct.parse=function(t,e){if(t.length<2||t.length>4)return e.error("Expected 1, 2, or 3 arguments, but found "+(t.length-1)+" instead.");var r,n;if(t.length>2){var a=t[1];if("string"!=typeof a||!(a in ut))return e.error('The item type argument of "array" must be one of string, number, boolean',1);r=ut[a]}else r=Y;if(t.length>3){if("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2]))return e.error('The length argument to "array" must be a positive integer literal',2);n=t[2]}var i=Z(r,n),o=e.parse(t[t.length-1],t.length-1,Y);return o?new ct(i,o):null},ct.prototype.evaluate=function(t){var e=this.input.evaluate(t);if(K(this.type,at(e)))throw new ot("Expected value to be of type "+$(this.type)+", but found "+$(at(e))+" instead.");return e},ct.prototype.eachChild=function(t){t(this.input)},ct.prototype.possibleOutputs=function(){return this.input.possibleOutputs()},ct.prototype.serialize=function(){var t=["array"],e=this.type.itemType;if("string"===e.kind||"number"===e.kind||"boolean"===e.kind){t.push(e.kind);var r=this.type.N;"number"==typeof r&&t.push(r)}return t.push(this.input.serialize()),t};var ft={"to-number":U,"to-color":G},ht=function(t,e){this.type=t,this.args=e};ht.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");for(var r=t[0],n=ft[r],a=[],i=1;i<t.length;i++){var o=e.parse(t[i],i,Y);if(!o)return null;a.push(o)}return new ht(n,a)},ht.prototype.evaluate=function(t){if("color"===this.type.kind){for(var e,r,n=0,a=this.args;n<a.length;n+=1){if(r=null,"string"==typeof(e=a[n].evaluate(t))){var i=t.parseColor(e);if(i)return i}else if(Array.isArray(e)&&!(r=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":nt(e[0],e[1],e[2],e[3])))return new tt(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ot(r||"Could not parse color from value '"+("string"==typeof e?e:JSON.stringify(e))+"'")}for(var o=null,s=0,l=this.args;s<l.length;s+=1){if(null!==(o=l[s].evaluate(t))){var u=Number(o);if(!isNaN(u))return u}}throw new ot("Could not convert "+JSON.stringify(o)+" to number.")},ht.prototype.eachChild=function(t){this.args.forEach(t)},ht.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},ht.prototype.serialize=function(){var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var pt=["Unknown","Point","LineString","Polygon"],dt=function(){this._parseColorCache={}};dt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},dt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?pt[this.feature.type]:this.feature.type:null},dt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},dt.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=tt.parse(t)),e};var vt=function(t,e,r,n){this.name=t,this.type=e,this._evaluate=r,this.args=n};function gt(t){if(t instanceof vt){if("get"===t.name&&1===t.args.length)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}var e=!0;return t.eachChild(function(t){e&&!gt(t)&&(e=!1)}),e}function mt(t,e){if(t instanceof vt&&e.indexOf(t.name)>=0)return!1;var r=!0;return t.eachChild(function(t){r&&!mt(t,e)&&(r=!1)}),r}vt.prototype.evaluate=function(t){return this._evaluate(t,this.args)},vt.prototype.eachChild=function(t){this.args.forEach(t)},vt.prototype.possibleOutputs=function(){return[void 0]},vt.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},vt.parse=function(t,e){var r=t[0],n=vt.definitions[r];if(!n)return e.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var a=Array.isArray(n)?n[0]:n.type,i=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=i.filter(function(e){var r=e[0];return!Array.isArray(r)||r.length===t.length-1}),s=[],l=1;l<t.length;l++){var u=t[l],c=void 0;if(1===o.length){var f=o[0][0];c=Array.isArray(f)?f[l-1]:f.type}var h=e.parse(u,1+s.length,c);if(!h)return null;s.push(h)}for(var p=null,d=0,v=o;d<v.length;d+=1){var g=v[d],m=g[0],y=g[1];if(p=new xt(e.registry,e.path,null,e.scope),Array.isArray(m)&&m.length!==s.length)p.error("Expected "+m.length+" arguments, but found "+s.length+" instead.");else{for(var x=0;x<s.length;x++){var b=Array.isArray(m)?m[x]:m.type,_=s[x];p.concat(x+1).checkSubtype(b,_.type)}if(0===p.errors.length)return new vt(r,a,y,s)}}if(1===o.length)e.errors.push.apply(e.errors,p.errors);else{var w=(o.length?o:i).map(function(t){var e,r=t[0];return e=r,Array.isArray(e)?"("+e.map($).join(", ")+")":"("+$(e.type)+"...)"}).join(" | "),k=s.map(function(t){return $(t.type)}).join(", ");e.error("Expected arguments of type "+w+", but found ("+k+") instead.")}return null},vt.register=function(t,e){for(var r in vt.definitions=e,e)t[r]=vt};var yt=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};yt.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var r=t[1];return e.scope.has(r)?new yt(r,e.scope.get(r)):e.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},yt.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},yt.prototype.eachChild=function(){},yt.prototype.possibleOutputs=function(){return[void 0]},yt.prototype.serialize=function(){return["var",this.name]};var xt=function(t,e,r,n,a){void 0===e&&(e=[]),void 0===n&&(n=new j),void 0===a&&(a=[]),this.registry=t,this.path=e,this.key=e.map(function(t){return"["+t+"]"}).join(""),this.scope=n,this.errors=a,this.expectedType=r};function bt(t,e){for(var r,n,a=0,i=t.length-1,o=0;a<=i;){if(r=t[o=Math.floor((a+i)/2)],n=t[o+1],e===r||e>r&&e<n)return o;if(r<e)a=o+1;else{if(!(r>e))throw new ot("Input is not a number.");i=o-1}}return Math.max(o-1,0)}xt.prototype.parse=function(t,e,r,n,a){return void 0===a&&(a={}),e?this.concat(e,r,n)._parse(t,a):this._parse(t,a)},xt.prototype._parse=function(t,e){if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=t[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var n=this.registry[r];if(n){var a=n.parse(t,this);if(!a)return null;if(this.expectedType){var i=this.expectedType,o=a.type;if("string"!==i.kind&&"number"!==i.kind&&"boolean"!==i.kind&&"object"!==i.kind||"value"!==o.kind)if("array"===i.kind&&"value"===o.kind)e.omitTypeAnnotations||(a=new ct(i,a));else if("color"!==i.kind||"value"!==o.kind&&"string"!==o.kind){if(this.checkSubtype(this.expectedType,a.type))return null}else e.omitTypeAnnotations||(a=new ht(i,[a]));else e.omitTypeAnnotations||(a=new lt(i,[a]))}if(!(a instanceof it)&&function t(e){if(e instanceof yt)return t(e.boundExpression);if(e instanceof vt&&"error"===e.name)return!1;if(e instanceof rt)return!1;var r=e instanceof ht||e instanceof lt||e instanceof ct;var n=!0;e.eachChild(function(e){n=r?n&&t(e):n&&e instanceof it});if(!n)return!1;return gt(e)&&mt(e,["zoom","heatmap-density","line-progress","is-supported-script"])}(a)){var s=new dt;try{a=new it(a.type,a.evaluate(s))}catch(t){return this.error(t.message),null}}return a}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},xt.prototype.concat=function(t,e,r){var n="number"==typeof t?this.path.concat(t):this.path,a=r?this.scope.concat(r):this.scope;return new xt(this.registry,n,e||null,a,this.errors)},xt.prototype.error=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];var n=""+this.key+e.map(function(t){return"["+t+"]"}).join("");this.errors.push(new N(n,t))},xt.prototype.checkSubtype=function(t,e){var r=K(t,e);return r&&this.error(r),r};var _t=function(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var n=0,a=r;n<a.length;n+=1){var i=a[n],o=i[0],s=i[1];this.labels.push(o),this.outputs.push(s)}};function wt(t,e,r){return t*(1-r)+e*r}_t.parse=function(t,e){var r=t[1],n=t.slice(2);if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(r=e.parse(r,1,U)))return null;var a=[],i=null;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType),n.unshift(-1/0);for(var o=0;o<n.length;o+=2){var s=n[o],l=n[o+1],u=o+1,c=o+2;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(a.length&&a[a.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var f=e.parse(l,c,i);if(!f)return null;i=i||f.type,a.push([s,f])}return new _t(i,r,a)},_t.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);var a=e.length;return n>=e[a-1]?r[a-1].evaluate(t):r[bt(e,n)].evaluate(t)},_t.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1){t(r[e])}},_t.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},_t.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var kt=Object.freeze({number:wt,color:function(t,e,r){return new tt(wt(t.r,e.r,r),wt(t.g,e.g,r),wt(t.b,e.b,r),wt(t.a,e.a,r))},array:function(t,e,r){return t.map(function(t,n){return wt(t,e[n],r)})}}),Mt=function(t,e,r,n){this.type=t,this.interpolation=e,this.input=r,this.labels=[],this.outputs=[];for(var a=0,i=n;a<i.length;a+=1){var o=i[a],s=o[0],l=o[1];this.labels.push(s),this.outputs.push(l)}};function At(t,e,r,n){var a=n-r,i=t-r;return 0===a?0:1===e?i/a:(Math.pow(e,i)-1)/(Math.pow(e,a)-1)}Mt.interpolationFactor=function(t,e,r,n){var a=0;if("exponential"===t.name)a=At(e,t.base,r,n);else if("linear"===t.name)a=At(e,1,r,n);else if("cubic-bezier"===t.name){var o=t.controlPoints;a=new i(o[0],o[1],o[2],o[3]).solve(At(e,1,r,n))}return a},Mt.parse=function(t,e){var r=t[1],n=t[2],a=t.slice(3);if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var i=r[1];if("number"!=typeof i)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:i}}else{if("cubic-bezier"!==r[0])return e.error("Unknown interpolation type "+String(r[0]),1,0);var o=r.slice(1);if(4!==o.length||o.some(function(t){return"number"!=typeof t||t<0||t>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:o}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(n=e.parse(n,2,U)))return null;var s=[],l=null;e.expectedType&&"value"!==e.expectedType.kind&&(l=e.expectedType);for(var u=0;u<a.length;u+=2){var c=a[u],f=a[u+1],h=u+3,p=u+4;if("number"!=typeof c)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',h);if(s.length&&s[s.length-1][0]>=c)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',h);var d=e.parse(f,p,l);if(!d)return null;l=l||d.type,s.push([c,d])}return"number"===l.kind||"color"===l.kind||"array"===l.kind&&"number"===l.itemType.kind&&"number"==typeof l.N?new Mt(l,r,n,s):e.error("Type "+$(l)+" is not interpolatable.")},Mt.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);var a=e.length;if(n>=e[a-1])return r[a-1].evaluate(t);var i=bt(e,n),o=e[i],s=e[i+1],l=Mt.interpolationFactor(this.interpolation,n,o,s),u=r[i].evaluate(t),c=r[i+1].evaluate(t);return kt[this.type.kind.toLowerCase()](u,c,l)},Mt.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1){t(r[e])}},Mt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},Mt.prototype.serialize=function(){for(var t=["interpolate","linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints),this.input.serialize()],e=0;e<this.labels.length;e++)t.push(this.labels[e],this.outputs[e].serialize());return t};var Tt=function(t,e){this.type=t,this.args=e};Tt.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var r=null,n=e.expectedType;n&&"value"!==n.kind&&(r=n);for(var a=[],i=0,o=t.slice(1);i<o.length;i+=1){var s=o[i],l=e.parse(s,1+a.length,r,void 0,{omitTypeAnnotations:!0});if(!l)return null;r=r||l.type,a.push(l)}var u=n&&a.some(function(t){return K(n,t.type)});return new Tt(u?Y:r,a)},Tt.prototype.evaluate=function(t){for(var e=null,r=0,n=this.args;r<n.length;r+=1){if(null!==(e=n[r].evaluate(t)))break}return e},Tt.prototype.eachChild=function(t){this.args.forEach(t)},Tt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},Tt.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var St=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};St.prototype.evaluate=function(t){return this.result.evaluate(t)},St.prototype.eachChild=function(t){for(var e=0,r=this.bindings;e<r.length;e+=1){t(r[e][1])}t(this.result)},St.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var r=[],n=1;n<t.length-1;n+=2){var a=t[n];if("string"!=typeof a)return e.error("Expected string, but found "+typeof a+" instead.",n);if(/[^a-zA-Z0-9_]/.test(a))return e.error("Variable names must contain only alphanumeric characters or '_'.",n);var i=e.parse(t[n+1],n+1);if(!i)return null;r.push([a,i])}var o=e.parse(t[t.length-1],t.length-1,void 0,r);return o?new St(r,o):null},St.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},St.prototype.serialize=function(){for(var t=["let"],e=0,r=this.bindings;e<r.length;e+=1){var n=r[e],a=n[0],i=n[1];t.push(a,i.serialize())}return t.push(this.result.serialize()),t};var Et=function(t,e,r){this.type=t,this.index=e,this.input=r};Et.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,U),n=e.parse(t[2],2,Z(e.expectedType||Y));if(!r||!n)return null;var a=n.type;return new Et(a.itemType,r,n)},Et.prototype.evaluate=function(t){var e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new ot("Array index out of bounds: "+e+" < 0.");if(e>=r.length)throw new ot("Array index out of bounds: "+e+" > "+(r.length-1)+".");if(e!==Math.floor(e))throw new ot("Array index must be an integer, but found "+e+" instead.");return r[e]},Et.prototype.eachChild=function(t){t(this.index),t(this.input)},Et.prototype.possibleOutputs=function(){return[void 0]},Et.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ct=function(t,e,r,n,a,i){this.inputType=t,this.type=e,this.input=r,this.cases=n,this.outputs=a,this.otherwise=i};Ct.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var r,n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var a={},i=[],o=2;o<t.length-1;o+=2){var s=t[o],l=t[o+1];Array.isArray(s)||(s=[s]);var u=e.concat(o);if(0===s.length)return u.error("Expected at least one branch label.");for(var c=0,f=s;c<f.length;c+=1){var h=f[c];if("number"!=typeof h&&"string"!=typeof h)return u.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,at(h)))return null}else r=at(h);if(void 0!==a[String(h)])return u.error("Branch labels must be unique.");a[String(h)]=i.length}var p=e.parse(l,o,n);if(!p)return null;n=n||p.type,i.push(p)}var d=e.parse(t[1],1,r);if(!d)return null;var v=e.parse(t[t.length-1],t.length-1,n);return v?new Ct(r,n,d,a,i,v):null},Ct.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Ct.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Ct.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},Ct.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],r=[],n={},a=0,i=Object.keys(this.cases).sort();a<i.length;a+=1){var o=i[a],s=n[t.cases[o]];void 0===s?(n[t.cases[o]]=r.length,r.push([t.cases[o],[o]])):r[s][1].push(o)}for(var l=function(e){return"number"===t.input.type.kind?Number(e):e},u=0,c=r;u<c.length;u+=1){var f=c[u],h=f[0],p=f[1];1===p.length?e.push(l(p[0])):e.push(p.map(l)),e.push(t.outputs[h].serialize())}return e.push(this.otherwise.serialize()),e};var Lt=function(t,e,r){this.type=t,this.branches=e,this.otherwise=r};function It(t){return"string"===t.kind||"number"===t.kind||"boolean"===t.kind||"null"===t.kind}function zt(t,e){return function(){function r(t,e,r){this.type=H,this.lhs=t,this.rhs=e,this.collator=r}return r.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var n=e.parse(t[1],1,Y);if(!n)return null;var a=e.parse(t[2],2,Y);if(!a)return null;if(!It(n.type)&&!It(a.type))return e.error("Expected at least one argument to be a string, number, boolean, or null, but found ("+$(n.type)+", "+$(a.type)+") instead.");if(n.type.kind!==a.type.kind&&"value"!==n.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare "+$(n.type)+" and "+$(a.type)+".");var i=null;if(4===t.length){if("string"!==n.type.kind&&"string"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(i=e.parse(t[3],3,X)))return null}return new r(n,a,i)},r.prototype.evaluate=function(t){var r=this.collator?0===this.collator.evaluate(t).compare(this.lhs.evaluate(t),this.rhs.evaluate(t)):this.lhs.evaluate(t)===this.rhs.evaluate(t);return e?!r:r},r.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},r.prototype.possibleOutputs=function(){return[!0,!1]},r.prototype.serialize=function(){var e=[t];return this.eachChild(function(t){e.push(t.serialize())}),e},r}()}Lt.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var n=[],a=1;a<t.length-1;a+=2){var i=e.parse(t[a],a,H);if(!i)return null;var o=e.parse(t[a+1],a+1,r);if(!o)return null;n.push([i,o]),r=r||o.type}var s=e.parse(t[t.length-1],t.length-1,r);return s?new Lt(r,n,s):null},Lt.prototype.evaluate=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],a=n[0],i=n[1];if(a.evaluate(t))return i.evaluate(t)}return this.otherwise.evaluate(t)},Lt.prototype.eachChild=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],a=n[0],i=n[1];t(a),t(i)}t(this.otherwise)},Lt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.branches.map(function(t){t[0];return t[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},Lt.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Pt=zt("==",!1),Ot=zt("!=",!0),Dt=function(t){this.type=U,this.input=t};Dt.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?e.error("Expected argument of type string or array, but found "+$(r.type)+" instead."):new Dt(r):null},Dt.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ot("Expected value to be of type string or array, but found "+$(at(e))+" instead.")},Dt.prototype.eachChild=function(t){t(this.input)},Dt.prototype.possibleOutputs=function(){return[void 0]},Dt.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Rt={"==":Pt,"!=":Ot,array:ct,at:Et,boolean:lt,case:Lt,coalesce:Tt,collator:rt,interpolate:Mt,length:Dt,let:St,literal:it,match:Ct,number:lt,object:lt,step:_t,string:lt,"to-color":ht,"to-number":ht,var:yt};function Bt(t,e){var r=e[0],n=e[1],a=e[2],i=e[3];r=r.evaluate(t),n=n.evaluate(t),a=a.evaluate(t);var o=i?i.evaluate(t):1,s=nt(r,n,a,o);if(s)throw new ot(s);return new tt(r/255*o,n/255*o,a/255*o,o)}function Ft(t,e){return t in e}function Nt(t,e){var r=e[t];return void 0===r?null:r}function jt(t,e){var r=e[0],n=e[1];return r.evaluate(t)<n.evaluate(t)}function Vt(t,e){var r=e[0],n=e[1];return r.evaluate(t)>n.evaluate(t)}function Ut(t,e){var r=e[0],n=e[1];return r.evaluate(t)<=n.evaluate(t)}function qt(t,e){var r=e[0],n=e[1];return r.evaluate(t)>=n.evaluate(t)}function Ht(t){return{type:t}}function Gt(t){return{result:"success",value:t}}function Wt(t){return{result:"error",value:t}}vt.register(Rt,{error:[{kind:"error"},[q],function(t,e){var r=e[0];throw new ot(r.evaluate(t))}],typeof:[q,[Y],function(t,e){return $(at(e[0].evaluate(t)))}],"to-string":[q,[Y],function(t,e){var r=e[0],n=typeof(r=r.evaluate(t));return null===r?"":"string"===n||"number"===n||"boolean"===n?String(r):r instanceof tt?r.toString():JSON.stringify(r)}],"to-boolean":[H,[Y],function(t,e){var r=e[0];return Boolean(r.evaluate(t))}],"to-rgba":[Z(U,4),[G],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[G,[U,U,U],Bt],rgba:[G,[U,U,U,U],Bt],has:{type:H,overloads:[[[q],function(t,e){return Ft(e[0].evaluate(t),t.properties())}],[[q,W],function(t,e){var r=e[0],n=e[1];return Ft(r.evaluate(t),n.evaluate(t))}]]},get:{type:Y,overloads:[[[q],function(t,e){return Nt(e[0].evaluate(t),t.properties())}],[[q,W],function(t,e){var r=e[0],n=e[1];return Nt(r.evaluate(t),n.evaluate(t))}]]},properties:[W,[],function(t){return t.properties()}],"geometry-type":[q,[],function(t){return t.geometryType()}],id:[Y,[],function(t){return t.id()}],zoom:[U,[],function(t){return t.globals.zoom}],"heatmap-density":[U,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[U,[],function(t){return t.globals.lineProgress||0}],"+":[U,Ht(U),function(t,e){for(var r=0,n=0,a=e;n<a.length;n+=1){r+=a[n].evaluate(t)}return r}],"*":[U,Ht(U),function(t,e){for(var r=1,n=0,a=e;n<a.length;n+=1){r*=a[n].evaluate(t)}return r}],"-":{type:U,overloads:[[[U,U],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)-n.evaluate(t)}],[[U],function(t,e){return-e[0].evaluate(t)}]]},"/":[U,[U,U],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)/n.evaluate(t)}],"%":[U,[U,U],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)%n.evaluate(t)}],ln2:[U,[],function(){return Math.LN2}],pi:[U,[],function(){return Math.PI}],e:[U,[],function(){return Math.E}],"^":[U,[U,U],function(t,e){var r=e[0],n=e[1];return Math.pow(r.evaluate(t),n.evaluate(t))}],sqrt:[U,[U],function(t,e){var r=e[0];return Math.sqrt(r.evaluate(t))}],log10:[U,[U],function(t,e){var r=e[0];return Math.log10(r.evaluate(t))}],ln:[U,[U],function(t,e){var r=e[0];return Math.log(r.evaluate(t))}],log2:[U,[U],function(t,e){var r=e[0];return Math.log2(r.evaluate(t))}],sin:[U,[U],function(t,e){var r=e[0];return Math.sin(r.evaluate(t))}],cos:[U,[U],function(t,e){var r=e[0];return Math.cos(r.evaluate(t))}],tan:[U,[U],function(t,e){var r=e[0];return Math.tan(r.evaluate(t))}],asin:[U,[U],function(t,e){var r=e[0];return Math.asin(r.evaluate(t))}],acos:[U,[U],function(t,e){var r=e[0];return Math.acos(r.evaluate(t))}],atan:[U,[U],function(t,e){var r=e[0];return Math.atan(r.evaluate(t))}],min:[U,Ht(U),function(t,e){return Math.min.apply(Math,e.map(function(e){return e.evaluate(t)}))}],max:[U,Ht(U),function(t,e){return Math.max.apply(Math,e.map(function(e){return e.evaluate(t)}))}],abs:[U,[U],function(t,e){var r=e[0];return Math.abs(r.evaluate(t))}],round:[U,[U],function(t,e){var r=e[0].evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[U,[U],function(t,e){var r=e[0];return Math.floor(r.evaluate(t))}],ceil:[U,[U],function(t,e){var r=e[0];return Math.ceil(r.evaluate(t))}],"filter-==":[H,[q,Y],function(t,e){var r=e[0],n=e[1];return t.properties()[r.value]===n.value}],"filter-id-==":[H,[Y],function(t,e){var r=e[0];return t.id()===r.value}],"filter-type-==":[H,[q],function(t,e){var r=e[0];return t.geometryType()===r.value}],"filter-<":[H,[q,Y],function(t,e){var r=e[0],n=e[1],a=t.properties()[r.value],i=n.value;return typeof a==typeof i&&a<i}],"filter-id-<":[H,[Y],function(t,e){var r=e[0],n=t.id(),a=r.value;return typeof n==typeof a&&n<a}],"filter->":[H,[q,Y],function(t,e){var r=e[0],n=e[1],a=t.properties()[r.value],i=n.value;return typeof a==typeof i&&a>i}],"filter-id->":[H,[Y],function(t,e){var r=e[0],n=t.id(),a=r.value;return typeof n==typeof a&&n>a}],"filter-<=":[H,[q,Y],function(t,e){var r=e[0],n=e[1],a=t.properties()[r.value],i=n.value;return typeof a==typeof i&&a<=i}],"filter-id-<=":[H,[Y],function(t,e){var r=e[0],n=t.id(),a=r.value;return typeof n==typeof a&&n<=a}],"filter->=":[H,[q,Y],function(t,e){var r=e[0],n=e[1],a=t.properties()[r.value],i=n.value;return typeof a==typeof i&&a>=i}],"filter-id->=":[H,[Y],function(t,e){var r=e[0],n=t.id(),a=r.value;return typeof n==typeof a&&n>=a}],"filter-has":[H,[Y],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[H,[],function(t){return null!==t.id()}],"filter-type-in":[H,[Z(q)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[H,[Z(Y)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[H,[q,Z(Y)],function(t,e){var r=e[0];return e[1].value.indexOf(t.properties()[r.value])>=0}],"filter-in-large":[H,[q,Z(Y)],function(t,e){var r=e[0],n=e[1];return function(t,e,r,n){for(;r<=n;){var a=r+n>>1;if(e[a]===t)return!0;e[a]>t?n=a-1:r=a+1}return!1}(t.properties()[r.value],n.value,0,n.value.length-1)}],">":{type:H,overloads:[[[U,U],Vt],[[q,q],Vt],[[q,q,X],function(t,e){var r=e[0],n=e[1];return e[2].evaluate(t).compare(r.evaluate(t),n.evaluate(t))>0}]]},"<":{type:H,overloads:[[[U,U],jt],[[q,q],jt],[[q,q,X],function(t,e){var r=e[0],n=e[1];return e[2].evaluate(t).compare(r.evaluate(t),n.evaluate(t))<0}]]},">=":{type:H,overloads:[[[U,U],qt],[[q,q],qt],[[q,q,X],function(t,e){var r=e[0],n=e[1];return e[2].evaluate(t).compare(r.evaluate(t),n.evaluate(t))>=0}]]},"<=":{type:H,overloads:[[[U,U],Ut],[[q,q],Ut],[[q,q,X],function(t,e){var r=e[0],n=e[1];return e[2].evaluate(t).compare(r.evaluate(t),n.evaluate(t))<=0}]]},all:{type:H,overloads:[[[H,H],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)&&n.evaluate(t)}],[Ht(H),function(t,e){for(var r=0,n=e;r<n.length;r+=1){if(!n[r].evaluate(t))return!1}return!0}]]},any:{type:H,overloads:[[[H,H],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)||n.evaluate(t)}],[Ht(H),function(t,e){for(var r=0,n=e;r<n.length;r+=1){if(n[r].evaluate(t))return!0}return!1}]]},"!":[H,[H],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[H,[q],function(t,e){var r=e[0],n=t.globals&&t.globals.isSupportedScript;return!n||n(r.evaluate(t))}],upcase:[q,[q],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[q,[q],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[q,Ht(q),function(t,e){return e.map(function(e){return e.evaluate(t)}).join("")}],"resolved-locale":[q,[X],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Yt=.95047,Xt=1,Zt=1.08883,$t=4/29,Jt=6/29,Kt=3*Jt*Jt,Qt=Jt*Jt*Jt,te=Math.PI/180,ee=180/Math.PI;function re(t){return t>Qt?Math.pow(t,1/3):t/Kt+$t}function ne(t){return t>Jt?t*t*t:Kt*(t-$t)}function ae(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ie(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function oe(t){var e=ie(t.r),r=ie(t.g),n=ie(t.b),a=re((.4124564*e+.3575761*r+.1804375*n)/Yt),i=re((.2126729*e+.7151522*r+.072175*n)/Xt);return{l:116*i-16,a:500*(a-i),b:200*(i-re((.0193339*e+.119192*r+.9503041*n)/Zt)),alpha:t.a}}function se(t){var e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,n=isNaN(t.b)?e:e-t.b/200;return e=Xt*ne(e),r=Yt*ne(r),n=Zt*ne(n),new tt(ae(3.2404542*r-1.5371385*e-.4985314*n),ae(-.969266*r+1.8760108*e+.041556*n),ae(.0556434*r-.2040259*e+1.0572252*n),t.alpha)}var le={forward:oe,reverse:se,interpolate:function(t,e,r){return{l:wt(t.l,e.l,r),a:wt(t.a,e.a,r),b:wt(t.b,e.b,r),alpha:wt(t.alpha,e.alpha,r)}}},ue={forward:function(t){var e=oe(t),r=e.l,n=e.a,a=e.b,i=Math.atan2(a,n)*ee;return{h:i<0?i+360:i,c:Math.sqrt(n*n+a*a),l:r,alpha:t.a}},reverse:function(t){var e=t.h*te,r=t.c;return se({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:function(t,e,r){var n=e-t;return t+r*(n>180||n<-180?n-360*Math.round(n/360):n)}(t.h,e.h,r),c:wt(t.c,e.c,r),l:wt(t.l,e.l,r),alpha:wt(t.alpha,e.alpha,r)}}},ce=Object.freeze({lab:le,hcl:ue});function fe(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function he(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function pe(t){return t}function de(t,e,r){return void 0!==t?t:void 0!==e?e:void 0!==r?r:void 0}function ve(t,e,r,n,a){return de(typeof r===a?n[r]:void 0,t.default,e.default)}function ge(t,e,r){if("number"!==fe(r))return de(t.default,e.default);var n=t.stops.length;if(1===n)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];var a=xe(t.stops,r);return t.stops[a][1]}function me(t,e,r){var n=void 0!==t.base?t.base:1;if("number"!==fe(r))return de(t.default,e.default);var a=t.stops.length;if(1===a)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[a-1][0])return t.stops[a-1][1];var i=xe(t.stops,r),o=function(t,e,r,n){var a=n-r,i=t-r;return 0===a?0:1===e?i/a:(Math.pow(e,i)-1)/(Math.pow(e,a)-1)}(r,n,t.stops[i][0],t.stops[i+1][0]),s=t.stops[i][1],l=t.stops[i+1][1],u=kt[e.type]||pe;if(t.colorSpace&&"rgb"!==t.colorSpace){var c=ce[t.colorSpace];u=function(t,e){return c.reverse(c.interpolate(c.forward(t),c.forward(e),o))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=s.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==n)return u(r,n,o)}}:u(s,l,o)}function ye(t,e,r){return"color"===e.type?r=tt.parse(r):fe(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),de(r,t.default,e.default)}function xe(t,e){for(var r,n,a=0,i=t.length-1,o=0;a<=i;){if(r=t[o=Math.floor((a+i)/2)][0],n=t[o+1][0],e===r||e>r&&e<n)return o;r<e?a=o+1:r>e&&(i=o-1)}return Math.max(o-1,0)}var be=function(t,e){var r;this.expression=t,this._warningHistory={},this._defaultValue="color"===(r=e).type&&he(r.default)?new tt(0,0,0,0):"color"===r.type?tt.parse(r.default)||null:void 0===r.default?null:r.default,"enum"===e.type&&(this._enumValues=e.values)};function _e(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Rt}function we(t,e){var r=new xt(Rt,[],function(t){var e={color:G,string:q,number:U,enum:q,boolean:H};if("array"===t.type)return Z(e[t.value]||Y,t.length);return e[t.type]||null}(e)),n=r.parse(t);return n?Gt(new be(n,e)):Wt(r.errors)}be.prototype.evaluateWithoutErrorHandling=function(t,e){return this._evaluator||(this._evaluator=new dt),this._evaluator.globals=t,this._evaluator.feature=e,this.expression.evaluate(this._evaluator)},be.prototype.evaluate=function(t,e){this._evaluator||(this._evaluator=new dt),this._evaluator.globals=t,this._evaluator.feature=e;try{var r=this.expression.evaluate(this._evaluator);if(null==r)return this._defaultValue;if(this._enumValues&&!(r in this._enumValues))throw new ot("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(r)+" instead.");return r}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var ke=function(t,e){this.kind=t,this._styleExpression=e};ke.prototype.evaluateWithoutErrorHandling=function(t,e){return this._styleExpression.evaluateWithoutErrorHandling(t,e)},ke.prototype.evaluate=function(t,e){return this._styleExpression.evaluate(t,e)};var Me=function(t,e,r){this.kind=t,this.zoomStops=r.labels,this._styleExpression=e,r instanceof Mt&&(this._interpolationType=r.interpolation)};function Ae(t,e){if("error"===(t=we(t,e)).result)return t;var r=t.value.expression,n=gt(r);if(!n&&!e["property-function"])return Wt([new N("","property expressions not supported")]);var a=mt(r,["zoom"]);if(!a&&!1===e["zoom-function"])return Wt([new N("","zoom expressions not supported")]);var i=function t(e){var r=null;if(e instanceof St)r=t(e.result);else if(e instanceof Tt)for(var n=0,a=e.args;n<a.length;n+=1){var i=a[n];if(r=t(i))break}else(e instanceof _t||e instanceof Mt)&&e.input instanceof vt&&"zoom"===e.input.name&&(r=e);if(r instanceof N)return r;e.eachChild(function(e){var n=t(e);n instanceof N?r=n:!r&&n?r=new N("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&n&&r!==n&&(r=new N("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))});return r}(r);return i||a?i instanceof N?Wt([i]):i instanceof Mt&&"piecewise-constant"===e.function?Wt([new N("",'"interpolate" expressions cannot be used with this property')]):Gt(i?new Me(n?"camera":"composite",t.value,i):new ke(n?"constant":"source",t.value)):Wt([new N("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Me.prototype.evaluateWithoutErrorHandling=function(t,e){return this._styleExpression.evaluateWithoutErrorHandling(t,e)},Me.prototype.evaluate=function(t,e){return this._styleExpression.evaluate(t,e)},Me.prototype.interpolationFactor=function(t,e,r){return this._interpolationType?Mt.interpolationFactor(this._interpolationType,t,e,r):0};var Te=function(t,e){this._parameters=t,this._specification=e,R(this,function t(e,r){var n,a,i,o="color"===r.type,s=e.stops&&"object"==typeof e.stops[0][0],l=s||void 0!==e.property,u=s||!l,c=e.type||("interpolated"===r.function?"exponential":"interval");if(o&&((e=R({},e)).stops&&(e.stops=e.stops.map(function(t){return[t[0],tt.parse(t[1])]})),e.default?e.default=tt.parse(e.default):e.default=tt.parse(r.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!ce[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===c)n=me;else if("interval"===c)n=ge;else if("categorical"===c){n=ve,a=Object.create(null);for(var f=0,h=e.stops;f<h.length;f+=1){var p=h[f];a[p[0]]=p[1]}i=typeof e.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');n=ye}if(s){for(var d={},v=[],g=0;g<e.stops.length;g++){var m=e.stops[g],y=m[0].zoom;void 0===d[y]&&(d[y]={zoom:y,type:e.type,property:e.property,default:e.default,stops:[]},v.push(y)),d[y].stops.push([m[0].value,m[1]])}for(var x=[],b=0,_=v;b<_.length;b+=1){var w=_[b];x.push([d[w].zoom,t(d[w],r)])}return{kind:"composite",interpolationFactor:Mt.interpolationFactor.bind(void 0,{name:"linear"}),zoomStops:x.map(function(t){return t[0]}),evaluate:function(t,n){var a=t.zoom;return me({stops:x,base:e.base},r,a).evaluate(a,n)}}}return u?{kind:"camera",interpolationFactor:"exponential"===c?Mt.interpolationFactor.bind(void 0,{name:"exponential",base:void 0!==e.base?e.base:1}):function(){return 0},zoomStops:e.stops.map(function(t){return t[0]}),evaluate:function(t){var o=t.zoom;return n(e,r,o,a,i)}}:{kind:"source",evaluate:function(t,o){var s=o&&o.properties?o.properties[e.property]:void 0;return void 0===s?de(e.default,r.default):n(e,r,s,a,i)}}}(this._parameters,this._specification))};function Se(t,e){if(he(t))return new Te(t,e);if(_e(t)){var r=Ae(t,e);if("error"===r.result)throw new Error(r.value.map(function(t){return t.key+": "+t.message}).join(", "));return r.value}var n=t;return"string"==typeof t&&"color"===e.type&&(n=tt.parse(t)),{kind:"constant",evaluate:function(){return n}}}function Ee(t){var e=t.key,r=t.value,n=t.valueSpec||{},a=t.objectElementValidators||{},i=t.style,o=t.styleSpec,s=[],l=fe(r);if("object"!==l)return[new O(e,r,"object expected, "+l+" found")];for(var u in r){var c=u.split(".")[0],f=n[c]||n["*"],h=void 0;if(a[c])h=a[c];else if(n[c])h=Ke;else if(a["*"])h=a["*"];else{if(!n["*"]){s.push(new O(e,r[u],'unknown property "'+u+'"'));continue}h=Ke}s=s.concat(h({key:(e?e+".":e)+u,value:r[u],valueSpec:f,style:i,styleSpec:o,object:r,objectKey:u},r))}for(var p in n)a[p]||n[p].required&&void 0===n[p].default&&void 0===r[p]&&s.push(new O(e,r,'missing required property "'+p+'"'));return s}function Ce(t){var e=t.value,r=t.valueSpec,n=t.style,a=t.styleSpec,i=t.key,o=t.arrayElementValidator||Ke;if("array"!==fe(e))return[new O(i,e,"array expected, "+fe(e)+" found")];if(r.length&&e.length!==r.length)return[new O(i,e,"array length "+r.length+" expected, length "+e.length+" found")];if(r["min-length"]&&e.length<r["min-length"])return[new O(i,e,"array length at least "+r["min-length"]+" expected, length "+e.length+" found")];var s={type:r.value};a.$version<7&&(s.function=r.function),"object"===fe(r.value)&&(s=r.value);for(var l=[],u=0;u<e.length;u++)l=l.concat(o({array:e,arrayIndex:u,value:e[u],valueSpec:s,style:n,styleSpec:a,key:i+"["+u+"]"}));return l}function Le(t){var e=t.key,r=t.value,n=t.valueSpec,a=fe(r);return"number"!==a?[new O(e,r,"number expected, "+a+" found")]:"minimum"in n&&r<n.minimum?[new O(e,r,r+" is less than the minimum value "+n.minimum)]:"maximum"in n&&r>n.maximum?[new O(e,r,r+" is greater than the maximum value "+n.maximum)]:[]}function Ie(t){var e,r,n,a=t.valueSpec,i=B(t.value.type),o={},s="categorical"!==i&&void 0===t.value.property,l=!s,u="array"===fe(t.value.stops)&&"array"===fe(t.value.stops[0])&&"object"===fe(t.value.stops[0][0]),c=Ee({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===i)return[new O(t.key,t.value,'identity function may not have a "stops" property')];var e=[],r=t.value;e=e.concat(Ce({key:t.key,value:r,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:f})),"array"===fe(r)&&0===r.length&&e.push(new O(t.key,r,"array must have at least one stop"));return e},default:function(t){return Ke({key:t.key,value:t.value,valueSpec:a,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===i&&s&&c.push(new O(t.key,t.value,'missing required property "property"')),"identity"===i||t.value.stops||c.push(new O(t.key,t.value,'missing required property "stops"')),"exponential"===i&&"piecewise-constant"===t.valueSpec.function&&c.push(new O(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!t.valueSpec["property-function"]?c.push(new O(t.key,t.value,"property functions not supported")):s&&!t.valueSpec["zoom-function"]&&"heatmap-color"!==t.objectKey&&"line-gradient"!==t.objectKey&&c.push(new O(t.key,t.value,"zoom functions not supported"))),"categorical"!==i&&!u||void 0!==t.value.property||c.push(new O(t.key,t.value,'"property" property is required')),c;function f(t){var e=[],i=t.value,s=t.key;if("array"!==fe(i))return[new O(s,i,"array expected, "+fe(i)+" found")];if(2!==i.length)return[new O(s,i,"array length 2 expected, length "+i.length+" found")];if(u){if("object"!==fe(i[0]))return[new O(s,i,"object expected, "+fe(i[0])+" found")];if(void 0===i[0].zoom)return[new O(s,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new O(s,i,"object stop key must have value")];if(n&&n>B(i[0].zoom))return[new O(s,i[0].zoom,"stop zoom values must appear in ascending order")];B(i[0].zoom)!==n&&(n=B(i[0].zoom),r=void 0,o={}),e=e.concat(Ee({key:s+"[0]",value:i[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Le,value:h}}))}else e=e.concat(h({key:s+"[0]",value:i[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},i));return e.concat(Ke({key:s+"[1]",value:i[1],valueSpec:a,style:t.style,styleSpec:t.styleSpec}))}function h(t,n){var s=fe(t.value),l=B(t.value),u=null!==t.value?t.value:n;if(e){if(s!==e)return[new O(t.key,u,s+" stop domain type must match previous stop domain type "+e)]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new O(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==i){var c="number expected, "+s+" found";return a["property-function"]&&void 0===i&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new O(t.key,u,c)]}return"categorical"!==i||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==i&&"number"===s&&void 0!==r&&l<r?[new O(t.key,u,"stop domain values must appear in ascending order")]:(r=l,"categorical"===i&&l in o?[new O(t.key,u,"stop domain values must be unique")]:(o[l]=!0,[])):[new O(t.key,u,"integer expected, found "+l)]}}function ze(t){var e=("property"===t.expressionContext?Ae:we)(F(t.value),t.valueSpec);return"error"===e.result?e.value.map(function(e){return new O(""+t.key+e.key,t.value,e.message)}):"property"===t.expressionContext&&"text-font"===t.propertyKey&&-1!==e.value._styleExpression.expression.possibleOutputs().indexOf(void 0)?[new O(t.key,t.value,'Invalid data expression for "text-font". Output values must be contained as literals within the expression.')]:[]}function Pe(t){var e=t.key,r=t.value,n=t.valueSpec,a=[];return Array.isArray(n.values)?-1===n.values.indexOf(B(r))&&a.push(new O(e,r,"expected one of ["+n.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(n.values).indexOf(B(r))&&a.push(new O(e,r,"expected one of ["+Object.keys(n.values).join(", ")+"], "+JSON.stringify(r)+" found")),a}function Oe(t){if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3===t.length&&(Array.isArray(t[1])||Array.isArray(t[2]));case"any":case"all":for(var e=0,r=t.slice(1);e<r.length;e+=1){var n=r[e];if(!Oe(n)&&"boolean"!=typeof n)return!1}return!0;default:return!0}}Te.deserialize=function(t){return new Te(t._parameters,t._specification)},Te.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var De={type:"boolean",default:!1,function:!0,"property-function":!0,"zoom-function":!0};function Re(t){if(!t)return function(){return!0};Oe(t)||(t=Fe(t));var e=we(t,De);if("error"===e.result)throw new Error(e.value.map(function(t){return t.key+": "+t.message}).join(", "));return function(t,r){return e.value.evaluate(t,r)}}function Be(t,e){return t<e?-1:t>e?1:0}function Fe(t){if(!t)return!0;var e,r=t[0];return t.length<=1?"any"!==r:"=="===r?Ne(t[1],t[2],"=="):"!="===r?Ue(Ne(t[1],t[2],"==")):"<"===r||">"===r||"<="===r||">="===r?Ne(t[1],t[2],r):"any"===r?(e=t.slice(1),["any"].concat(e.map(Fe))):"all"===r?["all"].concat(t.slice(1).map(Fe)):"none"===r?["all"].concat(t.slice(1).map(Fe).map(Ue)):"in"===r?je(t[1],t.slice(2)):"!in"===r?Ue(je(t[1],t.slice(2))):"has"===r?Ve(t[1]):"!has"!==r||Ue(Ve(t[1]))}function Ne(t,e,r){switch(t){case"$type":return["filter-type-"+r,e];case"$id":return["filter-id-"+r,e];default:return["filter-"+r,t,e]}}function je(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(Be)]]:["filter-in-small",t,["literal",e]]}}function Ve(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Ue(t){return["!",t]}function qe(t){return Oe(F(t.value))?ze(R({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var r=e.value;var n=e.key;if("array"!==fe(r))return[new O(n,r,"array expected, "+fe(r)+" found")];var a=e.styleSpec;var i;var o=[];if(r.length<1)return[new O(n,r,"filter array must have at least 1 element")];o=o.concat(Pe({key:n+"[0]",value:r[0],valueSpec:a.filter_operator,style:e.style,styleSpec:e.styleSpec}));switch(B(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===B(r[1])&&o.push(new O(n,r,'"$type" cannot be use with operator "'+r[0]+'"'));case"==":case"!=":3!==r.length&&o.push(new O(n,r,'filter array for operator "'+r[0]+'" must have 3 elements'));case"in":case"!in":r.length>=2&&"string"!==(i=fe(r[1]))&&o.push(new O(n+"[1]",r[1],"string expected, "+i+" found"));for(var s=2;s<r.length;s++)i=fe(r[s]),"$type"===B(r[1])?o=o.concat(Pe({key:n+"["+s+"]",value:r[s],valueSpec:a.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&o.push(new O(n+"["+s+"]",r[s],"string, number, or boolean expected, "+i+" found"));break;case"any":case"all":case"none":for(var l=1;l<r.length;l++)o=o.concat(t({key:n+"["+l+"]",value:r[l],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=fe(r[1]),2!==r.length?o.push(new O(n,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"string"!==i&&o.push(new O(n+"[1]",r[1],"string expected, "+i+" found"))}return o}(t)}function He(t,e){var r=t.key,n=t.style,a=t.styleSpec,i=t.value,o=t.objectKey,s=a[e+"_"+t.layerType];if(!s)return[];var l=o.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return Ke({key:r,value:i,valueSpec:a.transition,style:n,styleSpec:a});var u,c=t.valueSpec||s[o];if(!c)return[new O(r,i,'unknown property "'+o+'"')];if("string"===fe(i)&&c["property-function"]&&!c.tokens&&(u=/^{([^}]+)}$/.exec(i)))return[new O(r,i,'"'+o+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var f=[];return"symbol"===t.layerType&&("text-field"===o&&n&&!n.glyphs&&f.push(new O(r,i,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&he(F(i))&&"identity"===B(i.type)&&f.push(new O(r,i,'"text-font" does not support identity functions'))),f.concat(Ke({key:t.key,value:i,valueSpec:c,style:n,styleSpec:a,expressionContext:"property",propertyKey:o}))}function Ge(t){return He(t,"paint")}function We(t){return He(t,"layout")}function Ye(t){var e=[],r=t.value,n=t.key,a=t.style,i=t.styleSpec;r.type||r.ref||e.push(new O(n,r,'either "type" or "ref" is required'));var o,s=B(r.type),l=B(r.ref);if(r.id)for(var u=B(r.id),c=0;c<t.arrayIndex;c++){var f=a.layers[c];B(f.id)===u&&e.push(new O(n,r.id,'duplicate layer id "'+r.id+'", previously used at line '+f.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(t){t in r&&e.push(new O(n,r[t],'"'+t+'" is prohibited for ref layers'))}),a.layers.forEach(function(t){B(t.id)===l&&(o=t)}),o?o.ref?e.push(new O(n,r.ref,"ref cannot reference another ref layer")):s=B(o.type):e.push(new O(n,r.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(r.source){var h=a.sources&&a.sources[r.source],p=h&&B(h.type);h?"vector"===p&&"raster"===s?e.push(new O(n,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===p&&"raster"!==s?e.push(new O(n,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==p||r["source-layer"]?"raster-dem"===p&&"hillshade"!==s?e.push(new O(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===p&&h.lineMetrics||e.push(new O(n,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new O(n,r,'layer "'+r.id+'" must specify a "source-layer"')):e.push(new O(n,r.source,'source "'+r.source+'" not found'))}else e.push(new O(n,r,'missing required property "source"'));return e=e.concat(Ee({key:n,value:r,valueSpec:i.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ke({key:n+".type",value:r.type,valueSpec:i.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"})},filter:qe,layout:function(t){return Ee({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return We(R({layerType:s},t))}}})},paint:function(t){return Ee({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return Ge(R({layerType:s},t))}}})}}}))}function Xe(t){var e=t.value,r=t.key,n=t.styleSpec,a=t.style;if(!e.type)return[new O(r,e,'"type" is required')];var i=B(e.type),o=[];switch(i){case"vector":case"raster":case"raster-dem":if(o=o.concat(Ee({key:r,value:e,valueSpec:n["source_"+i.replace("-","_")],style:t.style,styleSpec:n})),"url"in e)for(var s in e)["type","url","tileSize"].indexOf(s)<0&&o.push(new O(r+"."+s,e[s],'a source with a "url" property may not include a "'+s+'" property'));return o;case"geojson":return Ee({key:r,value:e,valueSpec:n.source_geojson,style:a,styleSpec:n});case"video":return Ee({key:r,value:e,valueSpec:n.source_video,style:a,styleSpec:n});case"image":return Ee({key:r,value:e,valueSpec:n.source_image,style:a,styleSpec:n});case"canvas":return o.push(new O(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")),o;default:return Pe({key:r+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:a,styleSpec:n})}}function Ze(t){var e=t.value,r=t.styleSpec,n=r.light,a=t.style,i=[],o=fe(e);if(void 0===e)return i;if("object"!==o)return i=i.concat([new O("light",e,"object expected, "+o+" found")]);for(var s in e){var l=s.match(/^(.*)-transition$/);i=l&&n[l[1]]&&n[l[1]].transition?i.concat(Ke({key:s,value:e[s],valueSpec:r.transition,style:a,styleSpec:r})):n[s]?i.concat(Ke({key:s,value:e[s],valueSpec:n[s],style:a,styleSpec:r})):i.concat([new O(s,e[s],'unknown property "'+s+'"')])}return i}function $e(t){var e=t.value,r=t.key,n=fe(e);return"string"!==n?[new O(r,e,"string expected, "+n+" found")]:[]}var Je={"*":function(){return[]},array:Ce,boolean:function(t){var e=t.value,r=t.key,n=fe(e);return"boolean"!==n?[new O(r,e,"boolean expected, "+n+" found")]:[]},number:Le,color:function(t){var e=t.key,r=t.value,n=fe(r);return"string"!==n?[new O(e,r,"color expected, "+n+" found")]:null===Q(r)?[new O(e,r,'color expected, "'+r+'" found')]:[]},constants:D,enum:Pe,filter:qe,function:Ie,layer:Ye,object:Ee,source:Xe,light:Ze,string:$e};function Ke(t){var e=t.value,r=t.valueSpec,n=t.styleSpec;return r.function&&he(B(e))?Ie(t):r.function&&_e(F(e))?ze(t):r.type&&Je[r.type]?Je[r.type](t):Ee(R({},t,{valueSpec:r.type?n[r.type]:r}))}function Qe(t){var e=t.value,r=t.key,n=$e(t);return n.length?n:(-1===e.indexOf("{fontstack}")&&n.push(new O(r,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&n.push(new O(r,e,'"glyphs" url must include a "{range}" token')),n)}function tr(t,e){e=e||P;var r=[];return r=r.concat(Ke({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Qe,"*":function(){return[]}}})),t.constants&&(r=r.concat(D({key:"constants",value:t.constants,style:t,styleSpec:e}))),er(r)}function er(t){return[].concat(t).sort(function(t,e){return t.line-e.line})}function rr(t){return function(){return er(t.apply(this,arguments))}}tr.source=rr(Xe),tr.light=rr(Ze),tr.layer=rr(Ye),tr.filter=rr(qe),tr.paintProperty=rr(Ge),tr.layoutProperty=rr(We);var nr=tr,ar=tr.light,ir=tr.paintProperty,or=tr.layoutProperty;function sr(t,e){var r=!1;if(e&&e.length)for(var n=0,a=e;n<a.length;n+=1){var i=a[n];t.fire(new I(new Error(i.message))),r=!0}return r}var lr=cr,ur=3;function cr(t,e,r){var n=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var a=new Int32Array(this.arrayBuffer);t=a[0],e=a[1],r=a[2],this.d=e+2*r;for(var i=0;i<this.d*this.d;i++){var o=a[ur+i],s=a[ur+i+1];n.push(o===s?null:a.subarray(o,s))}var l=a[ur+n.length],u=a[ur+n.length+1];this.keys=a.subarray(l,u),this.bboxes=a.subarray(u),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var c=0;c<this.d*this.d;c++)n.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var f=r/e*t;this.min=-f,this.max=t+f}cr.prototype.insert=function(t,e,r,n,a){this._forEachCell(e,r,n,a,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(a)},cr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},cr.prototype._insertCell=function(t,e,r,n,a,i){this.cells[a].push(i)},cr.prototype.query=function(t,e,r,n){var a=this.min,i=this.max;if(t<=a&&e<=a&&i<=r&&i<=n)return Array.prototype.slice.call(this.keys);var o=[];return this._forEachCell(t,e,r,n,this._queryCell,o,{}),o},cr.prototype._queryCell=function(t,e,r,n,a,i,o){var s=this.cells[a];if(null!==s)for(var l=this.keys,u=this.bboxes,c=0;c<s.length;c++){var f=s[c];if(void 0===o[f]){var h=4*f;t<=u[h+2]&&e<=u[h+3]&&r>=u[h+0]&&n>=u[h+1]?(o[f]=!0,i.push(l[f])):o[f]=!1}}},cr.prototype._forEachCell=function(t,e,r,n,a,i,o){for(var s=this._convertToCellCoord(t),l=this._convertToCellCoord(e),u=this._convertToCellCoord(r),c=this._convertToCellCoord(n),f=s;f<=u;f++)for(var h=l;h<=c;h++){var p=this.d*h+f;if(a.call(this,t,e,r,n,p,i,o))return}},cr.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},cr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=ur+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var a=new Int32Array(e+r+this.keys.length+this.bboxes.length);a[0]=this.extent,a[1]=this.n,a[2]=this.padding;for(var i=e,o=0;o<t.length;o++){var s=t[o];a[ur+o]=i,a.set(s,i),i+=s.length}return a[ur+t.length]=i,a.set(this.keys,i),i+=this.keys.length,a[ur+t.length+1]=i,a.set(this.bboxes,i),i+=this.bboxes.length,a.buffer};var fr=self.ImageData,hr={};function pr(t,e,r){void 0===r&&(r={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),hr[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}for(var dr in pr("Object",Object),lr.serialize=function(t,e){var r=t.toArrayBuffer();return e&&e.push(r),r},lr.deserialize=function(t){return new lr(t)},pr("Grid",lr),pr("Color",tt),pr("Error",Error),pr("StylePropertyFunction",Te),pr("StyleExpression",be,{omit:["_evaluator"]}),pr("ZoomDependentExpression",Me),pr("ZoomConstantExpression",ke),pr("CompoundExpression",vt,{omit:["_evaluate"]}),Rt)Rt[dr]._classRegistryKey||pr("Expression_"+dr,Rt[dr]);function vr(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(t instanceof ArrayBuffer)return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var r=t;return e&&e.push(r.buffer),r}if(t instanceof fr)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var n=[],a=0,i=t;a<i.length;a+=1){var o=i[a];n.push(vr(o,e))}return n}if("object"==typeof t){var s=t.constructor,l=s._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");var u={};if(s.serialize)u._serialized=s.serialize(t,e);else{for(var c in t)if(t.hasOwnProperty(c)&&!(hr[l].omit.indexOf(c)>=0)){var f=t[c];u[c]=hr[l].shallow.indexOf(c)>=0?f:vr(f,e)}t instanceof Error&&(u.message=t.message)}return{name:l,properties:u}}throw new Error("can't serialize object of type "+typeof t)}function gr(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof ArrayBuffer||ArrayBuffer.isView(t)||t instanceof fr)return t;if(Array.isArray(t))return t.map(function(t){return gr(t)});if("object"==typeof t){var e=t,r=e.name,n=e.properties;if(!r)throw new Error("can't deserialize object of anonymous class");var a=hr[r].klass;if(!a)throw new Error("can't deserialize unregistered class "+r);if(a.deserialize)return a.deserialize(n._serialized);for(var i=Object.create(a.prototype),o=0,s=Object.keys(n);o<s.length;o+=1){var l=s[o];i[l]=hr[r].shallow.indexOf(l)>=0?n[l]:gr(n[l])}return i}throw new Error("can't deserialize object of type "+typeof t)}var mr=function(){this.first=!0};mr.prototype.update=function(t,e){var r=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=r,!0))};var yr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function xr(t){for(var e=0,r=t;e<r.length;e+=1){if(_r(r[e].charCodeAt(0)))return!0}return!1}function br(t){return!yr.Arabic(t)&&(!yr["Arabic Supplement"](t)&&(!yr["Arabic Extended-A"](t)&&(!yr["Arabic Presentation Forms-A"](t)&&!yr["Arabic Presentation Forms-B"](t))))}function _r(t){return 746===t||747===t||!(t<4352)&&(!!yr["Bopomofo Extended"](t)||(!!yr.Bopomofo(t)||(!(!yr["CJK Compatibility Forms"](t)||t>=65097&&t<=65103)||(!!yr["CJK Compatibility Ideographs"](t)||(!!yr["CJK Compatibility"](t)||(!!yr["CJK Radicals Supplement"](t)||(!!yr["CJK Strokes"](t)||(!(!yr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||(!!yr["CJK Unified Ideographs Extension A"](t)||(!!yr["CJK Unified Ideographs"](t)||(!!yr["Enclosed CJK Letters and Months"](t)||(!!yr["Hangul Compatibility Jamo"](t)||(!!yr["Hangul Jamo Extended-A"](t)||(!!yr["Hangul Jamo Extended-B"](t)||(!!yr["Hangul Jamo"](t)||(!!yr["Hangul Syllables"](t)||(!!yr.Hiragana(t)||(!!yr["Ideographic Description Characters"](t)||(!!yr.Kanbun(t)||(!!yr["Kangxi Radicals"](t)||(!!yr["Katakana Phonetic Extensions"](t)||(!(!yr.Katakana(t)||12540===t)||(!(!yr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||(!(!yr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(!!yr["Unified Canadian Aboriginal Syllabics"](t)||(!!yr["Unified Canadian Aboriginal Syllabics Extended"](t)||(!!yr["Vertical Forms"](t)||(!!yr["Yijing Hexagram Symbols"](t)||(!!yr["Yi Syllables"](t)||!!yr["Yi Radicals"](t))))))))))))))))))))))))))))))}function wr(t){return!(_r(t)||function(t){return!!(yr["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||yr["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||yr["Letterlike Symbols"](t)||yr["Number Forms"](t)||yr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||yr["Control Pictures"](t)&&9251!==t||yr["Optical Character Recognition"](t)||yr["Enclosed Alphanumerics"](t)||yr["Geometric Shapes"](t)||yr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||yr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||yr["CJK Symbols and Punctuation"](t)||yr.Katakana(t)||yr["Private Use Area"](t)||yr["CJK Compatibility Forms"](t)||yr["Small Form Variants"](t)||yr["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function kr(t,e){return!(!e&&(t>=1424&&t<=2303||yr["Arabic Presentation Forms-A"](t)||yr["Arabic Presentation Forms-B"](t)))&&!(t>=2304&&t<=3583||t>=3840&&t<=4255||yr.Khmer(t))}var Mr,Ar=!1,Tr=null,Sr=!1,Er=new z,Cr={applyArabicShaping:null,processBidirectionalText:null,isLoaded:function(){return Sr||null!=Cr.applyArabicShaping}},Lr=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new mr,this.transition={})};Lr.prototype.isSupportedScript=function(t){return function(t,e){for(var r=0,n=t;r<n.length;r+=1)if(!kr(n[r].charCodeAt(0),e))return!1;return!0}(t,Cr.isLoaded())},Lr.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)};var Ir=function(t,e){this.property=t,this.value=e,this.expression=Se(void 0===e?t.specification.default:e,t.specification)};Ir.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Ir.prototype.possiblyEvaluate=function(t){return this.property.possiblyEvaluate(this,t)};var zr=function(t){this.property=t,this.value=new Ir(t,void 0)};zr.prototype.transitioned=function(t,e){return new Or(this.property,this.value,e,p({},t.transition,this.transition),t.now)},zr.prototype.untransitioned=function(){return new Or(this.property,this.value,null,{},0)};var Pr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Pr.prototype.getValue=function(t){return x(this._values[t].value.value)},Pr.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new zr(this._values[t].property)),this._values[t].value=new Ir(this._values[t].property,null===e?void 0:x(e))},Pr.prototype.getTransition=function(t){return x(this._values[t].transition)},Pr.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new zr(this._values[t].property)),this._values[t].transition=x(e)||void 0},Pr.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var n=r[e],a=this.getValue(n);void 0!==a&&(t[n]=a);var i=this.getTransition(n);void 0!==i&&(t[n+"-transition"]=i)}return t},Pr.prototype.transitioned=function(t,e){for(var r=new Dr(this._properties),n=0,a=Object.keys(this._values);n<a.length;n+=1){var i=a[n];r._values[i]=this._values[i].transitioned(t,e._values[i])}return r},Pr.prototype.untransitioned=function(){for(var t=new Dr(this._properties),e=0,r=Object.keys(this._values);e<r.length;e+=1){var n=r[e];t._values[n]=this._values[n].untransitioned()}return t};var Or=function(t,e,r,n,a){this.property=t,this.value=e,this.begin=a+n.delay||0,this.end=this.begin+n.duration||0,t.specification.transition&&(n.delay||n.duration)&&(this.prior=r)};Or.prototype.possiblyEvaluate=function(t){var e=t.now||0,r=this.value.possiblyEvaluate(t),n=this.prior;if(n){if(e>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(e<this.begin)return n.possiblyEvaluate(t);var a=(e-this.begin)/(this.end-this.begin);return this.property.interpolate(n.possiblyEvaluate(t),r,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}(a))}return r};var Dr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Dr.prototype.possiblyEvaluate=function(t){for(var e=new Fr(this._properties),r=0,n=Object.keys(this._values);r<n.length;r+=1){var a=n[r];e._values[a]=this._values[a].possiblyEvaluate(t)}return e},Dr.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1){var r=e[t];if(this._values[r].prior)return!0}return!1};var Rr=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Rr.prototype.getValue=function(t){return x(this._values[t].value)},Rr.prototype.setValue=function(t,e){this._values[t]=new Ir(this._values[t].property,null===e?void 0:x(e))},Rr.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var n=r[e],a=this.getValue(n);void 0!==a&&(t[n]=a)}return t},Rr.prototype.possiblyEvaluate=function(t){for(var e=new Fr(this._properties),r=0,n=Object.keys(this._values);r<n.length;r+=1){var a=n[r];e._values[a]=this._values[a].possiblyEvaluate(t)}return e};var Br=function(t,e,r){this.property=t,this.value=e,this.globals=r};Br.prototype.isConstant=function(){return"constant"===this.value.kind},Br.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},Br.prototype.evaluate=function(t){return this.property.evaluate(this.value,this.globals,t)};var Fr=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Fr.prototype.get=function(t){return this._values[t]};var Nr=function(t){this.specification=t};Nr.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},Nr.prototype.interpolate=function(t,e,r){var n=kt[this.specification.type];return n?n(t,e,r):t};var jr=function(t){this.specification=t};jr.prototype.possiblyEvaluate=function(t,e){return"constant"===t.expression.kind||"camera"===t.expression.kind?new Br(this,{kind:"constant",value:t.expression.evaluate(e)},e):new Br(this,t.expression,e)},jr.prototype.interpolate=function(t,e,r){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Br(this,{kind:"constant",value:void 0},t.globals);var n=kt[this.specification.type];return n?new Br(this,{kind:"constant",value:n(t.value.value,e.value.value,r)},t.globals):t},jr.prototype.evaluate=function(t,e,r){return"constant"===t.kind?t.value:t.evaluate(e,r)};var Vr=function(t){this.specification=t};Vr.prototype.possiblyEvaluate=function(t,e){if(void 0!==t.value){if("constant"===t.expression.kind){var r=t.expression.evaluate(e);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new Lr(Math.floor(e.zoom-1),e)),t.expression.evaluate(new Lr(Math.floor(e.zoom),e)),t.expression.evaluate(new Lr(Math.floor(e.zoom+1),e)),e)}},Vr.prototype._calculate=function(t,e,r,n){var a=n.zoom,i=a-Math.floor(a),o=n.crossFadingFactor();return a>n.zoomHistory.lastIntegerZoom?{from:t,to:e,fromScale:2,toScale:1,t:i+(1-i)*o}:{from:r,to:e,fromScale:.5,toScale:1,t:1-(1-o)*i}},Vr.prototype.interpolate=function(t){return t};var Ur=function(t){this.specification=t};Ur.prototype.possiblyEvaluate=function(t,e){return!!t.expression.evaluate(e)},Ur.prototype.interpolate=function(){return!1};var qr=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},t){var r=t[e],n=this.defaultPropertyValues[e]=new Ir(r,void 0),a=this.defaultTransitionablePropertyValues[e]=new zr(r);this.defaultTransitioningPropertyValues[e]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=n.possiblyEvaluate({})}};pr("DataDrivenProperty",jr),pr("DataConstantProperty",Nr),pr("CrossFadedProperty",Vr),pr("ColorRampProperty",Ur);var Hr=function(t){function e(e,r){for(var n in t.call(this),this.id=e.id,this.metadata=e.metadata,this.type=e.type,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this.visibility="visible","background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),this._featureFilter=function(){return!0},r.layout&&(this._unevaluatedLayout=new Rr(r.layout)),this._transitionablePaint=new Pr(r.paint),e.paint)this.setPaintProperty(n,e.paint[n],{validate:!1});for(var a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,r){if(null!=e){var n="layers."+this.id+".layout."+t;if(this._validate(or,n,t,e,r))return}"visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility="none"===e?e:"visible"},e.prototype.getPaintProperty=function(t){return g(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,r){if(null!=e){var n="layers."+this.id+".paint."+t;if(this._validate(ir,n,t,e,r))return}g(t,"-transition")?this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0):this._transitionablePaint.setValue(t,e)},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||(!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility)},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t)),this.paint=this._transitioningPaint.possiblyEvaluate(t)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return"none"===this.visibility&&(t.layout=t.layout||{},t.layout.visibility="none"),y(t,function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)})},e.prototype._validate=function(t,e,r,n,a){return(!a||!1!==a.validate)&&sr(this,t.call(nr,{key:e,layerType:this.type,objectKey:r,value:n,styleSpec:P,style:{glyphs:!0,sprite:!0}}))},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e}(z),Gr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Wr=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Yr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Xr(t,e){void 0===e&&(e=1);var r=0,n=0;return{members:t.map(function(t){var a,i=(a=t.type,Gr[a].BYTES_PER_ELEMENT),o=r=Zr(r,Math.max(e,i)),s=t.components||1;return n=Math.max(n,i),r+=i*s,{name:t.name,type:t.type,components:s,offset:o}}),size:Zr(r,Math.max(n,e)),alignment:e}}function Zr(t,e){return Math.ceil(t/e)*e}Yr.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Yr.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},Yr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Yr.prototype.clear=function(){this.length=0},Yr.prototype.resize=function(t){this.reserve(t),this.length=t},Yr.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},Yr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var $r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=2*r;return this.int16[n+0]=t,this.int16[n+1]=e,r},e}(Yr);$r.prototype.bytesPerElement=4,pr("StructArrayLayout2i4",$r);var Jr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n){var a=this.length;this.resize(a+1);var i=4*a;return this.int16[i+0]=t,this.int16[i+1]=e,this.int16[i+2]=r,this.int16[i+3]=n,a},e}(Yr);Jr.prototype.bytesPerElement=8,pr("StructArrayLayout4i8",Jr);var Kr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,a,i){var o=this.length;this.resize(o+1);var s=6*o;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=r,this.int16[s+3]=n,this.int16[s+4]=a,this.int16[s+5]=i,o},e}(Yr);Kr.prototype.bytesPerElement=12,pr("StructArrayLayout2i4i12",Kr);var Qr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,a,i,o,s){var l=this.length;this.resize(l+1);var u=6*l,c=12*l;return this.int16[u+0]=t,this.int16[u+1]=e,this.int16[u+2]=r,this.int16[u+3]=n,this.uint8[c+8]=a,this.uint8[c+9]=i,this.uint8[c+10]=o,this.uint8[c+11]=s,l},e}(Yr);Qr.prototype.bytesPerElement=12,pr("StructArrayLayout4i4ub12",Qr);var tn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,a,i,o,s){var l=this.length;this.resize(l+1);var u=8*l;return this.int16[u+0]=t,this.int16[u+1]=e,this.int16[u+2]=r,this.int16[u+3]=n,this.uint16[u+4]=a,this.uint16[u+5]=i,this.uint16[u+6]=o,this.uint16[u+7]=s,l},e}(Yr);tn.prototype.bytesPerElement=16,pr("StructArrayLayout4i4ui16",tn);var en=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var a=3*n;return this.float32[a+0]=t,this.float32[a+1]=e,this.float32[a+2]=r,n},e}(Yr);en.prototype.bytesPerElement=12,pr("StructArrayLayout3f12",en);var rn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var r=1*e;return this.uint32[r+0]=t,e},e}(Yr);rn.prototype.bytesPerElement=4,pr("StructArrayLayout1ul4",rn);var nn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,a,i,o,s,l,u,c){var f=this.length;this.resize(f+1);var h=12*f,p=6*f;return this.int16[h+0]=t,this.int16[h+1]=e,this.int16[h+2]=r,this.int16[h+3]=n,this.int16[h+4]=a,this.int16[h+5]=i,this.uint32[p+3]=o,this.uint16[h+8]=s,this.uint16[h+9]=l,this.int16[h+10]=u,this.int16[h+11]=c,f},e}(Yr);nn.prototype.bytesPerElement=24,pr("StructArrayLayout6i1ul2ui2i24",nn);var an=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,a,i){var o=this.length;this.resize(o+1);var s=6*o;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=r,this.int16[s+3]=n,this.int16[s+4]=a,this.int16[s+5]=i,o},e}(Yr);an.prototype.bytesPerElement=12,pr("StructArrayLayout2i2i2i12",an);var on=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=4*r;return this.uint8[n+0]=t,this.uint8[n+1]=e,r},e}(Yr);on.prototype.bytesPerElement=4,pr("StructArrayLayout2ub4",on);var sn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n,a,i,o,s,l,u,c,f,h,p){var d=this.length;this.resize(d+1);var v=20*d,g=10*d,m=40*d;return this.int16[v+0]=t,this.int16[v+1]=e,this.uint16[v+2]=r,this.uint16[v+3]=n,this.uint32[g+2]=a,this.uint32[g+3]=i,this.uint32[g+4]=o,this.uint16[v+10]=s,this.uint16[v+11]=l,this.uint16[v+12]=u,this.float32[g+7]=c,this.float32[g+8]=f,this.uint8[m+36]=h,this.uint8[m+37]=p,d},e}(Yr);sn.prototype.bytesPerElement=40,pr("StructArrayLayout2i2ui3ul3ui2f2ub40",sn);var ln=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var r=1*e;return this.float32[r+0]=t,e},e}(Yr);ln.prototype.bytesPerElement=4,pr("StructArrayLayout1f4",ln);var un=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var a=3*n;return this.int16[a+0]=t,this.int16[a+1]=e,this.int16[a+2]=r,n},e}(Yr);un.prototype.bytesPerElement=6,pr("StructArrayLayout3i6",un);var cn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var a=2*n,i=4*n;return this.uint32[a+0]=t,this.uint16[i+2]=e,this.uint16[i+3]=r,n},e}(Yr);cn.prototype.bytesPerElement=8,pr("StructArrayLayout1ul2ui8",cn);var fn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var n=this.length;this.resize(n+1);var a=3*n;return this.uint16[a+0]=t,this.uint16[a+1]=e,this.uint16[a+2]=r,n},e}(Yr);fn.prototype.bytesPerElement=6,pr("StructArrayLayout3ui6",fn);var hn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=2*r;return this.uint16[n+0]=t,this.uint16[n+1]=e,r},e}(Yr);hn.prototype.bytesPerElement=4,pr("StructArrayLayout2ui4",hn);var pn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;this.resize(r+1);var n=2*r;return this.float32[n+0]=t,this.float32[n+1]=e,r},e}(Yr);pn.prototype.bytesPerElement=8,pr("StructArrayLayout2f8",pn);var dn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,n){var a=this.length;this.resize(a+1);var i=4*a;return this.float32[i+0]=t,this.float32[i+1]=e,this.float32[i+2]=r,this.float32[i+3]=n,a},e}(Yr);dn.prototype.bytesPerElement=16,pr("StructArrayLayout4f16",dn);var vn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointX.set=function(t){this._structArray.int16[this._pos2+0]=t},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorPointY.set=function(t){this._structArray.int16[this._pos2+1]=t},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.x1.set=function(t){this._structArray.int16[this._pos2+2]=t},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.y1.set=function(t){this._structArray.int16[this._pos2+3]=t},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.x2.set=function(t){this._structArray.int16[this._pos2+4]=t},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.y2.set=function(t){this._structArray.int16[this._pos2+5]=t},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.featureIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},r.radius.get=function(){return this._structArray.int16[this._pos2+10]},r.radius.set=function(t){this._structArray.int16[this._pos2+10]=t},r.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},r.signedDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+11]=t},r.anchorPoint.get=function(){return new l(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,r),e}(Wr);vn.prototype.size=24;var gn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new vn(this,t)},e}(nn);pr("CollisionBoxArray",gn);var mn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.glyphStartIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.numGlyphs.set=function(t){this._structArray.uint16[this._pos2+3]=t},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.vertexStartIndex.set=function(t){this._structArray.uint32[this._pos4+2]=t},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineStartIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.lineLength.set=function(t){this._structArray.uint32[this._pos4+4]=t},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.segment.set=function(t){this._structArray.uint16[this._pos2+10]=t},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.lowerSize.set=function(t){this._structArray.uint16[this._pos2+11]=t},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.upperSize.set=function(t){this._structArray.uint16[this._pos2+12]=t},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetX.set=function(t){this._structArray.float32[this._pos4+7]=t},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.lineOffsetY.set=function(t){this._structArray.float32[this._pos4+8]=t},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.writingMode.set=function(t){this._structArray.uint8[this._pos1+36]=t},r.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},r.hidden.set=function(t){this._structArray.uint8[this._pos1+37]=t},Object.defineProperties(e.prototype,r),e}(Wr);mn.prototype.size=40;var yn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new mn(this,t)},e}(sn);pr("PlacedSymbolArray",yn);var xn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={offsetX:{configurable:!0}};return r.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},r.offsetX.set=function(t){this._structArray.float32[this._pos4+0]=t},Object.defineProperties(e.prototype,r),e}(Wr);xn.prototype.size=4;var bn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e.prototype.get=function(t){return new xn(this,t)},e}(ln);pr("GlyphOffsetArray",bn);var _n=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return r.x.get=function(){return this._structArray.int16[this._pos2+0]},r.x.set=function(t){this._structArray.int16[this._pos2+0]=t},r.y.get=function(){return this._structArray.int16[this._pos2+1]},r.y.set=function(t){this._structArray.int16[this._pos2+1]=t},r.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},r.tileUnitDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+2]=t},Object.defineProperties(e.prototype,r),e}(Wr);_n.prototype.size=6;var wn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e.prototype.get=function(t){return new _n(this,t)},e}(un);pr("SymbolLineVertexArray",wn);var kn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.featureIndex.set=function(t){this._structArray.uint32[this._pos4+0]=t},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},r.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+3]=t},Object.defineProperties(e.prototype,r),e}(Wr);kn.prototype.size=8;var Mn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new kn(this,t)},e}(cn);pr("FeatureIndexArray",Mn);var An=Xr([{name:"a_pos",components:2,type:"Int16"}],4).members,Tn=function(t){void 0===t&&(t=[]),this.segments=t};Tn.prototype.prepareSegment=function(t,e,r){var n=this.segments[this.segments.length-1];return t>Tn.MAX_VERTEX_ARRAY_LENGTH&&_("Max vertices per segment is "+Tn.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!n||n.vertexLength+t>Tn.MAX_VERTEX_ARRAY_LENGTH)&&(n={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},this.segments.push(n)),n},Tn.prototype.get=function(){return this.segments},Tn.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var r=e[t];for(var n in r.vaos)r.vaos[n].destroy()}},Tn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,pr("SegmentVector",Tn);var Sn=function(t,e){return 256*(t=h(Math.floor(t),0,255))+(e=h(Math.floor(e),0,255))};function En(t){return[Sn(255*t.r,255*t.g),Sn(255*t.b,255*t.a)]}var Cn=function(t,e,r){this.value=t,this.name=e,this.type=r,this.statistics={max:-1/0}};Cn.prototype.defines=function(){return["#define HAS_UNIFORM_u_"+this.name]},Cn.prototype.populatePaintArray=function(){},Cn.prototype.upload=function(){},Cn.prototype.destroy=function(){},Cn.prototype.setUniforms=function(t,e,r,n){var a=n.constantOr(this.value),i=t.gl;"color"===this.type?i.uniform4f(e.uniforms["u_"+this.name],a.r,a.g,a.b,a.a):i.uniform1f(e.uniforms["u_"+this.name],a)};var Ln=function(t,e,r){this.expression=t,this.name=e,this.type=r,this.statistics={max:-1/0};var n="color"===r?pn:ln;this.paintVertexAttributes=[{name:"a_"+e,type:"Float32",components:"color"===r?2:1,offset:0}],this.paintVertexArray=new n};Ln.prototype.defines=function(){return[]},Ln.prototype.populatePaintArray=function(t,e){var r=this.paintVertexArray,n=r.length;r.reserve(t);var a=this.expression.evaluate(new Lr(0),e);if("color"===this.type)for(var i=En(a),o=n;o<t;o++)r.emplaceBack(i[0],i[1]);else{for(var s=n;s<t;s++)r.emplaceBack(a);this.statistics.max=Math.max(this.statistics.max,a)}},Ln.prototype.upload=function(t){this.paintVertexArray&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes))},Ln.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ln.prototype.setUniforms=function(t,e){t.gl.uniform1f(e.uniforms["a_"+this.name+"_t"],0)};var In=function(t,e,r,n,a){this.expression=t,this.name=e,this.type=r,this.useIntegerZoom=n,this.zoom=a,this.statistics={max:-1/0};var i="color"===r?dn:pn;this.paintVertexAttributes=[{name:"a_"+e,type:"Float32",components:"color"===r?4:2,offset:0}],this.paintVertexArray=new i};In.prototype.defines=function(){return[]},In.prototype.populatePaintArray=function(t,e){var r=this.paintVertexArray,n=r.length;r.reserve(t);var a=this.expression.evaluate(new Lr(this.zoom),e),i=this.expression.evaluate(new Lr(this.zoom+1),e);if("color"===this.type)for(var o=En(a),s=En(i),l=n;l<t;l++)r.emplaceBack(o[0],o[1],s[0],s[1]);else{for(var u=n;u<t;u++)r.emplaceBack(a,i);this.statistics.max=Math.max(this.statistics.max,a,i)}},In.prototype.upload=function(t){this.paintVertexArray&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes))},In.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},In.prototype.interpolationFactor=function(t){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(t),this.zoom,this.zoom+1):this.expression.interpolationFactor(t,this.zoom,this.zoom+1)},In.prototype.setUniforms=function(t,e,r){t.gl.uniform1f(e.uniforms["a_"+this.name+"_t"],this.interpolationFactor(r.zoom))};var zn=function(){this.binders={},this.cacheKey="",this._buffers=[]};zn.createDynamic=function(t,e,r){var n=new zn,a=[];for(var i in t.paint._values)if(r(i)){var o=t.paint.get(i);if(o instanceof Br&&o.property.specification["property-function"]){var s=On(i,t.type),l=o.property.specification.type,u=o.property.useIntegerZoom;"constant"===o.value.kind?(n.binders[i]=new Cn(o.value,s,l),a.push("/u_"+s)):"source"===o.value.kind?(n.binders[i]=new Ln(o.value,s,l),a.push("/a_"+s)):(n.binders[i]=new In(o.value,s,l,u,e),a.push("/z_"+s))}}return n.cacheKey=a.sort().join(""),n},zn.prototype.populatePaintArrays=function(t,e){for(var r in this.binders)this.binders[r].populatePaintArray(t,e)},zn.prototype.defines=function(){var t=[];for(var e in this.binders)t.push.apply(t,this.binders[e].defines());return t},zn.prototype.setUniforms=function(t,e,r,n){for(var a in this.binders){this.binders[a].setUniforms(t,e,n,r.get(a))}},zn.prototype.getPaintVertexBuffers=function(){return this._buffers},zn.prototype.upload=function(t){for(var e in this.binders)this.binders[e].upload(t);var r=[];for(var n in this.binders){var a=this.binders[n];(a instanceof Ln||a instanceof In)&&a.paintVertexBuffer&&r.push(a.paintVertexBuffer)}this._buffers=r},zn.prototype.destroy=function(){for(var t in this.binders)this.binders[t].destroy()};var Pn=function(t,e,r,n){void 0===n&&(n=function(){return!0}),this.programConfigurations={};for(var a=0,i=e;a<i.length;a+=1){var o=i[a];this.programConfigurations[o.id]=zn.createDynamic(o,r,n),this.programConfigurations[o.id].layoutAttributes=t}};function On(t,e){return{"text-opacity":"opacity","icon-opacity":"opacity","text-color":"fill_color","icon-color":"fill_color","text-halo-color":"halo_color","icon-halo-color":"halo_color","text-halo-blur":"halo_blur","icon-halo-blur":"halo_blur","text-halo-width":"halo_width","icon-halo-width":"halo_width","line-gap-width":"gapwidth"}[t]||t.replace(e+"-","").replace(/-/g,"_")}Pn.prototype.populatePaintArrays=function(t,e){for(var r in this.programConfigurations)this.programConfigurations[r].populatePaintArrays(t,e)},Pn.prototype.get=function(t){return this.programConfigurations[t]},Pn.prototype.upload=function(t){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t)},Pn.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},pr("ConstantBinder",Cn),pr("SourceExpressionBinder",Ln),pr("CompositeExpressionBinder",In),pr("ProgramConfiguration",zn,{omit:["_buffers"]}),pr("ProgramConfigurationSet",Pn);var Dn=8192;var Rn,Bn=(Rn=16,{min:-1*Math.pow(2,Rn-1),max:Math.pow(2,Rn-1)-1});function Fn(t){for(var e=Dn/t.extent,r=t.loadGeometry(),n=0;n<r.length;n++)for(var a=r[n],i=0;i<a.length;i++){var o=a[i];o.x=Math.round(o.x*e),o.y=Math.round(o.y*e),(o.x<Bn.min||o.x>Bn.max||o.y<Bn.min||o.y>Bn.max)&&_("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Nn(t,e,r,n,a){t.emplaceBack(2*e+(n+1)/2,2*r+(a+1)/2)}var jn=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new $r,this.indexArray=new fn,this.segments=new Tn,this.programConfigurations=new Pn(An,t.layers,t.zoom)};function Vn(t,e,r){for(var n=0;n<t.length;n++){var a=t[n];if($n(a,e))return!0;if(Yn(e,a,r))return!0}return!1}function Un(t,e){if(1===t.length&&1===t[0].length)return Zn(e,t[0][0]);for(var r=0;r<e.length;r++)for(var n=e[r],a=0;a<n.length;a++)if(Zn(t,n[a]))return!0;for(var i=0;i<t.length;i++){for(var o=t[i],s=0;s<o.length;s++)if(Zn(e,o[s]))return!0;for(var l=0;l<e.length;l++)if(Gn(o,e[l]))return!0}return!1}function qn(t,e,r){for(var n=0;n<e.length;n++)for(var a=e[n],i=0;i<t.length;i++){var o=t[i];if(o.length>=3)for(var s=0;s<a.length;s++)if($n(o,a[s]))return!0;if(Hn(o,a,r))return!0}return!1}function Hn(t,e,r){if(t.length>1){if(Gn(t,e))return!0;for(var n=0;n<e.length;n++)if(Yn(e[n],t,r))return!0}for(var a=0;a<t.length;a++)if(Yn(t[a],e,r))return!0;return!1}function Gn(t,e){if(0===t.length||0===e.length)return!1;for(var r=0;r<t.length-1;r++)for(var n=t[r],a=t[r+1],i=0;i<e.length-1;i++){if(Wn(n,a,e[i],e[i+1]))return!0}return!1}function Wn(t,e,r,n){return w(t,r,n)!==w(e,r,n)&&w(t,e,r)!==w(t,e,n)}function Yn(t,e,r){var n=r*r;if(1===e.length)return t.distSqr(e[0])<n;for(var a=1;a<e.length;a++){if(Xn(t,e[a-1],e[a])<n)return!0}return!1}function Xn(t,e,r){var n=e.distSqr(r);if(0===n)return t.distSqr(e);var a=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;return a<0?t.distSqr(e):a>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(a)._add(e))}function Zn(t,e){for(var r,n,a,i=!1,o=0;o<t.length;o++)for(var s=0,l=(r=t[o]).length-1;s<r.length;l=s++)n=r[s],a=r[l],n.y>e.y!=a.y>e.y&&e.x<(a.x-n.x)*(e.y-n.y)/(a.y-n.y)+n.x&&(i=!i);return i}function $n(t,e){for(var r=!1,n=0,a=t.length-1;n<t.length;a=n++){var i=t[n],o=t[a];i.y>e.y!=o.y>e.y&&e.x<(o.x-i.x)*(e.y-i.y)/(o.y-i.y)+i.x&&(r=!r)}return r}function Jn(t,e,r){var n=e.paint.get(t).value;return"constant"===n.kind?n.value:r.programConfigurations.get(e.id).binders[t].statistics.max}function Kn(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Qn(t,e,r,n,a){if(!e[0]&&!e[1])return t;var i=l.convert(e);"viewport"===r&&i._rotate(-n);for(var o=[],s=0;s<t.length;s++){for(var u=t[s],c=[],f=0;f<u.length;f++)c.push(u[f].sub(i._mult(a)));o.push(c)}return o}jn.prototype.populate=function(t,e){for(var r=0,n=t;r<n.length;r+=1){var a=n[r],i=a.feature,o=a.index,s=a.sourceLayerIndex;if(this.layers[0]._featureFilter(new Lr(this.zoom),i)){var l=Fn(i);this.addFeature(i,l),e.featureIndex.insert(i,l,o,s,this.index)}}},jn.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},jn.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,An),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.programConfigurations.upload(t)},jn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},jn.prototype.addFeature=function(t,e){for(var r=0,n=e;r<n.length;r+=1)for(var a=0,i=n[r];a<i.length;a+=1){var o=i[a],s=o.x,l=o.y;if(!(s<0||s>=Dn||l<0||l>=Dn)){var u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),c=u.vertexLength;Nn(this.layoutVertexArray,s,l,-1,-1),Nn(this.layoutVertexArray,s,l,1,-1),Nn(this.layoutVertexArray,s,l,1,1),Nn(this.layoutVertexArray,s,l,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),u.vertexLength+=4,u.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t)},pr("CircleBucket",jn,{omit:["layers"]});var ta={paint:new qr({"circle-radius":new jr(P.paint_circle["circle-radius"]),"circle-color":new jr(P.paint_circle["circle-color"]),"circle-blur":new jr(P.paint_circle["circle-blur"]),"circle-opacity":new jr(P.paint_circle["circle-opacity"]),"circle-translate":new Nr(P.paint_circle["circle-translate"]),"circle-translate-anchor":new Nr(P.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Nr(P.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Nr(P.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jr(P.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jr(P.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jr(P.paint_circle["circle-stroke-opacity"])})},ea=a(function(t,e){var r;t.exports=((r=new Float32Array(3))[0]=0,r[1]=0,r[2]=0,function(){var t=new Float32Array(4);t[0]=0,t[1]=0,t[2]=0,t[3]=0}(),{vec3:{transformMat3:function(t,e,r){var n=e[0],a=e[1],i=e[2];return t[0]=n*r[0]+a*r[3]+i*r[6],t[1]=n*r[1]+a*r[4]+i*r[7],t[2]=n*r[2]+a*r[5]+i*r[8],t}},vec4:{transformMat4:function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o,t[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o,t[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o,t[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o,t}},mat2:{create:function(){var t=new Float32Array(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},rotate:function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l+i*s,t[1]=a*l+o*s,t[2]=n*-s+i*l,t[3]=a*-s+o*l,t},scale:function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],l=r[1];return t[0]=n*s,t[1]=a*s,t[2]=i*l,t[3]=o*l,t}},mat3:{create:function(){var t=new Float32Array(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromRotation:function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}},mat4:{create:function(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},translate:function(t,e,r){var n,a,i,o,s,l,u,c,f,h,p,d,v=r[0],g=r[1],m=r[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*m+e[12],t[13]=e[1]*v+e[5]*g+e[9]*m+e[13],t[14]=e[2]*v+e[6]*g+e[10]*m+e[14],t[15]=e[3]*v+e[7]*g+e[11]*m+e[15]):(n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],p=e[10],d=e[11],t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=f,t[9]=h,t[10]=p,t[11]=d,t[12]=n*v+s*g+f*m+e[12],t[13]=a*v+l*g+h*m+e[13],t[14]=i*v+u*g+p*m+e[14],t[15]=o*v+c*g+d*m+e[15]),t},scale:function(t,e,r){var n=r[0],a=r[1],i=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},multiply:function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],p=e[10],d=e[11],v=e[12],g=e[13],m=e[14],y=e[15],x=r[0],b=r[1],_=r[2],w=r[3];return t[0]=x*n+b*s+_*f+w*v,t[1]=x*a+b*l+_*h+w*g,t[2]=x*i+b*u+_*p+w*m,t[3]=x*o+b*c+_*d+w*y,x=r[4],b=r[5],_=r[6],w=r[7],t[4]=x*n+b*s+_*f+w*v,t[5]=x*a+b*l+_*h+w*g,t[6]=x*i+b*u+_*p+w*m,t[7]=x*o+b*c+_*d+w*y,x=r[8],b=r[9],_=r[10],w=r[11],t[8]=x*n+b*s+_*f+w*v,t[9]=x*a+b*l+_*h+w*g,t[10]=x*i+b*u+_*p+w*m,t[11]=x*o+b*c+_*d+w*y,x=r[12],b=r[13],_=r[14],w=r[15],t[12]=x*n+b*s+_*f+w*v,t[13]=x*a+b*l+_*h+w*g,t[14]=x*i+b*u+_*p+w*m,t[15]=x*o+b*c+_*d+w*y,t},perspective:function(t,e,r,n,a){var i=1/Math.tan(e/2),o=1/(n-a);return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+n)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*n*o,t[15]=0,t},rotateX:function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+u*n,t[5]=o*a+c*n,t[6]=s*a+f*n,t[7]=l*a+h*n,t[8]=u*a-i*n,t[9]=c*a-o*n,t[10]=f*a-s*n,t[11]=h*a-l*n,t},rotateZ:function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+u*n,t[1]=o*a+c*n,t[2]=s*a+f*n,t[3]=l*a+h*n,t[4]=u*a-i*n,t[5]=c*a-o*n,t[6]=f*a-s*n,t[7]=h*a-l*n,t},invert:function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],p=e[11],d=e[12],v=e[13],g=e[14],m=e[15],y=r*s-n*o,x=r*l-a*o,b=r*u-i*o,_=n*l-a*s,w=n*u-i*s,k=a*u-i*l,M=c*v-f*d,A=c*g-h*d,T=c*m-p*d,S=f*g-h*v,E=f*m-p*v,C=h*m-p*g,L=y*C-x*E+b*S+_*T-w*A+k*M;return L?(L=1/L,t[0]=(s*C-l*E+u*S)*L,t[1]=(a*E-n*C-i*S)*L,t[2]=(v*k-g*w+m*_)*L,t[3]=(h*w-f*k-p*_)*L,t[4]=(l*T-o*C-u*A)*L,t[5]=(r*C-a*T+i*A)*L,t[6]=(g*b-d*k-m*x)*L,t[7]=(c*k-h*b+p*x)*L,t[8]=(o*E-s*T+u*M)*L,t[9]=(n*T-r*E-i*M)*L,t[10]=(d*w-v*b+m*y)*L,t[11]=(f*b-c*w-p*y)*L,t[12]=(s*A-o*S-l*M)*L,t[13]=(r*S-n*A+a*M)*L,t[14]=(v*x-d*_-g*y)*L,t[15]=(c*_-f*x+h*y)*L,t):null},ortho:function(t,e,r,n,a,i,o){var s=1/(e-r),l=1/(n-a),u=1/(i-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(a+n)*l,t[14]=(o+i)*u,t[15]=1,t}}})}),ra=(ea.vec3,ea.vec4),na=(ea.mat2,ea.mat3,ea.mat4),aa=function(t){function e(e){t.call(this,e,ta)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new jn(t)},e.prototype.queryRadius=function(t){var e=t;return Jn("circle-radius",this,e)+Jn("circle-stroke-width",this,e)+Kn(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,a,i,o){for(var s=Qn(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,i),l=this.paint.get("circle-radius").evaluate(e)+this.paint.get("circle-stroke-width").evaluate(e),u="map"===this.paint.get("circle-pitch-alignment"),c=u?s:function(t,e,r){return t.map(function(t){return t.map(function(t){return ia(t,e,r)})})}(s,o,a),f=u?l*i:l,h=0,p=r;h<p.length;h+=1)for(var d=0,v=p[h];d<v.length;d+=1){var g=v[d],m=u?g:ia(g,o,a),y=f,x=ra.transformMat4([],[g.x,g.y,0,1],o);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?y*=x[3]/a.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(y*=a.cameraToCenterDistance/x[3]),Vn(c,m,y))return!0}return!1},e}(Hr);function ia(t,e,r){var n=ra.transformMat4([],[t.x,t.y,0,1],e);return new l((n[0]/n[3]+1)*r.width*.5,(n[1]/n[3]+1)*r.height*.5)}var oa=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(jn);function sa(t,e,r,n){var a=e.width,i=e.height;if(n){if(n.length!==a*i*r)throw new RangeError("mismatched image size")}else n=new Uint8Array(a*i*r);return t.width=a,t.height=i,t.data=n,t}function la(t,e,r){var n=e.width,a=e.height;if(n!==t.width||a!==t.height){var i=sa({},{width:n,height:a},r);ua(t,i,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,n),height:Math.min(t.height,a)},r),t.width=n,t.height=a,t.data=i.data}}function ua(t,e,r,n,a,i){if(0===a.width||0===a.height)return e;if(a.width>t.width||a.height>t.height||r.x>t.width-a.width||r.y>t.height-a.height)throw new RangeError("out of range source coordinates for image copy");if(a.width>e.width||a.height>e.height||n.x>e.width-a.width||n.y>e.height-a.height)throw new RangeError("out of range destination coordinates for image copy");for(var o=t.data,s=e.data,l=0;l<a.height;l++)for(var u=((r.y+l)*t.width+r.x)*i,c=((n.y+l)*e.width+n.x)*i,f=0;f<a.width*i;f++)s[c+f]=o[u+f];return e}pr("HeatmapBucket",oa,{omit:["layers"]});var ca=function(t,e){sa(this,t,1,e)};ca.prototype.resize=function(t){la(this,t,1)},ca.prototype.clone=function(){return new ca({width:this.width,height:this.height},new Uint8Array(this.data))},ca.copy=function(t,e,r,n,a){ua(t,e,r,n,a,1)};var fa=function(t,e){sa(this,t,4,e)};fa.prototype.resize=function(t){la(this,t,4)},fa.prototype.clone=function(){return new fa({width:this.width,height:this.height},new Uint8Array(this.data))},fa.copy=function(t,e,r,n,a){ua(t,e,r,n,a,4)},pr("AlphaImage",ca),pr("RGBAImage",fa);var ha={paint:new qr({"heatmap-radius":new jr(P.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jr(P.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Nr(P.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ur(P.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Nr(P.paint_heatmap["heatmap-opacity"])})};function pa(t,e){for(var r=new Uint8Array(1024),n={},a=0,i=0;a<256;a++,i+=4){n[e]=a/255;var o=t.evaluate(n);r[i+0]=Math.floor(255*o.r/o.a),r[i+1]=Math.floor(255*o.g/o.a),r[i+2]=Math.floor(255*o.b/o.a),r[i+3]=Math.floor(255*o.a)}return new fa({width:256,height:1},r)}var da=function(t){function e(e){t.call(this,e,ha),this._updateColorRamp()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new oa(t)},e.prototype.setPaintProperty=function(e,r,n){t.prototype.setPaintProperty.call(this,e,r,n),"heatmap-color"===e&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){var t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=pa(t,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(Hr),va={paint:new qr({"hillshade-illumination-direction":new Nr(P.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Nr(P.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Nr(P.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Nr(P.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Nr(P.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Nr(P.paint_hillshade["hillshade-accent-color"])})},ga=function(t){function e(e){t.call(this,e,va)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(Hr),ma=Xr([{name:"a_pos",components:2,type:"Int16"}],4).members,ya=ba,xa=ba;function ba(t,e,r){r=r||2;var n,a,i,o,s,l,u,c=e&&e.length,f=c?e[0]*r:t.length,h=_a(t,0,f,r,!0),p=[];if(!h)return p;if(c&&(h=function(t,e,r,n){var a,i,o,s,l,u=[];for(a=0,i=e.length;a<i;a++)o=e[a]*n,s=a<i-1?e[a+1]*n:t.length,(l=_a(t,o,s,n,!1))===l.next&&(l.steiner=!0),u.push(Ia(l));for(u.sort(Ea),a=0;a<u.length;a++)Ca(u[a],r),r=wa(r,r.next);return r}(t,e,h,r)),t.length>80*r){n=i=t[0],a=o=t[1];for(var d=r;d<f;d+=r)(s=t[d])<n&&(n=s),(l=t[d+1])<a&&(a=l),s>i&&(i=s),l>o&&(o=l);u=0!==(u=Math.max(i-n,o-a))?1/u:0}return ka(h,p,r,n,a,u),p}function _a(t,e,r,n,a){var i,o;if(a===Ua(t,e,r,n)>0)for(i=e;i<r;i+=n)o=Na(i,t[i],t[i+1],o);else for(i=r-n;i>=e;i-=n)o=Na(i,t[i],t[i+1],o);return o&&Da(o,o.next)&&(ja(o),o=o.next),o}function wa(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Da(n,n.next)&&0!==Oa(n.prev,n,n.next))n=n.next;else{if(ja(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function ka(t,e,r,n,a,i,o){if(t){!o&&i&&function(t,e,r,n){var a=t;do{null===a.z&&(a.z=La(a.x,a.y,e,r,n)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==t);a.prevZ.nextZ=null,a.prevZ=null,function(t){var e,r,n,a,i,o,s,l,u=1;do{for(r=t,t=null,i=null,o=0;r;){for(o++,n=r,s=0,e=0;e<u&&(s++,n=n.nextZ);e++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(a=r,r=r.nextZ,s--):(a=n,n=n.nextZ,l--),i?i.nextZ=a:t=a,a.prevZ=i,i=a;r=n}i.nextZ=null,u*=2}while(o>1)}(a)}(t,n,a,i);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,i?Aa(t,n,a,i):Ma(t))e.push(s.i/r),e.push(t.i/r),e.push(l.i/r),ja(t),t=l.next,u=l.next;else if((t=l)===u){o?1===o?ka(t=Ta(t,e,r),e,r,n,a,i,2):2===o&&Sa(t,e,r,n,a,i):ka(wa(t),e,r,n,a,i,1);break}}}function Ma(t){var e=t.prev,r=t,n=t.next;if(Oa(e,r,n)>=0)return!1;for(var a=t.next.next;a!==t.prev;){if(za(e.x,e.y,r.x,r.y,n.x,n.y,a.x,a.y)&&Oa(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function Aa(t,e,r,n){var a=t.prev,i=t,o=t.next;if(Oa(a,i,o)>=0)return!1;for(var s=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,l=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,u=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,c=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y,f=La(s,l,e,r,n),h=La(u,c,e,r,n),p=t.prevZ,d=t.nextZ;p&&p.z>=f&&d&&d.z<=h;){if(p!==t.prev&&p!==t.next&&za(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&Oa(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,d!==t.prev&&d!==t.next&&za(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&Oa(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;p&&p.z>=f;){if(p!==t.prev&&p!==t.next&&za(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&Oa(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;d&&d.z<=h;){if(d!==t.prev&&d!==t.next&&za(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&Oa(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Ta(t,e,r){var n=t;do{var a=n.prev,i=n.next.next;!Da(a,i)&&Ra(a,n,n.next,i)&&Ba(a,i)&&Ba(i,a)&&(e.push(a.i/r),e.push(n.i/r),e.push(i.i/r),ja(n),ja(n.next),n=t=i),n=n.next}while(n!==t);return n}function Sa(t,e,r,n,a,i){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Pa(o,s)){var l=Fa(o,s);return o=wa(o,o.next),l=wa(l,l.next),ka(o,e,r,n,a,i),void ka(l,e,r,n,a,i)}s=s.next}o=o.next}while(o!==t)}function Ea(t,e){return t.x-e.x}function Ca(t,e){if(e=function(t,e){var r,n=e,a=t.x,i=t.y,o=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=a&&s>o){if(o=s,s===a){if(i===n.y)return n;if(i===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(a===o)return r.prev;var l,u=r,c=r.x,f=r.y,h=1/0;n=r.next;for(;n!==u;)a>=n.x&&n.x>=c&&a!==n.x&&za(i<f?a:o,i,c,f,i<f?o:a,i,n.x,n.y)&&((l=Math.abs(i-n.y)/(a-n.x))<h||l===h&&n.x>r.x)&&Ba(n,t)&&(r=n,h=l),n=n.next;return r}(t,e)){var r=Fa(e,t);wa(r,r.next)}}function La(t,e,r,n,a){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*a)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*a)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ia(t){var e=t,r=t;do{e.x<r.x&&(r=e),e=e.next}while(e!==t);return r}function za(t,e,r,n,a,i,o,s){return(a-o)*(e-s)-(t-o)*(i-s)>=0&&(t-o)*(n-s)-(r-o)*(e-s)>=0&&(r-o)*(i-s)-(a-o)*(n-s)>=0}function Pa(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Ra(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&Ba(t,e)&&Ba(e,t)&&function(t,e){var r=t,n=!1,a=(t.x+e.x)/2,i=(t.y+e.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&a<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)}function Oa(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Da(t,e){return t.x===e.x&&t.y===e.y}function Ra(t,e,r,n){return!!(Da(t,e)&&Da(r,n)||Da(t,n)&&Da(r,e))||Oa(t,e,r)>0!=Oa(t,e,n)>0&&Oa(r,n,t)>0!=Oa(r,n,e)>0}function Ba(t,e){return Oa(t.prev,t,t.next)<0?Oa(t,e,t.next)>=0&&Oa(t,t.prev,e)>=0:Oa(t,e,t.prev)<0||Oa(t,t.next,e)<0}function Fa(t,e){var r=new Va(t.i,t.x,t.y),n=new Va(e.i,e.x,e.y),a=t.next,i=e.prev;return t.next=e,e.prev=t,r.next=a,a.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function Na(t,e,r,n){var a=new Va(t,e,r);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}function ja(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Va(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ua(t,e,r,n){for(var a=0,i=e,o=r-n;i<r;i+=n)a+=(t[o]-t[i])*(t[i+1]+t[o+1]),o=i;return a}ba.deviation=function(t,e,r,n){var a=e&&e.length,i=a?e[0]*r:t.length,o=Math.abs(Ua(t,0,i,r));if(a)for(var s=0,l=e.length;s<l;s++){var u=e[s]*r,c=s<l-1?e[s+1]*r:t.length;o-=Math.abs(Ua(t,u,c,r))}var f=0;for(s=0;s<n.length;s+=3){var h=n[s]*r,p=n[s+1]*r,d=n[s+2]*r;f+=Math.abs((t[h]-t[d])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[d+1]-t[h+1]))}return 0===o&&0===f?0:Math.abs((f-o)/o)},ba.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,a=0;a<t.length;a++){for(var i=0;i<t[a].length;i++)for(var o=0;o<e;o++)r.vertices.push(t[a][i][o]);a>0&&(n+=t[a-1].length,r.holes.push(n))}return r},ya.default=xa;var qa=Ga,Ha=Ga;function Ga(t,e,r,n,a){!function t(e,r,n,a,i){for(;a>n;){if(a-n>600){var o=a-n+1,s=r-n+1,l=Math.log(o),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(o-u)/o)*(s-o/2<0?-1:1),f=Math.max(n,Math.floor(r-s*u/o+c)),h=Math.min(a,Math.floor(r+(o-s)*u/o+c));t(e,r,f,h,i)}var p=e[r],d=n,v=a;for(Wa(e,n,r),i(e[a],p)>0&&Wa(e,n,a);d<v;){for(Wa(e,d,v),d++,v--;i(e[d],p)<0;)d++;for(;i(e[v],p)>0;)v--}0===i(e[n],p)?Wa(e,n,v):Wa(e,++v,a),v<=r&&(n=v+1),r<=v&&(a=v-1)}}(t,e,r||0,n||t.length-1,a||Ya)}function Wa(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function Ya(t,e){return t<e?-1:t>e?1:0}function Xa(t,e){var r=t.length;if(r<=1)return[t];for(var n,a,i=[],o=0;o<r;o++){var s=k(t[o]);0!==s&&(t[o].area=Math.abs(s),void 0===a&&(a=s<0),a===s<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}if(n&&i.push(n),e>1)for(var l=0;l<i.length;l++)i[l].length<=e||(qa(i[l],e,1,i[l].length-1,Za),i[l]=i[l].slice(0,e));return i}function Za(t,e){return e.area-t.area}qa.default=Ha;var $a=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new $r,this.indexArray=new fn,this.indexArray2=new hn,this.programConfigurations=new Pn(ma,t.layers,t.zoom),this.segments=new Tn,this.segments2=new Tn};$a.prototype.populate=function(t,e){for(var r=0,n=t;r<n.length;r+=1){var a=n[r],i=a.feature,o=a.index,s=a.sourceLayerIndex;if(this.layers[0]._featureFilter(new Lr(this.zoom),i)){var l=Fn(i);this.addFeature(i,l),e.featureIndex.insert(i,l,o,s,this.index)}}},$a.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},$a.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ma),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2),this.programConfigurations.upload(t)},$a.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},$a.prototype.addFeature=function(t,e){for(var r=0,n=Xa(e,500);r<n.length;r+=1){for(var a=n[r],i=0,o=0,s=a;o<s.length;o+=1){i+=s[o].length}for(var l=this.segments.prepareSegment(i,this.layoutVertexArray,this.indexArray),u=l.vertexLength,c=[],f=[],h=0,p=a;h<p.length;h+=1){var d=p[h];if(0!==d.length){d!==a[0]&&f.push(c.length/2);var v=this.segments2.prepareSegment(d.length,this.layoutVertexArray,this.indexArray2),g=v.vertexLength;this.layoutVertexArray.emplaceBack(d[0].x,d[0].y),this.indexArray2.emplaceBack(g+d.length-1,g),c.push(d[0].x),c.push(d[0].y);for(var m=1;m<d.length;m++)this.layoutVertexArray.emplaceBack(d[m].x,d[m].y),this.indexArray2.emplaceBack(g+m-1,g+m),c.push(d[m].x),c.push(d[m].y);v.vertexLength+=d.length,v.primitiveLength+=d.length}}for(var y=ya(c,f),x=0;x<y.length;x+=3)this.indexArray.emplaceBack(u+y[x],u+y[x+1],u+y[x+2]);l.vertexLength+=i,l.primitiveLength+=y.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t)},pr("FillBucket",$a,{omit:["layers"]});var Ja={paint:new qr({"fill-antialias":new Nr(P.paint_fill["fill-antialias"]),"fill-opacity":new jr(P.paint_fill["fill-opacity"]),"fill-color":new jr(P.paint_fill["fill-color"]),"fill-outline-color":new jr(P.paint_fill["fill-outline-color"]),"fill-translate":new Nr(P.paint_fill["fill-translate"]),"fill-translate-anchor":new Nr(P.paint_fill["fill-translate-anchor"]),"fill-pattern":new Vr(P.paint_fill["fill-pattern"])})},Ka=function(t){function e(e){t.call(this,e,Ja)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(t){this.paint=this._transitioningPaint.possiblyEvaluate(t);var e=this.paint._values["fill-outline-color"];"constant"===e.value.kind&&void 0===e.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new $a(t)},e.prototype.queryRadius=function(){return Kn(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,a,i){return Un(Qn(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,i),r)},e}(Hr),Qa=Xr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ti=Math.pow(2,13);function ei(t,e,r,n,a,i,o,s){t.emplaceBack(e,r,2*Math.floor(n*ti)+o,a*ti*2,i*ti*2,Math.round(s))}var ri=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new Kr,this.indexArray=new fn,this.programConfigurations=new Pn(Qa,t.layers,t.zoom),this.segments=new Tn};function ni(t,e){return t.x===e.x&&(t.x<0||t.x>Dn)||t.y===e.y&&(t.y<0||t.y>Dn)}function ai(t){return t.every(function(t){return t.x<0})||t.every(function(t){return t.x>Dn})||t.every(function(t){return t.y<0})||t.every(function(t){return t.y>Dn})}ri.prototype.populate=function(t,e){for(var r=0,n=t;r<n.length;r+=1){var a=n[r],i=a.feature,o=a.index,s=a.sourceLayerIndex;if(this.layers[0]._featureFilter(new Lr(this.zoom),i)){var l=Fn(i);this.addFeature(i,l),e.featureIndex.insert(i,l,o,s,this.index)}}},ri.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ri.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Qa),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.programConfigurations.upload(t)},ri.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ri.prototype.addFeature=function(t,e){for(var r=0,n=Xa(e,500);r<n.length;r+=1){for(var a=n[r],i=0,o=0,s=a;o<s.length;o+=1){i+=s[o].length}for(var l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),u=0,c=a;u<c.length;u+=1){var f=c[u];if(0!==f.length&&!ai(f))for(var h=0,p=0;p<f.length;p++){var d=f[p];if(p>=1){var v=f[p-1];if(!ni(d,v)){l.vertexLength+4>Tn.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var g=d.sub(v)._perp()._unit(),m=v.dist(d);h+m>32768&&(h=0),ei(this.layoutVertexArray,d.x,d.y,g.x,g.y,0,0,h),ei(this.layoutVertexArray,d.x,d.y,g.x,g.y,0,1,h),h+=m,ei(this.layoutVertexArray,v.x,v.y,g.x,g.y,0,0,h),ei(this.layoutVertexArray,v.x,v.y,g.x,g.y,0,1,h);var y=l.vertexLength;this.indexArray.emplaceBack(y,y+1,y+2),this.indexArray.emplaceBack(y+1,y+2,y+3),l.vertexLength+=4,l.primitiveLength+=2}}}}l.vertexLength+i>Tn.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(i,this.layoutVertexArray,this.indexArray));for(var x=[],b=[],_=l.vertexLength,w=0,k=a;w<k.length;w+=1){var M=k[w];if(0!==M.length){M!==a[0]&&b.push(x.length/2);for(var A=0;A<M.length;A++){var T=M[A];ei(this.layoutVertexArray,T.x,T.y,0,0,1,1,0),x.push(T.x),x.push(T.y)}}}for(var S=ya(x,b),E=0;E<S.length;E+=3)this.indexArray.emplaceBack(_+S[E],_+S[E+1],_+S[E+2]);l.primitiveLength+=S.length/3,l.vertexLength+=i}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t)},pr("FillExtrusionBucket",ri,{omit:["layers"]});var ii={paint:new qr({"fill-extrusion-opacity":new Nr(P["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jr(P["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Nr(P["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Nr(P["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Vr(P["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jr(P["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jr(P["paint_fill-extrusion"]["fill-extrusion-base"])})},oi=function(t){function e(e){t.call(this,e,ii)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new ri(t)},e.prototype.queryRadius=function(){return Kn(this.paint.get("fill-extrusion-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,a,i){return Un(Qn(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,i),r)},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("fill-extrusion-opacity")&&"none"!==this.visibility},e.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},e}(Hr),si=Xr([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,li=ui;function ui(t,e,r,n,a){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=a,t.readFields(ci,this,e)}function ci(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){var r=t.readVarint()+t.pos;for(;t.pos<r;){var n=e._keys[t.readVarint()],a=e._values[t.readVarint()];e.properties[n]=a}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function fi(t){for(var e,r,n=0,a=0,i=t.length,o=i-1;a<i;o=a++)e=t[a],n+=((r=t[o]).x-e.x)*(e.y+r.y);return n}ui.types=["Unknown","Point","LineString","Polygon"],ui.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,n=1,a=0,i=0,o=0,s=[];t.pos<r;){if(a<=0){var u=t.readVarint();n=7&u,a=u>>3}if(a--,1===n||2===n)i+=t.readSVarint(),o+=t.readSVarint(),1===n&&(e&&s.push(e),e=[]),e.push(new l(i,o));else{if(7!==n)throw new Error("unknown command "+n);e&&e.push(e[0].clone())}}return e&&s.push(e),s},ui.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,a=0,i=0,o=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(n<=0){var c=t.readVarint();r=7&c,n=c>>3}if(n--,1===r||2===r)(a+=t.readSVarint())<o&&(o=a),a>s&&(s=a),(i+=t.readSVarint())<l&&(l=i),i>u&&(u=i);else if(7!==r)throw new Error("unknown command "+r)}return[o,l,s,u]},ui.prototype.toGeoJSON=function(t,e,r){var n,a,i=this.extent*Math.pow(2,r),o=this.extent*t,s=this.extent*e,l=this.loadGeometry(),u=ui.types[this.type];function c(t){for(var e=0;e<t.length;e++){var r=t[e],n=180-360*(r.y+s)/i;t[e]=[360*(r.x+o)/i-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(n=0;n<l.length;n++)f[n]=l[n][0];c(l=f);break;case 2:for(n=0;n<l.length;n++)c(l[n]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var r,n,a=[],i=0;i<e;i++){var o=fi(t[i]);0!==o&&(void 0===n&&(n=o<0),n===o<0?(r&&a.push(r),r=[t[i]]):r.push(t[i]))}r&&a.push(r);return a}(l),n=0;n<l.length;n++)for(a=0;a<l[n].length;a++)c(l[n][a])}1===l.length?l=l[0]:u="Multi"+u;var h={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var hi=pi;function pi(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(di,this,e),this.length=this._features.length}function di(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){var e=null,r=t.readVarint()+t.pos;for(;t.pos<r;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(r))}function vi(t,e,r){if(3===t){var n=new hi(r,r.readVarint()+r.pos);n.length&&(e[n.name]=n)}}pi.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new li(this._pbf,e,this.extent,this._keys,this._values)};var gi={VectorTile:function(t,e){this.layers=t.readFields(vi,{},e)},VectorTileFeature:li,VectorTileLayer:hi},mi=gi.VectorTileFeature.types,yi=63,xi=Math.cos(Math.PI/180*37.5),bi=.5,_i=Math.pow(2,14)/bi;function wi(t,e,r,n,a,i,o){t.emplaceBack(e.x,e.y,n?1:0,a?1:-1,Math.round(yi*r.x)+128,Math.round(yi*r.y)+128,1+(0===i?0:i<0?-1:1)|(o*bi&63)<<2,o*bi>>6)}var ki=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new Qr,this.indexArray=new fn,this.programConfigurations=new Pn(si,t.layers,t.zoom),this.segments=new Tn};function Mi(t,e){return(t/e.tileTotal*(e.end-e.start)+e.start)*(_i-1)}ki.prototype.populate=function(t,e){for(var r=0,n=t;r<n.length;r+=1){var a=n[r],i=a.feature,o=a.index,s=a.sourceLayerIndex;if(this.layers[0]._featureFilter(new Lr(this.zoom),i)){var l=Fn(i);this.addFeature(i,l),e.featureIndex.insert(i,l,o,s,this.index)}}},ki.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ki.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,si),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.programConfigurations.upload(t)},ki.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ki.prototype.addFeature=function(t,e){for(var r=this.layers[0].layout,n=r.get("line-join").evaluate(t),a=r.get("line-cap"),i=r.get("line-miter-limit"),o=r.get("line-round-limit"),s=0,l=e;s<l.length;s+=1){var u=l[s];this.addLine(u,t,n,a,i,o)}},ki.prototype.addLine=function(t,e,r,n,a,i){var o=null;e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")&&(o={start:e.properties.mapbox_clip_start,end:e.properties.mapbox_clip_end,tileTotal:void 0});for(var s="Polygon"===mi[e.type],l=t.length;l>=2&&t[l-1].equals(t[l-2]);)l--;for(var u=0;u<l-1&&t[u].equals(t[u+1]);)u++;if(!(l<(s?3:2))){o&&(o.tileTotal=function(t,e,r){for(var n,a,i=0,o=e;o<r-1;o++)n=t[o],a=t[o+1],i+=n.dist(a);return i}(t,u,l)),"bevel"===r&&(a=1.05);var c=Dn/(512*this.overscaling)*15,f=t[u],h=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray);this.distance=0;var p,d,v,g=n,m=s?"butt":n,y=!0,x=void 0,b=void 0,_=void 0,w=void 0;this.e1=this.e2=this.e3=-1,s&&(p=t[l-2],w=f.sub(p)._unit()._perp());for(var k=u;k<l;k++)if(!(b=s&&k===l-1?t[u+1]:t[k+1])||!t[k].equals(b)){w&&(_=w),p&&(x=p),p=t[k],w=b?b.sub(p)._unit()._perp():_;var M=(_=_||w).add(w);0===M.x&&0===M.y||M._unit();var A=M.x*w.x+M.y*w.y,T=0!==A?1/A:1/0,S=A<xi&&x&&b;if(S&&k>u){var E=p.dist(x);if(E>2*c){var C=p.sub(p.sub(x)._mult(c/E)._round());this.distance+=C.dist(x),this.addCurrentVertex(C,this.distance,_.mult(1),0,0,!1,h,o),x=C}}var L=x&&b,I=L?r:b?g:m;if(L&&"round"===I&&(T<i?I="miter":T<=2&&(I="fakeround")),"miter"===I&&T>a&&(I="bevel"),"bevel"===I&&(T>2&&(I="flipbevel"),T<a&&(I="miter")),x&&(this.distance+=p.dist(x)),"miter"===I)M._mult(T),this.addCurrentVertex(p,this.distance,M,0,0,!1,h,o);else if("flipbevel"===I){if(T>100)M=w.clone().mult(-1);else{var z=_.x*w.y-_.y*w.x>0?-1:1,P=T*_.add(w).mag()/_.sub(w).mag();M._perp()._mult(P*z)}this.addCurrentVertex(p,this.distance,M,0,0,!1,h,o),this.addCurrentVertex(p,this.distance,M.mult(-1),0,0,!1,h,o)}else if("bevel"===I||"fakeround"===I){var O=_.x*w.y-_.y*w.x>0,D=-Math.sqrt(T*T-1);if(O?(v=0,d=D):(d=0,v=D),y||this.addCurrentVertex(p,this.distance,_,d,v,!1,h,o),"fakeround"===I){for(var R=Math.floor(8*(.5-(A-.5))),B=void 0,F=0;F<R;F++)B=w.mult((F+1)/(R+1))._add(_)._unit(),this.addPieSliceVertex(p,this.distance,B,O,h,o);this.addPieSliceVertex(p,this.distance,M,O,h,o);for(var N=R-1;N>=0;N--)B=_.mult((N+1)/(R+1))._add(w)._unit(),this.addPieSliceVertex(p,this.distance,B,O,h,o)}b&&this.addCurrentVertex(p,this.distance,w,-d,-v,!1,h,o)}else"butt"===I?(y||this.addCurrentVertex(p,this.distance,_,0,0,!1,h,o),b&&this.addCurrentVertex(p,this.distance,w,0,0,!1,h,o)):"square"===I?(y||(this.addCurrentVertex(p,this.distance,_,1,1,!1,h,o),this.e1=this.e2=-1),b&&this.addCurrentVertex(p,this.distance,w,-1,-1,!1,h,o)):"round"===I&&(y||(this.addCurrentVertex(p,this.distance,_,0,0,!1,h,o),this.addCurrentVertex(p,this.distance,_,1,1,!0,h,o),this.e1=this.e2=-1),b&&(this.addCurrentVertex(p,this.distance,w,-1,-1,!0,h,o),this.addCurrentVertex(p,this.distance,w,0,0,!1,h,o)));if(S&&k<l-1){var j=p.dist(b);if(j>2*c){var V=p.add(b.sub(p)._mult(c/j)._round());this.distance+=V.dist(p),this.addCurrentVertex(V,this.distance,w.mult(1),0,0,!1,h,o),p=V}}y=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e)}},ki.prototype.addCurrentVertex=function(t,e,r,n,a,i,o,s){var l,u=this.layoutVertexArray,c=this.indexArray;s&&(e=Mi(e,s)),l=r.clone(),n&&l._sub(r.perp()._mult(n)),wi(u,t,l,i,!1,n,e),this.e3=o.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),o.primitiveLength++),this.e1=this.e2,this.e2=this.e3,l=r.mult(-1),a&&l._sub(r.perp()._mult(a)),wi(u,t,l,i,!0,-a,e),this.e3=o.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),o.primitiveLength++),this.e1=this.e2,this.e2=this.e3,e>_i/2&&!s&&(this.distance=0,this.addCurrentVertex(t,this.distance,r,n,a,i,o))},ki.prototype.addPieSliceVertex=function(t,e,r,n,a,i){r=r.mult(n?-1:1);var o=this.layoutVertexArray,s=this.indexArray;i&&(e=Mi(e,i)),wi(o,t,r,!1,n,0,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(s.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),n?this.e2=this.e3:this.e1=this.e3},pr("LineBucket",ki,{omit:["layers"]});var Ai=new qr({"line-cap":new Nr(P.layout_line["line-cap"]),"line-join":new jr(P.layout_line["line-join"]),"line-miter-limit":new Nr(P.layout_line["line-miter-limit"]),"line-round-limit":new Nr(P.layout_line["line-round-limit"])}),Ti={paint:new qr({"line-opacity":new jr(P.paint_line["line-opacity"]),"line-color":new jr(P.paint_line["line-color"]),"line-translate":new Nr(P.paint_line["line-translate"]),"line-translate-anchor":new Nr(P.paint_line["line-translate-anchor"]),"line-width":new jr(P.paint_line["line-width"]),"line-gap-width":new jr(P.paint_line["line-gap-width"]),"line-offset":new jr(P.paint_line["line-offset"]),"line-blur":new jr(P.paint_line["line-blur"]),"line-dasharray":new Vr(P.paint_line["line-dasharray"]),"line-pattern":new Vr(P.paint_line["line-pattern"]),"line-gradient":new Ur(P.paint_line["line-gradient"])}),layout:Ai},Si=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(e,r){return r=new Lr(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),t.prototype.possiblyEvaluate.call(this,e,r)},e.prototype.evaluate=function(e,r,n){return r=p({},r,{zoom:Math.floor(r.zoom)}),t.prototype.evaluate.call(this,e,r,n)},e}(jr))(Ti.paint.properties["line-width"].specification);Si.useIntegerZoom=!0;var Ei=function(t){function e(e){t.call(this,e,Ti)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setPaintProperty=function(e,r,n){t.prototype.setPaintProperty.call(this,e,r,n),"line-gradient"===e&&this._updateGradient()},e.prototype._updateGradient=function(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=pa(t,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),this.paint._values["line-floorwidth"]=Si.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new ki(t)},e.prototype.queryRadius=function(t){var e=t,r=Ci(Jn("line-width",this,e),Jn("line-gap-width",this,e)),n=Jn("line-offset",this,e);return r/2+Math.abs(n)+Kn(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,n,a,i){var o=Qn(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,i),s=i/2*Ci(this.paint.get("line-width").evaluate(e),this.paint.get("line-gap-width").evaluate(e)),u=this.paint.get("line-offset").evaluate(e);return u&&(r=function(t,e){for(var r=[],n=new l(0,0),a=0;a<t.length;a++){for(var i=t[a],o=[],s=0;s<i.length;s++){var u=i[s-1],c=i[s],f=i[s+1],h=0===s?n:c.sub(u)._unit()._perp(),p=s===i.length-1?n:f.sub(c)._unit()._perp(),d=h._add(p)._unit(),v=d.x*p.x+d.y*p.y;d._mult(1/v),o.push(d._mult(e)._add(c))}r.push(o)}return r}(r,u*i)),qn(o,r,s)},e}(Hr);function Ci(t,e){return e>0?e+2*t:t}var Li=Xr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),Ii=Xr([{name:"a_projected_pos",components:3,type:"Float32"}],4),zi=(Xr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Xr([{name:"a_placed",components:2,type:"Uint8"}],4)),Pi=(Xr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),Xr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Oi=Xr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);Xr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]),Xr([{type:"Float32",name:"offsetX"}]),Xr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function Di(t,e,r){var n=e.layout.get("text-transform").evaluate(r);return"uppercase"===n?t=t.toLocaleUpperCase():"lowercase"===n&&(t=t.toLocaleLowerCase()),Cr.applyArabicShaping&&(t=Cr.applyArabicShaping(t)),t}var Ri={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var Bi=function(t){function e(e,r,n,a){t.call(this,e,r),this.angle=n,void 0!==a&&(this.segment=a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(l);function Fi(t,e){var r=e.expression;if("constant"===r.kind)return{functionType:"constant",layoutSize:r.evaluate(new Lr(t+1))};if("source"===r.kind)return{functionType:"source"};for(var n=r.zoomStops,a=0;a<n.length&&n[a]<=t;)a++;for(var i=a=Math.max(0,a-1);i<n.length&&n[i]<t+1;)i++;i=Math.min(n.length-1,i);var o={min:n[a],max:n[i]};return"composite"===r.kind?{functionType:"composite",zoomRange:o,propertyValue:e.value}:{functionType:"camera",layoutSize:r.evaluate(new Lr(t+1)),zoomRange:o,sizeRange:{min:r.evaluate(new Lr(o.min)),max:r.evaluate(new Lr(o.max))},propertyValue:e.value}}pr("Anchor",Bi);var Ni=gi.VectorTileFeature.types,ji=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vi(t,e,r,n,a,i,o,s){t.emplaceBack(e,r,Math.round(32*n),Math.round(32*a),i,o,s?s[0]:0,s?s[1]:0)}function Ui(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}var qi=function(t){this.layoutVertexArray=new tn,this.indexArray=new fn,this.programConfigurations=t,this.segments=new Tn,this.dynamicLayoutVertexArray=new en,this.opacityVertexArray=new rn,this.placedSymbolArray=new yn};qi.prototype.upload=function(t,e){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Li.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.programConfigurations.upload(t),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Ii.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,ji,!0),this.opacityVertexBuffer.itemSize=1},qi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},pr("SymbolBuffers",qi);var Hi=function(t,e,r){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new r,this.segments=new Tn,this.collisionVertexArray=new on};Hi.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,zi.members,!0)},Hi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},pr("CollisionBuffers",Hi);var Gi=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex;var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Fi(this.zoom,e["text-size"]),this.iconSizeData=Fi(this.zoom,e["icon-size"]);var r=this.layers[0].layout;this.sortFeaturesByY=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement")};Gi.prototype.createArrays=function(){this.text=new qi(new Pn(Li.members,this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new qi(new Pn(Li.members,this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.collisionBox=new Hi(an,Pi.members,hn),this.collisionCircle=new Hi(an,Oi.members,fn),this.glyphOffsetArray=new bn,this.lineVertexArray=new wn},Gi.prototype.populate=function(t,e){var r=this.layers[0],n=r.layout,a=n.get("text-font"),i=n.get("text-field"),o=n.get("icon-image"),s=("constant"!==i.value.kind||i.value.value.length>0)&&("constant"!==a.value.kind||a.value.value.length>0),l="constant"!==o.value.kind||o.value.value&&o.value.value.length>0;if(this.features=[],s||l){for(var u=e.iconDependencies,c=e.glyphDependencies,f=new Lr(this.zoom),h=0,p=t;h<p.length;h+=1){var d=p[h],v=d.feature,g=d.index,m=d.sourceLayerIndex;if(r._featureFilter(f,v)){var y=void 0;s&&(y=Di(y=r.getValueAndResolveTokens("text-field",v),r,v));var x=void 0;if(l&&(x=r.getValueAndResolveTokens("icon-image",v)),y||x){var b={text:y,icon:x,index:g,sourceLayerIndex:m,geometry:Fn(v),properties:v.properties,type:Ni[v.type]};if(void 0!==v.id&&(b.id=v.id),this.features.push(b),x&&(u[x]=!0),y)for(var _=a.evaluate(v).join(","),w=c[_]=c[_]||{},k="map"===n.get("text-rotation-alignment")&&"line"===n.get("symbol-placement"),M=xr(y),A=0;A<y.length;A++)if(w[y.charCodeAt(A)]=!0,k&&M){var T=Ri[y.charAt(A)];T&&(w[T.charCodeAt(0)]=!0)}}}}"line"===n.get("symbol-placement")&&(this.features=function(t){var e={},r={},n=[],a=0;function i(e){n.push(t[e]),a++}function o(t,e,a){var i=r[t];return delete r[t],r[e]=i,n[i].geometry[0].pop(),n[i].geometry[0]=n[i].geometry[0].concat(a[0]),i}function s(t,r,a){var i=e[r];return delete e[r],e[t]=i,n[i].geometry[0].shift(),n[i].geometry[0]=a[0].concat(n[i].geometry[0]),i}function l(t,e,r){var n=r?e[0][e[0].length-1]:e[0][0];return t+":"+n.x+":"+n.y}for(var u=0;u<t.length;u++){var c=t[u],f=c.geometry,h=c.text;if(h){var p=l(h,f),d=l(h,f,!0);if(p in r&&d in e&&r[p]!==e[d]){var v=s(p,d,f),g=o(p,d,n[v].geometry);delete e[p],delete r[d],r[l(h,n[g].geometry,!0)]=g,n[v].geometry=null}else p in r?o(p,d,f):d in e?s(p,d,f):(i(u),e[p]=a-1,r[d]=a-1)}else i(u)}return n.filter(function(t){return t.geometry})}(this.features))}},Gi.prototype.isEmpty=function(){return 0===this.symbolInstances.length},Gi.prototype.upload=function(t){this.text.upload(t,this.sortFeaturesByY),this.icon.upload(t,this.sortFeaturesByY),this.collisionBox.upload(t),this.collisionCircle.upload(t)},Gi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},Gi.prototype.addToLineVertexArray=function(t,e){var r=this.lineVertexArray.length;if(void 0!==t.segment){for(var n=t.dist(e[t.segment+1]),a=t.dist(e[t.segment]),i={},o=t.segment+1;o<e.length;o++)i[o]={x:e[o].x,y:e[o].y,tileUnitDistanceFromAnchor:n},o<e.length-1&&(n+=e[o+1].dist(e[o]));for(var s=t.segment||0;s>=0;s--)i[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:a},s>0&&(a+=e[s-1].dist(e[s]));for(var l=0;l<e.length;l++){var u=i[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},Gi.prototype.addSymbols=function(t,e,r,n,a,i,o,s,l,u){for(var c=t.indexArray,f=t.layoutVertexArray,h=t.dynamicLayoutVertexArray,p=t.segments.prepareSegment(4*e.length,t.layoutVertexArray,t.indexArray),d=this.glyphOffsetArray.length,v=p.vertexLength,g=0,m=e;g<m.length;g+=1){var y=m[g],x=y.tl,b=y.tr,_=y.bl,w=y.br,k=y.tex,M=p.vertexLength,A=y.glyphOffset[1];Vi(f,s.x,s.y,x.x,A+x.y,k.x,k.y,r),Vi(f,s.x,s.y,b.x,A+b.y,k.x+k.w,k.y,r),Vi(f,s.x,s.y,_.x,A+_.y,k.x,k.y+k.h,r),Vi(f,s.x,s.y,w.x,A+w.y,k.x+k.w,k.y+k.h,r),Ui(h,s,0),c.emplaceBack(M,M+1,M+2),c.emplaceBack(M+1,M+2,M+3),p.vertexLength+=4,p.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(y.glyphOffset[0])}t.placedSymbolArray.emplaceBack(s.x,s.y,d,this.glyphOffsetArray.length-d,v,l,u,s.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],o,!1),t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,i)},Gi.prototype._addCollisionDebugVertex=function(t,e,r,n,a){return e.emplaceBack(0,0),t.emplaceBack(r.x,r.y,n.x,n.y,Math.round(a.x),Math.round(a.y))},Gi.prototype.addCollisionDebugVertices=function(t,e,r,n,a,i,o,s){var u=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),c=u.vertexLength,f=a.layoutVertexArray,h=a.collisionVertexArray;if(this._addCollisionDebugVertex(f,h,i,o.anchor,new l(t,e)),this._addCollisionDebugVertex(f,h,i,o.anchor,new l(r,e)),this._addCollisionDebugVertex(f,h,i,o.anchor,new l(r,n)),this._addCollisionDebugVertex(f,h,i,o.anchor,new l(t,n)),u.vertexLength+=4,s){var p=a.indexArray;p.emplaceBack(c,c+1,c+2),p.emplaceBack(c,c+2,c+3),u.primitiveLength+=2}else{var d=a.indexArray;d.emplaceBack(c,c+1),d.emplaceBack(c+1,c+2),d.emplaceBack(c+2,c+3),d.emplaceBack(c+3,c),u.primitiveLength+=4}},Gi.prototype.generateCollisionDebugBuffers=function(){for(var t=0,e=this.symbolInstances;t<e.length;t+=1){var r=e[t];r.textCollisionFeature={boxStartIndex:r.textBoxStartIndex,boxEndIndex:r.textBoxEndIndex},r.iconCollisionFeature={boxStartIndex:r.iconBoxStartIndex,boxEndIndex:r.iconBoxEndIndex};for(var n=0;n<2;n++){var a=r[0===n?"textCollisionFeature":"iconCollisionFeature"];if(a)for(var i=a.boxStartIndex;i<a.boxEndIndex;i++){var o=this.collisionBoxArray.get(i),s=o.x1,l=o.y1,u=o.x2,c=o.y2,f=o.radius>0;this.addCollisionDebugVertices(s,l,u,c,f?this.collisionCircle:this.collisionBox,o.anchorPoint,r,f)}}}},Gi.prototype.deserializeCollisionBoxes=function(t,e,r,n,a){for(var i={},o=e;o<r;o++){var s=t.get(o);if(0===s.radius){i.textBox={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,anchorPointX:s.anchorPointX,anchorPointY:s.anchorPointY},i.textFeatureIndex=s.featureIndex;break}i.textCircles||(i.textCircles=[],i.textFeatureIndex=s.featureIndex);i.textCircles.push(s.anchorPointX,s.anchorPointY,s.radius,s.signedDistanceFromAnchor,1)}for(var l=n;l<a;l++){var u=t.get(l);if(0===u.radius){i.iconBox={x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,anchorPointX:u.anchorPointX,anchorPointY:u.anchorPointY},i.iconFeatureIndex=u.featureIndex;break}}return i},Gi.prototype.hasTextData=function(){return this.text.segments.get().length>0},Gi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Gi.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},Gi.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},Gi.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&(this.sortedAngle=t,!(this.text.segments.get().length>1||this.icon.segments.get().length>1))){for(var r=[],n=0;n<this.symbolInstances.length;n++)r.push(n);var a=Math.sin(t),i=Math.cos(t);r.sort(function(t,r){var n=e.symbolInstances[t],o=e.symbolInstances[r];return(a*n.anchor.x+i*n.anchor.y|0)-(a*o.anchor.x+i*o.anchor.y|0)||o.featureIndex-n.featureIndex}),this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var o=0,s=r;o<s.length;o+=1){var l=s[o],u=e.symbolInstances[l];e.featureSortOrder.push(u.featureIndex);for(var c=0,f=u.placedTextSymbolIndices;c<f.length;c+=1)for(var h=f[c],p=e.text.placedSymbolArray.get(h),d=p.vertexStartIndex+4*p.numGlyphs,v=p.vertexStartIndex;v<d;v+=4)e.text.indexArray.emplaceBack(v,v+1,v+2),e.text.indexArray.emplaceBack(v+1,v+2,v+3);var g=e.icon.placedSymbolArray.get(l);if(g.numGlyphs){var m=g.vertexStartIndex;e.icon.indexArray.emplaceBack(m,m+1,m+2),e.icon.indexArray.emplaceBack(m+1,m+2,m+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},pr("SymbolBucket",Gi,{omit:["layers","collisionBoxArray","features","compareText"],shallow:["symbolInstances"]}),Gi.MAX_GLYPHS=65535,Gi.addDynamicAttributes=Ui;var Wi=new qr({"symbol-placement":new Nr(P.layout_symbol["symbol-placement"]),"symbol-spacing":new Nr(P.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Nr(P.layout_symbol["symbol-avoid-edges"]),"icon-allow-overlap":new Nr(P.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Nr(P.layout_symbol["icon-ignore-placement"]),"icon-optional":new Nr(P.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Nr(P.layout_symbol["icon-rotation-alignment"]),"icon-size":new jr(P.layout_symbol["icon-size"]),"icon-text-fit":new Nr(P.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Nr(P.layout_symbol["icon-text-fit-padding"]),"icon-image":new jr(P.layout_symbol["icon-image"]),"icon-rotate":new jr(P.layout_symbol["icon-rotate"]),"icon-padding":new Nr(P.layout_symbol["icon-padding"]),"icon-keep-upright":new Nr(P.layout_symbol["icon-keep-upright"]),"icon-offset":new jr(P.layout_symbol["icon-offset"]),"icon-anchor":new jr(P.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Nr(P.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Nr(P.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Nr(P.layout_symbol["text-rotation-alignment"]),"text-field":new jr(P.layout_symbol["text-field"]),"text-font":new jr(P.layout_symbol["text-font"]),"text-size":new jr(P.layout_symbol["text-size"]),"text-max-width":new jr(P.layout_symbol["text-max-width"]),"text-line-height":new Nr(P.layout_symbol["text-line-height"]),"text-letter-spacing":new jr(P.layout_symbol["text-letter-spacing"]),"text-justify":new jr(P.layout_symbol["text-justify"]),"text-anchor":new jr(P.layout_symbol["text-anchor"]),"text-max-angle":new Nr(P.layout_symbol["text-max-angle"]),"text-rotate":new jr(P.layout_symbol["text-rotate"]),"text-padding":new Nr(P.layout_symbol["text-padding"]),"text-keep-upright":new Nr(P.layout_symbol["text-keep-upright"]),"text-transform":new jr(P.layout_symbol["text-transform"]),"text-offset":new jr(P.layout_symbol["text-offset"]),"text-allow-overlap":new Nr(P.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Nr(P.layout_symbol["text-ignore-placement"]),"text-optional":new Nr(P.layout_symbol["text-optional"])}),Yi={paint:new qr({"icon-opacity":new jr(P.paint_symbol["icon-opacity"]),"icon-color":new jr(P.paint_symbol["icon-color"]),"icon-halo-color":new jr(P.paint_symbol["icon-halo-color"]),"icon-halo-width":new jr(P.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jr(P.paint_symbol["icon-halo-blur"]),"icon-translate":new Nr(P.paint_symbol["icon-translate"]),"icon-translate-anchor":new Nr(P.paint_symbol["icon-translate-anchor"]),"text-opacity":new jr(P.paint_symbol["text-opacity"]),"text-color":new jr(P.paint_symbol["text-color"]),"text-halo-color":new jr(P.paint_symbol["text-halo-color"]),"text-halo-width":new jr(P.paint_symbol["text-halo-width"]),"text-halo-blur":new jr(P.paint_symbol["text-halo-blur"]),"text-translate":new Nr(P.paint_symbol["text-translate"]),"text-translate-anchor":new Nr(P.paint_symbol["text-translate-anchor"])}),layout:Wi},Xi=function(t){function e(e){t.call(this,e,Yi)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),"auto"===this.layout.get("icon-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},e.prototype.getValueAndResolveTokens=function(t,e){var r,n=this.layout.get(t).evaluate(e),a=this._unevaluatedLayout._values[t];return a.isDataDriven()||_e(a.value)?n:(r=e.properties,n.replace(/{([^{}]+)}/g,function(t,e){return e in r?String(r[e]):""}))},e.prototype.createBucket=function(t){return new Gi(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e}(Hr),Zi={paint:new qr({"background-color":new Nr(P.paint_background["background-color"]),"background-pattern":new Vr(P.paint_background["background-pattern"]),"background-opacity":new Nr(P.paint_background["background-opacity"])})},$i=function(t){function e(e){t.call(this,e,Zi)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Hr),Ji={paint:new qr({"raster-opacity":new Nr(P.paint_raster["raster-opacity"]),"raster-hue-rotate":new Nr(P.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Nr(P.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Nr(P.paint_raster["raster-brightness-max"]),"raster-saturation":new Nr(P.paint_raster["raster-saturation"]),"raster-contrast":new Nr(P.paint_raster["raster-contrast"]),"raster-fade-duration":new Nr(P.paint_raster["raster-fade-duration"])})},Ki={circle:aa,heatmap:da,hillshade:ga,fill:Ka,"fill-extrusion":oi,line:Ei,symbol:Xi,background:$i,raster:function(t){function e(e){t.call(this,e,Ji)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Hr)};var Qi=a(function(t,e){t.exports=function(){function t(t,e,r){r=r||{},this.w=t||64,this.h=e||64,this.autoResize=!!r.autoResize,this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0}function e(t,e,r){this.x=0,this.y=t,this.w=this.free=e,this.h=r}return t.prototype.pack=function(t,e){t=[].concat(t),e=e||{};for(var r,n,a,i,o=[],s=0;s<t.length;s++)if(r=t[s].w||t[s].width,n=t[s].h||t[s].height,a=t[s].id,r&&n){if(!(i=this.packOne(r,n,a)))continue;e.inPlace&&(t[s].x=i.x,t[s].y=i.y,t[s].id=i.id),o.push(i)}return this.shrink(),o},t.prototype.packOne=function(t,r,n){var a,i,o,s,l,u,c,f,h={freebin:-1,shelf:-1,waste:1/0},p=0;if("string"==typeof n||"number"==typeof n){if(a=this.getBin(n))return this.ref(a),a;"number"==typeof n&&(this.maxId=Math.max(n,this.maxId))}else n=++this.maxId;for(s=0;s<this.freebins.length;s++){if(r===(a=this.freebins[s]).maxh&&t===a.maxw)return this.allocFreebin(s,t,r,n);r>a.maxh||t>a.maxw||r<=a.maxh&&t<=a.maxw&&(o=a.maxw*a.maxh-t*r)<h.waste&&(h.waste=o,h.freebin=s)}for(s=0;s<this.shelves.length;s++)if(p+=(i=this.shelves[s]).h,!(t>i.free)){if(r===i.h)return this.allocShelf(s,t,r,n);r>i.h||r<i.h&&(o=(i.h-r)*t)<h.waste&&(h.freebin=-1,h.waste=o,h.shelf=s)}return-1!==h.freebin?this.allocFreebin(h.freebin,t,r,n):-1!==h.shelf?this.allocShelf(h.shelf,t,r,n):r<=this.h-p&&t<=this.w?(i=new e(p,this.w,r),this.allocShelf(this.shelves.push(i)-1,t,r,n)):this.autoResize?(l=u=this.h,((c=f=this.w)<=l||t>c)&&(f=2*Math.max(t,c)),(l<c||r>l)&&(u=2*Math.max(r,l)),this.resize(f,u),this.packOne(t,r,n)):null},t.prototype.allocFreebin=function(t,e,r,n){var a=this.freebins.splice(t,1)[0];return a.id=n,a.w=e,a.h=r,a.refcount=0,this.bins[n]=a,this.ref(a),a},t.prototype.allocShelf=function(t,e,r,n){var a=this.shelves[t].alloc(e,r,n);return this.bins[n]=a,this.ref(a),a},t.prototype.shrink=function(){if(this.shelves.length>0){for(var t=0,e=0,r=0;r<this.shelves.length;r++){var n=this.shelves[r];e+=n.h,t=Math.max(n.w-n.free,t)}this.resize(t,e)}},t.prototype.getBin=function(t){return this.bins[t]},t.prototype.ref=function(t){if(1==++t.refcount){var e=t.h;this.stats[e]=1+(0|this.stats[e])}return t.refcount},t.prototype.unref=function(t){return 0===t.refcount?0:(0==--t.refcount&&(this.stats[t.h]--,delete this.bins[t.id],this.freebins.push(t)),t.refcount)},t.prototype.clear=function(){this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0},t.prototype.resize=function(t,e){this.w=t,this.h=e;for(var r=0;r<this.shelves.length;r++)this.shelves[r].resize(t);return!0},e.prototype.alloc=function(t,e,r){if(t>this.free||e>this.h)return null;var n=this.x;return this.x+=t,this.free-=t,new function(t,e,r,n,a,i,o){this.id=t,this.x=e,this.y=r,this.w=n,this.h=a,this.maxw=i||n,this.maxh=o||a,this.refcount=0}(r,n,this.y,t,e,t,this.h)},e.prototype.resize=function(t){return this.free+=t-this.w,this.w=t,!0},t}()}),to=function(t,e){var r=e.pixelRatio;this.paddedRect=t,this.pixelRatio=r},eo={tl:{configurable:!0},br:{configurable:!0},displaySize:{configurable:!0}};eo.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},eo.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},eo.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(to.prototype,eo);var ro=function(t){var e=new fa({width:0,height:0}),r={},n=new Qi(0,0,{autoResize:!0});for(var a in t){var i=t[a],o=n.packOne(i.data.width+2,i.data.height+2);e.resize({width:n.w,height:n.h}),fa.copy(i.data,e,{x:0,y:0},{x:o.x+1,y:o.y+1},i.data),r[a]=new to(o,i)}n.shrink(),e.resize({width:n.w,height:n.h}),this.image=e,this.positions=r};pr("ImagePosition",to),pr("ImageAtlas",ro);var no=function(t,e,r,n,a){var i,o,s=8*a-n-1,l=(1<<s)-1,u=l>>1,c=-7,f=r?a-1:0,h=r?-1:1,p=t[e+f];for(f+=h,i=p&(1<<-c)-1,p>>=-c,c+=s;c>0;i=256*i+t[e+f],f+=h,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=n;c>0;o=256*o+t[e+f],f+=h,c-=8);if(0===i)i=1-u;else{if(i===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),i-=u}return(p?-1:1)*o*Math.pow(2,i-n)},ao=function(t,e,r,n,a,i){var o,s,l,u=8*i-a-1,c=(1<<u)-1,f=c>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,d=n?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+f>=1?h/l:h*Math.pow(2,1-f))*l>=2&&(o++,l/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(e*l-1)*Math.pow(2,a),o+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,a),o=0));a>=8;t[r+p]=255&s,p+=d,s/=256,a-=8);for(o=o<<a|s,u+=a;u>0;t[r+p]=255&o,p+=d,o/=256,u-=8);t[r+p-d]|=128*v},io=oo;function oo(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}oo.Varint=0,oo.Fixed64=1,oo.Bytes=2,oo.Fixed32=5;function so(t){return t.type===oo.Bytes?t.readVarint()+t.pos:t.pos+1}function lo(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function uo(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var a=r.pos-1;a>=t;a--)r.buf[a+n]=r.buf[a]}function co(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function fo(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function ho(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function po(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function vo(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function go(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function mo(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function yo(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function xo(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function bo(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function _o(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function wo(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}oo.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),a=n>>3,i=this.pos;this.type=7&n,t(a,e,this),this.pos===i&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=bo(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=wo(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=bo(this.buf,this.pos)+4294967296*bo(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=bo(this.buf,this.pos)+4294967296*wo(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=no(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=no(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,n=this.buf;return e=127&(r=n[this.pos++]),r<128?e:(e|=(127&(r=n[this.pos++]))<<7,r<128?e:(e|=(127&(r=n[this.pos++]))<<14,r<128?e:(e|=(127&(r=n[this.pos++]))<<21,r<128?e:function(t,e,r){var n,a,i=r.buf;if(a=i[r.pos++],n=(112&a)>>4,a<128)return lo(t,n,e);if(a=i[r.pos++],n|=(127&a)<<3,a<128)return lo(t,n,e);if(a=i[r.pos++],n|=(127&a)<<10,a<128)return lo(t,n,e);if(a=i[r.pos++],n|=(127&a)<<17,a<128)return lo(t,n,e);if(a=i[r.pos++],n|=(127&a)<<24,a<128)return lo(t,n,e);if(a=i[r.pos++],n|=(1&a)<<31,a<128)return lo(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,r){var n="",a=e;for(;a<r;){var i,o,s,l=t[a],u=null,c=l>239?4:l>223?3:l>191?2:1;if(a+c>r)break;1===c?l<128&&(u=l):2===c?128==(192&(i=t[a+1]))&&(u=(31&l)<<6|63&i)<=127&&(u=null):3===c?(i=t[a+1],o=t[a+2],128==(192&i)&&128==(192&o)&&((u=(15&l)<<12|(63&i)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(i=t[a+1],o=t[a+2],s=t[a+3],128==(192&i)&&128==(192&o)&&128==(192&s)&&((u=(15&l)<<18|(63&i)<<12|(63&o)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),a+=c}return n}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var r=so(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=so(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=so(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=so(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=so(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=so(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=so(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=so(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=so(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===oo.Varint)for(;this.buf[this.pos++]>127;);else if(e===oo.Bytes)this.pos=this.readVarint()+this.pos;else if(e===oo.Fixed32)this.pos+=4;else{if(e!==oo.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),_o(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),_o(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),_o(this.buf,-1&t,this.pos),_o(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),_o(this.buf,-1&t,this.pos),_o(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,n;t>=0?(r=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,n=n+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}(r,0,e),function(t,e){var r=(7&t)<<4;if(e.buf[e.pos++]|=r|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var n,a,i=0;i<e.length;i++){if((n=e.charCodeAt(i))>55295&&n<57344){if(!a){n>56319||i+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):a=n;continue}if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,a=n;continue}n=a-55296<<10|n-56320|65536,a=null}else a&&(t[r++]=239,t[r++]=191,t[r++]=189,a=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=63&n|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&uo(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),ao(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ao(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&uo(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,oo.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){this.writeMessage(t,co,e)},writePackedSVarint:function(t,e){this.writeMessage(t,fo,e)},writePackedBoolean:function(t,e){this.writeMessage(t,vo,e)},writePackedFloat:function(t,e){this.writeMessage(t,ho,e)},writePackedDouble:function(t,e){this.writeMessage(t,po,e)},writePackedFixed32:function(t,e){this.writeMessage(t,go,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,mo,e)},writePackedFixed64:function(t,e){this.writeMessage(t,yo,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,xo,e)},writeBytesField:function(t,e){this.writeTag(t,oo.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,oo.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,oo.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,oo.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,oo.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,oo.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,oo.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,oo.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,oo.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,oo.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var ko=3;function Mo(t,e,r){1===t&&r.readMessage(Ao,e)}function Ao(t,e,r){if(3===t){var n=r.readMessage(To,{}),a=n.id,i=n.bitmap,o=n.width,s=n.height,l=n.left,u=n.top,c=n.advance;e.push({id:a,bitmap:new ca({width:o+2*ko,height:s+2*ko},i),metrics:{width:o,height:s,left:l,top:u,advance:c}})}}function To(t,e,r){1===t?e.id=r.readVarint():2===t?e.bitmap=r.readBytes():3===t?e.width=r.readVarint():4===t?e.height=r.readVarint():5===t?e.left=r.readSVarint():6===t?e.top=r.readSVarint():7===t&&(e.advance=r.readVarint())}var So=ko,Eo=function(t,e,r){this.target=t,this.parent=e,this.mapId=r,this.callbacks={},this.callbackID=0,v(["receive"],this),this.target.addEventListener("message",this.receive,!1)};Eo.prototype.send=function(t,e,r,n){var a=r?this.mapId+":"+this.callbackID++:null;r&&(this.callbacks[a]=r);var i=[];this.target.postMessage({targetMapId:n,sourceMapId:this.mapId,type:t,id:String(a),data:vr(e,i)},i)},Eo.prototype.receive=function(t){var e,r=this,n=t.data,a=n.id;if(!n.targetMapId||this.mapId===n.targetMapId){var i=function(t,e){var n=[];r.target.postMessage({sourceMapId:r.mapId,type:"<response>",id:String(a),error:t?vr(t):null,data:vr(e,n)},n)};if("<response>"===n.type)e=this.callbacks[n.id],delete this.callbacks[n.id],e&&n.error?e(gr(n.error)):e&&e(null,gr(n.data));else if(void 0!==n.id&&this.parent[n.type])this.parent[n.type](n.sourceMapId,gr(n.data),i);else if(void 0!==n.id&&this.parent.getWorkerSource){var o=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,o[0],o[1])[o[2]](gr(n.data),i)}else this.parent[n.type](gr(n.data))}},Eo.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var Co=n(a(function(t,e){!function(t){function e(t,e,n){e=Math.pow(2,n)-e-1;var a=r(256*t,256*e,n),i=r(256*(t+1),256*(e+1),n);return a[0]+","+a[1]+","+i[0]+","+i[1]}function r(t,e,r){var n=2*Math.PI*6378137/256/Math.pow(2,r),a=t*n-2*Math.PI*6378137/2,i=e*n-2*Math.PI*6378137/2;return[a,i]}t.getURL=function(t,r,n,a,i,o){return o=o||{},t+"?"+["bbox="+e(n,a,i),"format="+(o.format||"image/png"),"service="+(o.service||"WMS"),"version="+(o.version||"1.1.1"),"request="+(o.request||"GetMap"),"srs="+(o.srs||"EPSG:3857"),"width="+(o.width||256),"height="+(o.height||256),"layers="+r].join("&")},t.getTileBBox=e,t.getMercCoords=r,Object.defineProperty(t,"__esModule",{value:!0})}(e)})),Lo=function(t,e,r){this.z=t,this.x=e,this.y=r,this.key=Po(0,t,e,r)};Lo.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Lo.prototype.url=function(t,e){var r=Co.getTileBBox(this.x,this.y,this.z),n=function(t,e,r){for(var n,a="",i=t;i>0;i--)a+=(e&(n=1<<i-1)?1:0)+(r&n?2:0);return a}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",n).replace("{bbox-epsg-3857}",r)};var Io=function(t,e){this.wrap=t,this.canonical=e,this.key=Po(t,e.z,e.x,e.y)},zo=function(t,e,r,n,a){this.overscaledZ=t,this.wrap=e,this.canonical=new Lo(r,+n,+a),this.key=Po(e,t,n,a)};function Po(t,e,r,n){(t*=2)<0&&(t=-1*t-1);var a=1<<e;return 32*(a*a*t+a*n+r)+e}zo.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},zo.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new zo(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new zo(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},zo.prototype.isChildOf=function(t){var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},zo.prototype.children=function(t){if(this.overscaledZ>=t)return[new zo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new zo(e,this.wrap,e,r,n),new zo(e,this.wrap,e,r+1,n),new zo(e,this.wrap,e,r,n+1),new zo(e,this.wrap,e,r+1,n+1)]},zo.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},zo.prototype.wrapped=function(){return new zo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},zo.prototype.unwrapTo=function(t){return new zo(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},zo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},zo.prototype.toUnwrapped=function(){return new Io(this.wrap,this.canonical)},zo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},zo.prototype.toCoordinate=function(){return new s(this.canonical.x+Math.pow(2,this.wrap),this.canonical.y,this.canonical.z)},pr("CanonicalTileID",Lo),pr("OverscaledTileID",zo,{omit:["posMatrix"]});var Oo=function(t,e,r){if(t<=0)throw new RangeError("Level must have positive dimension");this.dim=t,this.border=e,this.stride=this.dim+2*this.border,this.data=r||new Int32Array((this.dim+2*this.border)*(this.dim+2*this.border))};Oo.prototype.set=function(t,e,r){this.data[this._idx(t,e)]=r+65536},Oo.prototype.get=function(t,e){return this.data[this._idx(t,e)]-65536},Oo.prototype._idx=function(t,e){if(t<-this.border||t>=this.dim+this.border||e<-this.border||e>=this.dim+this.border)throw new RangeError("out of range source coordinates for DEM data");return(e+this.border)*this.stride+(t+this.border)},pr("Level",Oo);var Do=function(t,e,r){this.uid=t,this.scale=e||1,this.level=r||new Oo(256,512),this.loaded=!!r};Do.prototype.loadFromImage=function(t,e){if(t.height!==t.width)throw new RangeError("DEM tiles must be square");if(e&&"mapbox"!==e&&"terrarium"!==e)return _('"'+e+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');var r=this.level=new Oo(t.width,t.width/2),n=t.data;this._unpackData(r,n,e||"mapbox");for(var a=0;a<r.dim;a++)r.set(-1,a,r.get(0,a)),r.set(r.dim,a,r.get(r.dim-1,a)),r.set(a,-1,r.get(a,0)),r.set(a,r.dim,r.get(a,r.dim-1));r.set(-1,-1,r.get(0,0)),r.set(r.dim,-1,r.get(r.dim-1,0)),r.set(-1,r.dim,r.get(0,r.dim-1)),r.set(r.dim,r.dim,r.get(r.dim-1,r.dim-1)),this.loaded=!0},Do.prototype._unpackMapbox=function(t,e,r){return(256*t*256+256*e+r)/10-1e4},Do.prototype._unpackTerrarium=function(t,e,r){return 256*t+e+r/256-32768},Do.prototype._unpackData=function(t,e,r){for(var n={mapbox:this._unpackMapbox,terrarium:this._unpackTerrarium}[r],a=0;a<t.dim;a++)for(var i=0;i<t.dim;i++){var o=4*(a*t.dim+i);t.set(i,a,this.scale*n(e[o],e[o+1],e[o+2]))}},Do.prototype.getPixels=function(){return new fa({width:this.level.dim+2*this.level.border,height:this.level.dim+2*this.level.border},new Uint8Array(this.level.data.buffer))},Do.prototype.backfillBorder=function(t,e,r){var n=this.level,a=t.level;if(n.dim!==a.dim)throw new Error("level mismatch (dem dimension)");var i=e*n.dim,o=e*n.dim+n.dim,s=r*n.dim,l=r*n.dim+n.dim;switch(e){case-1:i=o-1;break;case 1:o=i+1}switch(r){case-1:s=l-1;break;case 1:l=s+1}for(var u=h(i,-n.border,n.dim+n.border),c=h(o,-n.border,n.dim+n.border),f=h(s,-n.border,n.dim+n.border),p=h(l,-n.border,n.dim+n.border),d=-e*n.dim,v=-r*n.dim,g=f;g<p;g++)for(var m=u;m<c;m++)n.set(m,g,a.get(m+d,g+v))},pr("DEMData",Do);var Ro=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var r=t[e];this._stringToNumber[r]=e,this._numberToString[e]=r}};Ro.prototype.encode=function(t){return this._stringToNumber[t]},Ro.prototype.decode=function(t){return this._numberToString[t]};var Bo=function(t,e,r,n){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=r,t._y=n,this.properties=t.properties,null!=t.id&&(this.id=t.id)},Fo={geometry:{configurable:!0}};Fo.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Fo.geometry.set=function(t){this._geometry=t},Bo.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Bo.prototype,Fo);var No=function(t,e,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=e||new lr(Dn,16,0),this.featureIndexArray=r||new Mn};function jo(t,e){return e-t}No.prototype.insert=function(t,e,r,n,a){var i=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,a);for(var o=0;o<e.length;o++){for(var s=e[o],l=[1/0,1/0,-1/0,-1/0],u=0;u<s.length;u++){var c=s[u];l[0]=Math.min(l[0],c.x),l[1]=Math.min(l[1],c.y),l[2]=Math.max(l[2],c.x),l[3]=Math.max(l[3],c.y)}l[0]<Dn&&l[1]<Dn&&l[2]>=0&&l[3]>=0&&this.grid.insert(i,l[0],l[1],l[2],l[3])}},No.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new gi.VectorTile(new io(this.rawTileData)).layers,this.sourceLayerCoder=new Ro(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},No.prototype.query=function(t,e){var r=this;this.loadVTLayers();for(var n=t.params||{},a=Dn/t.tileSize/t.scale,i=Re(n.filter),o=t.queryGeometry,s=t.queryPadding*a,l=1/0,u=1/0,c=-1/0,f=-1/0,h=0;h<o.length;h++)for(var p=o[h],d=0;d<p.length;d++){var v=p[d];l=Math.min(l,v.x),u=Math.min(u,v.y),c=Math.max(c,v.x),f=Math.max(f,v.y)}var g=this.grid.query(l-s,u-s,c+s,f+s);g.sort(jo);for(var m,y={},x=function(s){var l=g[s];if(l!==m){m=l;var u=r.featureIndexArray.get(l),c=null;r.loadMatchingFeature(y,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,i,n.layers,e,function(e,n){return c||(c=Fn(e)),n.queryIntersectsFeature(o,e,c,r.z,t.transform,a,t.posMatrix)})}},b=0;b<g.length;b++)x(b);return y},No.prototype.loadMatchingFeature=function(t,e,r,n,a,i,o,s){var l=this.bucketLayerIDs[e];if(!i||function(t,e){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1}(i,l)){var u=this.sourceLayerCoder.decode(r),c=this.vtLayers[u].feature(n);if(a(new Lr(this.tileID.overscaledZ),c))for(var f=0;f<l.length;f++){var h=l[f];if(!(i&&i.indexOf(h)<0)){var p=o[h];if(p&&(!s||s(c,p))){var d=new Bo(c,this.z,this.x,this.y);d.layer=p.serialize();var v=t[h];void 0===v&&(v=t[h]=[]),v.push({featureIndex:n,feature:d})}}}}},No.prototype.lookupSymbolFeatures=function(t,e,r,n,a,i){var o={};this.loadVTLayers();for(var s=Re(n),l=0,u=t;l<u.length;l+=1){var c=u[l];this.loadMatchingFeature(o,e,r,c,s,a,i)}return o},No.prototype.hasLayer=function(t){for(var e=0,r=this.bucketLayerIDs;e<r.length;e+=1)for(var n=0,a=r[e];n<a.length;n+=1){if(t===a[n])return!0}return!1},pr("FeatureIndex",No,{omit:["rawTileData","sourceLayerCoder"]});var Vo={horizontal:1,vertical:2,horizontalOnly:3};var Uo={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},qo={};function Ho(t,e,r,n){var a=Math.pow(t-e,2);return n?t<e?a/2:2*a:a+Math.abs(r)*r}function Go(t,e){var r=0;return 10===t&&(r-=1e4),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function Wo(t,e,r,n,a,i){for(var o=null,s=Ho(e,r,a,i),l=0,u=n;l<u.length;l+=1){var c=u[l],f=Ho(e-c.x,r,a,i)+c.badness;f<=s&&(o=c,s=f)}return{index:t,x:e,priorBreak:o,badness:s}}function Yo(t,e,r,n){if(!r)return[];if(!t)return[];for(var a,i=[],o=function(t,e,r,n){for(var a=0,i=0;i<t.length;i++){var o=n[t.charCodeAt(i)];o&&(a+=o.metrics.advance+e)}return a/Math.max(1,Math.ceil(a/r))}(t,e,r,n),s=0,l=0;l<t.length;l++){var u=t.charCodeAt(l),c=n[u];c&&!Uo[u]&&(s+=c.metrics.advance+e),l<t.length-1&&(qo[u]||!((a=u)<11904)&&(yr["Bopomofo Extended"](a)||yr.Bopomofo(a)||yr["CJK Compatibility Forms"](a)||yr["CJK Compatibility Ideographs"](a)||yr["CJK Compatibility"](a)||yr["CJK Radicals Supplement"](a)||yr["CJK Strokes"](a)||yr["CJK Symbols and Punctuation"](a)||yr["CJK Unified Ideographs Extension A"](a)||yr["CJK Unified Ideographs"](a)||yr["Enclosed CJK Letters and Months"](a)||yr["Halfwidth and Fullwidth Forms"](a)||yr.Hiragana(a)||yr["Ideographic Description Characters"](a)||yr["Kangxi Radicals"](a)||yr["Katakana Phonetic Extensions"](a)||yr.Katakana(a)||yr["Vertical Forms"](a)||yr["Yi Radicals"](a)||yr["Yi Syllables"](a)))&&i.push(Wo(l+1,s,o,i,Go(u,t.charCodeAt(l+1)),!1))}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Wo(t.length,s,o,i,0,!0))}function Xo(t){var e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Zo(t,e,r,n,a){if(a){var i=e[t[n].glyph];if(i)for(var o=i.metrics.advance,s=(t[n].x+o)*a,l=r;l<=n;l++)t[l].x-=s}}qo[10]=!0,qo[32]=!0,qo[38]=!0,qo[40]=!0,qo[41]=!0,qo[43]=!0,qo[45]=!0,qo[47]=!0,qo[173]=!0,qo[183]=!0,qo[8203]=!0,qo[8208]=!0,qo[8211]=!0,qo[8231]=!0,t.commonjsGlobal=r,t.unwrapExports=n,t.createCommonjsModule=a,t.default=self,t.default$1=l,t.getJSON=function(t,e){var r=T(t);return r.setRequestHeader("Accept","application/json"),r.onerror=function(){e(new Error(r.statusText))},r.onload=function(){if(r.status>=200&&r.status<300&&r.response){var n;try{n=JSON.parse(r.response)}catch(t){return e(t)}e(null,n)}else 401===r.status&&t.url.match(/mapbox.com/)?e(new A(r.statusText+": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens",r.status,t.url)):e(new A(r.statusText,r.status,t.url))},r.send(),r},t.getImage=function(t,e){return S(t,function(t,r){if(t)e(t);else if(r){var n=new self.Image,a=self.URL||self.webkitURL;n.onload=function(){e(null,n),a.revokeObjectURL(n.src)};var i=new self.Blob([new Uint8Array(r.data)],{type:"image/png"});n.cacheControl=r.cacheControl,n.expires=r.expires,n.src=r.data.byteLength?a.createObjectURL(i):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},t.ResourceType=M,t.RGBAImage=fa,t.default$2=Qi,t.ImagePosition=to,t.getArrayBuffer=S,t.default$3=function(t){return new io(t).readFields(Mo,[])},t.default$4=yr,t.asyncAll=function(t,e,r){if(!t.length)return r(null,[]);var n=t.length,a=new Array(t.length),i=null;t.forEach(function(t,o){e(t,function(t,e){t&&(i=t),a[o]=e,0==--n&&r(i,a)})})},t.AlphaImage=ca,t.default$5=P,t.endsWith=g,t.extend=p,t.sphericalToCartesian=function(t){var e=t[0],r=t[1],n=t[2];return r+=90,r*=Math.PI/180,n*=Math.PI/180,{x:e*Math.cos(r)*Math.sin(n),y:e*Math.sin(r)*Math.sin(n),z:e*Math.cos(n)}},t.Evented=z,t.validateStyle=nr,t.validateLight=ar,t.emitValidationErrors=sr,t.default$6=tt,t.number=wt,t.Properties=qr,t.Transitionable=Pr,t.Transitioning=Dr,t.PossiblyEvaluated=Fr,t.DataConstantProperty=Nr,t.warnOnce=_,t.uniqueId=function(){return d++},t.default$7=Eo,t.pick=function(t,e){for(var r={},n=0;n<e.length;n++){var a=e[n];a in t&&(r[a]=t[a])}return r},t.wrap=function(t,e,r){var n=r-e,a=((t-e)%n+n)%n+e;return a===e?r:a},t.clamp=h,t.Event=L,t.ErrorEvent=I,t.OverscaledTileID=zo,t.default$8=Dn,t.createLayout=Xr,t.getCoordinatesCenter=function(t){for(var e=1/0,r=1/0,n=-1/0,a=-1/0,i=0;i<t.length;i++)e=Math.min(e,t[i].column),r=Math.min(r,t[i].row),n=Math.max(n,t[i].column),a=Math.max(a,t[i].row);var o=n-e,l=a-r,u=Math.max(o,l),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2));return new s((e+n)/2,(r+a)/2,0).zoomTo(c)},t.CanonicalTileID=Lo,t.RasterBoundsArray=Jr,t.getVideo=function(t,e){var r,n,a=self.document.createElement("video");a.onloadstart=function(){e(null,a)};for(var i=0;i<t.length;i++){var o=self.document.createElement("source");r=t[i],n=void 0,(n=self.document.createElement("a")).href=r,(n.protocol!==self.document.location.protocol||n.host!==self.document.location.host)&&(a.crossOrigin="Anonymous"),o.src=t[i],a.appendChild(o)}return a},t.default$9=O,t.bindAll=v,t.default$10=function t(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(var n=0;n<e.length;n++)if(!t(e[n],r[n]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(e).length!==Object.keys(r).length)return!1;for(var a in e)if(!t(e[a],r[a]))return!1;return!0}return e===r},t.parseCacheControl=function(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(t,r,n,a){var i=n||a;return e[r]=!i||i.toLowerCase(),""}),e["max-age"]){var r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e},t.default$11=No,t.default$12=Bo,t.default$13=Re,t.default$14=Gi,t.CollisionBoxArray=gn,t.default$15=Tn,t.TriangleIndexArray=fn,t.default$16=Lr,t.default$17=s,t.keysDifference=function(t,e){var r=[];for(var n in t)n in e||r.push(n);return r},t.default$18=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.mat4=na,t.vec4=ra,t.getSizeData=Fi,t.evaluateSizeForFeature=function(t,e,r){var n=e;return"source"===t.functionType?r.lowerSize/10:"composite"===t.functionType?wt(r.lowerSize/10,r.upperSize/10,n.uSizeT):n.uSize},t.evaluateSizeForZoom=function(t,e,r){if("constant"===t.functionType)return{uSizeT:0,uSize:t.layoutSize};if("source"===t.functionType)return{uSizeT:0,uSize:0};if("camera"===t.functionType){var n=t.propertyValue,a=t.zoomRange,i=t.sizeRange,o=h(Se(n,r.specification).interpolationFactor(e,a.min,a.max),0,1);return{uSizeT:0,uSize:i.min+o*(i.max-i.min)}}var s=t.propertyValue,l=t.zoomRange;return{uSizeT:h(Se(s,r.specification).interpolationFactor(e,l.min,l.max),0,1),uSize:0}},t.addDynamicAttributes=Ui,t.default$19=Yi,t.WritingMode=Vo,t.multiPolygonIntersectsBufferedPoint=Vn,t.multiPolygonIntersectsMultiPolygon=Un,t.multiPolygonIntersectsBufferedMultiLine=qn,t.polygonIntersectsPolygon=function(t,e){for(var r=0;r<t.length;r++)if($n(e,t[r]))return!0;for(var n=0;n<e.length;n++)if($n(t,e[n]))return!0;return!!Gn(t,e)},t.distToSegmentSquared=Xn,t.default$20=ea,t.default$21=Hr,t.default$22=function(t){return new Ki[t.type](t)},t.clone=x,t.filterObject=y,t.mapObject=m,t.registerForPluginAvailability=function(t){return Tr?t({pluginURL:Tr,completionCallback:Mr}):Er.once("pluginAvailable",t),t},t.evented=Er,t.default$23=mr,t.default$24=zn,t.PosArray=$r,t.UnwrappedTileID=Io,t.ease=f,t.bezier=c,t.setRTLTextPlugin=function(t,e){if(Ar)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ar=!0,Tr=t,Mr=function(t){t?(Ar=!1,Tr=null,e&&e(t)):Sr=!0},Er.fire(new L("pluginAvailable",{pluginURL:Tr,completionCallback:Mr}))},t.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e},t.default$25=Bi,t.register=pr,t.GLYPH_PBF_BORDER=So,t.shapeText=function(t,e,r,n,a,i,o,s,l,u){var c=t.trim();u===Vo.vertical&&(c=function(t){for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r+1)||null,a=t.charCodeAt(r-1)||null;n&&wr(n)&&!Ri[t[r+1]]||a&&wr(a)&&!Ri[t[r-1]]||!Ri[t[r]]?e+=t[r]:e+=Ri[t[r]]}return e}(c));var f=[],h={positionedGlyphs:f,text:c,top:s[1],bottom:s[1],left:s[0],right:s[0],writingMode:u},p=Cr.processBidirectionalText;return function(t,e,r,n,a,i,o,s,l){for(var u=0,c=-17,f=0,h=t.positionedGlyphs,p="right"===i?1:"left"===i?0:.5,d=0,v=r;d<v.length;d+=1){var g=v[d];if((g=g.trim()).length){for(var m=h.length,y=0;y<g.length;y++){var x=g.charCodeAt(y),b=e[x];b&&(_r(x)&&o!==Vo.horizontal?(h.push({glyph:x,x:u,y:0,vertical:!0}),u+=l+s):(h.push({glyph:x,x:u,y:c,vertical:!1}),u+=b.metrics.advance+s))}if(h.length!==m){var _=u-s;f=Math.max(_,f),Zo(h,e,m,h.length-1,p)}u=0,c+=n}else c+=n}var w=Xo(a),k=w.horizontalAlign,M=w.verticalAlign;!function(t,e,r,n,a,i,o){for(var s=(e-r)*a,l=(-n*o+.5)*i,u=0;u<t.length;u++)t[u].x+=s,t[u].y+=l}(h,p,k,M,f,n,r.length);var A=r.length*n;t.top+=-M*A,t.bottom=t.top+A,t.left+=-k*f,t.right=t.left+f}(h,e,p?p(c,Yo(c,o,r,e)):function(t,e){for(var r=[],n=0,a=0,i=e;a<i.length;a+=1){var o=i[a];r.push(t.substring(n,o)),n=o}return n<t.length&&r.push(t.substring(n,t.length)),r}(c,Yo(c,o,r,e)),n,a,i,u,o,l),!!f.length&&h},t.shapeIcon=function(t,e,r){var n=Xo(r),a=n.horizontalAlign,i=n.verticalAlign,o=e[0],s=e[1],l=o-t.displaySize[0]*a,u=l+t.displaySize[0],c=s-t.displaySize[1]*i;return{image:t,top:c,bottom:c+t.displaySize[1],left:l,right:u}},t.allowsVerticalWritingMode=xr,t.allowsLetterSpacing=function(t){for(var e=0,r=t;e<r.length;e+=1)if(!br(r[e].charCodeAt(0)))return!1;return!0},t.default$26=Xa,t.default$27=Ro,t.default$28=ro,t.default$29=gi,t.default$30=io,t.default$31=Do,t.__moduleExports=gi,t.default$32=l,t.__moduleExports$1=io,t.plugin=Cr});a(["./chunk1.js"],function(t){"use strict";function e(t){var r=typeof t;if("number"===r||"boolean"===r||"string"===r||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var n="[",a=0,i=t;a<i.length;a+=1){n+=e(i[a])+","}return n+"]"}for(var o=Object.keys(t).sort(),s="{",l=0;l<o.length;l++)s+=JSON.stringify(o[l])+":"+e(t[o[l]])+",";return s+"}"}function r(r){for(var n="",a=0,i=t.default$18;a<i.length;a+=1){n+="/"+e(r[i[a]])}return n}var n=function(t){t&&this.replace(t)};function a(t,e,r,n,a){if(void 0===e.segment)return!0;for(var i=e,o=e.segment+1,s=0;s>-r/2;){if(--o<0)return!1;s-=t[o].dist(i),i=t[o]}s+=t[o].dist(t[o+1]),o++;for(var l=[],u=0;s<r/2;){var c=t[o-1],f=t[o],h=t[o+1];if(!h)return!1;var p=c.angleTo(f)-f.angleTo(h);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:p}),u+=p;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>a)return!1;o++,s+=f.dist(h)}return!0}function i(e,r,n,i,o,s,l,u,c){var f=i?.6*s*l:0,h=Math.max(i?i.right-i.left:0,o?o.right-o.left:0),p=0===e[0].x||e[0].x===c||0===e[0].y||e[0].y===c;return r-h*l<r/4&&(r=h*l+r/4),function e(r,n,i,o,s,l,u,c,f){var h=l/2;var p=0;for(var d=0;d<r.length-1;d++)p+=r[d].dist(r[d+1]);var v=0,g=n-i;var m=[];for(var y=0;y<r.length-1;y++){for(var x=r[y],b=r[y+1],_=x.dist(b),w=b.angleTo(x);g+i<v+_;){var k=((g+=i)-v)/_,M=t.number(x.x,b.x,k),A=t.number(x.y,b.y,k);if(M>=0&&M<f&&A>=0&&A<f&&g-h>=0&&g+h<=p){var T=new t.default$25(M,A,w,y);T._round(),o&&!a(r,T,l,o,s)||m.push(T)}}v+=_}c||m.length||u||(m=e(r,v/2,i,o,s,l,u,!0,f));return m}(e,p?r/2*u%r:(h/2+2*s)*l*u%r,r,f,n,h*l,p,!1,c)}n.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},n.prototype.update=function(e,n){for(var a=this,i=0,o=e;i<o.length;i+=1){var s=o[i];a._layerConfigs[s.id]=s;var l=a._layers[s.id]=t.default$22(s);l._featureFilter=t.default$13(l.filter)}for(var u=0,c=n;u<c.length;u+=1){var f=c[u];delete a._layerConfigs[f],delete a._layers[f]}this.familiesBySource={};for(var h=0,p=function(t){for(var e={},n=0;n<t.length;n++){var a=r(t[n]),i=e[a];i||(i=e[a]=[]),i.push(t[n])}var o=[];for(var s in e)o.push(e[s]);return o}(t.values(this._layerConfigs));h<p.length;h+=1){var d=p[h].map(function(t){return a._layers[t.id]}),v=d[0];if("none"!==v.visibility){var g=v.source||"",m=a.familiesBySource[g];m||(m=a.familiesBySource[g]={});var y=v.sourceLayer||"_geojsonTileLayer",x=m[y];x||(x=m[y]=[]),x.push(d)}}};var o=function(){this.opacity=0,this.targetOpacity=0,this.time=0};o.prototype.clone=function(){var t=new o;return t.opacity=this.opacity,t.targetOpacity=this.targetOpacity,t.time=this.time,t},t.register("OpacityState",o);var s=function(t,e,r,n,a,i,o,s,l,u,c){var f=o.top*s-l,h=o.bottom*s+l,p=o.left*s-l,d=o.right*s+l;if(this.boxStartIndex=t.length,u){var v=h-f,g=d-p;v>0&&(v=Math.max(10*s,v),this._addLineCollisionCircles(t,e,r,r.segment,g,v,n,a,i,c))}else t.emplaceBack(r.x,r.y,p,f,d,h,n,a,i,0,0);this.boxEndIndex=t.length};s.prototype._addLineCollisionCircles=function(t,e,r,n,a,i,o,s,l,u){var c=i/2,f=Math.floor(a/c),h=1+.4*Math.log(u)/Math.LN2,p=Math.floor(f*h/2),d=-i/2,v=r,g=n+1,m=d,y=-a/2,x=y-a/4;do{if(--g<0){if(m>y)return;g=0;break}m-=e[g].dist(v),v=e[g]}while(m>x);for(var b=e[g].dist(e[g+1]),_=-p;_<f+p;_++){var w=_*c,k=y+w;if(w<0&&(k+=w),w>a&&(k+=w-a),!(k<m)){for(;m+b<k;){if(m+=b,++g+1>=e.length)return;b=e[g].dist(e[g+1])}var M=k-m,A=e[g],T=e[g+1].sub(A)._unit()._mult(M)._add(A)._round(),S=Math.abs(k-d)<c?0:.8*(k-d);t.emplaceBack(T.x,T.y,-i/2,-i/2,i/2,i/2,o,s,l,i/2,S)}}};var l=c,u=c;function c(t,e){if(!(this instanceof c))return new c(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||f,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}function f(t,e){return t<e?-1:t>e?1:0}function h(e,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);for(var a=1/0,i=1/0,o=-1/0,s=-1/0,u=e[0],c=0;c<u.length;c++){var f=u[c];(!c||f.x<a)&&(a=f.x),(!c||f.y<i)&&(i=f.y),(!c||f.x>o)&&(o=f.x),(!c||f.y>s)&&(s=f.y)}var h=o-a,v=s-i,g=Math.min(h,v),m=g/2,y=new l(null,p);if(0===g)return new t.default$1(a,i);for(var x=a;x<o;x+=g)for(var b=i;b<s;b+=g)y.push(new d(x+m,b+m,m,e));for(var _=function(t){for(var e=0,r=0,n=0,a=t[0],i=0,o=a.length,s=o-1;i<o;s=i++){var l=a[i],u=a[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,n+=(l.y+u.y)*c,e+=3*c}return new d(r/e,n/e,0,t)}(e),w=y.length;y.length;){var k=y.pop();(k.d>_.d||!_.d)&&(_=k,n&&console.log("found best %d after %d probes",Math.round(1e4*k.d)/1e4,w)),k.max-_.d<=r||(m=k.h/2,y.push(new d(k.p.x-m,k.p.y-m,m,e)),y.push(new d(k.p.x+m,k.p.y-m,m,e)),y.push(new d(k.p.x-m,k.p.y+m,m,e)),y.push(new d(k.p.x+m,k.p.y+m,m,e)),w+=4)}return n&&(console.log("num probes: "+w),console.log("best distance: "+_.d)),_.p}function p(t,e){return e.max-t.max}function d(e,r,n,a){this.p=new t.default$1(e,r),this.h=n,this.d=function(e,r){for(var n=!1,a=1/0,i=0;i<r.length;i++)for(var o=r[i],s=0,l=o.length,u=l-1;s<l;u=s++){var c=o[s],f=o[u];c.y>e.y!=f.y>e.y&&e.x<(f.x-c.x)*(e.y-c.y)/(f.y-c.y)+c.x&&(n=!n),a=Math.min(a,t.distToSegmentSquared(e,c,f))}return(n?1:-1)*Math.sqrt(a)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}function v(e,r,n,a,i,o){e.createArrays(),e.symbolInstances=[];var s=512*e.overscaling;e.tilePixelRatio=t.default$8/s,e.compareText={},e.iconsNeedLinear=!1;var l=e.layers[0].layout,u=e.layers[0]._unevaluatedLayout._values,c={};if("composite"===e.textSizeData.functionType){var f=e.textSizeData.zoomRange,h=f.min,p=f.max;c.compositeTextSizes=[u["text-size"].possiblyEvaluate(new t.default$16(h)),u["text-size"].possiblyEvaluate(new t.default$16(p))]}if("composite"===e.iconSizeData.functionType){var d=e.iconSizeData.zoomRange,v=d.min,m=d.max;c.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new t.default$16(v)),u["icon-size"].possiblyEvaluate(new t.default$16(m))]}c.layoutTextSize=u["text-size"].possiblyEvaluate(new t.default$16(e.zoom+1)),c.layoutIconSize=u["icon-size"].possiblyEvaluate(new t.default$16(e.zoom+1)),c.textMaxSize=u["text-size"].possiblyEvaluate(new t.default$16(18));for(var y=24*l.get("text-line-height"),x="map"===l.get("text-rotation-alignment")&&"line"===l.get("symbol-placement"),b=l.get("text-keep-upright"),_=0,w=e.features;_<w.length;_+=1){var k=w[_],M=l.get("text-font").evaluate(k).join(","),A=r[M]||{},T=n[M]||{},S={},E=k.text;if(E){var C=l.get("text-offset").evaluate(k).map(function(t){return 24*t}),L=24*l.get("text-letter-spacing").evaluate(k),I=t.allowsLetterSpacing(E)?L:0,z=l.get("text-anchor").evaluate(k),P=l.get("text-justify").evaluate(k),O="line"!==l.get("symbol-placement")?24*l.get("text-max-width").evaluate(k):0;S.horizontal=t.shapeText(E,A,O,y,z,P,I,C,24,t.WritingMode.horizontal),t.allowsVerticalWritingMode(E)&&x&&b&&(S.vertical=t.shapeText(E,A,O,y,z,P,I,C,24,t.WritingMode.vertical))}var D=void 0;if(k.icon){var R=a[k.icon];R&&(D=t.shapeIcon(i[k.icon],l.get("icon-offset").evaluate(k),l.get("icon-anchor").evaluate(k)),void 0===e.sdfIcons?e.sdfIcons=R.sdf:e.sdfIcons!==R.sdf&&t.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),R.pixelRatio!==e.pixelRatio?e.iconsNeedLinear=!0:0!==l.get("icon-rotate").constantOr(1)&&(e.iconsNeedLinear=!0))}(S.horizontal||D)&&g(e,k,S,D,T,c)}o&&e.generateCollisionDebugBuffers()}function g(e,r,n,a,l,u){var c=u.layoutTextSize.evaluate(r),f=u.layoutIconSize.evaluate(r),p=u.textMaxSize.evaluate(r);void 0===p&&(p=c);var d=e.layers[0].layout,v=d.get("text-offset").evaluate(r),g=d.get("icon-offset").evaluate(r),x=c/24,b=e.tilePixelRatio*x,_=e.tilePixelRatio*p/24,w=e.tilePixelRatio*f,k=e.tilePixelRatio*d.get("symbol-spacing"),M=d.get("text-padding")*e.tilePixelRatio,A=d.get("icon-padding")*e.tilePixelRatio,T=d.get("text-max-angle")/180*Math.PI,S="map"===d.get("text-rotation-alignment")&&"line"===d.get("symbol-placement"),E="map"===d.get("icon-rotation-alignment")&&"line"===d.get("symbol-placement"),C=k/2,L=function(i,c){c.x<0||c.x>=t.default$8||c.y<0||c.y>=t.default$8||e.symbolInstances.push(function(e,r,n,a,i,l,u,c,f,h,p,d,v,g,y,x,b,_,w,k,M){var A,T,S=e.addToLineVertexArray(r,n),E=0,C=0,L=0,I=a.horizontal?a.horizontal.text:"",z=[];a.horizontal&&(A=new s(u,n,r,c,f,h,a.horizontal,p,d,v,e.overscaling),C+=m(e,r,a.horizontal,l,v,w,g,S,a.vertical?t.WritingMode.horizontal:t.WritingMode.horizontalOnly,z,k,M),a.vertical&&(L+=m(e,r,a.vertical,l,v,w,g,S,t.WritingMode.vertical,z,k,M)));var P=A?A.boxStartIndex:e.collisionBoxArray.length,O=A?A.boxEndIndex:e.collisionBoxArray.length;if(i){var D=function(e,r,n,a,i,o){var s,l,u,c,f=r.image,h=n.layout,p=r.top-1/f.pixelRatio,d=r.left-1/f.pixelRatio,v=r.bottom+1/f.pixelRatio,g=r.right+1/f.pixelRatio;if("none"!==h.get("icon-text-fit")&&i){var m=g-d,y=v-p,x=h.get("text-size").evaluate(o)/24,b=i.left*x,_=i.right*x,w=i.top*x,k=_-b,M=i.bottom*x-w,A=h.get("icon-text-fit-padding")[0],T=h.get("icon-text-fit-padding")[1],S=h.get("icon-text-fit-padding")[2],E=h.get("icon-text-fit-padding")[3],C="width"===h.get("icon-text-fit")?.5*(M-y):0,L="height"===h.get("icon-text-fit")?.5*(k-m):0,I="width"===h.get("icon-text-fit")||"both"===h.get("icon-text-fit")?k:m,z="height"===h.get("icon-text-fit")||"both"===h.get("icon-text-fit")?M:y;s=new t.default$1(b+L-E,w+C-A),l=new t.default$1(b+L+T+I,w+C-A),u=new t.default$1(b+L+T+I,w+C+S+z),c=new t.default$1(b+L-E,w+C+S+z)}else s=new t.default$1(d,p),l=new t.default$1(g,p),u=new t.default$1(g,v),c=new t.default$1(d,v);var P=n.layout.get("icon-rotate").evaluate(o)*Math.PI/180;if(P){var O=Math.sin(P),D=Math.cos(P),R=[D,-O,O,D];s._matMult(R),l._matMult(R),c._matMult(R),u._matMult(R)}return[{tl:s,tr:l,bl:c,br:u,tex:f.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]}(0,i,l,0,a.horizontal,w);T=new s(u,n,r,c,f,h,i,y,x,!1,e.overscaling),E=4*D.length;var R=e.iconSizeData,B=null;"source"===R.functionType?B=[10*l.layout.get("icon-size").evaluate(w)]:"composite"===R.functionType&&(B=[10*M.compositeIconSizes[0].evaluate(w),10*M.compositeIconSizes[1].evaluate(w)]),e.addSymbols(e.icon,D,B,_,b,w,!1,r,S.lineStartIndex,S.lineLength)}var F=T?T.boxStartIndex:e.collisionBoxArray.length,N=T?T.boxEndIndex:e.collisionBoxArray.length;e.glyphOffsetArray.length>=t.default$14.MAX_GLYPHS&&t.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");var j=new o,V=new o;return{key:I,textBoxStartIndex:P,textBoxEndIndex:O,iconBoxStartIndex:F,iconBoxEndIndex:N,textOffset:g,iconOffset:_,anchor:r,line:n,featureIndex:c,feature:w,numGlyphVertices:C,numVerticalGlyphVertices:L,numIconVertices:E,textOpacityState:j,iconOpacityState:V,isDuplicate:!1,placedTextSymbolIndices:z,crossTileID:0}}(e,c,i,n,a,e.layers[0],e.collisionBoxArray,r.index,r.sourceLayerIndex,e.index,b,M,S,v,w,A,E,g,r,l,u))};if("line"===d.get("symbol-placement"))for(var I=0,z=function(e,r,n,a,i){for(var o=[],s=0;s<e.length;s++)for(var l=e[s],u=void 0,c=0;c<l.length-1;c++){var f=l[c],h=l[c+1];f.x<r&&h.x<r||(f.x<r?f=new t.default$1(r,f.y+(h.y-f.y)*((r-f.x)/(h.x-f.x)))._round():h.x<r&&(h=new t.default$1(r,f.y+(h.y-f.y)*((r-f.x)/(h.x-f.x)))._round()),f.y<n&&h.y<n||(f.y<n?f=new t.default$1(f.x+(h.x-f.x)*((n-f.y)/(h.y-f.y)),n)._round():h.y<n&&(h=new t.default$1(f.x+(h.x-f.x)*((n-f.y)/(h.y-f.y)),n)._round()),f.x>=a&&h.x>=a||(f.x>=a?f=new t.default$1(a,f.y+(h.y-f.y)*((a-f.x)/(h.x-f.x)))._round():h.x>=a&&(h=new t.default$1(a,f.y+(h.y-f.y)*((a-f.x)/(h.x-f.x)))._round()),f.y>=i&&h.y>=i||(f.y>=i?f=new t.default$1(f.x+(h.x-f.x)*((i-f.y)/(h.y-f.y)),i)._round():h.y>=i&&(h=new t.default$1(f.x+(h.x-f.x)*((i-f.y)/(h.y-f.y)),i)._round()),u&&f.equals(u[u.length-1])||(u=[f],o.push(u)),u.push(h)))))}return o}(r.geometry,0,0,t.default$8,t.default$8);I<z.length;I+=1)for(var P=z[I],O=0,D=i(P,k,T,n.vertical||n.horizontal,a,24,_,e.overscaling,t.default$8);O<D.length;O+=1){var R=D[O],B=n.horizontal;B&&y(e,B.text,C,R)||L(P,R)}else if("Polygon"===r.type)for(var F=0,N=t.default$26(r.geometry,0);F<N.length;F+=1){var j=N[F],V=h(j,16);L(j[0],new t.default$25(V.x,V.y,0))}else if("LineString"===r.type)for(var U=0,q=r.geometry;U<q.length;U+=1){var H=q[U];L(H,new t.default$25(H[0].x,H[0].y,0))}else if("Point"===r.type)for(var G=0,W=r.geometry;G<W.length;G+=1)for(var Y=0,X=W[G];Y<X.length;Y+=1){var Z=X[Y];L([Z],new t.default$25(Z.x,Z.y,0))}}function m(e,r,n,a,i,o,s,l,u,c,f,h){var p=function(e,r,n,a,i,o){for(var s=n.layout.get("text-rotate").evaluate(i)*Math.PI/180,l=n.layout.get("text-offset").evaluate(i).map(function(t){return 24*t}),u=r.positionedGlyphs,c=[],f=0;f<u.length;f++){var h=u[f],p=o[h.glyph];if(p){var d=p.rect;if(d){var v=t.GLYPH_PBF_BORDER+1,g=p.metrics.advance/2,m=a?[h.x+g,h.y]:[0,0],y=a?[0,0]:[h.x+g+l[0],h.y+l[1]],x=p.metrics.left-v-g+y[0],b=-p.metrics.top-v+y[1],_=x+d.w,w=b+d.h,k=new t.default$1(x,b),M=new t.default$1(_,b),A=new t.default$1(x,w),T=new t.default$1(_,w);if(a&&h.vertical){var S=new t.default$1(-g,g),E=-Math.PI/2,C=new t.default$1(5,0);k._rotateAround(E,S)._add(C),M._rotateAround(E,S)._add(C),A._rotateAround(E,S)._add(C),T._rotateAround(E,S)._add(C)}if(s){var L=Math.sin(s),I=Math.cos(s),z=[I,-L,L,I];k._matMult(z),M._matMult(z),A._matMult(z),T._matMult(z)}c.push({tl:k,tr:M,bl:A,br:T,tex:d,writingMode:r.writingMode,glyphOffset:m})}}}return c}(0,n,a,i,o,f),d=e.textSizeData,v=null;return"source"===d.functionType?v=[10*a.layout.get("text-size").evaluate(o)]:"composite"===d.functionType&&(v=[10*h.compositeTextSizes[0].evaluate(o),10*h.compositeTextSizes[1].evaluate(o)]),e.addSymbols(e.text,p,v,s,i,o,u,r,l.lineStartIndex,l.lineLength),c.push(e.text.placedSymbolArray.length-1),4*p.length}function y(t,e,r,n){var a=t.compareText;if(e in a){for(var i=a[e],o=i.length-1;o>=0;o--)if(n.dist(i[o])<r)return!0}else a[e]=[];return a[e].push(n),!1}c.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,r=this.compare,n=e[t];t>0;){var a=t-1>>1,i=e[a];if(r(n,i)>=0)break;e[t]=i,t=a}e[t]=n},_down:function(t){for(var e=this.data,r=this.compare,n=this.length>>1,a=e[t];t<n;){var i=1+(t<<1),o=i+1,s=e[i];if(o<this.length&&r(e[o],s)<0&&(i=o,s=e[o]),r(s,a)>=0)break;e[t]=s,t=i}e[t]=a}},l.default=u;var x=function(e){var r=new t.AlphaImage({width:0,height:0}),n={},a=new t.default$2(0,0,{autoResize:!0});for(var i in e){var o=e[i],s=n[i]={};for(var l in o){var u=o[+l];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c=a.packOne(u.bitmap.width+2,u.bitmap.height+2);r.resize({width:a.w,height:a.h}),t.AlphaImage.copy(u.bitmap,r,{x:0,y:0},{x:c.x+1,y:c.y+1},u.bitmap),s[l]={rect:c,metrics:u.metrics}}}}a.shrink(),r.resize({width:a.w,height:a.h}),this.image=r,this.positions=n};t.register("GlyphAtlas",x);var b=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming};function _(e,r){for(var n=new t.default$16(r),a=0,i=e;a<i.length;a+=1){i[a].recalculate(n)}}b.prototype.parse=function(e,r,n,a){var i=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var o=new t.default$27(Object.keys(e.layers).sort()),s=new t.default$11(this.tileID);s.bucketLayerIDs=[];var l,u,c,f={},h={featureIndex:s,iconDependencies:{},glyphDependencies:{}},p=r.familiesBySource[this.source];for(var d in p){var g=e.layers[d];if(g){1===g.version&&t.warnOnce('Vector tile source "'+i.source+'" layer "'+d+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var m=o.encode(d),y=[],b=0;b<g.length;b++){var w=g.feature(b);y.push({feature:w,index:b,sourceLayerIndex:m})}for(var k=0,M=p[d];k<M.length;k+=1){var A=M[k],T=A[0];if(!(T.minzoom&&i.zoom<Math.floor(T.minzoom)))if(!(T.maxzoom&&i.zoom>=T.maxzoom))if("none"!==T.visibility)_(A,i.zoom),(f[T.id]=T.createBucket({index:s.bucketLayerIDs.length,layers:A,zoom:i.zoom,pixelRatio:i.pixelRatio,overscaling:i.overscaling,collisionBoxArray:i.collisionBoxArray,sourceLayerIndex:m})).populate(y,h),s.bucketLayerIDs.push(A.map(function(t){return t.id}))}}}var S=t.mapObject(h.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(S).length?n.send("getGlyphs",{uid:this.uid,stacks:S},function(t,e){l||(l=t,u=e,C.call(i))}):u={};var E=Object.keys(h.iconDependencies);function C(){if(l)return a(l);if(u&&c){var e=new x(u),r=new t.default$28(c);for(var n in f){var i=f[n];i instanceof t.default$14&&(_(i.layers,this.zoom),v(i,u,e.positions,c,r.positions,this.showCollisionBoxes))}this.status="done",a(null,{buckets:t.values(f).filter(function(t){return!t.isEmpty()}),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,iconAtlasImage:r.image})}}E.length?n.send("getImages",{icons:E},function(t,e){l||(l=t,c=e,C.call(i))}):c={},C.call(this)};var w=function(t){return!(!performance||!performance.getEntriesByName)&&performance.getEntriesByName(t)};function k(e,r){var n=t.getArrayBuffer(e.request,function(e,n){e?r(e):n&&r(null,{vectorTile:new t.default$29.VectorTile(new t.default$30(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires})});return function(){n.abort(),r()}}var M=function(t,e,r){this.actor=t,this.layerIndex=e,this.loadVectorData=r||k,this.loading={},this.loaded={}};M.prototype.loadTile=function(e,r){var n=this,a=e.uid;this.loading||(this.loading={});var i=this.loading[a]=new b(e);i.abort=this.loadVectorData(e,function(o,s){if(delete n.loading[a],o||!s)return r(o);var l=s.rawData,u={};s.expires&&(u.expires=s.expires),s.cacheControl&&(u.cacheControl=s.cacheControl);var c={};if(e.request&&e.request.collectResourceTiming){var f=w(e.request.url);f&&(c.resourceTiming=JSON.parse(JSON.stringify(f)))}i.vectorTile=s.vectorTile,i.parse(s.vectorTile,n.layerIndex,n.actor,function(e,n){if(e||!n)return r(e);r(null,t.extend({rawTileData:l.slice(0)},n,u,c))}),n.loaded=n.loaded||{},n.loaded[a]=i})},M.prototype.reloadTile=function(t,e){var r=this.loaded,n=t.uid,a=this;if(r&&r[n]){var i=r[n];i.showCollisionBoxes=t.showCollisionBoxes;var o=function(t,r){var n=i.reloadCallback;n&&(delete i.reloadCallback,i.parse(i.vectorTile,a.layerIndex,a.actor,n)),e(t,r)};"parsing"===i.status?i.reloadCallback=o:"done"===i.status&&i.parse(i.vectorTile,this.layerIndex,this.actor,o)}},M.prototype.abortTile=function(t,e){var r=this.loading,n=t.uid;r&&r[n]&&r[n].abort&&(r[n].abort(),delete r[n]),e()},M.prototype.removeTile=function(t,e){var r=this.loaded,n=t.uid;r&&r[n]&&delete r[n],e()};var A=function(){this.loading={},this.loaded={}};A.prototype.loadTile=function(e,r){var n=e.uid,a=e.encoding,i=new t.default$31(n);this.loading[n]=i,i.loadFromImage(e.rawImageData,a),delete this.loading[n],this.loaded=this.loaded||{},this.loaded[n]=i,r(null,i)},A.prototype.removeTile=function(t){var e=this.loaded,r=t.uid;e&&e[r]&&delete e[r]};var T={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function S(t){var e=0;if(t&&t.length>0){e+=Math.abs(E(t[0]));for(var r=1;r<t.length;r++)e-=Math.abs(E(t[r]))}return e}function E(t){var e,r,n,a,i,o,s=0,l=t.length;if(l>2){for(o=0;o<l;o++)o===l-2?(n=l-2,a=l-1,i=0):o===l-1?(n=l-1,a=0,i=1):(n=o,a=o+1,i=o+2),e=t[n],r=t[a],s+=(C(t[i][0])-C(e[0]))*Math.sin(C(r[1]));s=s*T.RADIUS*T.RADIUS/2}return s}function C(t){return t*Math.PI/180}var L={geometry:function t(e){var r,n=0;switch(e.type){case"Polygon":return S(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++)n+=S(e.coordinates[r]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<e.geometries.length;r++)n+=t(e.geometries[r]);return n}},ring:E},I=function t(e,r){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(z(t,r)),e;case"Feature":return e.geometry=t(e.geometry,r),e;case"Polygon":case"MultiPolygon":return function(t,e){"Polygon"===t.type?t.coordinates=P(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(z(P,e)));return t}(e,r);default:return e}};function z(t,e){return function(r){return t(r,e)}}function P(t,e){e=!!e,t[0]=O(t[0],e);for(var r=1;r<t.length;r++)t[r]=O(t[r],!e);return t}function O(t,e){return function(t){return L.ring(t)>=0}(t)===e?t:t.reverse()}var D=t.default$29.VectorTileFeature.prototype.toGeoJSON,R=function(e){this._feature=e,this.extent=t.default$8,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};R.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],r=0,n=this._feature.geometry;r<n.length;r+=1){var a=n[r];e.push([new t.default$1(a[0],a[1])])}return e}for(var i=[],o=0,s=this._feature.geometry;o<s.length;o+=1){for(var l=[],u=0,c=s[o];u<c.length;u+=1){var f=c[u];l.push(new t.default$1(f[0],f[1]))}i.push(l)}return i},R.prototype.toGeoJSON=function(t,e,r){return D.call(this,t,e,r)};var B=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.default$8,this.length=e.length,this._features=e};B.prototype.feature=function(t){return new R(this._features[t])};var F=t.__moduleExports.VectorTileFeature,N=j;function j(t,e){this.options=e||{},this.features=t,this.length=t.length}function V(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}j.prototype.feature=function(t){return new V(this.features[t],this.options.extent)},V.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var r=0;r<e.length;r++){for(var n=e[r],a=[],i=0;i<n.length;i++)a.push(new t.default$32(n[i][0],n[i][1]));this.geometry.push(a)}return this.geometry},V.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-1/0,n=1/0,a=-1/0,i=0;i<t.length;i++)for(var o=t[i],s=0;s<o.length;s++){var l=o[s];e=Math.min(e,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),a=Math.max(a,l.y)}return[e,n,r,a]},V.prototype.toGeoJSON=F.prototype.toGeoJSON;var U=W,q=W,H=function(t,e){e=e||{};var r={};for(var n in t)r[n]=new N(t[n].features,e),r[n].name=n,r[n].version=e.version,r[n].extent=e.extent;return W({layers:r})},G=N;function W(e){var r=new t.__moduleExports$1;return function(t,e){for(var r in t.layers)e.writeMessage(3,Y,t.layers[r])}(e,r),r.finish()}function Y(t,e){var r;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<t.length;r++)n.feature=t.feature(r),e.writeMessage(2,X,n);var a=n.keys;for(r=0;r<a.length;r++)e.writeStringField(3,a[r]);var i=n.values;for(r=0;r<i.length;r++)e.writeMessage(4,Q,i[r])}function X(t,e){var r=t.feature;void 0!==r.id&&e.writeVarintField(1,r.id),e.writeMessage(2,Z,t),e.writeVarintField(3,r.type),e.writeMessage(4,K,r)}function Z(t,e){var r=t.feature,n=t.keys,a=t.values,i=t.keycache,o=t.valuecache;for(var s in r.properties){var l=i[s];void 0===l&&(n.push(s),l=n.length-1,i[s]=l),e.writeVarint(l);var u=r.properties[s],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var f=c+":"+u,h=o[f];void 0===h&&(a.push(u),h=a.length-1,o[f]=h),e.writeVarint(h)}}function $(t,e){return(e<<3)+(7&t)}function J(t){return t<<1^t>>31}function K(t,e){for(var r=t.loadGeometry(),n=t.type,a=0,i=0,o=r.length,s=0;s<o;s++){var l=r[s],u=1;1===n&&(u=l.length),e.writeVarint($(1,u));for(var c=3===n?l.length-1:l.length,f=0;f<c;f++){1===f&&1!==n&&e.writeVarint($(2,c-1));var h=l[f].x-a,p=l[f].y-i;e.writeVarint(J(h)),e.writeVarint(J(p)),a+=h,i+=p}3===n&&e.writeVarint($(7,0))}}function Q(t,e){var r=typeof t;"string"===r?e.writeStringField(1,t):"boolean"===r?e.writeBooleanField(7,t):"number"===r&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}U.fromVectorTileJs=q,U.fromGeojsonVt=H,U.GeoJSONWrapper=G;var tt=function t(e,r,n,a,i,o){if(i-a<=n)return;var s=Math.floor((a+i)/2);!function t(e,r,n,a,i,o){for(;i>a;){if(i-a>600){var s=i-a+1,l=n-a+1,u=Math.log(s),c=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1),h=Math.max(a,Math.floor(n-l*c/s+f)),p=Math.min(i,Math.floor(n+(s-l)*c/s+f));t(e,r,n,h,p,o)}var d=r[2*n+o],v=a,g=i;for(et(e,r,a,n),r[2*i+o]>d&&et(e,r,a,i);v<g;){for(et(e,r,v,g),v++,g--;r[2*v+o]<d;)v++;for(;r[2*g+o]>d;)g--}r[2*a+o]===d?et(e,r,a,g):et(e,r,++g,i),g<=n&&(a=g+1),n<=g&&(i=g-1)}}(e,r,s,a,i,o%2);t(e,r,n,a,s-1,o+1);t(e,r,n,s+1,i,o+1)};function et(t,e,r,n){rt(t,r,n),rt(e,2*r,2*n),rt(e,2*r+1,2*n+1)}function rt(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}var nt=function(t,e,r,n,a,i,o){var s,l,u=[0,t.length-1,0],c=[];for(;u.length;){var f=u.pop(),h=u.pop(),p=u.pop();if(h-p<=o)for(var d=p;d<=h;d++)s=e[2*d],l=e[2*d+1],s>=r&&s<=a&&l>=n&&l<=i&&c.push(t[d]);else{var v=Math.floor((p+h)/2);s=e[2*v],l=e[2*v+1],s>=r&&s<=a&&l>=n&&l<=i&&c.push(t[v]);var g=(f+1)%2;(0===f?r<=s:n<=l)&&(u.push(p),u.push(v-1),u.push(g)),(0===f?a>=s:i>=l)&&(u.push(v+1),u.push(h),u.push(g))}}return c};var at=function(t,e,r,n,a,i){var o=[0,t.length-1,0],s=[],l=a*a;for(;o.length;){var u=o.pop(),c=o.pop(),f=o.pop();if(c-f<=i)for(var h=f;h<=c;h++)it(e[2*h],e[2*h+1],r,n)<=l&&s.push(t[h]);else{var p=Math.floor((f+c)/2),d=e[2*p],v=e[2*p+1];it(d,v,r,n)<=l&&s.push(t[p]);var g=(u+1)%2;(0===u?r-a<=d:n-a<=v)&&(o.push(f),o.push(p-1),o.push(g)),(0===u?r+a>=d:n+a>=v)&&(o.push(p+1),o.push(c),o.push(g))}}return s};function it(t,e,r,n){var a=t-r,i=e-n;return a*a+i*i}var ot=function(t,e,r,n,a){return new st(t,e,r,n,a)};function st(t,e,r,n,a){e=e||lt,r=r||ut,a=a||Array,this.nodeSize=n||64,this.points=t,this.ids=new a(t.length),this.coords=new a(2*t.length);for(var i=0;i<t.length;i++)this.ids[i]=i,this.coords[2*i]=e(t[i]),this.coords[2*i+1]=r(t[i]);tt(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function lt(t){return t[0]}function ut(t){return t[1]}st.prototype={range:function(t,e,r,n){return nt(this.ids,this.coords,t,e,r,n,this.nodeSize)},within:function(t,e,r){return at(this.ids,this.coords,t,e,r,this.nodeSize)}};var ct=function(t){return new ft(t)};function ft(t){this.options=yt(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function ht(t,e,r,n,a){return{x:t,y:e,zoom:1/0,id:n,properties:a,parentId:-1,numPoints:r}}function pt(t,e){var r=t.geometry.coordinates;return{x:gt(r[0]),y:mt(r[1]),zoom:1/0,id:e,parentId:-1}}function dt(t){return{type:"Feature",properties:vt(t),geometry:{type:"Point",coordinates:[(n=t.x,360*(n-.5)),(e=t.y,r=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(r))/Math.PI-90)]}};var e,r,n}function vt(t){var e=t.numPoints,r=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return yt(yt({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:r})}function gt(t){return t/360+.5}function mt(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function yt(t,e){for(var r in e)t[r]=e[r];return t}function xt(t){return t.x}function bt(t){return t.y}function _t(t,e,r,n,a,i){var o=a-r,s=i-n;if(0!==o||0!==s){var l=((t-r)*o+(e-n)*s)/(o*o+s*s);l>1?(r=a,n=i):l>0&&(r+=o*l,n+=s*l)}return(o=t-r)*o+(s=e-n)*s}function wt(t,e,r,n){var a={id:t||null,type:e,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,r=t.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)kt(t,e);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<e.length;n++)kt(t,e[n]);else if("MultiPolygon"===r)for(n=0;n<e.length;n++)for(var a=0;a<e[n].length;a++)kt(t,e[n][a])}(a),a}function kt(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function Mt(t,e,r){if(e.geometry){var n=e.geometry.coordinates,a=e.geometry.type,i=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),o=[];if("Point"===a)At(n,o);else if("MultiPoint"===a)for(var s=0;s<n.length;s++)At(n[s],o);else if("LineString"===a)Tt(n,o,i,!1);else if("MultiLineString"===a)if(r.lineMetrics)for(s=0;s<n.length;s++)return o=[],Tt(n[s],o,i,!1),void t.push(wt(e.id,"LineString",o,e.properties));else St(n,o,i,!1);else if("Polygon"===a)St(n,o,i,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(s=0;s<e.geometry.geometries.length;s++)Mt(t,{id:e.id,geometry:e.geometry.geometries[s],properties:e.properties},r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(s=0;s<n.length;s++){var l=[];St(n[s],l,i,!0),o.push(l)}}t.push(wt(e.id,a,o,e.properties))}}function At(t,e){e.push(Et(t[0])),e.push(Ct(t[1])),e.push(0)}function Tt(t,e,r,n){for(var a,i,o=0,s=0;s<t.length;s++){var l=Et(t[s][0]),u=Ct(t[s][1]);e.push(l),e.push(u),e.push(0),s>0&&(o+=n?(a*u-l*i)/2:Math.sqrt(Math.pow(l-a,2)+Math.pow(u-i,2))),a=l,i=u}var c=e.length-3;e[2]=1,function t(e,r,n,a){for(var i,o=a,s=e[r],l=e[r+1],u=e[n],c=e[n+1],f=r+3;f<n;f+=3){var h=_t(e[f],e[f+1],s,l,u,c);h>o&&(i=f,o=h)}o>a&&(i-r>3&&t(e,r,i,a),e[i+2]=o,n-i>3&&t(e,i,n,a))}(e,0,c,r),e[c+2]=1,e.size=Math.abs(o),e.start=0,e.end=e.size}function St(t,e,r,n){for(var a=0;a<t.length;a++){var i=[];Tt(t[a],i,r,n),e.push(i)}}function Et(t){return t/360+.5}function Ct(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Lt(t,e,r,n,a,i,o,s){if(n/=e,i>=(r/=e)&&o<=n)return t;if(i>n||o<r)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],f=c.geometry,h=c.type,p=0===a?c.minX:c.minY,d=0===a?c.maxX:c.maxY;if(p>=r&&d<=n)l.push(c);else if(!(p>n||d<r)){var v=[];if("Point"===h||"MultiPoint"===h)It(f,v,r,n,a);else if("LineString"===h)zt(f,v,r,n,a,!1,s.lineMetrics);else if("MultiLineString"===h)Ot(f,v,r,n,a,!1);else if("Polygon"===h)Ot(f,v,r,n,a,!0);else if("MultiPolygon"===h)for(var g=0;g<f.length;g++){var m=[];Ot(f[g],m,r,n,a,!0),m.length&&v.push(m)}if(v.length){if(s.lineMetrics&&"LineString"===h){for(g=0;g<v.length;g++)l.push(wt(c.id,h,v[g],c.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===v.length?(h="LineString",v=v[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===v.length?"Point":"MultiPoint"),l.push(wt(c.id,h,v,c.tags))}}}return l.length?l:null}function It(t,e,r,n,a){for(var i=0;i<t.length;i+=3){var o=t[i+a];o>=r&&o<=n&&(e.push(t[i]),e.push(t[i+1]),e.push(t[i+2]))}}function zt(t,e,r,n,a,i,o){for(var s,l,u=Pt(t),c=0===a?Rt:Bt,f=t.start,h=0;h<t.length-3;h+=3){var p=t[h],d=t[h+1],v=t[h+2],g=t[h+3],m=t[h+4],y=0===a?p:d,x=0===a?g:m,b=!1;o&&(s=Math.sqrt(Math.pow(p-g,2)+Math.pow(d-m,2))),y<r?x>=r&&(l=c(u,p,d,g,m,r),o&&(u.start=f+s*l)):y>n?x<=n&&(l=c(u,p,d,g,m,n),o&&(u.start=f+s*l)):Dt(u,p,d,v),x<r&&y>=r&&(l=c(u,p,d,g,m,r),b=!0),x>n&&y<=n&&(l=c(u,p,d,g,m,n),b=!0),!i&&b&&(o&&(u.end=f+s*l),e.push(u),u=Pt(t)),o&&(f+=s)}var _=t.length-3;p=t[_],d=t[_+1],v=t[_+2],(y=0===a?p:d)>=r&&y<=n&&Dt(u,p,d,v),_=u.length-3,i&&_>=3&&(u[_]!==u[0]||u[_+1]!==u[1])&&Dt(u,u[0],u[1],u[2]),u.length&&e.push(u)}function Pt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function Ot(t,e,r,n,a,i){for(var o=0;o<t.length;o++)zt(t[o],e,r,n,a,i,!1)}function Dt(t,e,r,n){t.push(e),t.push(r),t.push(n)}function Rt(t,e,r,n,a,i){var o=(i-e)/(n-e);return t.push(i),t.push(r+(a-r)*o),t.push(1),o}function Bt(t,e,r,n,a,i){var o=(i-r)/(a-r);return t.push(e+(n-e)*o),t.push(i),t.push(1),o}function Ft(t,e){for(var r=[],n=0;n<t.length;n++){var a,i=t[n],o=i.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)a=Nt(i.geometry,e);else if("MultiLineString"===o||"Polygon"===o){a=[];for(var s=0;s<i.geometry.length;s++)a.push(Nt(i.geometry[s],e))}else if("MultiPolygon"===o)for(a=[],s=0;s<i.geometry.length;s++){for(var l=[],u=0;u<i.geometry[s].length;u++)l.push(Nt(i.geometry[s][u],e));a.push(l)}r.push(wt(i.id,o,a,i.tags))}return r}function Nt(t,e){var r=[];r.size=t.size,void 0!==t.start&&(r.start=t.start,r.end=t.end);for(var n=0;n<t.length;n+=3)r.push(t[n]+e,t[n+1],t[n+2]);return r}function jt(t,e){if(t.transformed)return t;var r,n,a,i=1<<t.z,o=t.x,s=t.y;for(r=0;r<t.features.length;r++){var l=t.features[r],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(n=0;n<u.length;n+=2)l.geometry.push(Vt(u[n],u[n+1],e,i,o,s));else for(n=0;n<u.length;n++){var f=[];for(a=0;a<u[n].length;a+=2)f.push(Vt(u[n][a],u[n][a+1],e,i,o,s));l.geometry.push(f)}}return t.transformed=!0,t}function Vt(t,e,r,n,a,i){return[Math.round(r*(t*n-a)),Math.round(r*(e*n-i))]}function Ut(t,e,r,n,a){for(var i=e===a.maxZoom?0:a.tolerance/((1<<e)*a.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){o.numFeatures++,qt(o,t[s],i,a);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,f=t[s].maxY;l<o.minX&&(o.minX=l),u<o.minY&&(o.minY=u),c>o.maxX&&(o.maxX=c),f>o.maxY&&(o.maxY=f)}return o}function qt(t,e,r,n){var a=e.geometry,i=e.type,o=[];if("Point"===i||"MultiPoint"===i)for(var s=0;s<a.length;s+=3)o.push(a[s]),o.push(a[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===i)Ht(o,a,t,r,!1,!1);else if("MultiLineString"===i||"Polygon"===i)for(s=0;s<a.length;s++)Ht(o,a[s],t,r,"Polygon"===i,0===s);else if("MultiPolygon"===i)for(var l=0;l<a.length;l++){var u=a[l];for(s=0;s<u.length;s++)Ht(o,u[s],t,r,!0,0===s)}if(o.length){var c=e.tags||null;if("LineString"===i&&n.lineMetrics){for(var f in c={},e.tags)c[f]=e.tags[f];c.mapbox_clip_start=a.start/a.size,c.mapbox_clip_end=a.end/a.size}var h={geometry:o,type:"Polygon"===i||"MultiPolygon"===i?3:"LineString"===i||"MultiLineString"===i?2:1,tags:c};null!==e.id&&(h.id=e.id),t.features.push(h)}}function Ht(t,e,r,n,a,i){var o=n*n;if(n>0&&e.size<(a?o:n))r.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===n||e[l+2]>o)&&(r.numSimplified++,s.push(e[l]),s.push(e[l+1])),r.numPoints++;a&&function(t,e){for(var r=0,n=0,a=t.length,i=a-2;n<a;i=n,n+=2)r+=(t[n]-t[i])*(t[n+1]+t[i+1]);if(r>0===e)for(n=0,a=t.length;n<a/2;n+=2){var o=t[n],s=t[n+1];t[n]=t[a-2-n],t[n+1]=t[a-1-n],t[a-2-n]=o,t[a-1-n]=s}}(s,i),t.push(s)}}function Gt(t,e){var r=(e=this.options=function(t,e){for(var r in e)t[r]=e[r];return t}(Object.create(this.options),e)).debug;if(r&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");var n=function(t,e){var r=[];if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)Mt(r,t.features[n],e);else"Feature"===t.type?Mt(r,t,e):Mt(r,{geometry:t},e);return r}(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(t,e){var r=e.buffer/e.extent,n=t,a=Lt(t,1,-1-r,r,0,-1,2,e),i=Lt(t,1,1-r,2+r,0,-1,2,e);return(a||i)&&(n=Lt(t,1,-r,1+r,0,-1,2,e)||[],a&&(n=Ft(a,1).concat(n)),i&&(n=n.concat(Ft(i,-1)))),n}(n,e)).length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Wt(t,e,r){return 32*((1<<t)*r+e)+t}function Yt(t,e){var r=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var n=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!n)return e(null,null);var a=new B(n.features),i=U(a);0===i.byteOffset&&i.byteLength===i.buffer.byteLength||(i=new Uint8Array(i)),e(null,{vectorTile:a,rawData:i.buffer})}ft.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var r="prepare "+t.length+" points";e&&console.time(r),this.points=t;var n=t.map(pt);e&&console.timeEnd(r);for(var a=this.options.maxZoom;a>=this.options.minZoom;a--){var i=+Date.now();this.trees[a+1]=ot(n,xt,bt,this.options.nodeSize,Float32Array),n=this._cluster(n,a),e&&console.log("z%d: %d clusters in %dms",a,n.length,+Date.now()-i)}return this.trees[this.options.minZoom]=ot(n,xt,bt,this.options.nodeSize,Float32Array),e&&console.timeEnd("total time"),this},getClusters:function(t,e){for(var r=this.trees[this._limitZoom(e)],n=r.range(gt(t[0]),mt(t[3]),gt(t[2]),mt(t[1])),a=[],i=0;i<n.length;i++){var o=r.points[n[i]];a.push(o.numPoints?dt(o):this.points[o.id])}return a},getChildren:function(t,e){for(var r=this.trees[e+1].points[t],n=this.options.radius/(this.options.extent*Math.pow(2,e)),a=this.trees[e+1].within(r.x,r.y,n),i=[],o=0;o<a.length;o++){var s=this.trees[e+1].points[a[o]];s.parentId===t&&i.push(s.numPoints?dt(s):this.points[s.id])}return i},getLeaves:function(t,e,r,n){r=r||10,n=n||0;var a=[];return this._appendLeaves(a,t,e,r,n,0),a},getTile:function(t,e,r){var n=this.trees[this._limitZoom(t)],a=Math.pow(2,t),i=this.options.extent,o=this.options.radius/i,s=(r-o)/a,l=(r+1+o)/a,u={features:[]};return this._addTileFeatures(n.range((e-o)/a,s,(e+1+o)/a,l),n.points,e,r,a,u),0===e&&this._addTileFeatures(n.range(1-o/a,s,1,l),n.points,a,r,a,u),e===a-1&&this._addTileFeatures(n.range(0,s,o/a,l),n.points,-1,r,a,u),u.features.length?u:null},getClusterExpansionZoom:function(t,e){for(;e<this.options.maxZoom;){var r=this.getChildren(t,e);if(e++,1!==r.length)break;t=r[0].properties.cluster_id}return e},_appendLeaves:function(t,e,r,n,a,i){for(var o=this.getChildren(e,r),s=0;s<o.length;s++){var l=o[s].properties;if(l.cluster?i+l.point_count<=a?i+=l.point_count:i=this._appendLeaves(t,l.cluster_id,r+1,n,a,i):i<a?i++:t.push(o[s]),t.length===n)break}return i},_addTileFeatures:function(t,e,r,n,a,i){for(var o=0;o<t.length;o++){var s=e[t[o]];i.features.push({type:1,geometry:[[Math.round(this.options.extent*(s.x*a-r)),Math.round(this.options.extent*(s.y*a-n))]],tags:s.numPoints?vt(s):this.points[s.id].properties})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var r=[],n=this.options.radius/(this.options.extent*Math.pow(2,e)),a=0;a<t.length;a++){var i=t[a];if(!(i.zoom<=e)){i.zoom=e;var o=this.trees[e+1],s=o.within(i.x,i.y,n),l=i.numPoints||1,u=i.x*l,c=i.y*l,f=null;this.options.reduce&&(f=this.options.initial(),this._accumulate(f,i));for(var h=0;h<s.length;h++){var p=o.points[s[h]];if(e<p.zoom){var d=p.numPoints||1;p.zoom=e,u+=p.x*d,c+=p.y*d,l+=d,p.parentId=a,this.options.reduce&&this._accumulate(f,p)}}1===l?r.push(i):(i.parentId=a,r.push(ht(u/l,c/l,l,a,f)))}}return r},_accumulate:function(t,e){var r=e.numPoints?e.properties:this.options.map(this.points[e.id].properties);this.options.reduce(t,r)}},Gt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,debug:0},Gt.prototype.splitTile=function(t,e,r,n,a,i,o){for(var s=[t,e,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,f=Wt(e,r,n),h=this.tiles[f];if(!h&&(u>1&&console.time("creation"),h=this.tiles[f]=Ut(t,e,r,n,l),this.tileCoords.push({z:e,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,n,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var p="z"+e;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(h.source=t,a){if(e===l.maxZoom||e===a)continue;var d=1<<a-e;if(r!==Math.floor(i/d)||n!==Math.floor(o/d))continue}else if(e===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue;if(h.source=null,0!==t.length){u>1&&console.time("clipping");var v,g,m,y,x,b,_=.5*l.buffer/l.extent,w=.5-_,k=.5+_,M=1+_;v=g=m=y=null,x=Lt(t,c,r-_,r+k,0,h.minX,h.maxX,l),b=Lt(t,c,r+w,r+M,0,h.minX,h.maxX,l),t=null,x&&(v=Lt(x,c,n-_,n+k,1,h.minY,h.maxY,l),g=Lt(x,c,n+w,n+M,1,h.minY,h.maxY,l),x=null),b&&(m=Lt(b,c,n-_,n+k,1,h.minY,h.maxY,l),y=Lt(b,c,n+w,n+M,1,h.minY,h.maxY,l),b=null),u>1&&console.timeEnd("clipping"),s.push(v||[],e+1,2*r,2*n),s.push(g||[],e+1,2*r,2*n+1),s.push(m||[],e+1,2*r+1,2*n),s.push(y||[],e+1,2*r+1,2*n+1)}}},Gt.prototype.getTile=function(t,e,r){var n=this.options,a=n.extent,i=n.debug;if(t<0||t>24)return null;var o=1<<t,s=Wt(t,e=(e%o+o)%o,r);if(this.tiles[s])return jt(this.tiles[s],a);i>1&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var l,u=t,c=e,f=r;!l&&u>0;)u--,c=Math.floor(c/2),f=Math.floor(f/2),l=this.tiles[Wt(u,c,f)];return l&&l.source?(i>1&&console.log("found parent tile z%d-%d-%d",u,c,f),i>1&&console.time("drilling down"),this.splitTile(l.source,u,c,f,t,e,r),i>1&&console.timeEnd("drilling down"),this.tiles[s]?jt(this.tiles[s],a):null):null};var Xt=function(e){function r(t,r,n){e.call(this,t,r,Yt),n&&(this.loadGeoJSON=n)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},r.prototype._loadData=function(){var t=this;if(this._pendingCallback&&this._pendingLoadDataParams){var e=this._pendingCallback,r=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams,this.loadGeoJSON(r,function(n,a){if(n||!a)return e(n);if("object"!=typeof a)return e(new Error("Input data is not a valid GeoJSON object."));I(a,!0);try{t._geoJSONIndex=r.cluster?ct(r.superclusterOptions).load(a.features):function(t,e){return new Gt(t,e)}(a,r.geojsonVtOptions)}catch(n){return e(n)}t.loaded={};var i={};if(r.request&&r.request.collectResourceTiming){var o=w(r.request.url);o&&(i.resourceTiming={},i.resourceTiming[r.source]=JSON.parse(JSON.stringify(o)))}e(null,i)})}},r.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},r.prototype.reloadTile=function(t,r){var n=this.loaded,a=t.uid;return n&&n[a]?e.prototype.reloadTile.call(this,t,r):this.loadTile(t,r)},r.prototype.loadGeoJSON=function(e,r){if(e.request)t.getJSON(e.request,r);else{if("string"!=typeof e.data)return r(new Error("Input data is not a valid GeoJSON object."));try{return r(null,JSON.parse(e.data))}catch(t){return r(new Error("Input data is not a valid GeoJSON object."))}}},r.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},r}(M),Zt=function(e){var r=this;this.self=e,this.actor=new t.default$7(e,this),this.layerIndexes={},this.workerSourceTypes={vector:M,geojson:Xt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(r.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');r.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isLoaded())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText}};return Zt.prototype.setLayers=function(t,e,r){this.getLayerIndex(t).replace(e),r()},Zt.prototype.updateLayers=function(t,e,r){this.getLayerIndex(t).update(e.layers,e.removedIds),r()},Zt.prototype.loadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).loadTile(e,r)},Zt.prototype.loadDEMTile=function(t,e,r){this.getDEMWorkerSource(t,e.source).loadTile(e,r)},Zt.prototype.reloadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).reloadTile(e,r)},Zt.prototype.abortTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).abortTile(e,r)},Zt.prototype.removeTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).removeTile(e,r)},Zt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},Zt.prototype.removeSource=function(t,e,r){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var n=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==n.removeSource?n.removeSource(e,r):r()}},Zt.prototype.loadWorkerSource=function(t,e,r){try{this.self.importScripts(e.url),r()}catch(t){r(t.toString())}},Zt.prototype.loadRTLTextPlugin=function(e,r,n){try{t.plugin.isLoaded()||(this.self.importScripts(r),n(t.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+r)))}catch(t){n(t.toString())}},Zt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new n),e},Zt.prototype.getWorkerSource=function(t,e,r){var n=this;if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][r]){var a={send:function(e,r,a){n.actor.send(e,r,a,t)}};this.workerSources[t][e][r]=new this.workerSourceTypes[e](a,this.getLayerIndex(t))}return this.workerSources[t][e][r]},Zt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new A),this.demWorkerSources[t][e]},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&new Zt(self),Zt});a(["./chunk1.js"],function(t){"use strict";var e=t.createCommonjsModule(function(t){function e(t){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,r=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(r);try{e=new Worker(n),t=!0}catch(e){t=!1}e&&e.terminate();return URL.revokeObjectURL(n),t}()&&"Uint8ClampedArray"in window&&function(t){void 0===r[t]&&(r[t]=function(t){var r=document.createElement("canvas"),n=Object.create(e.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=t,r.probablySupportsContext?r.probablySupportsContext("webgl",n)||r.probablySupportsContext("experimental-webgl",n):r.supportsContext?r.supportsContext("webgl",n)||r.supportsContext("experimental-webgl",n):r.getContext("webgl",n)||r.getContext("experimental-webgl",n)}(t));return r[t]}(t&&t.failIfMajorPerformanceCaveat))}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e);var r={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),r=t.default.performance&&t.default.performance.now?t.default.performance.now.bind(t.default.performance):Date.now.bind(Date),n=t.default.requestAnimationFrame||t.default.mozRequestAnimationFrame||t.default.webkitRequestAnimationFrame||t.default.msRequestAnimationFrame,a=t.default.cancelAnimationFrame||t.default.mozCancelAnimationFrame||t.default.webkitCancelAnimationFrame||t.default.msCancelAnimationFrame,i={now:r,frame:function(t){return n(t)},cancelFrame:function(t){return a(t)},getImageData:function(e){var r=t.default.document.createElement("canvas"),n=r.getContext("2d");if(!n)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,n.drawImage(e,0,0,e.width,e.height),n.getImageData(0,0,e.width,e.height)},hardwareConcurrency:t.default.navigator.hardwareConcurrency||4,get devicePixelRatio(){return t.default.devicePixelRatio},supportsWebp:!1};if(t.default.document){var o=t.default.document.createElement("img");o.onload=function(){i.supportsWebp=!0},o.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="}var s={create:function(e,r,n){var a=t.default.document.createElement(e);return r&&(a.className=r),n&&n.appendChild(a),a},createNS:function(e,r){return t.default.document.createElementNS(e,r)}},l=t.default.document?t.default.document.documentElement.style:null;function u(t){if(!l)return null;for(var e=0;e<t.length;e++)if(t[e]in l)return t[e];return t[0]}var c,f=u(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);s.disableDrag=function(){l&&f&&(c=l[f],l[f]="none")},s.enableDrag=function(){l&&f&&(l[f]=c)};var h=u(["transform","WebkitTransform"]);s.setTransform=function(t,e){t.style[h]=e};var p=!1;try{var d=Object.defineProperty({},"passive",{get:function(){p=!0}});t.default.addEventListener("test",d,d),t.default.removeEventListener("test",d,d)}catch(t){p=!1}s.addEventListener=function(t,e,r,n){void 0===n&&(n={}),"passive"in n&&p?t.addEventListener(e,r,n):t.addEventListener(e,r,n.capture)},s.removeEventListener=function(t,e,r,n){void 0===n&&(n={}),"passive"in n&&p?t.removeEventListener(e,r,n):t.removeEventListener(e,r,n.capture)};var v=function(e){e.preventDefault(),e.stopPropagation(),t.default.removeEventListener("click",v,!0)};s.suppressClick=function(){t.default.addEventListener("click",v,!0),t.default.setTimeout(function(){t.default.removeEventListener("click",v,!0)},0)},s.mousePos=function(e,r){var n=e.getBoundingClientRect();return r=r.touches?r.touches[0]:r,new t.default$1(r.clientX-n.left-e.clientLeft,r.clientY-n.top-e.clientTop)},s.touchPos=function(e,r){for(var n=e.getBoundingClientRect(),a=[],i="touchend"===r.type?r.changedTouches:r.touches,o=0;o<i.length;o++)a.push(new t.default$1(i[o].clientX-n.left-e.clientLeft,i[o].clientY-n.top-e.clientTop));return a},s.mouseButton=function(e){return void 0!==t.default.InstallTrigger&&2===e.button&&e.ctrlKey&&t.default.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},s.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var g={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null},m="See https://www.mapbox.com/api-documentation/#access-tokens";function y(t,e){var r=T(g.API_URL);if(t.protocol=r.protocol,t.authority=r.authority,"/"!==r.path&&(t.path=""+r.path+t.path),!g.REQUIRE_ACCESS_TOKEN)return S(t);if(!(e=e||g.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+m);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+m);return t.params.push("access_token="+e),S(t)}function x(t){return 0===t.indexOf("mapbox:")}var b=function(t,e){if(!x(t))return t;var r=T(t);return r.path="/fonts/v1"+r.path,y(r,e)},_=function(t,e){if(!x(t))return t;var r=T(t);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),y(r,e)},w=function(t,e,r,n){var a=T(t);return x(t)?(a.path="/styles/v1"+a.path+"/sprite"+e+r,y(a,n)):(a.path+=""+e+r,S(a))},k=/(\.(png|jpg)\d*)(?=$)/,M=function(t,e,r){if(!e||!x(e))return t;var n=T(t),a=i.devicePixelRatio>=2||512===r?"@2x":"",o=i.supportsWebp?".webp":"$1";return n.path=n.path.replace(k,""+a+o),function(t){for(var e=0;e<t.length;e++)0===t[e].indexOf("access_token=tk.")&&(t[e]="access_token="+(g.ACCESS_TOKEN||""))}(n.params),S(n)};var A=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function T(t){var e=t.match(A);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function S(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}var E=t.default.HTMLImageElement,C=t.default.HTMLCanvasElement,L=t.default.HTMLVideoElement,I=t.default.ImageData,z=function(t,e,r,n){this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(e,n)};z.prototype.update=function(t,e){var r=t.width,n=t.height,a=!this.size||this.size[0]!==r||this.size[1]!==n,i=this.context,o=i.gl;this.useMipmap=Boolean(e&&e.useMipmap),o.bindTexture(o.TEXTURE_2D,this.texture),a?(this.size=[r,n],i.pixelStoreUnpack.set(1),this.format!==o.RGBA||e&&!1===e.premultiply||i.pixelStoreUnpackPremultiplyAlpha.set(!0),t instanceof E||t instanceof C||t instanceof L||t instanceof I?o.texImage2D(o.TEXTURE_2D,0,this.format,this.format,o.UNSIGNED_BYTE,t):o.texImage2D(o.TEXTURE_2D,0,this.format,r,n,0,this.format,o.UNSIGNED_BYTE,t.data)):t instanceof E||t instanceof C||t instanceof L||t instanceof I?o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,t):o.texSubImage2D(o.TEXTURE_2D,0,0,0,r,n,o.RGBA,o.UNSIGNED_BYTE,t.data),this.useMipmap&&this.isSizePowerOfTwo()&&o.generateMipmap(o.TEXTURE_2D)},z.prototype.bind=function(t,e,r){var n=this.context.gl;n.bindTexture(n.TEXTURE_2D,this.texture),r!==n.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=n.LINEAR),t!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r||t),this.filter=t),e!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e),this.wrap=e)},z.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},z.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var P=function(){this.images={},this.loaded=!1,this.requestors=[],this.shelfPack=new t.default$2(64,64,{autoResize:!0}),this.patterns={},this.atlasImage=new t.RGBAImage({width:64,height:64}),this.dirty=!0};P.prototype.isLoaded=function(){return this.loaded},P.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,r=this.requestors;e<r.length;e+=1){var n=r[e],a=n.ids,i=n.callback;this._notify(a,i)}this.requestors=[]}},P.prototype.getImage=function(t){return this.images[t]},P.prototype.addImage=function(t,e){this.images[t]=e},P.prototype.removeImage=function(t){delete this.images[t];var e=this.patterns[t];e&&(this.shelfPack.unref(e.bin),delete this.patterns[t])},P.prototype.getImages=function(t,e){var r=!0;if(!this.isLoaded())for(var n=0,a=t;n<a.length;n+=1){var i=a[n];this.images[i]||(r=!1)}this.isLoaded()||r?this._notify(t,e):this.requestors.push({ids:t,callback:e})},P.prototype._notify=function(t,e){for(var r={},n=0,a=t;n<a.length;n+=1){var i=a[n],o=this.images[i];o&&(r[i]={data:o.data.clone(),pixelRatio:o.pixelRatio,sdf:o.sdf})}e(null,r)},P.prototype.getPixelSize=function(){return{width:this.shelfPack.w,height:this.shelfPack.h}},P.prototype.getPattern=function(e){var r=this.patterns[e];if(r)return r.position;var n=this.getImage(e);if(!n)return null;var a=n.data.width+2,i=n.data.height+2,o=this.shelfPack.packOne(a,i);if(!o)return null;this.atlasImage.resize(this.getPixelSize());var s=n.data,l=this.atlasImage,u=o.x+1,c=o.y+1,f=s.width,h=s.height;t.RGBAImage.copy(s,l,{x:0,y:0},{x:u,y:c},{width:f,height:h}),t.RGBAImage.copy(s,l,{x:0,y:h-1},{x:u,y:c-1},{width:f,height:1}),t.RGBAImage.copy(s,l,{x:0,y:0},{x:u,y:c+h},{width:f,height:1}),t.RGBAImage.copy(s,l,{x:f-1,y:0},{x:u-1,y:c},{width:1,height:h}),t.RGBAImage.copy(s,l,{x:0,y:0},{x:u+f,y:c},{width:1,height:h}),this.dirty=!0;var p=new t.ImagePosition(o,n);return this.patterns[e]={bin:o,position:p},p},P.prototype.bind=function(t){var e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new z(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)};var O=R,D=1e20;function R(t,e,r,n,a,i){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=n||.25,this.fontFamily=a||"sans-serif",this.fontWeight=i||"normal",this.radius=r||8;var o=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(o*o),this.gridInner=new Float64Array(o*o),this.f=new Float64Array(o),this.d=new Float64Array(o),this.z=new Float64Array(o+1),this.v=new Int16Array(o),this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function B(t,e,r,n,a,i,o){for(var s=0;s<e;s++){for(var l=0;l<r;l++)n[l]=t[l*e+s];for(F(n,a,i,o,r),l=0;l<r;l++)t[l*e+s]=a[l]}for(l=0;l<r;l++){for(s=0;s<e;s++)n[s]=t[l*e+s];for(F(n,a,i,o,e),s=0;s<e;s++)t[l*e+s]=Math.sqrt(a[s])}}function F(t,e,r,n,a){r[0]=0,n[0]=-D,n[1]=+D;for(var i=1,o=0;i<a;i++){for(var s=(t[i]+i*i-(t[r[o]]+r[o]*r[o]))/(2*i-2*r[o]);s<=n[o];)o--,s=(t[i]+i*i-(t[r[o]]+r[o]*r[o]))/(2*i-2*r[o]);r[++o]=i,n[o]=s,n[o+1]=+D}for(i=0,o=0;i<a;i++){for(;n[o+1]<i;)o++;e[i]=(i-r[o])*(i-r[o])+t[r[o]]}}R.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),r=new Uint8ClampedArray(this.size*this.size),n=0;n<this.size*this.size;n++){var a=e.data[4*n+3]/255;this.gridOuter[n]=1===a?0:0===a?D:Math.pow(Math.max(0,.5-a),2),this.gridInner[n]=1===a?D:0===a?0:Math.pow(Math.max(0,a-.5),2)}for(B(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),B(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),n=0;n<this.size*this.size;n++){var i=this.gridOuter[n]-this.gridInner[n];r[n]=Math.max(0,Math.min(255,Math.round(255-255*(i/this.radius+this.cutoff))))}return r};var N=function(t,e){this.requestTransform=t,this.localIdeographFontFamily=e,this.entries={}};N.prototype.setURL=function(t){this.url=t},N.prototype.getGlyphs=function(e,r){var n=this,a=[];for(var i in e)for(var o=0,s=e[i];o<s.length;o+=1){var l=s[o];a.push({stack:i,id:l})}t.asyncAll(a,function(t,e){var r=t.stack,a=t.id,i=n.entries[r];i||(i=n.entries[r]={glyphs:{},requests:{}});var o=i.glyphs[a];if(void 0===o)if(o=n._tinySDF(i,r,a))e(null,{stack:r,id:a,glyph:o});else{var s=Math.floor(a/256);if(256*s>65535)e(new Error("glyphs > 65535 not supported"));else{var l=i.requests[s];l||(l=i.requests[s]=[],N.loadGlyphRange(r,s,n.url,n.requestTransform,function(t,e){if(e)for(var r in e)i.glyphs[+r]=e[+r];for(var n=0,a=l;n<a.length;n+=1){(0,a[n])(t,e)}delete i.requests[s]})),l.push(function(t,n){t?e(t):n&&e(null,{stack:r,id:a,glyph:n[a]||null})})}}else e(null,{stack:r,id:a,glyph:o})},function(t,e){if(t)r(t);else if(e){for(var n={},a=0,i=e;a<i.length;a+=1){var o=i[a],s=o.stack,l=o.id,u=o.glyph;(n[s]||(n[s]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}r(null,n)}})},N.prototype._tinySDF=function(e,r,n){var a=this.localIdeographFontFamily;if(a&&(t.default$4["CJK Unified Ideographs"](n)||t.default$4["Hangul Syllables"](n))){var i=e.tinySDF;if(!i){var o="400";/bold/i.test(r)?o="900":/medium/i.test(r)?o="500":/light/i.test(r)&&(o="200"),i=e.tinySDF=new N.TinySDF(24,3,8,.25,a,o)}return{id:n,bitmap:new t.AlphaImage({width:30,height:30},i.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},N.loadGlyphRange=function(e,r,n,a,i){var o=256*r,s=o+255,l=a(b(n).replace("{fontstack}",e).replace("{range}",o+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(l,function(e,r){if(e)i(e);else if(r){for(var n={},a=0,o=t.default$3(r.data);a<o.length;a+=1){var s=o[a];n[s.id]=s}i(null,n)}})},N.TinySDF=O;var j=function(){this.specification=t.default$5.light.position};j.prototype.possiblyEvaluate=function(e,r){return t.sphericalToCartesian(e.expression.evaluate(r))},j.prototype.interpolate=function(e,r,n){return{x:t.number(e.x,r.x,n),y:t.number(e.y,r.y,n),z:t.number(e.z,r.z,n)}};var V=new t.Properties({anchor:new t.DataConstantProperty(t.default$5.light.anchor),position:new j,color:new t.DataConstantProperty(t.default$5.light.color),intensity:new t.DataConstantProperty(t.default$5.light.intensity)}),U=function(e){function r(r){e.call(this),this._transitionable=new t.Transitionable(V),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.getLight=function(){return this._transitionable.serialize()},r.prototype.setLight=function(e){if(!this._validate(t.validateLight,e))for(var r in e){var n=e[r];t.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-"-transition".length),n):this._transitionable.setValue(r,n)}},r.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},r.prototype.hasTransition=function(){return this._transitioning.hasTransition()},r.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},r.prototype._validate=function(e,r){return t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.default$5})))},r}(t.Evented),q=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};q.prototype.getDash=function(t,e){var r=t.join(",")+String(e);return this.positions[r]||(this.positions[r]=this.addDash(t,e)),this.positions[r]},q.prototype.addDash=function(e,r){var n=r?7:0,a=2*n+1;if(this.nextRow+a>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var i=0,o=0;o<e.length;o++)i+=e[o];for(var s=this.width/i,l=s/2,u=e.length%2==1,c=-n;c<=n;c++)for(var f=this.nextRow+n+c,h=this.width*f,p=u?-e[e.length-1]:0,d=e[0],v=1,g=0;g<this.width;g++){for(;d<g/s;)p=d,d+=e[v],u&&v===e.length-1&&(d+=e[0]),v++;var m=Math.abs(g-p*s),y=Math.abs(g-d*s),x=Math.min(m,y),b=v%2==1,_=void 0;if(r){var w=n?c/n*(l+1):0;if(b){var k=l-Math.abs(w);_=Math.sqrt(x*x+k*k)}else _=l-Math.sqrt(x*x+w*w)}else _=(b?1:-1)*x;this.data[3+4*(h+g)]=Math.max(0,Math.min(255,_+128))}var M={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:i};return this.nextRow+=a,this.dirty=!0,M},q.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,this.data))};var H=function e(r,n){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var a=this.workerPool.acquire(this.id),i=0;i<a.length;i++){var o=a[i],s=new e.Actor(o,n,this.id);s.name="Worker "+i,this.actors.push(s)}};function G(e,r,n){var a=function(e,r){if(e)return n(e);if(r){var a=t.pick(r,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);r.vector_layers&&(a.vectorLayers=r.vector_layers,a.vectorLayerIds=a.vectorLayers.map(function(t){return t.id})),n(null,a)}};e.url?t.getJSON(r(_(e.url),t.ResourceType.Source),a):i.frame(function(){return a(null,e)})}H.prototype.broadcast=function(e,r,n){n=n||function(){},t.asyncAll(this.actors,function(t,n){t.send(e,r,n)},n)},H.prototype.send=function(t,e,r,n){return("number"!=typeof n||isNaN(n))&&(n=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[n].send(t,e,r),n},H.prototype.remove=function(){this.actors.forEach(function(t){t.remove()}),this.actors=[],this.workerPool.release(this.id)},H.Actor=t.default$7;var W=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};W.prototype.wrap=function(){return new W(t.wrap(this.lng,-180,180),this.lat)},W.prototype.toArray=function(){return[this.lng,this.lat]},W.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},W.prototype.toBounds=function(t){var e=360*t/40075017,r=e/Math.cos(Math.PI/180*this.lat);return new Y(new W(this.lng-r,this.lat-e),new W(this.lng+r,this.lat+e))},W.convert=function(t){if(t instanceof W)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new W(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new W(Number(t.lng),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Y=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Y.prototype.setNorthEast=function(t){return this._ne=t instanceof W?new W(t.lng,t.lat):W.convert(t),this},Y.prototype.setSouthWest=function(t){return this._sw=t instanceof W?new W(t.lng,t.lat):W.convert(t),this},Y.prototype.extend=function(t){var e,r,n=this._sw,a=this._ne;if(t instanceof W)e=t,r=t;else{if(!(t instanceof Y))return Array.isArray(t)?t.every(Array.isArray)?this.extend(Y.convert(t)):this.extend(W.convert(t)):this;if(e=t._sw,r=t._ne,!e||!r)return this}return n||a?(n.lng=Math.min(e.lng,n.lng),n.lat=Math.min(e.lat,n.lat),a.lng=Math.max(r.lng,a.lng),a.lat=Math.max(r.lat,a.lat)):(this._sw=new W(e.lng,e.lat),this._ne=new W(r.lng,r.lat)),this},Y.prototype.getCenter=function(){return new W((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Y.prototype.getSouthWest=function(){return this._sw},Y.prototype.getNorthEast=function(){return this._ne},Y.prototype.getNorthWest=function(){return new W(this.getWest(),this.getNorth())},Y.prototype.getSouthEast=function(){return new W(this.getEast(),this.getSouth())},Y.prototype.getWest=function(){return this._sw.lng},Y.prototype.getSouth=function(){return this._sw.lat},Y.prototype.getEast=function(){return this._ne.lng},Y.prototype.getNorth=function(){return this._ne.lat},Y.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Y.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Y.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Y.convert=function(t){return!t||t instanceof Y?t:new Y(t)};var X=function(t,e,r){this.bounds=Y.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=r||24};X.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},X.prototype.contains=function(t){var e=Math.floor(this.lngX(this.bounds.getWest(),t.z)),r=Math.floor(this.latY(this.bounds.getNorth(),t.z)),n=Math.ceil(this.lngX(this.bounds.getEast(),t.z)),a=Math.ceil(this.latY(this.bounds.getSouth(),t.z));return t.x>=e&&t.x<n&&t.y>=r&&t.y<a},X.prototype.lngX=function(t,e){return(t+180)*(Math.pow(2,e)/360)},X.prototype.latY=function(e,r){var n=t.clamp(Math.sin(Math.PI/180*e),-.9999,.9999),a=Math.pow(2,r)/(2*Math.PI);return Math.pow(2,r-1)+.5*Math.log((1+n)/(1-n))*-a};var Z=function(e){function r(r,n,a,i){if(e.call(this),this.id=r,this.dispatcher=a,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,t.extend(this,t.pick(n,["url","scheme","tileSize"])),this._options=t.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),G(this._options,this.map._transformRequest,function(r,n){r?e.fire(new t.ErrorEvent(r)):n&&(t.extend(e,n),n.bounds&&(e.tileBounds=new X(n.bounds,e.minzoom,e.maxzoom)),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},r.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.serialize=function(){return t.extend({},this._options)},r.prototype.loadTile=function(e,r){var n=M(e.tileID.canonical.url(this.tiles,this.scheme),this.url),a={request:this.map._transformRequest(n,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:i.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};function o(t,n){return e.aborted?r(null):t?r(t):(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),this.map._refreshExpiredTiles&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),r(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}a.request.collectResourceTiming=this._collectResourceTiming,void 0===e.workerID||"expired"===e.state?e.workerID=this.dispatcher.send("loadTile",a,o.bind(this)):"loading"===e.state?e.reloadCallback=r:this.dispatcher.send("reloadTile",a,o.bind(this),e.workerID)},r.prototype.abortTile=function(t){this.dispatcher.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},r.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},r.prototype.hasTransition=function(){return!1},r}(t.Evented),$=function(e){function r(r,n,a,i){e.call(this),this.id=r,this.dispatcher=a,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({},n),t.extend(this,t.pick(n,["url","scheme","tileSize"]))}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),G(this._options,this.map._transformRequest,function(r,n){r?e.fire(new t.ErrorEvent(r)):n&&(t.extend(e,n),n.bounds&&(e.tileBounds=new X(n.bounds,e.minzoom,e.maxzoom)),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.serialize=function(){return t.extend({},this._options)},r.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},r.prototype.loadTile=function(e,r){var n=this,a=M(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(a,t.ResourceType.Tile),function(t,a){if(delete e.request,e.aborted)e.state="unloaded",r(null);else if(t)e.state="errored",r(t);else if(a){n.map._refreshExpiredTiles&&e.setExpiryData(a),delete a.cacheControl,delete a.expires;var i=n.map.painter.context,o=i.gl;e.texture=n.map.painter.getTileTexture(a.width),e.texture?e.texture.update(a,{useMipmap:!0}):(e.texture=new z(i,a,o.RGBA,{useMipmap:!0}),e.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&o.texParameterf(o.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),e.state="loaded",r(null)}})},r.prototype.abortTile=function(t,e){t.request&&(t.request.abort(),delete t.request),e()},r.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},r.prototype.hasTransition=function(){return!1},r}(t.Evented),J=function(e){function r(r,n,a,i){e.call(this,r,n,a,i),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({},n),this.encoding=n.encoding||"mapbox"}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},r.prototype.loadTile=function(e,r){var n=M(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(n,t.ResourceType.Tile),function(t,n){if(delete e.request,e.aborted)e.state="unloaded",r(null);else if(t)e.state="errored",r(t);else if(n){this.map._refreshExpiredTiles&&e.setExpiryData(n),delete n.cacheControl,delete n.expires;var a=i.getImageData(n),o={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:a,encoding:this.encoding};e.workerID&&"expired"!==e.state||(e.workerID=this.dispatcher.send("loadDEMTile",o,function(t,n){t&&(e.state="errored",r(t));n&&(e.dem=n,e.needsHillshadePrepare=!0,e.state="loaded",r(null))}.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},r.prototype._getNeighboringTiles=function(e){var r=e.canonical,n=Math.pow(2,r.z),a=(r.x-1+n)%n,i=0===r.x?e.wrap-1:e.wrap,o=(r.x+1+n)%n,s=r.x+1===n?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,i,r.z,a,r.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,o,r.y).key]={backfilled:!1},r.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,i,r.z,a,r.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,o,r.y-1).key]={backfilled:!1}),r.y+1<n&&(l[new t.OverscaledTileID(e.overscaledZ,i,r.z,a,r.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,o,r.y+1).key]={backfilled:!1}),l},r.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:t.uid,source:this.id},void 0,t.workerID)},r}($),K=function(e){function r(r,n,a,i){e.call(this),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=a,this.setEventedParent(i),this._data=n.data,this._options=t.extend({},n),this._collectResourceTiming=n.collectResourceTiming,this._resourceTiming=[],void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type);var o=t.default$8/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*o,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*o,extent:t.default$8,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?Math.min(n.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:t.default$8,radius:(n.clusterRadius||50)*o,log:!1}},n.workerOptions)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(r){if(r)e.fire(new t.ErrorEvent(r));else{var n={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(n.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",n))}})},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.setData=function(e){var r=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(e){if(e)return r.fire(new t.ErrorEvent(e));var n={dataType:"source",sourceDataType:"content"};r._collectResourceTiming&&r._resourceTiming&&r._resourceTiming.length>0&&(n.resourceTiming=r._resourceTiming,r._resourceTiming=[]),r.fire(new t.Event("data",n))}),this},r.prototype._updateWorkerData=function(e){var r,n,a=this,i=t.extend({},this.workerOptions),o=this._data;"string"==typeof o?(i.request=this.map._transformRequest((r=o,(n=t.default.document.createElement("a")).href=r,n.href),t.ResourceType.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(o),this.workerID=this.dispatcher.send(this.type+"."+i.source+".loadData",i,function(t,r){a._removed||r&&r.abandoned||(a._loaded=!0,r&&r.resourceTiming&&r.resourceTiming[a.id]&&(a._resourceTiming=r.resourceTiming[a.id].slice(0)),a.dispatcher.send(a.type+"."+i.source+".coalesce",null,null,a.workerID),e(t))},this.workerID)},r.prototype.loadTile=function(t,e){var r=this,n=void 0===t.workerID?"loadTile":"reloadTile",a={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:i.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};t.workerID=this.dispatcher.send(n,a,function(a,i){return t.unloadVectorData(),t.aborted?e(null):a?e(a):(t.loadVectorData(i,r.map.painter,"reloadTile"===n),e(null))},this.workerID)},r.prototype.abortTile=function(t){t.aborted=!0},r.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},null,t.workerID)},r.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},r.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},r.prototype.hasTransition=function(){return!1},r}(t.Evented);var Q=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),tt=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};tt.prototype.bind=function(t,e,r,n,a,i,o,s){this.context=t;for(var l=this.boundPaintVertexBuffers.length!==n.length,u=0;!l&&u<n.length;u++)this.boundPaintVertexBuffers[u]!==n[u]&&(l=!0);var c=!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==r||l||this.boundIndexBuffer!==a||this.boundVertexOffset!==i||this.boundDynamicVertexBuffer!==o||this.boundDynamicVertexBuffer2!==s;!t.extVertexArrayObject||c?this.freshBind(e,r,n,a,i,o,s):(t.bindVertexArrayOES.set(this.vao),o&&o.bind(),a&&a.dynamicDraw&&a.bind(),s&&s.bind())},tt.prototype.freshBind=function(t,e,r,n,a,i,o){var s,l=t.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=i,this.boundDynamicVertexBuffer2=o;else{s=u.currentNumAttributes||0;for(var f=l;f<s;f++)c.disableVertexAttribArray(f)}e.enableAttributes(c,t);for(var h=0,p=r;h<p.length;h+=1){p[h].enableAttributes(c,t)}i&&i.enableAttributes(c,t),o&&o.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,a);for(var d=0,v=r;d<v.length;d+=1){var g=v[d];g.bind(),g.setVertexAttribPointers(c,t,a)}i&&(i.bind(),i.setVertexAttribPointers(c,t,a)),n&&n.bind(),o&&(o.bind(),o.setVertexAttribPointers(c,t,a)),u.currentNumAttributes=l},tt.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var et=function(e){function r(t,r,n,a){e.call(this),this.id=t,this.dispatcher=n,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(a),this.options=r}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._transformRequest(this.url,t.ResourceType.Image),function(r,n){r?e.fire(new t.ErrorEvent(r)):n&&(e.image=i.getImageData(n),e._finishLoading())})},r.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},r.prototype.onAdd=function(t){this.map=t,this.load()},r.prototype.setCoordinates=function(e){this.coordinates=e;var r=this.map,n=e.map(function(t){return r.transform.locationCoordinate(W.convert(t)).zoomTo(0)}),a=this.centerCoord=t.getCoordinatesCenter(n);a.column=Math.floor(a.column),a.row=Math.floor(a.row),this.tileID=new t.CanonicalTileID(a.zoom,a.column,a.row),this.minzoom=this.maxzoom=a.zoom;var i=n.map(function(e){var r=e.zoomTo(a.zoom);return new t.default$1(Math.round((r.column-a.column)*t.default$8),Math.round((r.row-a.row)*t.default$8))});return this._boundsArray=new t.RasterBoundsArray,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,t.default$8,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,t.default$8),this._boundsArray.emplaceBack(i[2].x,i[2].y,t.default$8,t.default$8),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},r.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,e=t.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Q.members)),this.boundsVAO||(this.boundsVAO=new tt),this.texture||(this.texture=new z(t,this.image,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var n=this.tiles[r];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}}},r.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},r.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return!1},r}(t.Evented),rt=function(e){function r(t,r,n,a){e.call(this,t,r,n,a),this.roundZoom=!0,this.type="video",this.options=r}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){var e=this,r=this.options;this.urls=[];for(var n=0,a=r.urls;n<a.length;n+=1){var i=a[n];e.urls.push(e.map._transformRequest(i,t.ResourceType.Source).url)}t.getVideo(this.urls,function(r,n){r?e.fire(new t.ErrorEvent(r)):n&&(e.video=n,e.video.loop=!0,e.video.addEventListener("playing",function(){e.map._rerender()}),e.map&&e.video.play(),e._finishLoading())})},r.prototype.getVideo=function(){return this.video},r.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},r.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,e=t.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Q.members)),this.boundsVAO||(this.boundsVAO=new tt),this.texture?this.video.paused||(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.video)):(this.texture=new z(t,this.video,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var n=this.tiles[r];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this.video&&!this.video.paused},r}(et),nt=function(e){function r(r,n,a,i){e.call(this,r,n,a,i),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(function(t){return!Array.isArray(t)||2!==t.length||t.some(function(t){return"number"!=typeof t})})||this.fire(new t.ErrorEvent(new t.default$9("sources."+r,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.default$9("sources."+r,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.ErrorEvent(new t.default$9("sources."+r,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof t.default.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.default$9("sources."+r,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.default$9("sources."+r,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof t.default.HTMLCanvasElement?this.options.canvas:t.default.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map._rerender()},this.pause=function(){this._playing=!1},this._finishLoading())},r.prototype.getCanvas=function(){return this.canvas},r.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},r.prototype.onRemove=function(){this.pause()},r.prototype.prepare=function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var e=this.map.painter.context,r=e.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,Q.members)),this.boundsVAO||(this.boundsVAO=new tt),this.texture?t?this.texture.update(this.canvas):this._playing&&(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.canvas)):(this.texture=new z(e,this.canvas,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var a=this.tiles[n];"loaded"!==a.state&&(a.state="loaded",a.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this._playing},r.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var r=e[t];if(isNaN(r)||r<=0)return!0}return!1},r}(et),at={vector:Z,raster:$,"raster-dem":J,geojson:K,video:rt,image:et,canvas:nt},it=function(e,r,n,a){var i=new at[r.type](e,r,n,a);if(i.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+i.id);return t.bindAll(["load","abort","unload","serialize","prepare"],i),i};function ot(t,e,r,n,a){var i=a.maxPitchScaleFactor(),o=t.tilesIn(r,i);o.sort(st);for(var s=[],l=0,u=o;l<u.length;l+=1){var c=u[l];s.push({wrappedTileID:c.tileID.wrapped().key,queryResults:c.tile.queryRenderedFeatures(e,c.queryGeometry,c.scale,n,a,i,t.transform.calculatePosMatrix(c.tileID.toUnwrapped()))})}return function(t){for(var e={},r={},n=0,a=t;n<a.length;n+=1){var i=a[n],o=i.queryResults,s=i.wrappedTileID,l=r[s]=r[s]||{};for(var u in o)for(var c=o[u],f=l[u]=l[u]||{},h=e[u]=e[u]||[],p=0,d=c;p<d.length;p+=1){var v=d[p];f[v.featureIndex]||(f[v.featureIndex]=!0,h.push(v.feature))}}return e}(s)}function st(t,e){var r=t.tileID,n=e.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}var lt=function(e,r){this.tileID=e,this.uid=t.uniqueId(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.expiredRequestCount=0,this.state="loading"};lt.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<i.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},lt.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},lt.prototype.loadVectorData=function(e,r,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){if(e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(t,e){var r={};if(!e)return r;for(var n=0,a=t;n<a.length;n+=1){var i=a[n],o=i.layerIds.map(function(t){return e.getLayer(t)}).filter(Boolean);if(0!==o.length){i.layers=o;for(var s=0,l=o;s<l.length;s+=1)r[l[s].id]=i}}return r}(e.buckets,r.style),n)for(var a in this.buckets){var i=this.buckets[a];i instanceof t.default$14&&(i.justReloaded=!0)}for(var o in this.queryPadding=0,this.buckets){var s=this.buckets[o];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(s.layerIds[0]).queryRadius(s))}e.iconAtlasImage&&(this.iconAtlasImage=e.iconAtlasImage),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new t.CollisionBoxArray},lt.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.iconAtlasTexture&&this.iconAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},lt.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},lt.prototype.getBucket=function(t){return this.buckets[t.id]},lt.prototype.upload=function(t){for(var e in this.buckets){var r=this.buckets[e];r.uploaded||(r.upload(t),r.uploaded=!0)}var n=t.gl;this.iconAtlasImage&&(this.iconAtlasTexture=new z(t,this.iconAtlasImage,n.RGBA),this.iconAtlasImage=null),this.glyphAtlasImage&&(this.glyphAtlasTexture=new z(t,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)},lt.prototype.queryRenderedFeatures=function(t,e,r,n,a,i,o){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:e,scale:r,tileSize:this.tileSize,posMatrix:o,transform:a,params:n,queryPadding:this.queryPadding*i},t):{}},lt.prototype.querySourceFeatures=function(e,r){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var n=this.latestFeatureIndex.loadVTLayers(),a=r?r.sourceLayer:"",i=n._geojsonTileLayer||n[a];if(i)for(var o=t.default$13(r&&r.filter),s={z:this.tileID.overscaledZ,x:this.tileID.canonical.x,y:this.tileID.canonical.y},l=0;l<i.length;l++){var u=i.feature(l);if(o(new t.default$16(this.tileID.overscaledZ),u)){var c=new t.default$12(u,s.z,s.x,s.y);c.tile=s,e.push(c)}}}},lt.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},lt.prototype.setMask=function(e,r){if(!t.default$10(this.mask,e)&&(this.mask=e,this.clearMask(),!t.default$10(e,{0:!0}))){var n=new t.RasterBoundsArray,a=new t.TriangleIndexArray;this.segments=new t.default$15,this.segments.prepareSegment(0,n,a);for(var i=Object.keys(e),o=0;o<i.length;o++){var s=e[i[o]],l=t.default$8>>s.z,u=new t.default$1(s.x*l,s.y*l),c=new t.default$1(u.x+l,u.y+l),f=this.segments.prepareSegment(4,n,a);n.emplaceBack(u.x,u.y,u.x,u.y),n.emplaceBack(c.x,u.y,c.x,u.y),n.emplaceBack(u.x,c.y,u.x,c.y),n.emplaceBack(c.x,c.y,c.x,c.y);var h=f.vertexLength;a.emplaceBack(h,h+1,h+2),a.emplaceBack(h+1,h+2,h+3),f.vertexLength+=4,f.primitiveLength+=2}this.maskedBoundsBuffer=r.createVertexBuffer(n,Q.members),this.maskedIndexBuffer=r.createIndexBuffer(a)}},lt.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},lt.prototype.setExpiryData=function(e){var r=this.expirationTime;if(e.cacheControl){var n=t.parseCacheControl(e.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var a=Date.now(),i=!1;if(this.expirationTime>a)i=!1;else if(r)if(this.expirationTime<r)i=!0;else{var o=this.expirationTime-r;o?this.expirationTime=a+Math.max(o,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},lt.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)};var ut=function(t,e){this.max=t,this.onRemove=e,this.reset()};ut.prototype.reset=function(){for(var t in this.data)for(var e=0,r=this.data[t];e<r.length;e+=1){var n=r[e];n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value)}return this.data={},this.order=[],this},ut.prototype.add=function(t,e,r){var n=this,a=t.wrapped().key;void 0===this.data[a]&&(this.data[a]=[]);var i={value:e,timeout:void 0};if(void 0!==r&&(i.timeout=setTimeout(function(){n.remove(t,i)},r)),this.data[a].push(i),this.order.push(a),this.order.length>this.max){var o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this},ut.prototype.has=function(t){return t.wrapped().key in this.data},ut.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},ut.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},ut.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},ut.prototype.remove=function(t,e){if(!this.has(t))return this;var r=t.wrapped().key,n=void 0===e?0:this.data[r].indexOf(e),a=this.data[r][n];return this.data[r].splice(n,1),a.timeout&&clearTimeout(a.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(a.value),this.order.splice(this.order.indexOf(r),1),this},ut.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this};var ct=function(t,e,r){this.context=t;var n=t.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.unbindVAO(),t.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};ct.prototype.unbindVAO=function(){this.context.extVertexArrayObject&&this.context.bindVertexArrayOES.set(null)},ct.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ct.prototype.updateData=function(t){var e=this.context.gl;this.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},ct.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var ft={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ht=function(t,e,r,n){this.length=e.length,this.attributes=r,this.itemSize=e.bytesPerElement,this.dynamicDraw=n,this.context=t;var a=t.gl;this.buffer=a.createBuffer(),t.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};ht.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ht.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},ht.prototype.enableAttributes=function(t,e){for(var r=0;r<this.attributes.length;r++){var n=this.attributes[r],a=e.attributes[n.name];void 0!==a&&t.enableVertexAttribArray(a)}},ht.prototype.setVertexAttribPointers=function(t,e,r){for(var n=0;n<this.attributes.length;n++){var a=this.attributes[n],i=e.attributes[a.name];void 0!==i&&t.vertexAttribPointer(i,a.components,t[ft[a.type]],!1,this.itemSize,a.offset+this.itemSize*(r||0))}},ht.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var pt=function(e){this.context=e,this.current=t.default$6.transparent};pt.prototype.get=function(){return this.current},pt.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a||(this.context.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t)};var dt=function(t){this.context=t,this.current=1};dt.prototype.get=function(){return this.current},dt.prototype.set=function(t){this.current!==t&&(this.context.gl.clearDepth(t),this.current=t)};var vt=function(t){this.context=t,this.current=0};vt.prototype.get=function(){return this.current},vt.prototype.set=function(t){this.current!==t&&(this.context.gl.clearStencil(t),this.current=t)};var gt=function(t){this.context=t,this.current=[!0,!0,!0,!0]};gt.prototype.get=function(){return this.current},gt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(this.context.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t)};var mt=function(t){this.context=t,this.current=!0};mt.prototype.get=function(){return this.current},mt.prototype.set=function(t){this.current!==t&&(this.context.gl.depthMask(t),this.current=t)};var yt=function(t){this.context=t,this.current=255};yt.prototype.get=function(){return this.current},yt.prototype.set=function(t){this.current!==t&&(this.context.gl.stencilMask(t),this.current=t)};var xt=function(t){this.context=t,this.current={func:t.gl.ALWAYS,ref:0,mask:255}};xt.prototype.get=function(){return this.current},xt.prototype.set=function(t){var e=this.current;t.func===e.func&&t.ref===e.ref&&t.mask===e.mask||(this.context.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t)};var bt=function(t){this.context=t;var e=this.context.gl;this.current=[e.KEEP,e.KEEP,e.KEEP]};bt.prototype.get=function(){return this.current},bt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]||(this.context.gl.stencilOp(t[0],t[1],t[2]),this.current=t)};var _t=function(t){this.context=t,this.current=!1};_t.prototype.get=function(){return this.current},_t.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t}};var wt=function(t){this.context=t,this.current=[0,1]};wt.prototype.get=function(){return this.current},wt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]||(this.context.gl.depthRange(t[0],t[1]),this.current=t)};var kt=function(t){this.context=t,this.current=!1};kt.prototype.get=function(){return this.current},kt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t}};var Mt=function(t){this.context=t,this.current=t.gl.LESS};Mt.prototype.get=function(){return this.current},Mt.prototype.set=function(t){this.current!==t&&(this.context.gl.depthFunc(t),this.current=t)};var At=function(t){this.context=t,this.current=!1};At.prototype.get=function(){return this.current},At.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t}};var Tt=function(t){this.context=t;var e=this.context.gl;this.current=[e.ONE,e.ZERO]};Tt.prototype.get=function(){return this.current},Tt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]||(this.context.gl.blendFunc(t[0],t[1]),this.current=t)};var St=function(e){this.context=e,this.current=t.default$6.transparent};St.prototype.get=function(){return this.current},St.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a||(this.context.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t)};var Et=function(t){this.context=t,this.current=null};Et.prototype.get=function(){return this.current},Et.prototype.set=function(t){this.current!==t&&(this.context.gl.useProgram(t),this.current=t)};var Ct=function(t){this.context=t,this.current=1};Ct.prototype.get=function(){return this.current},Ct.prototype.set=function(e){var r=this.context.lineWidthRange,n=t.clamp(e,r[0],r[1]);this.current!==n&&(this.context.gl.lineWidth(n),this.current=e)};var Lt=function(t){this.context=t,this.current=t.gl.TEXTURE0};Lt.prototype.get=function(){return this.current},Lt.prototype.set=function(t){this.current!==t&&(this.context.gl.activeTexture(t),this.current=t)};var It=function(t){this.context=t;var e=this.context.gl;this.current=[0,0,e.drawingBufferWidth,e.drawingBufferHeight]};It.prototype.get=function(){return this.current},It.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(this.context.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t)};var zt=function(t){this.context=t,this.current=null};zt.prototype.get=function(){return this.current},zt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t}};var Pt=function(t){this.context=t,this.current=null};Pt.prototype.get=function(){return this.current},Pt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t}};var Ot=function(t){this.context=t,this.current=null};Ot.prototype.get=function(){return this.current},Ot.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t}};var Dt=function(t){this.context=t,this.current=null};Dt.prototype.get=function(){return this.current},Dt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t}};var Rt=function(t){this.context=t,this.current=null};Rt.prototype.get=function(){return this.current},Rt.prototype.set=function(t){var e=this.context.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t};var Bt=function(t){this.context=t,this.current=null};Bt.prototype.get=function(){return this.current},Bt.prototype.set=function(t){this.current!==t&&this.context.extVertexArrayObject&&(this.context.extVertexArrayObject.bindVertexArrayOES(t),this.current=t)};var Ft=function(t){this.context=t,this.current=4};Ft.prototype.get=function(){return this.current},Ft.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t}};var Nt=function(t){this.context=t,this.current=!1};Nt.prototype.get=function(){return this.current},Nt.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t}};var jt=function(t,e){this.context=t,this.current=null,this.parent=e};jt.prototype.get=function(){return this.current};var Vt=function(t){function e(e,r){t.call(this,e,r),this.dirty=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(this.dirty||this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e.prototype.setDirty=function(){this.dirty=!0},e}(jt),Ut=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t}},e}(jt),qt=function(t,e,r){this.context=t,this.width=e,this.height=r;var n=t.gl,a=this.framebuffer=n.createFramebuffer();this.colorAttachment=new Vt(t,a),this.depthAttachment=new Ut(t,a)};qt.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();e&&t.deleteTexture(e);var r=this.depthAttachment.get();r&&t.deleteRenderbuffer(r),t.deleteFramebuffer(this.framebuffer)};var Ht=function(t,e,r){this.func=t,this.mask=e,this.range=r};Ht.ReadOnly=!1,Ht.ReadWrite=!0,Ht.disabled=new Ht(519,Ht.ReadOnly,[0,1]);var Gt=function(t,e,r,n,a,i){this.test=t,this.ref=e,this.mask=r,this.fail=n,this.depthFail=a,this.pass=i};Gt.disabled=new Gt({func:519,mask:0},0,0,7680,7680,7680);var Wt=function(t,e,r){this.blendFunction=t,this.blendColor=e,this.mask=r};Wt.Replace=[1,0],Wt.disabled=new Wt(Wt.Replace,t.default$6.transparent,[!1,!1,!1,!1]),Wt.unblended=new Wt(Wt.Replace,t.default$6.transparent,[!0,!0,!0,!0]),Wt.alphaBlended=new Wt([1,771],t.default$6.transparent,[!0,!0,!0,!0]);var Yt=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.lineWidthRange=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE),this.clearColor=new pt(this),this.clearDepth=new dt(this),this.clearStencil=new vt(this),this.colorMask=new gt(this),this.depthMask=new mt(this),this.stencilMask=new yt(this),this.stencilFunc=new xt(this),this.stencilOp=new bt(this),this.stencilTest=new _t(this),this.depthRange=new wt(this),this.depthTest=new kt(this),this.depthFunc=new Mt(this),this.blend=new At(this),this.blendFunc=new Tt(this),this.blendColor=new St(this),this.program=new Et(this),this.lineWidth=new Ct(this),this.activeTexture=new Lt(this),this.viewport=new It(this),this.bindFramebuffer=new zt(this),this.bindRenderbuffer=new Pt(this),this.bindTexture=new Ot(this),this.bindVertexBuffer=new Dt(this),this.bindElementBuffer=new Rt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Bt(this),this.pixelStoreUnpack=new Ft(this),this.pixelStoreUnpackPremultiplyAlpha=new Nt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&t.getExtension("OES_texture_half_float_linear")};Yt.prototype.createIndexBuffer=function(t,e){return new ct(this,t,e)},Yt.prototype.createVertexBuffer=function(t,e,r){return new ht(this,t,e,r)},Yt.prototype.createRenderbuffer=function(t,e,r){var n=this.gl,a=n.createRenderbuffer();return this.bindRenderbuffer.set(a),n.renderbufferStorage(n.RENDERBUFFER,t,e,r),this.bindRenderbuffer.set(null),a},Yt.prototype.createFramebuffer=function(t,e){return new qt(this,t,e)},Yt.prototype.clear=function(t){var e=t.color,r=t.depth,n=this.gl,a=0;e&&(a|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(a|=n.DEPTH_BUFFER_BIT,this.clearDepth.set(r),this.depthMask.set(!0)),n.clear(a)},Yt.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},Yt.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},Yt.prototype.setColorMode=function(e){t.default$10(e.blendFunction,Wt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)};var Xt=function(e){function r(t,r,n){var a=this;e.call(this),this.id=t,this.dispatcher=n,this.on("data",function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(a._sourceLoaded=!0),a._sourceLoaded&&!a._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(a.reload(),a.transform&&a.update(a.transform))}),this.on("error",function(){a._sourceErrored=!0}),this._source=it(t,r,n,this),this._tiles={},this._cache=new ut(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._isIdRenderable=this._isIdRenderable.bind(this),this._coveredTiles={}}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},r.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},r.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},r.prototype.getSource=function(){return this._source},r.prototype.pause=function(){this._paused=!0},r.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},r.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},r.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,function(){})},r.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,function(){})},r.prototype.serialize=function(){return this._source.serialize()},r.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._tiles)this._tiles[e].upload(t)},r.prototype.getIds=function(){var e=this;return Object.keys(this._tiles).map(Number).sort(function(r,n){var a=e._tiles[r].tileID,i=e._tiles[n].tileID,o=new t.default$1(a.canonical.x,a.canonical.y).rotate(e.transform.angle),s=new t.default$1(i.canonical.x,i.canonical.y).rotate(e.transform.angle);return a.overscaledZ-i.overscaledZ||s.y-o.y||s.x-o.x})},r.prototype.getRenderableIds=function(){return this.getIds().filter(this._isIdRenderable)},r.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0,{});return!!e&&this._isIdRenderable(e.tileID.key)},r.prototype._isIdRenderable=function(t){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]},r.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)this._reloadTile(t,"reloading")},r.prototype._reloadTile=function(t,e){var r=this._tiles[t];r&&("loading"!==r.state&&(r.state=e),this._loadTile(r,this._tileLoaded.bind(this,r,t,e)))},r.prototype._tileLoaded=function(e,r,n,a){if(a)return e.state="errored",void(404!==a.status?this._source.fire(new t.ErrorEvent(a,{tile:e})):this.update(this.transform));e.timeAdded=i.now(),"expired"===n&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID})),this.map&&(this.map.painter.tileExtentVAO.vao=null)},r.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),r=0;r<e.length;r++){var n=e[r];if(t.neighboringTiles&&t.neighboringTiles[n]){var a=this.getTileByID(n);i(t,a),i(a,t)}}function i(t,e){t.needsHillshadePrepare=!0;var r=e.tileID.canonical.x-t.tileID.canonical.x,n=e.tileID.canonical.y-t.tileID.canonical.y,a=Math.pow(2,t.tileID.canonical.z),i=e.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+a)?r+=a:1===Math.abs(r-a)&&(r-=a)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,r,n),t.neighboringTiles&&t.neighboringTiles[i]&&(t.neighboringTiles[i].backfilled=!0)))}},r.prototype.getTile=function(t){return this.getTileByID(t.key)},r.prototype.getTileByID=function(t){return this._tiles[t]},r.prototype.getZoom=function(t){return t.zoom+t.scaleZoom(t.tileSize/this._source.tileSize)},r.prototype._findLoadedChildren=function(t,e,r){var n=!1;for(var a in this._tiles){var i=this._tiles[a];if(!(r[a]||!i.hasData()||i.tileID.overscaledZ<=t.overscaledZ||i.tileID.overscaledZ>e)){var o=Math.pow(2,i.tileID.canonical.z-t.canonical.z);if(Math.floor(i.tileID.canonical.x/o)===t.canonical.x&&Math.floor(i.tileID.canonical.y/o)===t.canonical.y)for(r[a]=i.tileID,n=!0;i&&i.tileID.overscaledZ-1>t.overscaledZ;){var s=i.tileID.scaledTo(i.tileID.overscaledZ-1);if(!s)break;(i=this._tiles[s.key])&&i.hasData()&&(delete r[a],r[s.key]=s)}}}return n},r.prototype.findLoadedParent=function(t,e,r){for(var n=t.overscaledZ-1;n>=e;n--){var a=t.scaledTo(n);if(!a)return;var i=String(a.key),o=this._tiles[i];if(o&&o.hasData())return r[i]=a,o;if(this._cache.has(a))return r[i]=a,this._cache.get(a)}},r.prototype.updateCacheSize=function(t){var e=(Math.ceil(t.width/this._source.tileSize)+1)*(Math.ceil(t.height/this._source.tileSize)+1),r=Math.floor(5*e),n="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(n)},r.prototype.handleWrapJump=function(t){var e=(t-(void 0===this._prevLng?t:this._prevLng))/360,r=Math.round(e);if(this._prevLng=t,r){var n={};for(var a in this._tiles){var i=this._tiles[a];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+r),n[i.tileID.key]=i}for(var o in this._tiles=n,this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(var s in this._tiles){var l=this._tiles[s];this._setTileReloadTimer(s,l)}}},r.prototype.update=function(e){var n=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var a;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?a=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)}):(a=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(a=a.filter(function(t){return n._source.hasTile(t)}))):a=[];var o,s=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(e)),l=Math.max(s-r.maxOverzooming,this._source.minzoom),u=Math.max(s+r.maxUnderzooming,this._source.minzoom),c=this._updateRetainedTiles(a,s),f={};if($t(this._source.type))for(var h=Object.keys(c),p=0;p<h.length;p++){var d=h[p],v=c[d],g=n._tiles[d];if(g&&(void 0===g.fadeEndTime||g.fadeEndTime>=i.now())){n._findLoadedChildren(v,u,c)&&(c[d]=v);var m=n.findLoadedParent(v,l,f);m&&n._addTile(m.tileID)}}for(o in f)c[o]||(n._coveredTiles[o]=!0);for(o in f)c[o]=f[o];for(var y=t.keysDifference(this._tiles,c),x=0;x<y.length;x++)n._removeTile(y[x])}},r.prototype._updateRetainedTiles=function(t,e){for(var n={},a={},i=Math.max(e-r.maxOverzooming,this._source.minzoom),o=Math.max(e+r.maxUnderzooming,this._source.minzoom),s=0;s<t.length;s++){var l=t[s],u=this._addTile(l),c=!1;if(u.hasData())n[l.key]=l;else{c=u.wasRequested(),n[l.key]=l;var f=!0;if(e+1>this._source.maxzoom){var h=l.children(this._source.maxzoom)[0],p=this.getTile(h);p&&p.hasData()?n[h.key]=h:f=!1}else{this._findLoadedChildren(l,o,n);for(var d=l.children(this._source.maxzoom),v=0;v<d.length;v++)if(!n[d[v].key]){f=!1;break}}if(!f)for(var g=l.overscaledZ-1;g>=i;--g){var m=l.scaledTo(g);if(a[m.key])break;if(a[m.key]=!0,!(u=this.getTile(m))&&c&&(u=this._addTile(m)),u&&(n[m.key]=m,c=u.wasRequested(),u.hasData()))break}}}return n},r.prototype._addTile=function(e){var r=this._tiles[e.key];if(r)return r;(r=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,r),r.tileID=e);var n=Boolean(r);return n||(r=new lt(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))),r?(r.uses++,this._tiles[e.key]=r,n||this._source.fire(new t.Event("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null},r.prototype._setTileReloadTimer=function(t,e){var r=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout(function(){r._reloadTile(t,"expired"),delete r._timers[t]},n))},r.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},r.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},r.prototype.tilesIn=function(e,r){for(var n=[],a=this.getIds(),i=1/0,o=1/0,s=-1/0,l=-1/0,u=e[0].zoom,c=0;c<e.length;c++){var f=e[c];i=Math.min(i,f.column),o=Math.min(o,f.row),s=Math.max(s,f.column),l=Math.max(l,f.row)}for(var h=0;h<a.length;h++){var p=this._tiles[a[h]],d=p.tileID,v=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),g=r*p.queryPadding*t.default$8/p.tileSize/v,m=[Zt(d,new t.default$17(i,o,u)),Zt(d,new t.default$17(s,l,u))];if(m[0].x-g<t.default$8&&m[0].y-g<t.default$8&&m[1].x+g>=0&&m[1].y+g>=0){for(var y=[],x=0;x<e.length;x++)y.push(Zt(d,e[x]));n.push({tile:p,tileID:d,queryGeometry:[y],scale:v})}}return n},r.prototype.getVisibleCoordinates=function(){for(var t=this,e=this.getRenderableIds().map(function(e){return t._tiles[e].tileID}),r=0,n=e;r<n.length;r+=1){var a=n[r];a.posMatrix=t.transform.calculatePosMatrix(a.toUnwrapped())}return e},r.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if($t(this._source.type))for(var t in this._tiles){var e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=i.now())return!0}return!1},r}(t.Evented);function Zt(e,r){var n=r.zoomTo(e.canonical.z);return new t.default$1((n.column-(e.canonical.x+e.wrap*Math.pow(2,e.canonical.z)))*t.default$8,(n.row-e.canonical.y)*t.default$8)}function $t(t){return"raster"===t||"image"===t||"video"===t}function Jt(){return new t.default.Worker(Ln.workerUrl)}Xt.maxOverzooming=10,Xt.maxUnderzooming=3;var Kt,Qt=function(){this.active={}};function te(e,r){var n={};for(var a in e)"ref"!==a&&(n[a]=e[a]);return t.default$18.forEach(function(t){t in r&&(n[t]=r[t])}),n}function ee(t){t=t.slice();for(var e=Object.create(null),r=0;r<t.length;r++)e[t[r].id]=t[r];for(var n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=te(t[n],e[t[n].ref]));return t}Qt.prototype.acquire=function(t){if(!this.workers){var e=Ln.workerCount;for(this.workers=[];this.workers.length<e;)this.workers.push(new Jt)}return this.active[t]=!0,this.workers.slice()},Qt.prototype.release=function(t){delete this.active[t],0===Object.keys(this.active).length&&(this.workers.forEach(function(t){t.terminate()}),this.workers=null)};var re={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ne(t,e,r){r.push({command:re.addSource,args:[t,e[t]]})}function ae(t,e,r){e.push({command:re.removeSource,args:[t]}),r[t]=!0}function ie(t,e,r,n){ae(t,r,n),ne(t,e,r)}function oe(e,r,n){var a;for(a in e[n])if(e[n].hasOwnProperty(a)&&"data"!==a&&!t.default$10(e[n][a],r[n][a]))return!1;for(a in r[n])if(r[n].hasOwnProperty(a)&&"data"!==a&&!t.default$10(e[n][a],r[n][a]))return!1;return!0}function se(e,r,n,a,i,o){var s;for(s in r=r||{},e=e||{})e.hasOwnProperty(s)&&(t.default$10(e[s],r[s])||n.push({command:o,args:[a,s,r[s],i]}));for(s in r)r.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.default$10(e[s],r[s])||n.push({command:o,args:[a,s,r[s],i]}))}function le(t){return t.id}function ue(t,e){return t[e.id]=e,t}function ce(e,r){if(!e)return[{command:re.setStyle,args:[r]}];var n=[];try{if(!t.default$10(e.version,r.version))return[{command:re.setStyle,args:[r]}];t.default$10(e.center,r.center)||n.push({command:re.setCenter,args:[r.center]}),t.default$10(e.zoom,r.zoom)||n.push({command:re.setZoom,args:[r.zoom]}),t.default$10(e.bearing,r.bearing)||n.push({command:re.setBearing,args:[r.bearing]}),t.default$10(e.pitch,r.pitch)||n.push({command:re.setPitch,args:[r.pitch]}),t.default$10(e.sprite,r.sprite)||n.push({command:re.setSprite,args:[r.sprite]}),t.default$10(e.glyphs,r.glyphs)||n.push({command:re.setGlyphs,args:[r.glyphs]}),t.default$10(e.transition,r.transition)||n.push({command:re.setTransition,args:[r.transition]}),t.default$10(e.light,r.light)||n.push({command:re.setLight,args:[r.light]});var a={},i=[];!function(e,r,n,a){var i;for(i in r=r||{},e=e||{})e.hasOwnProperty(i)&&(r.hasOwnProperty(i)||ae(i,n,a));for(i in r)r.hasOwnProperty(i)&&(e.hasOwnProperty(i)?t.default$10(e[i],r[i])||("geojson"===e[i].type&&"geojson"===r[i].type&&oe(e,r,i)?n.push({command:re.setGeoJSONSourceData,args:[i,r[i].data]}):ie(i,r,n,a)):ne(i,r,n))}(e.sources,r.sources,i,a);var o=[];e.layers&&e.layers.forEach(function(t){a[t.source]?n.push({command:re.removeLayer,args:[t.id]}):o.push(t)}),n=n.concat(i),function(e,r,n){r=r||[];var a,i,o,s,l,u,c,f=(e=e||[]).map(le),h=r.map(le),p=e.reduce(ue,{}),d=r.reduce(ue,{}),v=f.slice(),g=Object.create(null);for(a=0,i=0;a<f.length;a++)o=f[a],d.hasOwnProperty(o)?i++:(n.push({command:re.removeLayer,args:[o]}),v.splice(v.indexOf(o,i),1));for(a=0,i=0;a<h.length;a++)o=h[h.length-1-a],v[v.length-1-a]!==o&&(p.hasOwnProperty(o)?(n.push({command:re.removeLayer,args:[o]}),v.splice(v.lastIndexOf(o,v.length-i),1)):i++,u=v[v.length-a],n.push({command:re.addLayer,args:[d[o],u]}),v.splice(v.length-a,0,o),g[o]=!0);for(a=0;a<h.length;a++)if(s=p[o=h[a]],l=d[o],!g[o]&&!t.default$10(s,l))if(t.default$10(s.source,l.source)&&t.default$10(s["source-layer"],l["source-layer"])&&t.default$10(s.type,l.type)){for(c in se(s.layout,l.layout,n,o,null,re.setLayoutProperty),se(s.paint,l.paint,n,o,null,re.setPaintProperty),t.default$10(s.filter,l.filter)||n.push({command:re.setFilter,args:[o,l.filter]}),t.default$10(s.minzoom,l.minzoom)&&t.default$10(s.maxzoom,l.maxzoom)||n.push({command:re.setLayerZoomRange,args:[o,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?se(s[c],l[c],n,o,c.slice(6),re.setPaintProperty):t.default$10(s[c],l[c])||n.push({command:re.setLayerProperty,args:[o,c,l[c]]}));for(c in l)l.hasOwnProperty(c)&&!s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?se(s[c],l[c],n,o,c.slice(6),re.setPaintProperty):t.default$10(s[c],l[c])||n.push({command:re.setLayerProperty,args:[o,c,l[c]]}))}else n.push({command:re.removeLayer,args:[o]}),u=v[v.lastIndexOf(o)+1],n.push({command:re.addLayer,args:[l,u]})}(o,r.layers,n)}catch(t){console.warn("Unable to compute style diff:",t),n=[{command:re.setStyle,args:[r]}]}return n}var fe=function(t,e,r){var n=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(t/r),this.yCellCount=Math.ceil(e/r);for(var i=0;i<this.xCellCount*this.yCellCount;i++)n.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};fe.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},fe.prototype.insert=function(t,e,r,n,a){this._forEachCell(e,r,n,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(a)},fe.prototype.insertCircle=function(t,e,r,n){this._forEachCell(e-n,r-n,e+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(r),this.circles.push(n)},fe.prototype._insertBoxCell=function(t,e,r,n,a,i){this.boxCells[a].push(i)},fe.prototype._insertCircleCell=function(t,e,r,n,a,i){this.circleCells[a].push(i)},fe.prototype._query=function(t,e,r,n,a){if(r<0||t>this.width||n<0||e>this.height)return!a&&[];var i=[];if(t<=0&&e<=0&&this.width<=r&&this.height<=n){if(a)return!0;for(var o=0;o<this.boxKeys.length;o++)i.push({key:this.boxKeys[o],x1:this.bboxes[4*o],y1:this.bboxes[4*o+1],x2:this.bboxes[4*o+2],y2:this.bboxes[4*o+3]});for(var s=0;s<this.circleKeys.length;s++){var l=this.circles[3*s],u=this.circles[3*s+1],c=this.circles[3*s+2];i.push({key:this.circleKeys[s],x1:l-c,y1:u-c,x2:l+c,y2:u+c})}}else{var f={hitTest:a,seenUids:{box:{},circle:{}}};this._forEachCell(t,e,r,n,this._queryCell,i,f)}return a?i.length>0:i},fe.prototype._queryCircle=function(t,e,r,n){var a=t-r,i=t+r,o=e-r,s=e+r;if(i<0||a>this.width||s<0||o>this.height)return!n&&[];var l=[],u={hitTest:n,circle:{x:t,y:e,radius:r},seenUids:{box:{},circle:{}}};return this._forEachCell(a,o,i,s,this._queryCellCircle,l,u),n?l.length>0:l},fe.prototype.query=function(t,e,r,n){return this._query(t,e,r,n,!1)},fe.prototype.hitTest=function(t,e,r,n){return this._query(t,e,r,n,!0)},fe.prototype.hitTestCircle=function(t,e,r){return this._queryCircle(t,e,r,!0)},fe.prototype._queryCell=function(t,e,r,n,a,i,o){var s=o.seenUids,l=this.boxCells[a];if(null!==l)for(var u=this.bboxes,c=0,f=l;c<f.length;c+=1){var h=f[c];if(!s.box[h]){s.box[h]=!0;var p=4*h;if(t<=u[p+2]&&e<=u[p+3]&&r>=u[p+0]&&n>=u[p+1]){if(o.hitTest)return i.push(!0),!0;i.push({key:this.boxKeys[h],x1:u[p],y1:u[p+1],x2:u[p+2],y2:u[p+3]})}}}var d=this.circleCells[a];if(null!==d)for(var v=this.circles,g=0,m=d;g<m.length;g+=1){var y=m[g];if(!s.circle[y]){s.circle[y]=!0;var x=3*y;if(this._circleAndRectCollide(v[x],v[x+1],v[x+2],t,e,r,n)){if(o.hitTest)return i.push(!0),!0;var b=v[x],_=v[x+1],w=v[x+2];i.push({key:this.circleKeys[y],x1:b-w,y1:_-w,x2:b+w,y2:_+w})}}}},fe.prototype._queryCellCircle=function(t,e,r,n,a,i,o){var s=o.circle,l=o.seenUids,u=this.boxCells[a];if(null!==u)for(var c=this.bboxes,f=0,h=u;f<h.length;f+=1){var p=h[f];if(!l.box[p]){l.box[p]=!0;var d=4*p;if(this._circleAndRectCollide(s.x,s.y,s.radius,c[d+0],c[d+1],c[d+2],c[d+3]))return i.push(!0),!0}}var v=this.circleCells[a];if(null!==v)for(var g=this.circles,m=0,y=v;m<y.length;m+=1){var x=y[m];if(!l.circle[x]){l.circle[x]=!0;var b=3*x;if(this._circlesCollide(g[b],g[b+1],g[b+2],s.x,s.y,s.radius))return i.push(!0),!0}}},fe.prototype._forEachCell=function(t,e,r,n,a,i,o){for(var s=this._convertToXCellCoord(t),l=this._convertToYCellCoord(e),u=this._convertToXCellCoord(r),c=this._convertToYCellCoord(n),f=s;f<=u;f++)for(var h=l;h<=c;h++){var p=this.xCellCount*h+f;if(a.call(this,t,e,r,n,p,i,o))return}},fe.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},fe.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},fe.prototype._circlesCollide=function(t,e,r,n,a,i){var o=n-t,s=a-e,l=r+i;return l*l>o*o+s*s},fe.prototype._circleAndRectCollide=function(t,e,r,n,a,i,o){var s=(i-n)/2,l=Math.abs(t-(n+s));if(l>s+r)return!1;var u=(o-a)/2,c=Math.abs(e-(a+u));if(c>u+r)return!1;if(l<=s||c<=u)return!0;var f=l-s,h=c-u;return f*f+h*h<=r*r};var he=t.default$19.layout;function pe(e,r,n,a,i){var o=t.mat4.identity(new Float32Array(16));return r?(t.mat4.identity(o),t.mat4.scale(o,o,[1/i,1/i,1]),n||t.mat4.rotateZ(o,o,a.angle)):(t.mat4.scale(o,o,[a.width/2,-a.height/2,1]),t.mat4.translate(o,o,[1,-1,0]),t.mat4.multiply(o,o,e)),o}function de(e,r,n,a,i){var o=t.mat4.identity(new Float32Array(16));return r?(t.mat4.multiply(o,o,e),t.mat4.scale(o,o,[i,i,1]),n||t.mat4.rotateZ(o,o,-a.angle)):(t.mat4.scale(o,o,[1,-1,1]),t.mat4.translate(o,o,[-1,-1,0]),t.mat4.scale(o,o,[2/a.width,2/a.height,1])),o}function ve(e,r){var n=[e.x,e.y,0,1];Ae(n,n,r);var a=n[3];return{point:new t.default$1(n[0]/a,n[1]/a),signedDistanceFromCamera:a}}function ge(t,e){var r=t[0]/t[3],n=t[1]/t[3];return r>=-e[0]&&r<=e[0]&&n>=-e[1]&&n<=e[1]}function me(e,r,n,a,i,o,s,l){var u=a?e.textSizeData:e.iconSizeData,c=t.evaluateSizeForZoom(u,n.transform.zoom,he.properties[a?"text-size":"icon-size"]),f=[256/n.width*2+1,256/n.height*2+1],h=a?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;h.clear();for(var p=e.lineVertexArray,d=a?e.text.placedSymbolArray:e.icon.placedSymbolArray,v=n.transform.width/n.transform.height,g=!1,m=0;m<d.length;m++){var y=d.get(m);if(y.hidden||y.writingMode===t.WritingMode.vertical&&!g)Me(y.numGlyphs,h);else{g=!1;var x=[y.anchorX,y.anchorY,0,1];if(t.vec4.transformMat4(x,x,r),ge(x,f)){var b=.5+x[3]/n.transform.cameraToCenterDistance*.5,_=t.evaluateSizeForFeature(u,c,y),w=s?_*b:_/b,k=new t.default$1(y.anchorX,y.anchorY),M=ve(k,i).point,A={},T=be(y,w,!1,l,r,i,o,e.glyphOffsetArray,p,h,M,k,A,v);g=T.useVertical,(T.notEnoughRoom||g||T.needsFlipping&&be(y,w,!0,l,r,i,o,e.glyphOffsetArray,p,h,M,k,A,v).notEnoughRoom)&&Me(y.numGlyphs,h)}else Me(y.numGlyphs,h)}}a?e.text.dynamicLayoutVertexBuffer.updateData(h):e.icon.dynamicLayoutVertexBuffer.updateData(h)}function ye(t,e,r,n,a,i,o,s,l,u,c,f){var h=s.glyphStartIndex+s.numGlyphs,p=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,v=e.getoffsetX(s.glyphStartIndex),g=e.getoffsetX(h-1),m=we(t*v,r,n,a,i,o,s.segment,p,d,l,u,c,f);if(!m)return null;var y=we(t*g,r,n,a,i,o,s.segment,p,d,l,u,c,f);return y?{first:m,last:y}:null}function xe(e,r,n,a){if(e===t.WritingMode.horizontal&&Math.abs(n.y-r.y)>Math.abs(n.x-r.x)*a)return{useVertical:!0};return(e===t.WritingMode.vertical?r.y<n.y:r.x>n.x)?{needsFlipping:!0}:null}function be(e,r,n,a,i,o,s,l,u,c,f,h,p,d){var v,g=r/24,m=e.lineOffsetX*r,y=e.lineOffsetY*r;if(e.numGlyphs>1){var x=e.glyphStartIndex+e.numGlyphs,b=e.lineStartIndex,_=e.lineStartIndex+e.lineLength,w=ye(g,l,m,y,n,f,h,e,u,o,p,!1);if(!w)return{notEnoughRoom:!0};var k=ve(w.first.point,s).point,M=ve(w.last.point,s).point;if(a&&!n){var A=xe(e.writingMode,k,M,d);if(A)return A}v=[w.first];for(var T=e.glyphStartIndex+1;T<x-1;T++)v.push(we(g*l.getoffsetX(T),m,y,n,f,h,e.segment,b,_,u,o,p,!1));v.push(w.last)}else{if(a&&!n){var S=ve(h,i).point,E=e.lineStartIndex+e.segment+1,C=new t.default$1(u.getx(E),u.gety(E)),L=ve(C,i),I=L.signedDistanceFromCamera>0?L.point:_e(h,C,S,1,i),z=xe(e.writingMode,S,I,d);if(z)return z}var P=we(g*l.getoffsetX(e.glyphStartIndex),m,y,n,f,h,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,u,o,p,!1);if(!P)return{notEnoughRoom:!0};v=[P]}for(var O=0,D=v;O<D.length;O+=1){var R=D[O];t.addDynamicAttributes(c,R.point,R.angle)}return{}}function _e(t,e,r,n,a){var i=ve(t.add(t.sub(e)._unit()),a).point,o=r.sub(i);return r.add(o._mult(n/o.mag()))}function we(e,r,n,a,i,o,s,l,u,c,f,h,p){var d=a?e-r:e+r,v=d>0?1:-1,g=0;a&&(v*=-1,g=Math.PI),v<0&&(g+=Math.PI);for(var m=v>0?l+s:l+s+1,y=m,x=i,b=i,_=0,w=0,k=Math.abs(d);_+w<=k;){if((m+=v)<l||m>=u)return null;if(b=x,void 0===(x=h[m])){var M=new t.default$1(c.getx(m),c.gety(m)),A=ve(M,f);if(A.signedDistanceFromCamera>0)x=h[m]=A.point;else{var T=m-v;x=_e(0===_?o:new t.default$1(c.getx(T),c.gety(T)),M,b,k-_+1,f)}}_+=w,w=b.dist(x)}var S=(k-_)/w,E=x.sub(b),C=E.mult(S)._add(b);return C._add(E._unit()._perp()._mult(n*v)),{point:C,angle:g+Math.atan2(x.y-b.y,x.x-b.x),tileDistance:p?{prevTileDistance:m-v===y?0:c.gettileUnitDistanceFromAnchor(m-v),lastSegmentViewportDistance:k-_}:null}}var ke=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Me(t,e){for(var r=0;r<t;r++){var n=e.length;e.resize(n+4),e.float32.set(ke,3*n)}}function Ae(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[4]*a+r[12],t[1]=r[1]*n+r[5]*a+r[13],t[3]=r[3]*n+r[7]*a+r[15],t}t.default$20.mat4;var Te=function(t,e,r){void 0===e&&(e=new fe(t.width+200,t.height+200,25)),void 0===r&&(r=new fe(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=r,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100};function Se(t,e,r){t[e+4]=r?1:0}function Ee(e,r,n){return r*(t.default$8/(e.tileSize*Math.pow(2,n-e.tileID.overscaledZ)))}Te.prototype.placeCollisionBox=function(t,e,r,n){var a=this.projectAndGetPerspectiveRatio(n,t.anchorPointX,t.anchorPointY),i=r*a.perspectiveRatio,o=t.x1*i+a.point.x,s=t.y1*i+a.point.y,l=t.x2*i+a.point.x,u=t.y2*i+a.point.y;return!e&&this.grid.hitTest(o,s,l,u)?{box:[],offscreen:!1}:{box:[o,s,l,u],offscreen:this.isOffscreen(o,s,l,u)}},Te.prototype.approximateTileDistance=function(t,e,r,n,a){var i=a?1:n/this.pitchfactor,o=t.lastSegmentViewportDistance*r;return t.prevTileDistance+o+(i-1)*o*Math.abs(Math.sin(e))},Te.prototype.placeCollisionCircles=function(e,r,n,a,i,o,s,l,u,c,f,h,p){var d=[],v=this.projectAnchor(c,o.anchorX,o.anchorY),g=u/24,m=o.lineOffsetX*u,y=o.lineOffsetY*u,x=new t.default$1(o.anchorX,o.anchorY),b=ye(g,l,m,y,!1,ve(x,f).point,x,o,s,f,{},!0),_=!1,w=!0,k=v.perspectiveRatio*a,M=1/(a*n),A=0,T=0;b&&(A=this.approximateTileDistance(b.first.tileDistance,b.first.angle,M,v.cameraDistance,p),T=this.approximateTileDistance(b.last.tileDistance,b.last.angle,M,v.cameraDistance,p));for(var S=0;S<e.length;S+=5){var E=e[S],C=e[S+1],L=e[S+2],I=e[S+3];if(!b||I<-A||I>T)Se(e,S,!1);else{var z=this.projectPoint(c,E,C),P=L*k;if(d.length>0){var O=z.x-d[d.length-4],D=z.y-d[d.length-3];if(P*P*2>O*O+D*D)if(S+8<e.length){var R=e[S+8];if(R>-A&&R<T){Se(e,S,!1);continue}}}var B=S/5;if(d.push(z.x,z.y,P,B),Se(e,S,!0),w=w&&this.isOffscreen(z.x-P,z.y-P,z.x+P,z.y+P),!r&&this.grid.hitTestCircle(z.x,z.y,P)){if(!h)return{circles:[],offscreen:!1};_=!0}}}return{circles:_?[]:d,offscreen:w}},Te.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var r=[],n=1/0,a=1/0,i=-1/0,o=-1/0,s=0,l=e;s<l.length;s+=1){var u=l[s],c=new t.default$1(u.x+100,u.y+100);n=Math.min(n,c.x),a=Math.min(a,c.y),i=Math.max(i,c.x),o=Math.max(o,c.y),r.push(c)}for(var f={},h={},p=0,d=this.grid.query(n,a,i,o).concat(this.ignoredGrid.query(n,a,i,o));p<d.length;p+=1){var v=d[p],g=v.key;if(void 0===f[g.bucketInstanceId]&&(f[g.bucketInstanceId]={}),!f[g.bucketInstanceId][g.featureIndex]){var m=[new t.default$1(v.x1,v.y1),new t.default$1(v.x2,v.y1),new t.default$1(v.x2,v.y2),new t.default$1(v.x1,v.y2)];t.polygonIntersectsPolygon(r,m)&&(f[g.bucketInstanceId][g.featureIndex]=!0,void 0===h[g.bucketInstanceId]&&(h[g.bucketInstanceId]=[]),h[g.bucketInstanceId].push(g.featureIndex))}}return h},Te.prototype.insertCollisionBox=function(t,e,r,n){var a={bucketInstanceId:r,featureIndex:n};(e?this.ignoredGrid:this.grid).insert(a,t[0],t[1],t[2],t[3])},Te.prototype.insertCollisionCircles=function(t,e,r,n){for(var a=e?this.ignoredGrid:this.grid,i={bucketInstanceId:r,featureIndex:n},o=0;o<t.length;o+=4)a.insertCircle(i,t[o],t[o+1],t[o+2])},Te.prototype.projectAnchor=function(t,e,r){var n=[e,r,0,1];return Ae(n,n,t),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/n[3]*.5,cameraDistance:n[3]}},Te.prototype.projectPoint=function(e,r,n){var a=[r,n,0,1];return Ae(a,a,e),new t.default$1((a[0]/a[3]+1)/2*this.transform.width+100,(-a[1]/a[3]+1)/2*this.transform.height+100)},Te.prototype.projectAndGetPerspectiveRatio=function(e,r,n){var a=[r,n,0,1];return Ae(a,a,e),{point:new t.default$1((a[0]/a[3]+1)/2*this.transform.width+100,(-a[1]/a[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/a[3]*.5}},Te.prototype.isOffscreen=function(t,e,r,n){return r<100||t>=this.screenRightBoundary||n<100||e>this.screenBottomBoundary};var Ce=t.default$19.layout,Le=function(t,e,r,n){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):n&&r?1:0,this.placed=r};Le.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Ie=function(t,e,r,n,a){this.text=new Le(t?t.text:null,e,r,a),this.icon=new Le(t?t.icon:null,e,n,a)};Ie.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ze=function(t,e,r){this.text=t,this.icon=e,this.skipFade=r},Pe=function(t,e){this.transform=t.clone(),this.collisionIndex=new Te(this.transform),this.placements={},this.opacities={},this.stale=!1,this.fadeDuration=e,this.retainedQueryData={}};function Oe(t,e,r){t.emplaceBack(e?1:0,r?1:0),t.emplaceBack(e?1:0,r?1:0),t.emplaceBack(e?1:0,r?1:0),t.emplaceBack(e?1:0,r?1:0)}Pe.prototype.placeLayerTile=function(e,r,n,a){var i=r.getBucket(e),o=r.latestFeatureIndex;if(i&&o&&e.id===i.layerIds[0]){var s=r.collisionBoxArray,l=i.layers[0].layout,u=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),c=r.tileSize/t.default$8,f=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),h=pe(f,"map"===l.get("text-pitch-alignment"),"map"===l.get("text-rotation-alignment"),this.transform,Ee(r,1,this.transform.zoom)),p=pe(f,"map"===l.get("icon-pitch-alignment"),"map"===l.get("icon-rotation-alignment"),this.transform,Ee(r,1,this.transform.zoom));this.retainedQueryData[i.bucketInstanceId]=new function(t,e,r,n,a){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=a}(i.bucketInstanceId,o,i.sourceLayerIndex,i.index,r.tileID),this.placeLayerBucket(i,f,h,p,u,c,n,a,s)}},Pe.prototype.placeLayerBucket=function(e,r,n,a,i,o,s,l,u){for(var c=e.layers[0].layout,f=t.evaluateSizeForZoom(e.textSizeData,this.transform.zoom,Ce.properties["text-size"]),h=!e.hasTextData()||c.get("text-optional"),p=!e.hasIconData()||c.get("icon-optional"),d=0,v=e.symbolInstances;d<v.length;d+=1){var g=v[d];if(!l[g.crossTileID]){var m=void 0!==g.feature.text,y=void 0!==g.feature.icon,x=!0,b=null,_=null,w=null,k=0,M=0;g.collisionArrays||(g.collisionArrays=e.deserializeCollisionBoxes(u,g.textBoxStartIndex,g.textBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex)),g.collisionArrays.textFeatureIndex&&(k=g.collisionArrays.textFeatureIndex),g.collisionArrays.textBox&&(m=(b=this.collisionIndex.placeCollisionBox(g.collisionArrays.textBox,c.get("text-allow-overlap"),o,r)).box.length>0,x=x&&b.offscreen);var A=g.collisionArrays.textCircles;if(A){var T=e.text.placedSymbolArray.get(g.placedTextSymbolIndices[0]),S=t.evaluateSizeForFeature(e.textSizeData,f,T);_=this.collisionIndex.placeCollisionCircles(A,c.get("text-allow-overlap"),i,o,g.key,T,e.lineVertexArray,e.glyphOffsetArray,S,r,n,s,"map"===c.get("text-pitch-alignment")),m=c.get("text-allow-overlap")||_.circles.length>0,x=x&&_.offscreen}g.collisionArrays.iconFeatureIndex&&(M=g.collisionArrays.iconFeatureIndex),g.collisionArrays.iconBox&&(y=(w=this.collisionIndex.placeCollisionBox(g.collisionArrays.iconBox,c.get("icon-allow-overlap"),o,r)).box.length>0,x=x&&w.offscreen),h||p?p?h||(y=y&&m):m=y&&m:y=m=y&&m,m&&b&&this.collisionIndex.insertCollisionBox(b.box,c.get("text-ignore-placement"),e.bucketInstanceId,k),y&&w&&this.collisionIndex.insertCollisionBox(w.box,c.get("icon-ignore-placement"),e.bucketInstanceId,M),m&&_&&this.collisionIndex.insertCollisionCircles(_.circles,c.get("text-ignore-placement"),e.bucketInstanceId,k),this.placements[g.crossTileID]=new ze(m,y,x||e.justReloaded),l[g.crossTileID]=!0}}e.justReloaded=!1},Pe.prototype.commit=function(t,e){this.commitTime=e;var r=!1,n=t&&0!==this.fadeDuration?(this.commitTime-t.commitTime)/this.fadeDuration:1,a=t?t.opacities:{};for(var i in this.placements){var o=this.placements[i],s=a[i];s?(this.opacities[i]=new Ie(s,n,o.text,o.icon),r=r||o.text!==s.text.placed||o.icon!==s.icon.placed):(this.opacities[i]=new Ie(null,n,o.text,o.icon,o.skipFade),r=r||o.text||o.icon)}for(var l in a){var u=a[l];if(!this.opacities[l]){var c=new Ie(u,n,!1,!1);c.isHidden()||(this.opacities[l]=c,r=r||u.text.placed||u.icon.placed)}}r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)},Pe.prototype.updateLayerOpacities=function(t,e){for(var r={},n=0,a=e;n<a.length;n+=1){var i=a[n],o=i.getBucket(t);o&&i.latestFeatureIndex&&t.id===o.layerIds[0]&&this.updateBucketOpacities(o,r,i.collisionBoxArray)}},Pe.prototype.updateBucketOpacities=function(t,e,r){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexArray.clear(),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexArray.clear();for(var n=t.layers[0].layout,a=new Ie(null,0,!1,!1,!0),i=new Ie(null,0,n.get("text-allow-overlap"),n.get("icon-allow-overlap"),!0),o=0;o<t.symbolInstances.length;o++){var s=t.symbolInstances[o],l=e[s.crossTileID],u=this.opacities[s.crossTileID];l?u=a:u||(u=i,this.opacities[s.crossTileID]=u),e[s.crossTileID]=!0;var c=s.numGlyphVertices>0||s.numVerticalGlyphVertices>0,f=s.numIconVertices>0;if(c){for(var h=Ue(u.text),p=(s.numGlyphVertices+s.numVerticalGlyphVertices)/4,d=0;d<p;d++)t.text.opacityVertexArray.emplaceBack(h);for(var v=0,g=s.placedTextSymbolIndices;v<g.length;v+=1){var m=g[v];t.text.placedSymbolArray.get(m).hidden=u.text.isHidden()}}if(f){for(var y=Ue(u.icon),x=0;x<s.numIconVertices/4;x++)t.icon.opacityVertexArray.emplaceBack(y);t.icon.placedSymbolArray.get(o).hidden=u.icon.isHidden()}s.collisionArrays||(s.collisionArrays=t.deserializeCollisionBoxes(r,s.textBoxStartIndex,s.textBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex));var b=s.collisionArrays;if(b){b.textBox&&t.hasCollisionBoxData()&&Oe(t.collisionBox.collisionVertexArray,u.text.placed,!1),b.iconBox&&t.hasCollisionBoxData()&&Oe(t.collisionBox.collisionVertexArray,u.icon.placed,!1);var _=b.textCircles;if(_&&t.hasCollisionCircleData())for(var w=0;w<_.length;w+=5){var k=l||0===_[w+4];Oe(t.collisionCircle.collisionVertexArray,u.text.placed,k)}}}t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexBuffer&&t.collisionBox.collisionVertexBuffer.updateData(t.collisionBox.collisionVertexArray),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexBuffer&&t.collisionCircle.collisionVertexBuffer.updateData(t.collisionCircle.collisionVertexArray)},Pe.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration},Pe.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},Pe.prototype.stillRecent=function(t){return"undefined"!==this.commitTime&&this.commitTime+this.fadeDuration>t},Pe.prototype.setStale=function(){this.stale=!0};var De=Math.pow(2,25),Re=Math.pow(2,24),Be=Math.pow(2,17),Fe=Math.pow(2,16),Ne=Math.pow(2,9),je=Math.pow(2,8),Ve=Math.pow(2,1);function Ue(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,r=Math.floor(127*t.opacity);return r*De+e*Re+r*Be+e*Fe+r*Ne+e*je+r*Ve+e}var qe=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};qe.prototype.continuePlacement=function(t,e,r,n,a){for(;this._currentTileIndex<t.length;){var i=t[this._currentTileIndex];if(e.placeLayerTile(n,i,r,this._seenCrossTileIDs),this._currentTileIndex++,a())return!0}};var He=function(t,e,r,n,a){this.placement=new Pe(t,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=n,this._done=!1};He.prototype.isDone=function(){return this._done},He.prototype.continuePlacement=function(t,e,r){for(var n=this,a=i.now(),o=function(){var t=i.now()-a;return!n._forceFullPlacement&&t>2};this._currentPlacementIndex>=0;){var s=e[t[n._currentPlacementIndex]],l=n.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(n._inProgressLayer||(n._inProgressLayer=new qe),n._inProgressLayer.continuePlacement(r[s.source],n.placement,n._showCollisionBoxes,s,o))return;delete n._inProgressLayer}n._currentPlacementIndex--}this._done=!0},He.prototype.commit=function(t,e){return this.placement.commit(t,e),this.placement};var Ge=512/t.default$8/2,We=function(t,e,r){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(var n=0,a=e;n<a.length;n+=1){var i=a[n],o=i.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:i.crossTileID,coord:this.getScaledCoordinates(i,t)})}};We.prototype.getScaledCoordinates=function(e,r){var n=r.canonical.z-this.tileID.canonical.z,a=Ge/Math.pow(2,n),i=e.anchor;return{x:Math.floor((r.canonical.x*t.default$8+i.x)*a),y:Math.floor((r.canonical.y*t.default$8+i.y)*a)}},We.prototype.findMatches=function(t,e,r){for(var n=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),a=0,i=t;a<i.length;a+=1){var o=i[a];if(!o.crossTileID){var s=this.indexedSymbolInstances[o.key];if(s)for(var l=this.getScaledCoordinates(o,e),u=0,c=s;u<c.length;u+=1){var f=c[u];if(Math.abs(f.coord.x-l.x)<=n&&Math.abs(f.coord.y-l.y)<=n&&!r[f.crossTileID]){r[f.crossTileID]=!0,o.crossTileID=f.crossTileID;break}}}}};var Ye=function(){this.maxCrossTileID=0};Ye.prototype.generate=function(){return++this.maxCrossTileID};var Xe=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Xe.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var r in this.indexes){var n=this.indexes[r],a={};for(var i in n){var o=n[i];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+e),a[o.tileID.key]=o}this.indexes[r]=a}this.lng=t},Xe.prototype.addBucket=function(t,e,r){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var n=0,a=e.symbolInstances;n<a.length;n+=1){a[n].crossTileID=0}this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var i=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var s=this.indexes[o];if(Number(o)>t.overscaledZ)for(var l in s){var u=s[l];u.tileID.isChildOf(t)&&u.findMatches(e.symbolInstances,t,i)}else{var c=s[t.scaledTo(Number(o)).key];c&&c.findMatches(e.symbolInstances,t,i)}}for(var f=0,h=e.symbolInstances;f<h.length;f+=1){var p=h[f];p.crossTileID||(p.crossTileID=r.generate(),i[p.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new We(t,e.symbolInstances,e.bucketInstanceId),!0},Xe.prototype.removeBucketCrossTileIDs=function(t,e){for(var r in e.indexedSymbolInstances)for(var n=0,a=e.indexedSymbolInstances[r];n<a.length;n+=1){var i=a[n];delete this.usedCrossTileIDs[t][i.crossTileID]}},Xe.prototype.removeStaleBuckets=function(t){var e=!1;for(var r in this.indexes){var n=this.indexes[r];for(var a in n)t[n[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[a]),delete n[a],e=!0)}return e};var Ze=function(){this.layerIndexes={},this.crossTileIDs=new Ye,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Ze.prototype.addLayer=function(t,e,r){var n=this.layerIndexes[t.id];void 0===n&&(n=this.layerIndexes[t.id]=new Xe);var a=!1,i={};n.handleWrapJump(r);for(var o=0,s=e;o<s.length;o+=1){var l=s[o],u=l.getBucket(t);u&&t.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(l.tileID,u,this.crossTileIDs)&&(a=!0),i[u.bucketInstanceId]=!0)}return n.removeStaleBuckets(i)&&(a=!0),a},Ze.prototype.pruneUnusedLayers=function(t){var e={};for(var r in t.forEach(function(t){e[t]=!0}),this.layerIndexes)e[r]||delete this.layerIndexes[r]};var $e=function(e,r){return t.emitValidationErrors(e,r&&r.filter(function(t){return"source.canvas"!==t.identifier}))},Je=t.pick(re,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ke=t.pick(re,["setCenter","setZoom","setBearing","setPitch"]),Qe=function(e){function r(n,a){var i=this;void 0===a&&(a={}),e.call(this),this.map=n,this.dispatcher=new H((Kt||(Kt=new Qt),Kt),this),this.imageManager=new P,this.glyphManager=new N(n._transformRequest,a.localIdeographFontFamily),this.lineAtlas=new q(256,512),this.crossTileSymbolIndex=new Ze,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.default$23,this._loaded=!1,this._resetUpdates();var o=this;this._rtlTextPluginCallback=r.registerForPluginAvailability(function(t){for(var e in o.dispatcher.broadcast("loadRTLTextPlugin",t.pluginURL,t.completionCallback),o.sourceCaches)o.sourceCaches[e].reload()}),this.on("data",function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=i.sourceCaches[t.sourceId];if(e){var r=e.getSource();if(r&&r.vectorLayerIds)for(var n in i._layers){var a=i._layers[n];a.source===r.id&&i._validateLayer(a)}}}})}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.loadURL=function(e,r){var n=this;void 0===r&&(r={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var a="boolean"==typeof r.validate?r.validate:!x(e);e=function(t,e){if(!x(t))return t;var r=T(t);return r.path="/styles/v1"+r.path,y(r,e)}(e,r.accessToken);var i=this.map._transformRequest(e,t.ResourceType.Style);t.getJSON(i,function(e,r){e?n.fire(new t.ErrorEvent(e)):r&&n._load(r,a)})},r.prototype.loadJSON=function(e,r){var n=this;void 0===r&&(r={}),this.fire(new t.Event("dataloading",{dataType:"style"})),i.frame(function(){n._load(e,!1!==r.validate)})},r.prototype._load=function(e,r){var n=this;if(!r||!$e(this,t.validateStyle(e))){for(var a in this._loaded=!0,this.stylesheet=e,e.sources)n.addSource(a,e.sources[a],{validate:!1});e.sprite?function(e,r,n){var a,o,s,l=i.devicePixelRatio>1?"@2x":"";function u(){if(s)n(s);else if(a&&o){var e=i.getImageData(o),r={};for(var l in a){var u=a[l],c=u.width,f=u.height,h=u.x,p=u.y,d=u.sdf,v=u.pixelRatio,g=new t.RGBAImage({width:c,height:f});t.RGBAImage.copy(e,g,{x:h,y:p},{x:0,y:0},{width:c,height:f}),r[l]={data:g,pixelRatio:v,sdf:d}}n(null,r)}}t.getJSON(r(w(e,l,".json"),t.ResourceType.SpriteJSON),function(t,e){s||(s=t,a=e,u())}),t.getImage(r(w(e,l,".png"),t.ResourceType.SpriteImage),function(t,e){s||(s=t,o=e,u())})}(e.sprite,this.map._transformRequest,function(e,r){if(e)n.fire(new t.ErrorEvent(e));else if(r)for(var a in r)n.imageManager.addImage(a,r[a]);n.imageManager.setLoaded(!0),n.fire(new t.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var o=ee(this.stylesheet.layers);this._order=o.map(function(t){return t.id}),this._layers={};for(var s=0,l=o;s<l.length;s+=1){var u=l[s];(u=t.default$22(u)).setEventedParent(n,{layer:{id:u.id}}),n._layers[u.id]=u}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new U(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},r.prototype._validateLayer=function(e){var r=this.sourceCaches[e.source];if(r){var n=e.sourceLayer;if(n){var a=r.getSource();("geojson"===a.type||a.vectorLayerIds&&-1===a.vectorLayerIds.indexOf(n))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+n+'" does not exist on source "'+a.id+'" as specified by style layer "'+e.id+'"')))}}},r.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},r.prototype._serializeLayers=function(t){var e=this;return t.map(function(t){return e._layers[t].serialize()})},r.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},r.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},r.prototype.update=function(e){if(this._loaded){if(this._changed){var r=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);for(var a in(r.length||n.length)&&this._updateWorkerLayers(r,n),this._updatedSources){var i=this._updatedSources[a];"reload"===i?this._reloadSource(a):"clear"===i&&this._clearSource(a)}for(var o in this._updatedPaintProps)this._layers[o].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates(),this.fire(new t.Event("data",{dataType:"style"}))}for(var s in this.sourceCaches)this.sourceCaches[s].used=!1;for(var l=0,u=this._order;l<u.length;l+=1){var c=u[l],f=this._layers[c];f.recalculate(e),!f.isHidden(e.zoom)&&f.source&&(this.sourceCaches[f.source].used=!0)}this.light.recalculate(e),this.z=e.zoom}},r.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},r.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},r.prototype.setState=function(e){var r=this;if(this._checkLoaded(),$e(this,t.validateStyle(e)))return!1;(e=t.clone(e)).layers=ee(e.layers);var n=ce(this.serialize(),e).filter(function(t){return!(t.command in Ke)});if(0===n.length)return!1;var a=n.filter(function(t){return!(t.command in Je)});if(a.length>0)throw new Error("Unimplemented: "+a.map(function(t){return t.command}).join(", ")+".");return n.forEach(function(t){"setTransition"!==t.command&&r[t.command].apply(r,t.args)}),this.stylesheet=e,!0},r.prototype.addImage=function(e,r){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,r),this.fire(new t.Event("data",{dataType:"style"}))},r.prototype.getImage=function(t){return this.imageManager.getImage(t)},r.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this.fire(new t.Event("data",{dataType:"style"}))},r.prototype.addSource=function(e,r,n){var a=this;if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!r.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(r).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(r.type)>=0)||!this._validate(t.validateStyle.source,"sources."+e,r,null,n)){this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);var i=this.sourceCaches[e]=new Xt(e,r,this.dispatcher);i.style=this,i.setEventedParent(this,function(){return{isSourceLoaded:a.loaded(),source:i.serialize(),sourceId:e}}),i.onAdd(this.map),this._changed=!0}},r.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var r in this._layers)if(this._layers[r].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+r+'" is using it.')));var n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.clearTiles(),n.onRemove&&n.onRemove(this.map),this._changed=!0},r.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},r.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},r.prototype.addLayer=function(e,r,n){this._checkLoaded();var a=e.id;if(this.getLayer(a))this.fire(new t.ErrorEvent(new Error('Layer with id "'+a+'" already exists on this map')));else if("object"==typeof e.source&&(this.addSource(a,e.source),e=t.clone(e),e=t.extend(e,{source:a})),!this._validate(t.validateStyle.layer,"layers."+a,e,{arrayIndex:-1},n)){var i=t.default$22(e);this._validateLayer(i),i.setEventedParent(this,{layer:{id:a}});var o=r?this._order.indexOf(r):this._order.length;if(r&&-1===o)this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.')));else{if(this._order.splice(o,0,a),this._layerOrderChanged=!0,this._layers[a]=i,this._removedLayers[a]&&i.source){var s=this._removedLayers[a];delete this._removedLayers[a],s.type!==i.type?this._updatedSources[i.source]="clear":(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause())}this._updateLayer(i)}}},r.prototype.moveLayer=function(e,r){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==r){var n=this._order.indexOf(e);this._order.splice(n,1);var a=r?this._order.indexOf(r):this._order.length;r&&-1===a?this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.'))):(this._order.splice(a,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},r.prototype.removeLayer=function(e){this._checkLoaded();var r=this._layers[e];if(r){r.setEventedParent(null);var n=this._order.indexOf(e);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e]}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},r.prototype.getLayer=function(t){return this._layers[t]},r.prototype.setLayerZoomRange=function(e,r,n){this._checkLoaded();var a=this.getLayer(e);a?a.minzoom===r&&a.maxzoom===n||(null!=r&&(a.minzoom=r),null!=n&&(a.maxzoom=n),this._updateLayer(a)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},r.prototype.setFilter=function(e,r){this._checkLoaded();var n=this.getLayer(e);if(n){if(!t.default$10(n.filter,r))return null==r?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(t.validateStyle.filter,"layers."+n.id+".filter",r)||(n.filter=t.clone(r),this._updateLayer(n)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},r.prototype.getFilter=function(e){return t.clone(this.getLayer(e).filter)},r.prototype.setLayoutProperty=function(e,r,n){this._checkLoaded();var a=this.getLayer(e);a?t.default$10(a.getLayoutProperty(r),n)||(a.setLayoutProperty(r,n),this._updateLayer(a)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getLayoutProperty=function(t,e){return this.getLayer(t).getLayoutProperty(e)},r.prototype.setPaintProperty=function(e,r,n){this._checkLoaded();var a=this.getLayer(e);if(a){if(!t.default$10(a.getPaintProperty(r),n)){var i=a._transitionablePaint._values[r].value.isDataDriven();a.setPaintProperty(r,n),(a._transitionablePaint._values[r].value.isDataDriven()||i)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},r.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},r.prototype.serialize=function(){var e=this;return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,function(t){return t.serialize()}),layers:this._order.map(function(t){return e._layers[t].serialize()})},function(t){return void 0!==t})},r.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},r.prototype._flattenRenderedFeatures=function(t){for(var e=[],r=this._order.length-1;r>=0;r--)for(var n=this._order[r],a=0,i=t;a<i.length;a+=1){var o=i[a][n];if(o)for(var s=0,l=o;s<l.length;s+=1){var u=l[s];e.push(u)}}return e},r.prototype.queryRenderedFeatures=function(e,r,n){r&&r.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",r.filter);var a={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var i=0,o=r.layers;i<o.length;i+=1){var s=o[i],l=this._layers[s];if(!l)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];a[l.source]=!0}}var u=[];for(var c in this.sourceCaches)r.layers&&!a[c]||u.push(ot(this.sourceCaches[c],this._layers,e.worldCoordinate,r,n));return this.placement&&u.push(function(t,e,r,n,a){for(var i={},o=n.queryRenderedSymbols(e),s=[],l=0,u=Object.keys(o).map(Number);l<u.length;l+=1){var c=u[l];s.push(a[c])}s.sort(st);for(var f=function(){var e=p[h],n=e.featureIndex.lookupSymbolFeatures(o[e.bucketInstanceId],e.bucketIndex,e.sourceLayerIndex,r.filter,r.layers,t);for(var a in n){var s=i[a]=i[a]||[],l=n[a];l.sort(function(t,r){var n=e.featureSortOrder;if(n){var a=n.indexOf(t.featureIndex);return n.indexOf(r.featureIndex)-a}return r.featureIndex-t.featureIndex});for(var u=0,c=l;u<c.length;u+=1){var f=c[u];s.push(f.feature)}}},h=0,p=s;h<p.length;h+=1)f();return i}(this._layers,e.viewport,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenRenderedFeatures(u)},r.prototype.querySourceFeatures=function(e,r){r&&r.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",r.filter);var n=this.sourceCaches[e];return n?function(t,e){for(var r=t.getRenderableIds().map(function(e){return t.getTileByID(e)}),n=[],a={},i=0;i<r.length;i++){var o=r[i],s=o.tileID.canonical.key;a[s]||(a[s]=!0,o.querySourceFeatures(n,e))}return n}(n,r):[]},r.prototype.addSourceType=function(t,e,n){return r.getSourceType(t)?n(new Error('A source type called "'+t+'" already exists.')):(r.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))},r.prototype.getLight=function(){return this.light.getLight()},r.prototype.setLight=function(e){this._checkLoaded();var r=this.light.getLight(),n=!1;for(var a in e)if(!t.default$10(e[a],r[a])){n=!0;break}if(n){var o={now:i.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e),this.light.updateTransitions(o)}},r.prototype._validate=function(e,r,n,a,i){return(!i||!1!==i.validate)&&$e(this,e.call(t.validateStyle,t.extend({key:r,style:this.serialize(),value:n,styleSpec:t.default$5},a)))},r.prototype._remove=function(){for(var e in t.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[e].clearTiles();this.dispatcher.remove()},r.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},r.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},r.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},r.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},r.prototype._updatePlacement=function(t,e,r){for(var n=!1,a=!1,o={},s=0,l=this._order;s<l.length;s+=1){var u=l[s],c=this._layers[u];if("symbol"===c.type){if(!o[c.source]){var f=this.sourceCaches[c.source];o[c.source]=f.getRenderableIds().map(function(t){return f.getTileByID(t)}).sort(function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)})}var h=this.crossTileSymbolIndex.addLayer(c,o[c.source],t.center.lng);n=n||h}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var p=this._layerOrderChanged;if((p||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.now()))&&(this.pauseablePlacement=new He(t,this._order,p,e,r),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,o),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(this.placement,i.now()),a=!0),n&&this.pauseablePlacement.placement.setStale()),a||n)for(var d=0,v=this._order;d<v.length;d+=1){var g=v[d],m=this._layers[g];"symbol"===m.type&&this.placement.updateLayerOpacities(m,o[m.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.now())},r.prototype.getImages=function(t,e,r){this.imageManager.getImages(e.icons,r)},r.prototype.getGlyphs=function(t,e,r){this.glyphManager.getGlyphs(e.stacks,r)},r}(t.Evented);Qe.getSourceType=function(t){return at[t]},Qe.setSourceType=function(t,e){at[t]=e},Qe.registerForPluginAvailability=t.registerForPluginAvailability;var tr=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),er={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity = int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},background:{fragmentSource:"uniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main() {\n    gl_FragColor = u_color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},backgroundPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},clippingMask:{fragmentSource:"void main() {\n    gl_FragColor = vec4(1.0);\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},heatmap:{fragmentSource:"#pragma mapbox: define highp float weight\n\nuniform highp float u_intensity;\nvarying vec2 v_extrude;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main() {\n    #pragma mapbox: initialize highp float weight\n\n    // Kernel density estimation with a Gaussian kernel of size 5x5\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = weight * u_intensity * GAUSS_COEF * exp(d);\n\n    gl_FragColor = vec4(val, 1.0, 1.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\n\nuniform mat4 u_matrix;\nuniform float u_extrude_scale;\nuniform float u_opacity;\nuniform float u_intensity;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\n// Effective \"0\" in the kernel density texture to adjust the kernel size to;\n// this empirically chosen number minimizes artifacts on overlapping kernels\n// for typical heatmap cases (assuming clustered source)\nconst highp float ZERO = 1.0 / 255.0 / 16.0;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main(void) {\n    #pragma mapbox: initialize highp float weight\n    #pragma mapbox: initialize mediump float radius\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 unscaled_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // This 'extrude' comes in ranging from [-1, -1], to [1, 1].  We'll use\n    // it to produce the vertices of a square mesh framing the point feature\n    // we're adding to the kernel density texture.  We'll also pass it as\n    // a varying, so that the fragment shader can determine the distance of\n    // each fragment from the point feature.\n    // Before we do so, we need to scale it up sufficiently so that the\n    // kernel falls effectively to zero at the edge of the mesh.\n    // That is, we want to know S such that\n    // weight * u_intensity * GAUSS_COEF * exp(-0.5 * 3.0^2 * S^2) == ZERO\n    // Which solves to:\n    // S = sqrt(-2.0 * log(ZERO / (weight * u_intensity * GAUSS_COEF))) / 3.0\n    float S = sqrt(-2.0 * log(ZERO / weight / u_intensity / GAUSS_COEF)) / 3.0;\n\n    // Pass the varying in units of radius\n    v_extrude = S * unscaled_extrude;\n\n    // Scale by radius and the zoom-based scale factor to produce actual\n    // mesh position\n    vec2 extrude = v_extrude * radius * u_extrude_scale;\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec4 pos = vec4(floor(a_pos * 0.5) + extrude, 0, 1);\n\n    gl_Position = u_matrix * pos;\n}\n"},heatmapTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform sampler2D u_color_ramp;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    float t = texture2D(u_image, v_pos).r;\n    vec4 color = texture2D(u_color_ramp, vec2(t, 0.5));\n    gl_FragColor = color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},collisionBox:{fragmentSource:"\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        gl_FragColor *= .1;\n    }\n}",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field boxes in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    gl_Position.xy += a_extrude * u_extrude_scale * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n}\n"},collisionCircle:{fragmentSource:"uniform float u_overscale_factor;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    vec4 color = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        color = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        color *= .2;\n    }\n\n    float extrude_scale_length = length(v_extrude_scale);\n    float extrude_length = length(v_extrude) * extrude_scale_length;\n    float stroke_width = 15.0 * extrude_scale_length / u_overscale_factor;\n    float radius = v_radius * extrude_scale_length;\n\n    float distance_to_edge = abs(extrude_length - radius);\n    float opacity_t = smoothstep(-stroke_width, 0.0, -distance_to_edge);\n\n    gl_FragColor = opacity_t * color;\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\n\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field circles in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n\n    highp float padding_factor = 1.2; // Pad the vertices slightly to make room for anti-alias blur\n    gl_Position.xy += a_extrude * u_extrude_scale * padding_factor * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n    v_radius = abs(a_extrude.y); // We don't pitch the circles, so both units of the extrusion vector are equal in magnitude to the radius\n\n    v_extrude = a_extrude * padding_factor;\n    v_extrude_scale = u_extrude_scale * u_camera_to_center_distance * collision_perspective_ratio;\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    vec3 normal = a_normal_ed.xyz;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_mix);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\nuniform float u_height_factor;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\nvarying float v_directional;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec3 normal = a_normal_ed.xyz;\n    float edgedistance = a_normal_ed.w;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = normal.x == 1.0 && normal.y == 0.0 && normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},hillshadePrepare:{fragmentSource:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D u_image;\nvarying vec2 v_pos;\nuniform vec2 u_dimension;\nuniform float u_zoom;\nuniform float u_maxzoom;\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data = texture2D(u_image, coord) * 255.0;\n    return (data.r + data.g * 256.0 + data.b * 256.0 * 256.0) / 4.0;\n}\n\nvoid main() {\n    vec2 epsilon = 1.0 / u_dimension;\n\n    // queried pixels:\n    // +-----------+\n    // |   |   |   |\n    // | a | b | c |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | d | e | f |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | g | h | i |\n    // |   |   |   |\n    // +-----------+\n\n    float a = getElevation(v_pos + vec2(-epsilon.x, -epsilon.y), 0.0);\n    float b = getElevation(v_pos + vec2(0, -epsilon.y), 0.0);\n    float c = getElevation(v_pos + vec2(epsilon.x, -epsilon.y), 0.0);\n    float d = getElevation(v_pos + vec2(-epsilon.x, 0), 0.0);\n    float e = getElevation(v_pos, 0.0);\n    float f = getElevation(v_pos + vec2(epsilon.x, 0), 0.0);\n    float g = getElevation(v_pos + vec2(-epsilon.x, epsilon.y), 0.0);\n    float h = getElevation(v_pos + vec2(0, epsilon.y), 0.0);\n    float i = getElevation(v_pos + vec2(epsilon.x, epsilon.y), 0.0);\n\n    // here we divide the x and y slopes by 8 * pixel size\n    // where pixel size (aka meters/pixel) is:\n    // circumference of the world / (pixels per tile * number of tiles)\n    // which is equivalent to: 8 * 40075016.6855785 / (512 * pow(2, u_zoom))\n    // which can be reduced to: pow(2, 19.25619978527 - u_zoom)\n    // we want to vertically exaggerate the hillshading though, because otherwise\n    // it is barely noticeable at low zooms. to do this, we multiply this by some\n    // scale factor pow(2, (u_zoom - u_maxzoom) * a) where a is an arbitrary value\n    // Here we use a=0.3 which works out to the expression below. see \n    // nickidlugash's awesome breakdown for more info\n    // https://github.com/mapbox/mapbox-gl-js/pull/5286#discussion_r148419556\n    float exaggeration = u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;\n\n    vec2 deriv = vec2(\n        (c + f + f + i) - (a + d + d + g),\n        (g + h + h + i) - (a + b + b + c)\n    ) /  pow(2.0, (u_zoom - u_maxzoom) * exaggeration + 19.2562 - u_zoom);\n\n    gl_FragColor = clamp(vec4(\n        deriv.x / 2.0 + 0.5,\n        deriv.y / 2.0 + 0.5,\n        1.0,\n        1.0), 0.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (a_texture_pos / 8192.0) / 2.0 + 0.25;\n}\n"},hillshade:{fragmentSource:"uniform sampler2D u_image;\nvarying vec2 v_pos;\n\nuniform vec2 u_latrange;\nuniform vec2 u_light;\nuniform vec4 u_shadow;\nuniform vec4 u_highlight;\nuniform vec4 u_accent;\n\n#define PI 3.141592653589793\n\nvoid main() {\n    vec4 pixel = texture2D(u_image, v_pos);\n\n    vec2 deriv = ((pixel.rg * 2.0) - 1.0);\n\n    // We divide the slope by a scale factor based on the cosin of the pixel's approximate latitude\n    // to account for mercator projection distortion. see #4807 for details\n    float scaleFactor = cos(radians((u_latrange[0] - u_latrange[1]) * (1.0 - v_pos.y) + u_latrange[1]));\n    // We also multiply the slope by an arbitrary z-factor of 1.25\n    float slope = atan(1.25 * length(deriv) / scaleFactor);\n    float aspect = deriv.x != 0.0 ? atan(deriv.y, -deriv.x) : PI / 2.0 * (deriv.y > 0.0 ? 1.0 : -1.0);\n\n    float intensity = u_light.x;\n    // We add PI to make this property match the global light object, which adds PI/2 to the light's azimuthal\n    // position property to account for 0deg corresponding to north/the top of the viewport in the style spec\n    // and the original shader was written to accept (-illuminationDirection - 90) as the azimuthal.\n    float azimuth = u_light.y + PI;\n\n    // We scale the slope exponentially based on intensity, using a calculation similar to\n    // the exponential interpolation function in the style spec:\n    // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/expression/definitions/interpolate.js#L217-L228\n    // so that higher intensity values create more opaque hillshading.\n    float base = 1.875 - intensity * 1.75;\n    float maxValue = 0.5 * PI;\n    float scaledSlope = intensity != 0.5 ? ((pow(base, slope) - 1.0) / (pow(base, maxValue) - 1.0)) * maxValue : slope;\n\n    // The accent color is calculated with the cosine of the slope while the shade color is calculated with the sine\n    // so that the accent color's rate of change eases in while the shade color's eases out.\n    float accent = cos(scaledSlope);\n    // We multiply both the accent and shade color by a clamped intensity value\n    // so that intensities >= 0.5 do not additionally affect the color values\n    // while intensity values < 0.5 make the overall color more transparent.\n    vec4 accent_color = (1.0 - accent) * u_accent * clamp(intensity * 2.0, 0.0, 1.0);\n    float shade = abs(mod((aspect + azimuth) / PI + 0.5, 2.0) - 1.0);\n    vec4 shade_color = mix(u_shadow, u_highlight, shade) * sin(scaledSlope) * clamp(intensity * 2.0, 0.0, 1.0);\n    gl_FragColor = accent_color * (1.0 - shade_color.a) + shade_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = a_texture_pos / 8192.0;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_linesofar;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},lineGradient:{fragmentSource:"\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nuniform sampler2D u_image;\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    // For gradient lines, v_lineprogress is the ratio along the entire line,\n    // scaled to [0, 2^15), and the gradient ramp is stored in a texture.\n    vec4 color = texture2D(u_image, vec2(v_lineprogress, 0.5));\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n// the attribute conveying progress along a line is scaled to [0, 2^15)\n#define MAX_LINE_DISTANCE 32767.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_lineprogress = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0 / MAX_LINE_DISTANCE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n\n    // v_normal.y is 0 at the midpoint of the line, -1 at the lower edge, 1 at the upper edge\n    // we clamp the line width outset to be between 0 and half the pattern height plus padding (2.0)\n    // to ensure we don't sample outside the designated symbol on the sprite sheet.\n    // 0.5 is added to shift the component to be bounded between 0 and 1 for interpolation of\n    // the texture coordinate\n    float y_a = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_a.y + 2.0) / 2.0) / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_b.y + 2.0) / 2.0) / u_pattern_size_b.y);\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    v_pos0 = (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = opacity * v_fade_opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform float u_fade_change;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n            0.5 + 0.5 * distance_ratio,\n            0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n            4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    v_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n}\n"},symbolSDF:{fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n    float fade_opacity = v_data1[2];\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n    gl_FragColor = color * (alpha * opacity * fade_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform float u_fade_change;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    float interpolated_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n\n    v_data0 = vec2(tex.x, tex.y);\n    v_data1 = vec3(gamma_scale, size, interpolated_fade_opacity);\n}\n"}},rr=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,nr=function(t){var e=er[t],r={};e.fragmentSource=e.fragmentSource.replace(rr,function(t,e,n,a,i){return r[i]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+i+"\nvarying "+n+" "+a+" "+i+";\n#else\nuniform "+n+" "+a+" u_"+i+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+i+"\n    "+n+" "+a+" "+i+" = u_"+i+";\n#endif\n"}),e.vertexSource=e.vertexSource.replace(rr,function(t,e,n,a,i){var o="float"===a?"vec2":"vec4";return r[i]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+i+"\nuniform lowp float a_"+i+"_t;\nattribute "+n+" "+o+" a_"+i+";\nvarying "+n+" "+a+" "+i+";\n#else\nuniform "+n+" "+a+" u_"+i+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+i+" = unpack_mix_"+o+"(a_"+i+", a_"+i+"_t);\n#else\n    "+n+" "+a+" "+i+" = u_"+i+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+i+"\nuniform lowp float a_"+i+"_t;\nattribute "+n+" "+o+" a_"+i+";\n#else\nuniform "+n+" "+a+" u_"+i+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+n+" "+a+" "+i+" = unpack_mix_"+o+"(a_"+i+", a_"+i+"_t);\n#else\n    "+n+" "+a+" "+i+" = u_"+i+";\n#endif\n"})};for(var ar in er)nr(ar);var ir=er,or=function(t,e,r,n){var a=t.gl;this.program=a.createProgram();var o=r.defines().concat("#define DEVICE_PIXEL_RATIO "+i.devicePixelRatio.toFixed(1));n&&o.push("#define OVERDRAW_INSPECTOR;");var s=o.concat(ir.prelude.fragmentSource,e.fragmentSource).join("\n"),l=o.concat(ir.prelude.vertexSource,e.vertexSource).join("\n"),u=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(u,s),a.compileShader(u),a.attachShader(this.program,u);var c=a.createShader(a.VERTEX_SHADER);a.shaderSource(c,l),a.compileShader(c),a.attachShader(this.program,c);for(var f=r.layoutAttributes||[],h=0;h<f.length;h++)a.bindAttribLocation(this.program,h,f[h].name);a.linkProgram(this.program),this.numAttributes=a.getProgramParameter(this.program,a.ACTIVE_ATTRIBUTES),this.attributes={},this.uniforms={};for(var p=0;p<this.numAttributes;p++){var d=a.getActiveAttrib(this.program,p);d&&(this.attributes[d.name]=a.getAttribLocation(this.program,d.name))}for(var v=a.getProgramParameter(this.program,a.ACTIVE_UNIFORMS),g=0;g<v;g++){var m=a.getActiveUniform(this.program,g);m&&(this.uniforms[m.name]=a.getUniformLocation(this.program,m.name))}};function sr(e,r,n,a,i){for(var o=0;o<n.length;o++){var s=n[o];if(a.isLessThan(s.tileID))break;if(r.key===s.tileID.key)return;if(s.tileID.isChildOf(r)){for(var l=r.children(1/0),u=0;u<l.length;u++){sr(e,l[u],n.slice(o),a,i)}return}}var c=r.overscaledZ-e.overscaledZ,f=new t.CanonicalTileID(c,r.canonical.x-(e.canonical.x<<c),r.canonical.y-(e.canonical.y<<c));i[f.key]=i[f.key]||f}function lr(t,e,r,n,a){var i=t.context,o=i.gl,s=a?t.useProgram("collisionCircle"):t.useProgram("collisionBox");i.setDepthMode(Ht.disabled),i.setStencilMode(Gt.disabled),i.setColorMode(t.colorModeForRenderPass());for(var l=0;l<n.length;l++){var u=n[l],c=e.getTile(u),f=c.getBucket(r);if(f){var h=a?f.collisionCircle:f.collisionBox;if(h){o.uniformMatrix4fv(s.uniforms.u_matrix,!1,u.posMatrix),a||i.lineWidth.set(1),o.uniform1f(s.uniforms.u_camera_to_center_distance,t.transform.cameraToCenterDistance);var p=Ee(c,1,t.transform.zoom),d=Math.pow(2,t.transform.zoom-c.tileID.overscaledZ);o.uniform1f(s.uniforms.u_pixels_to_tile_units,p),o.uniform2f(s.uniforms.u_extrude_scale,t.transform.pixelsToGLUnits[0]/(p*d),t.transform.pixelsToGLUnits[1]/(p*d)),o.uniform1f(s.uniforms.u_overscale_factor,c.tileID.overscaleFactor()),s.draw(i,a?o.TRIANGLES:o.LINES,r.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,null,h.collisionVertexBuffer,null)}}}}or.prototype.draw=function(t,e,r,n,a,i,o,s,l){for(var u,c=t.gl,f=(u={},u[c.LINES]=2,u[c.TRIANGLES]=3,u)[e],h=0,p=i.get();h<p.length;h+=1){var d=p[h],v=d.vaos||(d.vaos={});(v[r]||(v[r]=new tt)).bind(t,this,n,o?o.getPaintVertexBuffers():[],a,d.vertexOffset,s,l),c.drawElements(e,d.primitiveLength*f,c.UNSIGNED_SHORT,d.primitiveOffset*f*2)}};var ur=t.mat4.identity(new Float32Array(16)),cr=t.default$19.layout;function fr(t,e,r,n,a,i,o,s,l,u){var c,f=t.context,h=f.gl,p=t.transform,d="map"===s,v="map"===l,g=d&&"line"===r.layout.get("symbol-placement"),m=d&&!v&&!g,y=v;f.setDepthMode(y?t.depthModeForSublayer(0,Ht.ReadOnly):Ht.disabled);for(var x=0,b=n;x<b.length;x+=1){var _=b[x],w=e.getTile(_),k=w.getBucket(r);if(k){var M=a?k.text:k.icon;if(M&&M.segments.get().length){var A=M.programConfigurations.get(r.id),T=a||k.sdfIcons,S=a?k.textSizeData:k.iconSizeData;if(c||(c=t.useProgram(T?"symbolSDF":"symbolIcon",A),A.setUniforms(t.context,c,r.paint,{zoom:t.transform.zoom}),hr(c,t,r,a,m,v,S)),f.activeTexture.set(h.TEXTURE0),h.uniform1i(c.uniforms.u_texture,0),a)w.glyphAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.uniform2fv(c.uniforms.u_texsize,w.glyphAtlasTexture.size);else{var E=1!==r.layout.get("icon-size").constantOr(0)||k.iconsNeedLinear,C=v||0!==p.pitch;w.iconAtlasTexture.bind(T||t.options.rotating||t.options.zooming||E||C?h.LINEAR:h.NEAREST,h.CLAMP_TO_EDGE),h.uniform2fv(c.uniforms.u_texsize,w.iconAtlasTexture.size)}h.uniformMatrix4fv(c.uniforms.u_matrix,!1,t.translatePosMatrix(_.posMatrix,w,i,o));var L=Ee(w,1,t.transform.zoom),I=pe(_.posMatrix,v,d,t.transform,L),z=de(_.posMatrix,v,d,t.transform,L);h.uniformMatrix4fv(c.uniforms.u_gl_coord_matrix,!1,t.translatePosMatrix(z,w,i,o,!0)),g?(h.uniformMatrix4fv(c.uniforms.u_label_plane_matrix,!1,ur),me(k,_.posMatrix,t,a,I,z,v,u)):h.uniformMatrix4fv(c.uniforms.u_label_plane_matrix,!1,I),h.uniform1f(c.uniforms.u_fade_change,t.options.fadeDuration?t.symbolFadeChange:1),pr(c,A,t,r,w,M,a,T,v)}}}}function hr(e,r,n,a,i,o,s){var l=r.context.gl,u=r.transform;l.uniform1i(e.uniforms.u_pitch_with_map,o?1:0),l.uniform1f(e.uniforms.u_is_text,a?1:0),l.uniform1f(e.uniforms.u_pitch,u.pitch/360*2*Math.PI);var c="constant"===s.functionType||"source"===s.functionType,f="constant"===s.functionType||"camera"===s.functionType;l.uniform1i(e.uniforms.u_is_size_zoom_constant,c?1:0),l.uniform1i(e.uniforms.u_is_size_feature_constant,f?1:0),l.uniform1f(e.uniforms.u_camera_to_center_distance,u.cameraToCenterDistance);var h=t.evaluateSizeForZoom(s,u.zoom,cr.properties[a?"text-size":"icon-size"]);void 0!==h.uSizeT&&l.uniform1f(e.uniforms.u_size_t,h.uSizeT),void 0!==h.uSize&&l.uniform1f(e.uniforms.u_size,h.uSize),l.uniform1f(e.uniforms.u_aspect_ratio,u.width/u.height),l.uniform1i(e.uniforms.u_rotate_symbol,i?1:0)}function pr(t,e,r,n,a,i,o,s,l){var u=r.context,c=u.gl,f=r.transform;if(s){var h=0!==n.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1),p=l?Math.cos(f._pitch)*f.cameraToCenterDistance:1;c.uniform1f(t.uniforms.u_gamma_scale,p),h&&(c.uniform1f(t.uniforms.u_is_halo,1),dr(i,n,u,t)),c.uniform1f(t.uniforms.u_is_halo,0)}dr(i,n,u,t)}function dr(t,e,r,n){n.draw(r,r.gl.TRIANGLES,e.id,t.layoutVertexBuffer,t.indexBuffer,t.segments,t.programConfigurations.get(e.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function vr(t,e,r,n,a,o,s,l,u){var c,f,h,p,d=e.context,v=d.gl,g=a.paint.get("line-dasharray"),m=a.paint.get("line-pattern");if(l||u){var y=1/Ee(r,1,e.transform.tileZoom);if(g){c=e.lineAtlas.getDash(g.from,"round"===a.layout.get("line-cap")),f=e.lineAtlas.getDash(g.to,"round"===a.layout.get("line-cap"));var x=c.width*g.fromScale,b=f.width*g.toScale;v.uniform2f(t.uniforms.u_patternscale_a,y/x,-c.height/2),v.uniform2f(t.uniforms.u_patternscale_b,y/b,-f.height/2),v.uniform1f(t.uniforms.u_sdfgamma,e.lineAtlas.width/(256*Math.min(x,b)*i.devicePixelRatio)/2)}else if(m){if(h=e.imageManager.getPattern(m.from),p=e.imageManager.getPattern(m.to),!h||!p)return;v.uniform2f(t.uniforms.u_pattern_size_a,h.displaySize[0]*m.fromScale/y,h.displaySize[1]),v.uniform2f(t.uniforms.u_pattern_size_b,p.displaySize[0]*m.toScale/y,p.displaySize[1]);var _=e.imageManager.getPixelSize(),w=_.width,k=_.height;v.uniform2fv(t.uniforms.u_texsize,[w,k])}v.uniform2f(t.uniforms.u_gl_units_to_pixels,1/e.transform.pixelsToGLUnits[0],1/e.transform.pixelsToGLUnits[1])}l&&(g?(v.uniform1i(t.uniforms.u_image,0),d.activeTexture.set(v.TEXTURE0),e.lineAtlas.bind(d),v.uniform1f(t.uniforms.u_tex_y_a,c.y),v.uniform1f(t.uniforms.u_tex_y_b,f.y),v.uniform1f(t.uniforms.u_mix,g.t)):m&&(v.uniform1i(t.uniforms.u_image,0),d.activeTexture.set(v.TEXTURE0),e.imageManager.bind(d),v.uniform2fv(t.uniforms.u_pattern_tl_a,h.tl),v.uniform2fv(t.uniforms.u_pattern_br_a,h.br),v.uniform2fv(t.uniforms.u_pattern_tl_b,p.tl),v.uniform2fv(t.uniforms.u_pattern_br_b,p.br),v.uniform1f(t.uniforms.u_fade,m.t))),d.setStencilMode(e.stencilModeForClipping(o));var M=e.translatePosMatrix(o.posMatrix,r,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"));if(v.uniformMatrix4fv(t.uniforms.u_matrix,!1,M),v.uniform1f(t.uniforms.u_ratio,1/Ee(r,1,e.transform.zoom)),a.paint.get("line-gradient")){d.activeTexture.set(v.TEXTURE0);var A=a.gradientTexture;if(!a.gradient)return;A||(A=a.gradientTexture=new z(d,a.gradient,v.RGBA)),A.bind(v.LINEAR,v.CLAMP_TO_EDGE),v.uniform1i(t.uniforms.u_image,0)}t.draw(d,v.TRIANGLES,a.id,n.layoutVertexBuffer,n.indexBuffer,n.segments,s)}var gr=function(t,e){if(!t)return!1;var r=e.imageManager.getPattern(t.from),n=e.imageManager.getPattern(t.to);return!r||!n},mr=function(t,e,r){var n=e.context,a=n.gl,i=e.imageManager.getPattern(t.from),o=e.imageManager.getPattern(t.to);a.uniform1i(r.uniforms.u_image,0),a.uniform2fv(r.uniforms.u_pattern_tl_a,i.tl),a.uniform2fv(r.uniforms.u_pattern_br_a,i.br),a.uniform2fv(r.uniforms.u_pattern_tl_b,o.tl),a.uniform2fv(r.uniforms.u_pattern_br_b,o.br);var s=e.imageManager.getPixelSize(),l=s.width,u=s.height;a.uniform2fv(r.uniforms.u_texsize,[l,u]),a.uniform1f(r.uniforms.u_mix,t.t),a.uniform2fv(r.uniforms.u_pattern_size_a,i.displaySize),a.uniform2fv(r.uniforms.u_pattern_size_b,o.displaySize),a.uniform1f(r.uniforms.u_scale_a,t.fromScale),a.uniform1f(r.uniforms.u_scale_b,t.toScale),n.activeTexture.set(a.TEXTURE0),e.imageManager.bind(e.context)},yr=function(t,e,r){var n=e.context.gl;n.uniform1f(r.uniforms.u_tile_units_to_pixels,1/Ee(t,1,e.transform.tileZoom));var a=Math.pow(2,t.tileID.overscaledZ),i=t.tileSize*Math.pow(2,e.transform.tileZoom)/a,o=i*(t.tileID.canonical.x+t.tileID.wrap*a),s=i*t.tileID.canonical.y;n.uniform2f(r.uniforms.u_pixel_coord_upper,o>>16,s>>16),n.uniform2f(r.uniforms.u_pixel_coord_lower,65535&o,65535&s)};function xr(t,e,r,n,a){if(!gr(r.paint.get("fill-pattern"),t))for(var i=!0,o=0,s=n;o<s.length;o+=1){var l=s[o],u=e.getTile(l),c=u.getBucket(r);c&&(t.context.setStencilMode(t.stencilModeForClipping(l)),a(t,e,r,u,l,c,i),i=!1)}}function br(t,e,r,n,a,i,o){var s=t.context.gl,l=i.programConfigurations.get(r.id);wr("fill",r.paint.get("fill-pattern"),t,l,r,n,a,o).draw(t.context,s.TRIANGLES,r.id,i.layoutVertexBuffer,i.indexBuffer,i.segments,l)}function _r(t,e,r,n,a,i,o){var s=t.context.gl,l=i.programConfigurations.get(r.id),u=wr("fillOutline",r.getPaintProperty("fill-outline-color")?null:r.paint.get("fill-pattern"),t,l,r,n,a,o);s.uniform2f(u.uniforms.u_world,s.drawingBufferWidth,s.drawingBufferHeight),u.draw(t.context,s.LINES,r.id,i.layoutVertexBuffer,i.indexBuffer2,i.segments2,l)}function wr(t,e,r,n,a,i,o,s){var l,u=r.context.program.get();return e?(l=r.useProgram(t+"Pattern",n),(s||l.program!==u)&&(n.setUniforms(r.context,l,a.paint,{zoom:r.transform.zoom}),mr(e,r,l)),yr(i,r,l)):(l=r.useProgram(t,n),(s||l.program!==u)&&n.setUniforms(r.context,l,a.paint,{zoom:r.transform.zoom})),r.context.gl.uniformMatrix4fv(l.uniforms.u_matrix,!1,r.translatePosMatrix(o.posMatrix,i,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"))),l}var kr=t.default$20.mat3,Mr=t.default$20.mat4,Ar=t.default$20.vec3;function Tr(t,e,r,n,a,i,o){var s=t.context,l=s.gl,u=r.paint.get("fill-extrusion-pattern"),c=t.context.program.get(),f=i.programConfigurations.get(r.id),h=t.useProgram(u?"fillExtrusionPattern":"fillExtrusion",f);if((o||h.program!==c)&&f.setUniforms(s,h,r.paint,{zoom:t.transform.zoom}),u){if(gr(u,t))return;mr(u,t,h),yr(n,t,h),l.uniform1f(h.uniforms.u_height_factor,-Math.pow(2,a.overscaledZ)/n.tileSize/8)}t.context.gl.uniformMatrix4fv(h.uniforms.u_matrix,!1,t.translatePosMatrix(a.posMatrix,n,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor"))),function(t,e){var r=e.context.gl,n=e.style.light,a=n.properties.get("position"),i=[a.x,a.y,a.z],o=kr.create();"viewport"===n.properties.get("anchor")&&kr.fromRotation(o,-e.transform.angle);Ar.transformMat3(i,i,o);var s=n.properties.get("color");r.uniform3fv(t.uniforms.u_lightpos,i),r.uniform1f(t.uniforms.u_lightintensity,n.properties.get("intensity")),r.uniform3f(t.uniforms.u_lightcolor,s.r,s.g,s.b)}(h,t),h.draw(s,l.TRIANGLES,r.id,i.layoutVertexBuffer,i.indexBuffer,i.segments,f)}function Sr(e,r,n){var a=e.context,i=a.gl,o=r.fbo;if(o){var s=e.useProgram("hillshade"),l=e.transform.calculatePosMatrix(r.tileID.toUnwrapped(),!0);!function(t,e,r){var n=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===r.paint.get("hillshade-illumination-anchor")&&(n-=e.transform.angle),e.context.gl.uniform2f(t.uniforms.u_light,r.paint.get("hillshade-exaggeration"),n)}(s,e,n);var u=function(e,r){var n=r.toCoordinate(),a=new t.default$17(n.column,n.row+1,n.zoom);return[e.transform.coordinateLocation(n).lat,e.transform.coordinateLocation(a).lat]}(e,r.tileID);a.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),i.uniformMatrix4fv(s.uniforms.u_matrix,!1,l),i.uniform2fv(s.uniforms.u_latrange,u),i.uniform1i(s.uniforms.u_image,0);var c=n.paint.get("hillshade-shadow-color");i.uniform4f(s.uniforms.u_shadow,c.r,c.g,c.b,c.a);var f=n.paint.get("hillshade-highlight-color");i.uniform4f(s.uniforms.u_highlight,f.r,f.g,f.b,f.a);var h=n.paint.get("hillshade-accent-color");if(i.uniform4f(s.uniforms.u_accent,h.r,h.g,h.b,h.a),r.maskedBoundsBuffer&&r.maskedIndexBuffer&&r.segments)s.draw(a,i.TRIANGLES,n.id,r.maskedBoundsBuffer,r.maskedIndexBuffer,r.segments);else{var p=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(a,s,p,[]),i.drawArrays(i.TRIANGLE_STRIP,0,p.length)}}}function Er(e,r,n){var a=e.context,i=a.gl;if(r.dem&&r.dem.level){var o=r.dem.level.dim,s=r.dem.getPixels();if(a.activeTexture.set(i.TEXTURE1),a.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||e.getTileTexture(r.tileSize),r.demTexture){var l=r.demTexture;l.update(s,{premultiply:!1}),l.bind(i.NEAREST,i.CLAMP_TO_EDGE)}else r.demTexture=new z(a,s,i.RGBA,{premultiply:!1}),r.demTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE);a.activeTexture.set(i.TEXTURE0);var u=r.fbo;if(!u){var c=new z(a,{width:o,height:o,data:null},i.RGBA);c.bind(i.LINEAR,i.CLAMP_TO_EDGE),(u=r.fbo=a.createFramebuffer(o,o)).colorAttachment.set(c.texture)}a.bindFramebuffer.set(u.framebuffer),a.viewport.set([0,0,o,o]);var f=t.mat4.create();t.mat4.ortho(f,0,t.default$8,-t.default$8,0,0,1),t.mat4.translate(f,f,[0,-t.default$8,0]);var h=e.useProgram("hillshadePrepare");i.uniformMatrix4fv(h.uniforms.u_matrix,!1,f),i.uniform1f(h.uniforms.u_zoom,r.tileID.overscaledZ),i.uniform2fv(h.uniforms.u_dimension,[2*o,2*o]),i.uniform1i(h.uniforms.u_image,1),i.uniform1f(h.uniforms.u_maxzoom,n);var p=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(a,h,p,[]),i.drawArrays(i.TRIANGLE_STRIP,0,p.length),r.needsHillshadePrepare=!1}}function Cr(e,r,n,a,o){var s=a.paint.get("raster-fade-duration");if(s>0){var l=i.now(),u=(l-e.timeAdded)/s,c=r?(l-r.timeAdded)/s:-1,f=n.getSource(),h=o.coveringZoomLevel({tileSize:f.tileSize,roundZoom:f.roundZoom}),p=!r||Math.abs(r.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),d=p&&e.refreshedUponExpiration?1:t.clamp(p?u:1-c,0,1);return e.refreshedUponExpiration&&u>=1&&(e.refreshedUponExpiration=!1),r?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}function Lr(e,r,n){var a=e.context,o=a.gl;a.lineWidth.set(1*i.devicePixelRatio);var s=n.posMatrix,l=e.useProgram("debug");a.setDepthMode(Ht.disabled),a.setStencilMode(Gt.disabled),a.setColorMode(e.colorModeForRenderPass()),o.uniformMatrix4fv(l.uniforms.u_matrix,!1,s),o.uniform4f(l.uniforms.u_color,1,0,0,1),e.debugVAO.bind(a,l,e.debugBuffer,[]),o.drawArrays(o.LINE_STRIP,0,e.debugBuffer.length);for(var u=function(t,e,r,n){n=n||1;var a,i,o,s,l,u,c,f,h=[];for(a=0,i=t.length;a<i;a++)if(l=Ir[t[a]]){for(f=null,o=0,s=l[1].length;o<s;o+=2)-1===l[1][o]&&-1===l[1][o+1]?f=null:(u=e+l[1][o]*n,c=r-l[1][o+1]*n,f&&h.push(f.x,f.y,u,c),f={x:u,y:c});e+=l[0]*n}return h}(n.toString(),50,200,5),c=new t.PosArray,f=0;f<u.length;f+=2)c.emplaceBack(u[f],u[f+1]);var h=a.createVertexBuffer(c,tr.members);(new tt).bind(a,l,h,[]),o.uniform4f(l.uniforms.u_color,1,1,1,1);for(var p=r.getTile(n).tileSize,d=t.default$8/(Math.pow(2,e.transform.zoom-n.overscaledZ)*p),v=[[-1,-1],[-1,1],[1,-1],[1,1]],g=0;g<v.length;g++){var m=v[g];o.uniformMatrix4fv(l.uniforms.u_matrix,!1,t.mat4.translate([],s,[d*m[0],d*m[1],0])),o.drawArrays(o.LINES,0,h.length)}o.uniform4f(l.uniforms.u_color,0,0,0,1),o.uniformMatrix4fv(l.uniforms.u_matrix,!1,s),o.drawArrays(o.LINES,0,h.length)}var Ir={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]};var zr={symbol:function(t,e,r,n){if("translucent"===t.renderPass){var a=t.context;a.setStencilMode(Gt.disabled),a.setColorMode(t.colorModeForRenderPass()),0!==r.paint.get("icon-opacity").constantOr(1)&&fr(t,e,r,n,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright")),0!==r.paint.get("text-opacity").constantOr(1)&&fr(t,e,r,n,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright")),e.map.showCollisionBoxes&&function(t,e,r,n){lr(t,e,r,n,!1),lr(t,e,r,n,!0)}(t,e,r,n)}},circle:function(t,e,r,n){if("translucent"===t.renderPass){var a=r.paint.get("circle-opacity"),i=r.paint.get("circle-stroke-width"),o=r.paint.get("circle-stroke-opacity");if(0!==a.constantOr(1)||0!==i.constantOr(1)&&0!==o.constantOr(1)){var s=t.context,l=s.gl;s.setDepthMode(t.depthModeForSublayer(0,Ht.ReadOnly)),s.setStencilMode(Gt.disabled),s.setColorMode(t.colorModeForRenderPass());for(var u=!0,c=0;c<n.length;c++){var f=n[c],h=e.getTile(f),p=h.getBucket(r);if(p){var d=t.context.program.get(),v=p.programConfigurations.get(r.id),g=t.useProgram("circle",v);if((u||g.program!==d)&&(v.setUniforms(s,g,r.paint,{zoom:t.transform.zoom}),u=!1),l.uniform1f(g.uniforms.u_camera_to_center_distance,t.transform.cameraToCenterDistance),l.uniform1i(g.uniforms.u_scale_with_map,"map"===r.paint.get("circle-pitch-scale")?1:0),"map"===r.paint.get("circle-pitch-alignment")){l.uniform1i(g.uniforms.u_pitch_with_map,1);var m=Ee(h,1,t.transform.zoom);l.uniform2f(g.uniforms.u_extrude_scale,m,m)}else l.uniform1i(g.uniforms.u_pitch_with_map,0),l.uniform2fv(g.uniforms.u_extrude_scale,t.transform.pixelsToGLUnits);l.uniformMatrix4fv(g.uniforms.u_matrix,!1,t.translatePosMatrix(f.posMatrix,h,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor"))),g.draw(s,l.TRIANGLES,r.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,v)}}}}},heatmap:function(e,r,n,a){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var i=e.context,o=i.gl;i.setDepthMode(e.depthModeForSublayer(0,Ht.ReadOnly)),i.setStencilMode(Gt.disabled),function(t,e,r){var n=t.gl;t.activeTexture.set(n.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var a=r.heatmapFbo;if(a)n.bindTexture(n.TEXTURE_2D,a.colorAttachment.get()),t.bindFramebuffer.set(a.framebuffer);else{var i=n.createTexture();n.bindTexture(n.TEXTURE_2D,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),a=r.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4),function t(e,r,n,a){var i=e.gl;i.texImage2D(i.TEXTURE_2D,0,i.RGBA,r.width/4,r.height/4,0,i.RGBA,e.extTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:i.UNSIGNED_BYTE,null),a.colorAttachment.set(n),e.extTextureHalfFloat&&i.checkFramebufferStatus(i.FRAMEBUFFER)!==i.FRAMEBUFFER_COMPLETE&&(e.extTextureHalfFloat=null,a.colorAttachment.setDirty(),t(e,r,n,a))}(t,e,i,a)}}(i,e,n),i.clear({color:t.default$6.transparent}),i.setColorMode(new Wt([o.ONE,o.ONE],t.default$6.transparent,[!0,!0,!0,!0]));for(var s=!0,l=0;l<a.length;l++){var u=a[l];if(!r.hasRenderableParent(u)){var c=r.getTile(u),f=c.getBucket(n);if(f){var h=e.context.program.get(),p=f.programConfigurations.get(n.id),d=e.useProgram("heatmap",p),v=e.transform.zoom;(s||d.program!==h)&&(p.setUniforms(e.context,d,n.paint,{zoom:v}),s=!1),o.uniform1f(d.uniforms.u_extrude_scale,Ee(c,1,v)),o.uniform1f(d.uniforms.u_intensity,n.paint.get("heatmap-intensity")),o.uniformMatrix4fv(d.uniforms.u_matrix,!1,u.posMatrix),d.draw(i,o.TRIANGLES,n.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,p)}}}i.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,r){var n=e.context,a=n.gl,i=r.heatmapFbo;if(i){n.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,i.colorAttachment.get()),n.activeTexture.set(a.TEXTURE1);var o=r.colorRampTexture;o||(o=r.colorRampTexture=new z(n,r.colorRamp,a.RGBA)),o.bind(a.LINEAR,a.CLAMP_TO_EDGE),n.setDepthMode(Ht.disabled);var s=e.useProgram("heatmapTexture"),l=r.paint.get("heatmap-opacity");a.uniform1f(s.uniforms.u_opacity,l),a.uniform1i(s.uniforms.u_image,0),a.uniform1i(s.uniforms.u_color_ramp,1);var u=t.mat4.create();t.mat4.ortho(u,0,e.width,e.height,0,0,1),a.uniformMatrix4fv(s.uniforms.u_matrix,!1,u),a.uniform2f(s.uniforms.u_world,a.drawingBufferWidth,a.drawingBufferHeight),e.viewportVAO.bind(e.context,s,e.viewportBuffer,[]),a.drawArrays(a.TRIANGLE_STRIP,0,4)}}(e,n))},line:function(t,e,r,n){if("translucent"===t.renderPass&&0!==r.paint.get("line-opacity").constantOr(1)){var a=t.context;a.setDepthMode(t.depthModeForSublayer(0,Ht.ReadOnly)),a.setColorMode(t.colorModeForRenderPass());for(var i,o=r.paint.get("line-dasharray")?"lineSDF":r.paint.get("line-pattern")?"linePattern":r.paint.get("line-gradient")?"lineGradient":"line",s=!0,l=0,u=n;l<u.length;l+=1){var c=u[l],f=e.getTile(c),h=f.getBucket(r);if(h){var p=h.programConfigurations.get(r.id),d=t.context.program.get(),v=t.useProgram(o,p),g=s||v.program!==d,m=i!==f.tileID.overscaledZ;g&&p.setUniforms(t.context,v,r.paint,{zoom:t.transform.zoom}),vr(v,t,f,h,r,c,p,g,m),i=f.tileID.overscaledZ,s=!1}}}},fill:function(e,r,n,a){var i=n.paint.get("fill-color"),o=n.paint.get("fill-opacity");if(0!==o.constantOr(1)){var s=e.context;s.setColorMode(e.colorModeForRenderPass());var l=n.paint.get("fill-pattern")||1!==i.constantOr(t.default$6.transparent).a||1!==o.constantOr(0)?"translucent":"opaque";e.renderPass===l&&(s.setDepthMode(e.depthModeForSublayer(1,"opaque"===e.renderPass?Ht.ReadWrite:Ht.ReadOnly)),xr(e,r,n,a,br)),"translucent"===e.renderPass&&n.paint.get("fill-antialias")&&(s.lineWidth.set(2),s.setDepthMode(e.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,Ht.ReadOnly)),xr(e,r,n,a,_r))}},"fill-extrusion":function(e,r,n,a){if(0!==n.paint.get("fill-extrusion-opacity"))if("offscreen"===e.renderPass){!function(e,r){var n=e.context,a=n.gl,i=r.viewportFrame;if(e.depthRboNeedsClear&&e.setupOffscreenDepthRenderbuffer(),!i){var o=new z(n,{width:e.width,height:e.height,data:null},a.RGBA);o.bind(a.LINEAR,a.CLAMP_TO_EDGE),(i=r.viewportFrame=n.createFramebuffer(e.width,e.height)).colorAttachment.set(o.texture)}n.bindFramebuffer.set(i.framebuffer),i.depthAttachment.set(e.depthRbo),e.depthRboNeedsClear&&(n.clear({depth:1}),e.depthRboNeedsClear=!1),n.clear({color:t.default$6.transparent}),n.setStencilMode(Gt.disabled),n.setDepthMode(new Ht(a.LEQUAL,Ht.ReadWrite,[0,1])),n.setColorMode(e.colorModeForRenderPass())}(e,n);for(var i=!0,o=0,s=a;o<s.length;o+=1){var l=s[o],u=r.getTile(l),c=u.getBucket(n);c&&(Tr(e,0,n,u,l,c,i),i=!1)}}else"translucent"===e.renderPass&&function(t,e){var r=e.viewportFrame;if(r){var n=t.context,a=n.gl,i=t.useProgram("extrusionTexture");n.setStencilMode(Gt.disabled),n.setDepthMode(Ht.disabled),n.setColorMode(t.colorModeForRenderPass()),n.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,r.colorAttachment.get()),a.uniform1f(i.uniforms.u_opacity,e.paint.get("fill-extrusion-opacity")),a.uniform1i(i.uniforms.u_image,0);var o=Mr.create();Mr.ortho(o,0,t.width,t.height,0,0,1),a.uniformMatrix4fv(i.uniforms.u_matrix,!1,o),a.uniform2f(i.uniforms.u_world,a.drawingBufferWidth,a.drawingBufferHeight),t.viewportVAO.bind(n,i,t.viewportBuffer,[]),a.drawArrays(a.TRIANGLE_STRIP,0,4)}}(e,n)},hillshade:function(t,e,r,n){if("offscreen"===t.renderPass||"translucent"===t.renderPass){var a=t.context,i=e.getSource().maxzoom;a.setDepthMode(t.depthModeForSublayer(0,Ht.ReadOnly)),a.setStencilMode(Gt.disabled),a.setColorMode(t.colorModeForRenderPass());for(var o=0,s=n;o<s.length;o+=1){var l=s[o],u=e.getTile(l);u.needsHillshadePrepare&&"offscreen"===t.renderPass?Er(t,u,i):"translucent"===t.renderPass&&Sr(t,u,r)}a.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,r,n){if("translucent"===t.renderPass&&0!==r.paint.get("raster-opacity")){var a,i,o=t.context,s=o.gl,l=e.getSource(),u=t.useProgram("raster");o.setStencilMode(Gt.disabled),o.setColorMode(t.colorModeForRenderPass()),s.uniform1f(u.uniforms.u_brightness_low,r.paint.get("raster-brightness-min")),s.uniform1f(u.uniforms.u_brightness_high,r.paint.get("raster-brightness-max")),s.uniform1f(u.uniforms.u_saturation_factor,(a=r.paint.get("raster-saturation"))>0?1-1/(1.001-a):-a),s.uniform1f(u.uniforms.u_contrast_factor,(i=r.paint.get("raster-contrast"))>0?1/(1-i):1+i),s.uniform3fv(u.uniforms.u_spin_weights,function(t){t*=Math.PI/180;var e=Math.sin(t),r=Math.cos(t);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}(r.paint.get("raster-hue-rotate"))),s.uniform1f(u.uniforms.u_buffer_scale,1),s.uniform1i(u.uniforms.u_image0,0),s.uniform1i(u.uniforms.u_image1,1);for(var c=n.length&&n[0].overscaledZ,f=0,h=n;f<h.length;f+=1){var p=h[f];o.setDepthMode(t.depthModeForSublayer(p.overscaledZ-c,1===r.paint.get("raster-opacity")?Ht.ReadWrite:Ht.ReadOnly,s.LESS));var d=e.getTile(p),v=t.transform.calculatePosMatrix(p.toUnwrapped(),!0);d.registerFadeDuration(r.paint.get("raster-fade-duration")),s.uniformMatrix4fv(u.uniforms.u_matrix,!1,v);var g=e.findLoadedParent(p,0,{}),m=Cr(d,g,e,r,t.transform),y=void 0,x=void 0;if(o.activeTexture.set(s.TEXTURE0),d.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),o.activeTexture.set(s.TEXTURE1),g?(g.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),y=Math.pow(2,g.tileID.overscaledZ-d.tileID.overscaledZ),x=[d.tileID.canonical.x*y%1,d.tileID.canonical.y*y%1]):d.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),s.uniform2fv(u.uniforms.u_tl_parent,x||[0,0]),s.uniform1f(u.uniforms.u_scale_parent,y||1),s.uniform1f(u.uniforms.u_fade_t,m.mix),s.uniform1f(u.uniforms.u_opacity,m.opacity*r.paint.get("raster-opacity")),l instanceof et){var b=l.boundsBuffer;l.boundsVAO.bind(o,u,b,[]),s.drawArrays(s.TRIANGLE_STRIP,0,b.length)}else if(d.maskedBoundsBuffer&&d.maskedIndexBuffer&&d.segments)u.draw(o,s.TRIANGLES,r.id,d.maskedBoundsBuffer,d.maskedIndexBuffer,d.segments);else{var _=t.rasterBoundsBuffer;t.rasterBoundsVAO.bind(o,u,_,[]),s.drawArrays(s.TRIANGLE_STRIP,0,_.length)}}}},background:function(t,e,r){var n=r.paint.get("background-color"),a=r.paint.get("background-opacity");if(0!==a){var i=t.context,o=i.gl,s=t.transform,l=s.tileSize,u=r.paint.get("background-pattern"),c=u||1!==n.a||1!==a?"translucent":"opaque";if(t.renderPass===c){var f;if(i.setStencilMode(Gt.disabled),i.setDepthMode(t.depthModeForSublayer(0,"opaque"===c?Ht.ReadWrite:Ht.ReadOnly)),i.setColorMode(t.colorModeForRenderPass()),u){if(gr(u,t))return;f=t.useProgram("backgroundPattern"),mr(u,t,f),t.tileExtentPatternVAO.bind(i,f,t.tileExtentBuffer,[])}else f=t.useProgram("background"),o.uniform4fv(f.uniforms.u_color,[n.r,n.g,n.b,n.a]),t.tileExtentVAO.bind(i,f,t.tileExtentBuffer,[]);o.uniform1f(f.uniforms.u_opacity,a);for(var h=0,p=s.coveringTiles({tileSize:l});h<p.length;h+=1){var d=p[h];u&&yr({tileID:d,tileSize:l},t,f),o.uniformMatrix4fv(f.uniforms.u_matrix,!1,t.transform.calculatePosMatrix(d.toUnwrapped())),o.drawArrays(o.TRIANGLE_STRIP,0,t.tileExtentBuffer.length)}}}},debug:function(t,e,r){for(var n=0;n<r.length;n++)Lr(t,e,r[n])}},Pr=function(e,r){this.context=new Yt(e),this.transform=r,this._tileTextures={},this.setup(),this.numSublayers=Xt.maxUnderzooming+Xt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new t.default$24,this.crossTileSymbolIndex=new Ze};function Or(t,e){if(t.row>e.row){var r=t;t=e,e=r}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function Dr(t,e,r,n,a){var i=Math.max(r,Math.floor(e.y0)),o=Math.min(n,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var l=t.dx/t.dy,u=e.dx/e.dy,c=t.dx>0,f=e.dx<0,h=i;h<o;h++){var p=l*Math.max(0,Math.min(t.dy,h+c-t.y0))+t.x0,d=u*Math.max(0,Math.min(e.dy,h+f-e.y0))+e.x0;a(Math.floor(d),Math.ceil(p),h)}}function Rr(t,e,r,n,a,i){var o,s=Or(t,e),l=Or(e,r),u=Or(r,t);s.dy>l.dy&&(o=s,s=l,l=o),s.dy>u.dy&&(o=s,s=u,u=o),l.dy>u.dy&&(o=l,l=u,u=o),s.dy&&Dr(u,s,n,a,i),l.dy&&Dr(u,l,n,a,i)}Pr.prototype.resize=function(t,e){var r=this.context.gl;if(this.width=t*i.devicePixelRatio,this.height=e*i.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,a=this.style._order;n<a.length;n+=1){var o=a[n];this.style._layers[o].resize()}this.depthRbo&&(r.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},Pr.prototype.setup=function(){var e=this.context,r=new t.PosArray;r.emplaceBack(0,0),r.emplaceBack(t.default$8,0),r.emplaceBack(0,t.default$8),r.emplaceBack(t.default$8,t.default$8),this.tileExtentBuffer=e.createVertexBuffer(r,tr.members),this.tileExtentVAO=new tt,this.tileExtentPatternVAO=new tt;var n=new t.PosArray;n.emplaceBack(0,0),n.emplaceBack(t.default$8,0),n.emplaceBack(t.default$8,t.default$8),n.emplaceBack(0,t.default$8),n.emplaceBack(0,0),this.debugBuffer=e.createVertexBuffer(n,tr.members),this.debugVAO=new tt;var a=new t.RasterBoundsArray;a.emplaceBack(0,0,0,0),a.emplaceBack(t.default$8,0,t.default$8,0),a.emplaceBack(0,t.default$8,0,t.default$8),a.emplaceBack(t.default$8,t.default$8,t.default$8,t.default$8),this.rasterBoundsBuffer=e.createVertexBuffer(a,Q.members),this.rasterBoundsVAO=new tt;var i=new t.PosArray;i.emplaceBack(0,0),i.emplaceBack(1,0),i.emplaceBack(0,1),i.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(i,tr.members),this.viewportVAO=new tt},Pr.prototype.clearStencil=function(){var e=this.context,r=e.gl;e.setColorMode(Wt.disabled),e.setDepthMode(Ht.disabled),e.setStencilMode(new Gt({func:r.ALWAYS,mask:0},0,255,r.ZERO,r.ZERO,r.ZERO));var n=t.mat4.create();t.mat4.ortho(n,0,this.width,this.height,0,0,1),t.mat4.scale(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]);var a=this.useProgram("clippingMask");r.uniformMatrix4fv(a.uniforms.u_matrix,!1,n),this.viewportVAO.bind(e,a,this.viewportBuffer,[]),r.drawArrays(r.TRIANGLE_STRIP,0,4)},Pr.prototype._renderTileClippingMasks=function(t){var e=this.context,r=e.gl;e.setColorMode(Wt.disabled),e.setDepthMode(Ht.disabled);var n=1;this._tileClippingMaskIDs={};for(var a=0,i=t;a<i.length;a+=1){var o=i[a],s=this._tileClippingMaskIDs[o.key]=n++;e.setStencilMode(new Gt({func:r.ALWAYS,mask:0},s,255,r.KEEP,r.KEEP,r.REPLACE));var l=this.useProgram("clippingMask");r.uniformMatrix4fv(l.uniforms.u_matrix,!1,o.posMatrix),this.tileExtentVAO.bind(this.context,l,this.tileExtentBuffer,[]),r.drawArrays(r.TRIANGLE_STRIP,0,this.tileExtentBuffer.length)}},Pr.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new Gt({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},Pr.prototype.colorModeForRenderPass=function(){var e=this.context.gl;if(this._showOverdrawInspector){return new Wt([e.CONSTANT_COLOR,e.ONE],new t.default$6(1/8,1/8,1/8,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Wt.unblended:Wt.alphaBlended},Pr.prototype.depthModeForSublayer=function(t,e,r){var n=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon,a=n-1+this.depthRange;return new Ht(r||this.context.gl.LEQUAL,e,[a,n])},Pr.prototype.render=function(e,r){var n=this;for(var a in this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(i.now()),e.sourceCaches){var o=n.style.sourceCaches[a];o.used&&o.prepare(n.context)}var s=this.style._order,l=t.filterObject(this.style.sourceCaches,function(t){return"raster"===t.getSource().type||"raster-dem"===t.getSource().type}),u=function(e){var r=l[e];!function(e,r){for(var n=e.sort(function(t,e){return t.tileID.isLessThan(e.tileID)?-1:e.tileID.isLessThan(t.tileID)?1:0}),a=0;a<n.length;a++){var i={},o=n[a],s=n.slice(a+1);sr(o.tileID.wrapped(),o.tileID,s,new t.OverscaledTileID(0,o.tileID.wrap+1,0,0,0),i),o.setMask(i,r)}}(r.getVisibleCoordinates().map(function(t){return r.getTile(t)}),n.context)};for(var c in l)u(c);this.renderPass="offscreen";var f,h=[];this.depthRboNeedsClear=!0;for(var p=0;p<s.length;p++){var d=n.style._layers[s[p]];d.hasOffscreenPass()&&!d.isHidden(n.transform.zoom)&&(d.source!==(f&&f.id)&&(h=[],(f=n.style.sourceCaches[d.source])&&(h=f.getVisibleCoordinates()).reverse()),h.length&&n.renderLayer(n,f,d,h))}this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?t.default$6.black:t.default$6.transparent,depth:1}),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRange=(e._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque";var v,g=[];for(this.currentLayer=s.length-1,this.currentLayer;this.currentLayer>=0;this.currentLayer--){var m=n.style._layers[s[n.currentLayer]];m.source!==(v&&v.id)&&(g=[],(v=n.style.sourceCaches[m.source])&&(n.clearStencil(),g=v.getVisibleCoordinates(),v.getSource().isTileClipped&&n._renderTileClippingMasks(g))),n.renderLayer(n,v,m,g)}this.renderPass="translucent";var y,x=[];for(this.currentLayer=0,this.currentLayer;this.currentLayer<s.length;this.currentLayer++){var b=n.style._layers[s[n.currentLayer]];b.source!==(y&&y.id)&&(x=[],(y=n.style.sourceCaches[b.source])&&(n.clearStencil(),x=y.getVisibleCoordinates(),y.getSource().isTileClipped&&n._renderTileClippingMasks(x)),x.reverse()),n.renderLayer(n,y,b,x)}if(this.options.showTileBoundaries){var _=this.style.sourceCaches[Object.keys(this.style.sourceCaches)[0]];_&&zr.debug(this,_,_.getVisibleCoordinates())}},Pr.prototype.setupOffscreenDepthRenderbuffer=function(){var t=this.context;this.depthRbo||(this.depthRbo=t.createRenderbuffer(t.gl.DEPTH_COMPONENT16,this.width,this.height))},Pr.prototype.renderLayer=function(t,e,r,n){r.isHidden(this.transform.zoom)||("background"===r.type||n.length)&&(this.id=r.id,zr[r.type](t,e,r,n))},Pr.prototype.translatePosMatrix=function(e,r,n,a,i){if(!n[0]&&!n[1])return e;var o=i?"map"===a?this.transform.angle:0:"viewport"===a?-this.transform.angle:0;if(o){var s=Math.sin(o),l=Math.cos(o);n=[n[0]*l-n[1]*s,n[0]*s+n[1]*l]}var u=[i?n[0]:Ee(r,n[0],this.transform.zoom),i?n[1]:Ee(r,n[1],this.transform.zoom),0],c=new Float32Array(16);return t.mat4.translate(c,e,u),c},Pr.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},Pr.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},Pr.prototype._createProgramCached=function(t,e){this.cache=this.cache||{};var r=""+t+(e.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[r]||(this.cache[r]=new or(this.context,ir[t],e,this._showOverdrawInspector)),this.cache[r]},Pr.prototype.useProgram=function(t,e){var r=this._createProgramCached(t,e||this.emptyProgramConfiguration);return this.context.program.set(r.program),r};var Br=t.default$20.vec4,Fr=t.default$20.mat4,Nr=t.default$20.mat2,jr=function(t,e,r){this.tileSize=512,this._renderWorldCopies=void 0===r||r,this._minZoom=t||0,this._maxZoom=e||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this._center=new W(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},Vr={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},x:{configurable:!0},y:{configurable:!0},point:{configurable:!0}};jr.prototype.clone=function(){var t=new jr(this._minZoom,this._maxZoom,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._calcMatrices(),t},Vr.minZoom.get=function(){return this._minZoom},Vr.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Vr.maxZoom.get=function(){return this._maxZoom},Vr.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Vr.renderWorldCopies.get=function(){return this._renderWorldCopies},Vr.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Vr.worldSize.get=function(){return this.tileSize*this.scale},Vr.centerPoint.get=function(){return this.size._div(2)},Vr.size.get=function(){return new t.default$1(this.width,this.height)},Vr.bearing.get=function(){return-this.angle/Math.PI*180},Vr.bearing.set=function(e){var r=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=Nr.create(),Nr.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Vr.pitch.get=function(){return this._pitch/Math.PI*180},Vr.pitch.set=function(e){var r=t.clamp(e,0,60)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())},Vr.fov.get=function(){return this._fov/Math.PI*180},Vr.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Vr.zoom.get=function(){return this._zoom},Vr.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Vr.center.get=function(){return this._center},Vr.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},jr.prototype.coveringZoomLevel=function(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))},jr.prototype.getVisibleUnwrappedCoordinates=function(e){var r=this.pointCoordinate(new t.default$1(0,0),0),n=this.pointCoordinate(new t.default$1(this.width,0),0),a=Math.floor(r.column),i=Math.floor(n.column),o=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var s=a;s<=i;s++)0!==s&&o.push(new t.UnwrappedTileID(s,e));return o},jr.prototype.coveringTiles=function(e){var r=this.coveringZoomLevel(e),n=r;if(void 0!==e.minzoom&&r<e.minzoom)return[];void 0!==e.maxzoom&&r>e.maxzoom&&(r=e.maxzoom);var a=this.pointCoordinate(this.centerPoint,r),i=new t.default$1(a.column-.5,a.row-.5);return function(e,r,n,a){void 0===a&&(a=!0);var i=1<<e,o={};function s(r,s,l){var u,c,f,h;if(l>=0&&l<=i)for(u=r;u<s;u++)c=Math.floor(u/i),f=(u%i+i)%i,0!==c&&!0!==a||(h=new t.OverscaledTileID(n,c,e,f,l),o[h.key]=h)}return Rr(r[0],r[1],r[2],0,i,s),Rr(r[2],r[3],r[0],0,i,s),Object.keys(o).map(function(t){return o[t]})}(r,[this.pointCoordinate(new t.default$1(0,0),r),this.pointCoordinate(new t.default$1(this.width,0),r),this.pointCoordinate(new t.default$1(this.width,this.height),r),this.pointCoordinate(new t.default$1(0,this.height),r)],e.reparseOverscaled?n:r,this._renderWorldCopies).sort(function(t,e){return i.dist(t.canonical)-i.dist(e.canonical)})},jr.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Vr.unmodified.get=function(){return this._unmodified},jr.prototype.zoomScale=function(t){return Math.pow(2,t)},jr.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},jr.prototype.project=function(e){return new t.default$1(this.lngX(e.lng),this.latY(e.lat))},jr.prototype.unproject=function(t){return new W(this.xLng(t.x),this.yLat(t.y))},Vr.x.get=function(){return this.lngX(this.center.lng)},Vr.y.get=function(){return this.latY(this.center.lat)},Vr.point.get=function(){return new t.default$1(this.x,this.y)},jr.prototype.lngX=function(t){return(180+t)*this.worldSize/360},jr.prototype.latY=function(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))*this.worldSize/360},jr.prototype.xLng=function(t){return 360*t/this.worldSize-180},jr.prototype.yLat=function(t){var e=180-360*t/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90},jr.prototype.setLocationAtPoint=function(t,e){var r=this.pointCoordinate(e)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(t)._sub(r)),this._renderWorldCopies&&(this.center=this.center.wrap())},jr.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},jr.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},jr.prototype.locationCoordinate=function(e){return new t.default$17(this.lngX(e.lng)/this.tileSize,this.latY(e.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},jr.prototype.coordinateLocation=function(t){var e=t.zoomTo(this.zoom);return new W(this.xLng(e.column*this.tileSize),this.yLat(e.row*this.tileSize))},jr.prototype.pointCoordinate=function(e,r){void 0===r&&(r=this.tileZoom);var n=[e.x,e.y,0,1],a=[e.x,e.y,1,1];Br.transformMat4(n,n,this.pixelMatrixInverse),Br.transformMat4(a,a,this.pixelMatrixInverse);var i=n[3],o=a[3],s=n[0]/i,l=a[0]/o,u=n[1]/i,c=a[1]/o,f=n[2]/i,h=a[2]/o,p=f===h?0:(0-f)/(h-f);return new t.default$17(t.number(s,l,p)/this.tileSize,t.number(u,c,p)/this.tileSize,this.zoom)._zoomTo(r)},jr.prototype.coordinatePoint=function(e){var r=e.zoomTo(this.zoom),n=[r.column*this.tileSize,r.row*this.tileSize,0,1];return Br.transformMat4(n,n,this.pixelMatrix),new t.default$1(n[0]/n[3],n[1]/n[3])},jr.prototype.calculatePosMatrix=function(e,r){void 0===r&&(r=!1);var n=e.key,a=r?this._alignedPosMatrixCache:this._posMatrixCache;if(a[n])return a[n];var i=e.canonical,o=this.worldSize/this.zoomScale(i.z),s=i.x+Math.pow(2,i.z)*e.wrap,l=Fr.identity(new Float64Array(16));return Fr.translate(l,l,[s*o,i.y*o,0]),Fr.scale(l,l,[o/t.default$8,o/t.default$8,1]),Fr.multiply(l,r?this.alignedProjMatrix:this.projMatrix,l),a[n]=new Float32Array(l),a[n]},jr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,r,n,a,i=-90,o=90,s=-180,l=180,u=this.size,c=this._unmodified;if(this.latRange){var f=this.latRange;i=this.latY(f[1]),e=(o=this.latY(f[0]))-i<u.y?u.y/(o-i):0}if(this.lngRange){var h=this.lngRange;s=this.lngX(h[0]),r=(l=this.lngX(h[1]))-s<u.x?u.x/(l-s):0}var p=Math.max(r||0,e||0);if(p)return this.center=this.unproject(new t.default$1(r?(l+s)/2:this.x,e?(o+i)/2:this.y)),this.zoom+=this.scaleZoom(p),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var d=this.y,v=u.y/2;d-v<i&&(a=i+v),d+v>o&&(a=o-v)}if(this.lngRange){var g=this.x,m=u.x/2;g-m<s&&(n=s+m),g+m>l&&(n=l-m)}void 0===n&&void 0===a||(this.center=this.unproject(new t.default$1(void 0!==n?n:this.x,void 0!==a?a:this.y))),this._unmodified=c,this._constraining=!1}},jr.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var t=this._fov/2,e=Math.PI/2+this._pitch,r=Math.sin(t)*this.cameraToCenterDistance/Math.sin(Math.PI-e-t),n=this.x,a=this.y,i=1.01*(Math.cos(Math.PI/2-this._pitch)*r+this.cameraToCenterDistance),o=new Float64Array(16);Fr.perspective(o,this._fov,this.width/this.height,1,i),Fr.scale(o,o,[1,-1,1]),Fr.translate(o,o,[0,0,-this.cameraToCenterDistance]),Fr.rotateX(o,o,this._pitch),Fr.rotateZ(o,o,this.angle),Fr.translate(o,o,[-n,-a,0]);var s=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));Fr.scale(o,o,[1,1,s,1]),this.projMatrix=o;var l=this.width%2/2,u=this.height%2/2,c=Math.cos(this.angle),f=Math.sin(this.angle),h=n-Math.round(n)+c*l+f*u,p=a-Math.round(a)+c*u+f*l,d=new Float64Array(o);if(Fr.translate(d,d,[h>.5?h-1:h,p>.5?p-1:p,0]),this.alignedProjMatrix=d,o=Fr.create(),Fr.scale(o,o,[this.width/2,-this.height/2,1]),Fr.translate(o,o,[1,-1,0]),this.pixelMatrix=Fr.multiply(new Float64Array(16),o,this.projMatrix),!(o=Fr.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=o,this._posMatrixCache={},this._alignedPosMatrixCache={}}},jr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.default$1(0,0)).zoomTo(this.zoom),r=[e.column*this.tileSize,e.row*this.tileSize,0,1];return Br.transformMat4(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance},Object.defineProperties(jr.prototype,Vr);var Ur=function(){var e,r,n,a,i;t.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(e=this._updateHashUnthrottled.bind(this),r=300,n=!1,a=0,i=function(){a=0,n&&(e(),a=setTimeout(i,r),n=!1)},function(){return n=!0,a||i(),a})};Ur.prototype.addTo=function(e){return this._map=e,t.default.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ur.prototype.remove=function(){return t.default.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ur.prototype.getHashString=function(t){var e=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,n),i=Math.round(e.lng*a)/a,o=Math.round(e.lat*a)/a,s=this._map.getBearing(),l=this._map.getPitch(),u="";return u+=t?"#/"+i+"/"+o+"/"+r:"#"+r+"/"+o+"/"+i,(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+="/"+Math.round(l)),u},Ur.prototype._onHashChange=function(){var e=t.default.location.hash.replace("#","").split("/");return e.length>=3&&(this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:+(e[3]||0),pitch:+(e[4]||0)}),!0)},Ur.prototype._updateHashUnthrottled=function(){var e=this.getHashString();t.default.history.replaceState(t.default.history.state,"",e)};var qr=function(e){function r(r,n,a,i){void 0===i&&(i={});var o=s.mousePos(n.getCanvasContainer(),a),l=n.unproject(o);e.call(this,r,t.extend({point:o,lngLat:l,originalEvent:a},i)),this._defaultPrevented=!1,this.target=n}e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r;var n={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,n),r}(t.Event),Hr=function(e){function r(r,n,a){var i=s.touchPos(n.getCanvasContainer(),a),o=i.map(function(t){return n.unproject(t)}),l=i.reduce(function(t,e,r,n){return t.add(e.div(n.length))},new t.default$1(0,0)),u=n.unproject(l);e.call(this,r,{points:i,point:l,lngLats:o,lngLat:u,originalEvent:a}),this._defaultPrevented=!1}e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r;var n={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,n),r}(t.Event),Gr=function(t){function e(e,r,n){t.call(this,e,{originalEvent:n}),this._defaultPrevented=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,r),e}(t.Event),Wr=function(e){this._map=e,this._el=e.getCanvasContainer(),this._delta=0,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Wr.prototype.isEnabled=function(){return!!this._enabled},Wr.prototype.isActive=function(){return!!this._active},Wr.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},Wr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Wr.prototype.onWheel=function(e){if(this.isEnabled()){var r=e.deltaMode===t.default.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,n=i.now(),a=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==r&&r%4.000244140625==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":a>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(a*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this.isActive()||this._start(e)),e.preventDefault()}},Wr.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(t)},Wr.prototype._start=function(e){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this._map.fire(new t.Event("movestart",{originalEvent:e})),this._map.fire(new t.Event("zoomstart",{originalEvent:e})),this._finishTimeout&&clearTimeout(this._finishTimeout);var r=s.mousePos(this._el,e);this._around=W.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(r)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},Wr.prototype._onScrollFrame=function(){var e=this;if(this._frameId=null,this.isActive()){var r=this._map.transform;if(0!==this._delta){var n="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?1/450:.01,a=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&0!==a&&(a=1/a);var o="number"==typeof this._targetZoom?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(o*a))),"wheel"===this._type&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var s=!1;if("wheel"===this._type){var l=Math.min((i.now()-this._lastWheelEventTime)/200,1),u=this._easing(l);r.zoom=t.number(this._startZoom,this._targetZoom,u),l<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):s=!0}else r.zoom=this._targetZoom,s=!0;r.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new t.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new t.Event("zoom",{originalEvent:this._lastWheelEvent})),s&&(this._active=!1,this._finishTimeout=setTimeout(function(){e._map.fire(new t.Event("zoomend",{originalEvent:e._lastWheelEvent})),e._map.fire(new t.Event("moveend",{originalEvent:e._lastWheelEvent})),delete e._targetZoom},200))}},Wr.prototype._smoothOutEasing=function(e){var r=t.ease;if(this._prevEase){var n=this._prevEase,a=(i.now()-n.start)/n.duration,o=n.easing(a+.01)-n.easing(a),s=.27/Math.sqrt(o*o+1e-4)*.01,l=Math.sqrt(.0729-s*s);r=t.bezier(s,l,.25,1)}return this._prevEase={start:i.now(),duration:e,easing:r},r};var Yr=function(e){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),t.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};Yr.prototype.isEnabled=function(){return!!this._enabled},Yr.prototype.isActive=function(){return!!this._active},Yr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Yr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Yr.prototype.onMouseDown=function(e){this.isEnabled()&&e.shiftKey&&0===e.button&&(t.default.document.addEventListener("mousemove",this._onMouseMove,!1),t.default.document.addEventListener("keydown",this._onKeyDown,!1),t.default.document.addEventListener("mouseup",this._onMouseUp,!1),s.disableDrag(),this._startPos=s.mousePos(this._el,e),this._active=!0)},Yr.prototype._onMouseMove=function(t){var e=this._startPos,r=s.mousePos(this._el,t);this._box||(this._box=s.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var n=Math.min(e.x,r.x),a=Math.max(e.x,r.x),i=Math.min(e.y,r.y),o=Math.max(e.y,r.y);s.setTransform(this._box,"translate("+n+"px,"+i+"px)"),this._box.style.width=a-n+"px",this._box.style.height=o-i+"px"},Yr.prototype._onMouseUp=function(e){if(0===e.button){var r=this._startPos,n=s.mousePos(this._el,e),a=(new Y).extend(this._map.unproject(r)).extend(this._map.unproject(n));this._finish(),s.suppressClick(),r.x===n.x&&r.y===n.y?this._fireEvent("boxzoomcancel",e):this._map.fitBounds(a,{linear:!0}).fire(new t.Event("boxzoomend",{originalEvent:e,boxZoomBounds:a}))}},Yr.prototype._onKeyDown=function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},Yr.prototype._finish=function(){this._active=!1,t.default.document.removeEventListener("mousemove",this._onMouseMove,!1),t.default.document.removeEventListener("keydown",this._onKeyDown,!1),t.default.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(s.remove(this._box),this._box=null),s.enableDrag()},Yr.prototype._fireEvent=function(e,r){return this._map.fire(new t.Event(e,{originalEvent:r}))};var Xr=t.bezier(0,0,.25,1),Zr=function(e,r){this._map=e,this._el=r.element||e.getCanvasContainer(),this._state="disabled",this._button=r.button||"right",this._bearingSnap=r.bearingSnap||0,this._pitchWithRotate=!1!==r.pitchWithRotate,t.bindAll(["_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};Zr.prototype.isEnabled=function(){return"disabled"!==this._state},Zr.prototype.isActive=function(){return"active"===this._state},Zr.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},Zr.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Zr.prototype.onMouseDown=function(e){if("enabled"===this._state){if("right"===this._button){if(this._eventButton=s.mouseButton(e),this._eventButton!==(e.ctrlKey?0:2))return}else{if(e.ctrlKey||0!==s.mouseButton(e))return;this._eventButton=0}s.disableDrag(),t.default.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),t.default.document.addEventListener("mouseup",this._onMouseUp),t.default.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[i.now(),this._map.getBearing()]],this._previousPos=s.mousePos(this._el,e),this._center=this._map.transform.centerPoint,e.preventDefault()}},Zr.prototype._onMouseMove=function(t){this._lastMoveEvent=t,this._pos=s.mousePos(this._el,t),"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame))},Zr.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var e=this._map.transform,r=this._previousPos,n=this._pos,a=.8*(r.x-n.x),o=-.5*(r.y-n.y),s=e.bearing-a,l=e.pitch-o,u=this._inertia,c=u[u.length-1];this._drainInertiaBuffer(),u.push([i.now(),this._map._normalizeBearing(s,c[1])]),e.bearing=s,this._pitchWithRotate&&(this._fireEvent("pitch",t),e.pitch=l),this._fireEvent("rotate",t),this._fireEvent("move",t),delete this._lastMoveEvent,this._previousPos=this._pos}},Zr.prototype._onMouseUp=function(t){if(s.mouseButton(t)===this._eventButton)switch(this._state){case"active":this._state="enabled",s.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(t);break;case"pending":this._state="enabled",this._unbind()}},Zr.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",t),this._pitchWithRotate&&this._fireEvent("pitchend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},Zr.prototype._unbind=function(){t.default.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),t.default.document.removeEventListener("mouseup",this._onMouseUp),t.default.removeEventListener("blur",this._onBlur),s.enableDrag()},Zr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._previousPos},Zr.prototype._inertialRotate=function(t){var e=this;this._fireEvent("rotateend",t),this._drainInertiaBuffer();var r=this._map,n=r.getBearing(),a=this._inertia,i=function(){Math.abs(n)<e._bearingSnap?r.resetNorth({noMoveStart:!0},{originalEvent:t}):e._fireEvent("moveend",t),e._pitchWithRotate&&e._fireEvent("pitchend",t)};if(a.length<2)i();else{var o=a[0],s=a[a.length-1],l=a[a.length-2],u=r._normalizeBearing(n,l[1]),c=s[1]-o[1],f=c<0?-1:1,h=(s[0]-o[0])/1e3;if(0!==c&&0!==h){var p=Math.abs(c*(.25/h));p>180&&(p=180);var d=p/180;u+=f*p*(d/2),Math.abs(r._normalizeBearing(u,0))<this._bearingSnap&&(u=r._normalizeBearing(0,u)),r.rotateTo(u,{duration:1e3*d,easing:Xr,noMoveStart:!0},{originalEvent:t})}else i()}},Zr.prototype._fireEvent=function(e,r){return this._map.fire(new t.Event(e,r?{originalEvent:r}:{}))},Zr.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=i.now();t.length>0&&e-t[0][0]>160;)t.shift()};var $r=t.bezier(0,0,.3,1),Jr=function(e){this._map=e,this._el=e.getCanvasContainer(),this._state="disabled",t.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};Jr.prototype.isEnabled=function(){return"disabled"!==this._state},Jr.prototype.isActive=function(){return"active"===this._state},Jr.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},Jr.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Jr.prototype.onMouseDown=function(e){"enabled"===this._state&&(e.ctrlKey||0!==s.mouseButton(e)||(s.addEventListener(t.default.document,"mousemove",this._onMove,{capture:!0}),s.addEventListener(t.default.document,"mouseup",this._onMouseUp),this._start(e)))},Jr.prototype.onTouchStart=function(e){"enabled"===this._state&&(e.touches.length>1||(s.addEventListener(t.default.document,"touchmove",this._onMove,{capture:!0,passive:!1}),s.addEventListener(t.default.document,"touchend",this._onTouchEnd),this._start(e)))},Jr.prototype._start=function(e){t.default.addEventListener("blur",this._onBlur),this._state="pending",this._previousPos=s.mousePos(this._el,e),this._inertia=[[i.now(),this._previousPos]]},Jr.prototype._onMove=function(t){this._lastMoveEvent=t,t.preventDefault(),this._pos=s.mousePos(this._el,t),this._drainInertiaBuffer(),this._inertia.push([i.now(),this._pos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",t),this._fireEvent("movestart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame))},Jr.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var e=this._map.transform;e.setLocationAtPoint(e.pointLocation(this._previousPos),this._pos),this._fireEvent("drag",t),this._fireEvent("move",t),this._previousPos=this._pos,delete this._lastMoveEvent}},Jr.prototype._onMouseUp=function(t){if(0===s.mouseButton(t))switch(this._state){case"active":this._state="enabled",s.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},Jr.prototype._onTouchEnd=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},Jr.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},Jr.prototype._unbind=function(){s.removeEventListener(t.default.document,"touchmove",this._onMove,{capture:!0,passive:!1}),s.removeEventListener(t.default.document,"touchend",this._onTouchEnd),s.removeEventListener(t.default.document,"mousemove",this._onMove,{capture:!0}),s.removeEventListener(t.default.document,"mouseup",this._onMouseUp),s.removeEventListener(t.default,"blur",this._onBlur)},Jr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._previousPos,delete this._pos},Jr.prototype._inertialPan=function(t){this._fireEvent("dragend",t),this._drainInertiaBuffer();var e=this._inertia;if(e.length<2)this._fireEvent("moveend",t);else{var r=e[e.length-1],n=e[0],a=r[1].sub(n[1]),i=(r[0]-n[0])/1e3;if(0===i||r[1].equals(n[1]))this._fireEvent("moveend",t);else{var o=a.mult(.3/i),s=o.mag();s>1400&&(s=1400,o._unit()._mult(s));var l=s/750,u=o.mult(-l/2);this._map.panBy(u,{duration:1e3*l,easing:$r,noMoveStart:!0},{originalEvent:t})}}},Jr.prototype._fireEvent=function(e,r){return this._map.fire(new t.Event(e,r?{originalEvent:r}:{}))},Jr.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=i.now();t.length>0&&e-t[0][0]>160;)t.shift()};var Kr=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onKeyDown"],this)};function Qr(t){return t*(2-t)}Kr.prototype.isEnabled=function(){return!!this._enabled},Kr.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},Kr.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},Kr.prototype._onKeyDown=function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=0,r=0,n=0,a=0,i=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?r=-1:(t.preventDefault(),a=-1);break;case 39:t.shiftKey?r=1:(t.preventDefault(),a=1);break;case 38:t.shiftKey?n=1:(t.preventDefault(),i=-1);break;case 40:t.shiftKey?n=-1:(i=1,t.preventDefault());break;default:return}var o=this._map,s=o.getZoom(),l={duration:300,delayEndEvents:500,easing:Qr,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:o.getBearing()+15*r,pitch:o.getPitch()+10*n,offset:[100*-a,100*-i],center:o.getCenter()};o.easeTo(l,{originalEvent:t})}};var tn=function(e){this._map=e,t.bindAll(["_onDblClick","_onZoomEnd"],this)};tn.prototype.isEnabled=function(){return!!this._enabled},tn.prototype.isActive=function(){return!!this._active},tn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},tn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},tn.prototype.onTouchStart=function(t){var e=this;this.isEnabled()&&(t.points.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._zoom(t)):this._tapped=setTimeout(function(){e._tapped=null},300)))},tn.prototype.onDblClick=function(t){this.isEnabled()&&(t.originalEvent.preventDefault(),this._zoom(t))},tn.prototype._zoom=function(t){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)},tn.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var en=t.bezier(0,0,.15,1),rn=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};rn.prototype.isEnabled=function(){return!!this._enabled},rn.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)},rn.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},rn.prototype.disableRotation=function(){this._rotationDisabled=!0},rn.prototype.enableRotation=function(){this._rotationDisabled=!1},rn.prototype.onStart=function(e){if(this.isEnabled()&&2===e.touches.length){var r=s.mousePos(this._el,e.touches[0]),n=s.mousePos(this._el,e.touches[1]);this._startVec=r.sub(n),this._gestureIntent=void 0,this._inertia=[],s.addEventListener(t.default.document,"touchmove",this._onMove,{passive:!1}),s.addEventListener(t.default.document,"touchend",this._onEnd)}},rn.prototype._getTouchEventData=function(t){var e=s.mousePos(this._el,t.touches[0]),r=s.mousePos(this._el,t.touches[1]),n=e.sub(r);return{vec:n,center:e.add(r).div(2),scale:n.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*n.angleWith(this._startVec)/Math.PI}},rn.prototype._onMove=function(e){if(2===e.touches.length){var r=this._getTouchEventData(e),n=r.vec,a=r.scale,i=r.bearing;if(!this._gestureIntent){var o=Math.abs(1-a)>.15;Math.abs(i)>10?this._gestureIntent="rotate":o&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new t.Event(this._gestureIntent+"start",{originalEvent:e})),this._map.fire(new t.Event("movestart",{originalEvent:e})),this._startVec=n)}this._lastTouchEvent=e,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),e.preventDefault()}},rn.prototype._onTouchFrame=function(){this._frameId=null;var e=this._gestureIntent;if(e){var r=this._map.transform;this._startScale||(this._startScale=r.scale,this._startBearing=r.bearing);var n=this._getTouchEventData(this._lastTouchEvent),a=n.center,o=n.bearing,s=n.scale,l=r.pointLocation(a),u=r.locationPoint(l);"rotate"===e&&(r.bearing=this._startBearing+o),r.zoom=r.scaleZoom(this._startScale*s),r.setLocationAtPoint(l,u),this._map.fire(new t.Event(e,{originalEvent:this._lastTouchEvent})),this._map.fire(new t.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([i.now(),s,a])}},rn.prototype._onEnd=function(e){s.removeEventListener(t.default.document,"touchmove",this._onMove,{passive:!1}),s.removeEventListener(t.default.document,"touchend",this._onEnd);var r=this._gestureIntent,n=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,r){this._map.fire(new t.Event(r+"end",{originalEvent:e})),this._drainInertiaBuffer();var a=this._inertia,i=this._map;if(a.length<2)i.snapToNorth({},{originalEvent:e});else{var o=a[a.length-1],l=a[0],u=i.transform.scaleZoom(n*o[1]),c=i.transform.scaleZoom(n*l[1]),f=u-c,h=(o[0]-l[0])/1e3,p=o[2];if(0!==h&&u!==c){var d=.15*f/h;Math.abs(d)>2.5&&(d=d>0?2.5:-2.5);var v=1e3*Math.abs(d/(12*.15)),g=u+d*v/2e3;g<0&&(g=0),i.easeTo({zoom:g,duration:v,easing:en,around:this._aroundCenter?i.getCenter():i.unproject(p),noMoveStart:!0},{originalEvent:e})}else i.snapToNorth({},{originalEvent:e})}}},rn.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=i.now();t.length>2&&e-t[0][0]>160;)t.shift()};var nn={scrollZoom:Wr,boxZoom:Yr,dragRotate:Zr,dragPan:Jr,keyboard:Kr,doubleClickZoom:tn,touchZoomRotate:rn};var an=function(e){function r(r,n){e.call(this),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=n.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.getCenter=function(){return this.transform.center},r.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},r.prototype.panBy=function(e,r,n){return e=t.default$1.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},r),n)},r.prototype.panTo=function(e,r,n){return this.easeTo(t.extend({center:e},r),n)},r.prototype.getZoom=function(){return this.transform.zoom},r.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},r.prototype.zoomTo=function(e,r,n){return this.easeTo(t.extend({zoom:e},r),n)},r.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},r.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},r.prototype.getBearing=function(){return this.transform.bearing},r.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},r.prototype.rotateTo=function(e,r,n){return this.easeTo(t.extend({bearing:e},r),n)},r.prototype.resetNorth=function(e,r){return this.rotateTo(0,t.extend({duration:1e3},e),r),this},r.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},r.prototype.getPitch=function(){return this.transform.pitch},r.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},r.prototype.fitBounds=function(e,r,n){if("number"==typeof(r=t.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){var a=r.padding;r.padding={top:a,bottom:a,right:a,left:a}}if(!t.default$10(Object.keys(r.padding).sort(function(t,e){return t<e?-1:t>e?1:0}),["bottom","left","right","top"]))return t.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'"),this;e=Y.convert(e);var i=[(r.padding.left-r.padding.right)/2,(r.padding.top-r.padding.bottom)/2],o=Math.min(r.padding.right,r.padding.left),s=Math.min(r.padding.top,r.padding.bottom);r.offset=[r.offset[0]+i[0],r.offset[1]+i[1]];var l=t.default$1.convert(r.offset),u=this.transform,c=u.project(e.getNorthWest()),f=u.project(e.getSouthEast()),h=f.sub(c),p=(u.width-2*o-2*Math.abs(l.x))/h.x,d=(u.height-2*s-2*Math.abs(l.y))/h.y;return d<0||p<0?(t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset."),this):(r.center=u.unproject(c.add(f).div(2)),r.zoom=Math.min(u.scaleZoom(u.scale*Math.min(p,d)),r.maxZoom),r.bearing=0,r.linear?this.easeTo(r,n):this.flyTo(r,n))},r.prototype.jumpTo=function(e,r){this.stop();var n=this.transform,a=!1,i=!1,o=!1;return"zoom"in e&&n.zoom!==+e.zoom&&(a=!0,n.zoom=+e.zoom),void 0!==e.center&&(n.center=W.convert(e.center)),"bearing"in e&&n.bearing!==+e.bearing&&(i=!0,n.bearing=+e.bearing),"pitch"in e&&n.pitch!==+e.pitch&&(o=!0,n.pitch=+e.pitch),this.fire(new t.Event("movestart",r)).fire(new t.Event("move",r)),a&&this.fire(new t.Event("zoomstart",r)).fire(new t.Event("zoom",r)).fire(new t.Event("zoomend",r)),i&&this.fire(new t.Event("rotatestart",r)).fire(new t.Event("rotate",r)).fire(new t.Event("rotateend",r)),o&&this.fire(new t.Event("pitchstart",r)).fire(new t.Event("pitch",r)).fire(new t.Event("pitchend",r)),this.fire(new t.Event("moveend",r))},r.prototype.easeTo=function(e,r){var n=this;this.stop(),!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate&&(e.duration=0);var a=this.transform,i=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l="zoom"in e?+e.zoom:i,u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:s,f=a.centerPoint.add(t.default$1.convert(e.offset)),h=a.pointLocation(f),p=W.convert(e.center||h);this._normalizeCenter(p);var d,v,g=a.project(h),m=a.project(p).sub(g),y=a.zoomScale(l-i);return e.around&&(d=W.convert(e.around),v=a.locationPoint(d)),this._zooming=l!==i,this._rotating=o!==u,this._pitching=c!==s,this._prepareEase(r,e.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(e){if(n._zooming&&(a.zoom=t.number(i,l,e)),n._rotating&&(a.bearing=t.number(o,u,e)),n._pitching&&(a.pitch=t.number(s,c,e)),d)a.setLocationAtPoint(d,v);else{var h=a.zoomScale(a.zoom-i),p=l>i?Math.min(2,y):Math.max(.5,y),x=Math.pow(p,1-e),b=a.unproject(g.add(m.mult(e*x)).mult(h));a.setLocationAtPoint(a.renderWorldCopies?b.wrap():b,f)}n._fireMoveEvents(r)},function(){e.delayEndEvents?n._easeEndTimeoutID=setTimeout(function(){return n._afterEase(r)},e.delayEndEvents):n._afterEase(r)},e),this},r.prototype._prepareEase=function(e,r){this._moving=!0,r||this.fire(new t.Event("movestart",e)),this._zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&this.fire(new t.Event("pitchstart",e))},r.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},r.prototype._afterEase=function(e){var r=this._zooming,n=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,r&&this.fire(new t.Event("zoomend",e)),n&&this.fire(new t.Event("rotateend",e)),a&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))},r.prototype.flyTo=function(e,r){var n=this;this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var a=this.transform,i=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l="zoom"in e?t.clamp(+e.zoom,a.minZoom,a.maxZoom):i,u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:s,f=a.zoomScale(l-i),h=a.centerPoint.add(t.default$1.convert(e.offset)),p=a.pointLocation(h),d=W.convert(e.center||p);this._normalizeCenter(d);var v=a.project(p),g=a.project(d).sub(v),m=e.curve,y=Math.max(a.width,a.height),x=y/f,b=g.mag();if("minZoom"in e){var _=t.clamp(Math.min(e.minZoom,i,l),a.minZoom,a.maxZoom),w=y/a.zoomScale(_-i);m=Math.sqrt(w/b*2)}var k=m*m;function M(t){var e=(x*x-y*y+(t?-1:1)*k*k*b*b)/(2*(t?x:y)*k*b);return Math.log(Math.sqrt(e*e+1)-e)}function A(t){return(Math.exp(t)-Math.exp(-t))/2}function T(t){return(Math.exp(t)+Math.exp(-t))/2}var S=M(0),E=function(t){return T(S)/T(S+m*t)},C=function(t){return y*((T(S)*(A(e=S+m*t)/T(e))-A(S))/k)/b;var e},L=(M(1)-S)/m;if(Math.abs(b)<1e-6||!isFinite(L)){if(Math.abs(y-x)<1e-6)return this.easeTo(e,r);var I=x<y?-1:1;L=Math.abs(Math.log(x/y))/m,C=function(){return 0},E=function(t){return Math.exp(I*m*t)}}if("duration"in e)e.duration=+e.duration;else{var z="screenSpeed"in e?+e.screenSpeed/m:+e.speed;e.duration=1e3*L/z}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==u,this._pitching=c!==s,this._prepareEase(r,!1),this._ease(function(e){var l=e*L,f=1/E(l);a.zoom=i+a.scaleZoom(f),n._rotating&&(a.bearing=t.number(o,u,e)),n._pitching&&(a.pitch=t.number(s,c,e));var p=a.unproject(v.add(g.mult(C(l))).mult(f));a.setLocationAtPoint(a.renderWorldCopies?p.wrap():p,h),n._fireMoveEvents(r)},function(){return n._afterEase(r)},e),this},r.prototype.isEasing=function(){return!!this._easeFrameId},r.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var t=this._onEaseEnd;delete this._onEaseEnd,t.call(this)}return this},r.prototype._ease=function(t,e,r){!1===r.animate||0===r.duration?(t(1),e()):(this._easeStart=i.now(),this._easeOptions=r,this._onEaseFrame=t,this._onEaseEnd=e,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},r.prototype._renderFrameCallback=function(){var t=Math.min((i.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},r.prototype._normalizeBearing=function(e,r){e=t.wrap(e,-180,180);var n=Math.abs(e-r);return Math.abs(e-360-r)<n&&(e-=360),Math.abs(e+360-r)<n&&(e+=360),e},r.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var r=t.lng-e.center.lng;t.lng+=r>180?-360:r<-180?360:0}},r}(t.Evented),on=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};on.prototype.getDefaultPosition=function(){return"bottom-right"},on.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},on.prototype.onRemove=function(){s.remove(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},on.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var e=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:g.ACCESS_TOKEN}];if(t){var r=e.reduce(function(t,r,n){return r.value&&(t+=r.key+"="+r.value+(n<e.length-1?"&":"")),t},"?");t.href="https://www.mapbox.com/feedback/"+r+(this._map._hash?this._map._hash.getHashString(!0):"")}},on.prototype._updateData=function(t){t&&"metadata"===t.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},on.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var r=this._map.style.sourceCaches;for(var n in r){var a=r[n].getSource();a.attribution&&t.indexOf(a.attribution)<0&&t.push(a.attribution)}t.sort(function(t,e){return t.length-e.length}),(t=t.filter(function(e,r){for(var n=r+1;n<t.length;n++)if(t[n].indexOf(e)>=0)return!1;return!0})).length?(this._container.innerHTML=t.join(" | "),this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null}},on.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var sn=function(){t.bindAll(["_updateLogo"],this)};sn.prototype.onAdd=function(t){this._map=t,this._container=s.create("div","mapboxgl-ctrl");var e=s.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.href="https://www.mapbox.com/",e.setAttribute("aria-label","Mapbox logo"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._container},sn.prototype.onRemove=function(){s.remove(this._container),this._map.off("sourcedata",this._updateLogo)},sn.prototype.getDefaultPosition=function(){return"bottom-left"},sn.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},sn.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t){if(t[e].getSource().mapbox_logo)return!0}return!1}};var ln=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};ln.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},ln.prototype.remove=function(t){for(var e=this._currentlyRunning,r=0,n=e?this._queue.concat(e):this._queue;r<n.length;r+=1){var a=n[r];if(a.id===t)return void(a.cancelled=!0)}},ln.prototype.run=function(){var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,r=t;e<r.length;e+=1){var n=r[e];if(!n.cancelled&&(n.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ln.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var un=t.default.HTMLImageElement,cn=t.default.HTMLElement,fn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null,fadeDuration:300},hn=function(r){function n(e){if(null!=(e=t.extend({},fn,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than minZoom");var n=new jr(e.minZoom,e.maxZoom,e.renderWorldCopies);r.call(this,n,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new ln;var a=e.transformRequest;if(this._transformRequest=a?function(t,e){return a(t,e)||{url:t}}:function(t){return{url:t}},"string"==typeof e.container){var i=t.default.document.getElementById(e.container);if(!i)throw new Error("Container '"+e.container+"' not found.");this._container=i}else{if(!(e.container instanceof cn))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored","_update","_render","_onData","_onDataLoading"],this),this._setupContainer(),this._setupPainter(),this.on("move",this._update.bind(this,!1)),this.on("zoom",this._update.bind(this,!0)),void 0!==t.default&&(t.default.addEventListener("online",this._onWindowOnline,!1),t.default.addEventListener("resize",this._onWindowResize,!1)),function(t,e){var r=t.getCanvasContainer(),n=null,a=!1;for(var i in nn)t[i]=new nn[i](t,e),e.interactive&&e[i]&&t[i].enable(e[i]);s.addEventListener(r,"mouseout",function(e){t.fire(new qr("mouseout",t,e))}),s.addEventListener(r,"mousedown",function(r){a=!0;var n=new qr("mousedown",t,r);t.fire(n),n.defaultPrevented||(e.interactive&&!t.doubleClickZoom.isActive()&&t.stop(),t.boxZoom.onMouseDown(r),t.boxZoom.isActive()||t.dragPan.isActive()||t.dragRotate.onMouseDown(r),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onMouseDown(r))}),s.addEventListener(r,"mouseup",function(e){var r=t.dragRotate.isActive();n&&!r&&t.fire(new qr("contextmenu",t,n)),n=null,a=!1,t.fire(new qr("mouseup",t,e))}),s.addEventListener(r,"mousemove",function(e){if(!t.dragPan.isActive()&&!t.dragRotate.isActive()){for(var n=e.toElement||e.target;n&&n!==r;)n=n.parentNode;n===r&&t.fire(new qr("mousemove",t,e))}}),s.addEventListener(r,"mouseover",function(e){for(var n=e.toElement||e.target;n&&n!==r;)n=n.parentNode;n===r&&t.fire(new qr("mouseover",t,e))}),s.addEventListener(r,"touchstart",function(r){var n=new Hr("touchstart",t,r);t.fire(n),n.defaultPrevented||(e.interactive&&t.stop(),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onTouchStart(r),t.touchZoomRotate.onStart(r),t.doubleClickZoom.onTouchStart(n))},{passive:!1}),s.addEventListener(r,"touchmove",function(e){t.fire(new Hr("touchmove",t,e))},{passive:!1}),s.addEventListener(r,"touchend",function(e){t.fire(new Hr("touchend",t,e))}),s.addEventListener(r,"touchcancel",function(e){t.fire(new Hr("touchcancel",t,e))}),s.addEventListener(r,"click",function(e){t.fire(new qr("click",t,e))}),s.addEventListener(r,"dblclick",function(e){var r=new qr("dblclick",t,e);t.fire(r),r.defaultPrevented||t.doubleClickZoom.onDblClick(r)}),s.addEventListener(r,"contextmenu",function(e){var r=t.dragRotate.isActive();a||r?a&&(n=e):t.fire(new qr("contextmenu",t,e)),e.preventDefault()}),s.addEventListener(r,"wheel",function(e){var r=new Gr("wheel",t,e);t.fire(r),r.defaultPrevented||t.scrollZoom.onWheel(e)},{passive:!1})}(this,e),this._hash=e.hash&&(new Ur).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),this.resize(),e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new on),this.addControl(new sn,e.logoPosition),this.on("style.load",function(){this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",this._onData),this.on("dataloading",this._onDataLoading)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var a={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}};return n.prototype.addControl=function(t,e){void 0===e&&t.getDefaultPosition&&(e=t.getDefaultPosition()),void 0===e&&(e="top-right");var r=t.onAdd(this),n=this._controlPositions[e];return-1!==e.indexOf("bottom")?n.insertBefore(r,n.firstChild):n.appendChild(r),this},n.prototype.removeControl=function(t){return t.onRemove(this),this},n.prototype.resize=function(e){var r=this._containerDimensions(),n=r[0],a=r[1];return this._resizeCanvas(n,a),this.transform.resize(n,a),this.painter.resize(n,a),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)).fire(new t.Event("resize",e)).fire(new t.Event("moveend",e))},n.prototype.getBounds=function(){var e=new Y(this.transform.pointLocation(new t.default$1(0,this.transform.height)),this.transform.pointLocation(new t.default$1(this.transform.width,0)));return(this.transform.angle||this.transform.pitch)&&(e.extend(this.transform.pointLocation(new t.default$1(this.transform.size.x,0))),e.extend(this.transform.pointLocation(new t.default$1(0,this.transform.size.y)))),e},n.prototype.getMaxBounds=function(){return this.transform.latRange&&2===this.transform.latRange.length&&this.transform.lngRange&&2===this.transform.lngRange.length?new Y([this.transform.lngRange[0],this.transform.latRange[0]],[this.transform.lngRange[1],this.transform.latRange[1]]):null},n.prototype.setMaxBounds=function(t){if(t){var e=Y.convert(t);this.transform.lngRange=[e.getWest(),e.getEast()],this.transform.latRange=[e.getSouth(),e.getNorth()],this.transform._constrain(),this._update()}else null==t&&(this.transform.lngRange=null,this.transform.latRange=null,this._update());return this},n.prototype.setMinZoom=function(t){if((t=null==t?0:t)>=0&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},n.prototype.getMinZoom=function(){return this.transform.minZoom},n.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},n.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},n.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update(),this},n.prototype.getMaxZoom=function(){return this.transform.maxZoom},n.prototype.project=function(t){return this.transform.locationPoint(W.convert(t))},n.prototype.unproject=function(e){return this.transform.pointLocation(t.default$1.convert(e))},n.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},n.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isActive()},n.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},n.prototype.on=function(t,e,n){var a,i=this;if(void 0===n)return r.prototype.on.call(this,t,e);var o=function(){if("mouseenter"===t||"mouseover"===t){var r=!1;return{layer:e,listener:n,delegates:{mousemove:function(a){var o=i.getLayer(e)?i.queryRenderedFeatures(a.point,{layers:[e]}):[];o.length?r||(r=!0,n.call(i,new qr(t,i,a.originalEvent,{features:o}))):r=!1},mouseout:function(){r=!1}}}}if("mouseleave"===t||"mouseout"===t){var o=!1;return{layer:e,listener:n,delegates:{mousemove:function(r){(i.getLayer(e)?i.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?o=!0:o&&(o=!1,n.call(i,new qr(t,i,r.originalEvent)))},mouseout:function(e){o&&(o=!1,n.call(i,new qr(t,i,e.originalEvent)))}}}}return{layer:e,listener:n,delegates:(a={},a[t]=function(t){var r=i.getLayer(e)?i.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,n.call(i,t),delete t.features)},a)}}();for(var s in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(o),o.delegates)i.on(s,o.delegates[s]);return this},n.prototype.off=function(t,e,n){if(void 0===n)return r.prototype.off.call(this,t,e);if(this._delegatedListeners&&this._delegatedListeners[t])for(var a=this._delegatedListeners[t],i=0;i<a.length;i++){var o=a[i];if(o.layer===e&&o.listener===n){for(var s in o.delegates)this.off(s,o.delegates[s]);return a.splice(i,1),this}}return this},n.prototype.queryRenderedFeatures=function(e,r){var n;return 2===arguments.length?(e=arguments[0],r=arguments[1]):1===arguments.length&&((n=arguments[0])instanceof t.default$1||Array.isArray(n))?(e=arguments[0],r={}):1===arguments.length?(e=void 0,r=arguments[0]):(e=void 0,r={}),this.style?this.style.queryRenderedFeatures(this._makeQueryGeometry(e),r,this.transform):[]},n.prototype._makeQueryGeometry=function(e){var r,n=this;if(void 0===e&&(e=[t.default$1.convert([0,0]),t.default$1.convert([this.transform.width,this.transform.height])]),e instanceof t.default$1||"number"==typeof e[0]){r=[t.default$1.convert(e)]}else{var a=[t.default$1.convert(e[0]),t.default$1.convert(e[1])];r=[a[0],new t.default$1(a[1].x,a[0].y),a[1],new t.default$1(a[0].x,a[1].y),a[0]]}return{viewport:r,worldCoordinate:r.map(function(t){return n.transform.pointCoordinate(t)})}},n.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},n.prototype.setStyle=function(e,r){if((!r||!1!==r.diff&&!r.localIdeographFontFamily)&&this.style&&e&&"object"==typeof e)try{return this.style.setState(e)&&this._update(!0),this}catch(e){t.warnOnce("Unable to perform style diff: "+(e.message||e.error||e)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new Qe(this,r||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e),this):(delete this.style,this)},n.prototype.getStyle=function(){if(this.style)return this.style.serialize()},n.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},n.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0),this},n.prototype.isSourceLoaded=function(e){var r=this.style&&this.style.sourceCaches[e];if(void 0!==r)return r.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},n.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var r=t[e]._tiles;for(var n in r){var a=r[n];if("loaded"!==a.state&&"errored"!==a.state)return!1}}return!0},n.prototype.addSourceType=function(t,e,r){return this.style.addSourceType(t,e,r)},n.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0),this},n.prototype.getSource=function(t){return this.style.getSource(t)},n.prototype.addImage=function(e,r,n){void 0===n&&(n={});var a=n.pixelRatio;void 0===a&&(a=1);var o=n.sdf;if(void 0===o&&(o=!1),r instanceof un){var s=i.getImageData(r),l=s.width,u=s.height,c=s.data;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},c),pixelRatio:a,sdf:o})}else{if(void 0===r.width||void 0===r.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var f=r.width,h=r.height,p=r.data;this.style.addImage(e,{data:new t.RGBAImage({width:f,height:h},p.slice(0)),pixelRatio:a,sdf:o})}},n.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},n.prototype.removeImage=function(t){this.style.removeImage(t)},n.prototype.loadImage=function(e,r){t.getImage(this._transformRequest(e,t.ResourceType.Image),r)},n.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0),this},n.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0),this},n.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0),this},n.prototype.getLayer=function(t){return this.style.getLayer(t)},n.prototype.setFilter=function(t,e){return this.style.setFilter(t,e),this._update(!0),this},n.prototype.setLayerZoomRange=function(t,e,r){return this.style.setLayerZoomRange(t,e,r),this._update(!0),this},n.prototype.getFilter=function(t){return this.style.getFilter(t)},n.prototype.setPaintProperty=function(t,e,r){return this.style.setPaintProperty(t,e,r),this._update(!0),this},n.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},n.prototype.setLayoutProperty=function(t,e,r){return this.style.setLayoutProperty(t,e,r),this._update(!0),this},n.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},n.prototype.setLight=function(t){return this.style.setLight(t),this._update(!0),this},n.prototype.getLight=function(){return this.style.getLight()},n.prototype.getContainer=function(){return this._container},n.prototype.getCanvasContainer=function(){return this._canvasContainer},n.prototype.getCanvas=function(){return this._canvas},n.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.offsetWidth||400,e=this._container.offsetHeight||300),[t,e]},n.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSContainer=s.create("div","mapboxgl-missing-css",t)).innerHTML="Missing Mapbox GL JS CSS";var e=this._canvasContainer=s.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=s.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var n=this._controlContainer=s.create("div","mapboxgl-control-container",t),a=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){a[t]=s.create("div","mapboxgl-ctrl-"+t,n)})},n.prototype._resizeCanvas=function(e,r){var n=t.default.devicePixelRatio||1;this._canvas.width=n*e,this._canvas.height=n*r,this._canvas.style.width=e+"px",this._canvas.style.height=r+"px"},n.prototype._setupPainter=function(){var r=t.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},e.webGLContextAttributes),n=this._canvas.getContext("webgl",r)||this._canvas.getContext("experimental-webgl",r);n?this.painter=new Pr(n,this.transform):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},n.prototype._contextLost=function(e){e.preventDefault(),this._frameId&&(i.cancelFrame(this._frameId),this._frameId=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},n.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},n.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!(!this.style||!this.style.loaded())},n.prototype._update=function(t){this.style&&(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this._rerender())},n.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},n.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},n.prototype._render=function(){this._renderTaskQueue.run();var e=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var r=this.transform.zoom,n=i.now();this.style.zoomHistory.update(r,n);var a=new t.default$16(r,{now:n,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),o=a.crossFadingFactor();1===o&&o===this._crossFadingFactor||(e=!0,this._crossFadingFactor=o),this.style.update(a)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),fadeDuration:this._fadeDuration}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||e)&&(this._styleDirty=!0),(this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty)&&this._rerender(),this},n.prototype.remove=function(){this._hash&&this._hash.remove(),i.cancelFrame(this._frameId),this._renderTaskQueue.clear(),this._frameId=null,this.setStyle(null),void 0!==t.default&&(t.default.removeEventListener("resize",this._onWindowResize,!1),t.default.removeEventListener("online",this._onWindowOnline,!1));var e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),pn(this._canvasContainer),pn(this._controlContainer),pn(this._missingCSSContainer),this._container.classList.remove("mapboxgl-map"),this.fire(new t.Event("remove"))},n.prototype._rerender=function(){var t=this;this.style&&!this._frameId&&(this._frameId=i.frame(function(){t._frameId=null,t._render()}))},n.prototype._onWindowOnline=function(){this._update()},n.prototype._onWindowResize=function(){this._trackResize&&this.stop().resize()._update()},a.showTileBoundaries.get=function(){return!!this._showTileBoundaries},a.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},a.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},a.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},a.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},a.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},a.repaint.get=function(){return!!this._repaint},a.repaint.set=function(t){this._repaint=t,this._update()},a.vertices.get=function(){return!!this._vertices},a.vertices.set=function(t){this._vertices=t,this._update()},n.prototype._onData=function(e){this._update("style"===e.dataType),this.fire(new t.Event(e.dataType+"data",e))},n.prototype._onDataLoading=function(e){this.fire(new t.Event(e.dataType+"dataloading",e))},Object.defineProperties(n.prototype,a),n}(an);function pn(t){t.parentNode&&t.parentNode.removeChild(t)}var dn={showCompass:!0,showZoom:!0},vn=function(e){var r=this;this.options=t.extend({},dn,e),this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this.options.showZoom&&(this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",function(){return r._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom Out",function(){return r._map.zoomOut()})),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",function(){return r._map.resetNorth()}),this._compassArrow=s.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};function gn(t,e,r){if(t=new W(t.lng,t.lat),e){var n=new W(t.lng-360,t.lat),a=new W(t.lng+360,t.lat),i=r.locationPoint(t).distSqr(e);r.locationPoint(n).distSqr(e)<i?t=n:r.locationPoint(a).distSqr(e)<i&&(t=a)}for(;Math.abs(t.lng-r.center.lng)>180;){var o=r.locationPoint(t);if(o.x>=0&&o.y>=0&&o.x<=r.width&&o.y<=r.height)break;t.lng>r.center.lng?t.lng-=360:t.lng+=360}return t}vn.prototype._rotateCompassArrow=function(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t},vn.prototype.onAdd=function(t){return this._map=t,this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Zr(t,{button:"left",element:this._compass}),this._handler.enable()),this._container},vn.prototype.onRemove=function(){s.remove(this._container),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),this._handler.disable(),delete this._handler),delete this._map},vn.prototype._createButton=function(t,e,r){var n=s.create("button",t,this._container);return n.type="button",n.setAttribute("aria-label",e),n.addEventListener("click",r),n};var mn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function yn(t,e,r){var n=t.classList;for(var a in mn)n.remove("mapboxgl-"+r+"-anchor-"+a);n.add("mapboxgl-"+r+"-anchor-"+e)}var xn=function(e){if((arguments[0]instanceof t.default.HTMLElement||2===arguments.length)&&(e=t.extend({element:e},arguments[1])),t.bindAll(["_update","_onMapClick"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",e&&e.element)this._element=e.element,this._offset=t.default$1.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=s.create("div");var r=s.createNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"height","41px"),r.setAttributeNS(null,"width","27px"),r.setAttributeNS(null,"viewBox","0 0 27 41");var n=s.createNS("http://www.w3.org/2000/svg","g");n.setAttributeNS(null,"stroke","none"),n.setAttributeNS(null,"stroke-width","1"),n.setAttributeNS(null,"fill","none"),n.setAttributeNS(null,"fill-rule","evenodd");var a=s.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"fill-rule","nonzero");var i=s.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"transform","translate(3.0, 29.0)"),i.setAttributeNS(null,"fill","#000000");for(var o=0,l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];o<l.length;o+=1){var u=l[o],c=s.createNS("http://www.w3.org/2000/svg","ellipse");c.setAttributeNS(null,"opacity","0.04"),c.setAttributeNS(null,"cx","10.5"),c.setAttributeNS(null,"cy","5.80029008"),c.setAttributeNS(null,"rx",u.rx),c.setAttributeNS(null,"ry",u.ry),i.appendChild(c)}var f=s.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"fill",this._color);var h=s.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),f.appendChild(h);var p=s.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"opacity","0.25"),p.setAttributeNS(null,"fill","#000000");var d=s.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),p.appendChild(d);var v=s.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(6.0, 7.0)"),v.setAttributeNS(null,"fill","#FFFFFF");var g=s.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(8.0, 8.0)");var m=s.createNS("http://www.w3.org/2000/svg","circle");m.setAttributeNS(null,"fill","#000000"),m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"cx","5.5"),m.setAttributeNS(null,"cy","5.5"),m.setAttributeNS(null,"r","5.4999962");var y=s.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),g.appendChild(m),g.appendChild(y),a.appendChild(i),a.appendChild(f),a.appendChild(p),a.appendChild(v),a.appendChild(g),r.appendChild(a),this._element.appendChild(r),this._offset=t.default$1.convert(e&&e.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._popup=null};xn.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this._update(),this._map.on("click",this._onMapClick),this},xn.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),delete this._map),s.remove(this._element),this._popup&&this._popup.remove(),this},xn.prototype.getLngLat=function(){return this._lngLat},xn.prototype.setLngLat=function(t){return this._lngLat=W.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},xn.prototype.getElement=function(){return this._element},xn.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},xn.prototype._onMapClick=function(t){var e=t.originalEvent.target,r=this._element;this._popup&&(e===r||r.contains(e))&&this.togglePopup()},xn.prototype.getPopup=function(){return this._popup},xn.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},xn.prototype._update=function(t){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=gn(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),t&&"moveend"!==t.type||(this._pos=this._pos.round()),s.setTransform(this._element,mn[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"),yn(this._element,this._anchor,"marker"))},xn.prototype.getOffset=function(){return this._offset},xn.prototype.setOffset=function(e){return this._offset=t.default$1.convert(e),this._update(),this};var bn,_n={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0};var wn=function(e){function r(r){e.call(this),this.options=t.extend({},_n,r),t.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.onAdd=function(e){var r;return this._map=e,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,void 0!==bn?r(bn):void 0!==t.default.navigator.permissions?t.default.navigator.permissions.query({name:"geolocation"}).then(function(t){bn="denied"!==t.state,r(bn)}):(bn=!!t.default.navigator.geolocation,r(bn)),this._container},r.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.default.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker.remove(),s.remove(this._container),this._map=void 0},r.prototype._onSuccess=function(e){if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()},r.prototype._updateCamera=function(t){var e=new W(t.coords.longitude,t.coords.latitude),r=t.coords.accuracy;this._map.fitBounds(e.toBounds(r),this.options.fitBoundsOptions,{geolocateSource:!0})},r.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},r.prototype._onError=function(e){if(this.options.trackUserLocation)if(1===e.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()},r.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},r.prototype._setupUI=function(e){var r=this;!1!==e&&(this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._geolocateButton=s.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=s.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new xn(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(e){e.geolocateSource||"ACTIVE_LOCK"!==r._watchState||(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),r.fire(new t.Event("trackuserlocationend")))}))},r.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=t.default.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else t.default.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},r.prototype._clearWatch=function(){t.default.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},r}(t.Evented),kn={maxWidth:100,unit:"metric"},Mn=function(e){this.options=t.extend({},kn,e),t.bindAll(["_onMove","setUnit"],this)};function An(t,e,r){var n,a,i,o,s,l,u=r&&r.maxWidth||100,c=t._container.clientHeight/2,f=(n=t.unproject([0,c]),a=t.unproject([u,c]),i=Math.PI/180,o=n.lat*i,s=a.lat*i,l=Math.sin(o)*Math.sin(s)+Math.cos(o)*Math.cos(s)*Math.cos((a.lng-n.lng)*i),6371e3*Math.acos(Math.min(l,1)));if(r&&"imperial"===r.unit){var h=3.2808*f;if(h>5280)Tn(e,u,h/5280,"mi");else Tn(e,u,h,"ft")}else if(r&&"nautical"===r.unit){Tn(e,u,f/1852,"nm")}else Tn(e,u,f,"m")}function Tn(t,e,r,n){var a,i,o,s=(a=r,(i=Math.pow(10,(""+Math.floor(a)).length-1))*(o=(o=a/i)>=10?10:o>=5?5:o>=3?3:o>=2?2:1)),l=s/r;"m"===n&&s>=1e3&&(s/=1e3,n="km"),t.style.width=e*l+"px",t.innerHTML=s+n}Mn.prototype.getDefaultPosition=function(){return"bottom-left"},Mn.prototype._onMove=function(){An(this._map,this._container,this.options)},Mn.prototype.onAdd=function(t){return this._map=t,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Mn.prototype.onRemove=function(){s.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Mn.prototype.setUnit=function(t){this.options.unit=t,An(this._map,this._container,this.options)};var Sn=function(){this._fullscreen=!1,t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.default.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.default.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.default.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.default.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};Sn.prototype.onAdd=function(e){return this._map=e,this._mapContainer=this._map.getContainer(),this._container=s.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._container},Sn.prototype.onRemove=function(){s.remove(this._container),this._map=null,t.default.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Sn.prototype._checkFullscreenSupport=function(){return!!(t.default.document.fullscreenEnabled||t.default.document.mozFullScreenEnabled||t.default.document.msFullscreenEnabled||t.default.document.webkitFullscreenEnabled)},Sn.prototype._setupUI=function(){var e=this._fullscreenButton=s.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);e.setAttribute("aria-label","Toggle fullscreen"),e.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.default.document.addEventListener(this._fullscreenchange,this._changeIcon)},Sn.prototype._isFullscreen=function(){return this._fullscreen},Sn.prototype._changeIcon=function(){(t.default.document.fullscreenElement||t.default.document.mozFullScreenElement||t.default.document.webkitFullscreenElement||t.default.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},Sn.prototype._onClickFullscreen=function(){this._isFullscreen()?t.default.document.exitFullscreen?t.default.document.exitFullscreen():t.default.document.mozCancelFullScreen?t.default.document.mozCancelFullScreen():t.default.document.msExitFullscreen?t.default.document.msExitFullscreen():t.default.document.webkitCancelFullScreen&&t.default.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()};var En={closeButton:!0,closeOnClick:!0},Cn=function(e){function r(r){e.call(this),this.options=t.extend(Object.create(En),r),t.bindAll(["_update","_onClickClose"],this)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.addTo=function(e){return this._map=e,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this.fire(new t.Event("open")),this},r.prototype.isOpen=function(){return!!this._map},r.prototype.remove=function(){return this._content&&s.remove(this._content),this._container&&(s.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire(new t.Event("close")),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(t){return this._lngLat=W.convert(t),this._pos=null,this._update(),this},r.prototype.setText=function(e){return this.setDOMContent(t.default.document.createTextNode(e))},r.prototype.setHTML=function(e){var r,n=t.default.document.createDocumentFragment(),a=t.default.document.createElement("body");for(a.innerHTML=e;r=a.firstChild;)n.appendChild(r);return this.setDOMContent(n)},r.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},r.prototype._createContent=function(){this._content&&s.remove(this._content),this._content=s.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=s.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},r.prototype._update=function(){if(this._map&&this._lngLat&&this._content){this._container||(this._container=s.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=s.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this._map.transform.renderWorldCopies&&(this._lngLat=gn(this._lngLat,this._pos,this._map.transform));var e=this._pos=this._map.project(this._lngLat),r=this.options.anchor,n=function e(r){if(r){if("number"==typeof r){var n=Math.round(Math.sqrt(.5*Math.pow(r,2)));return{center:new t.default$1(0,0),top:new t.default$1(0,r),"top-left":new t.default$1(n,n),"top-right":new t.default$1(-n,n),bottom:new t.default$1(0,-r),"bottom-left":new t.default$1(n,-n),"bottom-right":new t.default$1(-n,-n),left:new t.default$1(r,0),right:new t.default$1(-r,0)}}if(r instanceof t.default$1||Array.isArray(r)){var a=t.default$1.convert(r);return{center:a,top:a,"top-left":a,"top-right":a,bottom:a,"bottom-left":a,"bottom-right":a,left:a,right:a}}return{center:t.default$1.convert(r.center||[0,0]),top:t.default$1.convert(r.top||[0,0]),"top-left":t.default$1.convert(r["top-left"]||[0,0]),"top-right":t.default$1.convert(r["top-right"]||[0,0]),bottom:t.default$1.convert(r.bottom||[0,0]),"bottom-left":t.default$1.convert(r["bottom-left"]||[0,0]),"bottom-right":t.default$1.convert(r["bottom-right"]||[0,0]),left:t.default$1.convert(r.left||[0,0]),right:t.default$1.convert(r.right||[0,0])}}return e(new t.default$1(0,0))}(this.options.offset);if(!r){var a,i=this._container.offsetWidth,o=this._container.offsetHeight;a=e.y+n.bottom.y<o?["top"]:e.y>this._map.transform.height-o?["bottom"]:[],e.x<i/2?a.push("left"):e.x>this._map.transform.width-i/2&&a.push("right"),r=0===a.length?"bottom":a.join("-")}var l=e.add(n[r]).round();s.setTransform(this._container,mn[r]+" translate("+l.x+"px,"+l.y+"px)"),yn(this._container,r,"popup")}},r.prototype._onClickClose=function(){this.remove()},r}(t.Evented);var Ln={version:"0.45.0",supported:e,workerCount:Math.max(Math.floor(i.hardwareConcurrency/2),1),setRTLTextPlugin:t.setRTLTextPlugin,Map:hn,NavigationControl:vn,GeolocateControl:wn,AttributionControl:on,ScaleControl:Mn,FullscreenControl:Sn,Popup:Cn,Marker:xn,Style:Qe,LngLat:W,LngLatBounds:Y,Point:t.default$1,Evented:t.Evented,config:g,get accessToken(){return g.ACCESS_TOKEN},set accessToken(t){g.ACCESS_TOKEN=t},workerUrl:""};return Ln});return n})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],394:[function(t,e,r){"use strict";e.exports=o;var n=t("convex-hull");function a(t,e,r){var n=new Array(t);for(var a=0;a<t;++a){n[a]=0;if(a===e){n[a]+=.5}if(a===r){n[a]+=.5}}return n}function i(t,e){if(e===0||e===(1<<t+1)-1){return[]}var r=[];var i=[];for(var o=0;o<=t;++o){if(e&1<<o){r.push(a(t,o-1,o-1));i.push(null);for(var s=0;s<=t;++s){if(~e&1<<s){r.push(a(t,o-1,s-1));i.push([o,s])}}}}var l=n(r);var u=[];t:for(var o=0;o<l.length;++o){var c=l[o];var f=[];for(var s=0;s<c.length;++s){if(!i[c[s]]){continue t}f.push(i[c[s]].slice())}u.push(f)}return u}function o(t){var e=1<<t+1;var r=new Array(e);for(var n=0;n<e;++n){r[n]=i(t,n)}return r}},{"convex-hull":117}],395:[function(t,e,r){var n=t("./normalize");var a=t("gl-mat4/create");var i=t("gl-mat4/clone");var o=t("gl-mat4/determinant");var s=t("gl-mat4/invert");var l=t("gl-mat4/transpose");var u={length:t("gl-vec3/length"),normalize:t("gl-vec3/normalize"),dot:t("gl-vec3/dot"),cross:t("gl-vec3/cross")};var c=a();var f=a();var h=[0,0,0,0];var p=[[0,0,0],[0,0,0],[0,0,0]];var d=[0,0,0];e.exports=function t(e,r,a,y,x,b){if(!r)r=[0,0,0];if(!a)a=[0,0,0];if(!y)y=[0,0,0];if(!x)x=[0,0,0,1];if(!b)b=[0,0,0,1];if(!n(c,e))return false;i(f,c);f[3]=0;f[7]=0;f[11]=0;f[15]=1;if(Math.abs(o(f)<1e-8))return false;var _=c[3],w=c[7],k=c[11],M=c[12],A=c[13],T=c[14],S=c[15];if(_!==0||w!==0||k!==0){h[0]=_;h[1]=w;h[2]=k;h[3]=S;var E=s(f,f);if(!E)return false;l(f,f);v(x,h,f)}else{x[0]=x[1]=x[2]=0;x[3]=1}r[0]=M;r[1]=A;r[2]=T;g(p,c);a[0]=u.length(p[0]);u.normalize(p[0],p[0]);y[0]=u.dot(p[0],p[1]);m(p[1],p[1],p[0],1,-y[0]);a[1]=u.length(p[1]);u.normalize(p[1],p[1]);y[0]/=a[1];y[1]=u.dot(p[0],p[2]);m(p[2],p[2],p[0],1,-y[1]);y[2]=u.dot(p[1],p[2]);m(p[2],p[2],p[1],1,-y[2]);a[2]=u.length(p[2]);u.normalize(p[2],p[2]);y[1]/=a[2];y[2]/=a[2];u.cross(d,p[1],p[2]);if(u.dot(p[0],d)<0){for(var C=0;C<3;C++){a[C]*=-1;p[C][0]*=-1;p[C][1]*=-1;p[C][2]*=-1}}b[0]=.5*Math.sqrt(Math.max(1+p[0][0]-p[1][1]-p[2][2],0));b[1]=.5*Math.sqrt(Math.max(1-p[0][0]+p[1][1]-p[2][2],0));b[2]=.5*Math.sqrt(Math.max(1-p[0][0]-p[1][1]+p[2][2],0));b[3]=.5*Math.sqrt(Math.max(1+p[0][0]+p[1][1]+p[2][2],0));if(p[2][1]>p[1][2])b[0]=-b[0];if(p[0][2]>p[2][0])b[1]=-b[1];if(p[1][0]>p[0][1])b[2]=-b[2];return true};function v(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3];t[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o;t[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o;t[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o;t[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o;return t}function g(t,e){t[0][0]=e[0];t[0][1]=e[1];t[0][2]=e[2];t[1][0]=e[4];t[1][1]=e[5];t[1][2]=e[6];t[2][0]=e[8];t[2][1]=e[9];t[2][2]=e[10]}function m(t,e,r,n,a){t[0]=e[0]*n+r[0]*a;t[1]=e[1]*n+r[1]*a;t[2]=e[2]*n+r[2]*a}},{"./normalize":396,"gl-mat4/clone":248,"gl-mat4/create":249,"gl-mat4/determinant":250,"gl-mat4/invert":254,"gl-mat4/transpose":264,"gl-vec3/cross":314,"gl-vec3/dot":317,"gl-vec3/length":322,"gl-vec3/normalize":328}],396:[function(t,e,r){e.exports=function t(e,r){var n=r[15];if(n===0)return false;var a=1/n;for(var i=0;i<16;i++)e[i]=r[i]*a;return true}},{}],397:[function(t,e,r){var n=t("gl-vec3/lerp");var a=t("mat4-recompose");var i=t("mat4-decompose");var o=t("gl-mat4/determinant");var s=t("quat-slerp");var l=h();var u=h();var c=h();e.exports=f;function f(t,e,r,f){if(o(e)===0||o(r)===0)return false;var h=i(e,l.translate,l.scale,l.skew,l.perspective,l.quaternion);var p=i(r,u.translate,u.scale,u.skew,u.perspective,u.quaternion);if(!h||!p)return false;n(c.translate,l.translate,u.translate,f);n(c.skew,l.skew,u.skew,f);n(c.scale,l.scale,u.scale,f);n(c.perspective,l.perspective,u.perspective,f);s(c.quaternion,l.quaternion,u.quaternion,f);a(t,c.translate,c.scale,c.skew,c.perspective,c.quaternion);return true}function h(){return{translate:p(),scale:p(1),skew:p(),perspective:d(),quaternion:d()}}function p(t){return[t||0,t||0,t||0]}function d(){return[0,0,0,1]}},{"gl-mat4/determinant":250,"gl-vec3/lerp":323,"mat4-decompose":395,"mat4-recompose":398,"quat-slerp":450}],398:[function(t,e,r){var n={identity:t("gl-mat4/identity"),translate:t("gl-mat4/translate"),multiply:t("gl-mat4/multiply"),create:t("gl-mat4/create"),scale:t("gl-mat4/scale"),fromRotationTranslation:t("gl-mat4/fromRotationTranslation")};var a=n.create();var i=n.create();e.exports=function t(e,r,a,o,s,l){n.identity(e);n.fromRotationTranslation(e,l,r);e[3]=s[0];e[7]=s[1];e[11]=s[2];e[15]=s[3];n.identity(i);if(o[2]!==0){i[9]=o[2];n.multiply(e,e,i)}if(o[1]!==0){i[9]=0;i[8]=o[1];n.multiply(e,e,i)}if(o[0]!==0){i[8]=0;i[4]=o[0];n.multiply(e,e,i)}n.scale(e,e,a);return e}},{"gl-mat4/create":249,"gl-mat4/fromRotationTranslation":252,"gl-mat4/identity":253,"gl-mat4/multiply":256,"gl-mat4/scale":262,"gl-mat4/translate":263}],399:[function(t,e,r){"use strict";e.exports=Math.log2||function(t){return Math.log(t)*Math.LOG2E}},{}],400:[function(t,e,r){"use strict";var n=t("binary-search-bounds");var a=t("mat4-interpolate");var i=t("gl-mat4/invert");var o=t("gl-mat4/rotateX");var s=t("gl-mat4/rotateY");var l=t("gl-mat4/rotateZ");var u=t("gl-mat4/lookAt");var c=t("gl-mat4/translate");var f=t("gl-mat4/scale");var h=t("gl-vec3/normalize");var p=[0,0,0];e.exports=m;function d(t){this._components=t.slice();this._time=[0];this.prevMatrix=t.slice();this.nextMatrix=t.slice();this.computedMatrix=t.slice();this.computedInverse=t.slice();this.computedEye=[0,0,0];this.computedUp=[0,0,0];this.computedCenter=[0,0,0];this.computedRadius=[0];this._limits=[-Infinity,Infinity]}var v=d.prototype;v.recalcMatrix=function(t){var e=this._time;var r=n.le(e,t);var o=this.computedMatrix;if(r<0){return}var s=this._components;if(r===e.length-1){var l=16*r;for(var u=0;u<16;++u){o[u]=s[l++]}}else{var c=e[r+1]-e[r];var l=16*r;var f=this.prevMatrix;var p=true;for(var u=0;u<16;++u){f[u]=s[l++]}var d=this.nextMatrix;for(var u=0;u<16;++u){d[u]=s[l++];p=p&&f[u]===d[u]}if(c<1e-6||p){for(var u=0;u<16;++u){o[u]=f[u]}}else{a(o,f,d,(t-e[r])/c)}}var v=this.computedUp;v[0]=o[1];v[1]=o[5];v[2]=o[9];h(v,v);var g=this.computedInverse;i(g,o);var m=this.computedEye;var y=g[15];m[0]=g[12]/y;m[1]=g[13]/y;m[2]=g[14]/y;var x=this.computedCenter;var b=Math.exp(this.computedRadius[0]);for(var u=0;u<3;++u){x[u]=m[u]-o[2+4*u]*b}};v.idle=function(t){if(t<this.lastT()){return}var e=this._components;var r=e.length-16;for(var n=0;n<16;++n){e.push(e[r++])}this._time.push(t)};v.flush=function(t){var e=n.gt(this._time,t)-2;if(e<0){return}this._time.splice(0,e);this._components.splice(0,16*e)};v.lastT=function(){return this._time[this._time.length-1]};v.lookAt=function(t,e,r,n){this.recalcMatrix(t);e=e||this.computedEye;r=r||p;n=n||this.computedUp;this.setMatrix(t,u(this.computedMatrix,e,r,n));var a=0;for(var i=0;i<3;++i){a+=Math.pow(r[i]-e[i],2)}a=Math.log(Math.sqrt(a));this.computedRadius[0]=a};v.rotate=function(t,e,r,n){this.recalcMatrix(t);var a=this.computedInverse;if(e)s(a,a,e);if(r)o(a,a,r);if(n)l(a,a,n);this.setMatrix(t,i(this.computedMatrix,a))};var g=[0,0,0];v.pan=function(t,e,r,n){g[0]=-(e||0);g[1]=-(r||0);g[2]=-(n||0);this.recalcMatrix(t);var a=this.computedInverse;c(a,a,g);this.setMatrix(t,i(a,a))};v.translate=function(t,e,r,n){g[0]=e||0;g[1]=r||0;g[2]=n||0;this.recalcMatrix(t);var a=this.computedMatrix;c(a,a,g);this.setMatrix(t,a)};v.setMatrix=function(t,e){if(t<this.lastT()){return}this._time.push(t);for(var r=0;r<16;++r){this._components.push(e[r])}};v.setDistance=function(t,e){this.computedRadius[0]=e};v.setDistanceLimits=function(t,e){var r=this._limits;r[0]=t;r[1]=e};v.getDistanceLimits=function(t){var e=this._limits;if(t){t[0]=e[0];t[1]=e[1];return t}return e};function m(t){t=t||{};var e=t.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new d(e)}},{"binary-search-bounds":79,"gl-mat4/invert":254,"gl-mat4/lookAt":255,"gl-mat4/rotateX":259,"gl-mat4/rotateY":260,"gl-mat4/rotateZ":261,"gl-mat4/scale":262,"gl-mat4/translate":263,"gl-vec3/normalize":328,"mat4-interpolate":397}],401:[function(t,e,r){"use strict";e.exports=a;var n=t("robust-orientation")[3];function a(t){var e=t.length;if(e<3){var r=new Array(e);for(var a=0;a<e;++a){r[a]=a}if(e===2&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]){return[0]}return r}var i=new Array(e);for(var a=0;a<e;++a){i[a]=a}i.sort(function(e,r){var n=t[e][0]-t[r][0];if(n){return n}return t[e][1]-t[r][1]});var o=[i[0],i[1]];var s=[i[0],i[1]];for(var a=2;a<e;++a){var l=i[a];var u=t[l];var c=o.length;while(c>1&&n(t[o[c-2]],t[o[c-1]],u)<=0){c-=1;o.pop()}o.push(l);c=s.length;while(c>1&&n(t[s[c-2]],t[s[c-1]],u)>=0){c-=1;s.pop()}s.push(l)}var r=new Array(s.length+o.length-2);var f=0;for(var a=0,h=o.length;a<h;++a){r[f++]=o[a]}for(var p=s.length-2;p>0;--p){r[f++]=s[p]}return r}},{"robust-orientation":471}],402:[function(t,e,r){"use strict";e.exports=a;var n=t("mouse-event");function a(t,e){if(!e){e=t;t=window}var r=0;var a=0;var i=0;var o={shift:false,alt:false,control:false,meta:false};var s=false;function l(t){var e=false;if("altKey"in t){e=e||t.altKey!==o.alt;o.alt=!!t.altKey}if("shiftKey"in t){e=e||t.shiftKey!==o.shift;o.shift=!!t.shiftKey}if("ctrlKey"in t){e=e||t.ctrlKey!==o.control;o.control=!!t.ctrlKey}if("metaKey"in t){e=e||t.metaKey!==o.meta;o.meta=!!t.metaKey}return e}function u(t,s){var u=n.x(s);var c=n.y(s);if("buttons"in s){t=s.buttons|0}if(t!==r||u!==a||c!==i||l(s)){r=t|0;a=u||0;i=c||0;e&&e(r,a,i,o)}}function c(t){u(0,t)}function f(){if(r||a||i||o.shift||o.alt||o.meta||o.control){a=i=0;r=0;o.shift=o.alt=o.control=o.meta=false;e&&e(0,0,0,o)}}function h(t){if(l(t)){e&&e(r,a,i,o)}}function p(t){if(n.buttons(t)===0){u(0,t)}else{u(r,t)}}function d(t){u(r|n.buttons(t),t)}function v(t){u(r&~n.buttons(t),t)}function g(){if(s){return}s=true;t.addEventListener("mousemove",p);t.addEventListener("mousedown",d);t.addEventListener("mouseup",v);t.addEventListener("mouseleave",c);t.addEventListener("mouseenter",c);t.addEventListener("mouseout",c);t.addEventListener("mouseover",c);t.addEventListener("blur",f);t.addEventListener("keyup",h);t.addEventListener("keydown",h);t.addEventListener("keypress",h);if(t!==window){window.addEventListener("blur",f);window.addEventListener("keyup",h);window.addEventListener("keydown",h);window.addEventListener("keypress",h)}}function m(){if(!s){return}s=false;t.removeEventListener("mousemove",p);t.removeEventListener("mousedown",d);t.removeEventListener("mouseup",v);t.removeEventListener("mouseleave",c);t.removeEventListener("mouseenter",c);t.removeEventListener("mouseout",c);t.removeEventListener("mouseover",c);t.removeEventListener("blur",f);t.removeEventListener("keyup",h);t.removeEventListener("keydown",h);t.removeEventListener("keypress",h);if(t!==window){window.removeEventListener("blur",f);window.removeEventListener("keyup",h);window.removeEventListener("keydown",h);window.removeEventListener("keypress",h)}}g();var y={element:t};Object.defineProperties(y,{enabled:{get:function(){return s},set:function(t){if(t){g()}else{m()}},enumerable:true},buttons:{get:function(){return r},enumerable:true},x:{get:function(){return a},enumerable:true},y:{get:function(){return i},enumerable:true},mods:{get:function(){return o},enumerable:true}});return y}},{"mouse-event":404}],403:[function(t,e,r){var n={left:0,top:0};e.exports=a;function a(t,e,r){e=e||t.currentTarget||t.srcElement;if(!Array.isArray(r)){r=[0,0]}var n=t.clientX||0;var a=t.clientY||0;var o=i(e);r[0]=n-o.left;r[1]=a-o.top;return r}function i(t){if(t===window||t===document||t===document.body){return n}else{return t.getBoundingClientRect()}}},{}],404:[function(t,e,r){"use strict";function n(t){if(typeof t==="object"){if("buttons"in t){return t.buttons}else if("which"in t){var e=t.which;if(e===2){return 4}else if(e===3){return 2}else if(e>0){return 1<<e-1}}else if("button"in t){var e=t.button;if(e===1){return 4}else if(e===2){return 2}else if(e>=0){return 1<<e}}}return 0}r.buttons=n;function a(t){return t.target||t.srcElement||window}r.element=a;function i(t){if(typeof t==="object"){if("offsetX"in t){return t.offsetX}var e=a(t);var r=e.getBoundingClientRect();return t.clientX-r.left}return 0}r.x=i;function o(t){if(typeof t==="object"){if("offsetY"in t){return t.offsetY}var e=a(t);var r=e.getBoundingClientRect();return t.clientY-r.top}return 0}r.y=o},{}],405:[function(t,e,r){"use strict";var n=t("to-px");e.exports=a;function a(t,e,r){if(typeof t==="function"){r=!!e;e=t;t=window}var a=n("ex",t);var i=function(t){if(r){t.preventDefault()}var n=t.deltaX||0;var i=t.deltaY||0;var o=t.deltaZ||0;var s=t.deltaMode;var l=1;switch(s){case 1:l=a;break;case 2:l=window.innerHeight;break}n*=l;i*=l;o*=l;if(n||i||o){return e(n,i,o,t)}};t.addEventListener("wheel",i);return i}},{"to-px":501}],406:[function(t,e,r){"use strict";var n=t("typedarray-pool");e.exports=S;function a(t){return"a"+t}function i(t){return"d"+t}function o(t,e){return"c"+t+"_"+e}function s(t){return"s"+t}function l(t,e){return"t"+t+"_"+e}function u(t){return"o"+t}function c(t){return"x"+t}function f(t){return"p"+t}function h(t,e){return"d"+t+"_"+e}function p(t){return"i"+t}function d(t,e){return"u"+t+"_"+e}function v(t){return"b"+t}function g(t){return"y"+t}function m(t){return"e"+t}function y(t){return"v"+t}var x="V";var b="P";var _="N";var w="Q";var k="X";var M="T";function A(t,e,r){var n=0;for(var a=0;a<t;++a){if(e&1<<a){n|=1<<r[a]}}return n}function T(t,e,r,T,S,E){var C=E.length;var L=S.length;if(L<2){throw new Error("ndarray-extract-contour: Dimension must be at least 2")}var I="extractContour"+S.join("_");var z=[];var P=[];var O=[];for(var D=0;D<C;++D){O.push(a(D))}for(var D=0;D<T;++D){O.push(c(D))}for(var D=0;D<L;++D){P.push(s(D)+"="+a(0)+".shape["+D+"]|0")}for(var D=0;D<C;++D){P.push(i(D)+"="+a(D)+".data",u(D)+"="+a(D)+".offset|0");for(var R=0;R<L;++R){P.push(l(D,R)+"="+a(D)+".stride["+R+"]|0")}}for(var D=0;D<C;++D){P.push(f(D)+"="+u(D));P.push(o(D,0));for(var R=1;R<1<<L;++R){var B=[];for(var F=0;F<L;++F){if(R&1<<F){B.push("-"+l(D,F))}}P.push(h(D,R)+"=("+B.join("")+")|0");P.push(o(D,R)+"=0")}}for(var D=0;D<C;++D){for(var R=0;R<L;++R){var N=[l(D,S[R])];if(R>0){N.push(l(D,S[R-1])+"*"+s(S[R-1]))}P.push(d(D,S[R])+"=("+N.join("-")+")|0")}}for(var D=0;D<L;++D){P.push(p(D)+"=0")}P.push(_+"=0");var j=["2"];for(var D=L-2;D>=0;--D){j.push(s(S[D]))}P.push(w+"=("+j.join("*")+")|0",b+"=mallocUint32("+w+")",x+"=mallocUint32("+w+")",k+"=0");P.push(v(0)+"=0");for(var R=1;R<1<<L;++R){var V=[];var U=[];for(var F=0;F<L;++F){if(R&1<<F){if(U.length===0){V.push("1")}else{V.unshift(U.join("*"))}}U.push(s(S[F]))}var q="";if(V[0].indexOf(s(S[L-2]))<0){q="-"}var H=A(L,R,S);P.push(m(H)+"=(-"+V.join("-")+")|0",g(H)+"=("+q+V.join("-")+")|0",v(H)+"=0")}P.push(y(0)+"=0",M+"=0");function G(t,e){z.push("for(",p(S[t]),"=",e,";",p(S[t]),"<",s(S[t]),";","++",p(S[t]),"){")}function W(t){for(var e=0;e<C;++e){z.push(f(e),"+=",d(e,S[t]),";")}z.push("}")}function Y(t){for(var e=t-1;e>=0;--e){G(e,0)}var r=[];for(var e=0;e<C;++e){if(E[e]){r.push(i(e)+".get("+f(e)+")")}else{r.push(i(e)+"["+f(e)+"]")}}for(var e=0;e<T;++e){r.push(c(e))}z.push(b,"[",k,"++]=phase(",r.join(),");");for(var e=0;e<t;++e){W(e)}for(var n=0;n<C;++n){z.push(f(n),"+=",d(n,S[t]),";")}}function X(t){for(var e=0;e<C;++e){if(E[e]){z.push(o(e,0),"=",i(e),".get(",f(e),");")}else{z.push(o(e,0),"=",i(e),"[",f(e),"];")}}var r=[];for(var e=0;e<C;++e){r.push(o(e,0))}for(var e=0;e<T;++e){r.push(c(e))}z.push(v(0),"=",b,"[",k,"]=phase(",r.join(),");");for(var n=1;n<1<<L;++n){z.push(v(n),"=",b,"[",k,"+",m(n),"];")}var a=[];for(var n=1;n<1<<L;++n){a.push("("+v(0)+"!=="+v(n)+")")}z.push("if(",a.join("||"),"){");var s=[];for(var e=0;e<L;++e){s.push(p(e))}for(var e=0;e<C;++e){s.push(o(e,0));for(var n=1;n<1<<L;++n){if(E[e]){z.push(o(e,n),"=",i(e),".get(",f(e),"+",h(e,n),");")}else{z.push(o(e,n),"=",i(e),"[",f(e),"+",h(e,n),"];")}s.push(o(e,n))}}for(var e=0;e<1<<L;++e){s.push(v(e))}for(var e=0;e<T;++e){s.push(c(e))}z.push("vertex(",s.join(),");",y(0),"=",x,"[",k,"]=",_,"++;");var l=(1<<L)-1;var u=v(l);for(var n=0;n<L;++n){if((t&~(1<<n))===0){var d=l^1<<n;var g=v(d);var w=[];for(var M=d;M>0;M=M-1&d){w.push(x+"["+k+"+"+m(M)+"]")}w.push(y(0));for(var M=0;M<C;++M){if(n&1){w.push(o(M,l),o(M,d))}else{w.push(o(M,d),o(M,l))}}if(n&1){w.push(u,g)}else{w.push(g,u)}for(var M=0;M<T;++M){w.push(c(M))}z.push("if(",u,"!==",g,"){","face(",w.join(),")}")}}z.push("}",k,"+=1;")}function Z(){for(var t=1;t<1<<L;++t){z.push(M,"=",m(t),";",m(t),"=",g(t),";",g(t),"=",M,";")}}function $(t,e){if(t<0){X(e);return}Y(t);z.push("if(",s(S[t]),">0){",p(S[t]),"=1;");$(t-1,e|1<<S[t]);for(var r=0;r<C;++r){z.push(f(r),"+=",d(r,S[t]),";")}if(t===L-1){z.push(k,"=0;");Z()}G(t,2);$(t-1,e);if(t===L-1){z.push("if(",p(S[L-1]),"&1){",k,"=0;}");Z()}W(t);z.push("}")}$(L-1,0);z.push("freeUint32(",x,");freeUint32(",b,");");var J=["'use strict';","function ",I,"(",O.join(),"){","var ",P.join(),";",z.join(""),"}","return ",I].join("");var K=new Function("vertex","face","phase","mallocUint32","freeUint32",J);return K(t,e,r,n.mallocUint32,n.freeUint32)}function S(t){function e(t){throw new Error("ndarray-extract-contour: "+t)}if(typeof t!=="object"){e("Must specify arguments")}var r=t.order;if(!Array.isArray(r)){e("Must specify order")}var n=t.arrayArguments||1;if(n<1){e("Must have at least one array argument")}var a=t.scalarArguments||0;if(a<0){e("Scalar arg count must be > 0")}if(typeof t.vertex!=="function"){e("Must specify vertex creation function")}if(typeof t.cell!=="function"){e("Must specify cell creation function")}if(typeof t.phase!=="function"){e("Must specify phase function")}var i=t.getters||[];var o=new Array(n);for(var s=0;s<n;++s){if(i.indexOf(s)>=0){o[s]=true}else{o[s]=false}}return T(t.vertex,t.cell,t.phase,a,r,o)}},{"typedarray-pool":507}],407:[function(t,e,r){"use strict";var n=t("cwise/lib/wrapper")({args:["index","array","scalar"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{_inline_1_arg1_=_inline_1_arg2_.apply(void 0,_inline_1_arg0_)}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg1_",lvalue:true,rvalue:false,count:1},{name:"_inline_1_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:false,funcName:"cwise",blockSize:64});e.exports=function(t,e){n(t,e);return t}},{"cwise/lib/wrapper":136}],408:[function(t,e,r){"use strict";e.exports=h;var n=t("dup");var a=t("cwise-compiler");var i={};var o={};var s={body:"",args:[],thisVars:[],localVars:[]};var l=a({args:["array","array","array"],pre:s,post:s,body:{args:[{name:"out",lvalue:true,rvalue:false,count:1},{name:"left",lvalue:false,rvalue:true,count:1},{name:"right",lvalue:false,rvalue:true,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"});var u=a({args:["array"],pre:s,post:s,body:{args:[{name:"out",lvalue:true,rvalue:false,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function c(t){if(t in i){return i[t]}var e=[];for(var r=0;r<t;++r){e.push("out",r,"s=0.5*(inp",r,"l-inp",r,"r);")}var o=["array"];var l=["junk"];for(var r=0;r<t;++r){o.push("array");l.push("out"+r+"s");var u=n(t);u[r]=-1;o.push({array:0,offset:u.slice()});u[r]=1;o.push({array:0,offset:u.slice()});l.push("inp"+r+"l","inp"+r+"r")}return i[t]=a({args:o,pre:s,post:s,body:{body:e.join(""),args:l.map(function(t){return{name:t,lvalue:t.indexOf("out")===0,rvalue:t.indexOf("inp")===0,count:t!=="junk"|0}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+t})}function f(t){var e=t.join();var r=o[e];if(r){return r}var n=t.length;var a=["function gradient(dst,src){var s=src.shape.slice();"];function s(e){var r=n-e.length;var i=[];var o=[];var s=[];for(var l=0;l<n;++l){if(e.indexOf(l+1)>=0){s.push("0")}else if(e.indexOf(-(l+1))>=0){s.push("s["+l+"]-1")}else{s.push("-1");i.push("1");o.push("s["+l+"]-2")}}var u=".lo("+i.join()+").hi("+o.join()+")";if(i.length===0){u=""}if(r>0){a.push("if(1");for(var l=0;l<n;++l){if(e.indexOf(l+1)>=0||e.indexOf(-(l+1))>=0){continue}a.push("&&s[",l,"]>2")}a.push("){grad",r,"(src.pick(",s.join(),")",u);for(var l=0;l<n;++l){if(e.indexOf(l+1)>=0||e.indexOf(-(l+1))>=0){continue}a.push(",dst.pick(",s.join(),",",l,")",u)}a.push(");")}for(var l=0;l<e.length;++l){var c=Math.abs(e[l])-1;var f="dst.pick("+s.join()+","+c+")"+u;switch(t[c]){case"clamp":var h=s.slice();var p=s.slice();if(e[l]<0){h[c]="s["+c+"]-2"}else{p[c]="1"}if(r===0){a.push("if(s[",c,"]>1){dst.set(",s.join(),",",c,",0.5*(src.get(",h.join(),")-src.get(",p.join(),")))}else{dst.set(",s.join(),",",c,",0)};")}else{a.push("if(s[",c,"]>1){diff(",f,",src.pick(",h.join(),")",u,",src.pick(",p.join(),")",u,");}else{zero(",f,");};")}break;case"mirror":if(r===0){a.push("dst.set(",s.join(),",",c,",0);")}else{a.push("zero(",f,");")}break;case"wrap":var d=s.slice();var v=s.slice();if(e[l]<0){d[c]="s["+c+"]-2";v[c]="0"}else{d[c]="s["+c+"]-1";v[c]="1"}if(r===0){a.push("if(s[",c,"]>2){dst.set(",s.join(),",",c,",0.5*(src.get(",d.join(),")-src.get(",v.join(),")))}else{dst.set(",s.join(),",",c,",0)};")}else{a.push("if(s[",c,"]>2){diff(",f,",src.pick(",d.join(),")",u,",src.pick(",v.join(),")",u,");}else{zero(",f,");};")}break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}if(r>0){a.push("};")}}for(var f=0;f<1<<n;++f){var h=[];for(var p=0;p<n;++p){if(f&1<<p){h.push(p+1)}}for(var d=0;d<1<<h.length;++d){var v=h.slice();for(var p=0;p<h.length;++p){if(d&1<<p){v[p]=-v[p]}}s(v)}}a.push("return dst;};return gradient");var g=["diff","zero"];var m=[l,u];for(var f=1;f<=n;++f){g.push("grad"+f);m.push(c(f))}g.push(a.join(""));var y=Function.apply(void 0,g);var r=y.apply(void 0,m);i[e]=r;return r}function h(t,e,r){if(Array.isArray(r)){if(r.length!==e.dimension){throw new Error("ndarray-gradient: invalid boundary conditions")}}else if(typeof r==="string"){r=n(e.dimension,r)}else{r=n(e.dimension,"clamp")}if(t.dimension!==e.dimension+1){throw new Error("ndarray-gradient: output dimension must be +1 input dimension")}if(t.shape[e.dimension]!==e.dimension){throw new Error("ndarray-gradient: output shape must match input shape")}for(var a=0;a<e.dimension;++a){if(t.shape[a]!==e.shape[a]){throw new Error("ndarray-gradient: shape mismatch")}}if(e.size===0){return t}if(e.dimension<=0){t.set(0);return t}var i=f(r);return i(t,e)}},{"cwise-compiler":133,dup:154}],409:[function(t,e,r){"use strict";var n=t("ndarray-warp");var a=t("gl-matrix-invert");e.exports=i;function i(t,e,r){var i=e.dimension;var o=a([],r);n(t,e,function(t,e){for(var r=0;r<i;++r){t[r]=o[(i+1)*i+r];for(var n=0;n<i;++n){t[r]+=o[(i+1)*n+r]*e[n]}}var a=o[(i+1)*(i+1)-1];for(var n=0;n<i;++n){a+=o[(i+1)*n+i]*e[n]}var s=1/a;for(var r=0;r<i;++r){t[r]*=s}return t});return t}},{"gl-matrix-invert":265,"ndarray-warp":416}],410:[function(t,e,r){"use strict";function n(t,e){var r=Math.floor(e),n=e-r,a=0<=r&&r<t.shape[0],i=0<=r+1&&r+1<t.shape[0],o=a?+t.get(r):0,s=i?+t.get(r+1):0;return(1-n)*o+n*s}function a(t,e,r){var n=Math.floor(e),a=e-n,i=0<=n&&n<t.shape[0],o=0<=n+1&&n+1<t.shape[0],s=Math.floor(r),l=r-s,u=0<=s&&s<t.shape[1],c=0<=s+1&&s+1<t.shape[1],f=i&&u?t.get(n,s):0,h=i&&c?t.get(n,s+1):0,p=o&&u?t.get(n+1,s):0,d=o&&c?t.get(n+1,s+1):0;return(1-l)*((1-a)*f+a*p)+l*((1-a)*h+a*d)}function i(t,e,r,n){var a=Math.floor(e),i=e-a,o=0<=a&&a<t.shape[0],s=0<=a+1&&a+1<t.shape[0],l=Math.floor(r),u=r-l,c=0<=l&&l<t.shape[1],f=0<=l+1&&l+1<t.shape[1],h=Math.floor(n),p=n-h,d=0<=h&&h<t.shape[2],v=0<=h+1&&h+1<t.shape[2],g=o&&c&&d?t.get(a,l,h):0,m=o&&f&&d?t.get(a,l+1,h):0,y=s&&c&&d?t.get(a+1,l,h):0,x=s&&f&&d?t.get(a+1,l+1,h):0,b=o&&c&&v?t.get(a,l,h+1):0,_=o&&f&&v?t.get(a,l+1,h+1):0,w=s&&c&&v?t.get(a+1,l,h+1):0,k=s&&f&&v?t.get(a+1,l+1,h+1):0;return(1-p)*((1-u)*((1-i)*g+i*y)+u*((1-i)*m+i*x))+p*((1-u)*((1-i)*b+i*w)+u*((1-i)*_+i*k))}function o(t){var e=t.shape.length|0,r=new Array(e),n=new Array(e),a=new Array(e),i=new Array(e),o,s;for(o=0;o<e;++o){s=+arguments[o+1];r[o]=Math.floor(s);n[o]=s-r[o];a[o]=0<=r[o]&&r[o]<t.shape[o];i[o]=0<=r[o]+1&&r[o]+1<t.shape[o]}var l=0,u,c,f;t:for(o=0;o<1<<e;++o){c=1;f=t.offset;for(u=0;u<e;++u){if(o&1<<u){if(!i[u]){continue t}c*=n[u];f+=t.stride[u]*(r[u]+1)}else{if(!a[u]){continue t}c*=1-n[u];f+=t.stride[u]*r[u]}}l+=c*t.data[f]}return l}function s(t,e,r,s){switch(t.shape.length){case 0:return 0;case 1:return n(t,e);case 2:return a(t,e,r);case 3:return i(t,e,r,s);default:return o.apply(undefined,arguments)}}e.exports=s;e.exports.d1=n;e.exports.d2=a;e.exports.d3=i},{}],411:[function(t,e,r){"use strict";var n=t("cwise-compiler");var a={body:"",args:[],thisVars:[],localVars:[]};function i(t){if(!t){return a}for(var e=0;e<t.args.length;++e){var r=t.args[e];if(e===0){t.args[e]={name:r,lvalue:true,rvalue:!!t.rvalue,count:t.count||1}}else{t.args[e]={name:r,lvalue:false,rvalue:true,count:1}}}if(!t.thisVars){t.thisVars=[]}if(!t.localVars){t.localVars=[]}return t}function o(t){return n({args:t.args,pre:i(t.pre),body:i(t.body),post:i(t.proc),funcName:t.funcName})}function s(t){var e=[];for(var r=0;r<t.args.length;++r){e.push("a"+r)}var n=new Function("P",["return function ",t.funcName,"_ndarrayops(",e.join(","),") {P(",e.join(","),");return a0}"].join(""));return n(o(t))}var l={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var t in l){var e=l[t];r[t]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+e+"c"},funcName:t});r[t+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a"+e+"=b"},rvalue:true,funcName:t+"eq"});r[t+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+e+"s"},funcName:t+"s"});r[t+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a"+e+"=s"},rvalue:true,funcName:t+"seq"})}})();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var t in u){var e=u[t];r[t]=s({args:["array","array"],body:{args:["a","b"],body:"a="+e+"b"},funcName:t});r[t+"eq"]=s({args:["array"],body:{args:["a"],body:"a="+e+"a"},rvalue:true,count:2,funcName:t+"eq"})}})();var c={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var t in c){var e=c[t];r[t]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+e+"c"},funcName:t});r[t+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+e+"s"},funcName:t+"s"});r[t+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a=a"+e+"b"},rvalue:true,count:2,funcName:t+"eq"});r[t+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+e+"s"},rvalue:true,count:2,funcName:t+"seq"})}})();var f=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var t=0;t<f.length;++t){var e=f[t];r[e]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:e});r[e+"eq"]=s({args:["array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:e+"eq"})}})();var h=["max","min","atan2","pow"];(function(){for(var t=0;t<h.length;++t){var e=h[t];r[e]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:e});r[e+"s"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:e+"s"});r[e+"eq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:e+"eq"});r[e+"seq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:e+"seq"})}})();var p=["atan2","pow"];(function(){for(var t=0;t<p.length;++t){var e=p[t];r[e+"op"]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:e+"op"});r[e+"ops"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:e+"ops"});r[e+"opeq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:e+"opeq"});r[e+"opseq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:e+"opseq"})}})();r.any=n({args:["array"],pre:a,body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"});r.all=n({args:["array"],pre:a,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"});r.sum=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"});r.prod=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"});r.norm2squared=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"});r.norm2=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"});r.norminf=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"});r.norm1=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"});r.sup=n({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});r.inf=n({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});r.argmin=n({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});r.argmax=n({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});r.random=s({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"});r.assign=s({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"});r.assigns=s({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"});r.equals=n({args:["array","array"],pre:a,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1},{name:"y",lvalue:false,rvalue:true,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":133}],412:[function(t,e,r){"use strict";var n=t("ndarray");var a=t("./doConvert.js");e.exports=function t(e,r){var i=[],o=e,s=1;while(Array.isArray(o)){i.push(o.length);s*=o.length;o=o[0]}if(i.length===0){return n()}if(!r){r=n(new Float64Array(s),i)}a(r,e);return r}},{"./doConvert.js":413,ndarray:417}],413:[function(t,e,r){e.exports=t("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:true,rvalue:false,count:1},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg2_",lvalue:false,rvalue:true,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":133}],414:[function(t,e,r){"use strict";var n=t("typedarray-pool");var a=32;function i(t){switch(t){case"uint8":return[n.mallocUint8,n.freeUint8];case"uint16":return[n.mallocUint16,n.freeUint16];case"uint32":return[n.mallocUint32,n.freeUint32];case"int8":return[n.mallocInt8,n.freeInt8];case"int16":return[n.mallocInt16,n.freeInt16];case"int32":return[n.mallocInt32,n.freeInt32];case"float32":return[n.mallocFloat,n.freeFloat];case"float64":return[n.mallocDouble,n.freeDouble];default:return null}}function o(t){var e=[];for(var r=0;r<t;++r){e.push("s"+r)}for(var r=0;r<t;++r){e.push("n"+r)}for(var r=1;r<t;++r){e.push("d"+r)}for(var r=1;r<t;++r){e.push("e"+r)}for(var r=1;r<t;++r){e.push("f"+r)}return e}function s(t,e){var r=["'use strict'"];var n=["ndarrayInsertionSort",t.join("d"),e].join("");var a=["left","right","data","offset"].concat(o(t.length));var s=i(e);var l=["i,j,cptr,ptr=left*s0+offset"];if(t.length>1){var u=[];for(var c=1;c<t.length;++c){l.push("i"+c);u.push("n"+c)}if(s){l.push("scratch=malloc("+u.join("*")+")")}else{l.push("scratch=new Array("+u.join("*")+")")}l.push("dptr","sptr","a","b")}else{l.push("scratch")}function f(t){if(e==="generic"){return["data.get(",t,")"].join("")}return["data[",t,"]"].join("")}function h(t,r){if(e==="generic"){return["data.set(",t,",",r,")"].join("")}return["data[",t,"]=",r].join("")}r.push(["function ",n,"(",a.join(","),"){var ",l.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr");if(t.length>1){r.push("dptr=0;sptr=ptr");for(var c=t.length-1;c>=0;--c){var p=t[c];if(p===0){continue}r.push(["for(i",p,"=0;i",p,"<n",p,";++i",p,"){"].join(""))}r.push("scratch[dptr++]=",f("sptr"));for(var c=0;c<t.length;++c){var p=t[c];if(p===0){continue}r.push("sptr+=d"+p,"}")}r.push("__g:while(j--\x3eleft){","dptr=0","sptr=cptr-s0");for(var c=1;c<t.length;++c){if(c===1){r.push("__l:")}r.push(["for(i",c,"=0;i",c,"<n",c,";++i",c,"){"].join(""))}r.push(["a=",f("sptr"),"\nb=scratch[dptr]\nif(a<b){break __g}\nif(a>b){break __l}"].join(""));for(var c=t.length-1;c>=1;--c){r.push("sptr+=e"+c,"dptr+=f"+c,"}")}r.push("dptr=cptr;sptr=cptr-s0");for(var c=t.length-1;c>=0;--c){var p=t[c];if(p===0){continue}r.push(["for(i",p,"=0;i",p,"<n",p,";++i",p,"){"].join(""))}r.push(h("dptr",f("sptr")));for(var c=0;c<t.length;++c){var p=t[c];if(p===0){continue}r.push(["dptr+=d",p,";sptr+=d",p].join(""),"}")}r.push("cptr-=s0\n}");r.push("dptr=cptr;sptr=0");for(var c=t.length-1;c>=0;--c){var p=t[c];if(p===0){continue}r.push(["for(i",p,"=0;i",p,"<n",p,";++i",p,"){"].join(""))}r.push(h("dptr","scratch[sptr++]"));for(var c=0;c<t.length;++c){var p=t[c];if(p===0){continue}r.push("dptr+=d"+p,"}")}}else{r.push("scratch="+f("ptr"),"while((j--\x3eleft)&&("+f("cptr-s0")+">scratch)){",h("cptr",f("cptr-s0")),"cptr-=s0","}",h("cptr","scratch"))}r.push("}");if(t.length>1&&s){r.push("free(scratch)")}r.push("} return "+n);if(s){var d=new Function("malloc","free",r.join("\n"));return d(s[0],s[1])}else{var d=new Function(r.join("\n"));return d()}}function l(t,e,r){var n=["'use strict'"];var s=["ndarrayQuickSort",t.join("d"),e].join("");var l=["left","right","data","offset"].concat(o(t.length));var u=i(e);var c=0;n.push(["function ",s,"(",l.join(","),"){"].join(""));var f=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(t.length>1){var h=[];for(var p=1;p<t.length;++p){h.push("n"+p);f.push("i"+p)}for(var p=0;p<8;++p){f.push("b_ptr"+p)}f.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+h.join("*"));if(u){f.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)")}else{f.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}}else{f.push("pivot1","pivot2")}n.push("var "+f.join(","));function d(t){return["(offset+",t,"*s0)"].join("")}function v(t){if(e==="generic"){return["data.get(",t,")"].join("")}return["data[",t,"]"].join("")}function g(t,r){if(e==="generic"){return["data.set(",t,",",r,")"].join("")}return["data[",t,"]=",r].join("")}function m(e,r,a){if(e.length===1){n.push("ptr0="+d(e[0]))}else{for(var i=0;i<e.length;++i){n.push(["b_ptr",i,"=s0*",e[i]].join(""))}}if(r){n.push("pivot_ptr=0")}n.push("ptr_shift=offset");for(var i=t.length-1;i>=0;--i){var o=t[i];if(o===0){continue}n.push(["for(i",o,"=0;i",o,"<n",o,";++i",o,"){"].join(""))}if(e.length>1){for(var i=0;i<e.length;++i){n.push(["ptr",i,"=b_ptr",i,"+ptr_shift"].join(""))}}n.push(a);if(r){n.push("++pivot_ptr")}for(var i=0;i<t.length;++i){var o=t[i];if(o===0){continue}if(e.length>1){n.push("ptr_shift+=d"+o)}else{n.push("ptr0+=d"+o)}n.push("}")}}function y(e,r,a,i){if(r.length===1){n.push("ptr0="+d(r[0]))}else{for(var o=0;o<r.length;++o){n.push(["b_ptr",o,"=s0*",r[o]].join(""))}n.push("ptr_shift=offset")}if(a){n.push("pivot_ptr=0")}if(e){n.push(e+":")}for(var o=1;o<t.length;++o){n.push(["for(i",o,"=0;i",o,"<n",o,";++i",o,"){"].join(""))}if(r.length>1){for(var o=0;o<r.length;++o){n.push(["ptr",o,"=b_ptr",o,"+ptr_shift"].join(""))}}n.push(i);for(var o=t.length-1;o>=1;--o){if(a){n.push("pivot_ptr+=f"+o)}if(r.length>1){n.push("ptr_shift+=e"+o)}else{n.push("ptr0+=e"+o)}n.push("}")}}function x(){if(t.length>1&&u){n.push("free(pivot1)","free(pivot2)")}}function b(e,r){var a="el"+e;var i="el"+r;if(t.length>1){var o="__l"+ ++c;y(o,[a,i],false,["comp=",v("ptr0"),"-",v("ptr1"),"\n","if(comp>0){tmp0=",a,";",a,"=",i,";",i,"=tmp0;break ",o,"}\n","if(comp<0){break ",o,"}"].join(""))}else{n.push(["if(",v(d(a)),">",v(d(i)),"){tmp0=",a,";",a,"=",i,";",i,"=tmp0}"].join(""))}}b(1,2);b(4,5);b(1,3);b(2,3);b(1,4);b(3,4);b(2,5);b(2,3);b(4,5);if(t.length>1){m(["el1","el2","el3","el4","el5","index1","index3","index5"],true,["pivot1[pivot_ptr]=",v("ptr1"),"\n","pivot2[pivot_ptr]=",v("ptr3"),"\n","pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])\n","x=",v("ptr0"),"\n","y=",v("ptr2"),"\n","z=",v("ptr4"),"\n",g("ptr5","x"),"\n",g("ptr6","y"),"\n",g("ptr7","z")].join(""))}else{n.push(["pivot1=",v(d("el2")),"\n","pivot2=",v(d("el4")),"\n","pivots_are_equal=pivot1===pivot2\n","x=",v(d("el1")),"\n","y=",v(d("el3")),"\n","z=",v(d("el5")),"\n",g(d("index1"),"x"),"\n",g(d("index3"),"y"),"\n",g(d("index5"),"z")].join(""))}function _(e,r){if(t.length>1){m([e,r],false,g("ptr0",v("ptr1")))}else{n.push(g(d(e),v(d(r))))}}_("index2","left");_("index4","right");function w(e,r,a){if(t.length>1){var i="__l"+ ++c;y(i,[r],true,[e,"=",v("ptr0"),"-pivot",a,"[pivot_ptr]\n","if(",e,"!==0){break ",i,"}"].join(""))}else{n.push([e,"=",v(d(r)),"-pivot",a].join(""))}}function k(e,r){if(t.length>1){m([e,r],false,["tmp=",v("ptr0"),"\n",g("ptr0",v("ptr1")),"\n",g("ptr1","tmp")].join(""))}else{n.push(["ptr0=",d(e),"\n","ptr1=",d(r),"\n","tmp=",v("ptr0"),"\n",g("ptr0",v("ptr1")),"\n",g("ptr1","tmp")].join(""))}}function M(e,r,a){if(t.length>1){m([e,r,a],false,["tmp=",v("ptr0"),"\n",g("ptr0",v("ptr1")),"\n",g("ptr1",v("ptr2")),"\n",g("ptr2","tmp")].join(""));n.push("++"+r,"--"+a)}else{n.push(["ptr0=",d(e),"\n","ptr1=",d(r),"\n","ptr2=",d(a),"\n","++",r,"\n","--",a,"\n","tmp=",v("ptr0"),"\n",g("ptr0",v("ptr1")),"\n",g("ptr1",v("ptr2")),"\n",g("ptr2","tmp")].join(""))}}function A(t,e){k(t,e);n.push("--"+e)}n.push("if(pivots_are_equal){");n.push("for(k=less;k<=great;++k){");w("comp","k",1);n.push("if(comp===0){continue}");n.push("if(comp<0){");n.push("if(k!==less){");k("k","less");n.push("}");n.push("++less");n.push("}else{");n.push("while(true){");w("comp","great",1);n.push("if(comp>0){");n.push("great--");n.push("}else if(comp<0){");M("k","less","great");n.push("break");n.push("}else{");A("k","great");n.push("break");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}else{");n.push("for(k=less;k<=great;++k){");w("comp_pivot1","k",1);n.push("if(comp_pivot1<0){");n.push("if(k!==less){");k("k","less");n.push("}");n.push("++less");n.push("}else{");w("comp_pivot2","k",2);n.push("if(comp_pivot2>0){");n.push("while(true){");w("comp","great",2);n.push("if(comp>0){");n.push("if(--great<k){break}");n.push("continue");n.push("}else{");w("comp","great",1);n.push("if(comp<0){");M("k","less","great");n.push("}else{");A("k","great");n.push("}");n.push("break");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");function T(e,r,a){if(t.length>1){m([e,r],true,[g("ptr0",v("ptr1")),"\n",g("ptr1",["pivot",a,"[pivot_ptr]"].join(""))].join(""))}else{n.push(g(d(e),v(d(r))),g(d(r),"pivot"+a))}}T("left","(less-1)",1);T("right","(great+1)",2);function S(e,r){n.push(["if((",r,"-",e,")<=",a,"){\n","insertionSort(",e,",",r,",data,offset,",o(t.length).join(","),")\n","}else{\n",s,"(",e,",",r,",data,offset,",o(t.length).join(","),")\n","}"].join(""))}S("left","(less-2)");S("(great+2)","right");n.push("if(pivots_are_equal){");x();n.push("return");n.push("}");function E(e,r,a){if(t.length>1){n.push(["__l",++c,":while(true){"].join(""));m([e],true,["if(",v("ptr0"),"!==pivot",r,"[pivot_ptr]){break __l",c,"}"].join(""));n.push(a,"}")}else{n.push(["while(",v(d(e)),"===pivot",r,"){",a,"}"].join(""))}}n.push("if(less<index1&&great>index5){");E("less",1,"++less");E("great",2,"--great");n.push("for(k=less;k<=great;++k){");w("comp_pivot1","k",1);n.push("if(comp_pivot1===0){");n.push("if(k!==less){");k("k","less");n.push("}");n.push("++less");n.push("}else{");w("comp_pivot2","k",2);n.push("if(comp_pivot2===0){");n.push("while(true){");w("comp","great",2);n.push("if(comp===0){");n.push("if(--great<k){break}");n.push("continue");n.push("}else{");w("comp","great",1);n.push("if(comp<0){");M("k","less","great");n.push("}else{");A("k","great");n.push("}");n.push("break");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");x();S("less","great");n.push("}return "+s);if(t.length>1&&u){var C=new Function("insertionSort","malloc","free",n.join("\n"));return C(r,u[0],u[1])}var C=new Function("insertionSort",n.join("\n"));return C(r)}function u(t,e){var r=["'use strict'"];var n=["ndarraySortWrapper",t.join("d"),e].join("");var i=["array"];r.push(["function ",n,"(",i.join(","),"){"].join(""));var u=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"];for(var c=0;c<t.length;++c){u.push(["s",c,"=stride[",c,"]|0,n",c,"=shape[",c,"]|0"].join(""))}var f=new Array(t.length);var h=[];for(var c=0;c<t.length;++c){var p=t[c];if(p===0){continue}if(h.length===0){f[p]="1"}else{f[p]=h.join("*")}h.push("n"+p)}var d=-1,v=-1;for(var c=0;c<t.length;++c){var g=t[c];if(g!==0){if(d>0){u.push(["d",g,"=s",g,"-d",d,"*n",d].join(""))}else{u.push(["d",g,"=s",g].join(""))}d=g}var p=t.length-1-c;if(p!==0){if(v>0){u.push(["e",p,"=s",p,"-e",v,"*n",v,",f",p,"=",f[p],"-f",v,"*n",v].join(""))}else{u.push(["e",p,"=s",p,",f",p,"=",f[p]].join(""))}v=p}}r.push("var "+u.join(","));var m=["0","n0-1","data","offset"].concat(o(t.length));r.push(["if(n0<=",a,"){","insertionSort(",m.join(","),")}else{","quickSort(",m.join(","),")}"].join(""));r.push("}return "+n);var y=new Function("insertionSort","quickSort",r.join("\n"));var x=s(t,e);var b=l(t,e,x);return y(x,b)}e.exports=u},{"typedarray-pool":507}],415:[function(t,e,r){"use strict";var n=t("./lib/compile_sort.js");var a={};function i(t){var e=t.order;var r=t.dtype;var i=[e,r];var o=i.join(":");var s=a[o];if(!s){a[o]=s=n(e,r)}s(t);return t}e.exports=i},{"./lib/compile_sort.js":414}],416:[function(t,e,r){"use strict";var n=t("ndarray-linear-interpolate");var a=t("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=new Array(_inline_3_arg4_)}",args:[{name:"_inline_3_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_3_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_3_arg2_",lvalue:false,rvalue:false,count:0},{name:"_inline_3_arg3_",lvalue:false,rvalue:false,count:0},{name:"_inline_3_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_4_arg2_(this_warped,_inline_4_arg0_),_inline_4_arg1_=_inline_4_arg3_.apply(void 0,this_warped)}",args:[{name:"_inline_4_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_4_arg1_",lvalue:true,rvalue:false,count:1},{name:"_inline_4_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_4_arg3_",lvalue:false,rvalue:true,count:1},{name:"_inline_4_arg4_",lvalue:false,rvalue:false,count:0}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:false,funcName:"warpND",blockSize:64});var i=t("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_7_arg2_(this_warped,_inline_7_arg0_),_inline_7_arg1_=_inline_7_arg3_(_inline_7_arg4_,this_warped[0])}",args:[{name:"_inline_7_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_7_arg1_",lvalue:true,rvalue:false,count:1},{name:"_inline_7_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_7_arg3_",lvalue:false,rvalue:true,count:1},{name:"_inline_7_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:false,funcName:"warp1D",blockSize:64});var o=t("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_10_arg2_(this_warped,_inline_10_arg0_),_inline_10_arg1_=_inline_10_arg3_(_inline_10_arg4_,this_warped[0],this_warped[1])}",args:[{name:"_inline_10_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_10_arg1_",lvalue:true,rvalue:false,count:1},{name:"_inline_10_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_10_arg3_",lvalue:false,rvalue:true,count:1},{name:"_inline_10_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:false,funcName:"warp2D",blockSize:64});var s=t("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_13_arg2_(this_warped,_inline_13_arg0_),_inline_13_arg1_=_inline_13_arg3_(_inline_13_arg4_,this_warped[0],this_warped[1],this_warped[2])}",args:[{name:"_inline_13_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_13_arg1_",lvalue:true,rvalue:false,count:1},{name:"_inline_13_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_13_arg3_",lvalue:false,rvalue:true,count:1},{name:"_inline_13_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:false,funcName:"warp3D",blockSize:64});e.exports=function t(e,r,l){switch(r.shape.length){case 1:i(e,l,n.d1,r);break;case 2:o(e,l,n.d2,r);break;case 3:s(e,l,n.d3,r);break;default:a(e,l,n.bind(undefined,r),r.shape.length);break}return e}},{"cwise/lib/wrapper":136,"ndarray-linear-interpolate":410}],417:[function(t,e,r){var n=t("iota-array");var a=t("is-buffer");var i=typeof Float64Array!=="undefined";function o(t,e){return t[0]-e[0]}function s(){var t=this.stride;var e=new Array(t.length);var r;for(r=0;r<e.length;++r){e[r]=[Math.abs(t[r]),r]}e.sort(o);var n=new Array(e.length);for(r=0;r<n.length;++r){n[r]=e[r][1]}return n}function l(t,e){var r=["View",e,"d",t].join("");if(e<0){r="View_Nil"+t}var a=t==="generic";if(e===-1){var i="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}";var o=new Function(i);return o()}else if(e===0){var i="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(a?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(a?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}";var o=new Function("TrivialArray",i);return o(c[t][0])}var i=["'use strict'"];var l=n(e);var u=l.map(function(t){return"i"+t});var f="this.offset+"+l.map(function(t){return"this.stride["+t+"]*i"+t}).join("+");var h=l.map(function(t){return"b"+t}).join(",");var p=l.map(function(t){return"c"+t}).join(",");i.push("function "+r+"(a,"+h+","+p+",d){this.data=a","this.shape=["+h+"]","this.stride=["+p+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+t+"'","proto.dimension="+e);i.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+l.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})");if(e===1){i.push("proto.order=[0]")}else{i.push("Object.defineProperty(proto,'order',{get:");if(e<4){i.push("function "+r+"_order(){");if(e===2){i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})")}else if(e===3){i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")}}else{i.push("ORDER})")}}i.push("proto.set=function "+r+"_set("+u.join(",")+",v){");if(a){i.push("return this.data.set("+f+",v)}")}else{i.push("return this.data["+f+"]=v}")}i.push("proto.get=function "+r+"_get("+u.join(",")+"){");if(a){i.push("return this.data.get("+f+")}")}else{i.push("return this.data["+f+"]}")}i.push("proto.index=function "+r+"_index(",u.join(),"){return "+f+"}");i.push("proto.hi=function "+r+"_hi("+u.join(",")+"){return new "+r+"(this.data,"+l.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+l.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var d=l.map(function(t){return"a"+t+"=this.shape["+t+"]"});var v=l.map(function(t){return"c"+t+"=this.stride["+t+"]"});i.push("proto.lo=function "+r+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+v.join(","));for(var g=0;g<e;++g){i.push("if(typeof i"+g+"==='number'&&i"+g+">=0){d=i"+g+"|0;b+=c"+g+"*d;a"+g+"-=d}")}i.push("return new "+r+"(this.data,"+l.map(function(t){return"a"+t}).join(",")+","+l.map(function(t){return"c"+t}).join(",")+",b)}");i.push("proto.step=function "+r+"_step("+u.join(",")+"){var "+l.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+l.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var g=0;g<e;++g){i.push("if(typeof i"+g+"==='number'){d=i"+g+"|0;if(d<0){c+=b"+g+"*(a"+g+"-1);a"+g+"=ceil(-a"+g+"/d)}else{a"+g+"=ceil(a"+g+"/d)}b"+g+"*=d}")}i.push("return new "+r+"(this.data,"+l.map(function(t){return"a"+t}).join(",")+","+l.map(function(t){return"b"+t}).join(",")+",c)}");var m=new Array(e);var y=new Array(e);for(var g=0;g<e;++g){m[g]="a[i"+g+"]";y[g]="b[i"+g+"]"}i.push("proto.transpose=function "+r+"_transpose("+u+"){"+u.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+m.join(",")+","+y.join(",")+",this.offset)}");i.push("proto.pick=function "+r+"_pick("+u+"){var a=[],b=[],c=this.offset");for(var g=0;g<e;++g){i.push("if(typeof i"+g+"==='number'&&i"+g+">=0){c=(c+this.stride["+g+"]*i"+g+")|0}else{a.push(this.shape["+g+"]);b.push(this.stride["+g+"])}")}i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");i.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+l.map(function(t){return"shape["+t+"]"}).join(",")+","+l.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}");var o=new Function("CTOR_LIST","ORDER",i.join("\n"));return o(c[t],s)}function u(t){if(a(t)){return"buffer"}if(i){switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}}if(Array.isArray(t)){return"array"}return"generic"}var c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var t in c){c[t].push(l(t,-1))}});function f(t,e,r,n){if(t===undefined){var a=c.array[0];return a([])}else if(typeof t==="number"){t=[t]}if(e===undefined){e=[t.length]}var i=e.length;if(r===undefined){r=new Array(i);for(var o=i-1,s=1;o>=0;--o){r[o]=s;s*=e[o]}}if(n===undefined){n=0;for(var o=0;o<i;++o){if(r[o]<0){n-=(e[o]-1)*r[o]}}}var f=u(t);var h=c[f];while(h.length<=i+1){h.push(l(f,h.length-1))}var a=h[i+1];return a(t,e,r,n)}e.exports=f},{"iota-array":384,"is-buffer":386}],418:[function(t,e,r){"use strict";var n=t("double-bits");var a=Math.pow(2,-1074);var i=-1>>>0;e.exports=o;function o(t,e){if(isNaN(t)||isNaN(e)){return NaN}if(t===e){return t}if(t===0){if(e<0){return-a}else{return a}}var r=n.hi(t);var o=n.lo(t);if(e>t===t>0){if(o===i){r+=1;o=0}else{o+=1}}else{if(o===0){o=i;r-=1}else{o-=1}}return n.pack(o,r)}},{"double-bits":151}],419:[function(t,e,r){var n=Math.PI;var a=c(120);e.exports=i;function i(t){var e;var r=[];var n=0;var a=0;var i=0;var u=0;var f=null;var h=null;var p=0;var d=0;for(var v=0,g=t.length;v<g;v++){var m=t[v];var y=m[0];switch(y){case"M":i=m[1];u=m[2];break;case"A":m=l(p,d,m[1],m[2],c(m[3]),m[4],m[5],m[6],m[7]);m.unshift("C");if(m.length>7){r.push(m.splice(0,7));m.unshift("C")}break;case"S":var x=p;var b=d;if(e=="C"||e=="S"){x+=x-n;b+=b-a}m=["C",x,b,m[1],m[2],m[3],m[4]];break;case"T":if(e=="Q"||e=="T"){f=p*2-f;h=d*2-h}else{f=p;h=d}m=s(p,d,f,h,m[1],m[2]);break;case"Q":f=m[1];h=m[2];m=s(p,d,m[1],m[2],m[3],m[4]);break;case"L":m=o(p,d,m[1],m[2]);break;case"H":m=o(p,d,m[1],d);break;case"V":m=o(p,d,p,m[1]);break;case"Z":m=o(p,d,i,u);break}e=y;p=m[m.length-2];d=m[m.length-1];if(m.length>4){n=m[m.length-4];a=m[m.length-3]}else{n=p;a=d}r.push(m)}return r}function o(t,e,r,n){return["C",t,e,r,n,r,n]}function s(t,e,r,n,a,i){return["C",t/3+2/3*r,e/3+2/3*n,a/3+2/3*r,i/3+2/3*n,a,i]}function l(t,e,r,i,o,s,c,f,h,p){if(!p){var d=u(t,e,-o);t=d.x;e=d.y;d=u(f,h,-o);f=d.x;h=d.y;var v=(t-f)/2;var g=(e-h)/2;var m=v*v/(r*r)+g*g/(i*i);if(m>1){m=Math.sqrt(m);r=m*r;i=m*i}var y=r*r;var x=i*i;var b=(s==c?-1:1)*Math.sqrt(Math.abs((y*x-y*g*g-x*v*v)/(y*g*g+x*v*v)));if(b==Infinity)b=1;var _=b*r*g/i+(t+f)/2;var w=b*-i*v/r+(e+h)/2;var k=Math.asin(((e-w)/i).toFixed(9));var M=Math.asin(((h-w)/i).toFixed(9));k=t<_?n-k:k;M=f<_?n-M:M;if(k<0)k=n*2+k;if(M<0)M=n*2+M;if(c&&k>M)k=k-n*2;if(!c&&M>k)M=M-n*2}else{k=p[0];M=p[1];_=p[2];w=p[3]}if(Math.abs(M-k)>a){var A=M;var T=f;var S=h;M=k+a*(c&&M>k?1:-1);f=_+r*Math.cos(M);h=w+i*Math.sin(M);var E=l(f,h,r,i,o,0,c,T,S,[M,A,_,w])}var C=Math.tan((M-k)/4);var L=4/3*r*C;var I=4/3*i*C;var z=[2*t-(t+L*Math.sin(k)),2*e-(e-I*Math.cos(k)),f+L*Math.sin(M),h-I*Math.cos(M),f,h];if(p)return z;if(E)z=z.concat(E);for(var P=0;P<z.length;){var O=u(z[P],z[P+1],o);z[P++]=O.x;z[P++]=O.y}return z}function u(t,e,r){return{x:t*Math.cos(r)-e*Math.sin(r),y:t*Math.sin(r)+e*Math.cos(r)}}function c(t){return t*(n/180)}},{}],420:[function(t,e,r){var n=1e-6;var a=1e-6;r.vertexNormals=function(t,e,r){var a=e.length;var i=new Array(a);var o=r===void 0?n:r;for(var s=0;s<a;++s){i[s]=[0,0,0]}for(var s=0;s<t.length;++s){var l=t[s];var u=0;var c=l[l.length-1];var f=l[0];for(var h=0;h<l.length;++h){u=c;c=f;f=l[(h+1)%l.length];var p=e[u];var d=e[c];var v=e[f];var g=new Array(3);var m=0;var y=new Array(3);var x=0;for(var b=0;b<3;++b){g[b]=p[b]-d[b];m+=g[b]*g[b];y[b]=v[b]-d[b];x+=y[b]*y[b]}if(m*x>o){var _=i[c];var w=1/Math.sqrt(m*x);for(var b=0;b<3;++b){var k=(b+1)%3;var M=(b+2)%3;_[b]+=w*(y[k]*g[M]-y[M]*g[k])}}}}for(var s=0;s<a;++s){var _=i[s];var A=0;for(var b=0;b<3;++b){A+=_[b]*_[b]}if(A>o){var w=1/Math.sqrt(A);for(var b=0;b<3;++b){_[b]*=w}}else{for(var b=0;b<3;++b){_[b]=0}}}return i};r.faceNormals=function(t,e,r){var n=t.length;var i=new Array(n);var o=r===void 0?a:r;for(var s=0;s<n;++s){var l=t[s];var u=new Array(3);for(var c=0;c<3;++c){u[c]=e[l[c]]}var f=new Array(3);var h=new Array(3);for(var c=0;c<3;++c){f[c]=u[1][c]-u[0][c];h[c]=u[2][c]-u[0][c]}var p=new Array(3);var d=0;for(var c=0;c<3;++c){var v=(c+1)%3;var g=(c+2)%3;p[c]=f[v]*h[g]-f[g]*h[v];d+=p[c]*p[c]}if(d>o){d=1/Math.sqrt(d)}else{d=0}for(var c=0;c<3;++c){p[c]*=d}i[s]=p}return i}},{}],421:[function(t,e,r){"use strict";var n=Object.getOwnPropertySymbols;var a=Object.prototype.hasOwnProperty;var i=Object.prototype.propertyIsEnumerable;function o(t){if(t===null||t===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(t)}function s(){try{if(!Object.assign){return false}var t=new String("abc");t[5]="de";if(Object.getOwnPropertyNames(t)[0]==="5"){return false}var e={};for(var r=0;r<10;r++){e["_"+String.fromCharCode(r)]=r}var n=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if(n.join("")!=="0123456789"){return false}var a={};"abcdefghijklmnopqrst".split("").forEach(function(t){a[t]=t});if(Object.keys(Object.assign({},a)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(t){return false}}e.exports=s()?Object.assign:function(t,e){var r;var s=o(t);var l;for(var u=1;u<arguments.length;u++){r=Object(arguments[u]);for(var c in r){if(a.call(r,c)){s[c]=r[c]}}if(n){l=n(r);for(var f=0;f<l.length;f++){if(i.call(r,l[f])){s[l[f]]=r[l[f]]}}}}return s}},{}],422:[function(t,e,r){"use strict";e.exports=n;function n(t,e,r,n,a,i,o,s,l,u){var c=e+i+u;if(f>0){var f=Math.sqrt(c+1);t[0]=.5*(o-l)/f;t[1]=.5*(s-n)/f;t[2]=.5*(r-i)/f;t[3]=.5*f}else{var h=Math.max(e,i,u);var f=Math.sqrt(2*h-c+1);if(e>=h){t[0]=.5*f;t[1]=.5*(a+r)/f;t[2]=.5*(s+n)/f;t[3]=.5*(o-l)/f}else if(i>=h){t[0]=.5*(r+a)/f;t[1]=.5*f;t[2]=.5*(l+o)/f;t[3]=.5*(s-n)/f}else{t[0]=.5*(n+s)/f;t[1]=.5*(o+l)/f;t[2]=.5*f;t[3]=.5*(r-a)/f}}return t}},{}],423:[function(t,e,r){"use strict";e.exports=p;var n=t("filtered-vector");var a=t("gl-mat4/lookAt");var i=t("gl-mat4/fromQuat");var o=t("gl-mat4/invert");var s=t("./lib/quatFromFrame");function l(t,e,r){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2)+Math.pow(r,2))}function u(t,e,r,n){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2)+Math.pow(r,2)+Math.pow(n,2))}function c(t,e){var r=e[0];var n=e[1];var a=e[2];var i=e[3];var o=u(r,n,a,i);if(o>1e-6){t[0]=r/o;t[1]=n/o;t[2]=a/o;t[3]=i/o}else{t[0]=t[1]=t[2]=0;t[3]=1}}function f(t,e,r){this.radius=n([r]);this.center=n(e);this.rotation=n(t);this.computedRadius=this.radius.curve(0);this.computedCenter=this.center.curve(0);this.computedRotation=this.rotation.curve(0);this.computedUp=[.1,0,0];this.computedEye=[.1,0,0];this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.recalcMatrix(0)}var h=f.prototype;h.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())};h.recalcMatrix=function(t){this.radius.curve(t);this.center.curve(t);this.rotation.curve(t);var e=this.computedRotation;c(e,e);var r=this.computedMatrix;i(r,e);var n=this.computedCenter;var a=this.computedEye;var o=this.computedUp;var s=Math.exp(this.computedRadius[0]);a[0]=n[0]+s*r[2];a[1]=n[1]+s*r[6];a[2]=n[2]+s*r[10];o[0]=r[1];o[1]=r[5];o[2]=r[9];for(var l=0;l<3;++l){var u=0;for(var f=0;f<3;++f){u+=r[l+4*f]*a[f]}r[12+l]=-u}};h.getMatrix=function(t,e){this.recalcMatrix(t);var r=this.computedMatrix;if(e){for(var n=0;n<16;++n){e[n]=r[n]}return e}return r};h.idle=function(t){this.center.idle(t);this.radius.idle(t);this.rotation.idle(t)};h.flush=function(t){this.center.flush(t);this.radius.flush(t);this.rotation.flush(t)};h.pan=function(t,e,r,n){e=e||0;r=r||0;n=n||0;this.recalcMatrix(t);var a=this.computedMatrix;var i=a[1];var o=a[5];var s=a[9];var u=l(i,o,s);i/=u;o/=u;s/=u;var c=a[0];var f=a[4];var h=a[8];var p=c*i+f*o+h*s;c-=i*p;f-=o*p;h-=s*p;var d=l(c,f,h);c/=d;f/=d;h/=d;var v=a[2];var g=a[6];var m=a[10];var y=v*i+g*o+m*s;var x=v*c+g*f+m*h;v-=y*i+x*c;g-=y*o+x*f;m-=y*s+x*h;var b=l(v,g,m);v/=b;g/=b;m/=b;var _=c*e+i*r;var w=f*e+o*r;var k=h*e+s*r;this.center.move(t,_,w,k);var M=Math.exp(this.computedRadius[0]);M=Math.max(1e-4,M+n);this.radius.set(t,Math.log(M))};h.rotate=function(t,e,r,n){this.recalcMatrix(t);e=e||0;r=r||0;var a=this.computedMatrix;var i=a[0];var o=a[4];var s=a[8];var c=a[1];var f=a[5];var h=a[9];var p=a[2];var d=a[6];var v=a[10];var g=e*i+r*c;var m=e*o+r*f;var y=e*s+r*h;var x=-(d*y-v*m);var b=-(v*g-p*y);var _=-(p*m-d*g);var w=Math.sqrt(Math.max(0,1-Math.pow(x,2)-Math.pow(b,2)-Math.pow(_,2)));var k=u(x,b,_,w);if(k>1e-6){x/=k;b/=k;_/=k;w/=k}else{x=b=_=0;w=1}var M=this.computedRotation;var A=M[0];var T=M[1];var S=M[2];var E=M[3];var C=A*w+E*x+T*_-S*b;var L=T*w+E*b+S*x-A*_;var I=S*w+E*_+A*b-T*x;var z=E*w-A*x-T*b-S*_;if(n){x=p;b=d;_=v;var P=Math.sin(n)/l(x,b,_);x*=P;b*=P;_*=P;w=Math.cos(e);C=C*w+z*x+L*_-I*b;L=L*w+z*b+I*x-C*_;I=I*w+z*_+C*b-L*x;z=z*w-C*x-L*b-I*_}var O=u(C,L,I,z);if(O>1e-6){C/=O;L/=O;I/=O;z/=O}else{C=L=I=0;z=1}this.rotation.set(t,C,L,I,z)};h.lookAt=function(t,e,r,n){this.recalcMatrix(t);r=r||this.computedCenter;e=e||this.computedEye;n=n||this.computedUp;var i=this.computedMatrix;a(i,e,r,n);var o=this.computedRotation;s(o,i[0],i[1],i[2],i[4],i[5],i[6],i[8],i[9],i[10]);c(o,o);this.rotation.set(t,o[0],o[1],o[2],o[3]);var l=0;for(var u=0;u<3;++u){l+=Math.pow(r[u]-e[u],2)}this.radius.set(t,.5*Math.log(Math.max(l,1e-6)));this.center.set(t,r[0],r[1],r[2])};h.translate=function(t,e,r,n){this.center.move(t,e||0,r||0,n||0)};h.setMatrix=function(t,e){var r=this.computedRotation;s(r,e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10]);c(r,r);this.rotation.set(t,r[0],r[1],r[2],r[3]);var n=this.computedMatrix;o(n,e);var a=n[15];if(Math.abs(a)>1e-6){var i=n[12]/a;var l=n[13]/a;var u=n[14]/a;this.recalcMatrix(t);var f=Math.exp(this.computedRadius[0]);this.center.set(t,i-n[2]*f,l-n[6]*f,u-n[10]*f);this.radius.idle(t)}else{this.center.idle(t);this.radius.idle(t)}};h.setDistance=function(t,e){if(e>0){this.radius.set(t,Math.log(e))}};h.setDistanceLimits=function(t,e){if(t>0){t=Math.log(t)}else{t=-Infinity}if(e>0){e=Math.log(e)}else{e=Infinity}e=Math.max(e,t);this.radius.bounds[0][0]=t;this.radius.bounds[1][0]=e};h.getDistanceLimits=function(t){var e=this.radius.bounds;if(t){t[0]=Math.exp(e[0][0]);t[1]=Math.exp(e[1][0]);return t}return[Math.exp(e[0][0]),Math.exp(e[1][0])]};h.toJSON=function(){this.recalcMatrix(this.lastT());return{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}};h.fromJSON=function(t){var e=this.lastT();var r=t.center;if(r){this.center.set(e,r[0],r[1],r[2])}var n=t.rotation;if(n){this.rotation.set(e,n[0],n[1],n[2],n[3])}var a=t.distance;if(a&&a>0){this.radius.set(e,Math.log(a))}this.setDistanceLimits(t.zoomMin,t.zoomMax)};function p(t){t=t||{};var e=t.center||[0,0,0];var r=t.rotation||[0,0,0,1];var n=t.radius||1;e=[].slice.call(e,0,3);r=[].slice.call(r,0,4);c(r,r);var a=new f(r,e,Math.log(n));a.setDistanceLimits(t.zoomMin,t.zoomMax);if("eye"in t||"up"in t){a.lookAt(0,t.eye,t.center,t.up)}return a}},{"./lib/quatFromFrame":422,"filtered-vector":215,"gl-mat4/fromQuat":251,"gl-mat4/invert":254,"gl-mat4/lookAt":255}],424:[function(t,e,r){"use strict";var n=t("repeat-string");e.exports=function t(e,r,a){a=typeof a!=="undefined"?a+"":" ";return n(a,r)+e}},{"repeat-string":464}],425:[function(t,e,r){"use strict";function n(t,e){if(typeof t!=="string")return[t];var r=[t];if(typeof e==="string"||Array.isArray(e)){e={brackets:e}}else if(!e)e={};var n=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"];var a=e.escape||"___";var i=!!e.flat;n.forEach(function(t){var e=new RegExp(["\\",t[0],"[^\\",t[0],"\\",t[1],"]*\\",t[1]].join(""));var n=[];function i(e,i,o){var s=r.push(e.slice(t[0].length,-t[1].length))-1;n.push(s);return a+s}r.forEach(function(t,n){var a;var o=0;while(t!=a){a=t;t=t.replace(e,i);if(o++>1e4)throw Error("References have circular dependency. Please, check them.")}r[n]=t});n=n.reverse();r=r.map(function(e){n.forEach(function(r){e=e.replace(new RegExp("(\\"+a+r+"(?![0-9]))","g"),t[0]+"$1"+t[1])});return e})});var o=new RegExp("\\"+a+"([0-9]+)");function s(t,e,r){var n=[],a;var i=0;while(a=o.exec(t)){if(i++>1e4)throw Error("Circular references in parenthesis");n.push(t.slice(0,a.index));n.push(s(e[a[1]],e));t=t.slice(a.index+a[0].length)}n.push(t);return n}return i?r:s(r[0],r)}function a(t,e){if(e&&e.flat){var r=e&&e.escape||"___";var n=t[0],a;if(!n)return"";var i=new RegExp("\\"+r+"([0-9]+)");var o=0;while(n!=a){if(o++>1e4)throw Error("Circular references in "+t);a=n;n=n.replace(i,s)}return n}return t.reduce(function t(e,r){if(Array.isArray(r)){r=r.reduce(t,"")}return e+r},"");function s(e,r){if(t[r]==null)throw Error("Reference "+r+"is undefined");return t[r]}}function i(t,e){if(Array.isArray(t)){return a(t,e)}else{return n(t,e)}}i.parse=n;i.stringify=a;e.exports=i},{}],426:[function(t,e,r){"use strict";var n=t("pick-by-alias");e.exports=a;function a(t){var e;if(arguments.length>1){t=arguments}if(typeof t==="string"){t=t.split(/\s/).map(parseFloat)}else if(typeof t==="number"){t=[t]}if(t.length&&typeof t[0]==="number"){if(t.length===1){e={width:t[0],height:t[0],x:0,y:0}}else if(t.length===2){e={width:t[0],height:t[1],x:0,y:0}}else{e={x:t[0],y:t[1],width:t[2]-t[0]||0,height:t[3]-t[1]||0}}}else if(t){t=n(t,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"});e={x:t.left||0,y:t.top||0};if(t.width==null){if(t.right)e.width=t.right-e.x;else e.width=0}else{e.width=t.width}if(t.height==null){if(t.bottom)e.height=t.bottom-e.y;else e.height=0}else{e.height=t.height}}return e}},{"pick-by-alias":432}],427:[function(t,e,r){e.exports=i;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};var a=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function i(t){var e=[];t.replace(a,function(t,r,a){var i=r.toLowerCase();a=s(a);if(i=="m"&&a.length>2){e.push([r].concat(a.splice(0,2)));i="l";r=r=="m"?"l":"L"}while(true){if(a.length==n[i]){a.unshift(r);return e.push(a)}if(a.length<n[i])throw new Error("malformed path data");e.push([r].concat(a.splice(0,n[i])))}});return e}var o=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function s(t){var e=t.match(o);return e?e.map(Number):[]}},{}],428:[function(t,e,r){e.exports=function t(e,r){if(!r)r=[0,""];e=String(e);var n=parseFloat(e,10);r[0]=n;r[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"";return r}},{}],429:[function(t,e,r){(function(t){(function(){var r,n,a,i,o,s;if(typeof performance!=="undefined"&&performance!==null&&performance.now){e.exports=function(){return performance.now()}}else if(typeof t!=="undefined"&&t!==null&&t.hrtime){e.exports=function(){return(r()-o)/1e6};n=t.hrtime;r=function(){var t;t=n();return t[0]*1e9+t[1]};i=r();s=t.uptime()*1e9;o=i-s}else if(Date.now){e.exports=function(){return Date.now()-a};a=Date.now()}else{e.exports=function(){return(new Date).getTime()-a};a=(new Date).getTime()}}).call(this)}).call(this,t("_process"))},{_process:449}],430:[function(t,e,r){"use strict";e.exports=i;var n=32;var a=t("typedarray-pool");function i(t){var e=t.length;if(e<n){var r=1;for(var i=0;i<e;++i){for(var o=0;o<i;++o){if(t[i]<t[o]){r=-r}else if(t[i]===t[o]){return 0}}}return r}else{var s=a.mallocUint8(e);for(var i=0;i<e;++i){s[i]=0}var r=1;for(var i=0;i<e;++i){if(!s[i]){var l=1;s[i]=1;for(var o=t[i];o!==i;o=t[o]){if(s[o]){a.freeUint8(s);return 0}l+=1;s[o]=1}if(!(l&1)){r=-r}}}a.freeUint8(s);return r}}},{"typedarray-pool":507}],431:[function(t,e,r){"use strict";var n=t("typedarray-pool");var a=t("invert-permutation");function i(t){var e=t.length;switch(e){case 0:case 1:return 0;case 2:return t[1];default:break}var r=n.mallocUint32(e);var i=n.mallocUint32(e);var o=0,s,l,u;a(t,i);for(u=0;u<e;++u){r[u]=t[u]}for(u=e-1;u>0;--u){l=i[u];s=r[u];r[u]=r[l];r[l]=s;i[u]=i[s];i[s]=l;o=(o+s)*u}n.freeUint32(i);n.freeUint32(r);return o}function o(t,e,r){switch(t){case 0:if(r){return r}return[];case 1:if(r){r[0]=0;return r}else{return[0]}case 2:if(r){if(e){r[0]=0;r[1]=1}else{r[0]=1;r[1]=0}return r}else{return e?[0,1]:[1,0]}default:break}r=r||new Array(t);var n,a,i,o=1;r[0]=0;for(i=1;i<t;++i){r[i]=i;o=o*i|0}for(i=t-1;i>0;--i){n=e/o|0;e=e-n*o|0;o=o/i|0;a=r[i]|0;r[i]=r[n]|0;r[n]=a|0}return r}r.rank=i;r.unrank=o},{"invert-permutation":383,"typedarray-pool":507}],432:[function(t,e,r){"use strict";e.exports=function t(e,r,n){var i={},o,s;if(typeof r==="string")r=a(r);if(Array.isArray(r)){var l={};for(s=0;s<r.length;s++){l[r[s]]=true}r=l}for(o in r){r[o]=a(r[o])}var u={};for(o in r){var c=r[o];if(Array.isArray(c)){for(s=0;s<c.length;s++){var f=c[s];if(n){u[f]=true}if(f in e){i[o]=e[f];if(n){for(var h=s;h<c.length;h++){u[c[h]]=true}}break}}}else if(o in e){if(r[o]){i[o]=e[o]}if(n){u[o]=true}}}if(n){for(o in e){if(u[o])continue;i[o]=e[o]}}return i};var n={};function a(t){if(n[t])return n[t];if(typeof t==="string"){t=n[t]=t.split(/\s*,\s*|\s+/)}return t}},{}],433:[function(t,e,r){"use strict";e.exports=a;var n=t("compare-angle");function a(t,e){var r=e.length|0;var a=t.length;var i=[new Array(r),new Array(r)];for(var o=0;o<r;++o){i[0][o]=[];i[1][o]=[]}for(var o=0;o<a;++o){var s=t[o];i[0][s[0]].push(s);i[1][s[1]].push(s)}var l=[];for(var o=0;o<r;++o){if(i[0][o].length+i[1][o].length===0){l.push([o])}}function u(t,e){var r=i[e][t[e]];r.splice(r.indexOf(t),1)}function c(t,r,a){var o,s,l;for(var c=0;c<2;++c){if(i[c][r].length>0){o=i[c][r][0];l=c;break}}s=o[l^1];for(var f=0;f<2;++f){var h=i[f][r];for(var p=0;p<h.length;++p){var d=h[p];var v=d[f^1];var g=n(e[t],e[r],e[s],e[v]);if(g>0){o=d;s=v;l=f}}}if(a){return s}if(o){u(o,l)}return s}function f(t,r){var a=i[r][t][0];var o=[t];u(a,r);var s=a[r^1];var l=r;while(true){while(s!==t){o.push(s);s=c(o[o.length-2],s,false)}if(i[0][t].length+i[1][t].length===0){break}var f=o[o.length-1];var h=t;var p=o[1];var d=c(f,h,true);if(n(e[f],e[h],e[p],e[d])<0){break}o.push(t);s=c(f,h)}return o}function h(t,e){return e[1]===e[e.length-1]}for(var o=0;o<r;++o){for(var p=0;p<2;++p){var d=[];while(i[p][o].length>0){var v=i[0][o].length;var g=f(o,p);if(h(d,g)){d.push.apply(d,g)}else{if(d.length>0){l.push(d)}d=g}}if(d.length>0){l.push(d)}}}return l}},{"compare-angle":114}],434:[function(t,e,r){"use strict";e.exports=a;var n=t("edges-to-adjacency-list");function a(t,e){var r=n(t,e.length);var a=new Array(e.length);var i=new Array(e.length);var o=[];for(var s=0;s<e.length;++s){var l=r[s].length;i[s]=l;a[s]=true;if(l<=1){o.push(s)}}while(o.length>0){var u=o.pop();a[u]=false;var c=r[u];for(var s=0;s<c.length;++s){var f=c[s];if(--i[f]===0){o.push(f)}}}var h=new Array(e.length);var p=[];for(var s=0;s<e.length;++s){if(a[s]){var u=p.length;h[s]=u;p.push(e[s])}else{h[s]=-1}}var d=[];for(var s=0;s<t.length;++s){var v=t[s];if(a[v[0]]&&a[v[1]]){d.push([h[v[0]],h[v[1]]])}}return[d,p]}},{"edges-to-adjacency-list":156}],435:[function(t,e,r){"use strict";e.exports=h;var n=t("edges-to-adjacency-list");var a=t("planar-dual");var i=t("point-in-big-polygon");var o=t("two-product");var s=t("robust-sum");var l=t("uniq");var u=t("./lib/trim-leaves");function c(t,e){var r=new Array(t);for(var n=0;n<t;++n){r[n]=e}return r}function f(t){var e=new Array(t);for(var r=0;r<t;++r){e[r]=[]}return e}function h(t,e){var r=u(t,e);t=r[0];e=r[1];var h=e.length;var p=t.length;var d=n(t,e.length);for(var v=0;v<h;++v){if(d[v].length%2===1){throw new Error("planar-graph-to-polyline: graph must be manifold")}}var g=a(t,e);function m(t){var r=t.length;var n=[0];for(var a=0;a<r;++a){var i=e[t[a]];var l=e[t[(a+1)%r]];var u=o(-i[0],i[1]);var c=o(-i[0],l[1]);var f=o(l[0],i[1]);var h=o(l[0],l[1]);n=s(n,s(s(u,c),s(f,h)))}return n[n.length-1]>0}g=g.filter(m);var y=g.length;var x=new Array(y);var b=new Array(y);for(var v=0;v<y;++v){x[v]=v;var _=new Array(y);var w=g[v].map(function(t){return e[t]});var k=i([w]);var M=0;t:for(var A=0;A<y;++A){_[A]=0;if(v===A){continue}var T=g[A];var S=T.length;for(var E=0;E<S;++E){var C=k(e[T[E]]);if(C!==0){if(C<0){_[A]=1;M+=1}continue t}}_[A]=1;M+=1}b[v]=[M,v,_]}b.sort(function(t,e){return e[0]-t[0]});for(var v=0;v<y;++v){var _=b[v];var L=_[1];var I=_[2];for(var A=0;A<y;++A){if(I[A]){x[A]=L}}}var z=f(y);for(var v=0;v<y;++v){z[v].push(x[v]);z[x[v]].push(v)}var P={};var O=c(h,false);for(var v=0;v<y;++v){var T=g[v];var S=T.length;for(var A=0;A<S;++A){var D=T[A];var R=T[(A+1)%S];var B=Math.min(D,R)+":"+Math.max(D,R);if(B in P){var F=P[B];z[F].push(v);z[v].push(F);O[D]=O[R]=true}else{P[B]=v}}}function N(t){var e=t.length;for(var r=0;r<e;++r){if(!O[t[r]]){return false}}return true}var j=[];var V=c(y,-1);for(var v=0;v<y;++v){if(x[v]===v&&!N(g[v])){j.push(v);V[v]=0}else{V[v]=-1}}var r=[];while(j.length>0){var U=j.pop();var q=z[U];l(q,function(t,e){return t-e});var H=q.length;var G=V[U];var W;if(G===0){var T=g[U];W=[T]}for(var v=0;v<H;++v){var Y=q[v];if(V[Y]>=0){continue}V[Y]=G^1;j.push(Y);if(G===0){var T=g[Y];if(!N(T)){T.reverse();W.push(T)}}}if(G===0){r.push(W)}}return r}},{"./lib/trim-leaves":434,"edges-to-adjacency-list":156,"planar-dual":433,"point-in-big-polygon":439,"robust-sum":476,"two-product":505,uniq:509}],436:[function(t,e,r){"use strict";e.exports=t("./quad")},{"./quad":438}],437:[function(t,e,r){arguments[4][98][0].apply(r,arguments)},{dup:98}],438:[function(t,e,r){"use strict";var n=t("binary-search-bounds");var a=t("clamp");var i=t("parse-rect");var o=t("array-bounds");var s=t("pick-by-alias");var l=t("defined");var u=t("flatten-vertex-data");var c=t("is-obj");var f=t("dtype");var h=t("math-log2");e.exports=function t(e,r){if(!r){r={}}e=u(e,"float64");r=s(r,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var a=l(r.maxDepth,255);var d=l(r.bounds,o(e,2));if(d[0]===d[2]){d[2]++}if(d[1]===d[3]){d[3]++}var v=p(e,d);var g=e.length>>>1;var m;if(!r.dtype){r.dtype="array"}if(typeof r.dtype==="string"){m=new(f(r.dtype))(g)}else if(r.dtype){m=r.dtype;if(Array.isArray(m)){m.length=g}}for(var y=0;y<g;++y){m[y]=y}var x=[];var b=[];var _=[];var w=[];C(0,0,1,m,0,1);var k=0;for(var M=0;M<x.length;M++){var A=x[M];if(m.set){m.set(A,k)}else{for(var T=0,S=A.length;T<S;T++){m[T+k]=A[T]}}var E=k+x[M].length;w[M]=[k,E];k=E}m.range=L;return m;function C(t,e,r,n,i,o){if(!n.length){return null}var s=x[i]||(x[i]=[]);var l=_[i]||(_[i]=[]);var u=b[i]||(b[i]=[]);var c=s.length;i++;if(i>a){for(var f=0;f<n.length;f++){s.push(n[f]);l.push(o);u.push(null,null,null,null)}return c}s.push(n[0]);l.push(o);if(n.length<=1){u.push(null,null,null,null);return c}var h=r*.5;var p=t+h,d=e+h;var g=[],m=[],y=[],w=[];for(var k=1,M=n.length;k<M;k++){var A=n[k],T=v[A*2],S=v[A*2+1];T<p?S<d?g.push(A):m.push(A):S<d?y.push(A):w.push(A)}o<<=2;u.push(C(t,e,h,g,i,o),C(t,d,h,m,i,o+1),C(p,e,h,y,i,o+2),C(p,d,h,w,i,o+3));return c}function L(){var t=[],r=arguments.length;while(r--)t[r]=arguments[r];var n;if(c(t[t.length-1])){var a=t.pop();if(!t.length&&(a.x!=null||a.l!=null||a.left!=null)){t=[a];n={}}n=s(a,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else{n={}}if(!t.length){t=d}var o=i.apply(void 0,t);var u=[Math.min(o.x,o.x+o.width),Math.min(o.y,o.y+o.height),Math.max(o.x,o.x+o.width),Math.max(o.y,o.y+o.height)];var f=u[0];var v=u[1];var g=u[2];var m=u[3];var y=p([f,v,g,m],d);var _=y[0];var w=y[1];var k=y[2];var M=y[3];var A=l(n.level,x.length);if(n.d!=null){var T;if(typeof n.d==="number"){T=[n.d,n.d]}else if(n.d.length){T=n.d}A=Math.min(Math.max(Math.ceil(-h(Math.abs(T[0])/(d[2]-d[0]))),Math.ceil(-h(Math.abs(T[1])/(d[3]-d[1])))),A)}A=Math.min(A,x.length);if(n.lod){return I(_,w,k,M,A)}var S=[];E(0,0,1,0,0,1);function E(t,r,n,a,i,o){if(i===null||o===null){return}var s=t+n;var l=r+n;if(_>s||w>l||k<t||M<r){return}if(a>=A){return}if(i===o){return}var u=x[a];if(o===undefined){o=u.length}for(var c=i;c<o;c++){var h=u[c];var p=e[h*2];var d=e[h*2+1];if(p>=f&&p<=g&&d>=v&&d<=m){S.push(h)}}var y=b[a];var T=y[i*4+0];var L=y[i*4+1];var I=y[i*4+2];var z=y[i*4+3];var P=C(y,i+1);var O=n*.5;var D=a+1;E(t,r,O,D,T,L||I||z||P);E(t,r+O,O,D,L,I||z||P);E(t+O,r,O,D,I,z||P);E(t+O,r+O,O,D,z,P)}function C(t,e){var r=null,n=0;while(r===null){r=t[e*4+n];n++;if(n>t.length){return null}}return r}return S}function I(t,e,r,a,i){var o=[];for(var s=0;s<i;s++){var l=_[s];var u=w[s][0];var c=z(t,e,s);var f=z(r,a,s);var h=n.ge(l,c);var p=n.gt(l,f,h,l.length-1);o[s]=[h+u,p+u]}return o}function z(t,e,r){var n=1;var a=.5,i=.5;var o=.5;for(var s=0;s<r;s++){n<<=2;n+=t<a?e<i?0:1:e<i?2:3;o*=.5;a+=t<a?-o:o;i+=e<i?-o:o}return n}};function p(t,e){var r=e[0];var n=e[1];var i=e[2];var o=e[3];var s=1/(i-r);var l=1/(o-n);var u=new Array(t.length);for(var c=0,f=t.length/2;c<f;c++){u[2*c]=a((t[2*c]-r)*s,0,1);u[2*c+1]=a((t[2*c+1]-n)*l,0,1)}return u}},{"array-bounds":56,"binary-search-bounds":437,clamp:102,defined:148,dtype:153,"flatten-vertex-data":216,"is-obj":389,"math-log2":399,"parse-rect":426,"pick-by-alias":432}],439:[function(t,e,r){e.exports=d;var n=t("robust-orientation")[3];var a=t("slab-decomposition");var i=t("interval-tree-1d");var o=t("binary-search-bounds");function s(){return true}function l(t){return function(e,r){var n=t[e];if(n){return!!n.queryPoint(r,s)}return false}}function u(t){var e={};for(var r=0;r<t.length;++r){var n=t[r];var a=n[0][0];var o=n[0][1];var s=n[1][1];var u=[Math.min(o,s),Math.max(o,s)];if(a in e){e[a].push(u)}else{e[a]=[u]}}var c={};var f=Object.keys(e);for(var r=0;r<f.length;++r){var h=e[f[r]];c[f[r]]=i(h)}return l(c)}function c(t,e){return function(r){var a=o.le(e,r[0]);if(a<0){return 1}var i=t[a];if(!i){if(a>0&&e[a]===r[0]){i=t[a-1]}else{return 1}}var s=1;while(i){var l=i.key;var u=n(r,l[0],l[1]);if(l[0][0]<l[1][0]){if(u<0){i=i.left}else if(u>0){s=-1;i=i.right}else{return 0}}else{if(u>0){i=i.left}else if(u<0){s=1;i=i.right}else{return 0}}}return s}}function f(t){return 1}function h(t){return function e(r){if(t(r[0],r[1])){return 0}return 1}}function p(t,e){return function r(n){if(t(n[0],n[1])){return 0}return e(n)}}function d(t){var e=t.length;var r=[];var n=[];var i=0;for(var o=0;o<e;++o){var s=t[o];var l=s.length;for(var d=l-1,v=0;v<l;d=v++){var g=s[d];var m=s[v];if(g[0]===m[0]){n.push([g,m])}else{r.push([g,m])}}}if(r.length===0){if(n.length===0){return f}else{return h(u(n))}}var y=a(r);var x=c(y.slabs,y.coordinates);if(n.length===0){return x}else{return p(u(n),x)}}},{"binary-search-bounds":79,"interval-tree-1d":382,"robust-orientation":471,"slab-decomposition":487}],440:[function(t,e,r){var n=t("./lib/build-log");var a=t("./lib/epsilon");var i=t("./lib/intersecter");var o=t("./lib/segment-chainer");var s=t("./lib/segment-selector");var l=t("./lib/geojson");var u=false;var c=a();var f;f={buildLog:function(t){if(t===true)u=n();else if(t===false)u=false;return u===false?false:u.list},epsilon:function(t){return c.epsilon(t)},segments:function(t){var e=i(true,c,u);t.regions.forEach(e.addRegion);return{segments:e.calculate(t.inverted),inverted:t.inverted}},combine:function(t,e){var r=i(false,c,u);return{combined:r.calculate(t.segments,t.inverted,e.segments,e.inverted),inverted1:t.inverted,inverted2:e.inverted}},selectUnion:function(t){return{segments:s.union(t.combined,u),inverted:t.inverted1||t.inverted2}},selectIntersect:function(t){return{segments:s.intersect(t.combined,u),inverted:t.inverted1&&t.inverted2}},selectDifference:function(t){return{segments:s.difference(t.combined,u),inverted:t.inverted1&&!t.inverted2}},selectDifferenceRev:function(t){return{segments:s.differenceRev(t.combined,u),inverted:!t.inverted1&&t.inverted2}},selectXor:function(t){return{segments:s.xor(t.combined,u),inverted:t.inverted1!==t.inverted2}},polygon:function(t){return{regions:o(t.segments,c,u),inverted:t.inverted}},polygonFromGeoJSON:function(t){return l.toPolygon(f,t)},polygonToGeoJSON:function(t){return l.fromPolygon(f,c,t)},union:function(t,e){return h(t,e,f.selectUnion)},intersect:function(t,e){return h(t,e,f.selectIntersect)},difference:function(t,e){return h(t,e,f.selectDifference)},differenceRev:function(t,e){return h(t,e,f.selectDifferenceRev)},xor:function(t,e){return h(t,e,f.selectXor)}};function h(t,e,r){var n=f.segments(t);var a=f.segments(e);var i=f.combine(n,a);var o=r(i);return f.polygon(o)}if(typeof window==="object")window.PolyBool=f;e.exports=f},{"./lib/build-log":441,"./lib/epsilon":442,"./lib/geojson":443,"./lib/intersecter":444,"./lib/segment-chainer":446,"./lib/segment-selector":447}],441:[function(t,e,r){function n(){var t;var e=0;var r=false;function n(e,r){t.list.push({type:e,data:r?JSON.parse(JSON.stringify(r)):void 0});return t}t={list:[],segmentId:function(){return e++},checkIntersection:function(t,e){return n("check",{seg1:t,seg2:e})},segmentChop:function(t,e){n("div_seg",{seg:t,pt:e});return n("chop",{seg:t,pt:e})},statusRemove:function(t){return n("pop_seg",{seg:t})},segmentUpdate:function(t){return n("seg_update",{seg:t})},segmentNew:function(t,e){return n("new_seg",{seg:t,primary:e})},segmentRemove:function(t){return n("rem_seg",{seg:t})},tempStatus:function(t,e,r){return n("temp_status",{seg:t,above:e,below:r})},rewind:function(t){return n("rewind",{seg:t})},status:function(t,e,r){return n("status",{seg:t,above:e,below:r})},vert:function(e){if(e===r)return t;r=e;return n("vert",{x:e})},log:function(t){if(typeof t!=="string")t=JSON.stringify(t,false,"  ");return n("log",{txt:t})},reset:function(){return n("reset")},selected:function(t){return n("selected",{segs:t})},chainStart:function(t){return n("chain_start",{seg:t})},chainRemoveHead:function(t,e){return n("chain_rem_head",{index:t,pt:e})},chainRemoveTail:function(t,e){return n("chain_rem_tail",{index:t,pt:e})},chainNew:function(t,e){return n("chain_new",{pt1:t,pt2:e})},chainMatch:function(t){return n("chain_match",{index:t})},chainClose:function(t){return n("chain_close",{index:t})},chainAddHead:function(t,e){return n("chain_add_head",{index:t,pt:e})},chainAddTail:function(t,e){return n("chain_add_tail",{index:t,pt:e})},chainConnect:function(t,e){return n("chain_con",{index1:t,index2:e})},chainReverse:function(t){return n("chain_rev",{index:t})},chainJoin:function(t,e){return n("chain_join",{index1:t,index2:e})},done:function(){return n("done")}};return t}e.exports=n},{}],442:[function(t,e,r){function n(t){if(typeof t!=="number")t=1e-10;var e={epsilon:function(e){if(typeof e==="number")t=e;return t},pointAboveOrOnLine:function(e,r,n){var a=r[0];var i=r[1];var o=n[0];var s=n[1];var l=e[0];var u=e[1];return(o-a)*(u-i)-(s-i)*(l-a)>=-t},pointBetween:function(e,r,n){var a=e[1]-r[1];var i=n[0]-r[0];var o=e[0]-r[0];var s=n[1]-r[1];var l=o*i+a*s;if(l<t)return false;var u=i*i+s*s;if(l-u>-t)return false;return true},pointsSameX:function(e,r){return Math.abs(e[0]-r[0])<t},pointsSameY:function(e,r){return Math.abs(e[1]-r[1])<t},pointsSame:function(t,r){return e.pointsSameX(t,r)&&e.pointsSameY(t,r)},pointsCompare:function(t,r){if(e.pointsSameX(t,r))return e.pointsSameY(t,r)?0:t[1]<r[1]?-1:1;return t[0]<r[0]?-1:1},pointsCollinear:function(e,r,n){var a=e[0]-r[0];var i=e[1]-r[1];var o=r[0]-n[0];var s=r[1]-n[1];return Math.abs(a*s-o*i)<t},linesIntersect:function(e,r,n,a){var i=r[0]-e[0];var o=r[1]-e[1];var s=a[0]-n[0];var l=a[1]-n[1];var u=i*l-o*s;if(Math.abs(u)<t)return false;var c=e[0]-n[0];var f=e[1]-n[1];var h=(s*f-l*c)/u;var p=(i*f-o*c)/u;var d={alongA:0,alongB:0,pt:[e[0]+h*i,e[1]+h*o]};if(h<=-t)d.alongA=-2;else if(h<t)d.alongA=-1;else if(h-1<=-t)d.alongA=0;else if(h-1<t)d.alongA=1;else d.alongA=2;if(p<=-t)d.alongB=-2;else if(p<t)d.alongB=-1;else if(p-1<=-t)d.alongB=0;else if(p-1<t)d.alongB=1;else d.alongB=2;return d},pointInsideRegion:function(e,r){var n=e[0];var a=e[1];var i=r[r.length-1][0];var o=r[r.length-1][1];var s=false;for(var l=0;l<r.length;l++){var u=r[l][0];var c=r[l][1];if(c-a>t!=o-a>t&&(i-u)*(a-c)/(o-c)+u-n>t)s=!s;i=u;o=c}return s}};return e}e.exports=n},{}],443:[function(t,e,r){var n={toPolygon:function(t,e){function r(e){if(e.length<=0)return t.segments({inverted:false,regions:[]});function r(e){var r=e.slice(0,e.length-1);return t.segments({inverted:false,regions:[r]})}var n=r(e[0]);for(var a=1;a<e.length;a++)n=t.selectDifference(t.combine(n,r(e[a])));return n}if(e.type==="Polygon"){return t.polygon(r(e.coordinates))}else if(e.type==="MultiPolygon"){var n=t.segments({inverted:false,regions:[]});for(var a=0;a<e.coordinates.length;a++)n=t.selectUnion(t.combine(n,r(e.coordinates[a])));return t.polygon(n)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(t,e,r){r=t.polygon(t.segments(r));function n(t,r){return e.pointInsideRegion([(t[0][0]+t[1][0])*.5,(t[0][1]+t[1][1])*.5],r)}function a(t){return{region:t,children:[]}}var i=a(null);function o(t,e){for(var r=0;r<t.children.length;r++){var i=t.children[r];if(n(e,i.region)){o(i,e);return}}var s=a(e);for(var r=0;r<t.children.length;r++){var i=t.children[r];if(n(i.region,e)){s.children.push(i);t.children.splice(r,1);r--}}t.children.push(s)}for(var s=0;s<r.regions.length;s++){var l=r.regions[s];if(l.length<3)continue;o(i,l)}function u(t,e){var r=0;var n=t[t.length-1][0];var a=t[t.length-1][1];var i=[];for(var o=0;o<t.length;o++){var s=t[o][0];var l=t[o][1];i.push([s,l]);r+=l*n-s*a;n=s;a=l}var u=r<0;if(u!==e)i.reverse();i.push([i[0][0],i[0][1]]);return i}var c=[];function f(t){var e=[u(t.region,false)];c.push(e);for(var r=0;r<t.children.length;r++)e.push(h(t.children[r]))}function h(t){for(var e=0;e<t.children.length;e++)f(t.children[e]);return u(t.region,true)}for(var s=0;s<i.children.length;s++)f(i.children[s]);if(c.length<=0)return{type:"Polygon",coordinates:[]};if(c.length==1)return{type:"Polygon",coordinates:c[0]};return{type:"MultiPolygon",coordinates:c}}};e.exports=n},{}],444:[function(t,e,r){var n=t("./linked-list");function a(t,e,r){function a(t,e){return{id:r?r.segmentId():-1,start:t,end:e,myFill:{above:null,below:null},otherFill:null}}function i(t,e,n){return{id:r?r.segmentId():-1,start:t,end:e,myFill:{above:n.myFill.above,below:n.myFill.below},otherFill:null}}var o=n.create();function s(t,r,n,a,i,o){var s=e.pointsCompare(r,i);if(s!==0)return s;if(e.pointsSame(n,o))return 0;if(t!==a)return t?1:-1;return e.pointAboveOrOnLine(n,a?i:o,a?o:i)?1:-1}function l(t,e){o.insertBefore(t,function(r){var n=s(t.isStart,t.pt,e,r.isStart,r.pt,r.other.pt);return n<0})}function u(t,e){var r=n.node({isStart:true,pt:t.start,seg:t,primary:e,other:null,status:null});l(r,t.end);return r}function c(t,e,r){var a=n.node({isStart:false,pt:e.end,seg:e,primary:r,other:t,status:null});t.other=a;l(a,t.pt)}function f(t,e){var r=u(t,e);c(r,t,e);return r}function h(t,e){if(r)r.segmentChop(t.seg,e);t.other.remove();t.seg.end=e;t.other.pt=e;l(t.other,t.pt)}function p(t,e){var r=i(e,t.seg.end,t.seg);h(t,e);return f(r,t.primary)}function d(a,i){var s=n.create();function l(t,r){var n=t.seg.start;var a=t.seg.end;var i=r.seg.start;var o=r.seg.end;if(e.pointsCollinear(n,i,o)){if(e.pointsCollinear(a,i,o))return 1;return e.pointAboveOrOnLine(a,i,o)?1:-1}return e.pointAboveOrOnLine(n,i,o)?1:-1}function u(t){return s.findTransition(function(e){var r=l(t,e.ev);return r>0})}function c(t,n){var a=t.seg;var i=n.seg;var o=a.start;var s=a.end;var l=i.start;var u=i.end;if(r)r.checkIntersection(a,i);var c=e.linesIntersect(o,s,l,u);if(c===false){if(!e.pointsCollinear(o,s,l))return false;if(e.pointsSame(o,u)||e.pointsSame(s,l))return false;var f=e.pointsSame(o,l);var h=e.pointsSame(s,u);if(f&&h)return n;var d=!f&&e.pointBetween(o,l,u);var v=!h&&e.pointBetween(s,l,u);if(f){if(v){p(n,s)}else{p(t,u)}return n}else if(d){if(!h){if(v){p(n,s)}else{p(t,u)}}p(n,o)}}else{if(c.alongA===0){if(c.alongB===-1)p(t,l);else if(c.alongB===0)p(t,c.pt);else if(c.alongB===1)p(t,u)}if(c.alongB===0){if(c.alongA===-1)p(n,o);else if(c.alongA===0)p(n,c.pt);else if(c.alongA===1)p(n,s)}}return false}var f=[];while(!o.isEmpty()){var h=o.getHead();if(r)r.vert(h.pt[0]);if(h.isStart){if(r)r.segmentNew(h.seg,h.primary);var d=u(h);var v=d.before?d.before.ev:null;var g=d.after?d.after.ev:null;if(r){r.tempStatus(h.seg,v?v.seg:false,g?g.seg:false)}function m(){if(v){var t=c(h,v);if(t)return t}if(g)return c(h,g);return false}var y=m();if(y){if(t){var x;if(h.seg.myFill.below===null)x=true;else x=h.seg.myFill.above!==h.seg.myFill.below;if(x)y.seg.myFill.above=!y.seg.myFill.above}else{y.seg.otherFill=h.seg.myFill}if(r)r.segmentUpdate(y.seg);h.other.remove();h.remove()}if(o.getHead()!==h){if(r)r.rewind(h.seg);continue}if(t){var x;if(h.seg.myFill.below===null)x=true;else x=h.seg.myFill.above!==h.seg.myFill.below;if(!g){h.seg.myFill.below=a}else{h.seg.myFill.below=g.seg.myFill.above}if(x)h.seg.myFill.above=!h.seg.myFill.below;else h.seg.myFill.above=h.seg.myFill.below}else{if(h.seg.otherFill===null){var b;if(!g){b=h.primary?i:a}else{if(h.primary===g.primary)b=g.seg.otherFill.above;else b=g.seg.myFill.above}h.seg.otherFill={above:b,below:b}}}if(r){r.status(h.seg,v?v.seg:false,g?g.seg:false)}h.other.status=d.insert(n.node({ev:h}))}else{var _=h.status;if(_===null){throw new Error("PolyBool: Zero-length segment detected; your epsilon is "+"probably too small or too large")}if(s.exists(_.prev)&&s.exists(_.next))c(_.prev.ev,_.next.ev);if(r)r.statusRemove(_.ev.seg);_.remove();if(!h.primary){var w=h.seg.myFill;h.seg.myFill=h.seg.otherFill;h.seg.otherFill=w}f.push(h.seg)}o.getHead().remove()}if(r)r.done();return f}if(!t){return{calculate:function(t,e,r,n){t.forEach(function(t){f(i(t.start,t.end,t),true)});r.forEach(function(t){f(i(t.start,t.end,t),false)});return d(e,n)}}}return{addRegion:function(t){var r;var n=t[t.length-1];for(var i=0;i<t.length;i++){r=n;n=t[i];var o=e.pointsCompare(r,n);if(o===0)continue;f(a(o<0?r:n,o<0?n:r),true)}},calculate:function(t){return d(t,false)}}}e.exports=a},{"./linked-list":445}],445:[function(t,e,r){var n={create:function(){var t={root:{root:true,next:null},exists:function(e){if(e===null||e===t.root)return false;return true},isEmpty:function(){return t.root.next===null},getHead:function(){return t.root.next},insertBefore:function(e,r){var n=t.root;var a=t.root.next;while(a!==null){if(r(a)){e.prev=a.prev;e.next=a;a.prev.next=e;a.prev=e;return}n=a;a=a.next}n.next=e;e.prev=n;e.next=null},findTransition:function(e){var r=t.root;var n=t.root.next;while(n!==null){if(e(n))break;r=n;n=n.next}return{before:r===t.root?null:r,after:n,insert:function(t){t.prev=r;t.next=n;r.next=t;if(n!==null)n.prev=t;return t}}}};return t},node:function(t){t.prev=null;t.next=null;t.remove=function(){t.prev.next=t.next;if(t.next)t.next.prev=t.prev;t.prev=null;t.next=null};return t}};e.exports=n},{}],446:[function(t,e,r){function n(t,e,r){var n=[];var a=[];t.forEach(function(t){var i=t.start;var o=t.end;if(e.pointsSame(i,o)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is "+"probably too small or too large");return}if(r)r.chainStart(t);var s={index:0,matches_head:false,matches_pt1:false};var l={index:0,matches_head:false,matches_pt1:false};var u=s;function c(t,e,r){u.index=t;u.matches_head=e;u.matches_pt1=r;if(u===s){u=l;return false}u=null;return true}for(var f=0;f<n.length;f++){var h=n[f];var p=h[0];var d=h[1];var v=h[h.length-1];var g=h[h.length-2];if(e.pointsSame(p,i)){if(c(f,true,true))break}else if(e.pointsSame(p,o)){if(c(f,true,false))break}else if(e.pointsSame(v,i)){if(c(f,false,true))break}else if(e.pointsSame(v,o)){if(c(f,false,false))break}}if(u===s){n.push([i,o]);if(r)r.chainNew(i,o);return}if(u===l){if(r)r.chainMatch(s.index);var m=s.index;var y=s.matches_pt1?o:i;var x=s.matches_head;var h=n[m];var b=x?h[0]:h[h.length-1];var _=x?h[1]:h[h.length-2];var w=x?h[h.length-1]:h[0];var k=x?h[h.length-2]:h[1];if(e.pointsCollinear(_,b,y)){if(x){if(r)r.chainRemoveHead(s.index,y);h.shift()}else{if(r)r.chainRemoveTail(s.index,y);h.pop()}b=_}if(e.pointsSame(w,y)){n.splice(m,1);if(e.pointsCollinear(k,w,b)){if(x){if(r)r.chainRemoveTail(s.index,b);h.pop()}else{if(r)r.chainRemoveHead(s.index,b);h.shift()}}if(r)r.chainClose(s.index);a.push(h);return}if(x){if(r)r.chainAddHead(s.index,y);h.unshift(y)}else{if(r)r.chainAddTail(s.index,y);h.push(y)}return}function M(t){if(r)r.chainReverse(t);n[t].reverse()}function A(t,a){var i=n[t];var o=n[a];var s=i[i.length-1];var l=i[i.length-2];var u=o[0];var c=o[1];if(e.pointsCollinear(l,s,u)){if(r)r.chainRemoveTail(t,s);i.pop();s=l}if(e.pointsCollinear(s,u,c)){if(r)r.chainRemoveHead(a,u);o.shift()}if(r)r.chainJoin(t,a);n[t]=i.concat(o);n.splice(a,1)}var T=s.index;var S=l.index;if(r)r.chainConnect(T,S);var E=n[T].length<n[S].length;if(s.matches_head){if(l.matches_head){if(E){M(T);A(T,S)}else{M(S);A(S,T)}}else{A(S,T)}}else{if(l.matches_head){A(T,S)}else{if(E){M(T);A(S,T)}else{M(S);A(T,S)}}}});return a}e.exports=n},{}],447:[function(t,e,r){function n(t,e,r){var n=[];t.forEach(function(t){var a=(t.myFill.above?8:0)+(t.myFill.below?4:0)+(t.otherFill&&t.otherFill.above?2:0)+(t.otherFill&&t.otherFill.below?1:0);if(e[a]!==0){n.push({id:r?r.segmentId():-1,start:t.start,end:t.end,myFill:{above:e[a]===1,below:e[a]===2},otherFill:null})}});if(r)r.selected(n);return n}var a={union:function(t,e){return n(t,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],e)},intersect:function(t,e){return n(t,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],e)},difference:function(t,e){return n(t,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],e)},differenceRev:function(t,e){return n(t,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],e)},xor:function(t,e){return n(t,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],e)}};e.exports=a},{}],448:[function(t,e,r){"use strict";var n=new Float64Array(4);var a=new Float64Array(4);var i=new Float64Array(4);function o(t,e,r,o,s){if(n.length<o.length){n=new Float64Array(o.length);a=new Float64Array(o.length);i=new Float64Array(o.length)}for(var l=0;l<o.length;++l){n[l]=t[l]-o[l];a[l]=e[l]-t[l];i[l]=r[l]-t[l]}var u=0,c=0,f=0,h=0,p=0,d=0;for(var l=0;l<o.length;++l){var v=a[l],g=i[l],m=n[l];u+=v*v;c+=v*g;f+=g*g;h+=m*v;p+=m*g;d+=m*m}var y=Math.abs(u*f-c*c);var x=c*p-f*h;var b=c*h-u*p;var _;if(x+b<=y){if(x<0){if(b<0){if(h<0){b=0;if(-h>=u){x=1;_=u+2*h+d}else{x=-h/u;_=h*x+d}}else{x=0;if(p>=0){b=0;_=d}else if(-p>=f){b=1;_=f+2*p+d}else{b=-p/f;_=p*b+d}}}else{x=0;if(p>=0){b=0;_=d}else if(-p>=f){b=1;_=f+2*p+d}else{b=-p/f;_=p*b+d}}}else if(b<0){b=0;if(h>=0){x=0;_=d}else if(-h>=u){x=1;_=u+2*h+d}else{x=-h/u;_=h*x+d}}else{var w=1/y;x*=w;b*=w;_=x*(u*x+c*b+2*h)+b*(c*x+f*b+2*p)+d}}else{var k,M,A,T;if(x<0){k=c+h;M=f+p;if(M>k){A=M-k;T=u-2*c+f;if(A>=T){x=1;b=0;_=u+2*h+d}else{x=A/T;b=1-x;_=x*(u*x+c*b+2*h)+b*(c*x+f*b+2*p)+d}}else{x=0;if(M<=0){b=1;_=f+2*p+d}else if(p>=0){b=0;_=d}else{b=-p/f;_=p*b+d}}}else if(b<0){k=c+p;M=u+h;if(M>k){A=M-k;T=u-2*c+f;if(A>=T){b=1;x=0;_=f+2*p+d}else{b=A/T;x=1-b;_=x*(u*x+c*b+2*h)+b*(c*x+f*b+2*p)+d}}else{b=0;if(M<=0){x=1;_=u+2*h+d}else if(h>=0){x=0;_=d}else{x=-h/u;_=h*x+d}}}else{A=f+p-c-h;if(A<=0){x=0;b=1;_=f+2*p+d}else{T=u-2*c+f;if(A>=T){x=1;b=0;_=u+2*h+d}else{x=A/T;b=1-x;_=x*(u*x+c*b+2*h)+b*(c*x+f*b+2*p)+d}}}}var S=1-x-b;for(var l=0;l<o.length;++l){s[l]=S*t[l]+x*e[l]+b*r[l]}if(_<0){return 0}return _}e.exports=o},{}],449:[function(t,e,r){var n=e.exports={};var a;var i;function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){a=setTimeout}else{a=o}}catch(t){a=o}try{if(typeof clearTimeout==="function"){i=clearTimeout}else{i=s}}catch(t){i=s}})();function l(t){if(a===setTimeout){return setTimeout(t,0)}if((a===o||!a)&&setTimeout){a=setTimeout;return setTimeout(t,0)}try{return a(t,0)}catch(e){try{return a.call(null,t,0)}catch(e){return a.call(this,t,0)}}}function u(t){if(i===clearTimeout){return clearTimeout(t)}if((i===s||!i)&&clearTimeout){i=clearTimeout;return clearTimeout(t)}try{return i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}var c=[];var f=false;var h;var p=-1;function d(){if(!f||!h){return}f=false;if(h.length){c=h.concat(c)}else{p=-1}if(c.length){v()}}function v(){if(f){return}var t=l(d);f=true;var e=c.length;while(e){h=c;c=[];while(++p<e){if(h){h[p].run()}}p=-1;e=c.length}h=null;f=false;u(t)}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){e[r-1]=arguments[r]}}c.push(new g(t,e));if(c.length===1&&!f){l(v)}};function g(t,e){this.fun=t;this.array=e}g.prototype.run=function(){this.fun.apply(null,this.array)};n.title="browser";n.browser=true;n.env={};n.argv=[];n.version="";n.versions={};function m(){}n.on=m;n.addListener=m;n.once=m;n.off=m;n.removeListener=m;n.removeAllListeners=m;n.emit=m;n.prependListener=m;n.prependOnceListener=m;n.listeners=function(t){return[]};n.binding=function(t){throw new Error("process.binding is not supported")};n.cwd=function(){return"/"};n.chdir=function(t){throw new Error("process.chdir is not supported")};n.umask=function(){return 0}},{}],450:[function(t,e,r){e.exports=t("gl-quat/slerp")},{"gl-quat/slerp":280}],451:[function(t,e,r){(function(r){var n=t("performance-now"),a=typeof window==="undefined"?r:window,i=["moz","webkit"],o="AnimationFrame",s=a["request"+o],l=a["cancel"+o]||a["cancelRequest"+o];for(var u=0;!s&&u<i.length;u++){s=a[i[u]+"Request"+o];l=a[i[u]+"Cancel"+o]||a[i[u]+"CancelRequest"+o]}if(!s||!l){var c=0,f=0,h=[],p=1e3/60;s=function(t){if(h.length===0){var e=n(),r=Math.max(0,p-(e-c));c=r+e;setTimeout(function(){var t=h.slice(0);h.length=0;for(var e=0;e<t.length;e++){if(!t[e].cancelled){try{t[e].callback(c)}catch(t){setTimeout(function(){throw t},0)}}}},Math.round(r))}h.push({handle:++f,callback:t,cancelled:false});return f};l=function(t){for(var e=0;e<h.length;e++){if(h[e].handle===t){h[e].cancelled=true}}}}e.exports=function(t){return s.call(a,t)};e.exports.cancel=function(){l.apply(a,arguments)};e.exports.polyfill=function(t){if(!t){t=a}t.requestAnimationFrame=s;t.cancelAnimationFrame=l}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"performance-now":429}],452:[function(t,e,r){"use strict";var n=t("big-rat/add");e.exports=a;function a(t,e){var r=t.length;var a=new Array(r);for(var i=0;i<r;++i){a[i]=n(t[i],e[i])}return a}},{"big-rat/add":63}],453:[function(t,e,r){"use strict";e.exports=a;var n=t("big-rat");function a(t){var e=new Array(t.length);for(var r=0;r<t.length;++r){e[r]=n(t[r])}return e}},{"big-rat":66}],454:[function(t,e,r){"use strict";var n=t("big-rat");var a=t("big-rat/mul");e.exports=i;function i(t,e){var r=n(e);var i=t.length;var o=new Array(i);for(var s=0;s<i;++s){o[s]=a(t[s],r)}return o}},{"big-rat":66,"big-rat/mul":75}],455:[function(t,e,r){"use strict";var n=t("big-rat/sub");e.exports=a;function a(t,e){var r=t.length;var a=new Array(r);for(var i=0;i<r;++i){a[i]=n(t[i],e[i])}return a}},{"big-rat/sub":77}],456:[function(t,e,r){"use strict";var n=t("compare-cell");var a=t("compare-oriented-cell");var i=t("cell-orientation");e.exports=o;function o(t){t.sort(a);var e=t.length;var r=0;for(var o=0;o<e;++o){var s=t[o];var l=i(s);if(l===0){continue}if(r>0){var u=t[r-1];if(n(s,u)===0&&i(u)!==l){r-=1;continue}}t[r++]=s}t.length=r;return t}},{"cell-orientation":99,"compare-cell":115,"compare-oriented-cell":116}],457:[function(t,e,r){"use strict";var n=t("array-bounds");var a=t("color-normalize");var i=t("update-diff");var o=t("pick-by-alias");var s=t("object-assign");var l=t("flatten-vertex-data");var u=t("to-float32");var c=u.float32;var f=u.fract32;e.exports=p;var h=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];function p(t,e){if(typeof t==="function"){if(!e){e={}}e.regl=t}else{e=t}if(e.length){e.positions=e}t=e.regl;if(!t.hasExtension("ANGLE_instanced_arrays")){throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled")}var r=t._gl,u,p,d,v,g,m,y={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},x=[];v=t.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)});p=t.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});d=t.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});g=t.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});m=t.buffer({usage:"static",type:"float",data:h});k(e);u=t({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision mediump float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:t.prop("range"),lineWidth:t.prop("lineWidth"),capSize:t.prop("capSize"),opacity:t.prop("opacity"),scale:t.prop("scale"),translate:t.prop("translate"),scaleFract:t.prop("scaleFract"),translateFract:t.prop("translateFract"),viewport:function(t,e){return[e.viewport.x,e.viewport.y,t.viewportWidth,t.viewportHeight]}},attributes:{color:{buffer:v,offset:function(t,e){return e.offset*4},divisor:1},position:{buffer:p,offset:function(t,e){return e.offset*8},divisor:1},positionFract:{buffer:d,offset:function(t,e){return e.offset*8},divisor:1},error:{buffer:g,offset:function(t,e){return e.offset*16},divisor:1},direction:{buffer:m,stride:24,offset:0},lineOffset:{buffer:m,stride:24,offset:8},capOffset:{buffer:m,stride:24,offset:16}},primitive:"triangles",blend:{enable:true,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:false},scissor:{enable:true,box:t.prop("viewport")},viewport:t.prop("viewport"),stencil:false,instances:t.prop("count"),count:h.length});s(b,{update:k,draw:_,destroy:M,regl:t,gl:r,canvas:r.canvas,groups:x});return b;function b(t){if(t){k(t)}else if(t===null){M()}_()}function _(e){if(typeof e==="number"){return w(e)}if(e&&!Array.isArray(e)){e=[e]}t._refresh();x.forEach(function(t,r){if(!t){return}if(e){if(!e[r]){t.draw=false}else{t.draw=true}}if(!t.draw){t.draw=true;return}w(r)})}function w(t){if(typeof t==="number"){t=x[t]}if(t==null){return}if(!(t&&t.count&&t.color&&t.opacity&&t.positions&&t.positions.length>1)){return}t.scaleRatio=[t.scale[0]*t.viewport.width,t.scale[1]*t.viewport.height];u(t);if(t.after){t.after(t)}}function k(t){if(!t){return}if(t.length!=null){if(typeof t[0]==="number"){t=[{positions:t}]}}else if(!Array.isArray(t)){t=[t]}var e=0,u=0;b.groups=x=t.map(function(t,c){var h=x[c];if(!t){return h}else if(typeof t==="function"){t={after:t}}else if(typeof t[0]==="number"){t={positions:t}}t=o(t,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"});if(!h){x[c]=h={id:c,scale:null,translate:null,scaleFract:null,translateFract:null,draw:true};t=s({},y,t)}i(h,t,[{lineWidth:function(t){return+t*.5},capSize:function(t){return+t*.5},opacity:parseFloat,errors:function(t){t=l(t);u+=t.length;return t},positions:function(t,r){t=l(t,"float64");r.count=Math.floor(t.length/2);r.bounds=n(t,2);r.offset=e;e+=r.count;return t}},{color:function(t,e){var r=e.count;if(!t){t="transparent"}if(!Array.isArray(t)||typeof t[0]==="number"){var n=t;t=Array(r);for(var i=0;i<r;i++){t[i]=n}}if(t.length<r){throw Error("Not enough colors")}var o=new Uint8Array(r*4);for(var s=0;s<r;s++){var l=a(t[s],"uint8");o.set(l,s*4)}return o},range:function(t,e,r){var n=e.bounds;if(!t){t=n}e.scale=[1/(t[2]-t[0]),1/(t[3]-t[1])];e.translate=[-t[0],-t[1]];e.scaleFract=f(e.scale);e.translateFract=f(e.translate);return t},viewport:function(t){var e;if(Array.isArray(t)){e={x:t[0],y:t[1],width:t[2]-t[0],height:t[3]-t[1]}}else if(t){e={x:t.x||t.left||0,y:t.y||t.top||0};if(t.right){e.width=t.right-e.x}else{e.width=t.w||t.width||0}if(t.bottom){e.height=t.bottom-e.y}else{e.height=t.h||t.height||0}}else{e={x:0,y:0,width:r.drawingBufferWidth,height:r.drawingBufferHeight}}return e}}]);return h});if(e||u){var h=x.reduce(function(t,e,r){return t+(e?e.count:0)},0);var m=new Float64Array(h*2);var _=new Uint8Array(h*4);var w=new Float32Array(h*4);x.forEach(function(t,e){if(!t){return}var r=t.positions;var n=t.count;var a=t.offset;var i=t.color;var o=t.errors;if(!n){return}_.set(i,a*4);w.set(o,a*4);m.set(r,a*2)});p(c(m));d(f(m));v(_);g(w)}}function M(){p.destroy();d.destroy();v.destroy();g.destroy();m.destroy()}}},{"array-bounds":56,"color-normalize":107,"flatten-vertex-data":216,"object-assign":421,"pick-by-alias":432,"to-float32":500,"update-diff":511}],458:[function(t,e,r){"use strict";var n=t("color-normalize");var a=t("array-bounds");var i=t("object-assign");var o=t("glslify");var s=t("pick-by-alias");var l=t("flatten-vertex-data");var u=t("earcut");var c=t("array-normalize");var f=t("to-float32");var h=f.float32;var p=f.fract32;var d=t("es6-weak-map");var v=t("parse-rect");e.exports=g;function g(t,e){if(!(this instanceof g)){return new g(t,e)}if(typeof t==="function"){if(!e){e={}}e.regl=t}else{e=t}if(e.length){e.positions=e}t=e.regl;if(!t.hasExtension("ANGLE_instanced_arrays")){throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled")}this.gl=t._gl;this.regl=t;this.passes=[];this.shaders=g.shaders.has(t)?g.shaders.get(t):g.shaders.set(t,g.createShaders(t)).get(t);this.update(e)}g.dashMult=2;g.maxPatternLength=256;g.precisionThreshold=3e6;g.maxPoints=1e4;g.maxLines=2048;g.shaders=new d;g.createShaders=function(t){var e=t.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]});var r={primitive:"triangle strip",instances:t.prop("count"),count:4,offset:0,uniforms:{miterMode:function(t,e){return e.join==="round"?2:1},miterLimit:t.prop("miterLimit"),scale:t.prop("scale"),scaleFract:t.prop("scaleFract"),translateFract:t.prop("translateFract"),translate:t.prop("translate"),thickness:t.prop("thickness"),dashPattern:t.prop("dashTexture"),opacity:t.prop("opacity"),pixelRatio:t.context("pixelRatio"),id:t.prop("id"),dashSize:t.prop("dashLength"),viewport:function(t,e){return[e.viewport.x,e.viewport.y,t.viewportWidth,t.viewportHeight]},depth:t.prop("depth")},blend:{enable:true,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(t,e){return!e.overlay}},stencil:{enable:false},scissor:{enable:true,box:t.prop("viewport")},viewport:t.prop("viewport")};var n=t(i({vert:o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scale * viewport.zw);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:o(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\n\nuniform float dashSize, pixelRatio, thickness, opacity, id;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:e,divisor:0,stride:8,offset:0},lineTop:{buffer:e,divisor:0,stride:8,offset:4},aCoord:{buffer:t.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:t.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:t.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:t.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:t.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},r));var a;try{a=t(i({cull:{enable:true,face:"back"},vert:o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n\t// adjust scale for horizontal bars\n\tvec2 scale = max(scale, MIN_DIFF);\n\tvec2 scaleRatio = scale * viewport.zw;\n\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t// collapsed/unidirectional segment cases\n\t// FIXME: there should be more elegant solution\n\tvec2 prevTanDiff = abs(prevTangent - currTangent);\n\tvec2 nextTanDiff = abs(nextTangent - currTangent);\n\tif (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * scale + translate;\n\tvec2 aBotPosition = (aBotCoord) * scale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * scale + translate;\n\tvec2 bBotPosition = (bBotCoord) * scale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:o(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\nuniform float dashSize, pixelRatio, thickness, opacity, id, miterMode;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:e,divisor:0,stride:8,offset:0},lineTop:{buffer:e,divisor:0,stride:8,offset:4},aColor:{buffer:t.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:t.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:t.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:t.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:t.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:t.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},r))}catch(t){a=n}var s=t({primitive:"triangle",elements:function(t,e){return e.triangles},offset:0,vert:o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n}\n"]),frag:o(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n}\n"]),uniforms:{scale:t.prop("scale"),color:t.prop("fill"),scaleFract:t.prop("scaleFract"),translateFract:t.prop("translateFract"),translate:t.prop("translate"),opacity:t.prop("opacity"),pixelRatio:t.context("pixelRatio"),id:t.prop("id"),viewport:function(t,e){return[e.viewport.x,e.viewport.y,t.viewportWidth,t.viewportHeight]}},attributes:{position:{buffer:t.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:t.prop("positionFractBuffer"),stride:8,offset:8}},blend:r.blend,depth:{enable:false},scissor:r.scissor,stencil:r.stencil,viewport:r.viewport});return{fill:s,rect:n,miter:a}};g.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:false,viewport:null,range:null,close:false,fill:null};g.prototype.render=function(){var t=[],e=arguments.length;while(e--)t[e]=arguments[e];if(t.length){(r=this).update.apply(r,t)}this.draw();var r};g.prototype.draw=function(){var t=this;var e=[],r=arguments.length;while(r--)e[r]=arguments[r];(e.length?e:this.passes).forEach(function(e,r){if(e&&Array.isArray(e)){return(n=t).draw.apply(n,e)}if(typeof e==="number"){e=t.passes[e]}if(!(e&&e.count>1&&e.opacity)){return}t.regl._refresh();if(e.fill&&e.triangles&&e.triangles.length>2){t.shaders.fill(e)}if(!e.thickness){return}if(e.scale[0]*e.viewport.width>g.precisionThreshold||e.scale[1]*e.viewport.height>g.precisionThreshold){t.shaders.rect(e)}else if(e.join==="rect"||!e.join&&(e.thickness<=2||e.count>=g.maxPoints)){t.shaders.rect(e)}else{t.shaders.miter(e)}var n});return this};g.prototype.update=function(t){var e=this;if(!t){return}if(t.length!=null){if(typeof t[0]==="number"){t=[{positions:t}]}}else if(!Array.isArray(t)){t=[t]}var r=this;var o=r.regl;var f=r.gl;t.forEach(function(t,r){var d=e.passes[r];if(t===undefined){return}if(t===null){e.passes[r]=null;return}if(typeof t[0]==="number"){t={positions:t}}t=s(t,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow"});if(!d){e.passes[r]=d={id:r,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:o.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:o.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:o.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:o.buffer({usage:"dynamic",type:"float",data:new Uint8Array})};t=i({},g.defaults,t)}if(t.thickness!=null){d.thickness=parseFloat(t.thickness)}if(t.opacity!=null){d.opacity=parseFloat(t.opacity)}if(t.miterLimit!=null){d.miterLimit=parseFloat(t.miterLimit)}if(t.overlay!=null){d.overlay=!!t.overlay;if(r<g.maxLines){d.depth=2*(g.maxLines-1-r%g.maxLines)/g.maxLines-1}}if(t.join!=null){d.join=t.join}if(t.hole!=null){d.hole=t.hole}if(t.fill!=null){d.fill=!t.fill?null:n(t.fill,"uint8")}if(t.viewport!=null){d.viewport=v(t.viewport)}if(!d.viewport){d.viewport=v([f.drawingBufferWidth,f.drawingBufferHeight])}if(t.close!=null){d.close=t.close}if(t.positions===null){t.positions=[]}if(t.positions){var m,y;if(t.positions.x&&t.positions.y){var x=t.positions.x;var b=t.positions.y;y=d.count=Math.max(x.length,b.length);m=new Float64Array(y*2);for(var _=0;_<y;_++){m[_*2]=x[_];m[_*2+1]=b[_]}}else{m=l(t.positions,"float64");y=d.count=Math.floor(m.length/2)}var w=d.bounds=a(m,2);if(d.fill){var k=[];var M={};var A=0;for(var T=0,S=0,E=d.count;T<E;T++){var C=m[T*2];var L=m[T*2+1];if(isNaN(C)||isNaN(L)||C==null||L==null){C=m[A*2];L=m[A*2+1];M[T]=A}else{A=T}k[S++]=C;k[S++]=L}var I=u(k,d.hole||[]);for(var z=0,P=I.length;z<P;z++){if(M[I[z]]!=null){I[z]=M[I[z]]}}d.triangles=I}var O=new Float64Array(m);c(O,2,w);var D=new Float64Array(y*2+6);if(d.close){if(m[0]===m[y*2-2]&&m[1]===m[y*2-1]){D[0]=O[y*2-4];D[1]=O[y*2-3]}else{D[0]=O[y*2-2];D[1]=O[y*2-1]}}else{D[0]=O[0];D[1]=O[1]}D.set(O,2);if(d.close){if(m[0]===m[y*2-2]&&m[1]===m[y*2-1]){D[y*2+2]=O[2];D[y*2+3]=O[3];d.count-=1}else{D[y*2+2]=O[0];D[y*2+3]=O[1];D[y*2+4]=O[2];D[y*2+5]=O[3]}}else{D[y*2+2]=O[y*2-2];D[y*2+3]=O[y*2-1];D[y*2+4]=O[y*2-2];D[y*2+5]=O[y*2-1]}d.positionBuffer(h(D));d.positionFractBuffer(p(D))}if(t.range){d.range=t.range}else if(!d.range){d.range=d.bounds}if((t.range||t.positions)&&d.count){var R=d.bounds;var B=R[2]-R[0],F=R[3]-R[1];var N=d.range[2]-d.range[0],j=d.range[3]-d.range[1];d.scale=[B/N,F/j];d.translate=[-d.range[0]/N+R[0]/N||0,-d.range[1]/j+R[1]/j||0];d.scaleFract=p(d.scale);d.translateFract=p(d.translate)}if(t.dashes){var V=0,U;if(!t.dashes||t.dashes.length<2){V=1;U=new Uint8Array([255,255,255,255,255,255,255,255])}else{V=0;for(var q=0;q<t.dashes.length;++q){V+=t.dashes[q]}U=new Uint8Array(V*g.dashMult);var H=0;var G=255;for(var W=0;W<2;W++){for(var Y=0;Y<t.dashes.length;++Y){for(var X=0,Z=t.dashes[Y]*g.dashMult*.5;X<Z;++X){U[H++]=G}G^=255}}}d.dashLength=V;d.dashTexture({channels:1,data:U,width:U.length,height:1,mag:"linear",min:"linear"},0,0)}if(t.color){var $=d.count;var J=t.color;if(!J){J="transparent"}var K=new Uint8Array($*4+4);if(!Array.isArray(J)||typeof J[0]==="number"){var Q=n(J,"uint8");for(var tt=0;tt<$+1;tt++){K.set(Q,tt*4)}}else{for(var et=0;et<$;et++){var rt=n(J[et],"uint8");K.set(rt,et*4)}K.set(n(J[0],"uint8"),$*4)}d.colorBuffer({usage:"dynamic",type:"uint8",data:K})}});if(t.length<this.passes.length){for(var d=t.length;d<this.passes.length;d++){var m=e.passes[d];if(!m){continue}m.colorBuffer.destroy();m.positionBuffer.destroy();m.dashTexture.destroy()}this.passes.length=t.length}this.passes=this.passes.filter(Boolean);return this};g.prototype.destroy=function(){this.passes.forEach(function(t){t.colorBuffer.destroy();t.positionBuffer.destroy();t.dashTexture.destroy()});this.passes.length=0;return this}},{"array-bounds":56,"array-normalize":57,"color-normalize":107,earcut:155,"es6-weak-map":208,"flatten-vertex-data":216,glslify:377,"object-assign":421,"parse-rect":426,"pick-by-alias":432,"to-float32":500}],459:[function(t,e,r){"use strict";var n=t("./scatter");var a=t("object-assign");e.exports=function(t,e){var r=new n(t,e);var i=r.render.bind(r);a(i,{render:i,update:r.update.bind(r),draw:r.draw.bind(r),destroy:r.destroy.bind(r),regl:r.regl,gl:r.gl,canvas:r.gl.canvas,groups:r.groups,markers:r.markerCache,palette:r.palette});return i}},{"./scatter":460,"object-assign":421}],460:[function(t,e,r){"use strict";var n=t("color-normalize");var a=t("array-bounds");var i=t("color-id");var o=t("point-cluster");var s=t("object-assign");var l=t("glslify");var u=t("pick-by-alias");var c=t("update-diff");var f=t("flatten-vertex-data");var h=t("is-iexplorer");var p=t("to-float32");var d=p.float32;var v=p.fract32;var g=t("parse-rect");e.exports=m;function m(t,e){var r=this;if(!(this instanceof m)){return new m(t,e)}if(typeof t==="function"){if(!e){e={}}e.regl=t}else{e=t;t=null}if(e&&e.length){e.positions=e}t=e.regl;var n=t._gl,a,i=[],o={},u=[],c=[null],f=[null];var p=255,d=100;this.tooManyColors=h;a=t.texture({data:new Uint8Array(p*4),width:p,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"});s(this,{regl:t,gl:n,groups:u,markerCache:f,markerTextures:c,palette:i,paletteIds:o,paletteTexture:a,maxColors:p,maxSize:d,canvas:n.canvas});this.update(e);var v={uniforms:{pixelRatio:t.context("pixelRatio"),palette:a,paletteSize:function(t,e){return[r.tooManyColors?0:p,a.height]},scale:t.prop("scale"),scaleFract:t.prop("scaleFract"),translate:t.prop("translate"),translateFract:t.prop("translateFract"),opacity:t.prop("opacity"),marker:t.prop("markerTexture")},attributes:{x:function(t,e){return e.xAttr||{buffer:e.positionBuffer,stride:8,offset:0}},y:function(t,e){return e.yAttr||{buffer:e.positionBuffer,stride:8,offset:4}},xFract:function(t,e){return e.xAttr?{constant:[0,0]}:{buffer:e.positionFractBuffer,stride:8,offset:0}},yFract:function(t,e){return e.yAttr?{constant:[0,0]}:{buffer:e.positionFractBuffer,stride:8,offset:4}},size:function(t,e){return e.size.length?{buffer:e.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(e.size*255/r.maxSize)]}},borderSize:function(t,e){return e.borderSize.length?{buffer:e.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(e.borderSize*255/r.maxSize)]}},colorId:function(t,e){return e.color.length?{buffer:e.colorBuffer,stride:r.tooManyColors?8:4,offset:0}:{constant:r.tooManyColors?i.slice(e.color*4,e.color*4+4):[e.color]}},borderColorId:function(t,e){return e.borderColor.length?{buffer:e.colorBuffer,stride:r.tooManyColors?8:4,offset:r.tooManyColors?4:2}:{constant:r.tooManyColors?i.slice(e.borderColor*4,e.borderColor*4+4):[e.borderColor]}},isActive:function(t,e){return e.activation===true?{constant:[1]}:e.activation?e.activation:{constant:[0]}}},blend:{enable:true,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:true,box:t.prop("viewport")},viewport:t.prop("viewport"),stencil:{enable:false},depth:{enable:false},elements:t.prop("elements"),count:t.prop("count"),offset:t.prop("offset"),primitive:"points"};var g=s({},v);g.frag=l(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nuniform sampler2D marker;\nuniform float pixelRatio, opacity;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(marker, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n    return;\n  }\n\n  float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n  float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n  vec4 color = fragBorderColor;\n  color.a *= borderColorAmt;\n  color = mix(color, fragColor, colorAmt);\n  color.a *= opacity;\n\n  gl_FragColor = color;\n}\n"]);g.vert=l(["precision mediump float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform float pixelRatio;\nuniform sampler2D palette;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius,\n    fragWidth, fragBorderColorLevel, fragColorLevel;\n\nvec2 paletteCoord(float id) {\n  return vec2(\n    (mod(id, paletteSize.x) + .5) / paletteSize.x,\n    (floor(id / paletteSize.x) + .5) / paletteSize.y\n  );\n}\nvec2 paletteCoord(vec2 id) {\n  return vec2(\n    (id.x + .5) / paletteSize.x,\n    (id.y + .5) / paletteSize.y\n  );\n}\nvec4 getColor(vec4 id) {\n  // zero-palette means we deal with direct buffer\n  if (paletteSize.x == 0.) return id / 255.;\n  return texture2D(palette, paletteCoord(id.xy));\n}\n\nvoid main() {\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pixelRatio;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}\n"]);try{this.drawMarker=t(g)}catch(t){}var y=s({},v);y.frag=l(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\n\nuniform float opacity;\nvarying float fragBorderRadius, fragWidth;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n\tfloat t;\n\tt = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n\treturn t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif (radius > 1.0 + delta) {\n\t\tdiscard;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]);y.vert=l(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio;\nuniform sampler2D palette;\nuniform vec2 paletteSize;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nvec2 paletteCoord(float id) {\n  return vec2(\n    (mod(id, paletteSize.x) + .5) / paletteSize.x,\n    (floor(id / paletteSize.x) + .5) / paletteSize.y\n  );\n}\nvec2 paletteCoord(vec2 id) {\n  return vec2(\n    (id.x + .5) / paletteSize.x,\n    (id.y + .5) / paletteSize.y\n  );\n}\n\nvec4 getColor(vec4 id) {\n  // zero-palette means we deal with direct buffer\n  if (paletteSize.x == 0.) return id / 255.;\n  return texture2D(palette, paletteCoord(id.xy));\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]);if(h){y.frag=y.frag.replace("smoothstep","smoothStep")}this.drawCircle=t(y)}m.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:undefined,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4};m.prototype.render=function(){var t=[],e=arguments.length;while(e--)t[e]=arguments[e];if(t.length){(r=this).update.apply(r,t)}this.draw();return this;var r};m.prototype.draw=function(){var t=this;var e=[],r=arguments.length;while(r--)e[r]=arguments[r];var n=this;var a=n.groups;if(e.length===1&&Array.isArray(e[0])&&(e[0][0]===null||Array.isArray(e[0][0]))){e=e[0]}this.regl._refresh();if(e.length){for(var i=0;i<e.length;i++){t.drawItem(i,e[i])}}else{a.forEach(function(e,r){t.drawItem(r)})}return this};m.prototype.drawItem=function(t,e){var r=this;var n=this;var a=n.groups;var i=a[t];if(typeof e==="number"){t=e;i=a[e];e=null}if(!(i&&i.count&&i.opacity)){return}if(i.activation[0]){this.drawCircle(this.getMarkerDrawOptions(0,i,e))}var o=[];for(var s=1;s<i.activation.length;s++){if(!i.activation[s]||i.activation[s]!==true&&!i.activation[s].data.length){continue}o.push.apply(o,r.getMarkerDrawOptions(s,i,e))}if(o.length){this.drawMarker(o)}};m.prototype.getMarkerDrawOptions=function(t,e,r){var n=this;var a=e.range;var i=e.tree;var o=e.viewport;var l=e.activation;var u=e.selectionBuffer;var c=e.count;var f=this;var h=f.regl;if(!i){if(r){return[s({},e,{markerTexture:this.markerTextures[t],activation:l[t],count:r.length,elements:r,offset:0})]}return[s({},e,{markerTexture:this.markerTextures[t],activation:l[t],offset:0})]}var p=[];var d=i.range(a,{lod:true,px:[(a[2]-a[0])/o.width,(a[3]-a[1])/o.height]});if(r){var v=l[t];var g=v.data;var m=new Uint8Array(c);for(var y=0;y<r.length;y++){var x=r[y];m[x]=g?g[x]:1}u.subdata(m)}for(var b=d.length;b--;){var _=d[b];var w=_[0];var k=_[1];p.push(s({},e,{markerTexture:n.markerTextures[t],activation:r?u:l[t],offset:w,count:k-w}))}return p};m.prototype.update=function(){var t=this;var e=[],r=arguments.length;while(r--)e[r]=arguments[r];if(!e.length){return}if(e.length===1&&Array.isArray(e[0])){e=e[0]}var n=this;var i=n.groups;var l=n.gl;var h=n.regl;var p=n.maxSize;var y=n.maxColors;var x=n.palette;this.groups=i=e.map(function(e,r){var n=i[r];if(e===undefined){return n}if(e===null){e={positions:null}}else if(typeof e==="function"){e={ondraw:e}}else if(typeof e[0]==="number"){e={positions:e}}e=u(e,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits"});if(e.positions===null){e.positions=[]}if(!n){i[r]=n={id:r,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:h.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:h.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:h.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:h.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:h.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})};e=s({},m.defaults,e)}if(e.positions&&!("marker"in e)){e.marker=n.marker;delete n.marker}if(e.marker&&!("positions"in e)){e.positions=n.positions;delete n.positions}var b=0,_=0;c(n,e,[{snap:true,size:function(t,e){if(t==null){t=m.defaults.size}b+=t&&t.length?1:0;return t},borderSize:function(t,e){if(t==null){t=m.defaults.borderSize}b+=t&&t.length?1:0;return t},opacity:parseFloat,color:function(e,r){if(e==null){e=m.defaults.color}e=t.updateColor(e);_++;return e},borderColor:function(e,r){if(e==null){e=m.defaults.borderColor}e=t.updateColor(e);_++;return e},bounds:function(t,e,r){if(!("range"in r)){r.range=null}return t},positions:function(t,e,r){var n=e.snap;var i=e.positionBuffer;var s=e.positionFractBuffer;var l=e.selectionBuffer;if(t.x||t.y){if(t.x.length){e.xAttr={buffer:h.buffer(t.x),offset:0,stride:4,count:t.x.length}}else{e.xAttr={buffer:t.x.buffer,offset:t.x.offset*4||0,stride:(t.x.stride||1)*4,count:t.x.count}}if(t.y.length){e.yAttr={buffer:h.buffer(t.y),offset:0,stride:4,count:t.y.length}}else{e.yAttr={buffer:t.y.buffer,offset:t.y.offset*4||0,stride:(t.y.stride||1)*4,count:t.y.count}}e.count=Math.max(e.xAttr.count,e.yAttr.count);return t}t=f(t,"float64");var u=e.count=Math.floor(t.length/2);var c=e.bounds=u?a(t,2):null;if(!r.range&&!e.range){delete e.range;r.range=c}if(!r.marker&&!e.marker){delete e.marker;r.marker=null}if(n&&(n===true||u>n)){e.tree=o(t,{bounds:c})}else if(n&&n.length){e.tree=n}if(e.tree){var p={primitive:"points",usage:"static",data:e.tree,type:"uint32"};if(e.elements){e.elements(p)}else{e.elements=h.elements(p)}}i({data:d(t),usage:"dynamic"});s({data:v(t),usage:"dynamic"});l({data:new Uint8Array(u),type:"uint8",usage:"stream"});return t}},{marker:function(e,r,n){var a=r.activation;a.forEach(function(t){return t&&t.destroy&&t.destroy()});a.length=0;if(!e||typeof e[0]==="number"){var i=t.addMarker(e);a[i]=true}else{var o=[];for(var s=0,l=Math.min(e.length,r.count);s<l;s++){var u=t.addMarker(e[s]);if(!o[u]){o[u]=new Uint8Array(r.count)}o[u][s]=1}for(var c=0;c<o.length;c++){if(!o[c]){continue}var f={data:o[c],type:"uint8",usage:"static"};if(!a[c]){a[c]=h.buffer(f)}else{a[c](f)}a[c].data=o[c]}}return e},range:function(t,e,r){var n=e.bounds;if(!n){return}if(!t){t=n}e.scale=[1/(t[2]-t[0]),1/(t[3]-t[1])];e.translate=[-t[0],-t[1]];e.scaleFract=v(e.scale);e.translateFract=v(e.translate);return t},viewport:function(t){var e=g(t||[l.drawingBufferWidth,l.drawingBufferHeight]);return e}}]);if(b){var w=n.count;var k=n.size;var M=n.borderSize;var A=n.sizeBuffer;var T=new Uint8Array(w*2);if(k.length||M.length){for(var S=0;S<w;S++){T[S*2]=Math.round((k[S]==null?k:k[S])*255/p);T[S*2+1]=Math.round((M[S]==null?M:M[S])*255/p)}}A({data:T,usage:"dynamic"})}if(_){var E=n.count;var C=n.color;var L=n.borderColor;var I=n.colorBuffer;var z;if(t.tooManyColors){if(C.length||L.length){z=new Uint8Array(E*8);for(var P=0;P<E;P++){var O=C[P];z[P*8]=x[O*4];z[P*8+1]=x[O*4+1];z[P*8+2]=x[O*4+2];z[P*8+3]=x[O*4+3];var D=L[P];z[P*8+4]=x[D*4];z[P*8+5]=x[D*4+1];z[P*8+6]=x[D*4+2];z[P*8+7]=x[D*4+3]}}}else{if(C.length||L.length){z=new Uint8Array(E*4+2);for(var R=0;R<E;R++){if(C[R]!=null){z[R*4]=C[R]%y;z[R*4+1]=Math.floor(C[R]/y)}if(L[R]!=null){z[R*4+2]=L[R]%y;z[R*4+3]=Math.floor(L[R]/y)}}}}I({data:z||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return n})};m.prototype.addMarker=function(t){var e=this;var r=e.markerTextures;var n=e.regl;var a=e.markerCache;var i=t==null?0:a.indexOf(t);if(i>=0){return i}var o;if(t instanceof Uint8Array||t instanceof Uint8ClampedArray){o=t}else{o=new Uint8Array(t.length);for(var s=0,l=t.length;s<l;s++){o[s]=t[s]*255}}var u=Math.floor(Math.sqrt(o.length));i=r.length;a.push(t);r.push(n.texture({channels:1,data:o,radius:u,mag:"linear",min:"linear"}));return i};m.prototype.updateColor=function(t){var e=this;var r=e.paletteIds;var a=e.palette;var o=e.maxColors;if(!Array.isArray(t)){t=[t]}var s=[];if(typeof t[0]==="number"){var l=[];if(Array.isArray(t)){for(var u=0;u<t.length;u+=4){l.push(t.slice(u,u+4))}}else{for(var c=0;c<t.length;c+=4){l.push(t.subarray(c,c+4))}}t=l}for(var f=0;f<t.length;f++){var h=t[f];h=n(h,"uint8");var p=i(h,false);if(r[p]==null){var d=a.length;r[p]=Math.floor(d/4);a[d]=h[0];a[d+1]=h[1];a[d+2]=h[2];a[d+3]=h[3]}s[f]=r[p]}if(!this.tooManyColors&&a.length>o*o*4){this.tooManyColors=true}this.updatePalette(a);return s.length===1?s[0]:s};m.prototype.updatePalette=function(t){if(this.tooManyColors){return}var e=this;var r=e.maxColors;var n=e.paletteTexture;var a=Math.ceil(t.length*.25/r);if(a>1){t=t.slice();for(var i=t.length*.25%r;i<a*r;i++){t.push(0,0,0,0)}}if(n.height<a){n.resize(r,a)}n.subimage({width:Math.min(t.length*.25,r),height:a,data:t},0,0)};m.prototype.destroy=function(){this.groups.forEach(function(t){t.sizeBuffer.destroy();t.positionBuffer.destroy();t.positionFractBuffer.destroy();t.colorBuffer.destroy();t.activation.forEach(function(t){return t&&t.destroy&&t.destroy()});t.selectionBuffer.destroy();if(t.elements){t.elements.destroy()}});this.groups.length=0;this.paletteTexture.destroy();this.markerTextures.forEach(function(t){return t&&t.destroy&&t.destroy()});return this}},{"array-bounds":56,"color-id":105,"color-normalize":107,"flatten-vertex-data":216,glslify:377,"is-iexplorer":387,"object-assign":421,"parse-rect":426,"pick-by-alias":432,"point-cluster":436,"to-float32":500,"update-diff":511}],461:[function(t,e,r){"use strict";var n=t("regl-scatter2d/scatter");var a=t("pick-by-alias");var i=t("array-bounds");var o=t("raf");var s=t("array-range");var l=t("parse-rect");var u=t("flatten-vertex-data");e.exports=c;function c(t,e){if(!(this instanceof c)){return new c(t,e)}this.traces=[];this.passes={};this.regl=t;this.scatter=n(t);this.canvas=this.scatter.canvas}c.prototype.render=function(){var t=this;var e=[],r=arguments.length;while(r--)e[r]=arguments[r];if(e.length){(n=this).update.apply(n,e)}if(this.regl.attributes.preserveDrawingBuffer){return this.draw()}if(this.dirty){if(this.planned==null){this.planned=o(function(){t.draw();t.dirty=true;t.planned=null})}}else{this.draw();this.dirty=true;o(function(){t.dirty=false})}return this;var n};c.prototype.update=function(){var t=this;var e=[],r=arguments.length;while(r--)e[r]=arguments[r];if(!e.length){return}for(var n=0;n<e.length;n++){t.updateItem(n,e[n])}this.traces=this.traces.filter(Boolean);var a=[];var i=0;for(var o=0;o<this.traces.length;o++){var s=t.traces[o];var l=t.traces[o].passes;for(var u=0;u<l.length;u++){a.push(t.passes[l[u]])}s.passOffset=i;i+=s.passes.length}(c=this.scatter).update.apply(c,a);return this;var c};c.prototype.updateItem=function(t,e){var r=this;var n=this;var o=n.regl;if(e===null){this.traces[t]=null;return this}if(!e){return this}var s=a(e,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"});var c=this.traces[t]||(this.traces[t]={id:t,buffer:o.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:l([o._gl.drawingBufferWidth,o._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:true,upper:true,lower:true});if(s.color!=null){c.color=s.color}if(s.size!=null){c.size=s.size}if(s.marker!=null){c.marker=s.marker}if(s.borderColor!=null){c.borderColor=s.borderColor}if(s.borderSize!=null){c.borderSize=s.borderSize}if(s.opacity!=null){c.opacity=s.opacity}if(s.viewport){c.viewport=l(s.viewport)}if(s.diagonal!=null){c.diagonal=s.diagonal}if(s.upper!=null){c.upper=s.upper}if(s.lower!=null){c.lower=s.lower}if(s.data){c.buffer(u(s.data));c.columns=s.data.length;c.count=s.data[0].length;c.bounds=[];for(var d=0;d<c.columns;d++){c.bounds[d]=i(s.data[d],1)}}var v;if(s.range){c.range=s.range;v=c.range&&typeof c.range[0]!=="number"}if(s.domain){c.domain=s.domain}var g=false;if(s.padding!=null){if(Array.isArray(s.padding)&&s.padding.length===c.columns&&typeof s.padding[s.padding.length-1]==="number"){c.padding=s.padding.map(p);g=true}else{c.padding=p(s.padding)}}var m=c.columns;var y=c.count;var x=c.viewport.width;var b=c.viewport.height;var _=c.viewport.x;var w=c.viewport.y;var k=x/m;var M=b/m;c.passes=[];for(var A=0;A<m;A++){for(var T=0;T<m;T++){if(!c.diagonal&&T===A){continue}if(!c.upper&&A>T){continue}if(!c.lower&&A<T){continue}var S=f(c.id,A,T);var E=r.passes[S]||(r.passes[S]={});if(s.data){if(s.transpose){E.positions={x:{buffer:c.buffer,offset:T,count:y,stride:m},y:{buffer:c.buffer,offset:A,count:y,stride:m}}}else{E.positions={x:{buffer:c.buffer,offset:T*y,count:y},y:{buffer:c.buffer,offset:A*y,count:y}}}E.bounds=h(c.bounds,A,T)}if(s.domain||s.viewport||s.data){var C=g?h(c.padding,A,T):c.padding;if(c.domain){var L=h(c.domain,A,T);var I=L[0];var z=L[1];var P=L[2];var O=L[3];E.viewport=[_+I*x+C[0],w+z*b+C[1],_+P*x-C[2],w+O*b-C[3]]}else{E.viewport=[_+T*k+k*C[0],w+A*M+M*C[1],_+(T+1)*k-k*C[2],w+(A+1)*M-M*C[3]]}}if(s.color){E.color=c.color}if(s.size){E.size=c.size}if(s.marker){E.marker=c.marker}if(s.borderSize){E.borderSize=c.borderSize}if(s.borderColor){E.borderColor=c.borderColor}if(s.opacity){E.opacity=c.opacity}if(s.range){E.range=v?h(c.range,A,T):c.range||E.bounds}c.passes.push(S)}}return this};c.prototype.draw=function(){var t=this;var e=[],r=arguments.length;while(r--)e[r]=arguments[r];if(!e.length){this.scatter.draw()}else{var n=[];for(var a=0;a<e.length;a++){if(typeof e[a]==="number"){var i=t.traces[e[a]];var o=i.passes;var l=i.passOffset;n.push.apply(n,s(l,l+o.length))}else if(e[a].length){var u=e[a];var c=t.traces[a];var f=c.passes;var h=c.passOffset;f=f.map(function(t,e){n[h+e]=u})}}(p=this.scatter).draw.apply(p,n)}return this;var p};c.prototype.destroy=function(){this.traces.forEach(function(t){if(t.buffer&&t.buffer.destroy){t.buffer.destroy()}});this.traces=null;this.passes=null;this.scatter.destroy();return this};function f(t,e,r){var n=t.id!=null?t.id:t;var a=e;var i=r;var o=n<<16|(a&255)<<8|i&255;return o}function h(t,e,r){var n,a,i,o,s,l,u,c;var f=t[e],h=t[r];if(f.length>2){n=f[0];i=f[2];a=f[1];o=f[3]}else if(f.length){n=a=f[0];i=o=f[1]}else{n=f.x;a=f.y;i=f.x+f.width;o=f.y+f.height}if(h.length>2){s=h[0];u=h[2];l=h[1];c=h[3]}else if(h.length){s=l=h[0];u=c=h[1]}else{s=h.x;l=h.y;u=h.x+h.width;c=h.y+h.height}return[s,a,u,o]}function p(t){if(typeof t==="number"){return[t,t,t,t]}else if(t.length===2){return[t[0],t[1],t[0],t[1]]}else{var e=l(t);return[e.x,e.y,e.x+e.width,e.y+e.height]}}},{"array-bounds":56,"array-range":58,"flatten-vertex-data":462,"parse-rect":426,"pick-by-alias":432,raf:451,"regl-scatter2d/scatter":460}],462:[function(t,e,r){arguments[4][48][0].apply(r,arguments)},{dtype:153,dup:48}],463:[function(e,r,n){(function(e,a){"object"===typeof n&&"undefined"!==typeof r?r.exports=a():"function"===typeof t&&t.amd?t(a):e.createREGL=a()})(this,function(){function t(t,e){this.id=X++;this.type=t;this.data=e}function e(t){if(0===t.length)return[];var r=t.charAt(0),n=t.charAt(t.length-1);if(1<t.length&&r===n&&('"'===r||"'"===r))return['"'+t.substr(1,t.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t))return e(t.substr(0,r.index)).concat(e(r[1])).concat(e(t.substr(r.index+r[0].length)));r=t.split(".");if(1===r.length)return['"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];t=[];for(n=0;n<r.length;++n)t=t.concat(e(r[n]));return t}function r(t){return"["+e(t).join("][")+"]"}function n(){var t={"":0},e=[""];return{id:function(r){var n=t[r];if(n)return n;n=t[r]=e.length;e.push(r);return n},str:function(t){return e[t]}}}function a(t,e,r){function n(){var e=window.innerWidth,n=window.innerHeight;t!==document.body&&(n=t.getBoundingClientRect(),e=n.right-n.left,n=n.bottom-n.top);a.width=r*e;a.height=r*n;Y(a.style,{width:e+"px",height:n+"px"})}var a=document.createElement("canvas");Y(a.style,{border:0,margin:0,padding:0,top:0,left:0});t.appendChild(a);t===document.body&&(a.style.position="absolute",Y(t.style,{margin:0,padding:0}));window.addEventListener("resize",n,!1);n();return{canvas:a,onDestroy:function(){window.removeEventListener("resize",n);t.removeChild(a)}}}function i(t,e){function r(r){try{return t.getContext(r,e)}catch(t){return null}}return r("webgl")||r("experimental-webgl")||r("webgl-experimental")}function o(t){return"string"===typeof t?t.split():t}function s(t){return"string"===typeof t?document.querySelector(t):t}function l(t){var e=t||{},r,n,l,u;t={};var c=[],f=[],h="undefined"===typeof window?1:window.devicePixelRatio,p=!1,d=function(t){},v=function(){};"string"===typeof e?r=document.querySelector(e):"object"===typeof e&&("string"===typeof e.nodeName&&"function"===typeof e.appendChild&&"function"===typeof e.getBoundingClientRect?r=e:"function"===typeof e.drawArrays||"function"===typeof e.drawElements?(u=e,l=u.canvas):("gl"in e?u=e.gl:"canvas"in e?l=s(e.canvas):"container"in e&&(n=s(e.container)),"attributes"in e&&(t=e.attributes),"extensions"in e&&(c=o(e.extensions)),"optionalExtensions"in e&&(f=o(e.optionalExtensions)),"onDone"in e&&(d=e.onDone),"profile"in e&&(p=!!e.profile),"pixelRatio"in e&&(h=+e.pixelRatio)));r&&("canvas"===r.nodeName.toLowerCase()?l=r:n=r);if(!u){if(!l){r=a(n||document.body,d,h);if(!r)return null;l=r.canvas;v=r.onDestroy}u=i(l,t)}return u?{gl:u,canvas:l,container:n,extensions:c,optionalExtensions:f,pixelRatio:h,profile:p,onDone:d,onDestroy:v}:(v(),d("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function u(t,e){function r(e){e=e.toLowerCase();var r;try{r=n[e]=t.getExtension(e)}catch(t){}return!!r}for(var n={},a=0;a<e.extensions.length;++a){var i=e.extensions[a];if(!r(i))return e.onDestroy(),e.onDone('"'+i+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}e.optionalExtensions.forEach(r);return{extensions:n,restore:function(){Object.keys(n).forEach(function(t){if(!r(t))throw Error("(regl): error restoring extension "+t)})}}}function c(t,e){for(var r=Array(t),n=0;n<t;++n)r[n]=e(n);return r}function f(t){var e,r;e=(65535<t)<<4;t>>>=e;r=(255<t)<<3;t>>>=r;e|=r;r=(15<t)<<2;t>>>=r;e|=r;r=(3<t)<<1;return e|r|t>>>r>>1}function h(){function t(t){t:{for(var e=16;268435456>=e;e*=16)if(t<=e){t=e;break t}t=0}e=r[f(t)>>2];return 0<e.length?e.pop():new ArrayBuffer(t)}function e(t){r[f(t.byteLength)>>2].push(t)}var r=c(8,function(){return[]});return{alloc:t,free:e,allocType:function(e,r){var n=null;switch(e){case 5120:n=new Int8Array(t(r),0,r);break;case 5121:n=new Uint8Array(t(r),0,r);break;case 5122:n=new Int16Array(t(2*r),0,r);break;case 5123:n=new Uint16Array(t(2*r),0,r);break;case 5124:n=new Int32Array(t(4*r),0,r);break;case 5125:n=new Uint32Array(t(4*r),0,r);break;case 5126:n=new Float32Array(t(4*r),0,r);break;default:return null}return n.length!==r?n.subarray(0,r):n},freeType:function(t){e(t.buffer)}}}function p(t){return!!t&&"object"===typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"===typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||tt(t.data))}function d(t,e,r,n,a,i){for(var o=0;o<e;++o)for(var s=t[o],l=0;l<r;++l)for(var u=s[l],c=0;c<n;++c)a[i++]=u[c]}function v(t,e,r,n,a){for(var i=1,o=r+1;o<e.length;++o)i*=e[o];var s=e[r];if(4===e.length-r){var l=e[r+1],u=e[r+2];e=e[r+3];for(o=0;o<s;++o)d(t[o],l,u,e,n,a),a+=i}else for(o=0;o<s;++o)v(t[o],e,r+1,n,a),a+=i}function g(t){return nt[Object.prototype.toString.call(t)]|0}function m(t,e){for(var r=0;r<e.length;++r)t[r]=e[r]}function y(t,e,r,n,a,i,o){for(var s=0,l=0;l<r;++l)for(var u=0;u<n;++u)t[s++]=e[a*l+i*u+o]}function x(t,e,r,n){function a(e){this.id=l++;this.buffer=t.createBuffer();this.type=e;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;r.profile&&(this.stats={size:0})}function i(e,r,n){e.byteLength=r.byteLength;t.bufferData(e.type,r,n)}function o(t,e,r,n,a,o){t.usage=r;if(Array.isArray(e)){if(t.dtype=n||5126,0<e.length)if(Array.isArray(e[0])){a=st(e);for(var s=n=1;s<a.length;++s)n*=a[s];t.dimension=n;e=ot(e,a,t.dtype);i(t,e,r);o?t.persistentData=e:K.freeType(e)}else"number"===typeof e[0]?(t.dimension=a,a=K.allocType(t.dtype,e.length),m(a,e),i(t,a,r),o?t.persistentData=a:K.freeType(a)):tt(e[0])&&(t.dimension=e[0].length,t.dtype=n||g(e[0])||5126,e=ot(e,[e.length,e[0].length],t.dtype),i(t,e,r),o?t.persistentData=e:K.freeType(e))}else if(tt(e))t.dtype=n||g(e),t.dimension=a,i(t,e,r),o&&(t.persistentData=new Uint8Array(new Uint8Array(e.buffer)));else if(p(e)){a=e.shape;var l=e.stride,s=e.offset,u=0,c=0,f=0,h=0;1===a.length?(u=a[0],c=1,f=l[0],h=0):2===a.length&&(u=a[0],c=a[1],f=l[0],h=l[1]);t.dtype=n||g(e.data)||5126;t.dimension=c;a=K.allocType(t.dtype,u*c);y(a,e.data,u,c,f,h,s);i(t,a,r);o?t.persistentData=a:K.freeType(a)}}function s(r){e.bufferCount--;for(var a=0;a<n.state.length;++a){var i=n.state[a];i.buffer===r&&(t.disableVertexAttribArray(a),i.buffer=null)}t.deleteBuffer(r.buffer);r.buffer=null;delete u[r.id]}var l=0,u={};a.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)};a.prototype.destroy=function(){s(this)};var c=[];r.profile&&(e.getTotalBufferSize=function(){var t=0;Object.keys(u).forEach(function(e){t+=u[e].stats.size});return t});return{create:function(n,i,l,c){function f(e){var n=35044,a=null,i=0,s=0,l=1;Array.isArray(e)||tt(e)||p(e)?a=e:"number"===typeof e?i=e|0:e&&("data"in e&&(a=e.data),"usage"in e&&(n=it[e.usage]),"type"in e&&(s=at[e.type]),"dimension"in e&&(l=e.dimension|0),"length"in e&&(i=e.length|0));h.bind();a?o(h,a,n,s,l,c):(i&&t.bufferData(h.type,i,n),h.dtype=s||5121,h.usage=n,h.dimension=l,h.byteLength=i);r.profile&&(h.stats.size=h.byteLength*lt[h.dtype]);return f}e.bufferCount++;var h=new a(i);u[h.id]=h;l||f(n);f._reglType="buffer";f._buffer=h;f.subdata=function(e,r){var n=(r||0)|0,a;h.bind();if(tt(e))t.bufferSubData(h.type,n,e);else if(Array.isArray(e)){if(0<e.length)if("number"===typeof e[0]){var i=K.allocType(h.dtype,e.length);m(i,e);t.bufferSubData(h.type,n,i);K.freeType(i)}else if(Array.isArray(e[0])||tt(e[0]))a=st(e),i=ot(e,a,h.dtype),t.bufferSubData(h.type,n,i),K.freeType(i)}else if(p(e)){a=e.shape;var o=e.stride,s=i=0,l=0,u=0;1===a.length?(i=a[0],s=1,l=o[0],u=0):2===a.length&&(i=a[0],s=a[1],l=o[0],u=o[1]);a=Array.isArray(e.data)?h.dtype:g(e.data);a=K.allocType(a,i*s);y(a,e.data,i,s,l,u,e.offset);t.bufferSubData(h.type,n,a);K.freeType(a)}return f};r.profile&&(f.stats=h.stats);f.destroy=function(){s(h)};return f},createStream:function(t,e){var r=c.pop();r||(r=new a(t));r.bind();o(r,e,35040,0,1,!1);return r},destroyStream:function(t){c.push(t)},clear:function(){et(u).forEach(s);c.forEach(s)},getBuffer:function(t){return t&&t._buffer instanceof a?t._buffer:null},restore:function(){et(u).forEach(function(e){e.buffer=t.createBuffer();t.bindBuffer(e.type,e.buffer);t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)})},_initBuffer:o}}function b(t,e,r,n){function a(t){this.id=l++;s[this.id]=this;this.buffer=t;this.primType=4;this.type=this.vertCount=0}function i(n,a,i,o,s,l,u){n.buffer.bind();if(a){var c=u;u||tt(a)&&(!p(a)||tt(a.data))||(c=e.oes_element_index_uint?5125:5123);r._initBuffer(n.buffer,a,i,c,3)}else t.bufferData(34963,l,i),n.buffer.dtype=c||5121,n.buffer.usage=i,n.buffer.dimension=3,n.buffer.byteLength=l;c=u;if(!u){switch(n.buffer.dtype){case 5121:case 5120:c=5121;break;case 5123:case 5122:c=5123;break;case 5125:case 5124:c=5125}n.buffer.dtype=c}n.type=c;a=s;0>a&&(a=n.buffer.byteLength,5123===c?a>>=1:5125===c&&(a>>=2));n.vertCount=a;a=o;0>o&&(a=4,o=n.buffer.dimension,1===o&&(a=0),2===o&&(a=1),3===o&&(a=4));n.primType=a}function o(t){n.elementsCount--;delete s[t.id];t.buffer.destroy();t.buffer=null}var s={},l=0,u={uint8:5121,uint16:5123};e.oes_element_index_uint&&(u.uint32=5125);a.prototype.bind=function(){this.buffer.bind()};var c=[];return{create:function(t,e){function s(t){if(t)if("number"===typeof t)l(t),c.primType=4,c.vertCount=t|0,c.type=5121;else{var e=null,r=35044,n=-1,a=-1,o=0,f=0;if(Array.isArray(t)||tt(t)||p(t))e=t;else if("data"in t&&(e=t.data),"usage"in t&&(r=it[t.usage]),"primitive"in t&&(n=ut[t.primitive]),"count"in t&&(a=t.count|0),"type"in t&&(f=u[t.type]),"length"in t)o=t.length|0;else if(o=a,5123===f||5122===f)o*=2;else if(5125===f||5124===f)o*=4;i(c,e,r,n,a,o,f)}else l(),c.primType=4,c.vertCount=0,c.type=5121;return s}var l=r.create(null,34963,!0),c=new a(l._buffer);n.elementsCount++;s(t);s._reglType="elements";s._elements=c;s.subdata=function(t,e){l.subdata(t,e);return s};s.destroy=function(){o(c)};return s},createStream:function(t){var e=c.pop();e||(e=new a(r.create(null,34963,!0,!1)._buffer));i(e,t,35040,-1,-1,0,0);return e},destroyStream:function(t){c.push(t)},getElements:function(t){return"function"===typeof t&&t._elements instanceof a?t._elements:null},clear:function(){et(s).forEach(o)}}}function _(t){for(var e=K.allocType(5123,t.length),r=0;r<t.length;++r)if(isNaN(t[r]))e[r]=65535;else if(Infinity===t[r])e[r]=31744;else if(-Infinity===t[r])e[r]=64512;else{ct[0]=t[r];var n=ft[0],a=n>>>31<<15,i=(n<<1>>>24)-127,n=n>>13&1023;e[r]=-24>i?a:-14>i?a+(n+1024>>-14-i):15<i?a+31744:a+(i+15<<10)+n}return e}function w(t){return Array.isArray(t)||tt(t)}function k(t){return"[object "+t+"]"}function M(t){return Array.isArray(t)&&(0===t.length||"number"===typeof t[0])}function A(t){return Array.isArray(t)&&0!==t.length&&w(t[0])?!0:!1}function T(t){return Object.prototype.toString.call(t)}function S(t){if(!t)return!1;var e=T(t);return 0<=bt.indexOf(e)?!0:M(t)||A(t)||p(t)}function E(t,e){36193===t.type?(t.data=_(e),K.freeType(e)):t.data=e}function C(t,e,r,n,a,i){t="undefined"!==typeof wt[t]?wt[t]:dt[t]*_t[e];i&&(t*=6);if(a){for(n=0;1<=r;)n+=t*r*r,r/=2;return n}return t*r*n}function L(t,e,r,n,a,i,o){function s(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.colorSpace=37444;this.channels=this.height=this.width=0}function l(t,e){t.internalformat=e.internalformat;t.format=e.format;t.type=e.type;t.compressed=e.compressed;t.premultiplyAlpha=e.premultiplyAlpha;t.flipY=e.flipY;t.unpackAlignment=e.unpackAlignment;t.colorSpace=e.colorSpace;t.width=e.width;t.height=e.height;t.channels=e.channels}function u(t,e){if("object"===typeof e&&e){"premultiplyAlpha"in e&&(t.premultiplyAlpha=e.premultiplyAlpha);"flipY"in e&&(t.flipY=e.flipY);"alignment"in e&&(t.unpackAlignment=e.alignment);"colorSpace"in e&&(t.colorSpace=U[e.colorSpace]);"type"in e&&(t.type=q[e.type]);var r=t.width,n=t.height,a=t.channels,i=!1;"shape"in e?(r=e.shape[0],n=e.shape[1],3===e.shape.length&&(a=e.shape[2],i=!0)):("radius"in e&&(r=n=e.radius),"width"in e&&(r=e.width),"height"in e&&(n=e.height),"channels"in e&&(a=e.channels,i=!0));t.width=r|0;t.height=n|0;t.channels=a|0;r=!1;"format"in e&&(r=e.format,n=t.internalformat=H[r],t.format=it[n],r in q&&!("type"in e)&&(t.type=q[r]),r in G&&(t.compressed=!0),r=!0);!i&&r?t.channels=dt[t.format]:i&&!r&&t.channels!==pt[t.format]&&(t.format=t.internalformat=pt[t.channels])}}function c(e){t.pixelStorei(37440,e.flipY);t.pixelStorei(37441,e.premultiplyAlpha);t.pixelStorei(37443,e.colorSpace);t.pixelStorei(3317,e.unpackAlignment)}function f(){s.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function h(t,e){var r=null;S(e)?r=e:e&&(u(t,e),"x"in e&&(t.xOffset=e.x|0),"y"in e&&(t.yOffset=e.y|0),S(e.data)&&(r=e.data));if(e.copy){var n=a.viewportWidth,i=a.viewportHeight;t.width=t.width||n-t.xOffset;t.height=t.height||i-t.yOffset;t.needsCopy=!0}else if(!r)t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;else if(tt(r))t.channels=t.channels||4,t.data=r,"type"in e||5121!==t.type||(t.type=nt[Object.prototype.toString.call(r)]|0);else if(M(r)){t.channels=t.channels||4;n=r;i=n.length;switch(t.type){case 5121:case 5123:case 5125:case 5126:i=K.allocType(t.type,i);i.set(n);t.data=i;break;case 36193:t.data=_(n)}t.alignment=1;t.needsFree=!0}else if(p(r)){n=r.data;Array.isArray(n)||5121!==t.type||(t.type=nt[Object.prototype.toString.call(n)]|0);var i=r.shape,o=r.stride,s,l,c,f;3===i.length?(c=i[2],f=o[2]):f=c=1;s=i[0];l=i[1];i=o[0];o=o[1];t.alignment=1;t.width=s;t.height=l;t.channels=c;t.format=t.internalformat=pt[c];t.needsFree=!0;s=f;r=r.offset;c=t.width;f=t.height;l=t.channels;for(var h=K.allocType(36193===t.type?5126:t.type,c*f*l),d=0,v=0;v<f;++v)for(var g=0;g<c;++g)for(var m=0;m<l;++m)h[d++]=n[i*g+o*v+s*m+r];E(t,h)}else if(T(r)===vt||T(r)===gt)T(r)===vt?t.element=r:t.element=r.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(T(r)===mt)t.element=r,t.width=r.width,t.height=r.height,t.channels=4;else if(T(r)===yt)t.element=r,t.width=r.naturalWidth,t.height=r.naturalHeight,t.channels=4;else if(T(r)===xt)t.element=r,t.width=r.videoWidth,t.height=r.videoHeight,t.channels=4;else if(A(r)){n=t.width||r[0].length;i=t.height||r.length;o=t.channels;o=w(r[0][0])?o||r[0][0].length:o||1;s=rt.shape(r);c=1;for(f=0;f<s.length;++f)c*=s[f];c=K.allocType(36193===t.type?5126:t.type,c);rt.flatten(r,s,"",c);E(t,c);t.alignment=1;t.width=n;t.height=i;t.channels=o;t.format=t.internalformat=pt[o];t.needsFree=!0}}function d(e,r,a,i,o){var s=e.element,l=e.data,u=e.internalformat,f=e.format,h=e.type,p=e.width,d=e.height;c(e);s?t.texSubImage2D(r,o,a,i,f,h,s):e.compressed?t.compressedTexSubImage2D(r,o,a,i,u,p,d,l):e.needsCopy?(n(),t.copyTexSubImage2D(r,o,a,i,e.xOffset,e.yOffset,p,d)):t.texSubImage2D(r,o,a,i,p,d,f,h,l)}function v(){return ot.pop()||new f}function g(t){t.needsFree&&K.freeType(t.data);f.call(t);ot.push(t)}function m(){s.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function y(t,e,r){var n=t.images[0]=v();t.mipmask=1;n.width=t.width=e;n.height=t.height=r;n.channels=t.channels=4}function x(t,e){var r=null;if(S(e))r=t.images[0]=v(),l(r,t),h(r,e),t.mipmask=1;else if(u(t,e),Array.isArray(e.mipmap))for(var n=e.mipmap,a=0;a<n.length;++a)r=t.images[a]=v(),l(r,t),r.width>>=a,r.height>>=a,h(r,n[a]),t.mipmask|=1<<a;else r=t.images[0]=v(),l(r,t),h(r,e),t.mipmask=1;l(t,t.images[0])}function b(e,r){for(var a=e.images,i=0;i<a.length&&a[i];++i){var o=a[i],s=r,l=i,u=o.element,f=o.data,h=o.internalformat,p=o.format,d=o.type,v=o.width,g=o.height,m=o.channels;c(o);u?t.texImage2D(s,l,p,p,d,u):o.compressed?t.compressedTexImage2D(s,l,h,v,g,0,f):o.needsCopy?(n(),t.copyTexImage2D(s,l,p,o.xOffset,o.yOffset,v,g,0)):((o=!f)&&(f=K.zero.allocType(d,v*g*m)),t.texImage2D(s,l,p,v,g,0,p,d,f),o&&f&&K.zero.freeType(f))}}function k(){var t=st.pop()||new m;s.call(t);for(var e=t.mipmask=0;16>e;++e)t.images[e]=null;return t}function L(t){for(var e=t.images,r=0;r<e.length;++r)e[r]&&g(e[r]),e[r]=null;st.push(t)}function I(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function z(t,e){"min"in e&&(t.minFilter=V[e.min],0<=ht.indexOf(t.minFilter)&&!("faces"in e)&&(t.genMipmaps=!0));"mag"in e&&(t.magFilter=j[e.mag]);var r=t.wrapS,n=t.wrapT;if("wrap"in e){var a=e.wrap;"string"===typeof a?r=n=N[a]:Array.isArray(a)&&(r=N[a[0]],n=N[a[1]])}else"wrapS"in e&&(r=N[e.wrapS]),"wrapT"in e&&(n=N[e.wrapT]);t.wrapS=r;t.wrapT=n;"anisotropic"in e&&(t.anisotropic=e.anisotropic);if("mipmap"in e){r=!1;switch(typeof e.mipmap){case"string":t.mipmapHint=F[e.mipmap];r=t.genMipmaps=!0;break;case"boolean":r=t.genMipmaps=e.mipmap;break;case"object":t.genMipmaps=!1,r=!0}!r||"min"in e||(t.minFilter=9984)}}function P(r,n){t.texParameteri(n,10241,r.minFilter);t.texParameteri(n,10240,r.magFilter);t.texParameteri(n,10242,r.wrapS);t.texParameteri(n,10243,r.wrapT);e.ext_texture_filter_anisotropic&&t.texParameteri(n,34046,r.anisotropic);r.genMipmaps&&(t.hint(33170,r.mipmapHint),t.generateMipmap(n))}function O(e){s.call(this);this.mipmask=0;this.internalformat=6408;this.id=lt++;this.refCount=1;this.target=e;this.texture=t.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new I;o.profile&&(this.stats={size:0})}function D(e){t.activeTexture(33984);t.bindTexture(e.target,e.texture)}function R(){var e=ft[0];e?t.bindTexture(e.target,e.texture):t.bindTexture(3553,null)}function B(e){var r=e.texture,n=e.unit,a=e.target;0<=n&&(t.activeTexture(33984+n),t.bindTexture(a,null),ft[n]=null);t.deleteTexture(r);e.texture=null;e.params=null;e.pixels=null;e.refCount=0;delete ut[e.id];i.textureCount--}var F={"don't care":4352,"dont care":4352,nice:4354,fast:4353},N={repeat:10497,clamp:33071,mirror:33648},j={nearest:9728,linear:9729},V=Y({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},j),U={none:0,browser:37444},q={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},H={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},G={};e.ext_srgb&&(H.srgb=35904,H.srgba=35906);e.oes_texture_float&&(q.float32=q["float"]=5126);e.oes_texture_half_float&&(q.float16=q["half float"]=36193);e.webgl_depth_texture&&(Y(H,{depth:6402,"depth stencil":34041}),Y(q,{uint16:5123,uint32:5125,"depth stencil":34042}));e.webgl_compressed_texture_s3tc&&Y(G,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});e.webgl_compressed_texture_atc&&Y(G,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});e.webgl_compressed_texture_pvrtc&&Y(G,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});e.webgl_compressed_texture_etc1&&(G["rgb etc1"]=36196);var W=Array.prototype.slice.call(t.getParameter(34467));Object.keys(G).forEach(function(t){var e=G[t];0<=W.indexOf(e)&&(H[t]=e)});var X=Object.keys(H);r.textureFormats=X;var Z=[];Object.keys(H).forEach(function(t){Z[H[t]]=t});var $=[];Object.keys(q).forEach(function(t){$[q[t]]=t});var J=[];Object.keys(j).forEach(function(t){J[j[t]]=t});var Q=[];Object.keys(V).forEach(function(t){Q[V[t]]=t});var at=[];Object.keys(N).forEach(function(t){at[N[t]]=t});var it=X.reduce(function(t,e){var r=H[e];6409===r||6406===r||6409===r||6410===r||6402===r||34041===r?t[r]=r:32855===r||0<=e.indexOf("rgba")?t[r]=6408:t[r]=6407;return t},{}),ot=[],st=[],lt=0,ut={},ct=r.maxTextureUnits,ft=Array(ct).map(function(){return null});Y(O.prototype,{bind:function(){this.bindCount+=1;var e=this.unit;if(0>e){for(var r=0;r<ct;++r){var n=ft[r];if(n){if(0<n.bindCount)continue;n.unit=-1}ft[r]=this;e=r;break}o.profile&&i.maxTextureUnits<e+1&&(i.maxTextureUnits=e+1);this.unit=e;t.activeTexture(33984+e);t.bindTexture(this.target,this.texture)}return e},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&B(this)}});o.profile&&(i.getTotalTextureSize=function(){var t=0;Object.keys(ut).forEach(function(e){t+=ut[e].stats.size});return t});return{create2D:function(e,r){function n(t,e){var r=a.texInfo;I.call(r);var i=k();"number"===typeof t?"number"===typeof e?y(i,t|0,e|0):y(i,t|0,t|0):t?(z(r,t),x(i,t)):y(i,1,1);r.genMipmaps&&(i.mipmask=(i.width<<1)-1);a.mipmask=i.mipmask;l(a,i);a.internalformat=i.internalformat;n.width=i.width;n.height=i.height;D(a);b(i,3553);P(r,3553);R();L(i);o.profile&&(a.stats.size=C(a.internalformat,a.type,i.width,i.height,r.genMipmaps,!1));n.format=Z[a.internalformat];n.type=$[a.type];n.mag=J[r.magFilter];n.min=Q[r.minFilter];n.wrapS=at[r.wrapS];n.wrapT=at[r.wrapT];return n}var a=new O(3553);ut[a.id]=a;i.textureCount++;n(e,r);n.subimage=function(t,e,r,i){e|=0;r|=0;i|=0;var o=v();l(o,a);o.width=0;o.height=0;h(o,t);o.width=o.width||(a.width>>i)-e;o.height=o.height||(a.height>>i)-r;D(a);d(o,3553,e,r,i);R();g(o);return n};n.resize=function(e,r){var i=e|0,s=r|0||i;if(i===a.width&&s===a.height)return n;n.width=a.width=i;n.height=a.height=s;D(a);for(var l,u=a.channels,c=a.type,f=0;a.mipmask>>f;++f){var h=i>>f,p=s>>f;if(!h||!p)break;l=K.zero.allocType(c,h*p*u);t.texImage2D(3553,f,a.format,h,p,0,a.format,a.type,l);l&&K.zero.freeType(l)}R();o.profile&&(a.stats.size=C(a.internalformat,a.type,i,s,!1,!1));return n};n._reglType="texture2d";n._texture=a;o.profile&&(n.stats=a.stats);n.destroy=function(){a.decRef()};return n},createCube:function(e,r,n,a,s,c){function f(t,e,r,n,a,i){var s,c=p.texInfo;I.call(c);for(s=0;6>s;++s)m[s]=k();if("number"===typeof t||!t)for(t=t|0||1,s=0;6>s;++s)y(m[s],t,t);else if("object"===typeof t)if(e)x(m[0],t),x(m[1],e),x(m[2],r),x(m[3],n),x(m[4],a),x(m[5],i);else if(z(c,t),u(p,t),"faces"in t)for(t=t.faces,s=0;6>s;++s)l(m[s],p),x(m[s],t[s]);else for(s=0;6>s;++s)x(m[s],t);l(p,m[0]);p.mipmask=c.genMipmaps?(m[0].width<<1)-1:m[0].mipmask;p.internalformat=m[0].internalformat;f.width=m[0].width;f.height=m[0].height;D(p);for(s=0;6>s;++s)b(m[s],34069+s);P(c,34067);R();o.profile&&(p.stats.size=C(p.internalformat,p.type,f.width,f.height,c.genMipmaps,!0));f.format=Z[p.internalformat];f.type=$[p.type];f.mag=J[c.magFilter];f.min=Q[c.minFilter];f.wrapS=at[c.wrapS];f.wrapT=at[c.wrapT];for(s=0;6>s;++s)L(m[s]);return f}var p=new O(34067);ut[p.id]=p;i.cubeCount++;var m=Array(6);f(e,r,n,a,s,c);f.subimage=function(t,e,r,n,a){r|=0;n|=0;a|=0;var i=v();l(i,p);i.width=0;i.height=0;h(i,e);i.width=i.width||(p.width>>a)-r;i.height=i.height||(p.height>>a)-n;D(p);d(i,34069+t,r,n,a);R();g(i);return f};f.resize=function(e){e|=0;if(e!==p.width){f.width=p.width=e;f.height=p.height=e;D(p);for(var r=0;6>r;++r)for(var n=0;p.mipmask>>n;++n)t.texImage2D(34069+r,n,p.format,e>>n,e>>n,0,p.format,p.type,null);R();o.profile&&(p.stats.size=C(p.internalformat,p.type,f.width,f.height,!1,!0));return f}};f._reglType="textureCube";f._texture=p;o.profile&&(f.stats=p.stats);f.destroy=function(){p.decRef()};return f},clear:function(){for(var e=0;e<ct;++e)t.activeTexture(33984+e),t.bindTexture(3553,null),ft[e]=null;et(ut).forEach(B);i.cubeCount=0;i.textureCount=0},getTexture:function(t){return null},restore:function(){et(ut).forEach(function(e){e.texture=t.createTexture();t.bindTexture(e.target,e.texture);for(var r=0;32>r;++r)if(0!==(e.mipmask&1<<r))if(3553===e.target)t.texImage2D(3553,r,e.internalformat,e.width>>r,e.height>>r,0,e.internalformat,e.type,null);else for(var n=0;6>n;++n)t.texImage2D(34069+n,r,e.internalformat,e.width>>r,e.height>>r,0,e.internalformat,e.type,null);P(e.texInfo,e.target)})}}}function I(t,e,r,n,a,i){function o(t,e,r){this.target=t;this.texture=e;this.renderbuffer=r;var n=t=0;e?(t=e.width,n=e.height):r&&(t=r.width,n=r.height);this.width=t;this.height=n}function s(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function l(t,e,r){t&&(t.texture?t.texture._texture.refCount+=1:t.renderbuffer._renderbuffer.refCount+=1)}function u(e,r){r&&(r.texture?t.framebufferTexture2D(36160,e,r.target,r.texture._texture.texture,0):t.framebufferRenderbuffer(36160,e,36161,r.renderbuffer._renderbuffer.renderbuffer))}function c(t){var e=3553,r=null,n=null,a=t;"object"===typeof t&&(a=t.data,"target"in t&&(e=t.target|0));t=a._reglType;"texture2d"===t?r=a:"textureCube"===t?r=a:"renderbuffer"===t&&(n=a,e=36161);return new o(e,r,n)}function f(t,e,r,i,s){if(r)return t=n.create2D({width:t,height:e,format:i,type:s}),t._texture.refCount=0,new o(3553,t,null);t=a.create({width:t,height:e,format:i});t._renderbuffer.refCount=0;return new o(36161,null,t)}function h(t){return t&&(t.texture||t.renderbuffer)}function p(t,e,r){t&&(t.texture?t.texture.resize(e,r):t.renderbuffer&&t.renderbuffer.resize(e,r))}function d(){this.id=k++;M[this.id]=this;this.framebuffer=t.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function v(t){t.colorAttachments.forEach(s);s(t.depthAttachment);s(t.stencilAttachment);s(t.depthStencilAttachment)}function g(e){t.deleteFramebuffer(e.framebuffer);e.framebuffer=null;i.framebufferCount--;delete M[e.id]}function m(e){var n;t.bindFramebuffer(36160,e.framebuffer);var a=e.colorAttachments;for(n=0;n<a.length;++n)u(36064+n,a[n]);for(n=a.length;n<r.maxColorAttachments;++n)t.framebufferTexture2D(36160,36064+n,3553,null,0);t.framebufferTexture2D(36160,33306,3553,null,0);t.framebufferTexture2D(36160,36096,3553,null,0);t.framebufferTexture2D(36160,36128,3553,null,0);u(36096,e.depthAttachment);u(36128,e.stencilAttachment);u(33306,e.depthStencilAttachment);t.checkFramebufferStatus(36160);t.bindFramebuffer(36160,x.next?x.next.framebuffer:null);x.cur=x.next;t.getError()}function y(t,e){function r(t,e){var a,i=0,o=0,s=!0,u=!0;a=null;var p=!0,d="rgba",g="uint8",y=1,x=null,w=null,k=null,M=!1;if("number"===typeof t)i=t|0,o=e|0||i;else if(t){"shape"in t?(o=t.shape,i=o[0],o=o[1]):("radius"in t&&(i=o=t.radius),"width"in t&&(i=t.width),"height"in t&&(o=t.height));if("color"in t||"colors"in t)a=t.color||t.colors,Array.isArray(a);if(!a){"colorCount"in t&&(y=t.colorCount|0);"colorTexture"in t&&(p=!!t.colorTexture,d="rgba4");if("colorType"in t&&(g=t.colorType,!p))if("half float"===g||"float16"===g)d="rgba16f";else if("float"===g||"float32"===g)d="rgba32f";"colorFormat"in t&&(d=t.colorFormat,0<=b.indexOf(d)?p=!0:0<=_.indexOf(d)&&(p=!1))}if("depthTexture"in t||"depthStencilTexture"in t)M=!(!t.depthTexture&&!t.depthStencilTexture);"depth"in t&&("boolean"===typeof t.depth?s=t.depth:(x=t.depth,u=!1));"stencil"in t&&("boolean"===typeof t.stencil?u=t.stencil:(w=t.stencil,s=!1));"depthStencil"in t&&("boolean"===typeof t.depthStencil?s=u=t.depthStencil:(k=t.depthStencil,u=s=!1))}else i=o=1;var A=null,T=null,S=null,E=null;if(Array.isArray(a))A=a.map(c);else if(a)A=[c(a)];else for(A=Array(y),a=0;a<y;++a)A[a]=f(i,o,p,d,g);i=i||A[0].width;o=o||A[0].height;x?T=c(x):s&&!u&&(T=f(i,o,M,"depth","uint32"));w?S=c(w):u&&!s&&(S=f(i,o,!1,"stencil","uint8"));k?E=c(k):!x&&!w&&u&&s&&(E=f(i,o,M,"depth stencil","depth stencil"));s=null;for(a=0;a<A.length;++a)l(A[a],i,o),A[a]&&A[a].texture&&(u=At[A[a].texture._texture.format]*Tt[A[a].texture._texture.type],null===s&&(s=u));l(T,i,o);l(S,i,o);l(E,i,o);v(n);n.width=i;n.height=o;n.colorAttachments=A;n.depthAttachment=T;n.stencilAttachment=S;n.depthStencilAttachment=E;r.color=A.map(h);r.depth=h(T);r.stencil=h(S);r.depthStencil=h(E);r.width=n.width;r.height=n.height;m(n);return r}var n=new d;i.framebufferCount++;r(t,e);return Y(r,{resize:function(t,e){var a=t|0,i=e|0||a;if(a===n.width&&i===n.height)return r;for(var o=n.colorAttachments,s=0;s<o.length;++s)p(o[s],a,i);p(n.depthAttachment,a,i);p(n.stencilAttachment,a,i);p(n.depthStencilAttachment,a,i);n.width=r.width=a;n.height=r.height=i;m(n);return r},_reglType:"framebuffer",_framebuffer:n,destroy:function(){g(n);v(n)},use:function(t){x.setFBO({framebuffer:r},t)}})}var x={cur:null,next:null,dirty:!1,setFBO:null},b=["rgba"],_=["rgba4","rgb565","rgb5 a1"];e.ext_srgb&&_.push("srgba");e.ext_color_buffer_half_float&&_.push("rgba16f","rgb16f");e.webgl_color_buffer_float&&_.push("rgba32f");var w=["uint8"];e.oes_texture_half_float&&w.push("half float","float16");e.oes_texture_float&&w.push("float","float32");var k=0,M={};return Y(x,{getFramebuffer:function(t){return"function"===typeof t&&"framebuffer"===t._reglType&&(t=t._framebuffer,t instanceof d)?t:null},create:y,createCube:function(t){function e(t){var a,i={color:null},o=0,s=null;a="rgba";var l="uint8",u=1;if("number"===typeof t)o=t|0;else if(t){"shape"in t?o=t.shape[0]:("radius"in t&&(o=t.radius|0),"width"in t?o=t.width|0:"height"in t&&(o=t.height|0));if("color"in t||"colors"in t)s=t.color||t.colors,Array.isArray(s);s||("colorCount"in t&&(u=t.colorCount|0),"colorType"in t&&(l=t.colorType),"colorFormat"in t&&(a=t.colorFormat));"depth"in t&&(i.depth=t.depth);"stencil"in t&&(i.stencil=t.stencil);"depthStencil"in t&&(i.depthStencil=t.depthStencil)}else o=1;if(s)if(Array.isArray(s))for(t=[],a=0;a<s.length;++a)t[a]=s[a];else t=[s];else for(t=Array(u),s={radius:o,format:a,type:l},a=0;a<u;++a)t[a]=n.createCube(s);i.color=Array(t.length);for(a=0;a<t.length;++a)u=t[a],o=o||u.width,i.color[a]={target:34069,data:t[a]};for(a=0;6>a;++a){for(u=0;u<t.length;++u)i.color[u].target=34069+a;0<a&&(i.depth=r[0].depth,i.stencil=r[0].stencil,i.depthStencil=r[0].depthStencil);if(r[a])r[a](i);else r[a]=y(i)}return Y(e,{width:o,height:o,color:t})}var r=Array(6);e(t);return Y(e,{faces:r,resize:function(t){var n=t|0;if(n===e.width)return e;var a=e.color;for(t=0;t<a.length;++t)a[t].resize(n);for(t=0;6>t;++t)r[t].resize(n);e.width=e.height=n;return e},_reglType:"framebufferCube",destroy:function(){r.forEach(function(t){t.destroy()})}})},clear:function(){et(M).forEach(g)},restore:function(){et(M).forEach(function(e){e.framebuffer=t.createFramebuffer();m(e)})}})}function z(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}function P(t,e,r,n){t=r.maxAttributes;e=Array(t);for(r=0;r<t;++r)e[r]=new z;return{Record:z,scope:{},state:e}}function O(t,e,r,n){function a(t,e,r,n){this.name=t;this.id=e;this.location=r;this.info=n}function i(t,e){for(var r=0;r<t.length;++r)if(t[r].id===e.id){t[r].location=e.location;return}t.push(e)}function o(r,n,a){a=35632===r?u:c;var i=a[n];if(!i){var o=e.str(n),i=t.createShader(r);t.shaderSource(i,o);t.compileShader(i);a[n]=i}return i}function s(t,e){this.id=p++;this.fragId=t;this.vertId=e;this.program=null;this.uniforms=[];this.attributes=[];n.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function l(r,s){var l,u;l=o(35632,r.fragId);u=o(35633,r.vertId);var c=r.program=t.createProgram();t.attachShader(c,l);t.attachShader(c,u);t.linkProgram(c);var f=t.getProgramParameter(c,35718);n.profile&&(r.stats.uniformsCount=f);var h=r.uniforms;for(l=0;l<f;++l)if(u=t.getActiveUniform(c,l))if(1<u.size)for(var p=0;p<u.size;++p){var d=u.name.replace("[0]","["+p+"]");i(h,new a(d,e.id(d),t.getUniformLocation(c,d),u))}else i(h,new a(u.name,e.id(u.name),t.getUniformLocation(c,u.name),u));f=t.getProgramParameter(c,35721);n.profile&&(r.stats.attributesCount=f);h=r.attributes;for(l=0;l<f;++l)(u=t.getActiveAttrib(c,l))&&i(h,new a(u.name,e.id(u.name),t.getAttribLocation(c,u.name),u))}var u={},c={},f={},h=[],p=0;n.profile&&(r.getMaxUniformsCount=function(){var t=0;h.forEach(function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)});return t},r.getMaxAttributesCount=function(){var t=0;h.forEach(function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)});return t});return{clear:function(){var e=t.deleteShader.bind(t);et(u).forEach(e);u={};et(c).forEach(e);c={};h.forEach(function(e){t.deleteProgram(e.program)});h.length=0;f={};r.shaderCount=0},program:function(t,e,n){var a=f[e];a||(a=f[e]={});var i=a[t];i||(i=new s(e,t),r.shaderCount++,l(i,n),a[t]=i,h.push(i));return i},restore:function(){u={};c={};for(var t=0;t<h.length;++t)l(h[t])},shader:o,frag:-1,vert:-1}}function D(t,e,r,n,a,i,o){function s(a){var i;i=null===e.next?5121:e.next.colorAttachments[0].texture._texture.type;var o=0,s=0,l=n.framebufferWidth,u=n.framebufferHeight,c=null;tt(a)?c=a:a&&(o=a.x|0,s=a.y|0,l=(a.width||n.framebufferWidth-o)|0,u=(a.height||n.framebufferHeight-s)|0,c=a.data||null);r();a=l*u*4;c||(5121===i?c=new Uint8Array(a):5126===i&&(c=c||new Float32Array(a)));t.pixelStorei(3333,4);t.readPixels(o,s,l,u,6408,i,c);return c}function l(t){var r;e.setFBO({framebuffer:t.framebuffer},function(){r=s(t)});return r}return function(t){return t&&"framebuffer"in t?l(t):s(t)}}function R(t){return Array.prototype.slice.call(t)}function B(t){return R(t).join("")}function F(){function t(){var t=[],e=[];return Y(function(){t.push.apply(t,R(arguments))},{def:function(){var n="v"+r++;e.push(n);0<arguments.length&&(t.push(n,"="),t.push.apply(t,R(arguments)),t.push(";"));return n},toString:function(){return B([0<e.length?"var "+e+";":"",B(t)])}})}function e(){function e(t,e){n(t,e,"=",r.def(t,e),";")}var r=t(),n=t(),a=r.toString,i=n.toString;return Y(function(){r.apply(r,R(arguments))},{def:r.def,entry:r,exit:n,save:e,set:function(t,n,a){e(t,n);r(t,n,"=",a,";")},toString:function(){return a()+i()}})}var r=0,n=[],a=[],i=t(),o={};return{global:i,link:function(t){for(var e=0;e<a.length;++e)if(a[e]===t)return n[e];e="g"+r++;n.push(e);a.push(t);return e},block:t,proc:function(t,r){function n(){var t="a"+a.length;a.push(t);return t}var a=[];r=r||0;for(var i=0;i<r;++i)n();var i=e(),s=i.toString;return o[t]=Y(i,{arg:n,toString:function(){return B(["function(",a.join(),"){",s(),"}"])}})},scope:e,cond:function(){var t=B(arguments),r=e(),n=e(),a=r.toString,i=n.toString;return Y(r,{then:function(){r.apply(r,R(arguments));return this},else:function(){n.apply(n,R(arguments));return this},toString:function(){var e=i();e&&(e="else{"+e+"}");return B(["if(",t,"){",a(),"}",e])}})},compile:function(){var t=['"use strict";',i,"return {"];Object.keys(o).forEach(function(e){t.push('"',e,'":',o[e].toString(),",")});t.push("}");var e=B(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(e)).apply(null,a)}}}function N(t){return Array.isArray(t)||tt(t)||p(t)}function j(t){return t.sort(function(t,e){return"viewport"===t?-1:"viewport"===e?1:t<e?-1:1})}function V(t,e,r,n){this.thisDep=t;this.contextDep=e;this.propDep=r;this.append=n}function U(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function q(t){return new V(!1,!1,!1,t)}function H(t,e){var r=t.type;return 0===r?(r=t.data.length,new V(!0,1<=r,2<=r,e)):4===r?(r=t.data,new V(r.thisDep,r.contextDep,r.propDep,e)):new V(3===r,2===r,1===r,e)}function G(t,e,r,n,a,i,o,s,l,u,f,h,p,d,v){function g(t){return t.replace(".","_")}function m(t,e,r){var n=g(t);ft.push(t);ct[n]=lt[n]=!!r;ht[n]=e}function y(t,e,r){var n=g(t);ft.push(t);Array.isArray(r)?(lt[n]=r.slice(),ct[n]=r.slice()):lt[n]=ct[n]=r;pt[n]=e}function x(){var t=F(),r=t.link,n=t.global;t.id=gt++;t.batchId="0";var a=r(dt),i=t.shared={props:"a0"};Object.keys(dt).forEach(function(t){i[t]=n.def(a,".",t)});var o=t.next={},s=t.current={};Object.keys(pt).forEach(function(t){Array.isArray(lt[t])&&(o[t]=n.def(i.next,".",t),s[t]=n.def(i.current,".",t))});var l=t.constants={};Object.keys(vt).forEach(function(t){l[t]=n.def(JSON.stringify(vt[t]))});t.invoke=function(e,n){switch(n.type){case 0:var a=["this",i.context,i.props,t.batchId];return e.def(r(n.data),".call(",a.slice(0,Math.max(n.data.length+1,4)),")");case 1:return e.def(i.props,n.data);case 2:return e.def(i.context,n.data);case 3:return e.def("this",n.data);case 4:return n.data.append(t,e),n.data.ref}};t.attribCache={};var c={};t.scopeAttrib=function(t){t=e.id(t);if(t in c)return c[t];var n=u.scope[t];n||(n=u.scope[t]=new nt);return c[t]=r(n)};return t}function b(t){var e=t["static"];t=t.dynamic;var r;if("profile"in e){var n=!!e.profile;r=q(function(t,e){return n});r.enable=n}else if("profile"in t){var a=t.profile;r=H(a,function(t,e){return t.invoke(e,a)})}return r}function _(t,e){var r=t["static"],n=t.dynamic;if("framebuffer"in r){var a=r.framebuffer;return a?(a=s.getFramebuffer(a),q(function(t,e){var r=t.link(a),n=t.shared;e.set(n.framebuffer,".next",r);n=n.context;e.set(n,".framebufferWidth",r+".width");e.set(n,".framebufferHeight",r+".height");return r})):q(function(t,e){var r=t.shared;e.set(r.framebuffer,".next","null");r=r.context;e.set(r,".framebufferWidth",r+".drawingBufferWidth");e.set(r,".framebufferHeight",r+".drawingBufferHeight");return"null"})}if("framebuffer"in n){var i=n.framebuffer;return H(i,function(t,e){var r=t.invoke(e,i),n=t.shared,a=n.framebuffer,r=e.def(a,".getFramebuffer(",r,")");e.set(a,".next",r);n=n.context;e.set(n,".framebufferWidth",r+"?"+r+".width:"+n+".drawingBufferWidth");e.set(n,".framebufferHeight",r+"?"+r+".height:"+n+".drawingBufferHeight");return r})}return null}function k(t,e,r){function n(t){if(t in a){var r=a[t];t=!0;var n=r.x|0,o=r.y|0,s,l;"width"in r?s=r.width|0:t=!1;"height"in r?l=r.height|0:t=!1;return new V(!t&&e&&e.thisDep,!t&&e&&e.contextDep,!t&&e&&e.propDep,function(t,e){var a=t.shared.context,i=s;"width"in r||(i=e.def(a,".","framebufferWidth","-",n));var u=l;"height"in r||(u=e.def(a,".","framebufferHeight","-",o));return[n,o,i,u]})}if(t in i){var u=i[t];t=H(u,function(t,e){var r=t.invoke(e,u),n=t.shared.context,a=e.def(r,".x|0"),i=e.def(r,".y|0"),o=e.def('"width" in ',r,"?",r,".width|0:","(",n,".","framebufferWidth","-",a,")"),r=e.def('"height" in ',r,"?",r,".height|0:","(",n,".","framebufferHeight","-",i,")");return[a,i,o,r]});e&&(t.thisDep=t.thisDep||e.thisDep,t.contextDep=t.contextDep||e.contextDep,t.propDep=t.propDep||e.propDep);return t}return e?new V(e.thisDep,e.contextDep,e.propDep,function(t,e){var r=t.shared.context;return[0,0,e.def(r,".","framebufferWidth"),e.def(r,".","framebufferHeight")]}):null}var a=t["static"],i=t.dynamic;if(t=n("viewport")){var o=t;t=new V(t.thisDep,t.contextDep,t.propDep,function(t,e){var r=o.append(t,e),n=t.shared.context;e.set(n,".viewportWidth",r[2]);e.set(n,".viewportHeight",r[3]);return r})}return{viewport:t,scissor_box:n("scissor.box")}}function M(t){function r(t){if(t in n){var r=e.id(n[t]);t=q(function(){return r});t.id=r;return t}if(t in a){var i=a[t];return H(i,function(t,e){var r=t.invoke(e,i);return e.def(t.shared.strings,".id(",r,")")})}return null}var n=t["static"],a=t.dynamic,i=r("frag"),o=r("vert"),s=null;U(i)&&U(o)?(s=f.program(o.id,i.id),t=q(function(t,e){return t.link(s)})):t=new V(i&&i.thisDep||o&&o.thisDep,i&&i.contextDep||o&&o.contextDep,i&&i.propDep||o&&o.propDep,function(t,e){var r=t.shared.shader,n;n=i?i.append(t,e):e.def(r,".","frag");var a;a=o?o.append(t,e):e.def(r,".","vert");return e.def(r+".program("+a+","+n+")")});return{frag:i,vert:o,progVar:t,program:s}}function A(t,e){function r(t,e){if(t in n){var r=n[t]|0;return q(function(t,n){e&&(t.OFFSET=r);return r})}if(t in a){var i=a[t];return H(i,function(t,r){var n=t.invoke(r,i);e&&(t.OFFSET=n);return n})}return e&&o?q(function(t,e){t.OFFSET="0";return 0}):null}var n=t["static"],a=t.dynamic,o=function(){if("elements"in n){var t=n.elements;N(t)?t=i.getElements(i.create(t,!0)):t&&(t=i.getElements(t));var e=q(function(e,r){if(t){var n=e.link(t);return e.ELEMENTS=n}return e.ELEMENTS=null});e.value=t;return e}if("elements"in a){var r=a.elements;return H(r,function(t,e){var n=t.shared,a=n.isBufferArgs,n=n.elements,i=t.invoke(e,r),o=e.def("null"),a=e.def(a,"(",i,")"),i=t.cond(a).then(o,"=",n,".createStream(",i,");")["else"](o,"=",n,".getElements(",i,");");e.entry(i);e.exit(t.cond(a).then(n,".destroyStream(",o,");"));return t.ELEMENTS=o})}return null}(),s=r("offset",!0);return{elements:o,primitive:function(){if("primitive"in n){var t=n.primitive;return q(function(e,r){return ut[t]})}if("primitive"in a){var e=a.primitive;return H(e,function(t,r){var n=t.constants.primTypes,a=t.invoke(r,e);return r.def(n,"[",a,"]")})}return o?U(o)?o.value?q(function(t,e){return e.def(t.ELEMENTS,".primType")}):q(function(){return 4}):new V(o.thisDep,o.contextDep,o.propDep,function(t,e){var r=t.ELEMENTS;return e.def(r,"?",r,".primType:",4)}):null}(),count:function(){if("count"in n){var t=n.count|0;return q(function(){return t})}if("count"in a){var e=a.count;return H(e,function(t,r){return t.invoke(r,e)})}return o?U(o)?o?s?new V(s.thisDep,s.contextDep,s.propDep,function(t,e){return e.def(t.ELEMENTS,".vertCount-",t.OFFSET)}):q(function(t,e){return e.def(t.ELEMENTS,".vertCount")}):q(function(){return-1}):new V(o.thisDep||s.thisDep,o.contextDep||s.contextDep,o.propDep||s.propDep,function(t,e){var r=t.ELEMENTS;return t.OFFSET?e.def(r,"?",r,".vertCount-",t.OFFSET,":-1"):e.def(r,"?",r,".vertCount:-1")}):null}(),instances:r("instances",!1),offset:s}}function T(t,e){var r=t["static"],n=t.dynamic,a={};ft.forEach(function(t){function e(e,o){if(t in r){var s=e(r[t]);a[i]=q(function(){return s})}else if(t in n){var l=n[t];a[i]=H(l,function(t,e){return o(t,e,t.invoke(e,l))})}}var i=g(t);switch(t){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return e(function(t){return t},function(t,e,r){return r});case"depth.func":return e(function(t){return Lt[t]},function(t,e,r){return e.def(t.constants.compareFuncs,"[",r,"]")});case"depth.range":return e(function(t){return t},function(t,e,r){t=e.def("+",r,"[0]");e=e.def("+",r,"[1]");return[t,e]});case"blend.func":return e(function(t){return[Ct["srcRGB"in t?t.srcRGB:t.src],Ct["dstRGB"in t?t.dstRGB:t.dst],Ct["srcAlpha"in t?t.srcAlpha:t.src],Ct["dstAlpha"in t?t.dstAlpha:t.dst]]},function(t,e,r){function n(t,n){return e.def('"',t,n,'" in ',r,"?",r,".",t,n,":",r,".",t)}t=t.constants.blendFuncs;var a=n("src","RGB"),i=n("dst","RGB"),a=e.def(t,"[",a,"]"),o=e.def(t,"[",n("src","Alpha"),"]"),i=e.def(t,"[",i,"]");t=e.def(t,"[",n("dst","Alpha"),"]");return[a,i,o,t]});case"blend.equation":return e(function(t){if("string"===typeof t)return[it[t],it[t]];if("object"===typeof t)return[it[t.rgb],it[t.alpha]]},function(t,e,r){var n=t.constants.blendEquations,a=e.def(),i=e.def();t=t.cond("typeof ",r,'==="string"');t.then(a,"=",i,"=",n,"[",r,"];");t["else"](a,"=",n,"[",r,".rgb];",i,"=",n,"[",r,".alpha];");e(t);return[a,i]});case"blend.color":return e(function(t){return c(4,function(e){return+t[e]})},function(t,e,r){return c(4,function(t){return e.def("+",r,"[",t,"]")})});case"stencil.mask":return e(function(t){return t|0},function(t,e,r){return e.def(r,"|0")});case"stencil.func":return e(function(t){return[Lt[t.cmp||"keep"],t.ref||0,"mask"in t?t.mask:-1]},function(t,e,r){t=e.def('"cmp" in ',r,"?",t.constants.compareFuncs,"[",r,".cmp]",":",7680);var n=e.def(r,".ref|0");e=e.def('"mask" in ',r,"?",r,".mask|0:-1");return[t,n,e]});case"stencil.opFront":case"stencil.opBack":return e(function(e){return["stencil.opBack"===t?1029:1028,It[e.fail||"keep"],It[e.zfail||"keep"],It[e.zpass||"keep"]]},function(e,r,n){function a(t){return r.def('"',t,'" in ',n,"?",i,"[",n,".",t,"]:",7680)}var i=e.constants.stencilOps;return["stencil.opBack"===t?1029:1028,a("fail"),a("zfail"),a("zpass")]});case"polygonOffset.offset":return e(function(t){return[t.factor|0,t.units|0]},function(t,e,r){t=e.def(r,".factor|0");e=e.def(r,".units|0");return[t,e]});case"cull.face":return e(function(t){var e=0;"front"===t?e=1028:"back"===t&&(e=1029);return e},function(t,e,r){return e.def(r,'==="front"?',1028,":",1029)});case"lineWidth":return e(function(t){return t},function(t,e,r){return r});case"frontFace":return e(function(t){return zt[t]},function(t,e,r){return e.def(r+'==="cw"?2304:2305')});case"colorMask":return e(function(t){return t.map(function(t){return!!t})},function(t,e,r){return c(4,function(t){return"!!"+r+"["+t+"]"})});case"sample.coverage":return e(function(t){return["value"in t?t.value:1,!!t.invert]},function(t,e,r){t=e.def('"value" in ',r,"?+",r,".value:1");e=e.def("!!",r,".invert");return[t,e]})}});return a}function S(t,e){var r=t["static"],n=t.dynamic,a={};Object.keys(r).forEach(function(t){var e=r[t],n;if("number"===typeof e||"boolean"===typeof e)n=q(function(){return e});else if("function"===typeof e){var i=e._reglType;if("texture2d"===i||"textureCube"===i)n=q(function(t){return t.link(e)});else if("framebuffer"===i||"framebufferCube"===i)n=q(function(t){return t.link(e.color[0])})}else w(e)&&(n=q(function(t){return t.global.def("[",c(e.length,function(t){return e[t]}),"]")}));n.value=e;a[t]=n});Object.keys(n).forEach(function(t){var e=n[t];a[t]=H(e,function(t,r){return t.invoke(r,e)})});return a}function E(t,r){var n=t["static"],i=t.dynamic,o={};Object.keys(n).forEach(function(t){var r=n[t],i=e.id(t),s=new nt;if(N(r))s.state=1,s.buffer=a.getBuffer(a.create(r,34962,!1,!0)),s.type=0;else{var l=a.getBuffer(r);if(l)s.state=1,s.buffer=l,s.type=0;else if("constant"in r){var u=r.constant;s.buffer="null";s.state=2;"number"===typeof u?s.x=u:St.forEach(function(t,e){e<u.length&&(s[t]=u[e])})}else{var l=N(r.buffer)?a.getBuffer(a.create(r.buffer,34962,!1,!0)):a.getBuffer(r.buffer),c=r.offset|0,f=r.stride|0,h=r.size|0,p=!!r.normalized,d=0;"type"in r&&(d=at[r.type]);r=r.divisor|0;s.buffer=l;s.state=1;s.size=h;s.normalized=p;s.type=d||l.dtype;s.offset=c;s.stride=f;s.divisor=r}}o[t]=q(function(t,e){var r=t.attribCache;if(i in r)return r[i];var n={isStream:!1};Object.keys(s).forEach(function(t){n[t]=s[t]});s.buffer&&(n.buffer=t.link(s.buffer),n.type=n.type||n.buffer+".dtype");return r[i]=n})});Object.keys(i).forEach(function(t){var e=i[t];o[t]=H(e,function(t,r){function n(t){r(l[t],"=",a,".",t,"|0;")}var a=t.invoke(r,e),i=t.shared,o=i.isBufferArgs,s=i.buffer,l={isStream:r.def(!1)},u=new nt;u.state=1;Object.keys(u).forEach(function(t){l[t]=r.def(""+u[t])});var c=l.buffer,f=l.type;r("if(",o,"(",a,")){",l.isStream,"=true;",c,"=",s,".createStream(",34962,",",a,");",f,"=",c,".dtype;","}else{",c,"=",s,".getBuffer(",a,");","if(",c,"){",f,"=",c,".dtype;",'}else if("constant" in ',a,"){",l.state,"=",2,";","if(typeof "+a+'.constant === "number"){',l[St[0]],"=",a,".constant;",St.slice(1).map(function(t){return l[t]}).join("="),"=0;","}else{",St.map(function(t,e){return l[t]+"="+a+".constant.length>"+e+"?"+a+".constant["+e+"]:0;"}).join(""),"}}else{","if(",o,"(",a,".buffer)){",c,"=",s,".createStream(",34962,",",a,".buffer);","}else{",c,"=",s,".getBuffer(",a,".buffer);","}",f,'="type" in ',a,"?",i.glTypes,"[",a,".type]:",c,".dtype;",l.normalized,"=!!",a,".normalized;");n("size");n("offset");n("stride");n("divisor");r("}}");r.exit("if(",l.isStream,"){",s,".destroyStream(",c,");","}");return l})});return o}function C(t){var e=t["static"],r=t.dynamic,n={};Object.keys(e).forEach(function(t){var r=e[t];n[t]=q(function(t,e){return"number"===typeof r||"boolean"===typeof r?""+r:t.link(r)})});Object.keys(r).forEach(function(t){var e=r[t];n[t]=H(e,function(t,r){return t.invoke(r,e)})});return n}function L(t,e,r,n,a){var i=_(t,a),o=k(t,i,a),s=A(t,a),l=T(t,a),u=M(t,a),c=o.viewport;c&&(l.viewport=c);c=g("scissor.box");(o=o[c])&&(l[c]=o);o=0<Object.keys(l).length;i={framebuffer:i,draw:s,shader:u,state:l,dirty:o};i.profile=b(t,a);i.uniforms=S(r,a);i.attributes=E(e,a);i.context=C(n,a);return i}function I(t,e,r){var n=t.shared.context,a=t.scope();Object.keys(r).forEach(function(i){e.save(n,"."+i);a(n,".",i,"=",r[i].append(t,e),";")});e(a)}function z(t,e,r,n){var a=t.shared,i=a.gl,o=a.framebuffer,s;st&&(s=e.def(a.extensions,".webgl_draw_buffers"));var l=t.constants,a=l.drawBuffer,l=l.backBuffer;t=r?r.append(t,e):e.def(o,".next");n||e("if(",t,"!==",o,".cur){");e("if(",t,"){",i,".bindFramebuffer(",36160,",",t,".framebuffer);");st&&e(s,".drawBuffersWEBGL(",a,"[",t,".colorAttachments.length]);");e("}else{",i,".bindFramebuffer(",36160,",null);");st&&e(s,".drawBuffersWEBGL(",l,");");e("}",o,".cur=",t,";");n||e("}")}function P(t,e,r){var n=t.shared,a=n.gl,i=t.current,o=t.next,s=n.current,l=n.next,u=t.cond(s,".dirty");ft.forEach(function(e){e=g(e);if(!(e in r.state)){var n,f;if(e in o){n=o[e];f=i[e];var h=c(lt[e].length,function(t){return u.def(n,"[",t,"]")});u(t.cond(h.map(function(t,e){return t+"!=="+f+"["+e+"]"}).join("||")).then(a,".",pt[e],"(",h,");",h.map(function(t,e){return f+"["+e+"]="+t}).join(";"),";"))}else n=u.def(l,".",e),h=t.cond(n,"!==",s,".",e),u(h),e in ht?h(t.cond(n).then(a,".enable(",ht[e],");")["else"](a,".disable(",ht[e],");"),s,".",e,"=",n,";"):h(a,".",pt[e],"(",n,");",s,".",e,"=",n,";")}});0===Object.keys(r.state).length&&u(s,".dirty=false;");e(u)}function O(t,e,r,n){var a=t.shared,i=t.current,o=a.current,s=a.gl;j(Object.keys(r)).forEach(function(a){var l=r[a];if(!n||n(l)){var u=l.append(t,e);if(ht[a]){var c=ht[a];U(l)?u?e(s,".enable(",c,");"):e(s,".disable(",c,");"):e(t.cond(u).then(s,".enable(",c,");")["else"](s,".disable(",c,");"));e(o,".",a,"=",u,";")}else if(w(u)){var f=i[a];e(s,".",pt[a],"(",u,");",u.map(function(t,e){return f+"["+e+"]="+t}).join(";"),";")}else e(s,".",pt[a],"(",u,");",o,".",a,"=",u,";")}})}function D(t,e){ot&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function R(t,e,r,n,a){function i(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function o(t){p=e.def();t(p,"=",i(),";");"string"===typeof a?t(c,".count+=",a,";"):t(c,".count++;");d&&(n?(v=e.def(),t(v,"=",h,".getNumPendingQueries();")):t(h,".beginQuery(",c,");"))}function s(t){t(c,".cpuTime+=",i(),"-",p,";");d&&(n?t(h,".pushScopeStats(",v,",",h,".getNumPendingQueries(),",c,");"):t(h,".endQuery();"))}function l(t){var r=e.def(f,".profile");e(f,".profile=",t,";");e.exit(f,".profile=",r,";")}var u=t.shared,c=t.stats,f=u.current,h=u.timer;r=r.profile;var p,v;if(r){if(U(r)){r.enable?(o(e),s(e.exit),l("true")):l("false");return}r=r.append(t,e);l(r)}else r=e.def(f,".profile");u=t.block();o(u);e("if(",r,"){",u,"}");t=t.block();s(t);e.exit("if(",r,"){",t,"}")}function B(t,e,r,n,a){function i(t){switch(t){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function o(r,n,a){function i(){e("if(!",c,".buffer){",l,".enableVertexAttribArray(",u,");}");var r=a.type,i;i=a.size?e.def(a.size,"||",n):n;e("if(",c,".type!==",r,"||",c,".size!==",i,"||",p.map(function(t){return c+"."+t+"!=="+a[t]}).join("||"),"){",l,".bindBuffer(",34962,",",f,".buffer);",l,".vertexAttribPointer(",[u,i,r,a.normalized,a.stride,a.offset],");",c,".type=",r,";",c,".size=",i,";",p.map(function(t){return c+"."+t+"="+a[t]+";"}).join(""),"}");ot&&(r=a.divisor,e("if(",c,".divisor!==",r,"){",t.instancing,".vertexAttribDivisorANGLE(",[u,r],");",c,".divisor=",r,";}"))}function o(){e("if(",c,".buffer){",l,".disableVertexAttribArray(",u,");","}if(",St.map(function(t,e){return c+"."+t+"!=="+h[e]}).join("||"),"){",l,".vertexAttrib4f(",u,",",h,");",St.map(function(t,e){return c+"."+t+"="+h[e]+";"}).join(""),"}")}var l=s.gl,u=e.def(r,".location"),c=e.def(s.attributes,"[",u,"]");r=a.state;var f=a.buffer,h=[a.x,a.y,a.z,a.w],p=["buffer","normalized","offset","stride"];1===r?i():2===r?o():(e("if(",r,"===",1,"){"),i(),e("}else{"),o(),e("}"))}var s=t.shared;n.forEach(function(n){var s=n.name,l=r.attributes[s],u;if(l){if(!a(l))return;u=l.append(t,e)}else{if(!a(Pt))return;var c=t.scopeAttrib(s);u={};Object.keys(new nt).forEach(function(t){u[t]=e.def(c,".",t)})}o(t.link(n),i(n.info.type),u)})}function G(t,r,n,a,i){for(var o=t.shared,s=o.gl,l,u=0;u<a.length;++u){var f=a[u],h=f.name,p=f.info.type,d=n.uniforms[h],f=t.link(f)+".location",v;if(d){if(!i(d))continue;if(U(d)){h=d.value;if(35678===p||35680===p)p=t.link(h._texture||h.color[0]._texture),r(s,".uniform1i(",f,",",p+".bind());"),r.exit(p,".unbind();");else if(35674===p||35675===p||35676===p)h=t.global.def("new Float32Array(["+Array.prototype.slice.call(h)+"])"),d=2,35675===p?d=3:35676===p&&(d=4),r(s,".uniformMatrix",d,"fv(",f,",false,",h,");");else{switch(p){case 5126:l="1f";break;case 35664:l="2f";break;case 35665:l="3f";break;case 35666:l="4f";break;case 35670:l="1i";break;case 5124:l="1i";break;case 35671:l="2i";break;case 35667:l="2i";break;case 35672:l="3i";break;case 35668:l="3i";break;case 35673:l="4i";break;case 35669:l="4i"}r(s,".uniform",l,"(",f,",",w(h)?Array.prototype.slice.call(h):h,");")}continue}else v=d.append(t,r)}else{if(!i(Pt))continue;v=r.def(o.uniforms,"[",e.id(h),"]")}35678===p?r("if(",v,"&&",v,'._reglType==="framebuffer"){',v,"=",v,".color[0];","}"):35680===p&&r("if(",v,"&&",v,'._reglType==="framebufferCube"){',v,"=",v,".color[0];","}");h=1;switch(p){case 35678:case 35680:p=r.def(v,"._texture");r(s,".uniform1i(",f,",",p,".bind());");r.exit(p,".unbind();");continue;case 5124:case 35670:l="1i";break;case 35667:case 35671:l="2i";h=2;break;case 35668:case 35672:l="3i";h=3;break;case 35669:case 35673:l="4i";h=4;break;case 5126:l="1f";break;case 35664:l="2f";h=2;break;case 35665:l="3f";h=3;break;case 35666:l="4f";h=4;break;case 35674:l="Matrix2fv";break;case 35675:l="Matrix3fv";break;case 35676:l="Matrix4fv"}r(s,".uniform",l,"(",f,",");if("M"===l.charAt(0)){var f=Math.pow(p-35674+2,2),g=t.global.def("new Float32Array(",f,")");r("false,(Array.isArray(",v,")||",v," instanceof Float32Array)?",v,":(",c(f,function(t){return g+"["+t+"]="+v+"["+t+"]"}),",",g,")")}else 1<h?r(c(h,function(t){return v+"["+t+"]"})):r(v);r(");")}}function W(t,e,r,n){function a(a){var i=c[a];return i?i.contextDep&&n.contextDynamic||i.propDep?i.append(t,r):i.append(t,e):e.def(u,".",a)}function i(){function t(){r(g,".drawElementsInstancedANGLE(",[h,d,m,p+"<<(("+m+"-5121)>>1)",v],");")}function e(){r(g,".drawArraysInstancedANGLE(",[h,p,d,v],");")}f?y?t():(r("if(",f,"){"),t(),r("}else{"),e(),r("}")):e()}function o(){function t(){r(l+".drawElements("+[h,d,m,p+"<<(("+m+"-5121)>>1)"]+");")}function e(){r(l+".drawArrays("+[h,p,d]+");")}f?y?t():(r("if(",f,"){"),t(),r("}else{"),e(),r("}")):e()}var s=t.shared,l=s.gl,u=s.draw,c=n.draw,f=function(){var a=c.elements,i=e;if(a){if(a.contextDep&&n.contextDynamic||a.propDep)i=r;a=a.append(t,i)}else a=i.def(u,".","elements");a&&i("if("+a+")"+l+".bindBuffer(34963,"+a+".buffer.buffer);");return a}(),h=a("primitive"),p=a("offset"),d=function(){var a=c.count,i=e;if(a){if(a.contextDep&&n.contextDynamic||a.propDep)i=r;a=a.append(t,i)}else a=i.def(u,".","count");return a}();if("number"===typeof d){if(0===d)return}else r("if(",d,"){"),r.exit("}");var v,g;ot&&(v=a("instances"),g=t.instancing);var m=f+".type",y=c.elements&&U(c.elements);ot&&("number"!==typeof v||0<=v)?"string"===typeof v?(r("if(",v,">0){"),i(),r("}else if(",v,"<0){"),o(),r("}")):i():o()}function Y(t,e,r,n,a){e=x();a=e.proc("body",a);ot&&(e.instancing=a.def(e.shared.extensions,".angle_instanced_arrays"));t(e,a,r,n);return e.compile().body}function X(t,e,r,n){D(t,e);B(t,e,r,n.attributes,function(){return!0});G(t,e,r,n.uniforms,function(){return!0});W(t,e,e,r)}function $(t,e){var r=t.proc("draw",1);D(t,r);I(t,r,e.context);z(t,r,e.framebuffer);P(t,r,e);O(t,r,e.state);R(t,r,e,!1,!0);var n=e.shader.progVar.append(t,r);r(t.shared.gl,".useProgram(",n,".program);");if(e.shader.program)X(t,r,e,e.shader.program);else{var a=t.global.def("{}"),i=r.def(n,".id"),o=r.def(a,"[",i,"]");r(t.cond(o).then(o,".call(this,a0);")["else"](o,"=",a,"[",i,"]=",t.link(function(r){return Y(X,t,e,r,1)}),"(",n,");",o,".call(this,a0);"))}0<Object.keys(e.state).length&&r(t.shared.current,".dirty=true;")}function J(t,e,r,n){function a(){return!0}t.batchId="a1";D(t,e);B(t,e,r,n.attributes,a);G(t,e,r,n.uniforms,a);W(t,e,e,r)}function K(t,e,r,n){function a(t){return t.contextDep&&o||t.propDep}function i(t){return!a(t)}D(t,e);var o=r.contextDep,s=e.def(),l=e.def();t.shared.props=l;t.batchId=s;var u=t.scope(),c=t.scope();e(u.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",l,"=","a0","[",s,"];",c,"}",u.exit);r.needsContext&&I(t,c,r.context);r.needsFramebuffer&&z(t,c,r.framebuffer);O(t,c,r.state,a);r.profile&&a(r.profile)&&R(t,c,r,!1,!0);n?(B(t,u,r,n.attributes,i),B(t,c,r,n.attributes,a),G(t,u,r,n.uniforms,i),G(t,c,r,n.uniforms,a),W(t,u,c,r)):(e=t.global.def("{}"),n=r.shader.progVar.append(t,c),l=c.def(n,".id"),u=c.def(e,"[",l,"]"),c(t.shared.gl,".useProgram(",n,".program);","if(!",u,"){",u,"=",e,"[",l,"]=",t.link(function(e){return Y(J,t,r,e,2)}),"(",n,");}",u,".call(this,a0[",s,"],",s,");"))}function Q(t,e){function r(t){return t.contextDep&&a||t.propDep}var n=t.proc("batch",2);t.batchId="0";D(t,n);var a=!1,i=!0;Object.keys(e.context).forEach(function(t){a=a||e.context[t].propDep});a||(I(t,n,e.context),i=!1);var o=e.framebuffer,s=!1;o?(o.propDep?a=s=!0:o.contextDep&&a&&(s=!0),s||z(t,n,o)):z(t,n,null);e.state.viewport&&e.state.viewport.propDep&&(a=!0);P(t,n,e);O(t,n,e.state,function(t){return!r(t)});e.profile&&r(e.profile)||R(t,n,e,!1,"a1");e.contextDep=a;e.needsContext=i;e.needsFramebuffer=s;i=e.shader.progVar;if(i.contextDep&&a||i.propDep)K(t,n,e,null);else if(i=i.append(t,n),n(t.shared.gl,".useProgram(",i,".program);"),e.shader.program)K(t,n,e,e.shader.program);else{var o=t.global.def("{}"),s=n.def(i,".id"),l=n.def(o,"[",s,"]");n(t.cond(l).then(l,".call(this,a0,a1);")["else"](l,"=",o,"[",s,"]=",t.link(function(r){return Y(K,t,e,r,2)}),"(",i,");",l,".call(this,a0,a1);"))}0<Object.keys(e.state).length&&n(t.shared.current,".dirty=true;")}function tt(t,r){function n(e){var n=r.shader[e];n&&a.set(i.shader,"."+e,n.append(t,a))}var a=t.proc("scope",3);t.batchId="a2";var i=t.shared,o=i.current;I(t,a,r.context);r.framebuffer&&r.framebuffer.append(t,a);j(Object.keys(r.state)).forEach(function(e){var n=r.state[e].append(t,a);w(n)?n.forEach(function(r,n){a.set(t.next[e],"["+n+"]",r)}):a.set(i.next,"."+e,n)});R(t,a,r,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(e){var n=r.draw[e];n&&a.set(i.draw,"."+e,""+n.append(t,a))});Object.keys(r.uniforms).forEach(function(n){a.set(i.uniforms,"["+e.id(n)+"]",r.uniforms[n].append(t,a))});Object.keys(r.attributes).forEach(function(e){var n=r.attributes[e].append(t,a),i=t.scopeAttrib(e);Object.keys(new nt).forEach(function(t){a.set(i,"."+t,n[t])})});n("vert");n("frag");0<Object.keys(r.state).length&&(a(o,".dirty=true;"),a.exit(o,".dirty=true;"));a("a1(",t.shared.context,",a0,",t.batchId,");")}function et(t){if("object"===typeof t&&!w(t)){for(var e=Object.keys(t),r=0;r<e.length;++r)if(Z.isDynamic(t[e[r]]))return!0;return!1}}function rt(t,e,r){function n(t,e){o.forEach(function(r){var n=a[r];Z.isDynamic(n)&&(n=t.invoke(e,n),e(c,".",r,"=",n,";"))})}var a=e["static"][r];if(a&&et(a)){var i=t.global,o=Object.keys(a),s=!1,l=!1,u=!1,c=t.global.def("{}");o.forEach(function(e){var r=a[e];if(Z.isDynamic(r))"function"===typeof r&&(r=a[e]=Z.unbox(r)),e=H(r,null),s=s||e.thisDep,u=u||e.propDep,l=l||e.contextDep;else{i(c,".",e,"=");switch(typeof r){case"number":i(r);break;case"string":i('"',r,'"');break;case"object":Array.isArray(r)&&i("[",r.join(),"]");break;default:i(t.link(r))}i(";")}});e.dynamic[r]=new Z.DynamicVariable(4,{thisDep:s,contextDep:l,propDep:u,ref:c,append:n});delete e["static"][r]}}var nt=u.Record,it={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(it.min=32775,it.max=32776);var ot=r.angle_instanced_arrays,st=r.webgl_draw_buffers,lt={dirty:!0,profile:v.profile},ct={},ft=[],ht={},pt={};m("dither",3024);m("blend.enable",3042);y("blend.color","blendColor",[0,0,0,0]);y("blend.equation","blendEquationSeparate",[32774,32774]);y("blend.func","blendFuncSeparate",[1,0,1,0]);m("depth.enable",2929,!0);y("depth.func","depthFunc",513);y("depth.range","depthRange",[0,1]);y("depth.mask","depthMask",!0);y("colorMask","colorMask",[!0,!0,!0,!0]);m("cull.enable",2884);y("cull.face","cullFace",1029);y("frontFace","frontFace",2305);y("lineWidth","lineWidth",1);m("polygonOffset.enable",32823);y("polygonOffset.offset","polygonOffset",[0,0]);m("sample.alpha",32926);m("sample.enable",32928);y("sample.coverage","sampleCoverage",[1,!1]);m("stencil.enable",2960);y("stencil.mask","stencilMask",-1);y("stencil.func","stencilFunc",[519,0,-1]);y("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);y("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);m("scissor.enable",3089);y("scissor.box","scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);y("viewport","viewport",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var dt={gl:t,context:p,strings:e,next:ct,current:lt,draw:h,elements:i,buffer:a,shader:f,attributes:u.state,uniforms:l,framebuffer:s,extensions:r,timer:d,isBufferArgs:N},vt={primTypes:ut,compareFuncs:Lt,blendFuncs:Ct,blendEquations:it,stencilOps:It,glTypes:at,orientationType:zt};st&&(vt.backBuffer=[1029],vt.drawBuffer=c(n.maxDrawbuffers,function(t){return 0===t?[0]:c(t,function(t){return 36064+t})}));var gt=0;return{next:ct,current:lt,procs:function(){var t=x(),e=t.proc("poll"),r=t.proc("refresh"),a=t.block();e(a);r(a);var i=t.shared,o=i.gl,s=i.next,l=i.current;a(l,".dirty=false;");z(t,e);z(t,r,null,!0);var u;ot&&(u=t.link(ot));for(var f=0;f<n.maxAttributes;++f){var h=r.def(i.attributes,"[",f,"]"),p=t.cond(h,".buffer");p.then(o,".enableVertexAttribArray(",f,");",o,".bindBuffer(",34962,",",h,".buffer.buffer);",o,".vertexAttribPointer(",f,",",h,".size,",h,".type,",h,".normalized,",h,".stride,",h,".offset);")["else"](o,".disableVertexAttribArray(",f,");",o,".vertexAttrib4f(",f,",",h,".x,",h,".y,",h,".z,",h,".w);",h,".buffer=null;");r(p);ot&&r(u,".vertexAttribDivisorANGLE(",f,",",h,".divisor);")}Object.keys(ht).forEach(function(n){var i=ht[n],u=a.def(s,".",n),c=t.block();c("if(",u,"){",o,".enable(",i,")}else{",o,".disable(",i,")}",l,".",n,"=",u,";");r(c);e("if(",u,"!==",l,".",n,"){",c,"}")});Object.keys(pt).forEach(function(n){var i=pt[n],u=lt[n],f,h,p=t.block();p(o,".",i,"(");w(u)?(i=u.length,f=t.global.def(s,".",n),h=t.global.def(l,".",n),p(c(i,function(t){return f+"["+t+"]"}),");",c(i,function(t){return h+"["+t+"]="+f+"["+t+"];"}).join("")),e("if(",c(i,function(t){return f+"["+t+"]!=="+h+"["+t+"]"}).join("||"),"){",p,"}")):(f=a.def(s,".",n),h=a.def(l,".",n),p(f,");",l,".",n,"=",f,";"),e("if(",f,"!==",h,"){",p,"}"));r(p)});return t.compile()}(),compile:function(t,e,r,n,a){var i=x();i.stats=i.link(a);Object.keys(e["static"]).forEach(function(t){rt(i,e,t)});Et.forEach(function(e){rt(i,t,e)});r=L(t,e,r,n,i);$(i,r);tt(i,r);Q(i,r);return i.compile()}}}function W(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}var Y=function(t,e){for(var r=Object.keys(e),n=0;n<r.length;++n)t[r[n]]=e[r[n]];return t},X=0,Z={DynamicVariable:t,define:function(e,n){return new t(e,r(n+""))},isDynamic:function(e){return"function"===typeof e&&!e._reglType||e instanceof t},unbox:function(e,r){return"function"===typeof e?new t(0,e):e},accessor:r},$={next:"function"===typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"===typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},J="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},K=h();K.zero=h();var Q=function(t,e){var r=1;e.ext_texture_filter_anisotropic&&(r=t.getParameter(34047));var n=1,a=1;e.webgl_draw_buffers&&(n=t.getParameter(34852),a=t.getParameter(36063));var i=!!e.oes_texture_float;if(i){i=t.createTexture();t.bindTexture(3553,i);t.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var o=t.createFramebuffer();t.bindFramebuffer(36160,o);t.framebufferTexture2D(36160,36064,3553,i,0);t.bindTexture(3553,null);if(36053!==t.checkFramebufferStatus(36160))i=!1;else{t.viewport(0,0,1,1);t.clearColor(1,0,0,1);t.clear(16384);var s=K.allocType(5126,4);t.readPixels(0,0,1,1,6408,5126,s);t.getError()?i=!1:(t.deleteFramebuffer(o),t.deleteTexture(i),i=1===s[0]);K.freeType(s)}}s=!0;s=t.createTexture();o=K.allocType(5121,36);t.activeTexture(33984);t.bindTexture(34067,s);t.texImage2D(34069,0,6408,3,3,0,6408,5121,o);K.freeType(o);t.bindTexture(34067,null);t.deleteTexture(s);s=!t.getError();return{colorBits:[t.getParameter(3410),t.getParameter(3411),t.getParameter(3412),t.getParameter(3413)],depthBits:t.getParameter(3414),stencilBits:t.getParameter(3415),subpixelBits:t.getParameter(3408),extensions:Object.keys(e).filter(function(t){return!!e[t]}),maxAnisotropic:r,maxDrawbuffers:n,maxColorAttachments:a,pointSizeDims:t.getParameter(33901),lineWidthDims:t.getParameter(33902),maxViewportDims:t.getParameter(3386),maxCombinedTextureUnits:t.getParameter(35661),maxCubeMapSize:t.getParameter(34076),maxRenderbufferSize:t.getParameter(34024),maxTextureUnits:t.getParameter(34930),maxTextureSize:t.getParameter(3379),maxAttributes:t.getParameter(34921),maxVertexUniforms:t.getParameter(36347),maxVertexTextureUnits:t.getParameter(35660),maxVaryingVectors:t.getParameter(36348),maxFragmentUniforms:t.getParameter(36349),glsl:t.getParameter(35724),renderer:t.getParameter(7937),vendor:t.getParameter(7936),version:t.getParameter(7938),readFloat:i,npotTextureCube:s}},tt=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},et=function(t){return Object.keys(t).map(function(e){return t[e]})},rt={shape:function(t){for(var e=[];t.length;t=t[0])e.push(t.length);return e},flatten:function(t,e,r,n){var a=1;if(e.length)for(var i=0;i<e.length;++i)a*=e[i];else a=0;r=n||K.allocType(r,a);switch(e.length){case 0:break;case 1:n=e[0];for(e=0;e<n;++e)r[e]=t[e];break;case 2:n=e[0];e=e[1];for(i=a=0;i<n;++i)for(var o=t[i],s=0;s<e;++s)r[a++]=o[s];break;case 3:d(t,e[0],e[1],e[2],r,0);break;default:v(t,e,0,r,0)}return r}},nt={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},at={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},it={dynamic:35048,stream:35040,static:35044},ot=rt.flatten,st=rt.shape,lt=[];lt[5120]=1;lt[5122]=2;lt[5124]=4;lt[5121]=1;lt[5123]=2;lt[5125]=4;lt[5126]=4;var ut={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ct=new Float32Array(1),ft=new Uint32Array(ct.buffer),ht=[9984,9986,9985,9987],pt=[0,6409,6410,6407,6408],dt={};dt[6409]=dt[6406]=dt[6402]=1;dt[34041]=dt[6410]=2;dt[6407]=dt[35904]=3;dt[6408]=dt[35906]=4;var vt=k("HTMLCanvasElement"),gt=k("CanvasRenderingContext2D"),mt=k("ImageBitmap"),yt=k("HTMLImageElement"),xt=k("HTMLVideoElement"),bt=Object.keys(nt).concat([vt,gt,mt,yt,xt]),_t=[];_t[5121]=1;_t[5126]=4;_t[36193]=2;_t[5123]=2;_t[5125]=4;var wt=[];wt[32854]=2;wt[32855]=2;wt[36194]=2;wt[34041]=4;wt[33776]=.5;wt[33777]=.5;wt[33778]=1;wt[33779]=1;wt[35986]=.5;wt[35987]=1;wt[34798]=1;wt[35840]=.5;wt[35841]=.25;wt[35842]=.5;wt[35843]=.25;wt[36196]=.5;var kt=[];kt[32854]=2;kt[32855]=2;kt[36194]=2;kt[33189]=2;kt[36168]=1;kt[34041]=4;kt[35907]=4;kt[34836]=16;kt[34842]=8;kt[34843]=6;var Mt=function(t,e,r,n,a){function i(t){this.id=u++;this.refCount=1;this.renderbuffer=t;this.format=32854;this.height=this.width=0;a.profile&&(this.stats={size:0})}function o(e){var r=e.renderbuffer;t.bindRenderbuffer(36161,null);t.deleteRenderbuffer(r);e.renderbuffer=null;e.refCount=0;delete c[e.id];n.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};e.ext_srgb&&(s.srgba=35907);e.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843);e.webgl_color_buffer_float&&(s.rgba32f=34836);var l=[];Object.keys(s).forEach(function(t){l[s[t]]=t});var u=0,c={};i.prototype.decRef=function(){0>=--this.refCount&&o(this)};a.profile&&(n.getTotalRenderbufferSize=function(){var t=0;Object.keys(c).forEach(function(e){t+=c[e].stats.size});return t});return{create:function(e,r){function o(e,r){var n=0,i=0,c=32854;"object"===typeof e&&e?("shape"in e?(i=e.shape,n=i[0]|0,i=i[1]|0):("radius"in e&&(n=i=e.radius|0),"width"in e&&(n=e.width|0),"height"in e&&(i=e.height|0)),"format"in e&&(c=s[e.format])):"number"===typeof e?(n=e|0,i="number"===typeof r?r|0:n):e||(n=i=1);if(n!==u.width||i!==u.height||c!==u.format)return o.width=u.width=n,o.height=u.height=i,u.format=c,t.bindRenderbuffer(36161,u.renderbuffer),t.renderbufferStorage(36161,c,n,i),a.profile&&(u.stats.size=kt[u.format]*u.width*u.height),o.format=l[u.format],o}var u=new i(t.createRenderbuffer());c[u.id]=u;n.renderbufferCount++;o(e,r);o.resize=function(e,r){var n=e|0,i=r|0||n;if(n===u.width&&i===u.height)return o;o.width=u.width=n;o.height=u.height=i;t.bindRenderbuffer(36161,u.renderbuffer);t.renderbufferStorage(36161,u.format,n,i);a.profile&&(u.stats.size=kt[u.format]*u.width*u.height);return o};o._reglType="renderbuffer";o._renderbuffer=u;a.profile&&(o.stats=u.stats);o.destroy=function(){u.decRef()};return o},clear:function(){et(c).forEach(o)},restore:function(){et(c).forEach(function(e){e.renderbuffer=t.createRenderbuffer();t.bindRenderbuffer(36161,e.renderbuffer);t.renderbufferStorage(36161,e.format,e.width,e.height)});t.bindRenderbuffer(36161,null)}}},At=[];At[6408]=4;At[6407]=3;var Tt=[];Tt[5121]=1;Tt[5126]=4;Tt[36193]=2;var St=["x","y","z","w"],Et="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Ct={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Lt={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},It={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},zt={cw:2304,ccw:2305},Pt=new V(!1,!1,!1,function(){}),Ot=function(t,e){function r(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function n(t,e,n){var a=s.pop()||new r;a.startQueryIndex=t;a.endQueryIndex=e;a.sum=0;a.stats=n;l.push(a)}var a=e.ext_disjoint_timer_query;if(!a)return null;var i=[],o=[],s=[],l=[],u=[],c=[];return{beginQuery:function(t){var e=i.pop()||a.createQueryEXT();a.beginQueryEXT(35007,e);o.push(e);n(o.length-1,o.length,t)},endQuery:function(){a.endQueryEXT(35007)},pushScopeStats:n,update:function(){var t,e;t=o.length;if(0!==t){c.length=Math.max(c.length,t+1);u.length=Math.max(u.length,t+1);u[0]=0;var r=c[0]=0;for(e=t=0;e<o.length;++e){var n=o[e];a.getQueryObjectEXT(n,34919)?(r+=a.getQueryObjectEXT(n,34918),i.push(n)):o[t++]=n;u[e+1]=r;c[e+1]=t}o.length=t;for(e=t=0;e<l.length;++e){var r=l[e],f=r.startQueryIndex,n=r.endQueryIndex;r.sum+=u[n]-u[f];f=c[f];n=c[n];n===f?(r.stats.gpuTime+=r.sum/1e6,s.push(r)):(r.startQueryIndex=f,r.endQueryIndex=n,l[t++]=r)}l.length=t}},getNumPendingQueries:function(){return o.length},clear:function(){i.push.apply(i,o);for(var t=0;t<i.length;t++)a.deleteQueryEXT(i[t]);o.length=0;i.length=0},restore:function(){o.length=0;i.length=0}}};return function(t){function e(){if(0===H.length)M&&M.update(),et=null;else{et=$.next(e);p();for(var t=H.length-1;0<=t;--t){var r=H[t];r&&r(E,null,0)}g.flush();M&&M.update()}}function r(){!et&&0<H.length&&(et=$.next(e))}function a(){et&&($.cancel(e),et=null)}function i(t){t.preventDefault();a();X.forEach(function(t){t()})}function o(t){g.getError();y.restore();B.restore();z.restore();F.restore();N.restore();j.restore();M&&M.restore();V.procs.refresh();r();K.forEach(function(t){t()})}function s(t){function e(t){var e={},r={};Object.keys(t).forEach(function(n){var a=t[n];Z.isDynamic(a)?r[n]=Z.unbox(a,n):e[n]=a});return{dynamic:r,static:e}}function r(t){for(;c.length<t;)c.push(null);return c}var n=e(t.context||{}),a=e(t.uniforms||{}),i=e(t.attributes||{}),o=e(function(t){function e(t){if(t in r){var e=r[t];delete r[t];Object.keys(e).forEach(function(n){r[t+"."+n]=e[n]})}}var r=Y({},t);delete r.uniforms;delete r.attributes;delete r.context;"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op);e("blend");e("depth");e("cull");e("stencil");e("polygonOffset");e("scissor");e("sample");return r}(t));t={gpuTime:0,cpuTime:0,count:0};var n=V.compile(o,i,a,n,t),s=n.draw,l=n.batch,u=n.scope,c=[];return Y(function(t,e){var n;if("function"===typeof t)return u.call(this,null,t,0);if("function"===typeof e)if("number"===typeof t)for(n=0;n<t;++n)u.call(this,null,e,n);else if(Array.isArray(t))for(n=0;n<t.length;++n)u.call(this,t[n],e,n);else return u.call(this,t,e,0);else if("number"===typeof t){if(0<t)return l.call(this,r(t|0),t|0)}else if(Array.isArray(t)){if(t.length)return l.call(this,t,t.length)}else return s.call(this,t)},{stats:t})}function c(t,e){var r=0;V.procs.poll();var n=e.color;n&&(g.clearColor(+n[0]||0,+n[1]||0,+n[2]||0,+n[3]||0),r|=16384);"depth"in e&&(g.clearDepth(+e.depth),r|=256);"stencil"in e&&(g.clearStencil(e.stencil|0),r|=1024);g.clear(r)}function f(t){H.push(t);r();return{cancel:function(){function e(){var t=W(H,e);H[t]=H[H.length-1];--H.length;0>=H.length&&a()}var r=W(H,t);H[r]=e}}}function h(){var t=U.viewport,e=U.scissor_box;t[0]=t[1]=e[0]=e[1]=0;E.viewportWidth=E.framebufferWidth=E.drawingBufferWidth=t[2]=e[2]=g.drawingBufferWidth;E.viewportHeight=E.framebufferHeight=E.drawingBufferHeight=t[3]=e[3]=g.drawingBufferHeight}function p(){E.tick+=1;E.time=v();h();V.procs.poll()}function d(){h();V.procs.refresh();M&&M.update()}function v(){return(J()-A)/1e3}t=l(t);if(!t)return null;var g=t.gl,m=g.getContextAttributes();g.isContextLost();var y=u(g,t);if(!y)return null;var _=n(),w={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},k=y.extensions,M=Ot(g,k),A=J(),T=g.drawingBufferWidth,S=g.drawingBufferHeight,E={tick:0,time:0,viewportWidth:T,viewportHeight:S,framebufferWidth:T,framebufferHeight:S,drawingBufferWidth:T,drawingBufferHeight:S,pixelRatio:t.pixelRatio},C=Q(g,k),T=P(g,k,C,_),z=x(g,w,t,T),R=b(g,k,z,w),B=O(g,_,w,t),F=L(g,k,C,function(){V.procs.poll()},E,w,t),N=Mt(g,k,C,w,t),j=I(g,k,C,F,N,w),V=G(g,_,k,C,z,R,F,j,{},T,B,{elements:null,primitive:4,count:-1,offset:0,instances:-1},E,M,t),_=D(g,j,V.procs.poll,E,m,k,C),U=V.next,q=g.canvas,H=[],X=[],K=[],tt=[t.onDestroy],et=null;q&&(q.addEventListener("webglcontextlost",i,!1),q.addEventListener("webglcontextrestored",o,!1));var rt=j.setFBO=s({framebuffer:Z.define.call(null,1,"framebuffer")});d();m=Y(s,{clear:function(t){if("framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var e=0;6>e;++e)rt(Y({framebuffer:t.framebuffer.faces[e]},t),c);else rt(t,c);else c(null,t)},prop:Z.define.bind(null,1),context:Z.define.bind(null,2),this:Z.define.bind(null,3),draw:s({}),buffer:function(t){return z.create(t,34962,!1,!1)},elements:function(t){return R.create(t,!1)},texture:F.create2D,cube:F.createCube,renderbuffer:N.create,framebuffer:j.create,framebufferCube:j.createCube,attributes:m,frame:f,on:function(t,e){var r;switch(t){case"frame":return f(e);case"lost":r=X;break;case"restore":r=K;break;case"destroy":r=tt}r.push(e);return{cancel:function(){for(var t=0;t<r.length;++t)if(r[t]===e){r[t]=r[r.length-1];r.pop();break}}}},limits:C,hasExtension:function(t){return 0<=C.extensions.indexOf(t.toLowerCase())},read:_,destroy:function(){H.length=0;a();q&&(q.removeEventListener("webglcontextlost",i),q.removeEventListener("webglcontextrestored",o));B.clear();j.clear();N.clear();F.clear();R.clear();z.clear();M&&M.clear();tt.forEach(function(t){t()})},_gl:g,_refresh:d,poll:function(){p();M&&M.update()},now:v,stats:w});t.onDone(null,m);return m}})},{}],464:[function(t,e,r){"use strict";var n="";var a;e.exports=i;function i(t,e){if(typeof t!=="string"){throw new TypeError("expected a string")}if(e===1)return t;if(e===2)return t+t;var r=t.length*e;if(a!==t||typeof a==="undefined"){a=t;n=""}else if(n.length>=r){return n.substr(0,r)}while(r>n.length&&e>1){if(e&1){n+=t}e>>=1;t+=t}n+=t;n=n.substr(0,r);return n}},{}],465:[function(t,e,r){(function(t){e.exports=t.performance&&t.performance.now?function t(){return performance.now()}:Date.now||function t(){return+new Date}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],466:[function(t,e,r){"use strict";e.exports=n;function n(t){var e=t.length;var r=t[t.length-1];var n=e;for(var a=e-2;a>=0;--a){var i=r;var o=t[a];r=i+o;var s=r-i;var l=o-s;if(l){t[--n]=r;r=l}}var u=0;for(var a=n;a<e;++a){var i=t[a];var o=r;r=i+o;var s=r-i;var l=o-s;if(l){t[u++]=l}}t[u++]=r;t.length=u;return t}},{}],467:[function(t,e,r){"use strict";var n=t("two-product");var a=t("robust-sum");var i=t("robust-scale");var o=t("robust-compress");var s=6;function l(t,e){var r=new Array(t.length-1);for(var n=1;n<t.length;++n){var a=r[n-1]=new Array(t.length-1);for(var i=0,o=0;i<t.length;++i){if(i===e){continue}a[o++]=t[n][i]}}return r}function u(t){var e=new Array(t);for(var r=0;r<t;++r){e[r]=new Array(t);for(var n=0;n<t;++n){e[r][n]=["m[",r,"][",n,"]"].join("")}}return e}function c(t){if(t&1){return"-"}return""}function f(t){if(t.length===1){return t[0]}else if(t.length===2){return["sum(",t[0],",",t[1],")"].join("")}else{var e=t.length>>1;return["sum(",f(t.slice(0,e)),",",f(t.slice(e)),")"].join("")}}function h(t){if(t.length===2){return["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")}else{var e=[];for(var r=0;r<t.length;++r){e.push(["scale(",h(l(t,r)),",",c(r),t[0][r],")"].join(""))}return f(e)}}function p(t){var e=new Function("sum","scale","prod","compress",["function robustDeterminant",t,"(m){return compress(",h(u(t)),")};return robustDeterminant",t].join(""));return e(a,i,n,o)}var d=[function t(){return[0]},function t(e){return[e[0][0]]}];function v(){while(d.length<s){d.push(p(d.length))}var t=[];var r=["function robustDeterminant(m){switch(m.length){"];for(var n=0;n<s;++n){t.push("det"+n);r.push("case ",n,":return det",n,"(m);")}r.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant");t.push("CACHE","gen",r.join(""));var a=Function.apply(undefined,t);e.exports=a.apply(undefined,d.concat([d,p]));for(var n=0;n<d.length;++n){e.exports[n]=d[n]}}v()},{"robust-compress":466,"robust-scale":473,"robust-sum":476,"two-product":505}],468:[function(t,e,r){"use strict";var n=t("two-product");var a=t("robust-sum");e.exports=i;function i(t,e){var r=n(t[0],e[0]);for(var i=1;i<t.length;++i){r=a(r,n(t[i],e[i]))}return r}},{"robust-sum":476,"two-product":505}],469:[function(t,e,r){"use strict";var n=t("two-product");var a=t("robust-sum");var i=t("robust-subtract");var o=t("robust-scale");var s=6;function l(t,e){var r=new Array(t.length-1);for(var n=1;n<t.length;++n){var a=r[n-1]=new Array(t.length-1);for(var i=0,o=0;i<t.length;++i){if(i===e){continue}a[o++]=t[n][i]}}return r}function u(t){var e=new Array(t);for(var r=0;r<t;++r){e[r]=new Array(t);for(var n=0;n<t;++n){e[r][n]=["m",n,"[",t-r-2,"]"].join("")}}return e}function c(t){if(t.length===1){return t[0]}else if(t.length===2){return["sum(",t[0],",",t[1],")"].join("")}else{var e=t.length>>1;return["sum(",c(t.slice(0,e)),",",c(t.slice(e)),")"].join("")}}function f(t,e){if(t.charAt(0)==="m"){if(e.charAt(0)==="w"){var r=t.split("[");return["w",e.substr(1),"m",r[0].substr(1)].join("")}else{return["prod(",t,",",e,")"].join("")}}else{return f(e,t)}}function h(t){if(t&1!==0){return"-"}return""}function p(t){if(t.length===2){return[["diff(",f(t[0][0],t[1][1]),",",f(t[1][0],t[0][1]),")"].join("")]}else{var e=[];for(var r=0;r<t.length;++r){e.push(["scale(",c(p(l(t,r))),",",h(r),t[0][r],")"].join(""))}return e}}function d(t,e){var r=[];for(var n=0;n<e-2;++n){r.push(["prod(m",t,"[",n,"],m",t,"[",n,"])"].join(""))}return c(r)}function v(t){var e=[];var r=[];var s=u(t);for(var f=0;f<t;++f){s[0][f]="1";s[t-1][f]="w"+f}for(var f=0;f<t;++f){if((f&1)===0){e.push.apply(e,p(l(s,f)))}else{r.push.apply(r,p(l(s,f)))}}var h=c(e);var v=c(r);var g="exactInSphere"+t;var m=[];for(var f=0;f<t;++f){m.push("m"+f)}var y=["function ",g,"(",m.join(),"){"];for(var f=0;f<t;++f){y.push("var w",f,"=",d(f,t),";");for(var x=0;x<t;++x){if(x!==f){y.push("var w",f,"m",x,"=scale(w",f,",m",x,"[0]);")}}}y.push("var p=",h,",n=",v,",d=diff(p,n);return d[d.length-1];}return ",g);var b=new Function("sum","diff","prod","scale",y.join(""));return b(a,i,n,o)}function g(){return 0}function m(){return 0}function y(){return 0}var x=[g,m,y];function b(t){var e=x[t.length];if(!e){e=x[t.length]=v(t.length)}return e.apply(undefined,t)}function _(){while(x.length<=s){x.push(v(x.length))}var t=[];var r=["slow"];for(var n=0;n<=s;++n){t.push("a"+n);r.push("o"+n)}var a=["function testInSphere(",t.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(var n=2;n<=s;++n){a.push("case ",n,":return o",n,"(",t.slice(0,n).join(),");")}a.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere");r.push(a.join(""));var i=Function.apply(undefined,r);e.exports=i.apply(undefined,[b].concat(x));for(var n=0;n<=s;++n){e.exports[n]=x[n]}}_()},{"robust-scale":473,"robust-subtract":475,"robust-sum":476,"two-product":505}],470:[function(t,e,r){"use strict";var n=t("robust-determinant");var a=6;function i(t){var e="robustLinearSolve"+t+"d";var r=["function ",e,"(A,b){return ["];for(var a=0;a<t;++a){r.push("det([");for(var i=0;i<t;++i){if(i>0){r.push(",")}r.push("[");for(var o=0;o<t;++o){if(o>0){r.push(",")}if(o===a){r.push("+b[",i,"]")}else{r.push("+A[",i,"][",o,"]")}}r.push("]")}r.push("]),")}r.push("det(A)]}return ",e);var s=new Function("det",r.join(""));if(t<6){return s(n[t])}return s(n)}function o(){return[0]}function s(t,e){return[[e[0]],[t[0][0]]]}var l=[o,s];function u(){while(l.length<a){l.push(i(l.length))}var t=[];var r=["function dispatchLinearSolve(A,b){switch(A.length){"];for(var n=0;n<a;++n){t.push("s"+n);r.push("case ",n,":return s",n,"(A,b);")}r.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve");t.push("CACHE","g",r.join(""));var o=Function.apply(undefined,t);e.exports=o.apply(undefined,l.concat([l,i]));for(var n=0;n<a;++n){e.exports[n]=l[n]}}u()},{"robust-determinant":467}],471:[function(t,e,r){"use strict";var n=t("two-product");var a=t("robust-sum");var i=t("robust-scale");var o=t("robust-subtract");var s=5;var l=1.1102230246251565e-16;var u=(3+16*l)*l;var c=(7+56*l)*l;function f(t,e){var r=new Array(t.length-1);for(var n=1;n<t.length;++n){var a=r[n-1]=new Array(t.length-1);for(var i=0,o=0;i<t.length;++i){if(i===e){continue}a[o++]=t[n][i]}}return r}function h(t){var e=new Array(t);for(var r=0;r<t;++r){e[r]=new Array(t);for(var n=0;n<t;++n){e[r][n]=["m",n,"[",t-r-1,"]"].join("")}}return e}function p(t){if(t&1){return"-"}return""}function d(t){if(t.length===1){return t[0]}else if(t.length===2){return["sum(",t[0],",",t[1],")"].join("")}else{var e=t.length>>1;return["sum(",d(t.slice(0,e)),",",d(t.slice(e)),")"].join("")}}function v(t){if(t.length===2){return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")]}else{var e=[];for(var r=0;r<t.length;++r){e.push(["scale(",d(v(f(t,r))),",",p(r),t[0][r],")"].join(""))}return e}}function g(t){var e=[];var r=[];var s=h(t);var l=[];for(var u=0;u<t;++u){if((u&1)===0){e.push.apply(e,v(f(s,u)))}else{r.push.apply(r,v(f(s,u)))}l.push("m"+u)}var c=d(e);var p=d(r);var g="orientation"+t+"Exact";var m=["function ",g,"(",l.join(),"){var p=",c,",n=",p,",d=sub(p,n);return d[d.length-1];};return ",g].join("");var y=new Function("sum","prod","scale","sub",m);return y(a,n,i,o)}var m=g(3);var y=g(4);var x=[function t(){return 0},function t(){return 0},function t(e,r){return r[0]-e[0]},function t(e,r,n){var a=(e[1]-n[1])*(r[0]-n[0]);var i=(e[0]-n[0])*(r[1]-n[1]);var o=a-i;var s;if(a>0){if(i<=0){return o}else{s=a+i}}else if(a<0){if(i>=0){return o}else{s=-(a+i)}}else{return o}var l=u*s;if(o>=l||o<=-l){return o}return m(e,r,n)},function t(e,r,n,a){var i=e[0]-a[0];var o=r[0]-a[0];var s=n[0]-a[0];var l=e[1]-a[1];var u=r[1]-a[1];var f=n[1]-a[1];var h=e[2]-a[2];var p=r[2]-a[2];var d=n[2]-a[2];var v=o*f;var g=s*u;var m=s*l;var x=i*f;var b=i*u;var _=o*l;var w=h*(v-g)+p*(m-x)+d*(b-_);var k=(Math.abs(v)+Math.abs(g))*Math.abs(h)+(Math.abs(m)+Math.abs(x))*Math.abs(p)+(Math.abs(b)+Math.abs(_))*Math.abs(d);var M=c*k;if(w>M||-w>M){return w}return y(e,r,n,a)}];function b(t){var e=x[t.length];if(!e){e=x[t.length]=g(t.length)}return e.apply(undefined,t)}function _(){while(x.length<=s){x.push(g(x.length))}var t=[];var r=["slow"];for(var n=0;n<=s;++n){t.push("a"+n);r.push("o"+n)}var a=["function getOrientation(",t.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(var n=2;n<=s;++n){a.push("case ",n,":return o",n,"(",t.slice(0,n).join(),");")}a.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation");r.push(a.join(""));var i=Function.apply(undefined,r);e.exports=i.apply(undefined,[b].concat(x));for(var n=0;n<=s;++n){e.exports[n]=x[n]}}_()},{"robust-scale":473,"robust-subtract":475,"robust-sum":476,"two-product":505}],472:[function(t,e,r){"use strict";var n=t("robust-sum");var a=t("robust-scale");e.exports=i;function i(t,e){if(t.length===1){return a(e,t[0])}if(e.length===1){return a(t,e[0])}if(t.length===0||e.length===0){return[0]}var r=[0];if(t.length<e.length){for(var i=0;i<t.length;++i){r=n(r,a(e,t[i]))}}else{for(var i=0;i<e.length;++i){r=n(r,a(t,e[i]))}}return r}},{"robust-scale":473,"robust-sum":476}],473:[function(t,e,r){"use strict";var n=t("two-product");var a=t("two-sum");e.exports=i;function i(t,e){var r=t.length;if(r===1){var i=n(t[0],e);if(i[0]){return i}return[i[1]]}var o=new Array(2*r);var s=[.1,.1];var l=[.1,.1];var u=0;n(t[0],e,s);if(s[0]){o[u++]=s[0]}for(var c=1;c<r;++c){n(t[c],e,l);var f=s[1];a(f,l[0],s);if(s[0]){o[u++]=s[0]}var h=l[1];var p=s[1];var d=h+p;var v=d-h;var g=p-v;s[1]=d;if(g){o[u++]=g}}if(s[1]){o[u++]=s[1]}if(u===0){o[u++]=0}o.length=u;return o}},{"two-product":505,"two-sum":506}],474:[function(t,e,r){"use strict";e.exports=i;var n=t("robust-orientation")[3];function a(t,e,r,n){for(var a=0;a<2;++a){var i=t[a];var o=e[a];var s=Math.min(i,o);var l=Math.max(i,o);var u=r[a];var c=n[a];var f=Math.min(u,c);var h=Math.max(u,c);if(h<s||l<f){return false}}return true}function i(t,e,r,i){var o=n(t,r,i);var s=n(e,r,i);if(o>0&&s>0||o<0&&s<0){return false}var l=n(r,t,e);var u=n(i,t,e);if(l>0&&u>0||l<0&&u<0){return false}if(o===0&&s===0&&l===0&&u===0){return a(t,e,r,i)}return true}},{"robust-orientation":471}],475:[function(t,e,r){"use strict";e.exports=a;function n(t,e){var r=t+e;var n=r-t;var a=r-n;var i=e-n;var o=t-a;var s=o+i;if(s){return[s,r]}return[r]}function a(t,e){var r=t.length|0;var a=e.length|0;if(r===1&&a===1){return n(t[0],-e[0])}var i=r+a;var o=new Array(i);var s=0;var l=0;var u=0;var c=Math.abs;var f=t[l];var h=c(f);var p=-e[u];var d=c(p);var v,g;if(h<d){g=f;l+=1;if(l<r){f=t[l];h=c(f)}}else{g=p;u+=1;if(u<a){p=-e[u];d=c(p)}}if(l<r&&h<d||u>=a){v=f;l+=1;if(l<r){f=t[l];h=c(f)}}else{v=p;u+=1;if(u<a){p=-e[u];d=c(p)}}var m=v+g;var y=m-v;var x=g-y;var b=x;var _=m;var w,k,M,A,T;while(l<r&&u<a){if(h<d){v=f;l+=1;if(l<r){f=t[l];h=c(f)}}else{v=p;u+=1;if(u<a){p=-e[u];d=c(p)}}g=b;m=v+g;y=m-v;x=g-y;if(x){o[s++]=x}w=_+m;k=w-_;M=w-k;A=m-k;T=_-M;b=T+A;_=w}while(l<r){v=f;g=b;m=v+g;y=m-v;x=g-y;if(x){o[s++]=x}w=_+m;k=w-_;M=w-k;A=m-k;T=_-M;b=T+A;_=w;l+=1;if(l<r){f=t[l]}}while(u<a){v=p;g=b;m=v+g;y=m-v;x=g-y;if(x){o[s++]=x}w=_+m;k=w-_;M=w-k;A=m-k;T=_-M;b=T+A;_=w;u+=1;if(u<a){p=-e[u]}}if(b){o[s++]=b}if(_){o[s++]=_}if(!s){o[s++]=0}o.length=s;return o}},{}],476:[function(t,e,r){"use strict";e.exports=a;function n(t,e){var r=t+e;var n=r-t;var a=r-n;var i=e-n;var o=t-a;var s=o+i;if(s){return[s,r]}return[r]}function a(t,e){var r=t.length|0;var a=e.length|0;if(r===1&&a===1){return n(t[0],e[0])}var i=r+a;var o=new Array(i);var s=0;var l=0;var u=0;var c=Math.abs;var f=t[l];var h=c(f);var p=e[u];var d=c(p);var v,g;if(h<d){g=f;l+=1;if(l<r){f=t[l];h=c(f)}}else{g=p;u+=1;if(u<a){p=e[u];d=c(p)}}if(l<r&&h<d||u>=a){v=f;l+=1;if(l<r){f=t[l];h=c(f)}}else{v=p;u+=1;if(u<a){p=e[u];d=c(p)}}var m=v+g;var y=m-v;var x=g-y;var b=x;var _=m;var w,k,M,A,T;while(l<r&&u<a){if(h<d){v=f;l+=1;if(l<r){f=t[l];h=c(f)}}else{v=p;u+=1;if(u<a){p=e[u];d=c(p)}}g=b;m=v+g;y=m-v;x=g-y;if(x){o[s++]=x}w=_+m;k=w-_;M=w-k;A=m-k;T=_-M;b=T+A;_=w}while(l<r){v=f;g=b;m=v+g;y=m-v;x=g-y;if(x){o[s++]=x}w=_+m;k=w-_;M=w-k;A=m-k;T=_-M;b=T+A;_=w;l+=1;if(l<r){f=t[l]}}while(u<a){v=p;g=b;m=v+g;y=m-v;x=g-y;if(x){o[s++]=x}w=_+m;k=w-_;M=w-k;A=m-k;T=_-M;b=T+A;_=w;u+=1;if(u<a){p=e[u]}}if(b){o[s++]=b}if(_){o[s++]=_}if(!s){o[s++]=0}o.length=s;return o}},{}],477:[function(t,e,r){"use strict";e.exports=function t(e){if(e<0){return-1}if(e>0){return 1}return 0}},{}],478:[function(t,e,r){"use strict";e.exports=i;var n=t("boundary-cells");var a=t("reduce-simplicial-complex");function i(t){return a(n(t))}},{"boundary-cells":83,"reduce-simplicial-complex":456}],479:[function(t,e,r){"use strict";e.exports=p;var n=t("ndarray");var a=t("typedarray-pool");var i=t("ndarray-sort");var o=t("./lib/codegen");function s(t){var e=t.length;var r=0;for(var n=0;n<e;++n){r=Math.max(r,t[n].length)|0}return r-1}function l(t,e){var r=t.length;var n=a.mallocUint8(r);for(var i=0;i<r;++i){n[i]=t[i]<e|0}return n}function u(t,e){var r=t.length;var o=e*(e+1)/2*r|0;var s=a.mallocUint32(o*2);var l=0;for(var u=0;u<r;++u){var c=t[u];var e=c.length;for(var f=0;f<e;++f){for(var h=0;h<f;++h){var p=c[h];var d=c[f];s[l++]=Math.min(p,d)|0;s[l++]=Math.max(p,d)|0}}}var v=l/2|0;i(n(s,[v,2]));var g=2;for(var u=2;u<l;u+=2){if(s[u-2]===s[u]&&s[u-1]===s[u+1]){continue}s[g++]=s[u];s[g++]=s[u+1]}return n(s,[g/2|0,2])}function c(t,e,r,i){var o=t.data;var s=t.shape[0];var l=a.mallocDouble(s);var u=0;for(var c=0;c<s;++c){var f=o[2*c];var h=o[2*c+1];if(r[f]===r[h]){continue}var p=e[f];var d=e[h];o[2*u]=f;o[2*u+1]=h;l[u++]=(d-i)/(d-p)}t.shape[0]=u;return n(l,[u])}function f(t,e){var r=a.mallocInt32(e*2);var n=t.shape[0];var i=t.data;r[0]=0;var o=0;for(var s=0;s<n;++s){var l=i[2*s];if(l!==o){r[2*o+1]=s;while(++o<l){r[2*o]=s;r[2*o+1]=s}r[2*o]=s}}r[2*o+1]=n;while(++o<e){r[2*o]=r[2*o+1]=n}return r}function h(t){var e=t.shape[0]|0;var r=t.data;var n=new Array(e);for(var a=0;a<e;++a){n[a]=[r[2*a],r[2*a+1]]}return n}function p(t,e,r,n){r=r||0;if(typeof n==="undefined"){n=s(t)}var i=t.length;if(i===0||n<1){return{cells:[],vertexIds:[],vertexWeights:[]}}var p=l(e,+r);var d=u(t,n);var v=c(d,e,p,+r);var g=f(d,e.length|0);var m=o(n)(t,d.data,g,p);var y=h(d);var x=[].slice.call(v.data,0,v.shape[0]);a.free(p);a.free(d.data);a.free(v.data);a.free(g);return{cells:m,vertexIds:y,vertexWeights:x}}},{"./lib/codegen":480,ndarray:417,"ndarray-sort":415,"typedarray-pool":507}],480:[function(t,e,r){"use strict";e.exports=s;var n=t("typedarray-pool");var a=t("marching-simplex-table");var i={};function o(t){var e=0;var r=new Array(t+1);r[0]=[[]];for(var i=1;i<=t;++i){var o=r[i]=a(i);for(var s=0;s<o.length;++s){e=Math.max(e,o[i].length)}}var l=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",t,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"];function u(t){if(t.length<=0){return}l.push("R.push(");for(var e=0;e<t.length;++e){var r=t[e];if(e>0){l.push(",")}l.push("[");for(var n=0;n<r.length;++n){var a=r[n];if(n>0){l.push(",")}l.push("B(C,E,c[",a[0],"],c[",a[1],"])")}l.push("]")}l.push(");")}for(var i=t+1;i>1;--i){if(i<t+1){l.push("else ")}l.push("if(l===",i,"){");var c=[];for(var s=0;s<i;++s){c.push("(S[c["+s+"]]<<"+s+")")}l.push("var M=",c.join("+"),";if(M===0||M===",(1<<i)-1,"){continue}switch(M){");var o=r[i-1];for(var s=0;s<o.length;++s){l.push("case ",s,":");u(o[s]);l.push("break;")}l.push("}}")}l.push("}return R;};return getContour",t,"d");var f=new Function("pool",l.join(""));return f(n)}function s(t){var e=i[t];if(!e){e=i[t]=o(t)}return e}},{"marching-simplex-table":394,"typedarray-pool":507}],481:[function(t,e,r){"use strict";"use restrict";var n=t("bit-twiddle"),a=t("union-find");function i(t){var e=0,r=Math.max;for(var n=0,a=t.length;n<a;++n){e=r(e,t[n].length)}return e-1}r.dimension=i;function o(t){var e=-1,r=Math.max;for(var n=0,a=t.length;n<a;++n){var i=t[n];for(var o=0,s=i.length;o<s;++o){e=r(e,i[o])}}return e+1}r.countVertices=o;function s(t){var e=new Array(t.length);for(var r=0,n=t.length;r<n;++r){e[r]=t[r].slice(0)}return e}r.cloneCells=s;function l(t,e){var r=t.length,n=t.length-e.length,a=Math.min;if(n){return n}switch(r){case 0:return 0;case 1:return t[0]-e[0];case 2:var i=t[0]+t[1]-e[0]-e[1];if(i){return i}return a(t[0],t[1])-a(e[0],e[1]);case 3:var o=t[0]+t[1],s=e[0]+e[1];i=o+t[2]-(s+e[2]);if(i){return i}var l=a(t[0],t[1]),u=a(e[0],e[1]),i=a(l,t[2])-a(u,e[2]);if(i){return i}return a(l+t[2],o)-a(u+e[2],s);default:var c=t.slice(0);c.sort();var f=e.slice(0);f.sort();for(var h=0;h<r;++h){n=c[h]-f[h];if(n){return n}}return 0}}r.compareCells=l;function u(t,e){return l(t[0],e[0])}function c(t,e){if(e){var r=t.length;var n=new Array(r);for(var a=0;a<r;++a){n[a]=[t[a],e[a]]}n.sort(u);for(var a=0;a<r;++a){t[a]=n[a][0];e[a]=n[a][1]}return t}else{t.sort(l);return t}}r.normalize=c;function f(t){if(t.length===0){return[]}var e=1,r=t.length;for(var n=1;n<r;++n){var a=t[n];if(l(a,t[n-1])){if(n===e){e++;continue}t[e++]=a}}t.length=e;return t}r.unique=f;function h(t,e){var r=0,n=t.length-1,a=-1;while(r<=n){var i=r+n>>1,o=l(t[i],e);if(o<=0){if(o===0){a=i}r=i+1}else if(o>0){n=i-1}}return a}r.findCell=h;function p(t,e){var r=new Array(t.length);for(var a=0,i=r.length;a<i;++a){r[a]=[]}var o=[];for(var a=0,s=e.length;a<s;++a){var u=e[a];var c=u.length;for(var f=1,p=1<<c;f<p;++f){o.length=n.popCount(f);var d=0;for(var v=0;v<c;++v){if(f&1<<v){o[d++]=u[v]}}var g=h(t,o);if(g<0){continue}while(true){r[g++].push(a);if(g>=t.length||l(t[g],o)!==0){break}}}}return r}r.incidence=p;function d(t,e){if(!e){return p(f(g(t,0)),t,0)}var r=new Array(e);for(var n=0;n<e;++n){r[n]=[]}for(var n=0,a=t.length;n<a;++n){var i=t[n];for(var o=0,s=i.length;o<s;++o){r[i[o]].push(n)}}return r}r.dual=d;function v(t){var e=[];for(var r=0,n=t.length;r<n;++r){var a=t[r],i=a.length|0;for(var o=1,s=1<<i;o<s;++o){var l=[];for(var u=0;u<i;++u){if(o>>>u&1){l.push(a[u])}}e.push(l)}}return c(e)}r.explode=v;function g(t,e){if(e<0){return[]}var r=[],a=(1<<e+1)-1;for(var i=0;i<t.length;++i){var o=t[i];for(var s=a;s<1<<o.length;s=n.nextCombination(s)){var l=new Array(e+1),u=0;for(var f=0;f<o.length;++f){if(s&1<<f){l[u++]=o[f]}}r.push(l)}}return c(r)}r.skeleton=g;function m(t){var e=[];for(var r=0,n=t.length;r<n;++r){var a=t[r];for(var i=0,o=a.length;i<o;++i){var s=new Array(a.length-1);for(var l=0,u=0;l<o;++l){if(l!==i){s[u++]=a[l]}}e.push(s)}}return c(e)}r.boundary=m;function y(t,e){var r=new a(e);for(var n=0;n<t.length;++n){var i=t[n];for(var o=0;o<i.length;++o){for(var s=o+1;s<i.length;++s){r.link(i[o],i[s])}}}var l=[],u=r.ranks;for(var n=0;n<u.length;++n){u[n]=-1}for(var n=0;n<t.length;++n){var c=r.find(t[n][0]);if(u[c]<0){u[c]=l.length;l.push([t[n].slice(0)])}else{l[u[c]].push(t[n].slice(0))}}return l}function x(t){var e=f(c(g(t,0))),r=new a(e.length);for(var n=0;n<t.length;++n){var i=t[n];for(var o=0;o<i.length;++o){var s=h(e,[i[o]]);for(var l=o+1;l<i.length;++l){r.link(s,h(e,[i[l]]))}}}var u=[],p=r.ranks;for(var n=0;n<p.length;++n){p[n]=-1}for(var n=0;n<t.length;++n){var d=r.find(h(e,[t[n][0]]));if(p[d]<0){p[d]=u.length;u.push([t[n].slice(0)])}else{u[p[d]].push(t[n].slice(0))}}return u}function b(t,e){if(e){return y(t,e)}return x(t)}r.connectedComponents=b},{"bit-twiddle":80,"union-find":508}],482:[function(t,e,r){arguments[4][80][0].apply(r,arguments)},{dup:80}],483:[function(t,e,r){arguments[4][481][0].apply(r,arguments)},{"bit-twiddle":482,dup:481,"union-find":484}],484:[function(t,e,r){"use strict";"use restrict";e.exports=n;function n(t){this.roots=new Array(t);this.ranks=new Array(t);for(var e=0;e<t;++e){this.roots[e]=e;this.ranks[e]=0}}n.prototype.length=function(){return this.roots.length};n.prototype.makeSet=function(){var t=this.roots.length;this.roots.push(t);this.ranks.push(0);return t};n.prototype.find=function(t){var e=this.roots;while(e[t]!==t){var r=e[t];e[t]=e[r];t=r}return t};n.prototype.link=function(t,e){var r=this.find(t),n=this.find(e);if(r===n){return}var a=this.ranks,i=this.roots,o=a[r],s=a[n];if(o<s){i[r]=n}else if(s<o){i[n]=r}else{i[n]=r;++a[r]}}},{}],485:[function(t,e,r){"use strict";e.exports=o;var n=t("robust-orientation");var a=t("simplicial-complex");function i(t,e,r){var a=Math.abs(n(t,e,r));var i=Math.sqrt(Math.pow(e[0]-r[0],2)+Math.pow(e[1]-r[1],2));return a/i}function o(t,e,r){var n=e.length;var o=t.length;var s=new Array(n);var l=new Array(n);var u=new Array(n);var c=new Array(n);for(var f=0;f<n;++f){s[f]=l[f]=-1;u[f]=Infinity;c[f]=false}for(var f=0;f<o;++f){var h=t[f];if(h.length!==2){throw new Error("Input must be a graph")}var p=h[1];var d=h[0];if(l[d]!==-1){l[d]=-2}else{l[d]=p}if(s[p]!==-1){s[p]=-2}else{s[p]=d}}function v(t){if(c[t]){return Infinity}var r=s[t];var n=l[t];if(r<0||n<0){return Infinity}else{return i(e[t],e[r],e[n])}}function g(t,e){var r=M[t];var n=M[e];M[t]=n;M[e]=r;A[r]=e;A[n]=t}function m(t){return u[M[t]]}function y(t){if(t&1){return t-1>>1}return(t>>1)-1}function x(t){var e=m(t);while(true){var r=e;var n=2*t+1;var a=2*(t+1);var i=t;if(n<S){var o=m(n);if(o<r){i=n;r=o}}if(a<S){var s=m(a);if(s<r){i=a}}if(i===t){return t}g(t,i);t=i}}function b(t){var e=m(t);while(t>0){var r=y(t);if(r>=0){var n=m(r);if(e<n){g(t,r);t=r;continue}}return t}}function _(){if(S>0){var t=M[0];g(0,S-1);S-=1;x(0);return t}return-1}function w(t,e){var r=M[t];if(u[r]===e){return t}u[r]=-Infinity;b(t);_();u[r]=e;S+=1;return b(S-1)}function k(t){if(c[t]){return}c[t]=true;var e=s[t];var r=l[t];if(s[r]>=0){s[r]=e}if(l[e]>=0){l[e]=r}if(A[e]>=0){w(A[e],v(e))}if(A[r]>=0){w(A[r],v(r))}}var M=[];var A=new Array(n);for(var f=0;f<n;++f){var T=u[f]=v(f);if(T<Infinity){A[f]=M.length;M.push(f)}else{A[f]=-1}}var S=M.length;for(var f=S>>1;f>=0;--f){x(f)}while(true){var E=_();if(E<0||u[E]>r){break}k(E)}var C=[];for(var f=0;f<n;++f){if(!c[f]){A[f]=C.length;C.push(e[f].slice())}}var L=C.length;function I(t,e){if(t[e]<0){return e}var r=e;var n=e;do{var a=t[n];if(!c[n]||a<0||a===n){break}n=a;a=t[n];if(!c[n]||a<0||a===n){break}n=a;r=t[r]}while(r!==n);for(var i=e;i!==n;i=t[i]){t[i]=n}return n}var z=[];t.forEach(function(t){var e=I(s,t[0]);var r=I(l,t[1]);if(e>=0&&r>=0&&e!==r){var n=A[e];var a=A[r];if(n!==a){z.push([n,a])}}});a.unique(a.normalize(z));return{positions:C,edges:z}}},{"robust-orientation":471,"simplicial-complex":483}],486:[function(t,e,r){"use strict";e.exports=i;var n=t("robust-orientation");function a(t,e){var r,a;if(e[0][0]<e[1][0]){r=e[0];a=e[1]}else if(e[0][0]>e[1][0]){r=e[1];a=e[0]}else{var i=Math.min(t[0][1],t[1][1]);var o=Math.max(t[0][1],t[1][1]);var s=Math.min(e[0][1],e[1][1]);var l=Math.max(e[0][1],e[1][1]);if(o<s){return o-s}if(i>l){return i-l}return o-l}var u,c;if(t[0][1]<t[1][1]){u=t[0];c=t[1]}else{u=t[1];c=t[0]}var f=n(a,r,u);if(f){return f}f=n(a,r,c);if(f){return f}return c-a}function i(t,e){var r,i;if(e[0][0]<e[1][0]){r=e[0];i=e[1]}else if(e[0][0]>e[1][0]){r=e[1];i=e[0]}else{return a(e,t)}var o,s;if(t[0][0]<t[1][0]){o=t[0];s=t[1]}else if(t[0][0]>t[1][0]){o=t[1];s=t[0]}else{return-a(t,e)}var l=n(r,i,s);var u=n(r,i,o);if(l<0){if(u<=0){return l}}else if(l>0){if(u>=0){return l}}else if(u){return u}l=n(s,o,i);u=n(s,o,r);if(l<0){if(u<=0){return l}}else if(l>0){if(u>=0){return l}}else if(u){return u}return i[0]-s[0]}},{"robust-orientation":471}],487:[function(t,e,r){"use strict";e.exports=p;var n=t("binary-search-bounds");var a=t("functional-red-black-tree");var i=t("robust-orientation");var o=t("./lib/order-segments");function s(t,e,r){this.slabs=t;this.coordinates=e;this.horizontal=r}var l=s.prototype;function u(t,e){return t.y-e}function c(t,e){var r=null;while(t){var n=t.key;var a,o;if(n[0][0]<n[1][0]){a=n[0];o=n[1]}else{a=n[1];o=n[0]}var s=i(a,o,e);if(s<0){t=t.left}else if(s>0){if(e[0]!==n[1][0]){r=t;t=t.right}else{var l=c(t.right,e);if(l){return l}t=t.left}}else{if(e[0]!==n[1][0]){return t}else{var l=c(t.right,e);if(l){return l}t=t.left}}}return r}l.castUp=function(t){var e=n.le(this.coordinates,t[0]);if(e<0){return-1}var r=this.slabs[e];var a=c(this.slabs[e],t);var s=-1;if(a){s=a.value}if(this.coordinates[e]===t[0]){var l=null;if(a){l=a.key}if(e>0){var f=c(this.slabs[e-1],t);if(f){if(l){if(o(f.key,l)>0){l=f.key;s=f.value}}else{s=f.value;l=f.key}}}var h=this.horizontal[e];if(h.length>0){var p=n.ge(h,t[1],u);if(p<h.length){var d=h[p];if(t[1]===d.y){if(d.closed){return d.index}else{while(p<h.length-1&&h[p+1].y===t[1]){p=p+1;d=h[p];if(d.closed){return d.index}}if(d.y===t[1]&&!d.start){p=p+1;if(p>=h.length){return s}d=h[p]}}}if(d.start){if(l){var v=i(l[0],l[1],[t[0],d.y]);if(l[0][0]>l[1][0]){v=-v}if(v>0){s=d.index}}else{s=d.index}}else if(d.y!==t[1]){s=d.index}}}}return s};function f(t,e,r,n){this.y=t;this.index=e;this.start=r;this.closed=n}function h(t,e,r,n){this.x=t;this.segment=e;this.create=r;this.index=n}function p(t){var e=t.length;var r=2*e;var n=new Array(r);for(var i=0;i<e;++i){var l=t[i];var u=l[0][0]<l[1][0];n[2*i]=new h(l[0][0],l,u,i);n[2*i+1]=new h(l[1][0],l,!u,i)}n.sort(function(t,e){var r=t.x-e.x;if(r){return r}r=t.create-e.create;if(r){return r}return Math.min(t.segment[0][1],t.segment[1][1])-Math.min(e.segment[0][1],e.segment[1][1])});var c=a(o);var p=[];var d=[];var v=[];var g=-Infinity;for(var i=0;i<r;){var m=n[i].x;var y=[];while(i<r){var x=n[i];if(x.x!==m){break}i+=1;if(x.segment[0][0]===x.x&&x.segment[1][0]===x.x){if(x.create){if(x.segment[0][1]<x.segment[1][1]){y.push(new f(x.segment[0][1],x.index,true,true));y.push(new f(x.segment[1][1],x.index,false,false))}else{y.push(new f(x.segment[1][1],x.index,true,false));y.push(new f(x.segment[0][1],x.index,false,true))}}}else{if(x.create){c=c.insert(x.segment,x.index)}else{c=c.remove(x.segment)}}}p.push(c.root);d.push(m);v.push(y)}return new s(p,d,v)}},{"./lib/order-segments":486,"binary-search-bounds":79,"functional-red-black-tree":219,"robust-orientation":471}],488:[function(t,e,r){"use strict";var n=t("robust-dot-product");var a=t("robust-sum");e.exports=s;e.exports.positive=l;e.exports.negative=u;function i(t,e){var r=a(n(t,e),[e[e.length-1]]);return r[r.length-1]}function o(t,e,r,n){var a=n-e;var i=-e/a;if(i<0){i=0}else if(i>1){i=1}var o=1-i;var s=t.length;var l=new Array(s);for(var u=0;u<s;++u){l[u]=i*t[u]+o*r[u]}return l}function s(t,e){var r=[];var n=[];var a=i(t[t.length-1],e);for(var s=t[t.length-1],l=t[0],u=0;u<t.length;++u,s=l){l=t[u];var c=i(l,e);if(a<0&&c>0||a>0&&c<0){var f=o(s,c,l,a);r.push(f);n.push(f.slice())}if(c<0){n.push(l.slice())}else if(c>0){r.push(l.slice())}else{r.push(l.slice());n.push(l.slice())}a=c}return{positive:r,negative:n}}function l(t,e){var r=[];var n=i(t[t.length-1],e);for(var a=t[t.length-1],s=t[0],l=0;l<t.length;++l,a=s){s=t[l];var u=i(s,e);if(n<0&&u>0||n>0&&u<0){r.push(o(a,u,s,n))}if(u>=0){r.push(s.slice())}n=u}return r}function u(t,e){var r=[];var n=i(t[t.length-1],e);for(var a=t[t.length-1],s=t[0],l=0;l<t.length;++l,a=s){s=t[l];var u=i(s,e);if(n<0&&u>0||n>0&&u<0){r.push(o(a,u,s,n))}if(u<=0){r.push(s.slice())}n=u}return r}},{"robust-dot-product":468,"robust-sum":476}],489:[function(e,r,n){!function(){"use strict";var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function r(t){return i(s(t),arguments)}function a(t,e){return r.apply(null,[t].concat(e||[]))}function i(t,n){var a=1,i=t.length,o,s="",l,u,c,f,h,p,d,v;for(l=0;l<i;l++){if(typeof t[l]==="string"){s+=t[l]}else if(Array.isArray(t[l])){c=t[l];if(c[2]){o=n[a];for(u=0;u<c[2].length;u++){if(!o.hasOwnProperty(c[2][u])){throw new Error(r('[sprintf] property "%s" does not exist',c[2][u]))}o=o[c[2][u]]}}else if(c[1]){o=n[c[1]]}else{o=n[a++]}if(e.not_type.test(c[8])&&e.not_primitive.test(c[8])&&o instanceof Function){o=o()}if(e.numeric_arg.test(c[8])&&(typeof o!=="number"&&isNaN(o))){throw new TypeError(r("[sprintf] expecting number but found %T",o))}if(e.number.test(c[8])){d=o>=0}switch(c[8]){case"b":o=parseInt(o,10).toString(2);break;case"c":o=String.fromCharCode(parseInt(o,10));break;case"d":case"i":o=parseInt(o,10);break;case"j":o=JSON.stringify(o,null,c[6]?parseInt(c[6]):0);break;case"e":o=c[7]?parseFloat(o).toExponential(c[7]):parseFloat(o).toExponential();break;case"f":o=c[7]?parseFloat(o).toFixed(c[7]):parseFloat(o);break;case"g":o=c[7]?String(Number(o.toPrecision(c[7]))):parseFloat(o);break;case"o":o=(parseInt(o,10)>>>0).toString(8);break;case"s":o=String(o);o=c[7]?o.substring(0,c[7]):o;break;case"t":o=String(!!o);o=c[7]?o.substring(0,c[7]):o;break;case"T":o=Object.prototype.toString.call(o).slice(8,-1).toLowerCase();o=c[7]?o.substring(0,c[7]):o;break;case"u":o=parseInt(o,10)>>>0;break;case"v":o=o.valueOf();o=c[7]?o.substring(0,c[7]):o;break;case"x":o=(parseInt(o,10)>>>0).toString(16);break;case"X":o=(parseInt(o,10)>>>0).toString(16).toUpperCase();break}if(e.json.test(c[8])){s+=o}else{if(e.number.test(c[8])&&(!d||c[3])){v=d?"+":"-";o=o.toString().replace(e.sign,"")}else{v=""}h=c[4]?c[4]==="0"?"0":c[4].charAt(1):" ";p=c[6]-(v+o).length;f=c[6]?p>0?h.repeat(p):"":"";s+=c[5]?v+o+f:h==="0"?v+f+o:f+v+o}}}return s}var o=Object.create(null);function s(t){if(o[t]){return o[t]}var r=t,n,a=[],i=0;while(r){if((n=e.text.exec(r))!==null){a.push(n[0])}else if((n=e.modulo.exec(r))!==null){a.push("%")}else if((n=e.placeholder.exec(r))!==null){if(n[2]){i|=1;var s=[],l=n[2],u=[];if((u=e.key.exec(l))!==null){s.push(u[1]);while((l=l.substring(u[0].length))!==""){if((u=e.key_access.exec(l))!==null){s.push(u[1])}else if((u=e.index_access.exec(l))!==null){s.push(u[1])}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}}}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}n[2]=s}else{i|=2}if(i===3){throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported")}a.push(n)}else{throw new SyntaxError("[sprintf] unexpected placeholder")}r=r.substring(n[0].length)}return o[t]=a}if(typeof n!=="undefined"){n["sprintf"]=r;n["vsprintf"]=a}if(typeof window!=="undefined"){window["sprintf"]=r;window["vsprintf"]=a;if(typeof t==="function"&&t["amd"]){t(function(){return{sprintf:r,vsprintf:a}})}}}()},{}],490:[function(t,e,r){"use strict";var n=t("parenthesis");e.exports=function t(e,r,a){if(e==null)throw Error("First argument should be a string");if(r==null)throw Error("Separator should be a string or a RegExp");if(!a)a={};else if(typeof a==="string"||Array.isArray(a)){a={ignore:a}}if(a.escape==null)a.escape=true;if(a.ignore==null)a.ignore=["[]","()","{}","<>",'""',"''","``","\u201c\u201d","\xab\xbb"];else{if(typeof a.ignore==="string"){a.ignore=[a.ignore]}a.ignore=a.ignore.map(function(t){if(t.length===1)t=t+t;return t})}var i=n.parse(e,{flat:true,brackets:a.ignore});var o=i[0];var s=o.split(r);if(a.escape){var l=[];for(var u=0;u<s.length;u++){var c=s[u];var f=s[u+1];if(c[c.length-1]==="\\"&&c[c.length-2]!=="\\"){l.push(c+r+f);u++}else{l.push(c)}}s=l}for(var u=0;u<s.length;u++){i[0]=s[u];s[u]=n.stringify(i,{flat:true})}return s}},{parenthesis:425}],491:[function(t,e,r){"use strict";e.exports=n;function n(t){var e=t.length;var r=new Array(e);var n=new Array(e);var a=new Array(e);var i=new Array(e);var o=new Array(e);var s=new Array(e);for(var l=0;l<e;++l){r[l]=-1;n[l]=0;a[l]=false;i[l]=0;o[l]=-1;s[l]=[]}var u=0;var c=[];var f=[];function h(e){var l=[e],h=[e];r[e]=n[e]=u;a[e]=true;u+=1;while(h.length>0){e=h[h.length-1];var p=t[e];if(i[e]<p.length){for(var d=i[e];d<p.length;++d){var v=p[d];if(r[v]<0){r[v]=n[v]=u;a[v]=true;u+=1;l.push(v);h.push(v);break}else if(a[v]){n[e]=Math.min(n[e],n[v])|0}if(o[v]>=0){s[e].push(o[v])}}i[e]=d}else{if(n[e]===r[e]){var g=[];var m=[],y=0;for(var d=l.length-1;d>=0;--d){var x=l[d];a[x]=false;g.push(x);m.push(s[x]);y+=s[x].length;o[x]=c.length;if(x===e){l.length=d;break}}c.push(g);var b=new Array(y);for(var d=0;d<m.length;d++){for(var _=0;_<m[d].length;_++){b[--y]=m[d][_]}}f.push(b)}h.pop()}}}for(var l=0;l<e;++l){if(r[l]<0){h(l)}}var p;for(var l=0;l<f.length;l++){var d=f[l];if(d.length===0)continue;d.sort(function(t,e){return t-e});p=[d[0]];for(var v=1;v<d.length;v++){if(d[v]!==d[v-1]){p.push(d[v])}}f[l]=p}return{components:c,adjacencyList:f}}},{}],492:[function(t,e,r){"use strict";e.exports=a;var n={" ":" ",0:"\u2070",1:"\xb9",2:"\xb2",3:"\xb3",4:"\u2074",5:"\u2075",6:"\u2076",7:"\u2077",8:"\u2078",9:"\u2079","+":"\u207a","-":"\u207b",a:"\u1d43",b:"\u1d47",c:"\u1d9c",d:"\u1d48",e:"\u1d49",f:"\u1da0",g:"\u1d4d",h:"\u02b0",i:"\u2071",j:"\u02b2",k:"\u1d4f",l:"\u02e1",m:"\u1d50",n:"\u207f",o:"\u1d52",p:"\u1d56",r:"\u02b3",s:"\u02e2",t:"\u1d57",u:"\u1d58",v:"\u1d5b",w:"\u02b7",x:"\u02e3",y:"\u02b8",z:"\u1dbb"};function a(t){return t.split("").map(function(t){if(t in n){return n[t]}return""}).join("")}},{}],493:[function(t,e,r){"use strict";e.exports=u;var n=t("ndarray-extract-contour");var a=t("triangulate-hypercube");var i=t("zero-crossings");function o(t,e){var r=t.length;var i=["'use strict';"];var o="surfaceNets"+t.join("_")+"d"+e;i.push("var contour=genContour({","order:[",t.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },");if(e==="generic"){i.push("getters:[0],")}var s=[];var l=[];for(var u=0;u<r;++u){s.push("d"+u);l.push("d"+u)}for(var u=0;u<1<<r;++u){s.push("v"+u);l.push("v"+u)}for(var u=0;u<1<<r;++u){s.push("p"+u);l.push("p"+u)}s.push("a","b","c");l.push("a","c");i.push("vertex:function vertexFunc(",s.join(),"){");var c=[];for(var u=0;u<1<<r;++u){c.push("(p"+u+"<<"+u+")")}i.push("var m=(",c.join("+"),")|0;if(m===0||m===",(1<<(1<<r))-1,"){return}");var f=[];var h=[];if(1<<(1<<r)<=128){i.push("switch(m){");h=i}else{i.push("switch(m>>>7){")}for(var u=0;u<1<<(1<<r);++u){if(1<<(1<<r)>128){if(u%128===0){if(f.length>0){h.push("}}")}var p="vExtra"+f.length;i.push("case ",u>>>7,":",p,"(m&0x7f,",l.join(),");break;");h=["function ",p,"(m,",l.join(),"){switch(m){"];f.push(h)}}h.push("case ",u&127,":");var d=new Array(r);var v=new Array(r);var g=new Array(r);var m=new Array(r);var y=0;for(var x=0;x<r;++x){d[x]=[];v[x]=[];g[x]=0;m[x]=0}for(var x=0;x<1<<r;++x){for(var b=0;b<r;++b){var _=x^1<<b;if(_>x){continue}if(!(u&1<<_)!==!(u&1<<x)){var w=1;if(u&1<<_){v[b].push("v"+_+"-v"+x)}else{v[b].push("v"+x+"-v"+_);w=-w}if(w<0){d[b].push("-v"+x+"-v"+_);g[b]+=2}else{d[b].push("v"+x+"+v"+_);g[b]-=2}y+=1;for(var k=0;k<r;++k){if(k===b){continue}if(_&1<<k){m[k]+=1}else{m[k]-=1}}}}}var M=[];for(var b=0;b<r;++b){if(d[b].length===0){M.push("d"+b+"-0.5")}else{var A="";if(g[b]<0){A=g[b]+"*c"}else if(g[b]>0){A="+"+g[b]+"*c"}var T=.5*(d[b].length/y);var S=.5+.5*(m[b]/y);M.push("d"+b+"-"+S+"-"+T+"*("+d[b].join("+")+A+")/("+v[b].join("+")+")")}}h.push("a.push([",M.join(),"]);","break;")}i.push("}},");if(f.length>0){h.push("}}")}var E=[];for(var u=0;u<1<<r-1;++u){E.push("v"+u)}E.push("c0","c1","p0","p1","a","b","c");i.push("cell:function cellFunc(",E.join(),"){");var C=a(r-1);i.push("if(p0){b.push(",C.map(function(t){return"["+t.map(function(t){return"v"+t})+"]"}).join(),")}else{b.push(",C.map(function(t){var e=t.slice();e.reverse();return"["+e.map(function(t){return"v"+t})+"]"}).join(),")}}});function ",o,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",o,";");for(var u=0;u<f.length;++u){i.push(f[u].join(""))}var L=new Function("genContour",i.join(""));return L(n)}function s(t,e){var r=i(t,e);var n=r.length;var a=new Array(n);var o=new Array(n);for(var s=0;s<n;++s){a[s]=[r[s]];o[s]=[s]}return{positions:a,cells:o}}var l={};function u(t,e){if(t.dimension<=0){return{positions:[],cells:[]}}else if(t.dimension===1){return s(t,e)}var r=t.order.join()+"-"+t.dtype;var n=l[r];var e=+e||0;if(!n){n=l[r]=o(t.order,t.dtype)}return n(t,e)}},{"ndarray-extract-contour":406,"triangulate-hypercube":503,"zero-crossings":539}],494:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n=function(){function t(t,e){var r=[];var n=true;var a=false;var i=undefined;try{for(var o=t[Symbol.iterator](),s;!(n=(s=o.next()).done);n=true){r.push(s.value);if(e&&r.length===e)break}}catch(t){a=true;i=t}finally{try{if(!n&&o["return"])o["return"]()}finally{if(a)throw i}}return r}return function(e,r){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var a=Math.PI*2;var i=function t(e,r,n,a,i,o,s){var l=e.x,u=e.y;l*=r;u*=n;var c=a*l-i*u;var f=i*l+a*u;return{x:c+o,y:f+s}};var o=function t(e,r){var n=4/3*Math.tan(r/4);var a=Math.cos(e);var i=Math.sin(e);var o=Math.cos(e+r);var s=Math.sin(e+r);return[{x:a-i*n,y:i+a*n},{x:o+s*n,y:s-o*n},{x:o,y:s}]};var s=function t(e,r,n,a){var i=e*a-r*n<0?-1:1;var o=Math.sqrt(e*e+r*r);var s=Math.sqrt(e*e+r*r);var l=e*n+r*a;var u=l/(o*s);if(u>1){u=1}if(u<-1){u=-1}return i*Math.acos(u)};var l=function t(e,r,n,i,o,l,u,c,f,h,p,d){var v=Math.pow(o,2);var g=Math.pow(l,2);var m=Math.pow(p,2);var y=Math.pow(d,2);var x=v*g-v*y-g*m;if(x<0){x=0}x/=v*y+g*m;x=Math.sqrt(x)*(u===c?-1:1);var b=x*o/l*d;var _=x*-l/o*p;var w=h*b-f*_+(e+n)/2;var k=f*b+h*_+(r+i)/2;var M=(p-b)/o;var A=(d-_)/l;var T=(-p-b)/o;var S=(-d-_)/l;var E=s(1,0,M,A);var C=s(M,A,T,S);if(c===0&&C>0){C-=a}if(c===1&&C<0){C+=a}return[w,k,E,C]};var u=function t(e){var r=e.px,s=e.py,u=e.cx,c=e.cy,f=e.rx,h=e.ry,p=e.xAxisRotation,d=p===undefined?0:p,v=e.largeArcFlag,g=v===undefined?0:v,m=e.sweepFlag,y=m===undefined?0:m;var x=[];if(f===0||h===0){return[]}var b=Math.sin(d*a/360);var _=Math.cos(d*a/360);var w=_*(r-u)/2+b*(s-c)/2;var k=-b*(r-u)/2+_*(s-c)/2;if(w===0&&k===0){return[]}f=Math.abs(f);h=Math.abs(h);var M=Math.pow(w,2)/Math.pow(f,2)+Math.pow(k,2)/Math.pow(h,2);if(M>1){f*=Math.sqrt(M);h*=Math.sqrt(M)}var A=l(r,s,u,c,f,h,g,y,b,_,w,k),T=n(A,4),S=T[0],E=T[1],C=T[2],L=T[3];var I=Math.max(Math.ceil(Math.abs(L)/(a/4)),1);L/=I;for(var z=0;z<I;z++){x.push(o(C,L));C+=L}return x.map(function(t){var e=i(t[0],f,h,_,b,S,E),r=e.x,n=e.y;var a=i(t[1],f,h,_,b,S,E),o=a.x,s=a.y;var l=i(t[2],f,h,_,b,S,E),u=l.x,c=l.y;return{x1:r,y1:n,x2:o,y2:s,x:u,y:c}})};r.default=u;e.exports=r["default"]},{}],495:[function(t,e,r){"use strict";var n=t("parse-svg-path");var a=t("abs-svg-path");var i=t("normalize-svg-path");var o=t("is-svg-path");var s=t("assert");e.exports=l;function l(t){if(Array.isArray(t)&&t.length===1&&typeof t[0]==="string")t=t[0];if(typeof t==="string"){s(o(t),"String is not an SVG path.");t=n(t)}s(Array.isArray(t),"Argument should be a string or an array of path segments.");t=a(t);t=i(t);if(!t.length)return[0,0,0,0];var e=[Infinity,Infinity,-Infinity,-Infinity];for(var r=0,l=t.length;r<l;r++){var u=t[r].slice(1);for(var c=0;c<u.length;c+=2){if(u[c+0]<e[0])e[0]=u[c+0];if(u[c+1]<e[1])e[1]=u[c+1];if(u[c+0]>e[2])e[2]=u[c+0];if(u[c+1]>e[3])e[3]=u[c+1]}}return e}},{"abs-svg-path":51,assert:59,"is-svg-path":391,"normalize-svg-path":496,"parse-svg-path":427}],496:[function(t,e,r){"use strict";e.exports=a;var n=t("svg-arc-to-cubic-bezier");function a(t){var e;var r=[];var a=0;var s=0;var l=0;var u=0;var c=null;var f=null;var h=0;var p=0;for(var d=0,v=t.length;d<v;d++){var g=t[d];var m=g[0];switch(m){case"M":l=g[1];u=g[2];break;case"A":var y=n({px:h,py:p,cx:g[6],cy:g[7],rx:g[1],ry:g[2],xAxisRotation:g[3],largeArcFlag:g[4],sweepFlag:g[5]});if(!y.length)continue;for(var x=0,b;x<y.length;x++){b=y[x];g=["C",b.x1,b.y1,b.x2,b.y2,b.x,b.y];if(x<y.length-1)r.push(g)}break;case"S":var _=h;var w=p;if(e=="C"||e=="S"){_+=_-a;w+=w-s}g=["C",_,w,g[1],g[2],g[3],g[4]];break;case"T":if(e=="Q"||e=="T"){c=h*2-c;f=p*2-f}else{c=h;f=p}g=o(h,p,c,f,g[1],g[2]);break;case"Q":c=g[1];f=g[2];g=o(h,p,g[1],g[2],g[3],g[4]);break;case"L":g=i(h,p,g[1],g[2]);break;case"H":g=i(h,p,g[1],p);break;case"V":g=i(h,p,h,g[1]);break;case"Z":g=i(h,p,l,u);break}e=m;h=g[g.length-2];p=g[g.length-1];if(g.length>4){a=g[g.length-4];s=g[g.length-3]}else{a=h;s=p}r.push(g)}return r}function i(t,e,r,n){return["C",t,e,r,n,r,n]}function o(t,e,r,n,a,i){return["C",t/3+2/3*r,e/3+2/3*n,a/3+2/3*r,i/3+2/3*n,a,i]}},{"svg-arc-to-cubic-bezier":494}],497:[function(t,e,r){(function(r){"use strict";var n=t("svg-path-bounds");var a=t("parse-svg-path");var i=t("draw-svg-path");var o=t("is-svg-path");var s=t("bitmap-sdf");var l=document.createElement("canvas");var u=l.getContext("2d");e.exports=c;function c(t,e){if(!o(t))throw Error("Argument should be valid svg path string");if(!e)e={};var c,f;if(e.shape){c=e.shape[0];f=e.shape[1]}else{c=l.width=e.w||e.width||200;f=l.height=e.h||e.height||200}var h=Math.min(c,f);var p=e.stroke||0;var d=e.viewbox||e.viewBox||n(t);var v=[c/(d[2]-d[0]),f/(d[3]-d[1])];var g=Math.min(v[0]||0,v[1]||0)/2;u.fillStyle="black";u.fillRect(0,0,c,f);u.fillStyle="white";if(p){if(typeof p!="number")p=1;if(p>0){u.strokeStyle="white"}else{u.strokeStyle="black"}u.lineWidth=Math.abs(p)}u.translate(c*.5,f*.5);u.scale(g,g);if(r.Path2D){var m=new Path2D(t);u.fill(m);p&&u.stroke(m)}else{var y=a(t);i(u,y);u.fill();p&&u.stroke()}u.setTransform(1,0,0,1,0,0);var x=s(u,{cutoff:e.cutoff!=null?e.cutoff:.5,radius:e.radius!=null?e.radius:h*.5});return x}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"bitmap-sdf":81,"draw-svg-path":152,"is-svg-path":391,"parse-svg-path":427,"svg-path-bounds":495}],498:[function(t,e,r){(function(r){"use strict";e.exports=s;var n=t("vectorize-text");var a=window||r.global||{};var i=a.__TEXT_CACHE||{};a.__TEXT_CACHE={};function o(t){var e=t.cells;var r=t.positions;var n=new Float32Array(e.length*6);var a=0;var i=0;for(var o=0;o<e.length;++o){var s=e[o];for(var l=0;l<3;++l){var u=r[s[l]];n[a++]=u[0];n[a++]=u[1]+1.4;i=Math.max(u[0],i)}}return{data:n,shape:i}}function s(t,e,r){var r=r||{};var a=i[t];if(!a){a=i[t]={" ":{data:new Float32Array(0),shape:.2}}}var l=a[e];if(!l){if(e.length<=1||!/\d/.test(e)){l=a[e]=o(n(e,{triangles:true,font:t,textAlign:r.textAlign||"left",textBaseline:"alphabetic"}))}else{var u=e.split(/(\d|\s)/);var c=new Array(u.length);var f=0;var h=0;for(var p=0;p<u.length;++p){c[p]=s(t,u[p]);f+=c[p].data.length;h+=c[p].shape;if(p>0){h+=.02}}var d=new Float32Array(f);var v=0;var g=-.5*h;for(var p=0;p<c.length;++p){var m=c[p].data;for(var y=0;y<m.length;y+=2){d[v++]=m[y]+g;d[v++]=m[y+1]}g+=c[p].shape+.02}l=a[e]={data:d,shape:h}}}return l}}).call(this,t("_process"))},{_process:449,"vectorize-text":515}],499:[function(e,r,n){(function(e){var n=/^\s+/,a=/\s+$/,i=0,o=e.round,s=e.min,l=e.max,u=e.random;function c(t,e){t=t?t:"";e=e||{};if(t instanceof c){return t}if(!(this instanceof c)){return new c(t,e)}var r=f(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=o(100*this._a)/100,this._format=e.format||r.format;this._gradientType=e.gradientType;if(this._r<1){this._r=o(this._r)}if(this._g<1){this._g=o(this._g)}if(this._b<1){this._b=o(this._b)}this._ok=r.ok;this._tc_id=i++}c.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},getLuminance:function(){var t=this.toRgb();var r,n,a,i,o,s;r=t.r/255;n=t.g/255;a=t.b/255;if(r<=.03928){i=r/12.92}else{i=e.pow((r+.055)/1.055,2.4)}if(n<=.03928){o=n/12.92}else{o=e.pow((n+.055)/1.055,2.4)}if(a<=.03928){s=a/12.92}else{s=e.pow((a+.055)/1.055,2.4)}return.2126*i+.7152*o+.0722*s},setAlpha:function(t){this._a=R(t);this._roundA=o(100*this._a)/100;return this},toHsv:function(){var t=v(this._r,this._g,this._b);return{h:t.h*360,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=v(this._r,this._g,this._b);var e=o(t.h*360),r=o(t.s*100),n=o(t.v*100);return this._a==1?"hsv("+e+", "+r+"%, "+n+"%)":"hsva("+e+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var t=p(this._r,this._g,this._b);return{h:t.h*360,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=p(this._r,this._g,this._b);var e=o(t.h*360),r=o(t.s*100),n=o(t.l*100);return this._a==1?"hsl("+e+", "+r+"%, "+n+"%)":"hsla("+e+", "+r+"%, "+n+"%, "+this._roundA+")"},toHex:function(t){return m(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return y(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(B(this._r,255)*100)+"%",g:o(B(this._g,255)*100)+"%",b:o(B(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+o(B(this._r,255)*100)+"%, "+o(B(this._g,255)*100)+"%, "+o(B(this._b,255)*100)+"%)":"rgba("+o(B(this._r,255)*100)+"%, "+o(B(this._g,255)*100)+"%, "+o(B(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){if(this._a===0){return"transparent"}if(this._a<1){return false}return O[m(this._r,this._g,this._b,true)]||false},toFilter:function(t){var e="#"+x(this._r,this._g,this._b,this._a);var r=e;var n=this._gradientType?"GradientType = 1, ":"";if(t){var a=c(t);r="#"+x(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+e+",endColorstr="+r+")"},toString:function(t){var e=!!t;t=t||this._format;var r=false;var n=this._a<1&&this._a>=0;var a=!e&&n&&(t==="hex"||t==="hex6"||t==="hex3"||t==="hex4"||t==="hex8"||t==="name");if(a){if(t==="name"&&this._a===0){return this.toName()}return this.toRgbString()}if(t==="rgb"){r=this.toRgbString()}if(t==="prgb"){r=this.toPercentageRgbString()}if(t==="hex"||t==="hex6"){r=this.toHexString()}if(t==="hex3"){r=this.toHexString(true)}if(t==="hex4"){r=this.toHex8String(true)}if(t==="hex8"){r=this.toHex8String()}if(t==="name"){r=this.toName()}if(t==="hsl"){r=this.toHslString()}if(t==="hsv"){r=this.toHsvString()}return r||this.toHexString()},clone:function(){return c(this.toString())},_applyModification:function(t,e){var r=t.apply(null,[this].concat([].slice.call(e)));this._r=r._r;this._g=r._g;this._b=r._b;this.setAlpha(r._a);return this},lighten:function(){return this._applyModification(k,arguments)},brighten:function(){return this._applyModification(M,arguments)},darken:function(){return this._applyModification(A,arguments)},desaturate:function(){return this._applyModification(b,arguments)},saturate:function(){return this._applyModification(_,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(T,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(I,arguments)},complement:function(){return this._applyCombination(S,arguments)},monochromatic:function(){return this._applyCombination(z,arguments)},splitcomplement:function(){return this._applyCombination(L,arguments)},triad:function(){return this._applyCombination(E,arguments)},tetrad:function(){return this._applyCombination(C,arguments)}};c.fromRatio=function(t,e){if(typeof t=="object"){var r={};for(var n in t){if(t.hasOwnProperty(n)){if(n==="a"){r[n]=t[n]}else{r[n]=q(t[n])}}}t=r}return c(t,e)};function f(t){var e={r:0,g:0,b:0};var r=1;var n=null;var a=null;var i=null;var o=false;var u=false;if(typeof t=="string"){t=X(t)}if(typeof t=="object"){if(Y(t.r)&&Y(t.g)&&Y(t.b)){e=h(t.r,t.g,t.b);o=true;u=String(t.r).substr(-1)==="%"?"prgb":"rgb"}else if(Y(t.h)&&Y(t.s)&&Y(t.v)){n=q(t.s);a=q(t.v);e=g(t.h,n,a);o=true;u="hsv"}else if(Y(t.h)&&Y(t.s)&&Y(t.l)){n=q(t.s);i=q(t.l);e=d(t.h,n,i);o=true;u="hsl"}if(t.hasOwnProperty("a")){r=t.a}}r=R(r);return{ok:o,format:t.format||u,r:s(255,l(e.r,0)),g:s(255,l(e.g,0)),b:s(255,l(e.b,0)),a:r}}function h(t,e,r){return{r:B(t,255)*255,g:B(e,255)*255,b:B(r,255)*255}}function p(t,e,r){t=B(t,255);e=B(e,255);r=B(r,255);var n=l(t,e,r),a=s(t,e,r);var i,o,u=(n+a)/2;if(n==a){i=o=0}else{var c=n-a;o=u>.5?c/(2-n-a):c/(n+a);switch(n){case t:i=(e-r)/c+(e<r?6:0);break;case e:i=(r-t)/c+2;break;case r:i=(t-e)/c+4;break}i/=6}return{h:i,s:o,l:u}}function d(t,e,r){var n,a,i;t=B(t,360);e=B(e,100);r=B(r,100);function o(t,e,r){if(r<0)r+=1;if(r>1)r-=1;if(r<1/6)return t+(e-t)*6*r;if(r<1/2)return e;if(r<2/3)return t+(e-t)*(2/3-r)*6;return t}if(e===0){n=a=i=r}else{var s=r<.5?r*(1+e):r+e-r*e;var l=2*r-s;n=o(l,s,t+1/3);a=o(l,s,t);i=o(l,s,t-1/3)}return{r:n*255,g:a*255,b:i*255}}function v(t,e,r){t=B(t,255);e=B(e,255);r=B(r,255);var n=l(t,e,r),a=s(t,e,r);var i,o,u=n;var c=n-a;o=n===0?0:c/n;if(n==a){i=0}else{switch(n){case t:i=(e-r)/c+(e<r?6:0);break;case e:i=(r-t)/c+2;break;case r:i=(t-e)/c+4;break}i/=6}return{h:i,s:o,v:u}}function g(t,r,n){t=B(t,360)*6;r=B(r,100);n=B(n,100);var a=e.floor(t),i=t-a,o=n*(1-r),s=n*(1-i*r),l=n*(1-(1-i)*r),u=a%6,c=[n,s,o,o,l,n][u],f=[l,n,n,s,o,o][u],h=[o,o,l,n,n,s][u];return{r:c*255,g:f*255,b:h*255}}function m(t,e,r,n){var a=[U(o(t).toString(16)),U(o(e).toString(16)),U(o(r).toString(16))];if(n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)){return a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)}return a.join("")}function y(t,e,r,n,a){var i=[U(o(t).toString(16)),U(o(e).toString(16)),U(o(r).toString(16)),U(H(n))];if(a&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)&&i[3].charAt(0)==i[3].charAt(1)){return i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)+i[3].charAt(0)}return i.join("")}function x(t,e,r,n){var a=[U(H(n)),U(o(t).toString(16)),U(o(e).toString(16)),U(o(r).toString(16))];return a.join("")}c.equals=function(t,e){if(!t||!e){return false}return c(t).toRgbString()==c(e).toRgbString()};c.random=function(){return c.fromRatio({r:u(),g:u(),b:u()})};function b(t,e){e=e===0?0:e||10;var r=c(t).toHsl();r.s-=e/100;r.s=F(r.s);return c(r)}function _(t,e){e=e===0?0:e||10;var r=c(t).toHsl();r.s+=e/100;r.s=F(r.s);return c(r)}function w(t){return c(t).desaturate(100)}function k(t,e){e=e===0?0:e||10;var r=c(t).toHsl();r.l+=e/100;r.l=F(r.l);return c(r)}function M(t,e){e=e===0?0:e||10;var r=c(t).toRgb();r.r=l(0,s(255,r.r-o(255*-(e/100))));r.g=l(0,s(255,r.g-o(255*-(e/100))));r.b=l(0,s(255,r.b-o(255*-(e/100))));return c(r)}function A(t,e){e=e===0?0:e||10;var r=c(t).toHsl();r.l-=e/100;r.l=F(r.l);return c(r)}function T(t,e){var r=c(t).toHsl();var n=(r.h+e)%360;r.h=n<0?360+n:n;return c(r)}function S(t){var e=c(t).toHsl();e.h=(e.h+180)%360;return c(e)}function E(t){var e=c(t).toHsl();var r=e.h;return[c(t),c({h:(r+120)%360,s:e.s,l:e.l}),c({h:(r+240)%360,s:e.s,l:e.l})]}function C(t){var e=c(t).toHsl();var r=e.h;return[c(t),c({h:(r+90)%360,s:e.s,l:e.l}),c({h:(r+180)%360,s:e.s,l:e.l}),c({h:(r+270)%360,s:e.s,l:e.l})]}function L(t){var e=c(t).toHsl();var r=e.h;return[c(t),c({h:(r+72)%360,s:e.s,l:e.l}),c({h:(r+216)%360,s:e.s,l:e.l})]}function I(t,e,r){e=e||6;r=r||30;var n=c(t).toHsl();var a=360/r;var i=[c(t)];for(n.h=(n.h-(a*e>>1)+720)%360;--e;){n.h=(n.h+a)%360;i.push(c(n))}return i}function z(t,e){e=e||6;var r=c(t).toHsv();var n=r.h,a=r.s,i=r.v;var o=[];var s=1/e;while(e--){o.push(c({h:n,s:a,v:i}));i=(i+s)%1}return o}c.mix=function(t,e,r){r=r===0?0:r||50;var n=c(t).toRgb();var a=c(e).toRgb();var i=r/100;var o={r:(a.r-n.r)*i+n.r,g:(a.g-n.g)*i+n.g,b:(a.b-n.b)*i+n.b,a:(a.a-n.a)*i+n.a};return c(o)};c.readability=function(t,r){var n=c(t);var a=c(r);return(e.max(n.getLuminance(),a.getLuminance())+.05)/(e.min(n.getLuminance(),a.getLuminance())+.05)};c.isReadable=function(t,e,r){var n=c.readability(t,e);var a,i;i=false;a=Z(r);switch(a.level+a.size){case"AAsmall":case"AAAlarge":i=n>=4.5;break;case"AAlarge":i=n>=3;break;case"AAAsmall":i=n>=7;break}return i};c.mostReadable=function(t,e,r){var n=null;var a=0;var i;var o,s,l;r=r||{};o=r.includeFallbackColors;s=r.level;l=r.size;for(var u=0;u<e.length;u++){i=c.readability(t,e[u]);if(i>a){a=i;n=c(e[u])}}if(c.isReadable(t,n,{level:s,size:l})||!o){return n}else{r.includeFallbackColors=false;return c.mostReadable(t,["#fff","#000"],r)}};var P=c.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var O=c.hexNames=D(P);function D(t){var e={};for(var r in t){if(t.hasOwnProperty(r)){e[t[r]]=r}}return e}function R(t){t=parseFloat(t);if(isNaN(t)||t<0||t>1){t=1}return t}function B(t,r){if(j(t)){t="100%"}var n=V(t);t=s(r,l(0,parseFloat(t)));if(n){t=parseInt(t*r,10)/100}if(e.abs(t-r)<1e-6){return 1}return t%r/parseFloat(r)}function F(t){return s(1,l(0,t))}function N(t){return parseInt(t,16)}function j(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function V(t){return typeof t==="string"&&t.indexOf("%")!=-1}function U(t){return t.length==1?"0"+t:""+t}function q(t){if(t<=1){t=t*100+"%"}return t}function H(t){return e.round(parseFloat(t)*255).toString(16)}function G(t){return N(t)/255}var W=function(){var t="[-\\+]?\\d+%?";var e="[-\\+]?\\d*\\.\\d+%?";var r="(?:"+e+")|(?:"+t+")";var n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";var a="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+a),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Y(t){return!!W.CSS_UNIT.exec(t)}function X(t){t=t.replace(n,"").replace(a,"").toLowerCase();var e=false;if(P[t]){t=P[t];e=true}else if(t=="transparent"){return{r:0,g:0,b:0,a:0,format:"name"}}var r;if(r=W.rgb.exec(t)){return{r:r[1],g:r[2],b:r[3]}}if(r=W.rgba.exec(t)){return{r:r[1],g:r[2],b:r[3],a:r[4]}}if(r=W.hsl.exec(t)){return{h:r[1],s:r[2],l:r[3]}}if(r=W.hsla.exec(t)){return{h:r[1],s:r[2],l:r[3],a:r[4]}}if(r=W.hsv.exec(t)){return{h:r[1],s:r[2],v:r[3]}}if(r=W.hsva.exec(t)){return{h:r[1],s:r[2],v:r[3],a:r[4]}}if(r=W.hex8.exec(t)){return{r:N(r[1]),g:N(r[2]),b:N(r[3]),a:G(r[4]),format:e?"name":"hex8"}}if(r=W.hex6.exec(t)){return{r:N(r[1]),g:N(r[2]),b:N(r[3]),format:e?"name":"hex"}}if(r=W.hex4.exec(t)){return{r:N(r[1]+""+r[1]),g:N(r[2]+""+r[2]),b:N(r[3]+""+r[3]),a:G(r[4]+""+r[4]),format:e?"name":"hex8"}}if(r=W.hex3.exec(t)){return{r:N(r[1]+""+r[1]),g:N(r[2]+""+r[2]),b:N(r[3]+""+r[3]),format:e?"name":"hex"}}return false}function Z(t){var e,r;t=t||{level:"AA",size:"small"};e=(t.level||"AA").toUpperCase();r=(t.size||"small").toLowerCase();if(e!=="AA"&&e!=="AAA"){e="AA"}if(r!=="small"&&r!=="large"){r="small"}return{level:e,size:r}}if(typeof r!=="undefined"&&r.exports){r.exports=c}else if(typeof t==="function"&&t.amd){t(function(){return c})}else{window.tinycolor=c}})(Math)},{}],500:[function(t,e,r){"use strict";e.exports=a;e.exports.float32=e.exports.float=a;e.exports.fract32=e.exports.fract=n;function n(t){if(typeof t==="number"){return a(t-a(t))}var e=a(t);for(var r=0,n=e.length;r<n;r++){e[r]=t[r]-e[r]}return e}function a(t){if(t instanceof Float32Array)return t;if(typeof t==="number"){return new Float32Array([t])[0]}var e=new Float32Array(t);e.set(t);return e}},{}],501:[function(t,e,r){"use strict";var n=t("parse-unit");e.exports=s;var a=96;function i(t,e){var r=n(getComputedStyle(t).getPropertyValue(e));return r[0]*s(r[1],t)}function o(t,e){var r=document.createElement("div");r.style["font-size"]="128"+t;e.appendChild(r);var n=i(r,"font-size")/128;e.removeChild(r);return n}function s(t,e){e=e||document.body;t=(t||"px").trim().toLowerCase();if(e===window||e===document){e=document.body}switch(t){case"%":return e.clientHeight/100;case"ch":case"ex":return o(t,e);case"em":return i(e,"font-size");case"rem":return i(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return a;case"cm":return a/2.54;case"mm":return a/25.4;case"pt":return a/72;case"pc":return a/6}return 1}},{"parse-unit":428}],502:[function(e,r,n){(function(e,a){typeof n==="object"&&typeof r!=="undefined"?a(n):typeof t==="function"&&t.amd?t(["exports"],a):a(e.topojson=e.topojson||{})})(this,function(t){"use strict";var e=function(t){return t};var r=function(t){if((r=t.transform)==null)return e;var r,n,a,i=r.scale[0],o=r.scale[1],s=r.translate[0],l=r.translate[1];return function(t,e){if(!e)n=a=0;t[0]=(n+=t[0])*i+s;t[1]=(a+=t[1])*o+l;return t}};var n=function(t){var e=t.bbox;function n(t){s[0]=t[0],s[1]=t[1],i(s);if(s[0]<u)u=s[0];if(s[0]>f)f=s[0];if(s[1]<c)c=s[1];if(s[1]>h)h=s[1]}function a(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(a);break;case"Point":n(t.coordinates);break;case"MultiPoint":t.coordinates.forEach(n);break}}if(!e){var i=r(t),o,s=new Array(2),l,u=Infinity,c=u,f=-u,h=-u;t.arcs.forEach(function(t){var e=-1,r=t.length;while(++e<r){o=t[e],s[0]=o[0],s[1]=o[1],i(s,e);if(s[0]<u)u=s[0];if(s[0]>f)f=s[0];if(s[1]<c)c=s[1];if(s[1]>h)h=s[1]}});for(l in t.objects){a(t.objects[l])}e=t.bbox=[u,c,f,h]}return e};var a=function(t,e){var r,n=t.length,a=n-e;while(a<--n)r=t[a],t[a++]=t[n],t[n]=r};var i=function(t,e){return e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(e){return o(t,e)})}:o(t,e)};function o(t,e){var r=e.id,n=e.bbox,a=e.properties==null?{}:e.properties,i=s(t,e);return r==null&&n==null?{type:"Feature",properties:a,geometry:i}:n==null?{type:"Feature",id:r,properties:a,geometry:i}:{type:"Feature",id:r,bbox:n,properties:a,geometry:i}}function s(t,e){var n=r(t),i=t.arcs;function o(t,e){if(e.length)e.pop();for(var r=i[t<0?~t:t],o=0,s=r.length;o<s;++o){e.push(n(r[o].slice(),o))}if(t<0)a(e,s)}function s(t){return n(t.slice())}function l(t){var e=[];for(var r=0,n=t.length;r<n;++r)o(t[r],e);if(e.length<2)e.push(e[0].slice());return e}function u(t){var e=l(t);while(e.length<4)e.push(e[0].slice());return e}function c(t){return t.map(u)}function f(t){var e=t.type,r;switch(e){case"GeometryCollection":return{type:e,geometries:t.geometries.map(f)};case"Point":r=s(t.coordinates);break;case"MultiPoint":r=t.coordinates.map(s);break;case"LineString":r=l(t.arcs);break;case"MultiLineString":r=t.arcs.map(l);break;case"Polygon":r=c(t.arcs);break;case"MultiPolygon":r=t.arcs.map(c);break;default:return null}return{type:e,coordinates:r}}return f(e)}var l=function(t,e){var r={},n={},a={},i=[],o=-1;e.forEach(function(r,n){var a=t.arcs[r<0?~r:r],i;if(a.length<3&&!a[1][0]&&!a[1][1]){i=e[++o],e[o]=r,e[n]=i}});e.forEach(function(t){var e=s(t),r=e[0],i=e[1],o,l;if(o=a[r]){delete a[o.end];o.push(t);o.end=i;if(l=n[i]){delete n[l.start];var u=l===o?o:o.concat(l);n[u.start=o.start]=a[u.end=l.end]=u}else{n[o.start]=a[o.end]=o}}else if(o=n[i]){delete n[o.start];o.unshift(t);o.start=r;if(l=a[r]){delete a[l.end];var c=l===o?o:l.concat(o);n[c.start=l.start]=a[c.end=o.end]=c}else{n[o.start]=a[o.end]=o}}else{o=[t];n[o.start=r]=a[o.end=i]=o}});function s(e){var r=t.arcs[e<0?~e:e],n=r[0],a;if(t.transform)a=[0,0],r.forEach(function(t){a[0]+=t[0],a[1]+=t[1]});else a=r[r.length-1];return e<0?[a,n]:[n,a]}function l(t,e){for(var n in t){var a=t[n];delete e[a.start];delete a.start;delete a.end;a.forEach(function(t){r[t<0?~t:t]=1});i.push(a)}}l(a,n);l(n,a);e.forEach(function(t){if(!r[t<0?~t:t])i.push([t])});return i};var u=function(t){return s(t,c.apply(this,arguments))};function c(t,e,r){var n,a,i;if(arguments.length>1)n=f(t,e,r);else for(a=0,n=new Array(i=t.arcs.length);a<i;++a)n[a]=a;return{type:"MultiLineString",arcs:l(t,n)}}function f(t,e,r){var n=[],a=[],i;function o(t){var e=t<0?~t:t;(a[e]||(a[e]=[])).push({i:t,g:i})}function s(t){t.forEach(o)}function l(t){t.forEach(s)}function u(t){t.forEach(l)}function c(t){switch(i=t,t.type){case"GeometryCollection":t.geometries.forEach(c);break;case"LineString":s(t.arcs);break;case"MultiLineString":case"Polygon":l(t.arcs);break;case"MultiPolygon":u(t.arcs);break}}c(e);a.forEach(r==null?function(t){n.push(t[0].i)}:function(t){if(r(t[0].g,t[t.length-1].g))n.push(t[0].i)});return n}function h(t){var e=-1,r=t.length,n,a=t[r-1],i=0;while(++e<r)n=a,a=t[e],i+=n[0]*a[1]-n[1]*a[0];return Math.abs(i)}var p=function(t){return s(t,d.apply(this,arguments))};function d(t,e){var r={},n=[],a=[];e.forEach(i);function i(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(i);break;case"Polygon":o(t.arcs);break;case"MultiPolygon":t.arcs.forEach(o);break}}function o(t){t.forEach(function(e){e.forEach(function(e){(r[e=e<0?~e:e]||(r[e]=[])).push(t)})});n.push(t)}function u(e){return h(s(t,{type:"Polygon",arcs:[e]}).coordinates[0])}n.forEach(function(t){if(!t._){var e=[],n=[t];t._=1;a.push(e);while(t=n.pop()){e.push(t);t.forEach(function(t){t.forEach(function(t){r[t<0?~t:t].forEach(function(t){if(!t._){t._=1;n.push(t)}})})})}}});n.forEach(function(t){delete t._});return{type:"MultiPolygon",arcs:a.map(function(e){var n=[],a;e.forEach(function(t){t.forEach(function(t){t.forEach(function(t){if(r[t<0?~t:t].length<2){n.push(t)}})})});n=l(t,n);if((a=n.length)>1){for(var i=1,o=u(n[0]),s,c;i<a;++i){if((s=u(n[i]))>o){c=n[0],n[0]=n[i],n[i]=c,o=s}}}return n})}}var v=function(t,e){var r=0,n=t.length;while(r<n){var a=r+n>>>1;if(t[a]<e)r=a+1;else n=a}return r};var g=function(t){var e={},r=t.map(function(){return[]});function n(t,r){t.forEach(function(t){if(t<0)t=~t;var n=e[t];if(n)n.push(r);else e[t]=[r]})}function a(t,e){t.forEach(function(t){n(t,e)})}function i(t,e){if(t.type==="GeometryCollection")t.geometries.forEach(function(t){i(t,e)});else if(t.type in o)o[t.type](t.arcs,e)}var o={LineString:n,MultiLineString:a,Polygon:a,MultiPolygon:function(t,e){t.forEach(function(t){a(t,e)})}};t.forEach(i);for(var s in e){for(var l=e[s],u=l.length,c=0;c<u;++c){for(var f=c+1;f<u;++f){var h=l[c],p=l[f],d;if((d=r[h])[s=v(d,p)]!==p)d.splice(s,0,p);if((d=r[p])[s=v(d,h)]!==h)d.splice(s,0,h)}}}return r};var m=function(t,e){if(!((e=Math.floor(e))>=2))throw new Error("n must be \u22652");if(t.transform)throw new Error("already quantized");var r=n(t),a,i=r[0],o=(r[2]-i)/(e-1)||1,s=r[1],l=(r[3]-s)/(e-1)||1;function u(t){t[0]=Math.round((t[0]-i)/o);t[1]=Math.round((t[1]-s)/l)}function c(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(c);break;case"Point":u(t.coordinates);break;case"MultiPoint":t.coordinates.forEach(u);break}}t.arcs.forEach(function(t){var e=1,r=1,n=t.length,a=t[0],u=a[0]=Math.round((a[0]-i)/o),c=a[1]=Math.round((a[1]-s)/l),f,h,p;for(;e<n;++e){a=t[e];h=Math.round((a[0]-i)/o);p=Math.round((a[1]-s)/l);if(h!==u||p!==c){f=t[r++];f[0]=h-u,u=h;f[1]=p-c,c=p}}if(r<2){f=t[r++];f[0]=0;f[1]=0}t.length=r});for(a in t.objects){c(t.objects[a])}t.transform={scale:[o,l],translate:[i,s]};return t};var y=function(t){if((r=t.transform)==null)return e;var r,n,a,i=r.scale[0],o=r.scale[1],s=r.translate[0],l=r.translate[1];return function(t,e){if(!e)n=a=0;var r=Math.round((t[0]-s)/i),u=Math.round((t[1]-l)/o);t[0]=r-n,n=r;t[1]=u-a,a=u;return t}};t.bbox=n;t.feature=i;t.mesh=u;t.meshArcs=c;t.merge=p;t.mergeArcs=d;t.neighbors=g;t.quantize=m;t.transform=r;t.untransform=y;Object.defineProperty(t,"__esModule",{value:true})})},{}],503:[function(t,e,r){"use strict";e.exports=o;var n=t("permutation-rank");var a=t("permutation-parity");var i=t("gamma");function o(t){if(t<0){return[]}if(t===0){return[[0]]}var e=Math.round(i(t+1))|0;var r=[];for(var o=0;o<e;++o){var s=n.unrank(t,o);var l=[0];var u=0;for(var c=0;c<s.length;++c){u+=1<<s[c];l.push(u)}if(a(s)<1){l[0]=u;l[t]=0}r.push(l)}return r}},{gamma:220,"permutation-parity":430,"permutation-rank":431}],504:[function(t,e,r){"use strict";e.exports=v;var n=t("filtered-vector");var a=t("gl-mat4/invert");var i=t("gl-mat4/rotate");var o=t("gl-vec3/cross");var s=t("gl-vec3/normalize");var l=t("gl-vec3/dot");function u(t,e,r){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2)+Math.pow(r,2))}function c(t){return Math.min(1,Math.max(-1,t))}function f(t){var e=Math.abs(t[0]);var r=Math.abs(t[1]);var n=Math.abs(t[2]);var a=[0,0,0];if(e>Math.max(r,n)){a[2]=1}else if(r>Math.max(e,n)){a[0]=1}else{a[1]=1}var i=0;var o=0;for(var l=0;l<3;++l){i+=t[l]*t[l];o+=a[l]*t[l]}for(var l=0;l<3;++l){a[l]-=o/i*t[l]}s(a,a);return a}function h(t,e,r,a,i,o,s,l){this.center=n(r);this.up=n(a);this.right=n(i);this.radius=n([o]);this.angle=n([s,l]);this.angle.bounds=[[-Infinity,-Math.PI/2],[Infinity,Math.PI/2]];this.setDistanceLimits(t,e);this.computedCenter=this.center.curve(0);this.computedUp=this.up.curve(0);this.computedRight=this.right.curve(0);this.computedRadius=this.radius.curve(0);this.computedAngle=this.angle.curve(0);this.computedToward=[0,0,0];this.computedEye=[0,0,0];this.computedMatrix=new Array(16);for(var u=0;u<16;++u){this.computedMatrix[u]=.5}this.recalcMatrix(0)}var p=h.prototype;p.setDistanceLimits=function(t,e){if(t>0){t=Math.log(t)}else{t=-Infinity}if(e>0){e=Math.log(e)}else{e=Infinity}e=Math.max(e,t);this.radius.bounds[0][0]=t;this.radius.bounds[1][0]=e};p.getDistanceLimits=function(t){var e=this.radius.bounds[0];if(t){t[0]=Math.exp(e[0][0]);t[1]=Math.exp(e[1][0]);return t}return[Math.exp(e[0][0]),Math.exp(e[1][0])]};p.recalcMatrix=function(t){this.center.curve(t);this.up.curve(t);this.right.curve(t);this.radius.curve(t);this.angle.curve(t);var e=this.computedUp;var r=this.computedRight;var n=0;var a=0;for(var i=0;i<3;++i){a+=e[i]*r[i];n+=e[i]*e[i]}var l=Math.sqrt(n);var c=0;for(var i=0;i<3;++i){r[i]-=e[i]*a/n;c+=r[i]*r[i];e[i]/=l}var f=Math.sqrt(c);for(var i=0;i<3;++i){r[i]/=f}var h=this.computedToward;o(h,e,r);s(h,h);var p=Math.exp(this.computedRadius[0]);var d=this.computedAngle[0];var v=this.computedAngle[1];var g=Math.cos(d);var m=Math.sin(d);var y=Math.cos(v);var x=Math.sin(v);var b=this.computedCenter;var _=g*y;var w=m*y;var k=x;var M=-g*x;var A=-m*x;var T=y;var S=this.computedEye;var E=this.computedMatrix;for(var i=0;i<3;++i){var C=_*r[i]+w*h[i]+k*e[i];E[4*i+1]=M*r[i]+A*h[i]+T*e[i];E[4*i+2]=C;E[4*i+3]=0}var L=E[1];var I=E[5];var z=E[9];var P=E[2];var O=E[6];var D=E[10];var R=I*D-z*O;var B=z*P-L*D;var F=L*O-I*P;var N=u(R,B,F);R/=N;B/=N;F/=N;E[0]=R;E[4]=B;E[8]=F;for(var i=0;i<3;++i){S[i]=b[i]+E[2+4*i]*p}for(var i=0;i<3;++i){var c=0;for(var j=0;j<3;++j){c+=E[i+4*j]*S[j]}E[12+i]=-c}E[15]=1};p.getMatrix=function(t,e){this.recalcMatrix(t);var r=this.computedMatrix;if(e){for(var n=0;n<16;++n){e[n]=r[n]}return e}return r};var d=[0,0,0];p.rotate=function(t,e,r,n){this.angle.move(t,e,r);if(n){this.recalcMatrix(t);var a=this.computedMatrix;d[0]=a[2];d[1]=a[6];d[2]=a[10];var o=this.computedUp;var s=this.computedRight;var l=this.computedToward;for(var u=0;u<3;++u){a[4*u]=o[u];a[4*u+1]=s[u];a[4*u+2]=l[u]}i(a,a,n,d);for(var u=0;u<3;++u){o[u]=a[4*u];s[u]=a[4*u+1]}this.up.set(t,o[0],o[1],o[2]);this.right.set(t,s[0],s[1],s[2])}};p.pan=function(t,e,r,n){e=e||0;r=r||0;n=n||0;this.recalcMatrix(t);var a=this.computedMatrix;var i=Math.exp(this.computedRadius[0]);var o=a[1];var s=a[5];var l=a[9];var c=u(o,s,l);o/=c;s/=c;l/=c;var f=a[0];var h=a[4];var p=a[8];var d=f*o+h*s+p*l;f-=o*d;h-=s*d;p-=l*d;var v=u(f,h,p);f/=v;h/=v;p/=v;var g=f*e+o*r;var m=h*e+s*r;var y=p*e+l*r;this.center.move(t,g,m,y);var x=Math.exp(this.computedRadius[0]);x=Math.max(1e-4,x+n);this.radius.set(t,Math.log(x))};p.translate=function(t,e,r,n){this.center.move(t,e||0,r||0,n||0)};p.setMatrix=function(t,e,r,n){var i=1;if(typeof r==="number"){i=r|0}if(i<0||i>3){i=1}var o=(i+2)%3;var s=(i+1)%3;if(!e){this.recalcMatrix(t);e=this.computedMatrix}var l=e[i];var f=e[i+4];var h=e[i+8];if(!n){var p=u(l,f,h);l/=p;f/=p;h/=p}else{var d=Math.abs(l);var v=Math.abs(f);var g=Math.abs(h);var m=Math.max(d,v,g);if(d===m){l=l<0?-1:1;f=h=0}else if(g===m){h=h<0?-1:1;l=f=0}else{f=f<0?-1:1;l=h=0}}var y=e[o];var x=e[o+4];var b=e[o+8];var _=y*l+x*f+b*h;y-=l*_;x-=f*_;b-=h*_;var w=u(y,x,b);y/=w;x/=w;b/=w;var k=f*b-h*x;var M=h*y-l*b;var A=l*x-f*y;var T=u(k,M,A);k/=T;M/=T;A/=T;this.center.jump(t,G,W,Y);this.radius.idle(t);this.up.jump(t,l,f,h);this.right.jump(t,y,x,b);var S,E;if(i===2){var C=e[1];var L=e[5];var I=e[9];var z=C*y+L*x+I*b;var P=C*k+L*M+I*A;if(B<0){S=-Math.PI/2}else{S=Math.PI/2}E=Math.atan2(P,z)}else{var O=e[2];var D=e[6];var R=e[10];var B=O*l+D*f+R*h;var F=O*y+D*x+R*b;var N=O*k+D*M+R*A;S=Math.asin(c(B));E=Math.atan2(N,F)}this.angle.jump(t,E,S);this.recalcMatrix(t);var j=e[2];var V=e[6];var U=e[10];var q=this.computedMatrix;a(q,e);var H=q[15];var G=q[12]/H;var W=q[13]/H;var Y=q[14]/H;var X=Math.exp(this.computedRadius[0]);this.center.jump(t,G-j*X,W-V*X,Y-U*X)};p.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())};p.idle=function(t){this.center.idle(t);this.up.idle(t);this.right.idle(t);this.radius.idle(t);this.angle.idle(t)};p.flush=function(t){this.center.flush(t);this.up.flush(t);this.right.flush(t);this.radius.flush(t);this.angle.flush(t)};p.setDistance=function(t,e){if(e>0){this.radius.set(t,Math.log(e))}};p.lookAt=function(t,e,r,n){this.recalcMatrix(t);e=e||this.computedEye;r=r||this.computedCenter;n=n||this.computedUp;var a=n[0];var i=n[1];var o=n[2];var s=u(a,i,o);if(s<1e-6){return}a/=s;i/=s;o/=s;var l=e[0]-r[0];var f=e[1]-r[1];var h=e[2]-r[2];var p=u(l,f,h);if(p<1e-6){return}l/=p;f/=p;h/=p;var d=this.computedRight;var v=d[0];var g=d[1];var m=d[2];var y=a*v+i*g+o*m;v-=y*a;g-=y*i;m-=y*o;var x=u(v,g,m);if(x<.01){v=i*h-o*f;g=o*l-a*h;m=a*f-i*l;x=u(v,g,m);if(x<1e-6){return}}v/=x;g/=x;m/=x;this.up.set(t,a,i,o);this.right.set(t,v,g,m);this.center.set(t,r[0],r[1],r[2]);this.radius.set(t,Math.log(p));var b=i*m-o*g;var _=o*v-a*m;var w=a*g-i*v;var k=u(b,_,w);b/=k;_/=k;w/=k;var M=a*l+i*f+o*h;var A=v*l+g*f+m*h;var T=b*l+_*f+w*h;var S=Math.asin(c(M));var E=Math.atan2(T,A);var C=this.angle._state;var L=C[C.length-1];var I=C[C.length-2];L=L%(2*Math.PI);var z=Math.abs(L+2*Math.PI-E);var P=Math.abs(L-E);var O=Math.abs(L-2*Math.PI-E);if(z<P){L+=2*Math.PI}if(O<P){L-=2*Math.PI}this.angle.jump(this.angle.lastT(),L,I);this.angle.set(t,E,S)};function v(t){t=t||{};var e=t.center||[0,0,0];var r=t.up||[0,1,0];var n=t.right||f(r);var a=t.radius||1;var i=t.theta||0;var c=t.phi||0;e=[].slice.call(e,0,3);r=[].slice.call(r,0,3);s(r,r);n=[].slice.call(n,0,3);s(n,n);if("eye"in t){var p=t.eye;var d=[p[0]-e[0],p[1]-e[1],p[2]-e[2]];o(n,d,r);if(u(n[0],n[1],n[2])<1e-6){n=f(r)}else{s(n,n)}a=u(d[0],d[1],d[2]);var v=l(r,d)/a;var g=l(n,d)/a;c=Math.acos(v);i=Math.acos(g)}a=Math.log(a);return new h(t.zoomMin,t.zoomMax,e,r,n,a,i,c)}},{"filtered-vector":215,"gl-mat4/invert":254,"gl-mat4/rotate":258,"gl-vec3/cross":314,"gl-vec3/dot":317,"gl-vec3/normalize":328}],505:[function(t,e,r){"use strict";e.exports=a;var n=+(Math.pow(2,27)+1);function a(t,e,r){var a=t*e;var i=n*t;var o=i-t;var s=i-o;var l=t-s;var u=n*e;var c=u-e;var f=u-c;var h=e-f;var p=a-s*f;var d=p-l*f;var v=d-s*h;var g=l*h-v;if(r){r[0]=g;r[1]=a;return r}return[g,a]}},{}],506:[function(t,e,r){"use strict";e.exports=n;function n(t,e,r){var n=t+e;var a=n-t;var i=n-a;var o=e-a;var s=t-i;if(r){r[0]=s+o;r[1]=n;return r}return[s+o,n]}},{}],507:[function(t,e,r){(function(e,n){"use strict";var a=t("bit-twiddle");var i=t("dup");if(!e.__TYPEDARRAY_POOL){e.__TYPEDARRAY_POOL={UINT8:i([32,0]),UINT16:i([32,0]),UINT32:i([32,0]),INT8:i([32,0]),INT16:i([32,0]),INT32:i([32,0]),FLOAT:i([32,0]),DOUBLE:i([32,0]),DATA:i([32,0]),UINT8C:i([32,0]),BUFFER:i([32,0])}}var o=typeof Uint8ClampedArray!=="undefined";var s=e.__TYPEDARRAY_POOL;if(!s.UINT8C){s.UINT8C=i([32,0])}if(!s.BUFFER){s.BUFFER=i([32,0])}var l=s.DATA,u=s.BUFFER;r.free=function t(e){if(n.isBuffer(e)){u[a.log2(e.length)].push(e)}else{if(Object.prototype.toString.call(e)!=="[object ArrayBuffer]"){e=e.buffer}if(!e){return}var r=e.length||e.byteLength;var i=a.log2(r)|0;l[i].push(e)}};function c(t){if(!t){return}var e=t.length||t.byteLength;var r=a.log2(e);l[r].push(t)}function f(t){c(t.buffer)}r.freeUint8=r.freeUint16=r.freeUint32=r.freeInt8=r.freeInt16=r.freeInt32=r.freeFloat32=r.freeFloat=r.freeFloat64=r.freeDouble=r.freeUint8Clamped=r.freeDataView=f;r.freeArrayBuffer=c;r.freeBuffer=function t(e){u[a.log2(e.length)].push(e)};r.malloc=function t(e,r){if(r===undefined||r==="arraybuffer"){return h(e)}else{switch(r){case"uint8":return p(e);case"uint16":return d(e);case"uint32":return v(e);case"int8":return g(e);case"int16":return m(e);case"int32":return y(e);case"float":case"float32":return x(e);case"double":case"float64":return b(e);case"uint8_clamped":return _(e);case"buffer":return k(e);case"data":case"dataview":return w(e);default:return null}}return null};function h(t){var t=a.nextPow2(t);var e=a.log2(t);var r=l[e];if(r.length>0){return r.pop()}return new ArrayBuffer(t)}r.mallocArrayBuffer=h;function p(t){return new Uint8Array(h(t),0,t)}r.mallocUint8=p;function d(t){return new Uint16Array(h(2*t),0,t)}r.mallocUint16=d;function v(t){return new Uint32Array(h(4*t),0,t)}r.mallocUint32=v;function g(t){return new Int8Array(h(t),0,t)}r.mallocInt8=g;function m(t){return new Int16Array(h(2*t),0,t)}r.mallocInt16=m;function y(t){return new Int32Array(h(4*t),0,t)}r.mallocInt32=y;function x(t){return new Float32Array(h(4*t),0,t)}r.mallocFloat32=r.mallocFloat=x;function b(t){return new Float64Array(h(8*t),0,t)}r.mallocFloat64=r.mallocDouble=b;function _(t){if(o){return new Uint8ClampedArray(h(t),0,t)}else{return p(t)}}r.mallocUint8Clamped=_;function w(t){return new DataView(h(t),0,t)}r.mallocDataView=w;function k(t){t=a.nextPow2(t);var e=a.log2(t);var r=u[e];if(r.length>0){return r.pop()}return new n(t)}r.mallocBuffer=k;r.clearCache=function t(){for(var e=0;e<32;++e){s.UINT8[e].length=0;s.UINT16[e].length=0;s.UINT32[e].length=0;s.INT8[e].length=0;s.INT16[e].length=0;s.INT32[e].length=0;s.FLOAT[e].length=0;s.DOUBLE[e].length=0;s.UINT8C[e].length=0;l[e].length=0;u[e].length=0}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},t("buffer").Buffer)},{"bit-twiddle":80,buffer:92,dup:154}],508:[function(t,e,r){"use strict";"use restrict";e.exports=n;function n(t){this.roots=new Array(t);this.ranks=new Array(t);for(var e=0;e<t;++e){this.roots[e]=e;this.ranks[e]=0}}var a=n.prototype;Object.defineProperty(a,"length",{get:function(){return this.roots.length}});a.makeSet=function(){var t=this.roots.length;this.roots.push(t);this.ranks.push(0);return t};a.find=function(t){var e=t;var r=this.roots;while(r[t]!==t){t=r[t]}while(r[e]!==t){var n=r[e];r[e]=t;e=n}return t};a.link=function(t,e){var r=this.find(t),n=this.find(e);if(r===n){return}var a=this.ranks,i=this.roots,o=a[r],s=a[n];if(o<s){i[r]=n}else if(s<o){i[n]=r}else{i[n]=r;++a[r]}}},{}],509:[function(t,e,r){"use strict";function n(t,e){var r=1,n=t.length,a=t[0],i=t[0];for(var o=1;o<n;++o){i=a;a=t[o];if(e(a,i)){if(o===r){r++;continue}t[r++]=a}}t.length=r;return t}function a(t){var e=1,r=t.length,n=t[0],a=t[0];for(var i=1;i<r;++i,a=n){a=n;n=t[i];if(n!==a){if(i===e){e++;continue}t[e++]=n}}t.length=e;return t}function i(t,e,r){if(t.length===0){return t}if(e){if(!r){t.sort(e)}return n(t,e)}if(!r){t.sort()}return a(t)}e.exports=i},{}],510:[function(t,e,r){var n=/[\'\"]/;e.exports=function t(e){if(!e){return""}if(n.test(e.charAt(0))){e=e.substr(1)}if(n.test(e.charAt(e.length-1))){e=e.substr(0,e.length-1)}return e}},{}],511:[function(t,e,r){"use strict";e.exports=function t(e,r,n){if(!Array.isArray(n))n=[].slice.call(arguments,2);for(var a=0,i=n.length;a<i;a++){var o=n[a];for(var s in o){if(r[s]!==undefined&&!Array.isArray(r[s])&&e[s]===r[s])continue;if(s in r){var l;if(o[s]===true)l=r[s];else if(o[s]===false)continue;else if(typeof o[s]==="function"){l=o[s](r[s],e,r);if(l===undefined)continue}e[s]=l}}}return e}},{}],512:[function(t,e,r){if(typeof Object.create==="function"){e.exports=function t(e,r){e.super_=r;e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})}}else{e.exports=function t(e,r){e.super_=r;var n=function(){};n.prototype=r.prototype;e.prototype=new n;e.prototype.constructor=e}}},{}],513:[function(t,e,r){e.exports=function t(e){return e&&typeof e==="object"&&typeof e.copy==="function"&&typeof e.fill==="function"&&typeof e.readUInt8==="function"}},{}],514:[function(t,e,r){(function(e,n){var a=/%[sdj%]/g;r.format=function(t){if(!w(t)){var e=[];for(var r=0;r<arguments.length;r++){e.push(s(arguments[r]))}return e.join(" ")}var r=1;var n=arguments;var i=n.length;var o=String(t).replace(a,function(t){if(t==="%%")return"%";if(r>=i)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}});for(var l=n[r];r<i;l=n[++r]){if(x(l)||!T(l)){o+=" "+l}else{o+=" "+s(l)}}return o};r.deprecate=function(t,a){if(M(n.process)){return function(){return r.deprecate(t,a).apply(this,arguments)}}if(e.noDeprecation===true){return t}var i=false;function o(){if(!i){if(e.throwDeprecation){throw new Error(a)}else if(e.traceDeprecation){console.trace(a)}else{console.error(a)}i=true}return t.apply(this,arguments)}return o};var i={};var o;r.debuglog=function(t){if(M(o))o=e.env.NODE_DEBUG||"";t=t.toUpperCase();if(!i[t]){if(new RegExp("\\b"+t+"\\b","i").test(o)){var n=e.pid;i[t]=function(){var e=r.format.apply(r,arguments);console.error("%s %d: %s",t,n,e)}}else{i[t]=function(){}}}return i[t]};function s(t,e){var n={seen:[],stylize:u};if(arguments.length>=3)n.depth=arguments[2];if(arguments.length>=4)n.colors=arguments[3];if(y(e)){n.showHidden=e}else if(e){r._extend(n,e)}if(M(n.showHidden))n.showHidden=false;if(M(n.depth))n.depth=2;if(M(n.colors))n.colors=false;if(M(n.customInspect))n.customInspect=true;if(n.colors)n.stylize=l;return f(n,t,n.depth)}r.inspect=s;s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function l(t,e){var r=s.styles[e];if(r){return"\x1b["+s.colors[r][0]+"m"+t+"\x1b["+s.colors[r][1]+"m"}else{return t}}function u(t,e){return t}function c(t){var e={};t.forEach(function(t,r){e[t]=true});return e}function f(t,e,n){if(t.customInspect&&e&&C(e.inspect)&&e.inspect!==r.inspect&&!(e.constructor&&e.constructor.prototype===e)){var a=e.inspect(n,t);if(!w(a)){a=f(t,a,n)}return a}var i=h(t,e);if(i){return i}var o=Object.keys(e);var s=c(o);if(t.showHidden){o=Object.getOwnPropertyNames(e)}if(E(e)&&(o.indexOf("message")>=0||o.indexOf("description")>=0)){return p(e)}if(o.length===0){if(C(e)){var l=e.name?": "+e.name:"";return t.stylize("[Function"+l+"]","special")}if(A(e)){return t.stylize(RegExp.prototype.toString.call(e),"regexp")}if(S(e)){return t.stylize(Date.prototype.toString.call(e),"date")}if(E(e)){return p(e)}}var u="",y=false,x=["{","}"];if(m(e)){y=true;x=["[","]"]}if(C(e)){var b=e.name?": "+e.name:"";u=" [Function"+b+"]"}if(A(e)){u=" "+RegExp.prototype.toString.call(e)}if(S(e)){u=" "+Date.prototype.toUTCString.call(e)}if(E(e)){u=" "+p(e)}if(o.length===0&&(!y||e.length==0)){return x[0]+u+x[1]}if(n<0){if(A(e)){return t.stylize(RegExp.prototype.toString.call(e),"regexp")}else{return t.stylize("[Object]","special")}}t.seen.push(e);var _;if(y){_=d(t,e,n,s,o)}else{_=o.map(function(r){return v(t,e,n,s,r,y)})}t.seen.pop();return g(_,u,x)}function h(t,e){if(M(e))return t.stylize("undefined","undefined");if(w(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(_(e))return t.stylize(""+e,"number");if(y(e))return t.stylize(""+e,"boolean");if(x(e))return t.stylize("null","null")}function p(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,r,n,a){var i=[];for(var o=0,s=e.length;o<s;++o){if(D(e,String(o))){i.push(v(t,e,r,n,String(o),true))}else{i.push("")}}a.forEach(function(a){if(!a.match(/^\d+$/)){i.push(v(t,e,r,n,a,true))}});return i}function v(t,e,r,n,a,i){var o,s,l;l=Object.getOwnPropertyDescriptor(e,a)||{value:e[a]};if(l.get){if(l.set){s=t.stylize("[Getter/Setter]","special")}else{s=t.stylize("[Getter]","special")}}else{if(l.set){s=t.stylize("[Setter]","special")}}if(!D(n,a)){o="["+a+"]"}if(!s){if(t.seen.indexOf(l.value)<0){if(x(r)){s=f(t,l.value,null)}else{s=f(t,l.value,r-1)}if(s.indexOf("\n")>-1){if(i){s=s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2)}else{s="\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")}}}else{s=t.stylize("[Circular]","special")}}if(M(o)){if(i&&a.match(/^\d+$/)){return s}o=JSON.stringify(""+a);if(o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){o=o.substr(1,o.length-2);o=t.stylize(o,"name")}else{o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");o=t.stylize(o,"string")}}return o+": "+s}function g(t,e,r){var n=0;var a=t.reduce(function(t,e){n++;if(e.indexOf("\n")>=0)n++;return t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(a>60){return r[0]+(e===""?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]}return r[0]+e+" "+t.join(", ")+" "+r[1]}function m(t){return Array.isArray(t)}r.isArray=m;function y(t){return typeof t==="boolean"}r.isBoolean=y;function x(t){return t===null}r.isNull=x;function b(t){return t==null}r.isNullOrUndefined=b;function _(t){return typeof t==="number"}r.isNumber=_;function w(t){return typeof t==="string"}r.isString=w;function k(t){return typeof t==="symbol"}r.isSymbol=k;function M(t){return t===void 0}r.isUndefined=M;function A(t){return T(t)&&I(t)==="[object RegExp]"}r.isRegExp=A;function T(t){return typeof t==="object"&&t!==null}r.isObject=T;function S(t){return T(t)&&I(t)==="[object Date]"}r.isDate=S;function E(t){return T(t)&&(I(t)==="[object Error]"||t instanceof Error)}r.isError=E;function C(t){return typeof t==="function"}r.isFunction=C;function L(t){return t===null||typeof t==="boolean"||typeof t==="number"||typeof t==="string"||typeof t==="symbol"||typeof t==="undefined"}r.isPrimitive=L;r.isBuffer=t("./support/isBuffer");function I(t){return Object.prototype.toString.call(t)}function z(t){return t<10?"0"+t.toString(10):t.toString(10)}var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(){var t=new Date;var e=[z(t.getHours()),z(t.getMinutes()),z(t.getSeconds())].join(":");return[t.getDate(),P[t.getMonth()],e].join(" ")}r.log=function(){console.log("%s - %s",O(),r.format.apply(r,arguments))};r.inherits=t("inherits");r._extend=function(t,e){if(!e||!T(e))return t;var r=Object.keys(e);var n=r.length;while(n--){t[r[n]]=e[r[n]]}return t};function D(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}).call(this,t("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":513,_process:449,inherits:512}],515:[function(t,e,r){"use strict";e.exports=o;var n=t("./lib/vtext");var a=null;var i=null;if(typeof document!=="undefined"){a=document.createElement("canvas");a.width=8192;a.height=1024;i=a.getContext("2d")}function o(t,e){if(typeof e!=="object"||e===null){e={}}return n(t,e.canvas||a,e.context||i,e)}},{"./lib/vtext":516}],516:[function(t,e,r){"use strict";e.exports=d;e.exports.processPixels=p;var n=t("surface-nets");var a=t("ndarray");var i=t("simplify-planar-graph");var o=t("clean-pslg");var s=t("cdt2d");var l=t("planar-graph-to-polyline");function u(t,e,r){var n=e.textAlign||"start";var a=e.textBaseline||"alphabetic";var i=[1<<30,1<<30];var o=[0,0];var s=t.length;for(var l=0;l<s;++l){var u=t[l];for(var c=0;c<2;++c){i[c]=Math.min(i[c],u[c])|0;o[c]=Math.max(o[c],u[c])|0}}var f=0;switch(n){case"center":f=-.5*(i[0]+o[0]);break;case"right":case"end":f=-o[0];break;case"left":case"start":f=-i[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+n+"'")}var h=0;switch(a){case"hanging":case"top":h=-i[1];break;case"middle":h=-.5*(i[1]+o[1]);break;case"alphabetic":case"ideographic":h=-3*r;break;case"bottom":h=-o[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+a+"'")}var p=1/r;if("lineHeight"in e){p*=+e.lineHeight}else if("width"in e){p=e.width/(o[0]-i[0])}else if("height"in e){p=e.height/(o[1]-i[1])}return t.map(function(t){return[p*(t[0]+f),p*(t[1]+h)]})}function c(t,e,r,n){var i=Math.ceil(e.measureText(r).width+2*n)|0;if(i>8192){throw new Error("vectorize-text: String too long (sorry, this will get fixed later)")}var o=3*n;if(t.height<o){t.height=o}e.fillStyle="#000";e.fillRect(0,0,t.width,t.height);e.fillStyle="#fff";e.fillText(r,n,2*n);var s=e.getImageData(0,0,i,o);var l=a(s.data,[o,i,4]);return l.pick(-1,-1,0).transpose(1,0)}function f(t,e){var r=n(t,128);if(e){return i(r.cells,r.positions,.25)}return{edges:r.cells,positions:r.positions}}function h(t,e,r,n){var a=f(t,n);var i=u(a.positions,e,r);var c=a.edges;var h="ccw"===e.orientation;o(i,c);if(e.polygons||e.polygon||e.polyline){var p=l(c,i);var d=new Array(p.length);for(var v=0;v<p.length;++v){var g=p[v];var m=new Array(g.length);for(var y=0;y<g.length;++y){var x=g[y];var b=new Array(x.length);for(var _=0;_<x.length;++_){b[_]=i[x[_]].slice()}if(h){b.reverse()}m[y]=b}d[v]=m}return d}else if(e.triangles||e.triangulate||e.triangle){return{cells:s(i,c,{delaunay:false,exterior:false,interior:true}),positions:i}}else{return{edges:c,positions:i}}}function p(t,e,r){try{return h(t,e,r,true)}catch(t){}try{return h(t,e,r,false)}catch(t){}if(e.polygons||e.polyline||e.polygon){return[]}if(e.triangles||e.triangulate||e.triangle){return{cells:[],positions:[]}}return{edges:[],positions:[]}}function d(t,e,r,n){var a=n.size||64;var i=n.font||"normal";r.font=a+"px "+i;r.textAlign="start";r.textBaseline="alphabetic";r.direction="ltr";var o=c(e,r,t,a);return p(o,n,a)}},{cdt2d:93,"clean-pslg":103,ndarray:417,"planar-graph-to-polyline":435,"simplify-planar-graph":485,"surface-nets":493}],517:[function(t,e,r){(function t(){"use strict";if(typeof ses!=="undefined"&&ses.ok&&!ses.ok()){return}function r(t){if(t.permitHostObjects___){t.permitHostObjects___(r)}}if(typeof ses!=="undefined"){ses.weakMapPermitHostObjects=r}var n=false;if(typeof WeakMap==="function"){var a=WeakMap;if(typeof navigator!=="undefined"&&/Firefox/.test(navigator.userAgent)){}else{var i=new a;var o=Object.freeze({});i.set(o,1);if(i.get(o)!==1){n=true}else{e.exports=WeakMap;return}}}var s=Object.prototype.hasOwnProperty;var l=Object.getOwnPropertyNames;var u=Object.defineProperty;var c=Object.isExtensible;var f="weakmap:";var h=f+"ident:"+Math.random()+"___";if(typeof crypto!=="undefined"&&typeof crypto.getRandomValues==="function"&&typeof ArrayBuffer==="function"&&typeof Uint8Array==="function"){var p=new ArrayBuffer(25);var d=new Uint8Array(p);crypto.getRandomValues(d);h=f+"rand:"+Array.prototype.map.call(d,function(t){return(t%36).toString(36)}).join("")+"___"}function v(t){return!(t.substr(0,f.length)==f&&t.substr(t.length-3)==="___")}u(Object,"getOwnPropertyNames",{value:function t(e){return l(e).filter(v)}});if("getPropertyNames"in Object){var g=Object.getPropertyNames;u(Object,"getPropertyNames",{value:function t(e){return g(e).filter(v)}})}function m(t){if(t!==Object(t)){throw new TypeError("Not an object: "+t)}var e=t[h];if(e&&e.key===t){return e}if(!c(t)){return void 0}e={key:t};try{u(t,h,{value:e,writable:false,enumerable:false,configurable:false});return e}catch(t){return void 0}}(function(){var t=Object.freeze;u(Object,"freeze",{value:function e(r){m(r);return t(r)}});var e=Object.seal;u(Object,"seal",{value:function t(r){m(r);return e(r)}});var r=Object.preventExtensions;u(Object,"preventExtensions",{value:function t(e){m(e);return r(e)}})})();function y(t){t.prototype=null;return Object.freeze(t)}var x=false;function b(){if(!x&&typeof console!=="undefined"){x=true;console.warn("WeakMap should be invoked as new WeakMap(), not "+"WeakMap(). This will be an error in the future.")}}var _=0;var w=function(){if(!(this instanceof w)){b()}var t=[];var e=[];var r=_++;function n(n,a){var i;var o=m(n);if(o){return r in o?o[r]:a}else{i=t.indexOf(n);return i>=0?e[i]:a}}function a(e){var n=m(e);if(n){return r in n}else{return t.indexOf(e)>=0}}function i(n,a){var i;var o=m(n);if(o){o[r]=a}else{i=t.indexOf(n);if(i>=0){e[i]=a}else{i=t.length;e[i]=a;t[i]=n}}return this}function o(n){var a=m(n);var i,o;if(a){return r in a&&delete a[r]}else{i=t.indexOf(n);if(i<0){return false}o=t.length-1;t[i]=void 0;e[i]=e[o];t[i]=t[o];t.length=o;e.length=o;return true}}return Object.create(w.prototype,{get___:{value:y(n)},has___:{value:y(a)},set___:{value:y(i)},delete___:{value:y(o)}})};w.prototype=Object.create(Object.prototype,{get:{value:function t(e,r){return this.get___(e,r)},writable:true,configurable:true},has:{value:function t(e){return this.has___(e)},writable:true,configurable:true},set:{value:function t(e,r){return this.set___(e,r)},writable:true,configurable:true},delete:{value:function t(e){return this.delete___(e)},writable:true,configurable:true}});if(typeof a==="function"){(function(){if(n&&typeof Proxy!=="undefined"){Proxy=undefined}function t(){if(!(this instanceof w)){b()}var t=new a;var e=undefined;var i=false;function o(r,n){if(e){return t.has(r)?t.get(r):e.get___(r,n)}else{return t.get(r,n)}}function s(r){return t.has(r)||(e?e.has___(r):false)}var l;if(n){l=function(r,n){t.set(r,n);if(!t.has(r)){if(!e){e=new w}e.set(r,n)}return this}}else{l=function(r,n){if(i){try{t.set(r,n)}catch(t){if(!e){e=new w}e.set___(r,n)}}else{t.set(r,n)}return this}}function u(r){var n=!!t["delete"](r);if(e){return e.delete___(r)||n}return n}return Object.create(w.prototype,{get___:{value:y(o)},has___:{value:y(s)},set___:{value:y(l)},delete___:{value:y(u)},permitHostObjects___:{value:y(function(t){if(t===r){i=true}else{throw new Error("bogus call to permitHostObjects___")}})}})}t.prototype=w.prototype;e.exports=t;Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:false,configurable:true,writable:true})})()}else{if(typeof Proxy!=="undefined"){Proxy=undefined}e.exports=w}})()},{}],518:[function(t,e,r){var n=t("./hidden-store.js");e.exports=a;function a(){var t={};return function(e){if((typeof e!=="object"||e===null)&&typeof e!=="function"){throw new Error("Weakmap-shim: Key must be object")}var r=e.valueOf(t);return r&&r.identity===t?r:n(e,t)}}},{"./hidden-store.js":519}],519:[function(t,e,r){e.exports=n;function n(t,e){var r={identity:e};var n=t.valueOf;Object.defineProperty(t,"valueOf",{value:function(t){return t!==e?n.apply(this,arguments):r},writable:true});return r}},{}],520:[function(t,e,r){var n=t("./create-store.js");e.exports=a;function a(){var t=n();return{get:function(e,r){var n=t(e);return n.hasOwnProperty("value")?n.value:r},set:function(e,r){t(e).value=r;return this},has:function(e){return"value"in t(e)},delete:function(e){return delete t(e).value}}}},{"./create-store.js":518}],521:[function(t,e,r){var n=t("get-canvas-context");e.exports=function t(e){return n("webgl",e)}},{"get-canvas-context":221}],522:[function(t,e,r){var n=t("../main");var a=t("object-assign");var i=n.instance();function o(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}o.prototype=new n.baseCalendar;a(o.prototype,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:false,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(t,e){if(typeof t==="string"){var r=t.match(l);return r?r[0]:""}var n=this._validateYear(t);var a=t.month();var i=""+this.toChineseMonth(n,a);if(e&&i.length<2){i="0"+i}if(this.isIntercalaryMonth(n,a)){i+="i"}return i},monthNames:function(t){if(typeof t==="string"){var e=t.match(u);return e?e[0]:""}var r=this._validateYear(t);var n=t.month();var a=this.toChineseMonth(r,n);var i=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"][a-1];if(this.isIntercalaryMonth(r,n)){i="\u95f0"+i}return i},monthNamesShort:function(t){if(typeof t==="string"){var e=t.match(c);return e?e[0]:""}var r=this._validateYear(t);var n=t.month();var a=this.toChineseMonth(r,n);var i=["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"][a-1];if(this.isIntercalaryMonth(r,n)){i="\u95f0"+i}return i},parseMonth:function(t,e){t=this._validateYear(t);var r=parseInt(e);var n;if(!isNaN(r)){var a=e[e.length-1];n=a==="i"||a==="I"}else{if(e[0]==="\u95f0"){n=true;e=e.substring(1)}if(e[e.length-1]==="\u6708"){e=e.substring(0,e.length-1)}r=1+["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"].indexOf(e)}var i=this.toMonthIndex(t,r,n);return i},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:false}},_validateYear:function(t,e){if(t.year){t=t.year()}if(typeof t!=="number"||t<1888||t>2111){throw e.replace(/\{0\}/,this.local.name)}return t},toMonthIndex:function(t,e,r){var a=this.intercalaryMonth(t);var i=r&&e!==a;if(i||e<1||e>12){throw n.local.invalidMonth.replace(/\{0\}/,this.local.name)}var o;if(!a){o=e-1}else if(!r&&e<=a){o=e-1}else{o=e}return o},toChineseMonth:function(t,e){if(t.year){t=t.year();e=t.month()}var r=this.intercalaryMonth(t);var a=r?12:11;if(e<0||e>a){throw n.local.invalidMonth.replace(/\{0\}/,this.local.name)}var i;if(!r){i=e+1}else if(e<r){i=e+1}else{i=e}return i},intercalaryMonth:function(t){t=this._validateYear(t);var e=f[t-f[0]];var r=e>>13;return r},isIntercalaryMonth:function(t,e){if(t.year){t=t.year();e=t.month()}var r=this.intercalaryMonth(t);return!!r&&r===e},leapYear:function(t){return this.intercalaryMonth(t)!==0},weekOfYear:function(t,e,r){var a=this._validateYear(t,n.local.invalidyear);var o=h[a-h[0]];var s=o>>9&4095;var l=o>>5&15;var u=o&31;var c;c=i.newDate(s,l,u);c.add(4-(c.dayOfWeek()||7),"d");var f=this.toJD(t,e,r)-c.toJD();return 1+Math.floor(f/7)},monthsInYear:function(t){return this.leapYear(t)?13:12},daysInMonth:function(t,e){if(t.year){e=t.month();t=t.year()}t=this._validateYear(t);var r=f[t-f[0]];var a=r>>13;var i=a?12:11;if(e>i){throw n.local.invalidMonth.replace(/\{0\}/,this.local.name)}var o=r&1<<12-e?30:29;return o},weekDay:function(t,e,r){return(this.dayOfWeek(t,e,r)||7)<6},toJD:function(t,e,r){var a=this._validate(t,s,r,n.local.invalidDate);t=this._validateYear(a.year());e=a.month();r=a.day();var o=this.isIntercalaryMonth(t,e);var s=this.toChineseMonth(t,e);var l=d(t,s,r,o);return i.toJD(l.year,l.month,l.day)},fromJD:function(t){var e=i.fromJD(t);var r=p(e.year(),e.month(),e.day());var n=this.toMonthIndex(r.year,r.month,r.isIntercalary);return this.newDate(r.year,n,r.day)},fromString:function(t){var e=t.match(s);var r=this._validateYear(+e[1]);var n=+e[2];var a=!!e[3];var i=this.toMonthIndex(r,n,a);var o=+e[4];return this.newDate(r,i,o)},add:function(t,e,r){var n=t.year();var a=t.month();var i=this.isIntercalaryMonth(n,a);var s=this.toChineseMonth(n,a);var l=Object.getPrototypeOf(o.prototype).add.call(this,t,e,r);if(r==="y"){var u=l.year();var c=l.month();var f=this.isIntercalaryMonth(u,s);var h=i&&f?this.toMonthIndex(u,s,true):this.toMonthIndex(u,s,false);if(h!==c){l.month(h)}}return l}});var s=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m;var l=/^\d?\d[iI]?/m;var u=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m;var c=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;n.calendars.chinese=o;var f=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548];var h=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function p(t,e,r,n){var a;var i;if(typeof t==="object"){a=t;i=e||{}}else{var o=typeof t==="number"&&t>=1888&&t<=2111;if(!o)throw new Error("Solar year outside range 1888-2111");var s=typeof e==="number"&&e>=1&&e<=12;if(!s)throw new Error("Solar month outside range 1 - 12");var l=typeof r==="number"&&r>=1&&r<=31;if(!l)throw new Error("Solar day outside range 1 - 31");a={year:t,month:e,day:r};i=n||{}}var u=h[a.year-h[0]];var c=a.year<<9|a.month<<5|a.day;i.year=c>=u?a.year:a.year-1;u=h[i.year-h[0]];var p=u>>9&4095;var d=u>>5&15;var v=u&31;var g;var m=new Date(p,d-1,v);var y=new Date(a.year,a.month-1,a.day);g=Math.round((y-m)/(24*3600*1e3));var x=f[i.year-f[0]];var b;for(b=0;b<13;b++){var _=x&1<<12-b?30:29;if(g<_){break}g-=_}var w=x>>13;if(!w||b<w){i.isIntercalary=false;i.month=1+b}else if(b===w){i.isIntercalary=true;i.month=b}else{i.isIntercalary=false;i.month=b}i.day=1+g;return i}function d(t,e,r,n,a){var i;var o;if(typeof t==="object"){o=t;i=e||{}}else{var s=typeof t==="number"&&t>=1888&&t<=2111;if(!s)throw new Error("Lunar year outside range 1888-2111");var l=typeof e==="number"&&e>=1&&e<=12;if(!l)throw new Error("Lunar month outside range 1 - 12");var u=typeof r==="number"&&r>=1&&r<=30;if(!u)throw new Error("Lunar day outside range 1 - 30");var c;if(typeof n==="object"){c=false;i=n}else{c=!!n;i=a||{}}o={year:t,month:e,day:r,isIntercalary:c}}var p;p=o.day-1;var d=f[o.year-f[0]];var v=d>>13;var g;if(!v){g=o.month-1}else if(o.month>v){g=o.month}else if(o.isIntercalary){g=o.month}else{g=o.month-1}for(var m=0;m<g;m++){var y=d&1<<12-m?30:29;p+=y}var x=h[o.year-h[0]];var b=x>>9&4095;var _=x>>5&15;var w=x&31;var k=new Date(b,_-1,w+p);i.year=k.getFullYear();i.month=1+k.getMonth();i.day=k.getDate();return i}},{"../main":536,"object-assign":421}],523:[function(t,e,r){var n=t("../main");var a=t("object-assign");function i(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);var t=e.year()+(e.year()<0?1:0);return t%4===3||t%4===-1},monthsInYear:function(t){this._validate(t,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return 13},weekOfYear:function(t,e,r){var n=this.newDate(t,e,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(t,e){var r=this._validate(t,e,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===13&&this.leapYear(r.year())?1:0)},weekDay:function(t,e,r){return(this.dayOfWeek(t,e,r)||7)<6},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);t=a.year();if(t<0){t++}return a.day()+(a.month()-1)*30+(t-1)*365+Math.floor(t/4)+this.jdEpoch-1},fromJD:function(t){var e=Math.floor(t)+.5-this.jdEpoch;var r=Math.floor((e-Math.floor((e+366)/1461))/365)+1;if(r<=0){r--}e=Math.floor(t)+.5-this.newDate(r,1,1).toJD();var n=Math.floor(e/30)+1;var a=e-(n-1)*30+1;return this.newDate(r,n,a)}});n.calendars.coptic=i},{"../main":536,"object-assign":421}],524:[function(t,e,r){var n=t("../main");var a=t("object-assign");function i(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:false}},leapYear:function(t){this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);return false},monthsInYear:function(t){this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);return 13},daysInYear:function(t){this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);return 400},weekOfYear:function(t,e,r){var n=this.newDate(t,e,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/8)+1},daysInMonth:function(t,e){var r=this._validate(t,e,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);return(a.day()+1)%8},weekDay:function(t,e,r){var n=this.dayOfWeek(t,e,r);return n>=2&&n<=6},extraInfo:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);return{century:o[Math.floor((a.year()-1)/100)+1]||""}},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);t=a.year()+(a.year()<0?1:0);e=a.month();r=a.day();return r+(e>1?16:0)+(e>2?(e-2)*32:0)+(t-1)*400+this.jdEpoch-1},fromJD:function(t){t=Math.floor(t+.5)-Math.floor(this.jdEpoch)-1;var e=Math.floor(t/400)+1;t-=(e-1)*400;t+=t>15?16:0;var r=Math.floor(t/32)+1;var n=t-(r-1)*32+1;return this.newDate(e<=0?e-1:e,r,n)}});var o={20:"Fruitbat",21:"Anchovy"};n.calendars.discworld=i},{"../main":536,"object-assign":421}],525:[function(t,e,r){var n=t("../main");var a=t("object-assign");function i(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);var t=e.year()+(e.year()<0?1:0);return t%4===3||t%4===-1},monthsInYear:function(t){this._validate(t,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return 13},weekOfYear:function(t,e,r){var n=this.newDate(t,e,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(t,e){var r=this._validate(t,e,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===13&&this.leapYear(r.year())?1:0)},weekDay:function(t,e,r){return(this.dayOfWeek(t,e,r)||7)<6},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);t=a.year();if(t<0){t++}return a.day()+(a.month()-1)*30+(t-1)*365+Math.floor(t/4)+this.jdEpoch-1},fromJD:function(t){var e=Math.floor(t)+.5-this.jdEpoch;var r=Math.floor((e-Math.floor((e+366)/1461))/365)+1;if(r<=0){r--}e=Math.floor(t)+.5-this.newDate(r,1,1).toJD();var n=Math.floor(e/30)+1;var a=e-(n-1)*30+1;return this.newDate(r,n,a)}});n.calendars.ethiopian=i},{"../main":536,"object-assign":421}],526:[function(t,e,r){var n=t("../main");var a=t("object-assign");function i(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:false,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);return this._leapYear(e.year())},_leapYear:function(t){t=t<0?t+1:t;return o(t*7+1,19)<7},monthsInYear:function(t){this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);return this._leapYear(t.year?t.year():t)?13:12},weekOfYear:function(t,e,r){var n=this.newDate(t,e,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);t=e.year();return this.toJD(t===-1?+1:t+1,7,1)-this.toJD(t,7,1)},daysInMonth:function(t,e){if(t.year){e=t.month();t=t.year()}this._validate(t,e,this.minDay,n.local.invalidMonth);return e===12&&this.leapYear(t)?30:e===8&&o(this.daysInYear(t),10)===5?30:e===9&&o(this.daysInYear(t),10)===3?29:this.daysPerMonth[e-1]},weekDay:function(t,e,r){return this.dayOfWeek(t,e,r)!==6},extraInfo:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);return{yearType:(this.leapYear(a)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(a)%10-3]}},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);t=a.year();e=a.month();r=a.day();var i=t<=0?t+1:t;var o=this.jdEpoch+this._delay1(i)+this._delay2(i)+r+1;if(e<7){for(var s=7;s<=this.monthsInYear(t);s++){o+=this.daysInMonth(t,s)}for(var s=1;s<e;s++){o+=this.daysInMonth(t,s)}}else{for(var s=7;s<e;s++){o+=this.daysInMonth(t,s)}}return o},_delay1:function(t){var e=Math.floor((235*t-234)/19);var r=12084+13753*e;var n=e*29+Math.floor(r/25920);if(o(3*(n+1),7)<3){n++}return n},_delay2:function(t){var e=this._delay1(t-1);var r=this._delay1(t);var n=this._delay1(t+1);return n-r===356?2:r-e===382?1:0},fromJD:function(t){t=Math.floor(t)+.5;var e=Math.floor((t-this.jdEpoch)*98496/35975351)-1;while(t>=this.toJD(e===-1?+1:e+1,7,1)){e++}var r=t<this.toJD(e,1,1)?7:1;while(t>this.toJD(e,r,this.daysInMonth(e,r))){r++}var n=t-this.toJD(e,r,1)+1;return this.newDate(e,r,n)}});function o(t,e){return t-e*Math.floor(t/e)}n.calendars.hebrew=i},{"../main":536,"object-assign":421}],527:[function(t,e,r){var n=t("../main");var a=t("object-assign");function i(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:false}},leapYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);return(e.year()*11+14)%30<11},weekOfYear:function(t,e,r){var n=this.newDate(t,e,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(t){return this.leapYear(t)?355:354},daysInMonth:function(t,e){var r=this._validate(t,e,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===12&&this.leapYear(r.year())?1:0)},weekDay:function(t,e,r){return this.dayOfWeek(t,e,r)!==5},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);t=a.year();e=a.month();r=a.day();t=t<=0?t+1:t;return r+Math.ceil(29.5*(e-1))+(t-1)*354+Math.floor((3+11*t)/30)+this.jdEpoch-1},fromJD:function(t){t=Math.floor(t)+.5;var e=Math.floor((30*(t-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var r=Math.min(12,Math.ceil((t-29-this.toJD(e,1,1))/29.5)+1);var n=t-this.toJD(e,r,1)+1;return this.newDate(e,r,n)}});n.calendars.islamic=i},{"../main":536,"object-assign":421}],528:[function(t,e,r){var n=t("../main");var a=t("object-assign");function i(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:false}},leapYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);var t=e.year()<0?e.year()+1:e.year();return t%4===0},weekOfYear:function(t,e,r){var n=this.newDate(t,e,r);n.add(4-(n.dayOfWeek()||7),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(t,e){var r=this._validate(t,e,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(t,e,r){return(this.dayOfWeek(t,e,r)||7)<6},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);t=a.year();e=a.month();r=a.day();if(t<0){t++}if(e<=2){t--;e+=12}return Math.floor(365.25*(t+4716))+Math.floor(30.6001*(e+1))+r-1524.5},fromJD:function(t){var e=Math.floor(t+.5);var r=e+1524;var n=Math.floor((r-122.1)/365.25);var a=Math.floor(365.25*n);var i=Math.floor((r-a)/30.6001);var o=i-Math.floor(i<14?1:13);var s=n-Math.floor(o>2?4716:4715);var l=r-a-Math.floor(30.6001*i);if(s<=0){s--}return this.newDate(s,o,l)}});n.calendars.julian=i},{"../main":536,"object-assign":421}],529:[function(t,e,r){var n=t("../main");var a=t("object-assign");function i(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:true,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:false,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(t){this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);return false},formatYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);t=e.year();var r=Math.floor(t/400);t=t%400;t+=t<0?400:0;var a=Math.floor(t/20);return r+"."+a+"."+t%20},forYear:function(t){t=t.split(".");if(t.length<3){throw"Invalid Mayan year"}var e=0;for(var r=0;r<t.length;r++){var n=parseInt(t[r],10);if(Math.abs(n)>19||r>0&&n<0){throw"Invalid Mayan year"}e=e*20+n}return e},monthsInYear:function(t){this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);return 18},weekOfYear:function(t,e,r){this._validate(t,e,r,n.local.invalidDate);return 0},daysInYear:function(t){this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);return 360},daysInMonth:function(t,e){this._validate(t,e,this.minDay,n.local.invalidMonth);return 20},daysInWeek:function(){return 5},dayOfWeek:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);return a.day()},weekDay:function(t,e,r){this._validate(t,e,r,n.local.invalidDate);return true},extraInfo:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);var i=a.toJD();var o=this._toHaab(i);var s=this._toTzolkin(i);return{haabMonthName:this.local.haabMonths[o[0]-1],haabMonth:o[0],haabDay:o[1],tzolkinDayName:this.local.tzolkinMonths[s[0]-1],tzolkinDay:s[0],tzolkinTrecena:s[1]}},_toHaab:function(t){t-=this.jdEpoch;var e=o(t+8+(18-1)*20,365);return[Math.floor(e/20)+1,o(e,20)]},_toTzolkin:function(t){t-=this.jdEpoch;return[s(t+20,20),s(t+4,13)]},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);return a.day()+a.month()*20+a.year()*360+this.jdEpoch},fromJD:function(t){t=Math.floor(t)+.5-this.jdEpoch;var e=Math.floor(t/360);t=t%360;t+=t<0?360:0;var r=Math.floor(t/20);var n=t%20;return this.newDate(e,r,n)}});function o(t,e){return t-e*Math.floor(t/e)}function s(t,e){return o(t-1,e)+1}n.calendars.mayan=i},{"../main":536,"object-assign":421}],530:[function(t,e,r){var n=t("../main");var a=t("object-assign");function i(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;var o=n.instance("gregorian");a(i.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:false}},leapYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return o.leapYear(e.year()+(e.year()<1?1:0)+1469)},weekOfYear:function(t,e,r){var n=this.newDate(t,e,r);n.add(1-(n.dayOfWeek()||7),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(t,e){var r=this._validate(t,e,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===12&&this.leapYear(r.year())?1:0)},weekDay:function(t,e,r){return(this.dayOfWeek(t,e,r)||7)<6},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidMonth);var t=a.year();if(t<0){t++}var i=a.day();for(var s=1;s<a.month();s++){i+=this.daysPerMonth[s-1]}return i+o.toJD(t+1468,3,13)},fromJD:function(t){t=Math.floor(t+.5);var e=Math.floor((t-(this.jdEpoch-1))/366);while(t>=this.toJD(e+1,1,1)){e++}var r=t-Math.floor(this.toJD(e,1,1)+.5)+1;var n=1;while(r>this.daysInMonth(e,n)){r-=this.daysInMonth(e,n);n++}return this.newDate(e,n,r)}});n.calendars.nanakshahi=i},{"../main":536,"object-assign":421}],531:[function(t,e,r){var n=t("../main");var a=t("object-assign");function i(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:false}},leapYear:function(t){return this.daysInYear(t)!==this.daysPerYear},weekOfYear:function(t,e,r){var n=this.newDate(t,e,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);t=e.year();if(typeof this.NEPALI_CALENDAR_DATA[t]==="undefined"){return this.daysPerYear}var r=0;for(var a=this.minMonth;a<=12;a++){r+=this.NEPALI_CALENDAR_DATA[t][a]}return r},daysInMonth:function(t,e){if(t.year){e=t.month();t=t.year()}this._validate(t,e,this.minDay,n.local.invalidMonth);return typeof this.NEPALI_CALENDAR_DATA[t]==="undefined"?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[t][e]},weekDay:function(t,e,r){return this.dayOfWeek(t,e,r)!==6},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);t=a.year();e=a.month();r=a.day();var i=n.instance();var o=0;var s=e;var l=t;this._createMissingCalendarData(t);var u=t-(s>9||s===9&&r>=this.NEPALI_CALENDAR_DATA[l][0]?56:57);if(e!==9){o=r;s--}while(s!==9){if(s<=0){s=12;l--}o+=this.NEPALI_CALENDAR_DATA[l][s];s--}if(e===9){o+=r-this.NEPALI_CALENDAR_DATA[l][0];if(o<0){o+=i.daysInYear(u)}}else{o+=this.NEPALI_CALENDAR_DATA[l][9]-this.NEPALI_CALENDAR_DATA[l][0]}return i.newDate(u,1,1).add(o,"d").toJD()},fromJD:function(t){var e=n.instance();var r=e.fromJD(t);var a=r.year();var i=r.dayOfYear();var o=a+56;this._createMissingCalendarData(o);var s=9;var l=this.NEPALI_CALENDAR_DATA[o][0];var u=this.NEPALI_CALENDAR_DATA[o][s]-l+1;while(i>u){s++;if(s>12){s=1;o++}u+=this.NEPALI_CALENDAR_DATA[o][s]}var c=this.NEPALI_CALENDAR_DATA[o][s]-(u-i);return this.newDate(o,s,c)},_createMissingCalendarData:function(t){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var r=t-1;r<t+2;r++){if(typeof this.NEPALI_CALENDAR_DATA[r]==="undefined"){this.NEPALI_CALENDAR_DATA[r]=e}}},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2000:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}});n.calendars.nepali=i},{"../main":536,"object-assign":421}],532:[function(t,e,r){var n=t("../main");var a=t("object-assign");function i(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xe6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xe6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:false}},leapYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);return((e.year()-(e.year()>0?474:473))%2820+474+38)*682%2816<682},weekOfYear:function(t,e,r){var n=this.newDate(t,e,r);n.add(-((n.dayOfWeek()+1)%7),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(t,e){var r=this._validate(t,e,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===12&&this.leapYear(r.year())?1:0)},weekDay:function(t,e,r){return this.dayOfWeek(t,e,r)!==5},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);t=a.year();e=a.month();r=a.day();var i=t-(t>=0?474:473);var s=474+o(i,2820);return r+(e<=7?(e-1)*31:(e-1)*30+6)+Math.floor((s*682-110)/2816)+(s-1)*365+Math.floor(i/2820)*1029983+this.jdEpoch-1},fromJD:function(t){t=Math.floor(t)+.5;var e=t-this.toJD(475,1,1);var r=Math.floor(e/1029983);var n=o(e,1029983);var a=2820;if(n!==1029982){var i=Math.floor(n/366);var s=o(n,366);a=Math.floor((2134*i+2816*s+2815)/1028522)+i+1}var l=a+2820*r+474;l=l<=0?l-1:l;var u=t-this.toJD(l,1,1)+1;var c=u<=186?Math.ceil(u/31):Math.ceil((u-6)/30);var f=t-this.toJD(l,c,1)+1;return this.newDate(l,c,f)}});function o(t,e){return t-e*Math.floor(t/e)}n.calendars.persian=i;n.calendars.jalali=i},{"../main":536,"object-assign":421}],533:[function(t,e,r){var n=t("../main");var a=t("object-assign");var i=n.instance();function o(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}o.prototype=new n.baseCalendar;a(o.prototype,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:false}},leapYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);var t=this._t2gYear(e.year());return i.leapYear(t)},weekOfYear:function(t,e,r){var a=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);var t=this._t2gYear(a.year());return i.weekOfYear(t,a.month(),a.day())},daysInMonth:function(t,e){var r=this._validate(t,e,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(t,e,r){return(this.dayOfWeek(t,e,r)||7)<6},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);var t=this._t2gYear(a.year());return i.toJD(t,a.month(),a.day())},fromJD:function(t){var e=i.fromJD(t);var r=this._g2tYear(e.year());return this.newDate(r,e.month(),e.day())},_t2gYear:function(t){return t+this.yearsOffset+(t>=-this.yearsOffset&&t<=-1?1:0)},_g2tYear:function(t){return t-this.yearsOffset-(t>=1&&t<=this.yearsOffset?1:0)}});n.calendars.taiwan=o},{"../main":536,"object-assign":421}],534:[function(t,e,r){var n=t("../main");var a=t("object-assign");var i=n.instance();function o(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}o.prototype=new n.baseCalendar;a(o.prototype,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);var t=this._t2gYear(e.year());return i.leapYear(t)},weekOfYear:function(t,e,r){var a=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);var t=this._t2gYear(a.year());return i.weekOfYear(t,a.month(),a.day())},daysInMonth:function(t,e){var r=this._validate(t,e,this.minDay,n.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(t,e,r){return(this.dayOfWeek(t,e,r)||7)<6},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);var t=this._t2gYear(a.year());return i.toJD(t,a.month(),a.day())},fromJD:function(t){var e=i.fromJD(t);var r=this._g2tYear(e.year());return this.newDate(r,e.month(),e.day())},_t2gYear:function(t){return t-this.yearsOffset-(t>=1&&t<=this.yearsOffset?1:0)},_g2tYear:function(t){return t+this.yearsOffset+(t>=-this.yearsOffset&&t<=-1?1:0)}});n.calendars.thai=o},{"../main":536,"object-assign":421}],535:[function(t,e,r){var n=t("../main");var a=t("object-assign");function i(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}i.prototype=new n.baseCalendar;a(i.prototype,{name:"UmmAlQura",hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:true}},leapYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,n.local.invalidYear);return this.daysInYear(e.year())===355},weekOfYear:function(t,e,r){var n=this.newDate(t,e,r);n.add(-n.dayOfWeek(),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(t){var e=0;for(var r=1;r<=12;r++){e+=this.daysInMonth(t,r)}return e},daysInMonth:function(t,e){var r=this._validate(t,e,this.minDay,n.local.invalidMonth);var a=r.toJD()-24e5+.5;var i=0;for(var s=0;s<o.length;s++){if(o[s]>a){return o[i]-o[i-1]}i++}return 30},weekDay:function(t,e,r){return this.dayOfWeek(t,e,r)!==5},toJD:function(t,e,r){var a=this._validate(t,e,r,n.local.invalidDate);var i=12*(a.year()-1)+a.month()-15292;var s=a.day()+o[i-1]-1;return s+24e5-.5},fromJD:function(t){var e=t-24e5+.5;var r=0;for(var n=0;n<o.length;n++){if(o[n]>e)break;r++}var a=r+15292;var i=Math.floor((a-1)/12);var s=i+1;var l=a-12*i;var u=e-o[r-1]+1;return this.newDate(s,l,u)},isValid:function(t,e,r){var a=n.baseCalendar.prototype.isValid.apply(this,arguments);if(a){t=t.year!=null?t.year:t;a=t>=1276&&t<=1500}return a},_validate:function(t,e,r,a){var i=n.baseCalendar.prototype._validate.apply(this,arguments);if(i.year<1276||i.year>1500){throw a.replace(/\{0\}/,this.local.name)}return i}});n.calendars.ummalqura=i;var o=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":536,"object-assign":421}],536:[function(t,e,r){var n=t("object-assign");function a(){this.regionalOptions=[];this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"};this.local=this.regionalOptions[""];this.calendars={};this._localCals={}}n(a.prototype,{instance:function(t,e){t=(t||"gregorian").toLowerCase();e=e||"";var r=this._localCals[t+"-"+e];if(!r&&this.calendars[t]){r=new this.calendars[t](e);this._localCals[t+"-"+e]=r}if(!r){throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,t)}return r},newDate:function(t,e,r,n,a){n=(t!=null&&t.year?t.calendar():typeof n==="string"?this.instance(n,a):n)||this.instance();return n.newDate(t,e,r)},substituteDigits:function(t){return function(e){return(e+"").replace(/[0-9]/g,function(e){return t[e]})}},substituteChineseDigits:function(t,e){return function(r){var n="";var a=0;while(r>0){var i=r%10;n=(i===0?"":t[i]+e[a])+n;a++;r=Math.floor(r/10)}if(n.indexOf(t[1]+e[1])===0){n=n.substr(1)}return n||t[0]}}});function i(t,e,r,n){this._calendar=t;this._year=e;this._month=r;this._day=n;if(this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day)){throw(u.local.invalidDate||u.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}}function o(t,e){t=""+t;return"000000".substring(0,e-t.length)+t}n(i.prototype,{newDate:function(t,e,r){return this._calendar.newDate(t==null?this:t,e,r)},year:function(t){return arguments.length===0?this._year:this.set(t,"y")},month:function(t){return arguments.length===0?this._month:this.set(t,"m")},day:function(t){return arguments.length===0?this._day:this.set(t,"d")},date:function(t,e,r){if(!this._calendar.isValid(t,e,r)){throw(u.local.invalidDate||u.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}this._year=t;this._month=e;this._day=r;return this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(t,e){return this._calendar.add(this,t,e)},set:function(t,e){return this._calendar.set(this,t,e)},compareTo:function(t){if(this._calendar.name!==t._calendar.name){throw(u.local.differentCalendars||u.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,t._calendar.local.name)}var e=this._year!==t._year?this._year-t._year:this._month!==t._month?this.monthOfYear()-t.monthOfYear():this._day-t._day;return e===0?0:e<0?-1:+1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(t){return this._calendar.fromJD(t)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(t){return this._calendar.fromJSDate(t)},toString:function(){return(this.year()<0?"-":"")+o(Math.abs(this.year()),4)+"-"+o(this.month(),2)+"-"+o(this.day(),2)}});function s(){this.shortYearCutoff="+10"}n(s.prototype,{_validateLevel:0,newDate:function(t,e,r){if(t==null){return this.today()}if(t.year){this._validate(t,e,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);r=t.day();e=t.month();t=t.year()}return new i(this,t,e,r)},today:function(){return this.fromJSDate(new Date)},epoch:function(t){var e=this._validate(t,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return e.year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return(e.year()<0?"-":"")+o(Math.abs(e.year()),4)},monthsInYear:function(t){this._validate(t,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return 12},monthOfYear:function(t,e){var r=this._validate(t,e,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return(r.month()+this.monthsInYear(r)-this.firstMonth)%this.monthsInYear(r)+this.minMonth},fromMonthOfYear:function(t,e){var r=(e+this.firstMonth-2*this.minMonth)%this.monthsInYear(t)+this.minMonth;this._validate(t,r,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return r},daysInYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return this.leapYear(e)?366:365},dayOfYear:function(t,e,r){var n=this._validate(t,e,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return n.toJD()-this.newDate(n.year(),this.fromMonthOfYear(n.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(t,e,r){var n=this._validate(t,e,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(n))+2)%this.daysInWeek()},extraInfo:function(t,e,r){this._validate(t,e,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return{}},add:function(t,e,r){this._validate(t,this.minMonth,this.minDay,u.local.invalidDate||u.regionalOptions[""].invalidDate);return this._correctAdd(t,this._add(t,e,r),e,r)},_add:function(t,e,r){this._validateLevel++;if(r==="d"||r==="w"){var n=t.toJD()+e*(r==="w"?this.daysInWeek():1);var a=t.calendar().fromJD(n);this._validateLevel--;return[a.year(),a.month(),a.day()]}try{var i=t.year()+(r==="y"?e:0);var o=t.monthOfYear()+(r==="m"?e:0);var a=t.day();var s=function(t){while(o<t.minMonth){i--;o+=t.monthsInYear(i)}var e=t.monthsInYear(i);while(o>e-1+t.minMonth){i++;o-=e;e=t.monthsInYear(i)}};if(r==="y"){if(t.month()!==this.fromMonthOfYear(i,o)){o=this.newDate(i,t.month(),this.minDay).monthOfYear()}o=Math.min(o,this.monthsInYear(i));a=Math.min(a,this.daysInMonth(i,this.fromMonthOfYear(i,o)))}else if(r==="m"){s(this);a=Math.min(a,this.daysInMonth(i,this.fromMonthOfYear(i,o)))}var l=[i,this.fromMonthOfYear(i,o),a];this._validateLevel--;return l}catch(t){this._validateLevel--;throw t}},_correctAdd:function(t,e,r,n){if(!this.hasYearZero&&(n==="y"||n==="m")){if(e[0]===0||t.year()>0!==e[0]>0){var a={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[n];var i=r<0?-1:+1;e=this._add(t,r*a[0]+i*a[1],a[2])}}return t.date(e[0],e[1],e[2])},set:function(t,e,r){this._validate(t,this.minMonth,this.minDay,u.local.invalidDate||u.regionalOptions[""].invalidDate);var n=r==="y"?e:t.year();var a=r==="m"?e:t.month();var i=r==="d"?e:t.day();if(r==="y"||r==="m"){i=Math.min(i,this.daysInMonth(n,a))}return t.date(n,a,i)},isValid:function(t,e,r){this._validateLevel++;var n=this.hasYearZero||t!==0;if(n){var a=this.newDate(t,e,this.minDay);n=e>=this.minMonth&&e-this.minMonth<this.monthsInYear(a)&&(r>=this.minDay&&r-this.minDay<this.daysInMonth(a))}this._validateLevel--;return n},toJSDate:function(t,e,r){var n=this._validate(t,e,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return u.instance().fromJD(this.toJD(n)).toJSDate()},fromJSDate:function(t){return this.fromJD(u.instance().fromJSDate(t).toJD())},_validate:function(t,e,r,n){if(t.year){if(this._validateLevel===0&&this.name!==t.calendar().name){throw(u.local.differentCalendars||u.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,t.calendar().local.name)}return t}try{this._validateLevel++;if(this._validateLevel===1&&!this.isValid(t,e,r)){throw n.replace(/\{0\}/,this.local.name)}var a=this.newDate(t,e,r);this._validateLevel--;return a}catch(t){this._validateLevel--;throw t}}});function l(t){this.local=this.regionalOptions[t]||this.regionalOptions[""]}l.prototype=new s;n(l.prototype,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:false}},leapYear:function(t){var e=this._validate(t,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);var t=e.year()+(e.year()<0?1:0);return t%4===0&&(t%100!==0||t%400===0)},weekOfYear:function(t,e,r){var n=this.newDate(t,e,r);n.add(4-(n.dayOfWeek()||7),"d");return Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(t,e){var r=this._validate(t,e,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(t,e,r){return(this.dayOfWeek(t,e,r)||7)<6},toJD:function(t,e,r){var n=this._validate(t,e,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);t=n.year();e=n.month();r=n.day();if(t<0){t++}if(e<3){e+=12;t--}var a=Math.floor(t/100);var i=2-a+Math.floor(a/4);return Math.floor(365.25*(t+4716))+Math.floor(30.6001*(e+1))+r+i-1524.5},fromJD:function(t){var e=Math.floor(t+.5);var r=Math.floor((e-1867216.25)/36524.25);r=e+1+r-Math.floor(r/4);var n=r+1524;var a=Math.floor((n-122.1)/365.25);var i=Math.floor(365.25*a);var o=Math.floor((n-i)/30.6001);var s=n-i-Math.floor(o*30.6001);var l=o-(o>13.5?13:1);var u=a-(l>2.5?4716:4715);if(u<=0){u--}return this.newDate(u,l,s)},toJSDate:function(t,e,r){var n=this._validate(t,e,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);var a=new Date(n.year(),n.month()-1,n.day());a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);a.setHours(a.getHours()>12?a.getHours()+2:0);return a},fromJSDate:function(t){return this.newDate(t.getFullYear(),t.getMonth()+1,t.getDate())}});var u=e.exports=new a;u.cdate=i;u.baseCalendar=s;u.calendars.gregorian=l},{"object-assign":421}],537:[function(t,e,r){var n=t("object-assign");var a=t("./main");n(a.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"});a.local=a.regionalOptions[""];n(a.cdate.prototype,{formatDate:function(t,e){if(typeof t!=="string"){e=t;t=""}return this._calendar.formatDate(t||"",this,e)}});n(a.baseCalendar.prototype,{UNIX_EPOCH:a.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:24*60*60,TICKS_EPOCH:a.instance().jdEpoch,TICKS_PER_DAY:24*60*60*1e7,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(t,e,r){if(typeof t!=="string"){r=e;e=t;t=""}if(!e){return""}if(e.calendar()!==this){throw a.local.invalidFormat||a.regionalOptions[""].invalidFormat}t=t||this.local.dateFormat;r=r||{};var n=r.dayNamesShort||this.local.dayNamesShort;var i=r.dayNames||this.local.dayNames;var o=r.monthNumbers||this.local.monthNumbers;var s=r.monthNamesShort||this.local.monthNamesShort;var l=r.monthNames||this.local.monthNames;var u=r.calculateWeek||this.local.calculateWeek;var c=function(e,r){var n=1;while(b+n<t.length&&t.charAt(b+n)===e){n++}b+=n-1;return Math.floor(n/(r||1))>1};var f=function(t,e,r,n){var a=""+e;if(c(t,n)){while(a.length<r){a="0"+a}}return a};var h=function(t,e,r,n){return c(t)?n[e]:r[e]};var p=this;var d=function(t){return typeof o==="function"?o.call(p,t,c("m")):m(f("m",t.month(),2))};var v=function(t,e){if(e){return typeof l==="function"?l.call(p,t):l[t.month()-p.minMonth]}else{return typeof s==="function"?s.call(p,t):s[t.month()-p.minMonth]}};var g=this.local.digits;var m=function(t){return r.localNumbers&&g?g(t):t};var y="";var x=false;for(var b=0;b<t.length;b++){if(x){if(t.charAt(b)==="'"&&!c("'")){x=false}else{y+=t.charAt(b)}}else{switch(t.charAt(b)){case"d":y+=m(f("d",e.day(),2));break;case"D":y+=h("D",e.dayOfWeek(),n,i);break;case"o":y+=f("o",e.dayOfYear(),3);break;case"w":y+=f("w",e.weekOfYear(),2);break;case"m":y+=d(e);break;case"M":y+=v(e,c("M"));break;case"y":y+=c("y",2)?e.year():(e.year()%100<10?"0":"")+e.year()%100;break;case"Y":c("Y",2);y+=e.formatYear();break;case"J":y+=e.toJD();break;case"@":y+=(e.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":y+=(e.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":if(c("'")){y+="'"}else{x=true}break;default:y+=t.charAt(b)}}}return y},parseDate:function(t,e,r){if(e==null){throw a.local.invalidArguments||a.regionalOptions[""].invalidArguments}e=typeof e==="object"?e.toString():e+"";if(e===""){return null}t=t||this.local.dateFormat;r=r||{};var n=r.shortYearCutoff||this.shortYearCutoff;n=typeof n!=="string"?n:this.today().year()%100+parseInt(n,10);var i=r.dayNamesShort||this.local.dayNamesShort;var o=r.dayNames||this.local.dayNames;var s=r.parseMonth||this.local.parseMonth;var l=r.monthNumbers||this.local.monthNumbers;var u=r.monthNamesShort||this.local.monthNamesShort;var c=r.monthNames||this.local.monthNames;var f=-1;var h=-1;var p=-1;var d=-1;var v=-1;var g=false;var m=false;var y=function(e,r){var n=1;while(T+n<t.length&&t.charAt(T+n)===e){n++}T+=n-1;return Math.floor(n/(r||1))>1};var x=function(t,r){var n=y(t,r);var i=[2,3,n?4:2,n?4:2,10,11,20]["oyYJ@!".indexOf(t)+1];var o=new RegExp("^-?\\d{1,"+i+"}");var s=e.substring(A).match(o);if(!s){throw(a.local.missingNumberAt||a.regionalOptions[""].missingNumberAt).replace(/\{0\}/,A)}A+=s[0].length;return parseInt(s[0],10)};var b=this;var _=function(){if(typeof l==="function"){y("m");var t=l.call(b,e.substring(A));A+=t.length;return t}return x("m")};var w=function(t,r,n,i){var o=y(t,i)?n:r;for(var s=0;s<o.length;s++){if(e.substr(A,o[s].length).toLowerCase()===o[s].toLowerCase()){A+=o[s].length;return s+b.minMonth}}throw(a.local.unknownNameAt||a.regionalOptions[""].unknownNameAt).replace(/\{0\}/,A)};var k=function(){if(typeof c==="function"){var t=y("M")?c.call(b,e.substring(A)):u.call(b,e.substring(A));A+=t.length;return t}return w("M",u,c)};var M=function(){if(e.charAt(A)!==t.charAt(T)){throw(a.local.unexpectedLiteralAt||a.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,A)}A++};var A=0;for(var T=0;T<t.length;T++){if(m){if(t.charAt(T)==="'"&&!y("'")){m=false}else{M()}}else{switch(t.charAt(T)){case"d":d=x("d");break;case"D":w("D",i,o);break;case"o":v=x("o");break;case"w":x("w");break;case"m":p=_();break;case"M":p=k();break;case"y":var S=T;g=!y("y",2);T=S;h=x("y",2);break;case"Y":h=x("Y",2);break;case"J":f=x("J")+.5;if(e.charAt(A)==="."){A++;x("J")}break;case"@":f=x("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":f=x("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":A=e.length;break;case"'":if(y("'")){M()}else{m=true}break;default:M()}}}if(A<e.length){throw a.local.unexpectedText||a.regionalOptions[""].unexpectedText}if(h===-1){h=this.today().year()}else if(h<100&&g){h+=n===-1?1900:this.today().year()-this.today().year()%100-(h<=n?0:100)}if(typeof p==="string"){p=s.call(this,h,p)}if(v>-1){p=1;d=v;for(var E=this.daysInMonth(h,p);d>E;E=this.daysInMonth(h,p)){p++;d-=E}}return f>-1?this.fromJD(f):this.newDate(h,p,d)},determineDate:function(t,e,r,n,a){if(r&&typeof r!=="object"){a=n;n=r;r=null}if(typeof n!=="string"){a=n;n=""}var i=this;var o=function(t){try{return i.parseDate(n,t,a)}catch(t){}t=t.toLowerCase();var e=(t.match(/^c/)&&r?r.newDate():null)||i.today();var o=/([+-]?[0-9]+)\s*(d|w|m|y)?/g;var s=o.exec(t);while(s){e.add(parseInt(s[1],10),s[2]||"d");s=o.exec(t)}return e};e=e?e.newDate():null;t=t==null?e:typeof t==="string"?o(t):typeof t==="number"?isNaN(t)||t===Infinity||t===-Infinity?e:i.today().add(t,"d"):i.newDate(t);return t}})},{"./main":536,"object-assign":421}],538:[function(t,e,r){e.exports=t("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg3_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":133}],539:[function(t,e,r){"use strict";e.exports=a;var n=t("./lib/zc-core");function a(t,e){var r=[];e=+e||0;n(t.hi(t.shape[0]-1),r,e);return r}},{"./lib/zc-core":538}],540:[function(t,e,r){"use strict";e.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:true},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:true}]},{}],541:[function(t,e,r){"use strict";var n=t("./arrow_paths");var a=t("../../plots/font_attributes");var i=t("../../plots/cartesian/constants");var o=t("../../plot_api/plot_template").templatedArray;e.exports=o("annotation",{visible:{valType:"boolean",dflt:true,editType:"calcIfAutorange+arraydraw"},text:{valType:"string",editType:"calcIfAutorange+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calcIfAutorange+arraydraw"},font:a({editType:"calcIfAutorange+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calcIfAutorange+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calcIfAutorange+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calcIfAutorange+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calcIfAutorange+arraydraw"},showarrow:{valType:"boolean",dflt:true,editType:"calcIfAutorange+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:n.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:n.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calcIfAutorange+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calcIfAutorange+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calcIfAutorange+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calcIfAutorange+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calcIfAutorange+arraydraw"},ax:{valType:"any",editType:"calcIfAutorange+arraydraw"},ay:{valType:"any",editType:"calcIfAutorange+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",i.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",i.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",i.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calcIfAutorange+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calcIfAutorange+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calcIfAutorange+arraydraw"},yref:{valType:"enumerated",values:["paper",i.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calcIfAutorange+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calcIfAutorange+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calcIfAutorange+arraydraw"},clicktoshow:{valType:"enumerated",values:[false,"onoff","onout"],dflt:false,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:a({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../plot_api/plot_template":722,"../../plots/cartesian/constants":737,"../../plots/font_attributes":758,"./arrow_paths":540}],542:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/cartesian/axes");var i=t("./draw").draw;e.exports=function t(e){var r=e._fullLayout,s=n.filterVisible(r.annotations);if(!s.length||!e._fullData.length)return;var l={};s.forEach(function(t){l[t.xref]=1;l[t.yref]=1});for(var u in l){var c=a.getFromId(e,u);if(c&&c.autorange){return n.syncOrAsync([i,o],e)}}};function o(t){var e=t._fullLayout;n.filterVisible(e.annotations).forEach(function(e){var r=a.getFromId(t,e.xref),n=a.getFromId(t,e.yref),i=3*e.arrowsize*e.arrowwidth||0,o=3*e.startarrowsize*e.arrowwidth||0;var s,l,u,c;if(r&&r.autorange){s=i+e.xshift;l=i-e.xshift;u=o+e.xshift;c=o-e.xshift;if(e.axref===e.xref){a.expand(r,[r.r2c(e.x)],{ppadplus:s,ppadminus:l});a.expand(r,[r.r2c(e.ax)],{ppadplus:Math.max(e._xpadplus,u),ppadminus:Math.max(e._xpadminus,c)})}else{u=e.ax?u+e.ax:u;c=e.ax?c-e.ax:c;a.expand(r,[r.r2c(e.x)],{ppadplus:Math.max(e._xpadplus,s,u),ppadminus:Math.max(e._xpadminus,l,c)})}}if(n&&n.autorange){s=i-e.yshift;l=i+e.yshift;u=o-e.yshift;c=o+e.yshift;if(e.ayref===e.yref){a.expand(n,[n.r2c(e.y)],{ppadplus:s,ppadminus:l});a.expand(n,[n.r2c(e.ay)],{ppadplus:Math.max(e._ypadplus,u),ppadminus:Math.max(e._ypadminus,c)})}else{u=e.ay?u+e.ay:u;c=e.ay?c-e.ay:c;a.expand(n,[n.r2c(e.y)],{ppadplus:Math.max(e._ypadplus,s,u),ppadminus:Math.max(e._ypadminus,l,c)})}}})}},{"../../lib":684,"../../plots/cartesian/axes":732,"./draw":547}],543:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../registry");var i=t("../../plot_api/plot_template").arrayEditor;e.exports={hasClickToShow:o,onClick:s};function o(t,e){var r=l(t,e);return r.on.length>0||r.explicitOff.length>0}function s(t,e){var r=l(t,e);var o=r.on;var s=r.off.concat(r.explicitOff);var u={};var c=t._fullLayout.annotations;var f,h;if(!(o.length||s.length))return;for(f=0;f<o.length;f++){h=i(t.layout,"annotations",c[o[f]]);h.modifyItem("visible",true);n.extendFlat(u,h.getUpdateObj())}for(f=0;f<s.length;f++){h=i(t.layout,"annotations",c[s[f]]);h.modifyItem("visible",false);n.extendFlat(u,h.getUpdateObj())}return a.call("update",t,{},u)}function l(t,e){var r=t._fullLayout.annotations,n=[],a=[],i=[],o=(e||[]).length;var s,l,c,f,h,p,d,v;for(s=0;s<r.length;s++){c=r[s];f=c.clicktoshow;if(f){for(l=0;l<o;l++){h=e[l];p=h.xaxis;d=h.yaxis;if(p._id===c.xref&&d._id===c.yref&&p.d2r(h.x)===u(c._xclick,p)&&d.d2r(h.y)===u(c._yclick,d)){if(c.visible){if(f==="onout")v=a;else v=i}else{v=n}v.push(s);break}}if(l===o){if(c.visible&&f==="onout")a.push(s)}}}return{on:n,off:a,explicitOff:i}}function u(t,e){return e.type==="log"?e.l2r(t):e.d2r(t)}},{"../../lib":684,"../../plot_api/plot_template":722,"../../registry":817}],544:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../color");e.exports=function t(e,r,i,o){o("opacity");var s=o("bgcolor");var l=o("bordercolor");var u=a.opacity(l);o("borderpad");var c=o("borderwidth");var f=o("showarrow");o("text",f?" ":i._dfltTitle.annotation);o("textangle");n.coerceFont(o,"font",i.font);o("width");o("align");var h=o("height");if(h)o("valign");if(f){var p=o("arrowside");var d;var v;if(p.indexOf("end")!==-1){d=o("arrowhead");v=o("arrowsize")}if(p.indexOf("start")!==-1){o("startarrowhead",d);o("startarrowsize",v)}o("arrowcolor",u?r.bordercolor:a.defaultLine);o("arrowwidth",(u&&c||1)*2);o("standoff");o("startstandoff")}var g=o("hovertext");var m=i.hoverlabel||{};if(g){var y=o("hoverlabel.bgcolor",m.bgcolor||(a.opacity(s)?a.rgb(s):a.defaultLine));var x=o("hoverlabel.bordercolor",m.bordercolor||a.contrast(y));n.coerceFont(o,"hoverlabel.font",{family:m.font.family,size:m.font.size,color:m.font.color||x})}o("captureevents",!!g)}},{"../../lib":684,"../color":558}],545:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib/to_log_range");e.exports=function t(e,r,i,o){r=r||{};var s=i==="log"&&r.type==="linear",l=i==="linear"&&r.type==="log";if(!(s||l))return;var u=e._fullLayout.annotations,c=r._id.charAt(0),f,h;function p(t){var e=f[t],i=null;if(s)i=a(e,r.range);else i=Math.pow(10,e);if(!n(i))i=null;o(h+t,i)}for(var d=0;d<u.length;d++){f=u[d];h="annotations["+d+"].";if(f[c+"ref"]===r._id)p(c);if(f["a"+c+"ref"]===r._id)p("a"+c)}}},{"../../lib/to_log_range":710,"fast-isnumeric":214}],546:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/cartesian/axes");var i=t("../../plots/array_container_defaults");var o=t("./common_defaults");var s=t("./attributes");e.exports=function t(e,r){i(e,r,{name:"annotations",handleItemDefaults:l})};function l(t,e,r){function i(r,a){return n.coerce(t,e,s,r,a)}var l=i("visible");var u=i("clicktoshow");if(!(l||u))return;o(t,e,r,i);var c=e.showarrow;var f=["x","y"],h=[-10,-30],p={_fullLayout:r};for(var d=0;d<2;d++){var v=f[d];var g=a.coerceRef(t,e,p,v,"","paper");a.coercePosition(e,p,i,g,v,.5);if(c){var m="a"+v,y=a.coerceRef(t,e,p,m,"pixel");if(y!=="pixel"&&y!==g){y=e[m]="pixel"}var x=y==="pixel"?h[d]:.4;a.coercePosition(e,p,i,y,m,x)}i(v+"anchor");i(v+"shift")}n.noneOrAll(t,e,["x","y"]);if(c){n.noneOrAll(t,e,["ax","ay"])}if(u){var b=i("xclick");var _=i("yclick");e._xclick=b===undefined?e.x:a.cleanPosition(b,p,e.xref);e._yclick=_===undefined?e.y:a.cleanPosition(_,p,e.yref)}}},{"../../lib":684,"../../plots/array_container_defaults":728,"../../plots/cartesian/axes":732,"./attributes":541,"./common_defaults":544}],547:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../registry");var i=t("../../plots/plots");var o=t("../../lib");var s=t("../../plots/cartesian/axes");var l=t("../color");var u=t("../drawing");var c=t("../fx");var f=t("../../lib/svg_text_utils");var h=t("../../lib/setcursor");var p=t("../dragelement");var d=t("../../plot_api/plot_template").arrayEditor;var v=t("./draw_arrow_head");e.exports={draw:g,drawOne:m,drawRaw:y};function g(t){var e=t._fullLayout;e._infolayer.selectAll(".annotation").remove();for(var r=0;r<e.annotations.length;r++){if(e.annotations[r].visible){m(t,r)}}return i.previousPromises(t)}function m(t,e){var r=t._fullLayout;var n=r.annotations[e]||{};var a=s.getFromId(t,n.xref);var i=s.getFromId(t,n.yref);y(t,n,e,false,a,i)}function y(t,e,r,i,s,g){var m=t._fullLayout;var y=t._fullLayout._size;var x=t._context.edits;var b,_;if(i){b="annotation-"+i;_=i+".annotations"}else{b="annotation";_="annotations"}var w=d(t.layout,_,e);var k=w.modifyBase;var M=w.modifyItem;var A=w.getUpdateObj;m._infolayer.selectAll("."+b+'[data-index="'+r+'"]').remove();var T="clip"+m._uid+"_ann"+r;if(!e._input||e.visible===false){n.selectAll("#"+T).remove();return}var S={x:{},y:{}},E=+e.textangle||0;var C=m._infolayer.append("g").classed(b,true).attr("data-index",String(r)).style("opacity",e.opacity);var L=C.append("g").classed("annotation-text-g",true);var I=x[e.showarrow?"annotationTail":"annotationPosition"];var z=e.captureevents||x.annotationText||I;var P=L.append("g").style("pointer-events",z?"all":null).call(h,"pointer").on("click",function(){t._dragging=false;var a={index:r,annotation:e._input,fullAnnotation:e,event:n.event};if(i){a.subplotId=i}t.emit("plotly_clickannotation",a)});if(e.hovertext){P.on("mouseover",function(){var r=e.hoverlabel;var n=r.font;var a=this.getBoundingClientRect();var i=t.getBoundingClientRect();c.loneHover({x0:a.left-i.left,x1:a.right-i.left,y:(a.top+a.bottom)/2-i.top,text:e.hovertext,color:r.bgcolor,borderColor:r.bordercolor,fontFamily:n.family,fontSize:n.size,fontColor:n.color},{container:m._hoverlayer.node(),outerContainer:m._paper.node(),gd:t})}).on("mouseout",function(){c.loneUnhover(m._hoverlayer.node())})}var O=e.borderwidth,D=e.borderpad,R=O+D;var B=P.append("rect").attr("class","bg").style("stroke-width",O+"px").call(l.stroke,e.bordercolor).call(l.fill,e.bgcolor);var F=e.width||e.height;var N=m._topclips.selectAll("#"+T).data(F?[0]:[]);N.enter().append("clipPath").classed("annclip",true).attr("id",T).append("rect");N.exit().remove();var j=e.font;var V=P.append("text").classed("annotation-text",true).text(e.text);function U(r){r.call(u.font,j).attr({"text-anchor":{left:"start",right:"end"}[e.align]||"middle"});f.convertToTspans(r,t,q);return r}function q(){var r=V.selectAll("a");if(r.size()===1&&r.text()===V.text()){var n=P.insert("a",":first-child").attr({"xlink:xlink:href":r.attr("xlink:href"),"xlink:xlink:show":r.attr("xlink:show")}).style({cursor:"pointer"});n.node().appendChild(B.node())}var c=P.select(".annotation-text-math-group");var d=!c.empty();var b=u.bBox((d?c:V).node());var _=b.width;var w=b.height;var z=e.width||_;var D=e.height||w;var j=Math.round(z+2*R);var U=Math.round(D+2*R);e._w=z;e._h=D;function q(t,e){if(e==="auto"){if(t<1/3)e="left";else if(t>2/3)e="right";else e="center"}return{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[e]}var H=false;var G=["x","y"];for(var W=0;W<G.length;W++){var Y=G[W],X=e[Y+"ref"]||Y,Z=e["a"+Y+"ref"],$={x:s,y:g}[Y],J=(E+(Y==="x"?0:-90))*Math.PI/180,K=j*Math.cos(J),Q=U*Math.sin(J),tt=Math.abs(K)+Math.abs(Q),et=e[Y+"anchor"],rt=e[Y+"shift"]*(Y==="x"?1:-1),nt=S[Y],at,it,ot,st,lt;if($){var ut=$.r2fraction(e[Y]);if((t._dragging||!$.autorange)&&(ut<0||ut>1)){if(Z===X){ut=$.r2fraction(e["a"+Y]);if(ut<0||ut>1){H=true}}else{H=true}if(H)continue}at=$._offset+$.r2p(e[Y]);st=.5}else{if(Y==="x"){ot=e[Y];at=y.l+y.w*ot}else{ot=1-e[Y];at=y.t+y.h*ot}st=e.showarrow?.5:ot}if(e.showarrow){nt.head=at;var ct=e["a"+Y];lt=K*q(.5,e.xanchor)-Q*q(.5,e.yanchor);if(Z===X){nt.tail=$._offset+$.r2p(ct);it=lt}else{nt.tail=at+ct;it=lt+ct}nt.text=nt.tail+lt;var ft=m[Y==="x"?"width":"height"];if(X==="paper"){nt.head=o.constrain(nt.head,1,ft-1)}if(Z==="pixel"){var ht=-Math.max(nt.tail-3,nt.text),pt=Math.min(nt.tail+3,nt.text)-ft;if(ht>0){nt.tail+=ht;nt.text+=ht}else if(pt>0){nt.tail-=pt;nt.text-=pt}}nt.tail+=rt;nt.head+=rt}else{lt=tt*q(st,et);it=lt;nt.text=at+lt}nt.text+=rt;lt+=rt;it+=rt;e["_"+Y+"padplus"]=tt/2+it;e["_"+Y+"padminus"]=tt/2-it;e["_"+Y+"size"]=tt;e["_"+Y+"shift"]=lt}if(H){P.remove();return}var dt=0;var vt=0;if(e.align!=="left"){dt=(z-_)*(e.align==="center"?.5:1)}if(e.valign!=="top"){vt=(D-w)*(e.valign==="middle"?.5:1)}if(d){c.select("svg").attr({x:R+dt-1,y:R+vt}).call(u.setClipUrl,F?T:null)}else{var gt=R+vt-b.top;var mt=R+dt-b.left;V.call(f.positionText,mt,gt).call(u.setClipUrl,F?T:null)}N.select("rect").call(u.setRect,R,R,z,D);B.call(u.setRect,O/2,O/2,j-O,U-O);P.call(u.setTranslate,Math.round(S.x.text-j/2),Math.round(S.y.text-U/2));L.attr({transform:"rotate("+E+","+S.x.text+","+S.y.text+")"});var yt=function(r,n){C.selectAll(".annotation-arrow-g").remove();var c=S.x.head,f=S.y.head,h=S.x.tail+r,d=S.y.tail+n,m=S.x.text+r,b=S.y.text+n,_=o.rotationXYMatrix(E,m,b),w=o.apply2DTransform(_),T=o.apply2DTransform2(_),I=+B.attr("width"),z=+B.attr("height"),O=m-.5*I,D=O+I,R=b-.5*z,F=R+z,N=[[O,R,O,F],[O,F,D,F],[D,F,D,R],[D,R,O,R]].map(T);if(N.reduce(function(t,e){return t^!!o.segmentsIntersect(c,f,c+1e6,f+1e6,e[0],e[1],e[2],e[3])},false)){return}N.forEach(function(t){var e=o.segmentsIntersect(h,d,c,f,t[0],t[1],t[2],t[3]);if(e){h=e.x;d=e.y}});var j=e.arrowwidth,V=e.arrowcolor,U=e.arrowside;var q=C.append("g").style({opacity:l.opacity(V)}).classed("annotation-arrow-g",true);var H=q.append("path").attr("d","M"+h+","+d+"L"+c+","+f).style("stroke-width",j+"px").call(l.stroke,l.rgb(V));v(H,U,e);if(x.annotationPosition&&H.node().parentNode&&!i){var G=c;var W=f;if(e.standoff){var Y=Math.sqrt(Math.pow(c-h,2)+Math.pow(f-d,2));G+=e.standoff*(h-c)/Y;W+=e.standoff*(d-f)/Y}var X=q.append("path").classed("annotation-arrow",true).classed("anndrag",true).classed("cursor-move",true).attr({d:"M3,3H-3V-3H3ZM0,0L"+(h-G)+","+(d-W),transform:"translate("+G+","+W+")"}).style("stroke-width",j+6+"px").call(l.stroke,"rgba(0,0,0,0)").call(l.fill,"rgba(0,0,0,0)");var Z,$;p.init({element:X.node(),gd:t,prepFn:function(){var t=u.getTranslate(P);Z=t.x;$=t.y;if(s&&s.autorange){k(s._name+".autorange",true)}if(g&&g.autorange){k(g._name+".autorange",true)}},moveFn:function(t,r){var n=w(Z,$),a=n[0]+t,i=n[1]+r;P.call(u.setTranslate,a,i);M("x",s?s.p2r(s.r2p(e.x)+t):e.x+t/y.w);M("y",g?g.p2r(g.r2p(e.y)+r):e.y-r/y.h);if(e.axref===e.xref){M("ax",s.p2r(s.r2p(e.ax)+t))}if(e.ayref===e.yref){M("ay",g.p2r(g.r2p(e.ay)+r))}q.attr("transform","translate("+t+","+r+")");L.attr({transform:"rotate("+E+","+a+","+i+")"})},doneFn:function(){a.call("relayout",t,A());var e=document.querySelector(".js-notes-box-panel");if(e)e.redraw(e.selectedObj)}})}};if(e.showarrow)yt(0,0);if(I){var xt;p.init({element:P.node(),gd:t,prepFn:function(){xt=L.attr("transform")},moveFn:function(t,r){var n="pointer";if(e.showarrow){if(e.axref===e.xref){M("ax",s.p2r(s.r2p(e.ax)+t))}else{M("ax",e.ax+t)}if(e.ayref===e.yref){M("ay",g.p2r(g.r2p(e.ay)+r))}else{M("ay",e.ay+r)}yt(t,r)}else if(!i){var a,o;if(s){a=s.p2r(s.r2p(e.x)+t)}else{var l=e._xsize/y.w,u=e.x+(e._xshift-e.xshift)/y.w-l/2;a=p.align(u+t/y.w,l,0,1,e.xanchor)}if(g){o=g.p2r(g.r2p(e.y)+r)}else{var c=e._ysize/y.h,f=e.y-(e._yshift+e.yshift)/y.h-c/2;o=p.align(f-r/y.h,c,0,1,e.yanchor)}M("x",a);M("y",o);if(!s||!g){n=p.getCursor(s?.5:a,g?.5:o,e.xanchor,e.yanchor)}}else return;L.attr({transform:"translate("+t+","+r+")"+xt});h(P,n)},doneFn:function(){h(P);a.call("relayout",t,A());var e=document.querySelector(".js-notes-box-panel");if(e)e.redraw(e.selectedObj)}})}}if(x.annotationText){V.call(f.makeEditable,{delegate:P,gd:t}).call(U).on("edit",function(r){e.text=r;this.call(U);M("text",r);if(s&&s.autorange){k(s._name+".autorange",true)}if(g&&g.autorange){k(g._name+".autorange",true)}a.call("relayout",t,A())})}else V.call(U)}},{"../../lib":684,"../../lib/setcursor":704,"../../lib/svg_text_utils":708,"../../plot_api/plot_template":722,"../../plots/cartesian/axes":732,"../../plots/plots":795,"../../registry":817,"../color":558,"../dragelement":580,"../drawing":583,"../fx":600,"./draw_arrow_head":548,d3:147}],548:[function(t,e,r){"use strict";var n=t("d3");var a=t("../color");var i=t("./arrow_paths");e.exports=function t(e,r,o){var s=e.node();var l=i[o.arrowhead||0];var u=i[o.startarrowhead||0];var c=(o.arrowwidth||1)*(o.arrowsize||1);var f=(o.arrowwidth||1)*(o.startarrowsize||1);var h=r.indexOf("start")>=0;var p=r.indexOf("end")>=0;var d=l.backoff*c+o.standoff;var v=u.backoff*f+o.startstandoff;var g,m,y,x;if(s.nodeName==="line"){g={x:+e.attr("x1"),y:+e.attr("y1")};m={x:+e.attr("x2"),y:+e.attr("y2")};var b=g.x-m.x;var _=g.y-m.y;y=Math.atan2(_,b);x=y+Math.PI;if(d&&v){if(d+v>Math.sqrt(b*b+_*_)){P();return}}if(d){if(d*d>b*b+_*_){P();return}var w=d*Math.cos(y),k=d*Math.sin(y);m.x+=w;m.y+=k;e.attr({x2:m.x,y2:m.y})}if(v){if(v*v>b*b+_*_){P();return}var M=v*Math.cos(y),A=v*Math.sin(y);g.x-=M;g.y-=A;e.attr({x1:g.x,y1:g.y})}}else if(s.nodeName==="path"){var T=s.getTotalLength(),S="";if(T<d+v){P();return}var E=s.getPointAtLength(0);var C=s.getPointAtLength(.1);y=Math.atan2(E.y-C.y,E.x-C.x);g=s.getPointAtLength(Math.min(v,T));S="0px,"+v+"px,";var L=s.getPointAtLength(T);var I=s.getPointAtLength(T-.1);x=Math.atan2(L.y-I.y,L.x-I.x);m=s.getPointAtLength(Math.max(0,T-d));var z=S?v+d:d;S+=T-z+"px,"+T+"px";e.style("stroke-dasharray",S)}function P(){e.style("stroke-dasharray","0px,100px")}function O(t,r,i,l){if(!t.path)return;if(t.noRotate)i=0;n.select(s.parentNode).append("path").attr({class:e.attr("class"),d:t.path,transform:"translate("+r.x+","+r.y+")"+(i?"rotate("+i*180/Math.PI+")":"")+"scale("+l+")"}).style({fill:a.rgb(o.arrowcolor),"stroke-width":0})}if(h)O(u,g,y,f);if(p)O(l,m,x,c)}},{"../color":558,"./arrow_paths":540,d3:147}],549:[function(t,e,r){"use strict";var n=t("./draw");var a=t("./click");e.exports={moduleType:"component",name:"annotations",layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),includeBasePlot:t("../../plots/cartesian/include_components")("annotations"),calcAutorange:t("./calc_autorange"),draw:n.draw,drawOne:n.drawOne,drawRaw:n.drawRaw,hasClickToShow:a.hasClickToShow,onClick:a.onClick,convertCoords:t("./convert_coords")}},{"../../plots/cartesian/include_components":742,"./attributes":541,"./calc_autorange":542,"./click":543,"./convert_coords":545,"./defaults":546,"./draw":547}],550:[function(t,e,r){"use strict";var n=t("../annotations/attributes");var a=t("../../plot_api/edit_types").overrideAll;var i=t("../../plot_api/plot_template").templatedArray;e.exports=a(i("annotation",{visible:n.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:n.xanchor,xshift:n.xshift,yanchor:n.yanchor,yshift:n.yshift,text:n.text,textangle:n.textangle,font:n.font,width:n.width,height:n.height,opacity:n.opacity,align:n.align,valign:n.valign,bgcolor:n.bgcolor,bordercolor:n.bordercolor,borderpad:n.borderpad,borderwidth:n.borderwidth,showarrow:n.showarrow,arrowcolor:n.arrowcolor,arrowhead:n.arrowhead,startarrowhead:n.startarrowhead,arrowside:n.arrowside,arrowsize:n.arrowsize,startarrowsize:n.startarrowsize,arrowwidth:n.arrowwidth,standoff:n.standoff,startstandoff:n.startstandoff,hovertext:n.hovertext,hoverlabel:n.hoverlabel,captureevents:n.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":715,"../../plot_api/plot_template":722,"../annotations/attributes":541}],551:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/cartesian/axes");e.exports=function t(e){var r=e.fullSceneLayout;var n=r.annotations;for(var a=0;a<n.length;a++){i(n[a],e)}e.fullLayout._infolayer.selectAll(".annotation-"+e.id).remove()};function i(t,e){var r=e.fullSceneLayout;var i=r.domain;var o=e.fullLayout._size;var s={pdata:null,type:"linear",autorange:false,range:[-Infinity,Infinity]};t._xa={};n.extendFlat(t._xa,s);a.setConvert(t._xa);t._xa._offset=o.l+i.x[0]*o.w;t._xa.l2p=function(){return.5*(1+t._pdata[0]/t._pdata[3])*o.w*(i.x[1]-i.x[0])};t._ya={};n.extendFlat(t._ya,s);a.setConvert(t._ya);t._ya._offset=o.t+(1-i.y[1])*o.h;t._ya.l2p=function(){return.5*(1-t._pdata[1]/t._pdata[3])*o.h*(i.y[1]-i.y[0])}}},{"../../lib":684,"../../plots/cartesian/axes":732}],552:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/cartesian/axes");var i=t("../../plots/array_container_defaults");var o=t("../annotations/common_defaults");var s=t("./attributes");e.exports=function t(e,r,n){i(e,r,{name:"annotations",handleItemDefaults:l,fullLayout:n.fullLayout})};function l(t,e,r,i){function l(r,a){return n.coerce(t,e,s,r,a)}function u(t){var n=t+"axis";var i={_fullLayout:{}};i._fullLayout[n]=r[n];return a.coercePosition(e,i,l,t,t,.5)}var c=l("visible");if(!c)return;o(t,e,i.fullLayout,l);u("x");u("y");u("z");n.noneOrAll(t,e,["x","y","z"]);e.xref="x";e.yref="y";e.zref="z";l("xanchor");l("yanchor");l("xshift");l("yshift");if(e.showarrow){e.axref="pixel";e.ayref="pixel";l("ax",-10);l("ay",-30);n.noneOrAll(t,e,["ax","ay"])}}},{"../../lib":684,"../../plots/array_container_defaults":728,"../../plots/cartesian/axes":732,"../annotations/common_defaults":544,"./attributes":550}],553:[function(t,e,r){"use strict";var n=t("../annotations/draw").drawRaw;var a=t("../../plots/gl3d/project");var i=["x","y","z"];e.exports=function t(e){var r=e.fullSceneLayout;var o=e.dataScale;var s=r.annotations;for(var l=0;l<s.length;l++){var u=s[l];var c=false;for(var f=0;f<3;f++){var h=i[f];var p=u[h];var d=r[h+"axis"];var v=d.r2fraction(p);if(v<0||v>1){c=true;break}}if(c){e.fullLayout._infolayer.select(".annotation-"+e.id+'[data-index="'+l+'"]').remove()}else{u._pdata=a(e.glplot.cameraParams,[r.xaxis.r2l(u.x)*o[0],r.yaxis.r2l(u.y)*o[1],r.zaxis.r2l(u.z)*o[2]]);n(e.graphDiv,u,l,e.id,u._xa,u._ya)}}}},{"../../plots/gl3d/project":783,"../annotations/draw":547}],554:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");e.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:t("./attributes")}}},layoutAttributes:t("./attributes"),handleDefaults:t("./defaults"),includeBasePlot:i,convert:t("./convert"),draw:t("./draw")};function i(t,e){var r=n.subplotsRegistry.gl3d;if(!r)return;var i=r.attrRegex;var o=Object.keys(t);for(var s=0;s<o.length;s++){var l=o[s];if(i.test(l)&&(t[l].annotations||[]).length){a.pushUnique(e._basePlotModules,r);a.pushUnique(e._subplots.gl3d,l)}}}},{"../../lib":684,"../../registry":817,"./attributes":550,"./convert":551,"./defaults":552,"./draw":553}],555:[function(t,e,r){"use strict";e.exports=t("world-calendars/dist/main");t("world-calendars/dist/plus");t("world-calendars/dist/calendars/chinese");t("world-calendars/dist/calendars/coptic");t("world-calendars/dist/calendars/discworld");t("world-calendars/dist/calendars/ethiopian");t("world-calendars/dist/calendars/hebrew");t("world-calendars/dist/calendars/islamic");t("world-calendars/dist/calendars/julian");t("world-calendars/dist/calendars/mayan");t("world-calendars/dist/calendars/nanakshahi");t("world-calendars/dist/calendars/nepali");t("world-calendars/dist/calendars/persian");t("world-calendars/dist/calendars/taiwan");t("world-calendars/dist/calendars/thai");t("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":522,"world-calendars/dist/calendars/coptic":523,"world-calendars/dist/calendars/discworld":524,"world-calendars/dist/calendars/ethiopian":525,"world-calendars/dist/calendars/hebrew":526,"world-calendars/dist/calendars/islamic":527,"world-calendars/dist/calendars/julian":528,"world-calendars/dist/calendars/mayan":529,"world-calendars/dist/calendars/nanakshahi":530,"world-calendars/dist/calendars/nepali":531,"world-calendars/dist/calendars/persian":532,"world-calendars/dist/calendars/taiwan":533,"world-calendars/dist/calendars/thai":534,"world-calendars/dist/calendars/ummalqura":535,"world-calendars/dist/main":536,"world-calendars/dist/plus":537}],556:[function(t,e,r){"use strict";var n=t("./calendars");var a=t("../../lib");var i=t("../../constants/numerical");var o=i.EPOCHJD;var s=i.ONEDAY;var l={valType:"enumerated",values:Object.keys(n.calendars),editType:"calc",dflt:"gregorian"};var u=function(t,e,r,n){var i={};i[r]=l;return a.coerce(t,e,i,r,n)};var c=function(t,e,r,n){for(var a=0;a<r.length;a++){u(t,e,r[a]+"calendar",n.calendar)}};var f={chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"};var h={chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"};var p={chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]};var d="##";var v={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:d,w:d,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}};function g(t,e,r){var n=Math.floor((e+.05)/s)+o,a=y(r).fromJD(n),i=0,l,u,c,f,h;while((i=t.indexOf("%",i))!==-1){l=t.charAt(i+1);if(l==="0"||l==="-"||l==="_"){c=3;u=t.charAt(i+2);if(l==="_")l="-"}else{u=l;l="0";c=2}f=v[u];if(!f){i+=c}else{if(f===d)h=d;else h=a.formatDate(f[l]);t=t.substr(0,i)+h+t.substr(i+c);i+=h.length}}return t}var m={};function y(t){var e=m[t];if(e)return e;e=m[t]=n.instance(t);return e}function x(t){return a.extendFlat({},l,{description:t})}function b(t){return"Sets the calendar system to use with `"+t+"` date data."}var _={xcalendar:x(b("x"))};var w=a.extendFlat({},_,{ycalendar:x(b("y"))});var k=a.extendFlat({},w,{zcalendar:x(b("z"))});var M=x(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));e.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:w,bar:w,box:w,heatmap:w,contour:w,histogram:w,histogram2d:w,histogram2dcontour:w,scatter3d:k,surface:k,mesh3d:k,scattergl:w,ohlc:_,candlestick:_},layout:{calendar:x(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:M},yaxis:{calendar:M},scene:{xaxis:{calendar:M},yaxis:{calendar:M},zaxis:{calendar:M}},polar:{radialaxis:{calendar:M}}},transforms:{filter:{valuecalendar:x(["Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:x(["Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:l,handleDefaults:u,handleTraceDefaults:c,CANONICAL_SUNDAY:h,CANONICAL_TICK:f,DFLTRANGE:p,getCal:y,worldCalFmt:g}},{"../../constants/numerical":661,"../../lib":684,"./calendars":555}],557:[function(t,e,r){"use strict";r.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];r.defaultLine="#444";r.lightLine="#eee";r.background="#fff";r.borderLine="#BEC8D9";r.lightFraction=100*(14-4)/(15-4)},{}],558:[function(t,e,r){"use strict";var n=t("tinycolor2");var a=t("fast-isnumeric");var i=e.exports={};var o=t("./attributes");i.defaults=o.defaults;var s=i.defaultLine=o.defaultLine;i.lightLine=o.lightLine;var l=i.background=o.background;i.tinyRGB=function(t){var e=t.toRgb();return"rgb("+Math.round(e.r)+", "+Math.round(e.g)+", "+Math.round(e.b)+")"};i.rgb=function(t){return i.tinyRGB(n(t))};i.opacity=function(t){return t?n(t).getAlpha():0};i.addOpacity=function(t,e){var r=n(t).toRgb();return"rgba("+Math.round(r.r)+", "+Math.round(r.g)+", "+Math.round(r.b)+", "+e+")"};i.combine=function(t,e){var r=n(t).toRgb();if(r.a===1)return n(t).toRgbString();var a=n(e||l).toRgb(),i=a.a===1?a:{r:255*(1-a.a)+a.r*a.a,g:255*(1-a.a)+a.g*a.a,b:255*(1-a.a)+a.b*a.a},o={r:i.r*(1-r.a)+r.r*r.a,g:i.g*(1-r.a)+r.g*r.a,b:i.b*(1-r.a)+r.b*r.a};return n(o).toRgbString()};i.contrast=function(t,e,r){var a=n(t);if(a.getAlpha()!==1)a=n(i.combine(t,l));var o=a.isDark()?e?a.lighten(e):l:r?a.darken(r):s;return o.toString()};i.stroke=function(t,e){var r=n(e);t.style({stroke:i.tinyRGB(r),"stroke-opacity":r.getAlpha()})};i.fill=function(t,e){var r=n(e);t.style({fill:i.tinyRGB(r),"fill-opacity":r.getAlpha()})};i.clean=function(t){if(!t||typeof t!=="object")return;var e=Object.keys(t),r,n,a,o;for(r=0;r<e.length;r++){a=e[r];o=t[a];if(a.substr(a.length-5)==="color"){if(Array.isArray(o)){for(n=0;n<o.length;n++)o[n]=u(o[n])}else t[a]=u(o)}else if(a.substr(a.length-10)==="colorscale"&&Array.isArray(o)){for(n=0;n<o.length;n++){if(Array.isArray(o[n]))o[n][1]=u(o[n][1])}}else if(Array.isArray(o)){var s=o[0];if(!Array.isArray(s)&&s&&typeof s==="object"){for(n=0;n<o.length;n++)i.clean(o[n])}}else if(o&&typeof o==="object")i.clean(o)}};function u(t){if(a(t)||typeof t!=="string")return t;var e=t.trim();if(e.substr(0,3)!=="rgb")return t;var r=e.match(/^rgba?\s*\(([^()]*)\)$/);if(!r)return t;var n=r[1].trim().split(/\s*[\s,]\s*/),i=e.charAt(3)==="a"&&n.length===4;if(!i&&n.length!==3)return t;for(var o=0;o<n.length;o++){if(!n[o].length)return t;n[o]=Number(n[o]);if(!(n[o]>=0))return t;if(o===3){if(n[o]>1)n[o]=1}else if(n[o]>=1)return t}var s=Math.round(n[0]*255)+", "+Math.round(n[1]*255)+", "+Math.round(n[2]*255);if(i)return"rgba("+s+", "+n[3]+")";return"rgb("+s+")"}},{"./attributes":557,"fast-isnumeric":214,tinycolor2:499}],559:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/layout_attributes");var a=t("../../plots/font_attributes");var i=t("../../lib/extend").extendFlat;var o=t("../../plot_api/edit_types").overrideAll;e.exports=o({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:n.linecolor,outlinewidth:n.linewidth,bordercolor:n.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:i({},n.ticks,{dflt:""}),ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,showticklabels:n.showticklabels,tickfont:a({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,showexponent:n.showexponent,title:{valType:"string"},titlefont:a({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},"colorbars","from-root")},{"../../lib/extend":673,"../../plot_api/edit_types":715,"../../plots/cartesian/layout_attributes":744,"../../plots/font_attributes":758}],560:[function(t,e,r){"use strict";var n=t("../colorscale");var a=t("./draw");e.exports=function t(e,r,i){if(typeof i==="function")return i(e,r);var o=r[0].trace;var s="cb"+o.uid;var l=i.container;var u=l?o[l]:o;e._fullLayout._infolayer.selectAll("."+s).remove();if(!u||!u.showscale)return;var c=u[i.min];var f=u[i.max];var h=r[0].t.cb=a(e,s);var p=n.makeColorScaleFunc(n.extractScale(u.colorscale,c,f),{noNumericCheck:true});h.fillcolor(p).filllevels({start:c,end:f,size:(f-c)/254}).options(u.colorbar)()}},{"../colorscale":573,"./draw":563}],561:[function(t,e,r){"use strict";e.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],562:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plot_api/plot_template");var i=t("../../plots/cartesian/tick_value_defaults");var o=t("../../plots/cartesian/tick_mark_defaults");var s=t("../../plots/cartesian/tick_label_defaults");var l=t("./attributes");e.exports=function t(e,r,u){var c=a.newContainer(r,"colorbar"),f=e.colorbar||{};function h(t,e){return n.coerce(f,c,l,t,e)}var p=h("thicknessmode");h("thickness",p==="fraction"?30/(u.width-u.margin.l-u.margin.r):30);var d=h("lenmode");h("len",d==="fraction"?1:u.height-u.margin.t-u.margin.b);h("x");h("xanchor");h("xpad");h("y");h("yanchor");h("ypad");n.noneOrAll(f,c,["x","y"]);h("outlinecolor");h("outlinewidth");h("bordercolor");h("borderwidth");h("bgcolor");i(f,c,h,"linear");var v={outerTicks:false,font:u.font};s(f,c,h,"linear",v);o(f,c,h,"linear",v);h("title",u._dfltTitle.colorbar);n.coerceFont(h,"titlefont",u.font);h("titleside")}},{"../../lib":684,"../../plot_api/plot_template":722,"../../plots/cartesian/tick_label_defaults":751,"../../plots/cartesian/tick_mark_defaults":752,"../../plots/cartesian/tick_value_defaults":753,"./attributes":559}],563:[function(t,e,r){"use strict";var n=t("d3");var a=t("tinycolor2");var i=t("../../plots/plots");var o=t("../../registry");var s=t("../../plots/cartesian/axes");var l=t("../dragelement");var u=t("../../lib");var c=t("../../lib/extend").extendFlat;var f=t("../../lib/setcursor");var h=t("../drawing");var p=t("../color");var d=t("../titles");var v=t("../../lib/svg_text_utils");var g=t("../../constants/alignment");var m=g.LINE_SPACING;var y=g.FROM_TL;var x=g.FROM_BR;var b=t("../../plots/cartesian/axis_defaults");var _=t("../../plots/cartesian/position_defaults");var w=t("../../plots/cartesian/layout_attributes");var k=t("./attributes");var M=t("./constants").cn;e.exports=function t(e,r){var g={};Object.keys(k).forEach(function(t){g[t]=null});g.fillcolor=null;g.line={color:null,width:null,dash:null};g.levels={start:null,end:null,size:null};g.filllevels=null;function A(){var t=e._fullLayout,k=t._size;if(typeof g.fillcolor!=="function"&&typeof g.line.color!=="function"){t._infolayer.selectAll("g."+r).remove();return}var S=n.extent((typeof g.fillcolor==="function"?g.fillcolor:g.line.color).domain());var E=[];var C=[];var L=typeof g.line.color==="function"?g.line.color:function(){return g.line.color};var I=typeof g.fillcolor==="function"?g.fillcolor:function(){return g.fillcolor};var z;var P;var O=g.levels.end+g.levels.size/100,D=g.levels.size,R=1.001*S[0]-.001*S[1],B=1.001*S[1]-.001*S[0];for(P=0;P<1e5;P++){z=g.levels.start+P*D;if(D>0?z>=O:z<=O)break;if(z>R&&z<B)E.push(z)}if(typeof g.fillcolor==="function"){if(g.filllevels){O=g.filllevels.end+g.filllevels.size/100;D=g.filllevels.size;for(P=0;P<1e5;P++){z=g.filllevels.start+P*D;if(D>0?z>=O:z<=O)break;if(z>S[0]&&z<S[1])C.push(z)}}else{C=E.map(function(t){return t-g.levels.size/2});C.push(C[C.length-1]+g.levels.size)}}else if(g.fillcolor&&typeof g.fillcolor==="string"){C=[0]}if(g.levels.size<0){E.reverse();C.reverse()}var F=k.h,N=k.w,j=Math.round(g.thickness*(g.thicknessmode==="fraction"?N:1)),V=j/k.w,U=Math.round(g.len*(g.lenmode==="fraction"?F:1)),q=U/k.h,H=g.xpad/k.w,G=(g.borderwidth+g.outlinewidth)/2,W=g.ypad/k.h,Y=Math.round(g.x*k.w+g.xpad),X=g.x-V*({middle:.5,right:1}[g.xanchor]||0),Z=g.y+q*(({top:-.5,bottom:.5}[g.yanchor]||0)-.5),$=Math.round(k.h*(1-Z)),J=$-U,K,Q={type:"linear",range:S,tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:g.ticks,ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,showticklabels:g.showticklabels,tickfont:g.tickfont,tickangle:g.tickangle,tickformat:g.tickformat,exponentformat:g.exponentformat,separatethousands:g.separatethousands,showexponent:g.showexponent,showtickprefix:g.showtickprefix,tickprefix:g.tickprefix,showticksuffix:g.showticksuffix,ticksuffix:g.ticksuffix,title:g.title,titlefont:g.titlefont,showline:true,anchor:"free",position:1},tt={type:"linear",_id:"y"+r},et={letter:"y",font:t.font,noHover:true,calendar:t.calendar};function rt(t,e){return u.coerce(Q,tt,w,t,e)}b(Q,tt,rt,et,t);_(Q,tt,rt,et);tt.position=g.x+H+V;A.axis=tt;if(["top","bottom"].indexOf(g.titleside)!==-1){tt.titleside=g.titleside;tt.titlex=g.x+H;tt.titley=Z+(g.titleside==="top"?q-W:W)}if(g.line.color&&g.tickmode==="auto"){tt.tickmode="linear";tt.tick0=g.levels.start;var nt=g.levels.size;var at=u.constrain(($-J)/50,4,15)+1,it=(S[1]-S[0])/((g.nticks||at)*nt);if(it>1){var ot=Math.pow(10,Math.floor(Math.log(it)/Math.LN10));nt*=ot*u.roundUp(it/ot,[2,5,10]);if((Math.abs(g.levels.start)/g.levels.size+1e-6)%1<2e-6){tt.tick0=0}}tt.dtick=nt}tt.domain=[Z+W,Z+q-W];tt.setScale();var st=u.ensureSingle(t._infolayer,"g",r,function(t){t.classed(M.colorbar,true).each(function(){var t=n.select(this);t.append("rect").classed(M.cbbg,true);t.append("g").classed(M.cbfills,true);t.append("g").classed(M.cblines,true);t.append("g").classed(M.cbaxis,true).classed(M.crisp,true);t.append("g").classed(M.cbtitleunshift,true).append("g").classed(M.cbtitle,true);t.append("rect").classed(M.cboutline,true);t.select(".cbtitle").datum(0)})});st.attr("transform","translate("+Math.round(k.l)+","+Math.round(k.t)+")");var lt=st.select(".cbtitleunshift").attr("transform","translate(-"+Math.round(k.l)+",-"+Math.round(k.t)+")");tt._axislayer=st.select(".cbaxis");var ut=0;if(["top","bottom"].indexOf(g.titleside)!==-1){var ct=k.l+(g.x+H)*k.w,ft=tt.titlefont.size,ht;if(g.titleside==="top"){ht=(1-(Z+q-W))*k.h+k.t+3+ft*.75}else{ht=(1-(Z+W))*k.h+k.t-3-ft*.25}dt(tt._id+"title",{attributes:{x:ct,y:ht,"text-anchor":"start"}})}function pt(){if(["top","bottom"].indexOf(g.titleside)!==-1){var r=st.select(".cbtitle"),i=r.select("text"),o=[-g.outlinewidth/2,g.outlinewidth/2],l=r.select(".h"+tt._id+"title-math-group").node(),c=15.6;if(i.node()){c=parseInt(i.node().style.fontSize,10)*m}if(l){ut=h.bBox(l).height;if(ut>c){o[1]-=(ut-c)/2}}else if(i.node()&&!i.classed(M.jsPlaceholder)){ut=h.bBox(i.node()).height}if(ut){ut+=5;if(g.titleside==="top"){tt.domain[1]-=ut/k.h;o[1]*=-1}else{tt.domain[0]+=ut/k.h;var f=v.lineCount(i);o[1]+=(1-f)*c}r.attr("transform","translate("+o+")");tt.setScale()}}st.selectAll(".cbfills,.cblines").attr("transform","translate(0,"+Math.round(k.h*(1-tt.domain[1]))+")");tt._axislayer.attr("transform","translate(0,"+Math.round(-k.t)+")");var p=st.select(".cbfills").selectAll("rect.cbfill").data(C);p.enter().append("rect").classed(M.cbfill,true).style("stroke","none");p.exit().remove();p.each(function(t,e){var r=[e===0?S[0]:(C[e]+C[e-1])/2,e===C.length-1?S[1]:(C[e]+C[e+1])/2].map(tt.c2p).map(Math.round);if(e!==C.length-1){r[1]+=r[1]>r[0]?1:-1}var i=I(t).replace("e-",""),o=a(i).toHexString();n.select(this).attr({x:Y,width:Math.max(j,2),y:n.min(r),height:Math.max(n.max(r)-n.min(r),2),fill:o})});var d=st.select(".cblines").selectAll("path.cbline").data(g.line.color&&g.line.width?E:[]);d.enter().append("path").classed(M.cbline,true);d.exit().remove();d.each(function(t){n.select(this).attr("d","M"+Y+","+(Math.round(tt.c2p(t))+g.line.width/2%1)+"h"+j).call(h.lineGroupStyle,g.line.width,L(t),g.line.dash)});tt._axislayer.selectAll("g."+tt._id+"tick,path").remove();tt._pos=Y+j+(g.outlinewidth||0)/2-(g.ticks==="outside"?1:0);tt.side="right";return u.syncOrAsync([function(){return s.doTicksSingle(e,tt,true)},function(){if(["top","bottom"].indexOf(g.titleside)===-1){var r=tt.titlefont.size,a=tt._offset+tt._length/2,i=k.l+(tt.position||0)*k.w+(tt.side==="right"?10+r*(tt.showticklabels?1:.5):-10-r*(tt.showticklabels?.5:0));dt("h"+tt._id+"title",{avoid:{selection:n.select(e).selectAll("g."+tt._id+"tick"),side:g.titleside,offsetLeft:k.l,offsetTop:0,maxShift:t.width},attributes:{x:i,y:a,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}}])}function dt(r,n){var a=T();var i="colorbar.title";var o=a._module.colorbar.container;if(o)i=o+"."+i;var s={propContainer:tt,propName:i,traceIndex:a.index,placeholder:t._dfltTitle.colorbar,containerGroup:st.select(".cbtitle")};var l=r.charAt(0)==="h"?r.substr(1):"h"+r;st.selectAll("."+l+",."+l+"-math-group").remove();d.draw(e,r,c(s,n||{}))}function vt(){var t=j+g.outlinewidth/2+h.bBox(tt._axislayer.node()).width;K=lt.select("text");if(K.node()&&!K.classed(M.jsPlaceholder)){var n=lt.select(".h"+tt._id+"title-math-group").node(),a;if(n&&["top","bottom"].indexOf(g.titleside)!==-1){a=h.bBox(n).width}else{a=h.bBox(lt.node()).right-Y-k.l}t=Math.max(t,a)}var o=2*g.xpad+t+g.borderwidth+g.outlinewidth/2,s=$-J;st.select(".cbbg").attr({x:Y-g.xpad-(g.borderwidth+g.outlinewidth)/2,y:J-G,width:Math.max(o,2),height:Math.max(s+2*G,2)}).call(p.fill,g.bgcolor).call(p.stroke,g.bordercolor).style({"stroke-width":g.borderwidth});st.selectAll(".cboutline").attr({x:Y,y:J+g.ypad+(g.titleside==="top"?ut:0),width:Math.max(j,2),height:Math.max(s-2*g.ypad-ut,2)}).call(p.stroke,g.outlinecolor).style({fill:"None","stroke-width":g.outlinewidth});var l=({center:.5,right:1}[g.xanchor]||0)*o;st.attr("transform","translate("+(k.l-l)+","+k.t+")");var u={};var c=y[g.yanchor];var f=x[g.yanchor];if(g.lenmode==="pixels"){u.y=g.y;u.t=s*c;u.b=s*f}else{u.t=u.b=0;u.yt=g.y+g.len*c;u.yb=g.y-g.len*f}var d=y[g.xanchor];var v=x[g.xanchor];if(g.thicknessmode==="pixels"){u.x=g.x;u.l=o*d;u.r=o*v}else{var m=o-j;u.l=m*d;u.r=m*v;u.xl=g.x-g.thickness*d;u.xr=g.x+g.thickness*v}i.autoMargin(e,r,u)}var gt=u.syncOrAsync([i.previousPromises,pt,i.previousPromises,vt],e);if(gt&&gt.then)(e._promises||[]).push(gt);if(e._context.edits.colorbarPosition){var mt,yt,xt;l.init({element:st.node(),gd:e,prepFn:function(){mt=st.attr("transform");f(st)},moveFn:function(t,e){st.attr("transform",mt+" "+"translate("+t+","+e+")");yt=l.align(X+t/k.w,V,0,1,g.xanchor);xt=l.align(Z-e/k.h,q,0,1,g.yanchor);var r=l.getCursor(yt,xt,g.xanchor,g.yanchor);f(st,r)},doneFn:function(){f(st);if(yt!==undefined&&xt!==undefined){o.call("restyle",e,{"colorbar.x":yt,"colorbar.y":xt},T().index)}}})}return gt}function T(){var t=r.substr(2),n,a;for(n=0;n<e._fullData.length;n++){a=e._fullData[n];if(a.uid===t)return a}}Object.keys(g).forEach(function(t){A[t]=function(e){if(!arguments.length)return g[t];g[t]=u.isPlainObject(g[t])?u.extendFlat(g[t],e):e;return A}});A.options=function(t){Object.keys(t).forEach(function(e){if(typeof A[e]==="function"){A[e](t[e])}});return A};A._opts=g;return A}},{"../../constants/alignment":656,"../../lib":684,"../../lib/extend":673,"../../lib/setcursor":704,"../../lib/svg_text_utils":708,"../../plots/cartesian/axes":732,"../../plots/cartesian/axis_defaults":734,"../../plots/cartesian/layout_attributes":744,"../../plots/cartesian/position_defaults":747,"../../plots/plots":795,"../../registry":817,"../color":558,"../dragelement":580,"../drawing":583,"../titles":649,"./attributes":559,"./constants":561,d3:147,tinycolor2:499}],564:[function(t,e,r){"use strict";var n=t("../../lib");e.exports=function t(e){return n.isPlainObject(e.colorbar)}},{"../../lib":684}],565:[function(t,e,r){"use strict";var n=t("./scales.js");var a=Object.keys(n);function i(t){return"`"+t+"`"}e.exports=function t(e,r){e=e||"";r=r||{};var a=r.cLetter||"c";var o="onlyIfNumerical"in r?r.onlyIfNumerical:Boolean(e);var s="noScale"in r?r.noScale:e==="marker.line";var l="showScaleDflt"in r?r.showScaleDflt:a==="z";var u=typeof r.colorscaleDflt==="string"?n[r.colorscaleDflt]:null;var c=r.editTypeOverride||"";var f=e?e+".":"";var h,p;if("colorAttr"in r){h=r.colorAttr;p=r.colorAttr}else{h={z:"z",c:"color"}[a];p="in "+i(f+h)}var d=o?" Has an effect only if "+p+"is set to a numerical array.":"";var v=a+"auto";var g=a+"min";var m=a+"max";var y=i(f+g);var x=i(f+m);var b=y+" and "+x;var _={};_[g]=_[m]=undefined;var w={};w[v]=false;var k={};if(h==="color"){k.color={valType:"color",arrayOk:true,editType:c||"style"}}k[v]={valType:"boolean",dflt:true,editType:"calc",impliedEdits:_};k[g]={valType:"number",dflt:null,editType:c||"plot",impliedEdits:w};k[m]={valType:"number",dflt:null,editType:c||"plot",impliedEdits:w};k.colorscale={valType:"colorscale",editType:"calc",dflt:u,impliedEdits:{autocolorscale:false}};k.autocolorscale={valType:"boolean",dflt:r.autoColorDflt===false?false:true,editType:"calc",impliedEdits:{colorscale:undefined}};k.reversescale={valType:"boolean",dflt:false,editType:"calc"};if(!s){k.showscale={valType:"boolean",dflt:l,editType:"calc"}}return k}},{"./scales.js":577}],566:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./scales");var i=t("./flip_scale");e.exports=function t(e,r,o,s){var l=e;var u=e._input;var c=e._fullInput;var f=e.updateStyle;function h(t,r,n){if(n===undefined)n=r;if(f){f(e._input,o?o+"."+t:t,r)}else{u[t]=r}l[t]=n;if(c&&e!==e._fullInput){if(f){f(e._fullInput,o?o+"."+t:t,n)}else{c[t]=n}}}if(o){l=n.nestedProperty(l,o).get();u=n.nestedProperty(u,o).get();c=n.nestedProperty(c,o).get()||{}}var p=s+"auto";var d=s+"min";var v=s+"max";var g=l[p];var m=l[d];var y=l[v];var x=l.colorscale;if(g!==false||m===undefined){m=n.aggNums(Math.min,null,r)}if(g!==false||y===undefined){y=n.aggNums(Math.max,null,r)}if(m===y){m-=.5;y+=.5}h(d,m);h(v,y);h(p,g!==false||m===undefined&&y===undefined);if(l.autocolorscale){if(m*y<0)x=a.RdBu;else if(m>=0)x=a.Reds;else x=a.Blues;h("colorscale",x,l.reversescale?i(x):x);if(!u.autocolorscale){h("autocolorscale",false)}}}},{"../../lib":684,"./flip_scale":570,"./scales":577}],567:[function(t,e,r){"use strict";var n=t("./scales");e.exports=n.RdBu},{"./scales":577}],568:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib");var i=t("../colorbar/has_colorbar");var o=t("../colorbar/defaults");var s=t("./is_valid_scale");var l=t("./flip_scale");e.exports=function t(e,r,u,c,f){var h=f.prefix,p=f.cLetter,d=h.slice(0,h.length-1),v=h?a.nestedProperty(e,d).get()||{}:e,g=h?a.nestedProperty(r,d).get()||{}:r,m=v[p+"min"],y=v[p+"max"],x=v.colorscale;var b=n(m)&&n(y)&&m<y;c(h+p+"auto",!b);c(h+p+"min");c(h+p+"max");var _;if(x!==undefined)_=!s(x);c(h+"autocolorscale",_);var w=c(h+"colorscale");var k=c(h+"reversescale");if(k)g.colorscale=l(w);if(h==="marker.line.")return;var M;if(h)M=i(v);var A=c(h+"showscale",M);if(A)o(v,g,u)}},{"../../lib":684,"../colorbar/defaults":562,"../colorbar/has_colorbar":564,"./flip_scale":570,"./is_valid_scale":574,"fast-isnumeric":214}],569:[function(t,e,r){"use strict";e.exports=function t(e,r,n){var a=e.length,i=new Array(a),o=new Array(a);for(var s=0;s<a;s++){var l=e[s];i[s]=r+l[0]*(n-r);o[s]=l[1]}return{domain:i,range:o}}},{}],570:[function(t,e,r){"use strict";e.exports=function t(e){var r=e.length,n=new Array(r),a;for(var i=r-1,o=0;i>=0;i--,o++){a=e[i];n[o]=[1-a[0],a[1]]}return n}},{}],571:[function(t,e,r){"use strict";var n=t("./scales");var a=t("./default_scale");var i=t("./is_valid_scale_array");e.exports=function t(e,r){if(!r)r=a;if(!e)return r;function o(){try{e=n[e]||JSON.parse(e)}catch(t){e=r}}if(typeof e==="string"){o();if(typeof e==="string")o()}if(!i(e))return r;return e}},{"./default_scale":567,"./is_valid_scale_array":575,"./scales":577}],572:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib");var i=t("./is_valid_scale");e.exports=function t(e,r){var o=r?a.nestedProperty(e,r).get()||{}:e;var s=o.color;var l=false;if(a.isArrayOrTypedArray(s)){for(var u=0;u<s.length;u++){if(n(s[u])){l=true;break}}}return a.isPlainObject(o)&&(l||o.showscale===true||n(o.cmin)&&n(o.cmax)||i(o.colorscale)||a.isPlainObject(o.colorbar))}},{"../../lib":684,"./is_valid_scale":574,"fast-isnumeric":214}],573:[function(t,e,r){"use strict";r.scales=t("./scales");r.defaultScale=t("./default_scale");r.attributes=t("./attributes");r.handleDefaults=t("./defaults");r.calc=t("./calc");r.hasColorscale=t("./has_colorscale");r.isValidScale=t("./is_valid_scale");r.getScale=t("./get_scale");r.flipScale=t("./flip_scale");r.extractScale=t("./extract_scale");r.makeColorScaleFunc=t("./make_color_scale_func")},{"./attributes":565,"./calc":566,"./default_scale":567,"./defaults":568,"./extract_scale":569,"./flip_scale":570,"./get_scale":571,"./has_colorscale":572,"./is_valid_scale":574,"./make_color_scale_func":576,"./scales":577}],574:[function(t,e,r){"use strict";var n=t("./scales");var a=t("./is_valid_scale_array");e.exports=function t(e){if(n[e]!==undefined)return true;else return a(e)}},{"./is_valid_scale_array":575,"./scales":577}],575:[function(t,e,r){"use strict";var n=t("tinycolor2");e.exports=function t(e){var r=0;if(!Array.isArray(e)||e.length<2)return false;if(!e[0]||!e[e.length-1])return false;if(+e[0][0]!==0||+e[e.length-1][0]!==1)return false;for(var a=0;a<e.length;a++){var i=e[a];if(i.length!==2||+i[0]<r||!n(i[1]).isValid()){return false}r=+i[0]}return true}},{tinycolor2:499}],576:[function(t,e,r){"use strict";var n=t("d3");var a=t("tinycolor2");var i=t("fast-isnumeric");var o=t("../color");e.exports=function t(e,r){r=r||{};var l=e.domain,u=e.range,c=u.length,f=new Array(c);for(var h=0;h<c;h++){var p=a(u[h]).toRgb();f[h]=[p.r,p.g,p.b,p.a]}var d=n.scale.linear().domain(l).range(f).clamp(true);var v=r.noNumericCheck,g=r.returnArray,m;if(v&&g){m=d}else if(v){m=function(t){return s(d(t))}}else if(g){m=function(t){if(i(t))return d(t);else if(a(t).isValid())return t;else return o.defaultLine}}else{m=function(t){if(i(t))return s(d(t));else if(a(t).isValid())return t;else return o.defaultLine}}m.domain=d.domain;m.range=function(){return u};return m};function s(t){var e={r:t[0],g:t[1],b:t[2],a:t[3]};return a(e).toRgbString()}},{"../color":558,d3:147,"fast-isnumeric":214,tinycolor2:499}],577:[function(t,e,r){"use strict";e.exports={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]}},{}],578:[function(t,e,r){"use strict";e.exports=function t(e,r,n,a,i){var o=(e-n)/(a-n),s=o+r/(a-n),l=(o+s)/2;if(i==="left"||i==="bottom")return o;if(i==="center"||i==="middle")return l;if(i==="right"||i==="top")return s;if(o<2/3-l)return o;if(s>4/3-l)return s;return l}},{}],579:[function(t,e,r){"use strict";var n=t("../../lib");var a=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];e.exports=function t(e,r,i,o){if(i==="left")e=0;else if(i==="center")e=1;else if(i==="right")e=2;else e=n.constrain(Math.floor(e*3),0,2);if(o==="bottom")r=0;else if(o==="middle")r=1;else if(o==="top")r=2;else r=n.constrain(Math.floor(r*3),0,2);return a[r][e]}},{"../../lib":684}],580:[function(t,e,r){"use strict";var n=t("mouse-event-offset");var a=t("has-hover");var i=t("has-passive-events");var o=t("../../registry");var s=t("../../lib");var l=t("../../plots/cartesian/constants");var u=t("../../constants/interactions");var c=e.exports={};c.align=t("./align");c.getCursor=t("./cursor");var f=t("./unhover");c.unhover=f.wrapped;c.unhoverRaw=f.raw;c.init=function t(e){var r=e.gd;var n=1;var o=u.DBLCLICKDELAY;var f=e.element;var v,g,m,y,x,b,_,w;if(!r._mouseDownTime)r._mouseDownTime=0;f.style.pointerEvents="all";f.onmousedown=A;if(!i){f.ontouchstart=A}else{if(f._ontouchstart){f.removeEventListener("touchstart",f._ontouchstart)}f._ontouchstart=A;f.addEventListener("touchstart",A,{passive:false})}function k(t,e,r){if(Math.abs(t)<r)t=0;if(Math.abs(e)<r)e=0;return[t,e]}var M=e.clampFn||k;function A(t){t.preventDefault();r._dragged=false;r._dragging=true;var i=d(t);v=i[0];g=i[1];_=t.target;b=t;w=t.buttons===2||t.ctrlKey;m=(new Date).getTime();if(m-r._mouseDownTime<o){n+=1}else{n=1;r._mouseDownTime=m}if(e.prepFn)e.prepFn(t,v,g);if(a&&!w){x=h();x.style.cursor=window.getComputedStyle(f).cursor}else if(!a){x=document;y=window.getComputedStyle(document.documentElement).cursor;document.documentElement.style.cursor=window.getComputedStyle(f).cursor}document.addEventListener("mousemove",T);document.addEventListener("mouseup",S);document.addEventListener("touchmove",T);document.addEventListener("touchend",S);return}function T(t){t.preventDefault();var n=d(t);var a=e.minDrag||l.MINDRAG;var i=M(n[0]-v,n[1]-g,a);var o=i[0];var s=i[1];if(o||s){r._dragged=true;c.unhover(r)}if(r._dragged&&e.moveFn&&!w)e.moveFn(o,s);return}function S(t){document.removeEventListener("mousemove",T);document.removeEventListener("mouseup",S);document.removeEventListener("touchmove",T);document.removeEventListener("touchend",S);t.preventDefault();if(a){s.removeElement(x)}else if(y){x.documentElement.style.cursor=y;y=null}if(!r._dragging){r._dragged=false;return}r._dragging=false;if((new Date).getTime()-r._mouseDownTime>o){n=Math.max(n-1,1)}if(r._dragged){if(e.doneFn)e.doneFn()}else{if(e.clickFn)e.clickFn(n,b);if(!w){var i;try{i=new MouseEvent("click",t)}catch(e){var l=d(t);i=document.createEvent("MouseEvents");i.initMouseEvent("click",t.bubbles,t.cancelable,t.view,t.detail,t.screenX,t.screenY,l[0],l[1],t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget)}_.dispatchEvent(i)}}p(r);r._dragged=false;return}};function h(){var t=document.createElement("div");t.className="dragcover";var e=t.style;e.position="fixed";e.left=0;e.right=0;e.top=0;e.bottom=0;e.zIndex=999999999;e.background="none";document.body.appendChild(t);return t}c.coverSlip=h;function p(t){t._dragging=false;if(t._replotPending)o.call("plot",t)}function d(t){return n(t.changedTouches?t.changedTouches[0]:t,document.body)}},{"../../constants/interactions":660,"../../lib":684,"../../plots/cartesian/constants":737,"../../registry":817,"./align":578,"./cursor":579,"./unhover":581,"has-hover":378,"has-passive-events":379,"mouse-event-offset":403}],581:[function(t,e,r){"use strict";var n=t("../../lib/events");var a=t("../../lib/throttle");var i=t("../../lib/get_graph_div");var o=t("../fx/constants");var s=e.exports={};s.wrapped=function(t,e,r){t=i(t);if(t._fullLayout){a.clear(t._fullLayout._uid+o.HOVERID)}s.raw(t,e,r)};s.raw=function t(e,r){var a=e._fullLayout;var i=e._hoverdata;if(!r)r={};if(r.target&&n.triggerHandler(e,"plotly_beforehover",r)===false){return}a._hoverlayer.selectAll("g").remove();a._hoverlayer.selectAll("line").remove();a._hoverlayer.selectAll("circle").remove();e._hoverdata=undefined;if(r.target&&i){e.emit("plotly_unhover",{event:r,points:i})}}},{"../../lib/events":672,"../../lib/get_graph_div":679,"../../lib/throttle":709,"../fx/constants":595}],582:[function(t,e,r){"use strict";r.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"}},{}],583:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("tinycolor2");var o=t("../../registry");var s=t("../color");var l=t("../colorscale");var u=t("../../lib");var c=t("../../lib/svg_text_utils");var f=t("../../constants/xmlns_namespaces");var h=t("../../constants/alignment");var p=h.LINE_SPACING;var d=t("../../constants/interactions").DESELECTDIM;var v=t("../../traces/scatter/subtypes");var g=t("../../traces/scatter/make_bubble_size_func");var m=e.exports={};m.font=function(t,e,r,n){if(u.isPlainObject(e)){n=e.color;r=e.size;e=e.family}if(e)t.style("font-family",e);if(r+1)t.style("font-size",r+"px");if(n)t.call(s.fill,n)};m.setPosition=function(t,e,r){t.attr("x",e).attr("y",r)};m.setSize=function(t,e,r){t.attr("width",e).attr("height",r)};m.setRect=function(t,e,r,n,a){t.call(m.setPosition,e,r).call(m.setSize,n,a)};m.translatePoint=function(t,e,r,n){var i=r.c2p(t.x);var o=n.c2p(t.y);if(a(i)&&a(o)&&e.node()){if(e.node().nodeName==="text"){e.attr("x",i).attr("y",o)}else{e.attr("transform","translate("+i+","+o+")")}}else{return false}return true};m.translatePoints=function(t,e,r){t.each(function(t){var a=n.select(this);m.translatePoint(t,a,e,r)})};m.hideOutsideRangePoint=function(t,e,r,n,a,i){e.attr("display",r.isPtWithinRange(t,a)&&n.isPtWithinRange(t,i)?null:"none")};m.hideOutsideRangePoints=function(t,e){if(!e._hasClipOnAxisFalse)return;var r=e.xaxis;var a=e.yaxis;t.each(function(e){var i=e[0].trace;var o=i.xcalendar;var s=i.ycalendar;var l=i.type==="bar"?".bartext":".point,.textpoint";t.selectAll(l).each(function(t){m.hideOutsideRangePoint(t,n.select(this),r,a,o,s)})})};m.crispRound=function(t,e,r){if(!e||!a(e))return r||0;if(t._context.staticPlot)return e;if(e<1)return 1;return Math.round(e)};m.singleLineStyle=function(t,e,r,n,a){e.style("fill","none");var i=(((t||[])[0]||{}).trace||{}).line||{},o=r||i.width||0,l=a||i.dash||"";s.stroke(e,n||i.color);m.dashLine(e,l,o)};m.lineGroupStyle=function(t,e,r,a){t.style("fill","none").each(function(t){var i=(((t||[])[0]||{}).trace||{}).line||{},o=e||i.width||0,l=a||i.dash||"";n.select(this).call(s.stroke,r||i.color).call(m.dashLine,l,o)})};m.dashLine=function(t,e,r){r=+r||0;e=m.dashStyle(e,r);t.style({"stroke-dasharray":e,"stroke-width":r+"px"})};m.dashStyle=function(t,e){e=+e||1;var r=Math.max(e,3);if(t==="solid")t="";else if(t==="dot")t=r+"px,"+r+"px";else if(t==="dash")t=3*r+"px,"+3*r+"px";else if(t==="longdash")t=5*r+"px,"+5*r+"px";else if(t==="dashdot"){t=3*r+"px,"+r+"px,"+r+"px,"+r+"px"}else if(t==="longdashdot"){t=5*r+"px,"+2*r+"px,"+r+"px,"+2*r+"px"}return t};m.singleFillStyle=function(t){var e=n.select(t.node());var r=e.data();var a=(((r[0]||[])[0]||{}).trace||{}).fillcolor;if(a){t.call(s.fill,a)}};m.fillGroupStyle=function(t){t.style("stroke-width",0).each(function(e){var r=n.select(this);try{r.call(s.fill,e[0].trace.fillcolor)}catch(e){u.error(e,t);r.remove()}})};var y=t("./symbol_defs");m.symbolNames=[];m.symbolFuncs=[];m.symbolNeedLines={};m.symbolNoDot={};m.symbolNoFill={};m.symbolList=[];Object.keys(y).forEach(function(t){var e=y[t];m.symbolList=m.symbolList.concat([e.n,t,e.n+100,t+"-open"]);m.symbolNames[e.n]=t;m.symbolFuncs[e.n]=e.f;if(e.needLine){m.symbolNeedLines[e.n]=true}if(e.noDot){m.symbolNoDot[e.n]=true}else{m.symbolList=m.symbolList.concat([e.n+200,t+"-dot",e.n+300,t+"-open-dot"])}if(e.noFill){m.symbolNoFill[e.n]=true}});var x=m.symbolNames.length,b="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";m.symbolNumber=function(t){if(typeof t==="string"){var e=0;if(t.indexOf("-open")>0){e=100;t=t.replace("-open","")}if(t.indexOf("-dot")>0){e+=200;t=t.replace("-dot","")}t=m.symbolNames.indexOf(t);if(t>=0){t+=e}}if(t%100>=x||t>=400){return 0}return Math.floor(Math.max(t,0))};function _(t,e){var r=t%100;return m.symbolFuncs[r](e)+(t>=200?b:"")}var w={x1:1,x2:0,y1:0,y2:0};var k={x1:0,x2:0,y1:1,y2:0};m.gradient=function(t,e,r,a,o,l){var c=e._fullLayout._defs.select(".gradients").selectAll("#"+r).data([a+o+l],u.identity);c.exit().remove();c.enter().append(a==="radial"?"radialGradient":"linearGradient").each(function(){var t=n.select(this);if(a==="horizontal")t.attr(w);else if(a==="vertical")t.attr(k);t.attr("id",r);var e=i(o);var u=i(l);t.append("stop").attr({offset:"0%","stop-color":s.tinyRGB(u),"stop-opacity":u.getAlpha()});t.append("stop").attr({offset:"100%","stop-color":s.tinyRGB(e),"stop-opacity":e.getAlpha()})});t.style({fill:"url(#"+r+")","fill-opacity":null})};m.initGradients=function(t){var e=u.ensureSingle(t._fullLayout._defs,"g","gradients");e.selectAll("linearGradient,radialGradient").remove()};m.pointStyle=function(t,e,r){if(!t.size())return;var a=m.makePointStyleFns(e);t.each(function(t){m.singlePointStyle(t,n.select(this),e,a,r)})};m.singlePointStyle=function(t,e,r,n,a){var i=r.marker;var o=i.line;e.style("opacity",n.selectedOpacityFn?n.selectedOpacityFn(t):t.mo===undefined?i.opacity:t.mo);if(n.ms2mrc){var l;if(t.ms==="various"||i.size==="various"){l=3}else{l=n.ms2mrc(t.ms)}t.mrc=l;if(n.selectedSizeFn){l=t.mrc=n.selectedSizeFn(t)}var c=m.symbolNumber(t.mx||i.symbol)||0;t.om=c%200>=100;e.attr("d",_(c,l))}var f=false;var h,p,d;if(t.so){d=o.outlierwidth;p=o.outliercolor;h=i.outliercolor}else{var v=(o||{}).width;d=(t.mlw+1||v+1||(t.trace?(t.trace.marker.line||{}).width:0)+1)-1||0;if("mlc"in t)p=t.mlcc=n.lineScale(t.mlc);else if(u.isArrayOrTypedArray(o.color))p=s.defaultLine;else p=o.color;if(u.isArrayOrTypedArray(i.color)){h=s.defaultLine;f=true}if("mc"in t){h=t.mcc=n.markerScale(t.mc)}else{h=i.color||"rgba(0,0,0,0)"}if(n.selectedColorFn){h=n.selectedColorFn(t)}}if(t.om){e.call(s.stroke,h).style({"stroke-width":(d||1)+"px",fill:"none"})}else{e.style("stroke-width",d+"px");var g=i.gradient;var y=t.mgt;if(y)f=true;else y=g&&g.type;if(y&&y!=="none"){var x=t.mgc;if(x)f=true;else x=g.color;var b="g"+a._fullLayout._uid+"-"+r.uid;if(f)b+="-"+t.i;e.call(m.gradient,a,b,y,h,x)}else{e.call(s.fill,h)}if(d){e.call(s.stroke,p)}}};m.makePointStyleFns=function(t){var e={};var r=t.marker;e.markerScale=m.tryColorscale(r,"");e.lineScale=m.tryColorscale(r,"line");if(o.traceIs(t,"symbols")){e.ms2mrc=v.isBubble(t)?g(t):function(){return(r.size||6)/2}}if(t.selectedpoints){u.extendFlat(e,m.makeSelectedPointStyleFns(t))}return e};m.makeSelectedPointStyleFns=function(t){var e={};var r=t.selected||{};var n=t.unselected||{};var a=t.marker||{};var i=r.marker||{};var s=n.marker||{};var l=a.opacity;var c=i.opacity;var f=s.opacity;var h=c!==undefined;var p=f!==undefined;if(u.isArrayOrTypedArray(l)||h||p){e.selectedOpacityFn=function(t){var e=t.mo===undefined?a.opacity:t.mo;if(t.selected){return h?c:e}else{return p?f:d*e}}}var v=a.color;var g=i.color;var m=s.color;if(g||m){e.selectedColorFn=function(t){var e=t.mcc||v;if(t.selected){return g||e}else{return m||e}}}var y=a.size;var x=i.size;var b=s.size;var _=x!==undefined;var w=b!==undefined;if(o.traceIs(t,"symbols")&&(_||w)){e.selectedSizeFn=function(t){var e=t.mrc||y/2;if(t.selected){return _?x/2:e}else{return w?b/2:e}}}return e};m.makeSelectedTextStyleFns=function(t){var e={};var r=t.selected||{};var n=t.unselected||{};var a=t.textfont||{};var i=r.textfont||{};var o=n.textfont||{};var l=a.color;var u=i.color;var c=o.color;e.selectedTextColorFn=function(t){var e=t.tc||l;if(t.selected){return u||e}else{if(c)return c;else return u?e:s.addOpacity(e,d)}};return e};m.selectedPointStyle=function(t,e){if(!t.size()||!e.selectedpoints)return;var r=m.makeSelectedPointStyleFns(e);var a=e.marker||{};var i=[];if(r.selectedOpacityFn){i.push(function(t,e){t.style("opacity",r.selectedOpacityFn(e))})}if(r.selectedColorFn){i.push(function(t,e){s.fill(t,r.selectedColorFn(e))})}if(r.selectedSizeFn){i.push(function(t,e){var n=e.mx||a.symbol||0;var i=r.selectedSizeFn(e);t.attr("d",_(m.symbolNumber(n),i));e.mrc2=i})}if(i.length){t.each(function(t){var e=n.select(this);for(var r=0;r<i.length;r++){i[r](e,t)}})}};m.tryColorscale=function(t,e){var r=e?u.nestedProperty(t,e).get():t;if(r){var n=r.colorscale;var a=r.color;if(n&&u.isArrayOrTypedArray(a)){return l.makeColorScaleFunc(l.extractScale(n,r.cmin,r.cmax))}}return u.identity};var M={start:1,end:-1,middle:0,bottom:1,top:-1};function A(t,e,r,a){var i=n.select(t.node().parentNode);var o=e.indexOf("top")!==-1?"top":e.indexOf("bottom")!==-1?"bottom":"middle";var s=e.indexOf("left")!==-1?"end":e.indexOf("right")!==-1?"start":"middle";var l=a?a/.8+1:0;var u=(c.lineCount(t)-1)*p+1;var f=M[s]*l;var h=r*.75+M[o]*l+(M[o]-1)*u*r/2;t.attr("text-anchor",s);i.attr("transform","translate("+f+","+h+")")}function T(t,e){var r=t.ts||e.textfont.size;return a(r)&&r>0?r:0}m.textPointStyle=function(t,e,r){if(!t.size())return;var a;if(e.selectedpoints){var i=m.makeSelectedTextStyleFns(e);a=i.selectedTextColorFn}t.each(function(t){var i=n.select(this);var o=u.extractOption(t,e,"tx","text");if(!o&&o!==0){i.remove();return}var s=t.tp||e.textposition;var l=T(t,e);var f=a?a(t):t.tc||e.textfont.color;i.call(m.font,t.tf||e.textfont.family,l,f).text(o).call(c.convertToTspans,r).call(A,s,l,t.mrc)})};m.selectedTextStyle=function(t,e){if(!t.size()||!e.selectedpoints)return;var r=m.makeSelectedTextStyleFns(e);t.each(function(t){var a=n.select(this);var i=r.selectedTextColorFn(t);var o=t.tp||e.textposition;var l=T(t,e);s.fill(a,i);A(a,o,l,t.mrc2||t.mrc)})};var S=.5;m.smoothopen=function(t,e){if(t.length<3){return"M"+t.join("L")}var r="M"+t[0],n=[],a;for(a=1;a<t.length-1;a++){n.push(E(t[a-1],t[a],t[a+1],e))}r+="Q"+n[0][0]+" "+t[1];for(a=2;a<t.length-1;a++){r+="C"+n[a-2][1]+" "+n[a-1][0]+" "+t[a]}r+="Q"+n[t.length-3][1]+" "+t[t.length-1];return r};m.smoothclosed=function(t,e){if(t.length<3){return"M"+t.join("L")+"Z"}var r="M"+t[0],n=t.length-1,a=[E(t[n],t[0],t[1],e)],i;for(i=1;i<n;i++){a.push(E(t[i-1],t[i],t[i+1],e))}a.push(E(t[n-1],t[n],t[0],e));for(i=1;i<=n;i++){r+="C"+a[i-1][1]+" "+a[i][0]+" "+t[i]}r+="C"+a[n][1]+" "+a[0][0]+" "+t[0]+"Z";return r};function E(t,e,r,a){var i=t[0]-e[0],o=t[1]-e[1],s=r[0]-e[0],l=r[1]-e[1],u=Math.pow(i*i+o*o,S/2),c=Math.pow(s*s+l*l,S/2),f=(c*c*i-u*u*s)*a,h=(c*c*o-u*u*l)*a,p=3*c*(u+c),d=3*u*(u+c);return[[n.round(e[0]+(p&&f/p),2),n.round(e[1]+(p&&h/p),2)],[n.round(e[0]-(d&&f/d),2),n.round(e[1]-(d&&h/d),2)]]}var C={hv:function(t,e){return"H"+n.round(e[0],2)+"V"+n.round(e[1],2)},vh:function(t,e){return"V"+n.round(e[1],2)+"H"+n.round(e[0],2)},hvh:function(t,e){return"H"+n.round((t[0]+e[0])/2,2)+"V"+n.round(e[1],2)+"H"+n.round(e[0],2)},vhv:function(t,e){return"V"+n.round((t[1]+e[1])/2,2)+"H"+n.round(e[0],2)+"V"+n.round(e[1],2)}};var L=function(t,e){return"L"+n.round(e[0],2)+","+n.round(e[1],2)};m.steps=function(t){var e=C[t]||L;return function(t){var r="M"+n.round(t[0][0],2)+","+n.round(t[0][1],2);for(var a=1;a<t.length;a++){r+=e(t[a-1],t[a])}return r}};m.makeTester=function(){var t=u.ensureSingleById(n.select("body"),"svg","js-plotly-tester",function(t){t.attr(f.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})});var e=u.ensureSingle(t,"path","js-reference-point",function(t){t.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});m.tester=t;m.testref=e};m.savedBBoxes={};var I=0;var z=1e4;m.bBox=function(t,e,r){if(!r)r=P(t);var a;if(r){a=m.savedBBoxes[r];if(a)return u.extendFlat({},a)}else if(t.childNodes.length===1){var i=t.childNodes[0];r=P(i);if(r){var o=+i.getAttribute("x")||0;var s=+i.getAttribute("y")||0;var l=i.getAttribute("transform");if(!l){var f=m.bBox(i,false,r);if(o){f.left+=o;f.right+=o}if(s){f.top+=s;f.bottom+=s}return f}r+="~"+o+"~"+s+"~"+l;a=m.savedBBoxes[r];if(a)return u.extendFlat({},a)}}var h,p;if(e){h=t}else{p=m.tester.node();h=t.cloneNode(true);p.appendChild(h)}n.select(h).attr("transform",null).call(c.positionText,0,0);var d=h.getBoundingClientRect();var v=m.testref.node().getBoundingClientRect();if(!e)p.removeChild(h);var g={height:d.height,width:d.width,left:d.left-v.left,top:d.top-v.top,right:d.right-v.left,bottom:d.bottom-v.top};if(I>=z){m.savedBBoxes={};I=0}if(r)m.savedBBoxes[r]=g;I++;return u.extendFlat({},g)};function P(t){var e=t.getAttribute("data-unformatted");if(e===null)return;return e+t.getAttribute("data-math")+t.getAttribute("text-anchor")+t.getAttribute("style")}m.setClipUrl=function(t,e){if(!e){t.attr("clip-path",null);return}if(m.baseUrl===undefined){var r=n.select("base");if(r.size()&&r.attr("href")){m.baseUrl=window.location.href.split("#")[0]}else{m.baseUrl=""}}t.attr("clip-path","url("+m.baseUrl+"#"+e+")")};m.getTranslate=function(t){var e=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,r=t.attr?"attr":"getAttribute",n=t[r]("transform")||"";var a=n.replace(e,function(t,e,r){return[e,r].join(" ")}).split(" ");return{x:+a[0]||0,y:+a[1]||0}};m.setTranslate=function(t,e,r){var n=/(\btranslate\(.*?\);?)/,a=t.attr?"attr":"getAttribute",i=t.attr?"attr":"setAttribute",o=t[a]("transform")||"";e=e||0;r=r||0;o=o.replace(n,"").trim();o+=" translate("+e+", "+r+")";o=o.trim();t[i]("transform",o);return o};m.getScale=function(t){var e=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,r=t.attr?"attr":"getAttribute",n=t[r]("transform")||"";var a=n.replace(e,function(t,e,r){return[e,r].join(" ")}).split(" ");return{x:+a[0]||1,y:+a[1]||1}};m.setScale=function(t,e,r){var n=/(\bscale\(.*?\);?)/,a=t.attr?"attr":"getAttribute",i=t.attr?"attr":"setAttribute",o=t[a]("transform")||"";e=e||1;r=r||1;o=o.replace(n,"").trim();o+=" scale("+e+", "+r+")";o=o.trim();t[i]("transform",o);return o};var O=/\s*sc.*/;m.setPointGroupScale=function(t,e,r){e=e||1;r=r||1;if(!t)return;var n=e===1&&r===1?"":" scale("+e+","+r+")";t.each(function(){var t=(this.getAttribute("transform")||"").replace(O,"");t+=n;t=t.trim();this.setAttribute("transform",t)})};var D=/translate\([^)]*\)\s*$/;m.setTextPointsScale=function(t,e,r){if(!t)return;t.each(function(){var t;var a=n.select(this);var i=a.select("text");if(!i.node())return;var o=parseFloat(i.attr("x")||0);var s=parseFloat(i.attr("y")||0);var l=(a.attr("transform")||"").match(D);if(e===1&&r===1){t=[]}else{t=["translate("+o+","+s+")","scale("+e+","+r+")","translate("+-o+","+-s+")"]}if(l){t.push(l)}a.attr("transform",t.join(" "))})}},{"../../constants/alignment":656,"../../constants/interactions":660,"../../constants/xmlns_namespaces":663,"../../lib":684,"../../lib/svg_text_utils":708,"../../registry":817,"../../traces/scatter/make_bubble_size_func":1031,"../../traces/scatter/subtypes":1037,"../color":558,"../colorscale":573,"./symbol_defs":584,d3:147,"fast-isnumeric":214,tinycolor2:499}],584:[function(t,e,r){"use strict";var n=t("d3");e.exports={circle:{n:0,f:function(t){var e=n.round(t,2);return"M"+e+",0A"+e+","+e+" 0 1,1 0,-"+e+"A"+e+","+e+" 0 0,1 "+e+",0Z"}},square:{n:1,f:function(t){var e=n.round(t,2);return"M"+e+","+e+"H-"+e+"V-"+e+"H"+e+"Z"}},diamond:{n:2,f:function(t){var e=n.round(t*1.3,2);return"M"+e+",0L0,"+e+"L-"+e+",0L0,-"+e+"Z"}},cross:{n:3,f:function(t){var e=n.round(t*.4,2),r=n.round(t*1.2,2);return"M"+r+","+e+"H"+e+"V"+r+"H-"+e+"V"+e+"H-"+r+"V-"+e+"H-"+e+"V-"+r+"H"+e+"V-"+e+"H"+r+"Z"}},x:{n:4,f:function(t){var e=n.round(t*.8/Math.sqrt(2),2),r="l"+e+","+e,a="l"+e+",-"+e,i="l-"+e+",-"+e,o="l-"+e+","+e;return"M0,"+e+r+a+i+a+i+o+i+o+r+o+r+"Z"}},"triangle-up":{n:5,f:function(t){var e=n.round(t*2/Math.sqrt(3),2),r=n.round(t/2,2),a=n.round(t,2);return"M-"+e+","+r+"H"+e+"L0,-"+a+"Z"}},"triangle-down":{n:6,f:function(t){var e=n.round(t*2/Math.sqrt(3),2),r=n.round(t/2,2),a=n.round(t,2);return"M-"+e+",-"+r+"H"+e+"L0,"+a+"Z"}},"triangle-left":{n:7,f:function(t){var e=n.round(t*2/Math.sqrt(3),2),r=n.round(t/2,2),a=n.round(t,2);return"M"+r+",-"+e+"V"+e+"L-"+a+",0Z"}},"triangle-right":{n:8,f:function(t){var e=n.round(t*2/Math.sqrt(3),2),r=n.round(t/2,2),a=n.round(t,2);return"M-"+r+",-"+e+"V"+e+"L"+a+",0Z"}},"triangle-ne":{n:9,f:function(t){var e=n.round(t*.6,2),r=n.round(t*1.2,2);return"M-"+r+",-"+e+"H"+e+"V"+r+"Z"}},"triangle-se":{n:10,f:function(t){var e=n.round(t*.6,2),r=n.round(t*1.2,2);return"M"+e+",-"+r+"V"+e+"H-"+r+"Z"}},"triangle-sw":{n:11,f:function(t){var e=n.round(t*.6,2),r=n.round(t*1.2,2);return"M"+r+","+e+"H-"+e+"V-"+r+"Z"}},"triangle-nw":{n:12,f:function(t){var e=n.round(t*.6,2),r=n.round(t*1.2,2);return"M-"+e+","+r+"V-"+e+"H"+r+"Z"}},pentagon:{n:13,f:function(t){var e=n.round(t*.951,2),r=n.round(t*.588,2),a=n.round(-t,2),i=n.round(t*-.309,2),o=n.round(t*.809,2);return"M"+e+","+i+"L"+r+","+o+"H-"+r+"L-"+e+","+i+"L0,"+a+"Z"}},hexagon:{n:14,f:function(t){var e=n.round(t,2),r=n.round(t/2,2),a=n.round(t*Math.sqrt(3)/2,2);return"M"+a+",-"+r+"V"+r+"L0,"+e+"L-"+a+","+r+"V-"+r+"L0,-"+e+"Z"}},hexagon2:{n:15,f:function(t){var e=n.round(t,2),r=n.round(t/2,2),a=n.round(t*Math.sqrt(3)/2,2);return"M-"+r+","+a+"H"+r+"L"+e+",0L"+r+",-"+a+"H-"+r+"L-"+e+",0Z"}},octagon:{n:16,f:function(t){var e=n.round(t*.924,2),r=n.round(t*.383,2);return"M-"+r+",-"+e+"H"+r+"L"+e+",-"+r+"V"+r+"L"+r+","+e+"H-"+r+"L-"+e+","+r+"V-"+r+"Z"}},star:{n:17,f:function(t){var e=t*1.4,r=n.round(e*.225,2),a=n.round(e*.951,2),i=n.round(e*.363,2),o=n.round(e*.588,2),s=n.round(-e,2),l=n.round(e*-.309,2),u=n.round(e*.118,2),c=n.round(e*.809,2),f=n.round(e*.382,2);return"M"+r+","+l+"H"+a+"L"+i+","+u+"L"+o+","+c+"L0,"+f+"L-"+o+","+c+"L-"+i+","+u+"L-"+a+","+l+"H-"+r+"L0,"+s+"Z"}},hexagram:{n:18,f:function(t){var e=n.round(t*.66,2),r=n.round(t*.38,2),a=n.round(t*.76,2);return"M-"+a+",0l-"+r+",-"+e+"h"+a+"l"+r+",-"+e+"l"+r+","+e+"h"+a+"l-"+r+","+e+"l"+r+","+e+"h-"+a+"l-"+r+","+e+"l-"+r+",-"+e+"h-"+a+"Z"}},"star-triangle-up":{n:19,f:function(t){var e=n.round(t*Math.sqrt(3)*.8,2),r=n.round(t*.8,2),a=n.round(t*1.6,2),i=n.round(t*4,2),o="A "+i+","+i+" 0 0 1 ";return"M-"+e+","+r+o+e+","+r+o+"0,-"+a+o+"-"+e+","+r+"Z"}},"star-triangle-down":{n:20,f:function(t){var e=n.round(t*Math.sqrt(3)*.8,2),r=n.round(t*.8,2),a=n.round(t*1.6,2),i=n.round(t*4,2),o="A "+i+","+i+" 0 0 1 ";return"M"+e+",-"+r+o+"-"+e+",-"+r+o+"0,"+a+o+e+",-"+r+"Z"}},"star-square":{n:21,f:function(t){var e=n.round(t*1.1,2),r=n.round(t*2,2),a="A "+r+","+r+" 0 0 1 ";return"M-"+e+",-"+e+a+"-"+e+","+e+a+e+","+e+a+e+",-"+e+a+"-"+e+",-"+e+"Z"}},"star-diamond":{n:22,f:function(t){var e=n.round(t*1.4,2),r=n.round(t*1.9,2),a="A "+r+","+r+" 0 0 1 ";return"M-"+e+",0"+a+"0,"+e+a+e+",0"+a+"0,-"+e+a+"-"+e+",0"+"Z"}},"diamond-tall":{n:23,f:function(t){var e=n.round(t*.7,2),r=n.round(t*1.4,2);return"M0,"+r+"L"+e+",0L0,-"+r+"L-"+e+",0Z"}},"diamond-wide":{n:24,f:function(t){var e=n.round(t*1.4,2),r=n.round(t*.7,2);return"M0,"+r+"L"+e+",0L0,-"+r+"L-"+e+",0Z"}},hourglass:{n:25,f:function(t){var e=n.round(t,2);return"M"+e+","+e+"H-"+e+"L"+e+",-"+e+"H-"+e+"Z"},noDot:true},bowtie:{n:26,f:function(t){var e=n.round(t,2);return"M"+e+","+e+"V-"+e+"L-"+e+","+e+"V-"+e+"Z"},noDot:true},"circle-cross":{n:27,f:function(t){var e=n.round(t,2);return"M0,"+e+"V-"+e+"M"+e+",0H-"+e+"M"+e+",0A"+e+","+e+" 0 1,1 0,-"+e+"A"+e+","+e+" 0 0,1 "+e+",0Z"},needLine:true,noDot:true},"circle-x":{n:28,f:function(t){var e=n.round(t,2),r=n.round(t/Math.sqrt(2),2);return"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r+"M"+e+",0A"+e+","+e+" 0 1,1 0,-"+e+"A"+e+","+e+" 0 0,1 "+e+",0Z"},needLine:true,noDot:true},"square-cross":{n:29,f:function(t){var e=n.round(t,2);return"M0,"+e+"V-"+e+"M"+e+",0H-"+e+"M"+e+","+e+"H-"+e+"V-"+e+"H"+e+"Z"},needLine:true,noDot:true},"square-x":{n:30,f:function(t){var e=n.round(t,2);return"M"+e+","+e+"L-"+e+",-"+e+"M"+e+",-"+e+"L-"+e+","+e+"M"+e+","+e+"H-"+e+"V-"+e+"H"+e+"Z"},needLine:true,noDot:true},"diamond-cross":{n:31,f:function(t){var e=n.round(t*1.3,2);return"M"+e+",0L0,"+e+"L-"+e+",0L0,-"+e+"Z"+"M0,-"+e+"V"+e+"M-"+e+",0H"+e},needLine:true,noDot:true},"diamond-x":{n:32,f:function(t){var e=n.round(t*1.3,2),r=n.round(t*.65,2);return"M"+e+",0L0,"+e+"L-"+e+",0L0,-"+e+"Z"+"M-"+r+",-"+r+"L"+r+","+r+"M-"+r+","+r+"L"+r+",-"+r},needLine:true,noDot:true},"cross-thin":{n:33,f:function(t){var e=n.round(t*1.4,2);return"M0,"+e+"V-"+e+"M"+e+",0H-"+e},needLine:true,noDot:true,noFill:true},"x-thin":{n:34,f:function(t){var e=n.round(t,2);return"M"+e+","+e+"L-"+e+",-"+e+"M"+e+",-"+e+"L-"+e+","+e},needLine:true,noDot:true,noFill:true},asterisk:{n:35,f:function(t){var e=n.round(t*1.2,2);var r=n.round(t*.85,2);return"M0,"+e+"V-"+e+"M"+e+",0H-"+e+"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r},needLine:true,noDot:true,noFill:true},hash:{n:36,f:function(t){var e=n.round(t/2,2),r=n.round(t,2);return"M"+e+","+r+"V-"+r+"m-"+r+",0V"+r+"M"+r+","+e+"H-"+r+"m0,-"+r+"H"+r},needLine:true,noFill:true},"y-up":{n:37,f:function(t){var e=n.round(t*1.2,2),r=n.round(t*1.6,2),a=n.round(t*.8,2);return"M-"+e+","+a+"L0,0M"+e+","+a+"L0,0M0,-"+r+"L0,0"},needLine:true,noDot:true,noFill:true},"y-down":{n:38,f:function(t){var e=n.round(t*1.2,2),r=n.round(t*1.6,2),a=n.round(t*.8,2);return"M-"+e+",-"+a+"L0,0M"+e+",-"+a+"L0,0M0,"+r+"L0,0"},needLine:true,noDot:true,noFill:true},"y-left":{n:39,f:function(t){var e=n.round(t*1.2,2),r=n.round(t*1.6,2),a=n.round(t*.8,2);return"M"+a+","+e+"L0,0M"+a+",-"+e+"L0,0M-"+r+",0L0,0"},needLine:true,noDot:true,noFill:true},"y-right":{n:40,f:function(t){var e=n.round(t*1.2,2),r=n.round(t*1.6,2),a=n.round(t*.8,2);return"M-"+a+","+e+"L0,0M-"+a+",-"+e+"L0,0M"+r+",0L0,0"},needLine:true,noDot:true,noFill:true},"line-ew":{n:41,f:function(t){var e=n.round(t*1.4,2);return"M"+e+",0H-"+e},needLine:true,noDot:true,noFill:true},"line-ns":{n:42,f:function(t){var e=n.round(t*1.4,2);return"M0,"+e+"V-"+e},needLine:true,noDot:true,noFill:true},"line-ne":{n:43,f:function(t){var e=n.round(t,2);return"M"+e+",-"+e+"L-"+e+","+e},needLine:true,noDot:true,noFill:true},"line-nw":{n:44,f:function(t){var e=n.round(t,2);return"M"+e+","+e+"L-"+e+",-"+e},needLine:true,noDot:true,noFill:true}}},{d3:147}],585:[function(t,e,r){"use strict";e.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],586:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../registry");var i=t("../../plots/cartesian/axes");var o=t("./compute_error");e.exports=function t(e){var r=e.calcdata;for(var n=0;n<r.length;n++){var o=r[n],l=o[0].trace;if(!a.traceIs(l,"errorBarsOK"))continue;var u=i.getFromId(e,l.xaxis),c=i.getFromId(e,l.yaxis);s(o,l,u,"x");s(o,l,c,"y")}};function s(t,e,r,a){var s=e["error_"+a]||{},l=s.visible&&["linear","log"].indexOf(r.type)!==-1,u=[];if(!l)return;var c=o(s);for(var f=0;f<t.length;f++){var h=t[f],p=h[a];if(!n(r.c2l(p)))continue;var d=c(p,f);if(n(d[0])&&n(d[1])){var v=h[a+"s"]=p-d[0],g=h[a+"h"]=p+d[1];u.push(v,g)}}i.expand(r,u,{padded:true})}},{"../../plots/cartesian/axes":732,"../../registry":817,"./compute_error":587,"fast-isnumeric":214}],587:[function(t,e,r){"use strict";e.exports=function t(e){var r=e.type,a=e.symmetric;if(r==="data"){var i=e.array||[];if(a){return function t(e,r){var n=+i[r];return[n,n]}}else{var o=e.arrayminus||[];return function t(e,r){var n=+i[r];var a=+o[r];if(!isNaN(n)||!isNaN(a)){return[a||0,n||0]}return[NaN,NaN]}}}else{var s=n(r,e.value),l=n(r,e.valueminus);if(a||e.valueminus===undefined){return function t(e){var r=s(e);return[r,r]}}else{return function t(e){return[l(e),s(e)]}}}};function n(t,e){if(t==="percent"){return function(t){return Math.abs(t*e/100)}}if(t==="constant"){return function(){return Math.abs(e)}}if(t==="sqrt"){return function(t){return Math.sqrt(Math.abs(t))}}}},{}],588:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../registry");var i=t("../../lib");var o=t("../../plot_api/plot_template");var s=t("./attributes");e.exports=function(t,e,r,l){var u="error_"+l.axis;var c=o.newContainer(e,u);var f=t[u]||{};function h(t,e){return i.coerce(f,c,s,t,e)}var p=f.array!==undefined||f.value!==undefined||f.type==="sqrt";var d=h("visible",p);if(d===false)return;var v=h("type","array"in f?"data":"percent"),g=true;if(v!=="sqrt"){g=h("symmetric",!((v==="data"?"arrayminus":"valueminus")in f))}if(v==="data"){h("array");h("traceref");if(!g){h("arrayminus");h("tracerefminus")}}else if(v==="percent"||v==="constant"){h("value");if(!g)h("valueminus")}var m="copy_"+l.inherit+"style";if(l.inherit){var y=e["error_"+l.inherit];if((y||{}).visible){h(m,!(f.color||n(f.thickness)||n(f.width)))}}if(!l.inherit||!c[m]){h("color",r);h("thickness");h("width",a.traceIs(e,"gl3d")?0:4)}}},{"../../lib":684,"../../plot_api/plot_template":722,"../../registry":817,"./attributes":585,"fast-isnumeric":214}],589:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plot_api/edit_types").overrideAll;var i=t("./attributes");var o={error_x:n.extendFlat({},i),error_y:n.extendFlat({},i)};delete o.error_x.copy_zstyle;delete o.error_y.copy_zstyle;delete o.error_y.copy_ystyle;var s={error_x:n.extendFlat({},i),error_y:n.extendFlat({},i),error_z:n.extendFlat({},i)};delete s.error_x.copy_ystyle;delete s.error_y.copy_ystyle;delete s.error_z.copy_ystyle;delete s.error_z.copy_zstyle;e.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:o,bar:o,histogram:o,scatter3d:a(s,"calc","nested"),scattergl:a(o,"calc","nested")}},supplyDefaults:t("./defaults"),calc:t("./calc"),makeComputeError:t("./compute_error"),plot:t("./plot"),style:t("./style"),hoverInfo:l};function l(t,e,r){if((e.error_y||{}).visible){r.yerr=t.yh-t.y;if(!e.error_y.symmetric)r.yerrneg=t.y-t.ys}if((e.error_x||{}).visible){r.xerr=t.xh-t.x;if(!e.error_x.symmetric)r.xerrneg=t.x-t.xs}}},{"../../lib":684,"../../plot_api/edit_types":715,"./attributes":585,"./calc":586,"./compute_error":587,"./defaults":588,"./plot":590,"./style":591}],590:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("../drawing");var o=t("../../traces/scatter/subtypes");e.exports=function t(e,r,l){var u;var c=r.xaxis;var f=r.yaxis;var h=l&&l.duration>0;e.each(function(t){var e=t[0].trace,p=e.error_x||{},d=e.error_y||{};var v;if(e.ids){v=function(t){return t.id}}var g=o.hasMarkers(e)&&e.marker.maxdisplayed>0;if(!d.visible&&!p.visible)t=[];var m=n.select(this).selectAll("g.errorbar").data(t,v);m.exit().remove();if(!t.length)return;if(!p.visible)m.selectAll("path.xerror").remove();if(!d.visible)m.selectAll("path.yerror").remove();m.style("opacity",1);var y=m.enter().append("g").classed("errorbar",true);if(h){y.style("opacity",0).transition().duration(l.duration).style("opacity",1)}i.setClipUrl(m,r.layerClipId);m.each(function(t){var e=n.select(this);var r=s(t,c,f);if(g&&!t.vis)return;var i;var o=e.select("path.yerror");if(d.visible&&a(r.x)&&a(r.yh)&&a(r.ys)){var v=d.width;i="M"+(r.x-v)+","+r.yh+"h"+2*v+"m-"+v+",0V"+r.ys;if(!r.noYS)i+="m-"+v+",0h"+2*v;u=!o.size();if(u){o=e.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",true)}else if(h){o=o.transition().duration(l.duration).ease(l.easing)}o.attr("d",i)}else o.remove();var m=e.select("path.xerror");if(p.visible&&a(r.y)&&a(r.xh)&&a(r.xs)){var y=(p.copy_ystyle?d:p).width;i="M"+r.xh+","+(r.y-y)+"v"+2*y+"m0,-"+y+"H"+r.xs;if(!r.noXS)i+="m0,-"+y+"v"+2*y;u=!m.size();if(u){m=e.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",true)}else if(h){m=m.transition().duration(l.duration).ease(l.easing)}m.attr("d",i)}else m.remove()})})};function s(t,e,r){var n={x:e.c2p(t.x),y:r.c2p(t.y)};if(t.yh!==undefined){n.yh=r.c2p(t.yh);n.ys=r.c2p(t.ys);if(!a(n.ys)){n.noYS=true;n.ys=r.c2p(t.ys,true)}}if(t.xh!==undefined){n.xh=e.c2p(t.xh);n.xs=e.c2p(t.xs);if(!a(n.xs)){n.noXS=true;n.xs=e.c2p(t.xs,true)}}return n}},{"../../traces/scatter/subtypes":1037,"../drawing":583,d3:147,"fast-isnumeric":214}],591:[function(t,e,r){"use strict";var n=t("d3");var a=t("../color");e.exports=function t(e){e.each(function(t){var e=t[0].trace,r=e.error_y||{},i=e.error_x||{};var o=n.select(this);o.selectAll("path.yerror").style("stroke-width",r.thickness+"px").call(a.stroke,r.color);if(i.copy_ystyle)i=r;o.selectAll("path.xerror").style("stroke-width",i.thickness+"px").call(a.stroke,i.color)})}},{"../color":558,d3:147}],592:[function(t,e,r){"use strict";var n=t("../../plots/font_attributes");e.exports={hoverlabel:{bgcolor:{valType:"color",arrayOk:true,editType:"none"},bordercolor:{valType:"color",arrayOk:true,editType:"none"},font:n({arrayOk:true,editType:"none"}),namelength:{valType:"integer",min:-1,arrayOk:true,editType:"none"},editType:"calc"}}},{"../../plots/font_attributes":758}],593:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../registry");e.exports=function t(e){var r=e.calcdata;var o=e._fullLayout;function s(t){return function(e){return n.coerceHoverinfo({hoverinfo:e},{_module:t._module},o)}}for(var l=0;l<r.length;l++){var u=r[l];var c=u[0].trace;if(a.traceIs(c,"pie"))continue;var f=a.traceIs(c,"2dMap")?i:n.fillArray;f(c.hoverinfo,u,"hi",s(c));if(!c.hoverlabel)continue;f(c.hoverlabel.bgcolor,u,"hbg");f(c.hoverlabel.bordercolor,u,"hbc");f(c.hoverlabel.font.size,u,"hts");f(c.hoverlabel.font.color,u,"htc");f(c.hoverlabel.font.family,u,"htf");f(c.hoverlabel.namelength,u,"hnl")}};function i(t,e,r,a){a=a||n.identity;if(Array.isArray(t)){e[0][r]=a(t)}}},{"../../lib":684,"../../registry":817}],594:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("./hover").hover;e.exports=function t(e,r,i){var o=n.getComponentMethod("annotations","onClick")(e,e._hoverdata);if(i!==undefined){a(e,r,i,true)}function s(){e.emit("plotly_click",{points:e._hoverdata,event:r})}if(e._hoverdata&&r&&r.target){if(o&&o.then){o.then(s)}else s();if(r.stopImmediatePropagation)r.stopImmediatePropagation()}}},{"../../registry":817,"./hover":598}],595:[function(t,e,r){"use strict";e.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],596:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./attributes");var i=t("./hoverlabel_defaults");e.exports=function t(e,r,o,s){function l(t,i){return n.coerce(e,r,a,t,i)}i(e,r,l,s.hoverlabel)}},{"../../lib":684,"./attributes":592,"./hoverlabel_defaults":599}],597:[function(t,e,r){"use strict";var n=t("../../lib");r.getSubplot=function t(e){return e.subplot||e.xaxis+e.yaxis||e.geo};r.isTraceInSubplots=function t(e,n){if(e.type==="splom"){var a=e.xaxes||[];var i=e.yaxes||[];for(var o=0;o<a.length;o++){for(var s=0;s<i.length;s++){if(n.indexOf(a[o]+i[s])!==-1){return true}}}return false}return n.indexOf(r.getSubplot(e))!==-1};r.flat=function t(e,r){var n=new Array(e.length);for(var a=0;a<e.length;a++){n[a]=r}return n};r.p2c=function t(e,r){var n=new Array(e.length);for(var a=0;a<e.length;a++){n[a]=e[a].p2c(r)}return n};r.getDistanceFunction=function t(e,n,a,i){if(e==="closest")return i||r.quadrature(n,a);return e==="x"?n:a};r.getClosest=function t(e,r,n){if(n.index!==false){if(n.index>=0&&n.index<e.length){n.distance=0}else n.index=false}else{for(var a=0;a<e.length;a++){var i=r(e[a]);if(i<=n.distance){n.index=a;n.distance=i}}}return n};r.inbox=function t(e,r,n){return e*r<0||e===0?n:Infinity};r.quadrature=function t(e,r){return function(t){var n=e(t),a=r(t);return Math.sqrt(n*n+a*a)}};r.makeEventData=function t(e,n,a){var i="index"in e?e.index:e.pointNumber;var o={data:n._input,fullData:n,curveNumber:n.index,pointNumber:i};if(n._indexToPoints){var s=n._indexToPoints[i];if(s.length===1){o.pointIndex=s[0]}else{o.pointIndices=s}}else{o.pointIndex=i}if(n._module.eventData){o=n._module.eventData(o,e,n,a,i)}else{if("xVal"in e)o.x=e.xVal;else if("x"in e)o.x=e.x;if("yVal"in e)o.y=e.yVal;else if("y"in e)o.y=e.y;if(e.xa)o.xaxis=e.xa;if(e.ya)o.yaxis=e.ya;if(e.zLabelVal!==undefined)o.z=e.zLabelVal}r.appendArrayPointValue(o,n,i);return o};r.appendArrayPointValue=function(t,e,r){var a=e._arrayAttrs;if(!a){return}for(var s=0;s<a.length;s++){var l=a[s];var u=i(l);if(t[u]===undefined){var c=n.nestedProperty(e,l).get();var f=o(c,r);if(f!==undefined)t[u]=f}}};r.appendArrayMultiPointValues=function(t,e,r){var a=e._arrayAttrs;if(!a){return}for(var s=0;s<a.length;s++){var l=a[s];var u=i(l);if(t[u]===undefined){var c=n.nestedProperty(e,l).get();var f=new Array(r.length);for(var h=0;h<r.length;h++){f[h]=o(c,r[h])}t[u]=f}}};var a={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color"};function i(t){return a[t]||t}function o(t,e){if(Array.isArray(e)){if(Array.isArray(t)&&Array.isArray(t[e[0]])){return t[e[0]][e[1]]}}else{return t[e]}}},{"../../lib":684}],598:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("tinycolor2");var o=t("../../lib");var s=t("../../lib/events");var l=t("../../lib/svg_text_utils");var u=t("../../lib/override_cursor");var c=t("../drawing");var f=t("../color");var h=t("../dragelement");var p=t("../../plots/cartesian/axes");var d=t("../../registry");var v=t("./helpers");var g=t("./constants");var m=g.YANGLE;var y=Math.PI*m/180;var x=1/Math.sin(y);var b=Math.cos(y);var _=Math.sin(y);var w=g.HOVERARROWSIZE;var k=g.HOVERTEXTPAD;r.hover=function t(e,r,n,a){e=o.getGraphDiv(e);o.throttle(e._fullLayout._uid+g.HOVERID,g.HOVERMINTIME,function(){M(e,r,n,a)})};r.loneHover=function t(e,r){var a={color:e.color||f.defaultLine,x0:e.x0||e.x||0,x1:e.x1||e.x||0,y0:e.y0||e.y||0,y1:e.y1||e.y||0,xLabel:e.xLabel,yLabel:e.yLabel,zLabel:e.zLabel,text:e.text,name:e.name,idealAlign:e.idealAlign,borderColor:e.borderColor,fontFamily:e.fontFamily,fontSize:e.fontSize,fontColor:e.fontColor,trace:{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0};var i=n.select(r.container),o=r.outerContainer?n.select(r.outerContainer):i;var s={hovermode:"closest",rotateLabels:false,bgColor:r.bgColor||f.background,container:i,outerContainer:o};var l=A([a],s,r.gd);S(l,s.rotateLabels);return l.node()};function M(t,e,r,i){if(!r)r="xy";var l=Array.isArray(r)?r:[r];var c=t._fullLayout;var g=c._plots||[];var m=g[r];var y=c._has("cartesian");if(m){var x=m.overlays.map(function(t){return t.id});l=l.concat(x)}var b=l.length;var _=new Array(b);var w=new Array(b);var k=false;for(var M=0;M<b;M++){var z=l[M];var P=g[z];if(P){k=true;_[M]=p.getFromId(t,P.xaxis._id);w[M]=p.getFromId(t,P.yaxis._id);continue}var O=c[z]._subplot;_[M]=O.xaxis;w[M]=O.yaxis}var D=e.hovermode||c.hovermode;if(D&&!k)D="closest";if(["x","y","closest"].indexOf(D)===-1||!t.calcdata||t.querySelector(".zoombox")||t._dragging){return h.unhoverRaw(t,e)}var R=c.hoverdistance===-1?Infinity:c.hoverdistance;var B=c.spikedistance===-1?Infinity:c.spikedistance;var F=[],N=[],j,V,U,q,H,G,W,Y,X,Z,$,J,K,Q={hLinePoint:null,vLinePoint:null};if(Array.isArray(e)){D="array";for(U=0;U<e.length;U++){H=t.calcdata[e[U].curveNumber||0];if(H[0].trace.hoverinfo!=="skip"){N.push(H)}}}else{for(q=0;q<t.calcdata.length;q++){H=t.calcdata[q];G=H[0].trace;if(G.hoverinfo!=="skip"&&v.isTraceInSubplots(G,l)){N.push(H)}}var tt=!e.target,et,rt;if(tt){if("xpx"in e)et=e.xpx;else et=_[0]._length/2;if("ypx"in e)rt=e.ypx;else rt=w[0]._length/2}else{if(s.triggerHandler(t,"plotly_beforehover",e)===false){return}var nt=e.target.getBoundingClientRect();et=e.clientX-nt.left;rt=e.clientY-nt.top;if(et<0||et>_[0]._length||rt<0||rt>w[0]._length){return h.unhoverRaw(t,e)}}e.pointerX=et+_[0]._offset;e.pointerY=rt+w[0]._offset;if("xval"in e)j=v.flat(l,e.xval);else j=v.p2c(_,et);if("yval"in e)V=v.flat(l,e.yval);else V=v.p2c(w,rt);if(!a(j[0])||!a(V[0])){o.warn("Fx.hover failed",e,t);return h.unhoverRaw(t,e)}}var at=Infinity;for(q=0;q<N.length;q++){H=N[q];if(!H||!H[0]||!H[0].trace||H[0].trace.visible!==true)continue;G=H[0].trace;if(["carpet","contourcarpet"].indexOf(G._module.name)!==-1)continue;if(G.type==="splom"){Y=0;W=l[Y]}else{W=v.getSubplot(G);Y=l.indexOf(W)}X=D;J={cd:H,trace:G,xa:_[Y],ya:w[Y],maxHoverDistance:R,maxSpikeDistance:B,index:false,distance:Math.min(at,R),spikeDistance:Infinity,xSpike:undefined,ySpike:undefined,color:f.defaultLine,name:G.name,x0:undefined,x1:undefined,y0:undefined,y1:undefined,xLabelVal:undefined,yLabelVal:undefined,zLabelVal:undefined,text:undefined};if(c[W]){J.subplot=c[W]._subplot}K=F.length;if(X==="array"){var it=e[q];if("pointNumber"in it){J.index=it.pointNumber;X="closest"}else{X="";if("xval"in it){Z=it.xval;X="x"}if("yval"in it){$=it.yval;X=X?"closest":"y"}}}else{Z=j[Y];$=V[Y]}if(R!==0){if(G._module&&G._module.hoverPoints){var ot=G._module.hoverPoints(J,Z,$,X,c._hoverlayer);if(ot){var st;for(var lt=0;lt<ot.length;lt++){st=ot[lt];if(a(st.x0)&&a(st.y0)){F.push(E(st,D))}}}}else{o.log("Unrecognized trace type in hover:",G)}}if(D==="closest"&&F.length>K){F.splice(0,K);at=F[0].distance}if(y&&B!==0){if(F.length===0){J.distance=B;J.index=false;var ut=G._module.hoverPoints(J,Z,$,"closest",c._hoverlayer);if(ut){ut=ut.filter(function(t){return t.spikeDistance<=B})}if(ut&&ut.length){var ct;var ft=ut.filter(function(t){return t.xa.showspikes});if(ft.length){var ht=ft[0];if(a(ht.x0)&&a(ht.y0)){ct=gt(ht);if(!Q.vLinePoint||Q.vLinePoint.spikeDistance>ct.spikeDistance){Q.vLinePoint=ct}}}var pt=ut.filter(function(t){return t.ya.showspikes});if(pt.length){var dt=pt[0];if(a(dt.x0)&&a(dt.y0)){ct=gt(dt);if(!Q.hLinePoint||Q.hLinePoint.spikeDistance>ct.spikeDistance){Q.hLinePoint=ct}}}}}}}function vt(t,e){var r=null;var n=Infinity;var a;for(var i=0;i<t.length;i++){a=t[i].spikeDistance;if(a<n&&a<=e){r=t[i];n=a}}return r}function gt(t){if(!t)return null;return{xa:t.xa,ya:t.ya,x:t.xSpike!==undefined?t.xSpike:(t.x0+t.x1)/2,y:t.ySpike!==undefined?t.ySpike:(t.y0+t.y1)/2,distance:t.distance,spikeDistance:t.spikeDistance,curveNumber:t.trace.index,color:t.color,pointNumber:t.index}}var mt={fullLayout:c,container:c._hoverlayer,outerContainer:c._paperdiv,event:e};var yt=t._spikepoints,xt={vLinePoint:Q.vLinePoint,hLinePoint:Q.hLinePoint};t._spikepoints=xt;if(y&&B!==0){if(F.length!==0){var bt=F.filter(function(t){return t.ya.showspikes});var _t=vt(bt,B);Q.hLinePoint=gt(_t);var wt=F.filter(function(t){return t.xa.showspikes});var kt=vt(wt,B);Q.vLinePoint=gt(kt)}}if(F.length===0){var Mt=h.unhoverRaw(t,e);if(y&&(Q.hLinePoint!==null||Q.vLinePoint!==null)){if(I(yt)){C(Q,mt)}}return Mt}if(y){if(I(yt)){C(Q,mt)}}F.sort(function(t,e){return t.distance-e.distance});var At=t._hoverdata,Tt=[];for(U=0;U<F.length;U++){var St=F[U];Tt.push(v.makeEventData(St,St.trace,St.cd))}t._hoverdata=Tt;var Et=D==="y"&&N.length>1;var Ct=f.combine(c.plot_bgcolor||f.background,c.paper_bgcolor);var Lt={hovermode:D,rotateLabels:Et,bgColor:Ct,container:c._hoverlayer,outerContainer:c._paperdiv,commonLabelOpts:c.hoverlabel,hoverdistance:c.hoverdistance};var It=A(F,Lt,t);T(F,Et?"xa":"ya",c);S(It,Et);if(e.target&&e.target.tagName){var zt=d.getComponentMethod("annotations","hasClickToShow")(t,Tt);u(n.select(e.target),zt?"pointer":"")}if(!e.target||i||!L(t,e,At))return;if(At){t.emit("plotly_unhover",{event:e,points:At})}t.emit("plotly_hover",{event:e,points:t._hoverdata,xaxes:_,yaxes:w,xvals:j,yvals:V})}function A(t,e,r){var a=e.hovermode;var i=e.rotateLabels;var s=e.bgColor;var u=e.container;var h=e.outerContainer;var p=e.commonLabelOpts||{};var d=e.fontFamily||g.HOVERFONT;var v=e.fontSize||g.HOVERFONTSIZE;var y=t[0];var x=y.xa;var b=y.ya;var _=a==="y"?"yLabel":"xLabel";var M=y[_];var A=(String(M)||"").split(" ")[0];var T=h.node().getBoundingClientRect();var S=T.top;var E=T.width;var C=T.height;var L=M!==undefined&&y.distance<=e.hoverdistance&&(a==="x"||a==="y");if(L){var I,z;var P=true;for(I=0;I<t.length;I++){if(P&&t[I].zLabel===undefined)P=false;z=t[I].hoverinfo||t[I].trace.hoverinfo;var O=Array.isArray(z)?z:z.split("+");if(O.indexOf("all")===-1&&O.indexOf(a)===-1){L=false;break}}if(P)L=false}var D=u.selectAll("g.axistext").data(L?[0]:[]);D.enter().append("g").classed("axistext",true);D.exit().remove();D.each(function(){var e=n.select(this);var i=o.ensureSingle(e,"path","",function(t){t.style({"stroke-width":"1px"})});var s=o.ensureSingle(e,"text","",function(t){t.attr("data-notex",1)});var u=p.bgcolor||f.defaultLine;var h=p.bordercolor||f.contrast(u);i.style({fill:u,stroke:h});s.text(M).call(c.font,p.font.family||d,p.font.size||v,p.font.color||f.background).call(l.positionText,0,0).call(l.convertToTspans,r);e.attr("transform","");var g=s.node().getBoundingClientRect();if(a==="x"){s.attr("text-anchor","middle").call(l.positionText,0,x.side==="top"?S-g.bottom-w-k:S-g.top+w+k);var m=x.side==="top"?"-":"";i.attr("d","M0,0"+"L"+w+","+m+w+"H"+(k+g.width/2)+"v"+m+(k*2+g.height)+"H-"+(k+g.width/2)+"V"+m+w+"H-"+w+"Z");e.attr("transform","translate("+(x._offset+(y.x0+y.x1)/2)+","+(b._offset+(x.side==="top"?0:b._length))+")")}else{s.attr("text-anchor",b.side==="right"?"start":"end").call(l.positionText,(b.side==="right"?1:-1)*(k+w),S-g.top-g.height/2);var T=b.side==="right"?"":"-";i.attr("d","M0,0"+"L"+T+w+","+w+"V"+(k+g.height/2)+"h"+T+(k*2+g.width)+"V-"+(k+g.height/2)+"H"+T+w+"V-"+w+"Z");e.attr("transform","translate("+(x._offset+(b.side==="right"?x._length:0))+","+(b._offset+(y.y0+y.y1)/2)+")")}t=t.filter(function(t){return t.zLabelVal!==undefined||(t[_]||"").split(" ")[0]===A})});var R=u.selectAll("g.hovertext").data(t,function(t){return[t.trace.index,t.index,t.x0,t.y0,t.name,t.attr,t.xa,t.ya||""].join(",")});R.enter().append("g").classed("hovertext",true).each(function(){var t=n.select(this);t.append("rect").call(f.fill,f.addOpacity(s,.8));t.append("text").classed("name",true);t.append("path").style("stroke-width","1px");t.append("text").classed("nums",true).call(c.font,d,v)});R.exit().remove();R.each(function(t){var e=n.select(this).attr("transform",""),o="",u="";var h=f.opacity(t.color)?t.color:f.defaultLine;var p=f.combine(h,s);var g=t.borderColor||f.contrast(p);if(t.nameOverride!==undefined)t.name=t.nameOverride;if(t.name){o=l.plainText(t.name||"");var y=Math.round(t.nameLength);if(y>-1&&o.length>y){if(y>3)o=o.substr(0,y-3)+"...";else o=o.substr(0,y)}}if(t.zLabel!==undefined){if(t.xLabel!==undefined)u+="x: "+t.xLabel+"<br>";if(t.yLabel!==undefined)u+="y: "+t.yLabel+"<br>";u+=(u?"z: ":"")+t.zLabel}else if(L&&t[a+"Label"]===M){u=t[(a==="x"?"y":"x")+"Label"]||""}else if(t.xLabel===undefined){if(t.yLabel!==undefined)u=t.yLabel}else if(t.yLabel===undefined)u=t.xLabel;else u="("+t.xLabel+", "+t.yLabel+")";if((t.text||t.text===0)&&!Array.isArray(t.text)){u+=(u?"<br>":"")+t.text}if(t.extraText!==undefined)u+=(u?"<br>":"")+t.extraText;if(u===""){if(o==="")e.remove();u=o}var x=e.select("text.nums").call(c.font,t.fontFamily||d,t.fontSize||v,t.fontColor||g).text(u).attr("data-notex",1).call(l.positionText,0,0).call(l.convertToTspans,r);var b=e.select("text.name"),_=0;if(o&&o!==u){b.call(c.font,t.fontFamily||d,t.fontSize||v,p).text(o).attr("data-notex",1).call(l.positionText,0,0).call(l.convertToTspans,r);_=b.node().getBoundingClientRect().width+2*k}else{b.remove();e.select("rect").remove()}e.select("path").style({fill:p,stroke:g});var A=x.node().getBoundingClientRect(),T=t.xa._offset+(t.x0+t.x1)/2,I=t.ya._offset+(t.y0+t.y1)/2,z=Math.abs(t.x1-t.x0),P=Math.abs(t.y1-t.y0),O=A.width+w+k+_,D,R;t.ty0=S-A.top;t.bx=A.width+2*k;t.by=A.height+2*k;t.anchor="start";t.txwidth=A.width;t.tx2width=_;t.offset=0;if(i){t.pos=T;D=I+P/2+O<=C;R=I-P/2-O>=0;if((t.idealAlign==="top"||!D)&&R){I-=P/2;t.anchor="end"}else if(D){I+=P/2;t.anchor="start"}else t.anchor="middle"}else{t.pos=I;D=T+z/2+O<=E;R=T-z/2-O>=0;if((t.idealAlign==="left"||!D)&&R){T-=z/2;t.anchor="end"}else if(D){T+=z/2;t.anchor="start"}else t.anchor="middle"}x.attr("text-anchor",t.anchor);if(_)b.attr("text-anchor",t.anchor);e.attr("transform","translate("+T+","+I+")"+(i?"rotate("+m+")":""))});return R}function T(t,e,r){var n=0,a=t.map(function(t,n){var a=t[e];return[{i:n,dp:0,pos:t.pos,posref:t.posref,size:t.by*(a._id.charAt(0)==="x"?x:1)/2,pmin:0,pmax:a._id.charAt(0)==="x"?r.width:r.height}]}).sort(function(t,e){return t[0].posref-e[0].posref}),i,o,s,l,u,c,f;function h(t){var e=t[0],r=t[t.length-1];o=e.pmin-e.pos-e.dp+e.size;s=r.pos+r.dp+r.size-e.pmax;if(o>.01){for(u=t.length-1;u>=0;u--)t[u].dp+=o;i=false}if(s<.01)return;if(o<-.01){for(u=t.length-1;u>=0;u--)t[u].dp-=s;i=false}if(!i)return;var n=0;for(l=0;l<t.length;l++){c=t[l];if(c.pos+c.dp+c.size>e.pmax)n++}for(l=t.length-1;l>=0;l--){if(n<=0)break;c=t[l];if(c.pos>e.pmax-1){c.del=true;n--}}for(l=0;l<t.length;l++){if(n<=0)break;c=t[l];if(c.pos<e.pmin+1){c.del=true;n--;s=c.size*2;for(u=t.length-1;u>=0;u--)t[u].dp-=s}}for(l=t.length-1;l>=0;l--){if(n<=0)break;c=t[l];if(c.pos+c.dp+c.size>e.pmax){c.del=true;n--}}}while(!i&&n<=t.length){n++;i=true;l=0;while(l<a.length-1){var p=a[l],d=a[l+1],v=p[p.length-1],g=d[0];o=v.pos+v.dp+v.size-g.pos-g.dp+g.size;if(o>.01&&v.pmin===g.pmin&&v.pmax===g.pmax){for(u=d.length-1;u>=0;u--)d[u].dp+=o;p.push.apply(p,d);a.splice(l+1,1);f=0;for(u=p.length-1;u>=0;u--)f+=p[u].dp;s=f/p.length;for(u=p.length-1;u>=0;u--)p[u].dp-=s;i=false}else l++}a.forEach(h)}for(l=a.length-1;l>=0;l--){var m=a[l];for(u=m.length-1;u>=0;u--){var y=m[u],b=t[y.i];b.offset=y.dp;b.del=y.del}}}function S(t,e){t.each(function(t){var r=n.select(this);if(t.del){r.remove();return}var a=t.anchor==="end"?-1:1,i=r.select("text.nums"),o={start:1,end:-1,middle:0}[t.anchor],s=o*(w+k),u=s+o*(t.txwidth+k),f=0,h=t.offset;if(t.anchor==="middle"){s-=t.tx2width/2;u+=t.txwidth/2+k}if(e){h*=-_;f=t.offset*b}r.select("path").attr("d",t.anchor==="middle"?"M-"+(t.bx/2+t.tx2width/2)+","+(h-t.by/2)+"h"+t.bx+"v"+t.by+"h-"+t.bx+"Z":"M0,0L"+(a*w+f)+","+(w+h)+"v"+(t.by/2-w)+"h"+a*t.bx+"v-"+t.by+"H"+(a*w+f)+"V"+(h-w)+"Z");i.call(l.positionText,s+f,h+t.ty0-t.by/2+k);if(t.tx2width){r.select("text.name").call(l.positionText,u+o*k+f,h+t.ty0-t.by/2+k);r.select("rect").call(c.setRect,u+(o-1)*t.tx2width/2+f,h-t.by/2-1,t.tx2width,t.by+2)}})}function E(t,e){var r=t.index;var n=t.trace||{};var a=t.cd[0];var i=t.cd[r]||{};var s=Array.isArray(r)?function(t,e){return o.castOption(a,r,t)||o.extractOption({},n,"",e)}:function(t,e){return o.extractOption(i,n,t,e)};function l(e,r,n){var a=s(r,n);if(a)t[e]=a}l("hoverinfo","hi","hoverinfo");l("color","hbg","hoverlabel.bgcolor");l("borderColor","hbc","hoverlabel.bordercolor");l("fontFamily","htf","hoverlabel.font.family");l("fontSize","hts","hoverlabel.font.size");l("fontColor","htc","hoverlabel.font.color");l("nameLength","hnl","hoverlabel.namelength");t.posref=e==="y"?t.xa._offset+(t.x0+t.x1)/2:t.ya._offset+(t.y0+t.y1)/2;t.x0=o.constrain(t.x0,0,t.xa._length);t.x1=o.constrain(t.x1,0,t.xa._length);t.y0=o.constrain(t.y0,0,t.ya._length);t.y1=o.constrain(t.y1,0,t.ya._length);if(t.xLabelVal!==undefined){t.xLabel="xLabel"in t?t.xLabel:p.hoverLabelText(t.xa,t.xLabelVal);t.xVal=t.xa.c2d(t.xLabelVal)}if(t.yLabelVal!==undefined){t.yLabel="yLabel"in t?t.yLabel:p.hoverLabelText(t.ya,t.yLabelVal);t.yVal=t.ya.c2d(t.yLabelVal)}if(t.zLabelVal!==undefined&&t.zLabel===undefined){t.zLabel=String(t.zLabelVal)}if(!isNaN(t.xerr)&&!(t.xa.type==="log"&&t.xerr<=0)){var u=p.tickText(t.xa,t.xa.c2l(t.xerr),"hover").text;if(t.xerrneg!==undefined){t.xLabel+=" +"+u+" / -"+p.tickText(t.xa,t.xa.c2l(t.xerrneg),"hover").text}else t.xLabel+=" \xb1 "+u;if(e==="x")t.distance+=1}if(!isNaN(t.yerr)&&!(t.ya.type==="log"&&t.yerr<=0)){var c=p.tickText(t.ya,t.ya.c2l(t.yerr),"hover").text;if(t.yerrneg!==undefined){t.yLabel+=" +"+c+" / -"+p.tickText(t.ya,t.ya.c2l(t.yerrneg),"hover").text}else t.yLabel+=" \xb1 "+c;if(e==="y")t.distance+=1}var f=t.hoverinfo||t.trace.hoverinfo;if(f!=="all"){f=Array.isArray(f)?f:f.split("+");if(f.indexOf("x")===-1)t.xLabel=undefined;if(f.indexOf("y")===-1)t.yLabel=undefined;if(f.indexOf("z")===-1)t.zLabel=undefined;if(f.indexOf("text")===-1)t.text=undefined;if(f.indexOf("name")===-1)t.name=undefined}return t}function C(t,e){var r=e.container;var n=e.fullLayout;var a=e.event;var o,s;var l=!!t.hLinePoint;var u=!!t.vLinePoint;r.selectAll(".spikeline").remove();if(!(u||l))return;var h=f.combine(n.plot_bgcolor,n.paper_bgcolor);if(l){var p=t.hLinePoint,d,v;o=p&&p.xa;s=p&&p.ya;var g=s.spikesnap;if(g==="cursor"){d=a.pointerX;v=a.pointerY}else{d=o._offset+p.x;v=s._offset+p.y}var m=i.readability(p.color,h)<1.5?f.contrast(h):p.color;var y=s.spikemode,x=s.spikethickness,b=s.spikecolor||m,_=s._boundingBox,w=(_.left+_.right)/2<d?_.right:_.left,k,M;if(y.indexOf("toaxis")!==-1||y.indexOf("across")!==-1){if(y.indexOf("toaxis")!==-1){k=w;M=d}if(y.indexOf("across")!==-1){k=s._counterSpan[0];M=s._counterSpan[1]}r.insert("line",":first-child").attr({x1:k,x2:M,y1:v,y2:v,"stroke-width":x,stroke:b,"stroke-dasharray":c.dashStyle(s.spikedash,x)}).classed("spikeline",true).classed("crisp",true);r.insert("line",":first-child").attr({x1:k,x2:M,y1:v,y2:v,"stroke-width":x+2,stroke:h}).classed("spikeline",true).classed("crisp",true)}if(y.indexOf("marker")!==-1){r.insert("circle",":first-child").attr({cx:w+(s.side!=="right"?x:-x),cy:v,r:x,fill:b}).classed("spikeline",true)}}if(u){var A=t.vLinePoint,T,S;o=A&&A.xa;s=A&&A.ya;var E=o.spikesnap;if(E==="cursor"){T=a.pointerX;S=a.pointerY}else{T=o._offset+A.x;S=s._offset+A.y}var C=i.readability(A.color,h)<1.5?f.contrast(h):A.color;var L=o.spikemode,I=o.spikethickness,z=o.spikecolor||C,P=o._boundingBox,O=(P.top+P.bottom)/2<S?P.bottom:P.top,D,R;if(L.indexOf("toaxis")!==-1||L.indexOf("across")!==-1){if(L.indexOf("toaxis")!==-1){D=O;R=S}if(L.indexOf("across")!==-1){D=o._counterSpan[0];R=o._counterSpan[1]}r.insert("line",":first-child").attr({x1:T,x2:T,y1:D,y2:R,"stroke-width":I,stroke:z,"stroke-dasharray":c.dashStyle(o.spikedash,I)}).classed("spikeline",true).classed("crisp",true);r.insert("line",":first-child").attr({x1:T,x2:T,y1:D,y2:R,"stroke-width":I+2,stroke:h}).classed("spikeline",true).classed("crisp",true)}if(L.indexOf("marker")!==-1){r.insert("circle",":first-child").attr({cx:T,cy:O-(o.side!=="top"?I:-I),r:I,fill:z}).classed("spikeline",true)}}}function L(t,e,r){if(!r||r.length!==t._hoverdata.length)return true;for(var n=r.length-1;n>=0;n--){var a=r[n],i=t._hoverdata[n];if(a.curveNumber!==i.curveNumber||String(a.pointNumber)!==String(i.pointNumber)){return true}}return false}function I(t,e){if(!e)return true;if(e.vLinePoint!==t._spikepoints.vLinePoint||e.hLinePoint!==t._spikepoints.hLinePoint)return true;return false}},{"../../lib":684,"../../lib/events":672,"../../lib/override_cursor":695,"../../lib/svg_text_utils":708,"../../plots/cartesian/axes":732,"../../registry":817,"../color":558,"../dragelement":580,"../drawing":583,"./constants":595,"./helpers":597,d3:147,"fast-isnumeric":214,tinycolor2:499}],599:[function(t,e,r){"use strict";var n=t("../../lib");e.exports=function t(e,r,a,i){i=i||{};a("hoverlabel.bgcolor",i.bgcolor);a("hoverlabel.bordercolor",i.bordercolor);a("hoverlabel.namelength",i.namelength);n.coerceFont(a,"hoverlabel.font",i.font)}},{"../../lib":684}],600:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../lib");var i=t("../dragelement");var o=t("./helpers");var s=t("./layout_attributes");e.exports={moduleType:"component",name:"fx",constants:t("./constants"),schema:{layout:s},attributes:t("./attributes"),layoutAttributes:s,supplyLayoutGlobalDefaults:t("./layout_global_defaults"),supplyDefaults:t("./defaults"),supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc"),getDistanceFunction:o.getDistanceFunction,getClosest:o.getClosest,inbox:o.inbox,quadrature:o.quadrature,appendArrayPointValue:o.appendArrayPointValue,castHoverOption:u,castHoverinfo:c,hover:t("./hover").hover,unhover:i.unhover,loneHover:t("./hover").loneHover,loneUnhover:l,click:t("./click")};function l(t){var e=a.isD3Selection(t)?t:n.select(t);e.selectAll("g.hovertext").remove();e.selectAll(".spikeline").remove()}function u(t,e,r){return a.castOption(t,e,"hoverlabel."+r)}function c(t,e,r){function n(r){return a.coerceHoverinfo({hoverinfo:r},{_module:t._module},e)}return a.castOption(t,r,"hoverinfo",n)}},{"../../lib":684,"../dragelement":580,"./attributes":592,"./calc":593,"./click":594,"./constants":595,"./defaults":596,"./helpers":597,"./hover":598,"./layout_attributes":601,"./layout_defaults":602,"./layout_global_defaults":603,d3:147}],601:[function(t,e,r){"use strict";var n=t("./constants");var a=t("../../plots/font_attributes")({editType:"none"});a.family.dflt=n.HOVERFONT;a.size.dflt=n.HOVERFONTSIZE;e.exports={dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","orbit","turntable"],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",false],editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:20,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:a,namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":758,"./constants":595}],602:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./layout_attributes");e.exports=function t(e,r,o){function s(t,i){return n.coerce(e,r,a,t,i)}var l=s("dragmode");if(l==="select")s("selectdirection");var u;if(r._has("cartesian")){r._isHoriz=i(o);u=r._isHoriz?"y":"x"}else u="closest";var c=s("hovermode",u);if(c){s("hoverdistance");s("spikedistance")}var f=r._has("mapbox");var h=r._has("geo");var p=r._basePlotModules.length;if(r.dragmode==="zoom"&&((f||h)&&p===1||f&&h&&p===2)){r.dragmode="pan"}};function i(t){var e=true;for(var r=0;r<t.length;r++){var n=t[r];if(n.orientation!=="h"){e=false;break}}return e}},{"../../lib":684,"./layout_attributes":601}],603:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./hoverlabel_defaults");var i=t("./layout_attributes");e.exports=function t(e,r){function o(t,a){return n.coerce(e,r,i,t,a)}a(e,r,o)}},{"../../lib":684,"./hoverlabel_defaults":599,"./layout_attributes":601}],604:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../lib/regex").counter;var i=t("../../plots/domain").attributes;var o=t("../../plots/cartesian/constants").idRegex;var s=t("../../plot_api/plot_template");var l={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:true,dimensions:2,items:{valType:"enumerated",values:[a("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:true,items:{valType:"enumerated",values:[o.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:true,items:{valType:"enumerated",values:[o.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:i({name:"grid",editType:"plot",noGridCell:true},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function u(t,e,r){var n=e[r+"axes"];var a=Object.keys((t._splomAxes||{})[r]||{});if(Array.isArray(n))return n;if(a.length)return a}function c(t,e){var r=t.grid||{};var a=u(e,r,"x");var i=u(e,r,"y");if(!t.grid&&!a&&!i)return;var o=Array.isArray(r.subplots)&&Array.isArray(r.subplots[0]);var c=Array.isArray(a);var h=Array.isArray(i);var p=c&&a!==r.xaxes&&h&&i!==r.yaxes;var d,v;if(o){d=r.subplots.length;v=r.subplots[0].length}else{if(h)d=i.length;if(c)v=a.length}var g=s.newContainer(e,"grid");function m(t,e){return n.coerce(r,g,l,t,e)}var y=m("rows",d);var x=m("columns",v);if(!(y*x>1)){delete e.grid;return}if(!o&&!c&&!h){var b=m("pattern")==="independent";if(b)o=true}g._hasSubplotGrid=o;var _=m("roworder");var w=_==="top to bottom";var k=o?.2:.1;var M=o?.3:.1;var A,T;if(p&&e._splomGridDflt){A=e._splomGridDflt.xside;T=e._splomGridDflt.yside}g._domains={x:f("x",m,k,A,x),y:f("y",m,M,T,y,w)}}function f(t,e,r,n,a,i){var o=e(t+"gap",r);var s=e("domain."+t);e(t+"side",n);var l=new Array(a);var u=s[0];var c=(s[1]-u)/(a-o);var f=c*(1-o);for(var h=0;h<a;h++){var p=u+c*h;l[i?a-1-h:h]=[p,p+f]}return l}function h(t,e){var r=e.grid;if(!r||!r._domains)return;var n=t.grid||{};var a=e._subplots;var i=r._hasSubplotGrid;var o=r.rows;var s=r.columns;var l=r.pattern==="independent";var c,f,h,d,v,g,m;var y=r._axisMap={};if(i){var x=n.subplots||[];g=r.subplots=new Array(o);var b=1;for(c=0;c<o;c++){var _=g[c]=new Array(s);var w=x[c]||[];for(f=0;f<s;f++){if(l){v=b===1?"xy":"x"+b+"y"+b;b++}else v=w[f];_[f]="";if(a.cartesian.indexOf(v)!==-1){m=v.indexOf("y");h=v.slice(0,m);d=v.slice(m);if(y[h]!==undefined&&y[h]!==f||y[d]!==undefined&&y[d]!==c){continue}_[f]=v;y[h]=f;y[d]=c}}}}else{var k=u(e,n,"x");var M=u(e,n,"y");r.xaxes=p(k,a.xaxis,s,y,"x");r.yaxes=p(M,a.yaxis,o,y,"y")}var A=r._anchors={};var T=r.roworder==="top to bottom";for(var S in y){var E=S.charAt(0);var C=r[E+"side"];var L,I,z;if(C.length<8){A[S]="free"}else if(E==="x"){if(C.charAt(0)==="t"===T){L=0;I=1;z=o}else{L=o-1;I=-1;z=-1}if(i){var P=y[S];for(c=L;c!==z;c+=I){v=g[c][P];if(!v)continue;m=v.indexOf("y");if(v.slice(0,m)===S){A[S]=v.slice(m);break}}}else{for(c=L;c!==z;c+=I){d=r.yaxes[c];if(a.cartesian.indexOf(S+d)!==-1){A[S]=d;break}}}}else{if(C.charAt(0)==="l"){L=0;I=1;z=s}else{L=s-1;I=-1;z=-1}if(i){var O=y[S];for(c=L;c!==z;c+=I){v=g[O][c];if(!v)continue;m=v.indexOf("y");if(v.slice(m)===S){A[S]=v.slice(0,m);break}}}else{for(c=L;c!==z;c+=I){h=r.xaxes[c];if(a.cartesian.indexOf(h+S)!==-1){A[S]=h;break}}}}}}function p(t,e,r,n,a){var i=new Array(r);var o;function s(t,r){if(e.indexOf(r)!==-1&&n[r]===undefined){i[t]=r;n[r]=t}else i[t]=""}if(Array.isArray(t)){for(o=0;o<r;o++){s(o,t[o])}}else{s(0,a);for(o=1;o<r;o++){s(o,a+(o+1))}}return i}e.exports={moduleType:"component",name:"grid",schema:{layout:{grid:l}},layoutAttributes:l,sizeDefaults:c,contentDefaults:h}},{"../../lib":684,"../../lib/regex":700,"../../plot_api/plot_template":722,"../../plots/cartesian/constants":737,"../../plots/domain":757}],605:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/constants");var a=t("../../plot_api/plot_template").templatedArray;e.exports=a("image",{visible:{valType:"boolean",dflt:true,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",n.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",n.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../plot_api/plot_template":722,"../../plots/cartesian/constants":737}],606:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib/to_log_range");e.exports=function t(e,r,i,o){r=r||{};var s=i==="log"&&r.type==="linear",l=i==="linear"&&r.type==="log";if(!(s||l))return;var u=e._fullLayout.images,c=r._id.charAt(0),f,h;for(var p=0;p<u.length;p++){f=u[p];h="images["+p+"].";if(f[c+"ref"]===r._id){var d=f[c],v=f["size"+c],g=null,m=null;if(s){g=a(d,r.range);var y=v/Math.pow(10,g)/2;m=2*Math.log(y+Math.sqrt(1+y*y))/Math.LN10}else{g=Math.pow(10,d);m=g*(Math.pow(10,v/2)-Math.pow(10,-v/2))}if(!n(g)){g=null;m=null}else if(!n(m))m=null;o(h+c,g);o(h+"size"+c,m)}}}},{"../../lib/to_log_range":710,"fast-isnumeric":214}],607:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/cartesian/axes");var i=t("../../plots/array_container_defaults");var o=t("./attributes");var s="images";e.exports=function t(e,r){var n={name:s,handleItemDefaults:l};i(e,r,n)};function l(t,e,r){function i(r,a){return n.coerce(t,e,o,r,a)}var s=i("source");var l=i("visible",!!s);if(!l)return e;i("layer");i("xanchor");i("yanchor");i("sizex");i("sizey");i("sizing");i("opacity");var u={_fullLayout:r},c=["x","y"];for(var f=0;f<2;f++){var h=c[f],p=a.coerceRef(t,e,u,h,"paper");a.coercePosition(e,u,i,p,h,0)}return e}},{"../../lib":684,"../../plots/array_container_defaults":728,"../../plots/cartesian/axes":732,"./attributes":605}],608:[function(t,e,r){"use strict";var n=t("d3");var a=t("../drawing");var i=t("../../plots/cartesian/axes");var o=t("../../constants/xmlns_namespaces");e.exports=function t(e){var r=e._fullLayout,s=[],l={},u=[],c,f;for(f=0;f<r.images.length;f++){var h=r.images[f];if(h.visible){if(h.layer==="below"&&h.xref!=="paper"&&h.yref!=="paper"){c=h.xref+h.yref;var p=r._plots[c];if(!p){u.push(h);continue}if(p.mainplot){c=p.mainplot.id}if(!l[c]){l[c]=[]}l[c].push(h)}else if(h.layer==="above"){s.push(h)}else{u.push(h)}}}var d={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function v(t){var r=n.select(this);if(this.img&&this.img.src===t.source){return}r.attr("xmlns",o.svg);var a=new Promise(function(e){var n=new Image;this.img=n;n.setAttribute("crossOrigin","anonymous");n.onerror=a;n.onload=function(){var t=document.createElement("canvas");t.width=this.width;t.height=this.height;var n=t.getContext("2d");n.drawImage(this,0,0);var a=t.toDataURL("image/png");r.attr("xlink:href",a);e()};r.on("error",a);n.src=t.source;function a(){r.remove();e()}}.bind(this));e._promises.push(a)}function g(t){var o=n.select(this);var s=i.getFromId(e,t.xref),l=i.getFromId(e,t.yref);var u=r._size,c=s?Math.abs(s.l2p(t.sizex)-s.l2p(0)):t.sizex*u.w,f=l?Math.abs(l.l2p(t.sizey)-l.l2p(0)):t.sizey*u.h;var h=c*d.x[t.xanchor].offset,p=f*d.y[t.yanchor].offset;var v=d.x[t.xanchor].sizing+d.y[t.yanchor].sizing;var g=(s?s.r2p(t.x)+s._offset:t.x*u.w+u.l)+h,m=(l?l.r2p(t.y)+l._offset:u.h-t.y*u.h+u.t)+p;switch(t.sizing){case"fill":v+=" slice";break;case"stretch":v="none";break}o.attr({x:g,y:m,width:c,height:f,preserveAspectRatio:v,opacity:t.opacity});var y=s?s._id:"",x=l?l._id:"",b=y+x;o.call(a.setClipUrl,b?"clip"+r._uid+b:null)}var m=r._imageLowerLayer.selectAll("image").data(u),y=r._imageUpperLayer.selectAll("image").data(s);m.enter().append("image");y.enter().append("image");m.exit().remove();y.exit().remove();m.each(function(t){v.bind(this)(t);g.bind(this)(t)});y.each(function(t){v.bind(this)(t);g.bind(this)(t)});var x=Object.keys(r._plots);for(f=0;f<x.length;f++){c=x[f];var b=r._plots[c];if(!b.imagelayer)continue;var _=b.imagelayer.selectAll("image").data(l[c]||[]);_.enter().append("image");_.exit().remove();_.each(function(t){v.bind(this)(t);g.bind(this)(t)})}}},{"../../constants/xmlns_namespaces":663,"../../plots/cartesian/axes":732,"../drawing":583,d3:147}],609:[function(t,e,r){"use strict";e.exports={moduleType:"component",name:"images",layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),includeBasePlot:t("../../plots/cartesian/include_components")("images"),draw:t("./draw"),convertCoords:t("./convert_coords")}},{"../../plots/cartesian/include_components":742,"./attributes":605,"./convert_coords":606,"./defaults":607,"./draw":608}],610:[function(t,e,r){"use strict";r.isRightAnchor=function t(e){return e.xanchor==="right"||e.xanchor==="auto"&&e.x>=2/3};r.isCenterAnchor=function t(e){return e.xanchor==="center"||e.xanchor==="auto"&&e.x>1/3&&e.x<2/3};r.isBottomAnchor=function t(e){return e.yanchor==="bottom"||e.yanchor==="auto"&&e.y<=1/3};r.isMiddleAnchor=function t(e){return e.yanchor==="middle"||e.yanchor==="auto"&&e.y>1/3&&e.y<2/3}},{}],611:[function(t,e,r){"use strict";var n=t("../../plots/font_attributes");var a=t("../color/attributes");e.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:a.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:n({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},x:{valType:"number",min:-2,max:3,dflt:1.02,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,dflt:1,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":758,"../color/attributes":557}],612:[function(t,e,r){"use strict";e.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4}},{}],613:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");var i=t("../../plot_api/plot_template");var o=t("./attributes");var s=t("../../plots/layout_attributes");var l=t("./helpers");e.exports=function t(e,r,u){var c=e.legend||{};var f=0;var h="normal";var p,d,v,g;for(var m=0;m<u.length;m++){var y=u[m];if(l.legendGetsTrace(y)){f++;if(n.traceIs(y,"pie"))f++}if(n.traceIs(y,"bar")&&r.barmode==="stack"||["tonextx","tonexty"].indexOf(y.fill)!==-1){h=l.isGrouped({traceorder:h})?"grouped+reversed":"reversed"}if(y.legendgroup!==undefined&&y.legendgroup!==""){h=l.isReversed({traceorder:h})?"reversed+grouped":"grouped"}}var x=a.coerce(e,r,s,"showlegend",f>1);if(x===false)return;var b=i.newContainer(r,"legend");function _(t,e){return a.coerce(c,b,o,t,e)}_("bgcolor",r.paper_bgcolor);_("bordercolor");_("borderwidth");a.coerceFont(_,"font",r.font);_("orientation");if(b.orientation==="h"){var w=e.xaxis;if(w&&w.rangeslider&&w.rangeslider.visible){p=0;v="left";d=1.1;g="bottom"}else{p=0;v="left";d=-.1;g="top"}}_("traceorder",h);if(l.isGrouped(r.legend))_("tracegroupgap");_("x",p);_("xanchor",v);_("y",d);_("yanchor",g);a.noneOrAll(c,b,["x","y"])}},{"../../lib":684,"../../plot_api/plot_template":722,"../../plots/layout_attributes":786,"../../registry":817,"./attributes":611,"./helpers":617}],614:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../lib");var i=t("../../plots/plots");var o=t("../../registry");var s=t("../../lib/events");var l=t("../dragelement");var u=t("../drawing");var c=t("../color");var f=t("../../lib/svg_text_utils");var h=t("./handle_click");var p=t("./constants");var d=t("../../constants/interactions");var v=t("../../constants/alignment");var g=v.LINE_SPACING;var m=v.FROM_TL;var y=v.FROM_BR;var x=t("./get_legend_data");var b=t("./style");var _=t("./helpers");var w=t("./anchor_utils");var k=d.DBLCLICKDELAY;e.exports=function t(e){var r=e._fullLayout;var s="legend"+r._uid;if(!r._infolayer||!e.calcdata)return;if(!e._legendMouseDownTime)e._legendMouseDownTime=0;var f=r.legend;var h=r.showlegend&&x(e.calcdata,f);var d=r.hiddenlabels||[];if(!r.showlegend||!h.length){r._infolayer.selectAll(".legend").remove();r._topdefs.select("#"+s).remove();i.autoMargin(e,"legend");return}var v=0;for(var g=0;g<h.length;g++){for(var m=0;m<h[g].length;m++){var y=h[g][m][0];var _=y.trace;var k=o.traceIs(_,"pie");var T=k?y.label:_.name;v=Math.max(v,T&&T.length||0)}}var E=false;var z=a.ensureSingle(r._infolayer,"g","legend",function(t){t.attr("pointer-events","all");E=true});var P=a.ensureSingleById(r._topdefs,"clipPath",s,function(t){t.append("rect")});var O=a.ensureSingle(z,"rect","bg",function(t){t.attr("shape-rendering","crispEdges")});O.call(c.stroke,f.bordercolor).call(c.fill,f.bgcolor).style("stroke-width",f.borderwidth+"px");var D=a.ensureSingle(z,"g","scrollbox");var R=a.ensureSingle(z,"rect","scrollbar",function(t){t.attr({rx:20,ry:3,width:0,height:0}).call(c.fill,"#808BA4")});var B=D.selectAll("g.groups").data(h);B.enter().append("g").attr("class","groups");B.exit().remove();var F=B.selectAll("g.traces").data(a.identity);F.enter().append("g").attr("class","traces");F.exit().remove();F.call(b,e).style("opacity",function(t){var e=t[0].trace;if(o.traceIs(e,"pie")){return d.indexOf(t[0].label)!==-1?.5:1}else{return e.visible==="legendonly"?.5:1}}).each(function(){n.select(this).call(A,e,v).call(S,e)});if(E){C(e,B,F);L(e)}var N=0,j=r.width,V=0,U=r.height;C(e,B,F);if(f._height>U){I(e)}else{L(e)}var q=r._size,H=q.l+q.w*f.x,G=q.t+q.h*(1-f.y);if(w.isRightAnchor(f)){H-=f._width}else if(w.isCenterAnchor(f)){H-=f._width/2}if(w.isBottomAnchor(f)){G-=f._height}else if(w.isMiddleAnchor(f)){G-=f._height/2}var W=f._width,Y=q.w;if(W>Y){H=q.l;W=Y}else{if(H+W>j)H=j-W;if(H<N)H=N;W=Math.min(j-H,f._width)}var X=f._height,Z=q.h;if(X>Z){G=q.t;X=Z}else{if(G+X>U)G=U-X;if(G<V)G=V;X=Math.min(U-G,f._height)}u.setTranslate(z,H,G);R.on(".drag",null);z.on("wheel",null);if(f._height<=X||e._context.staticPlot){O.attr({width:W-f.borderwidth,height:X-f.borderwidth,x:f.borderwidth/2,y:f.borderwidth/2});u.setTranslate(D,0,0);P.select("rect").attr({width:W-2*f.borderwidth,height:X-2*f.borderwidth,x:f.borderwidth,y:f.borderwidth});u.setClipUrl(D,s);u.setRect(R,0,0,0,0);delete f._scrollY}else{var $=Math.max(p.scrollBarMinHeight,X*X/f._height);var J=X-$-2*p.scrollBarMargin;var K=f._height-X;var Q=J/K;var tt=Math.min(f._scrollY||0,K);O.attr({width:W-2*f.borderwidth+p.scrollBarWidth+p.scrollBarMargin,height:X-f.borderwidth,x:f.borderwidth/2,y:f.borderwidth/2});P.select("rect").attr({width:W-2*f.borderwidth+p.scrollBarWidth+p.scrollBarMargin,height:X-2*f.borderwidth,x:f.borderwidth,y:f.borderwidth+tt});u.setClipUrl(D,s);at(tt,$,Q);z.on("wheel",function(){tt=a.constrain(f._scrollY+n.event.deltaY/J*K,0,K);at(tt,$,Q);if(tt!==0&&tt!==K){n.event.preventDefault()}});var et,rt;var nt=n.behavior.drag().on("dragstart",function(){et=n.event.sourceEvent.clientY;rt=tt}).on("drag",function(){var t=n.event.sourceEvent;if(t.buttons===2||t.ctrlKey)return;tt=a.constrain((t.clientY-et)/Q+rt,0,K);at(tt,$,Q)});R.call(nt)}function at(t,r,n){f._scrollY=e._fullLayout.legend._scrollY=t;u.setTranslate(D,0,-t);u.setRect(R,W,p.scrollBarMargin+t*n,p.scrollBarWidth,r);P.select("rect").attr({y:f.borderwidth+t})}if(e._context.edits.legendPosition){var it,ot,st,lt;z.classed("cursor-move",true);l.init({element:z.node(),gd:e,prepFn:function(){var t=u.getTranslate(z);st=t.x;lt=t.y},moveFn:function(t,e){var r=st+t,n=lt+e;u.setTranslate(z,r,n);it=l.align(r,0,q.l,q.l+q.w,f.xanchor);ot=l.align(n,0,q.t+q.h,q.t,f.yanchor)},doneFn:function(){if(it!==undefined&&ot!==undefined){o.call("relayout",e,{"legend.x":it,"legend.y":ot})}},clickFn:function(t,n){var a=r._infolayer.selectAll("g.traces").filter(function(){var t=this.getBoundingClientRect();return n.clientX>=t.left&&n.clientX<=t.right&&n.clientY>=t.top&&n.clientY<=t.bottom});if(a.size()>0){M(e,z,a,t,n)}}})}};function M(t,e,r,n,a){var i=r.data()[0][0].trace;var o={event:a,node:r.node(),curveNumber:i.index,expandedIndex:i._expandedIndex,data:t.data,layout:t.layout,frames:t._transitionData._frames,config:t._context,fullData:t._fullData,fullLayout:t._fullLayout};if(i._group){o.group=i._group}if(i.type==="pie"){o.label=r.datum()[0].label}var l=s.triggerHandler(t,"plotly_legendclick",o);if(l===false)return;if(n===1){e._clickTimeout=setTimeout(function(){h(r,t,n)},k)}else if(n===2){if(e._clickTimeout)clearTimeout(e._clickTimeout);t._legendMouseDownTime=0;var u=s.triggerHandler(t,"plotly_legenddoubleclick",o);if(u!==false)h(r,t,n)}}function A(t,e,r){var n=t.data()[0][0];var i=e._fullLayout;var s=n.trace;var l=o.traceIs(s,"pie");var c=s.index;var h=l?n.label:s.name;var p=e._context.edits.legendText&&!l;var d=a.ensureSingle(t,"text","legendtext");d.attr("text-anchor","start").classed("user-select-none",true).call(u.font,i.legend.font).text(p?T(h,r):h);function v(r){f.convertToTspans(r,e,function(){E(t,e)})}if(p){d.call(f.makeEditable,{gd:e,text:h}).call(v).on("edit",function(t){this.text(T(t,r)).call(v);var i=n.trace._fullInput||{};var s={};if(o.hasTransform(i,"groupby")){var l=o.getTransformIndices(i,"groupby");var u=l[l.length-1];var f=a.keyedContainer(i,"transforms["+u+"].styles","target","value.name");f.set(n.trace._group,t);s=f.constructUpdate()}else{s.name=t}return o.call("restyle",e,s,c)})}else{v(d)}}function T(t,e){var r=Math.max(4,e);if(t&&t.trim().length>=r/2)return t;t=t||"";for(var n=r-t.length;n>0;n--)t+=" ";return t}function S(t,e){var r,i=1;var o=a.ensureSingle(t,"rect","legendtoggle",function(t){t.style("cursor","pointer").attr("pointer-events","all").call(c.fill,"rgba(0,0,0,0)")});o.on("mousedown",function(){r=(new Date).getTime();if(r-e._legendMouseDownTime<k){i+=1}else{i=1;e._legendMouseDownTime=r}});o.on("mouseup",function(){if(e._dragged||e._editing)return;var r=e._fullLayout.legend;if((new Date).getTime()-e._legendMouseDownTime>k){i=Math.max(i-1,1)}M(e,r,t,i,n.event)})}function E(t,e){var r=t.data()[0][0];if(!r.trace.showlegend){t.remove();return}var n=t.select("g[class*=math-group]");var a=n.node();var i=e._fullLayout.legend;var o=i.font.size*g;var s,l;if(a){var c=u.bBox(a);s=c.height;l=c.width;u.setTranslate(n,0,s/4)}else{var h=t.select(".legendtext");var p=f.lineCount(h);var d=h.node();s=o*p;l=d?u.bBox(d).width:0;var v=o*(.3+(1-p)/2);f.positionText(h,40,v)}s=Math.max(s,16)+3;r.height=s;r.width=l}function C(t,e,r){var a=t._fullLayout;var i=a.legend;var o=i.borderwidth;var s=_.isGrouped(i);var l=0;i._width=0;i._height=0;if(_.isVertical(i)){if(s){e.each(function(t,e){u.setTranslate(this,0,e*i.tracegroupgap)})}r.each(function(t){var e=t[0],r=e.height,n=e.width;u.setTranslate(this,o,5+o+i._height+r/2);i._height+=r;i._width=Math.max(i._width,n)});i._width+=45+o*2;i._height+=10+o*2;if(s){i._height+=(i._lgroupsLength-1)*i.tracegroupgap}l=40}else if(s){var c=[i._width],f=e.data();for(var h=0,p=f.length;h<p;h++){var d=f[h].map(function(t){return t[0].width});var v=40+Math.max.apply(null,d);i._width+=i.tracegroupgap+v;c.push(i._width)}e.each(function(t,e){u.setTranslate(this,c[e],0)});e.each(function(){var t=n.select(this),e=t.selectAll("g.traces"),r=0;e.each(function(t){var e=t[0],n=e.height;u.setTranslate(this,0,5+o+r+n/2);r+=n});i._height=Math.max(i._height,r)});i._height+=10+o*2;i._width+=o*2}else{var g=0,m=0,y=0,x=0,b=0,w=i.tracegroupgap||5,k;r.each(function(t){y=Math.max(40+t[0].width,y);b+=40+t[0].width+w});k=a.width-(a.margin.r+a.margin.l)>o+b-w;r.each(function(t){var e=t[0],r=k?40+t[0].width:y;if(o+x+w+r>a.width-(a.margin.r+a.margin.l)){x=0;g=g+m;i._height=i._height+m;m=0}u.setTranslate(this,o+x,5+o+e.height/2+g);i._width+=w+r;i._height=Math.max(i._height,e.height);x+=w+r;m=Math.max(e.height,m)});i._width+=o*2;i._height+=10+o*2}i._width=Math.ceil(i._width);i._height=Math.ceil(i._height);r.each(function(e){var r=e[0],a=n.select(this).select(".legendtoggle");u.setRect(a,0,-r.height/2,(t._context.edits.legendText?0:i._width)+l,r.height)})}function L(t){var e=t._fullLayout,r=e.legend;var n="left";if(w.isRightAnchor(r)){n="right"}else if(w.isCenterAnchor(r)){n="center"}var a="top";if(w.isBottomAnchor(r)){a="bottom"}else if(w.isMiddleAnchor(r)){a="middle"}i.autoMargin(t,"legend",{x:r.x,y:r.y,l:r._width*m[n],r:r._width*y[n],b:r._height*y[a],t:r._height*m[a]})}function I(t){var e=t._fullLayout,r=e.legend;var n="left";if(w.isRightAnchor(r)){n="right"}else if(w.isCenterAnchor(r)){n="center"}i.autoMargin(t,"legend",{x:r.x,y:.5,l:r._width*m[n],r:r._width*y[n],b:0,t:0})}},{"../../constants/alignment":656,"../../constants/interactions":660,"../../lib":684,"../../lib/events":672,"../../lib/svg_text_utils":708,"../../plots/plots":795,"../../registry":817,"../color":558,"../dragelement":580,"../drawing":583,"./anchor_utils":610,"./constants":612,"./get_legend_data":615,"./handle_click":616,"./helpers":617,"./style":619,d3:147}],615:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("./helpers");e.exports=function t(e,r){var i={},o=[],s=false,l={},u=0;var c,f;function h(t,e){if(t===""||!a.isGrouped(r)){var n="~~i"+u;o.push(n);i[n]=[[e]];u++}else if(o.indexOf(t)===-1){o.push(t);s=true;i[t]=[[e]]}else i[t].push([e])}for(c=0;c<e.length;c++){var p=e[c],d=p[0],v=d.trace,g=v.legendgroup;if(!a.legendGetsTrace(v)||!v.showlegend)continue;if(n.traceIs(v,"pie")){if(!l[g])l[g]={};for(f=0;f<p.length;f++){var m=p[f].label;if(!l[g][m]){h(g,{label:m,color:p[f].color,i:p[f].i,trace:v});l[g][m]=true}}}else h(g,d)}if(!o.length)return[];var y=o.length,x,b;if(s&&a.isGrouped(r)){b=new Array(y);for(c=0;c<y;c++){x=i[o[c]];b[c]=a.isReversed(r)?x.reverse():x}}else{b=[new Array(y)];for(c=0;c<y;c++){x=i[o[c]][0];b[0][a.isReversed(r)?y-c-1:c]=x}y=1}r._lgroupsLength=y;return b}},{"../../registry":817,"./helpers":617}],616:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../registry");var i=true;e.exports=function t(e,r,o){if(r._dragged||r._editing)return;var s=r._fullLayout.hiddenlabels?r._fullLayout.hiddenlabels.slice():[];var l=e.data()[0][0];var u=r._fullData;var c=l.trace;var f=c.legendgroup;var h,p,d,v,g,m;var y={};var x=[];var b=[];var _=[];function w(t,e,r){var n=x.indexOf(t);var a=y[e];if(!a){a=y[e]=[]}if(x.indexOf(t)===-1){x.push(t);n=x.length-1}a[n]=r;return n}function k(t,e){var r=t._fullInput;if(a.hasTransform(r,"groupby")){var i=b[r.index];if(!i){var o=a.getTransformIndices(r,"groupby");var s=o[o.length-1];i=n.keyedContainer(r,"transforms["+s+"].styles","target","value.visible");b[r.index]=i}var l=i.get(t._group);if(l===undefined){l=true}if(l!==false){i.set(t._group,e)}_[r.index]=w(r.index,"visible",r.visible===false?false:true)}else{var u=r.visible===false?false:e;w(r.index,"visible",u)}}if(o===1&&i&&r.data&&r._context.showTips){n.notifier(n._(r,"Double-click on legend to isolate one trace"),"long");i=false}else{i=false}if(a.traceIs(c,"pie")){var M=l.label,A=s.indexOf(M);if(o===1){if(A===-1)s.push(M);else s.splice(A,1)}else if(o===2){s=[];r.calcdata[0].forEach(function(t){if(M!==t.label){s.push(t.label)}});if(r._fullLayout.hiddenlabels&&r._fullLayout.hiddenlabels.length===s.length&&A===-1){s=[]}}a.call("relayout",r,"hiddenlabels",s)}else{var T=f&&f.length;var S=[];var E;if(T){for(h=0;h<u.length;h++){E=u[h];if(!E.visible)continue;if(E.legendgroup===f){S.push(h)}}}if(o===1){var C;switch(c.visible){case true:C="legendonly";break;case false:C=false;break;case"legendonly":C=true;break}if(T){for(h=0;h<u.length;h++){if(u[h].visible!==false&&u[h].legendgroup===f){k(u[h],C)}}}else{k(c,C)}}else if(o===2){var L,I,z;var P=true;for(h=0;h<u.length;h++){L=u[h]===c;if(L)continue;I=T&&u[h].legendgroup===f;if(!I&&u[h].visible===true&&!a.traceIs(u[h],"notLegendIsolatable")){P=false;break}}for(h=0;h<u.length;h++){if(u[h].visible===false)continue;if(a.traceIs(u[h],"notLegendIsolatable")){continue}switch(c.visible){case"legendonly":k(u[h],true);break;case true:z=P?true:"legendonly";L=u[h]===c;I=L||T&&u[h].legendgroup===f;k(u[h],I?true:z);break}}}for(h=0;h<b.length;h++){d=b[h];if(!d)continue;var O=d.constructUpdate();var D=Object.keys(O);for(p=0;p<D.length;p++){v=D[p];m=y[v]=y[v]||[];m[_[h]]=O[v]}}g=Object.keys(y);for(h=0;h<g.length;h++){v=g[h];for(p=0;p<x.length;p++){if(!y[v].hasOwnProperty(p)){y[v][p]=undefined}}}a.call("restyle",r,y,x)}}},{"../../lib":684,"../../registry":817}],617:[function(t,e,r){"use strict";r.legendGetsTrace=function t(e){return e.visible&&e.showlegend!==undefined};r.isGrouped=function t(e){return(e.traceorder||"").indexOf("grouped")!==-1};r.isVertical=function t(e){return e.orientation!=="h"};r.isReversed=function t(e){return(e.traceorder||"").indexOf("reversed")!==-1}},{}],618:[function(t,e,r){"use strict";e.exports={moduleType:"component",name:"legend",layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),draw:t("./draw"),style:t("./style")}},{"./attributes":611,"./defaults":613,"./draw":614,"./style":619}],619:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../registry");var i=t("../../lib");var o=t("../drawing");var s=t("../color");var l=t("../../traces/scatter/subtypes");var u=t("../../traces/pie/style_one");e.exports=function t(e,r){e.each(function(t){var e=n.select(this);var r=i.ensureSingle(e,"g","layers");r.style("opacity",t[0].trace.opacity);var a=r.selectAll("g.legendfill").data([t]);a.enter().append("g").classed("legendfill",true);var o=r.selectAll("g.legendlines").data([t]);o.enter().append("g").classed("legendlines",true);var s=r.selectAll("g.legendsymbols").data([t]);s.enter().append("g").classed("legendsymbols",true);s.selectAll("g.legendpoints").data([t]).enter().append("g").classed("legendpoints",true)}).each(h).each(p).each(g).each(c).each(f).each(d).each(v);function c(t){var e=t[0].trace;var r=e.visible&&e.fill&&e.fill!=="none";var a=l.hasLines(e);var i=e.contours;if(i&&i.type==="constraint"){a=i.showlines;r=i._operation!=="="}var s=n.select(this).select(".legendfill").selectAll("path").data(r?[t]:[]);s.enter().append("path").classed("js-fill",true);s.exit().remove();s.attr("d","M5,0h30v6h-30z").call(o.fillGroupStyle);var u=n.select(this).select(".legendlines").selectAll("path").data(a?[t]:[]);u.enter().append("path").classed("js-line",true).attr("d","M5,0h30");u.exit().remove();u.call(o.lineGroupStyle)}function f(t){var e=t[0],a=e.trace,s=l.hasMarkers(a),u=l.hasText(a),c=l.hasLines(a);var f,h;function p(t,e,r){var n=i.nestedProperty(a,t).get(),o=Array.isArray(n)&&e?e(n):n;if(r){if(o<r[0])return r[0];else if(o>r[1])return r[1]}return o}function d(t){return t[0]}if(s||u||c){var v={};var g={};if(s){v.mc=p("marker.color",d);v.mo=p("marker.opacity",i.mean,[.2,1]);v.ms=p("marker.size",i.mean,[2,16]);v.mlc=p("marker.line.color",d);v.mlw=p("marker.line.width",i.mean,[0,5]);g.marker={sizeref:1,sizemin:1,sizemode:"diameter"}}if(c){g.line={width:p("line.width",d,[0,10])}}if(u){v.tx="Aa";v.tp=p("textposition",d);v.ts=10;v.tc=p("textfont.color",d);v.tf=p("textfont.family",d)}f=[i.minExtend(e,v)];h=i.minExtend(a,g);h.selectedpoints=null}var m=n.select(this).select("g.legendpoints");var y=m.selectAll("path.scatterpts").data(s?f:[]);y.enter().append("path").classed("scatterpts",true).attr("transform","translate(20,0)");y.exit().remove();y.call(o.pointStyle,h,r);if(s)f[0].mrc=3;var x=m.selectAll("g.pointtext").data(u?f:[]);x.enter().append("g").classed("pointtext",true).append("text").attr("transform","translate(20,0)");x.exit().remove();x.selectAll("text").call(o.textPointStyle,h,r)}function h(t){var e=t[0].trace,r=e.marker||{},i=r.line||{},o=n.select(this).select("g.legendpoints").selectAll("path.legendbar").data(a.traceIs(e,"bar")?[t]:[]);o.enter().append("path").classed("legendbar",true).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");o.exit().remove();o.each(function(t){var e=n.select(this),a=t[0],o=(a.mlw+1||i.width+1)-1;e.style("stroke-width",o+"px").call(s.fill,a.mc||r.color);if(o){e.call(s.stroke,a.mlc||i.color)}})}function p(t){var e=t[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendbox").data(a.traceIs(e,"box-violin")&&e.visible?[t]:[]);r.enter().append("path").classed("legendbox",true).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");r.exit().remove();r.each(function(){var t=e.line.width,r=n.select(this);r.style("stroke-width",t+"px").call(s.fill,e.fillcolor);if(t){s.stroke(r,e.line.color)}})}function d(t){var e=t[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(e.type==="candlestick"&&e.visible?[t,t]:[]);r.enter().append("path").classed("legendcandle",true).attr("d",function(t,e){if(e)return"M-15,0H-8M-8,6V-6H8Z";return"M15,0H8M8,-6V6H-8Z"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1);r.exit().remove();r.each(function(t,r){var a=e[r?"increasing":"decreasing"];var i=a.line.width,o=n.select(this);o.style("stroke-width",i+"px").call(s.fill,a.fillcolor);if(i){s.stroke(o,a.line.color)}})}function v(t){var e=t[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(e.type==="ohlc"&&e.visible?[t,t]:[]);r.enter().append("path").classed("legendohlc",true).attr("d",function(t,e){if(e)return"M-15,0H0M-8,-6V0";return"M15,0H0M8,6V0"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1);r.exit().remove();r.each(function(t,r){var a=e[r?"increasing":"decreasing"];var i=a.line.width,l=n.select(this);l.style("fill","none").call(o.dashLine,a.line.dash,i);if(i){s.stroke(l,a.line.color)}})}function g(t){var e=t[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendpie").data(a.traceIs(e,"pie")&&e.visible?[t]:[]);r.enter().append("path").classed("legendpie",true).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");r.exit().remove();if(r.size())r.call(u,t[0],e)}}},{"../../lib":684,"../../registry":817,"../../traces/pie/style_one":1001,"../../traces/scatter/subtypes":1037,"../color":558,"../drawing":583,d3:147}],620:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../plots/plots");var i=t("../../plots/cartesian/axis_ids");var o=t("../../lib");var s=t("../../../build/ploticon");var l=o._;var u=e.exports={};u.toImage={name:"toImage",title:function(t){var e=t._context.toImageButtonOptions||{};var r=e.format||"png";return r==="png"?l(t,"Download plot as a png"):l(t,"Download plot")},icon:s.camera,click:function(t){var e=t._context.toImageButtonOptions;var r={format:e.format||"png"};o.notifier(l(t,"Taking snapshot - this may take a few seconds"),"long");if(r.format!=="svg"&&o.isIE()){o.notifier(l(t,"IE only supports svg.  Changing format to svg."),"long");r.format="svg"}["filename","width","height","scale"].forEach(function(t){if(e[t]){r[t]=e[t]}});n.call("downloadImage",t,r).then(function(e){o.notifier(l(t,"Snapshot succeeded")+" - "+e,"long")}).catch(function(){o.notifier(l(t,"Sorry, there was a problem downloading your snapshot!"),"long")})}};u.sendDataToCloud={name:"sendDataToCloud",title:function(t){return l(t,"Edit in Chart Studio")},icon:s.disk,click:function(t){a.sendDataToCloud(t)}};u.zoom2d={name:"zoom2d",title:function(t){return l(t,"Zoom")},attr:"dragmode",val:"zoom",icon:s.zoombox,click:c};u.pan2d={name:"pan2d",title:function(t){return l(t,"Pan")},attr:"dragmode",val:"pan",icon:s.pan,click:c};u.select2d={name:"select2d",title:function(t){return l(t,"Box Select")},attr:"dragmode",val:"select",icon:s.selectbox,click:c};u.lasso2d={name:"lasso2d",title:function(t){return l(t,"Lasso Select")},attr:"dragmode",val:"lasso",icon:s.lasso,click:c};u.zoomIn2d={name:"zoomIn2d",title:function(t){return l(t,"Zoom in")},attr:"zoom",val:"in",icon:s.zoom_plus,click:c};u.zoomOut2d={name:"zoomOut2d",title:function(t){return l(t,"Zoom out")},attr:"zoom",val:"out",icon:s.zoom_minus,click:c};u.autoScale2d={name:"autoScale2d",title:function(t){return l(t,"Autoscale")},attr:"zoom",val:"auto",icon:s.autoscale,click:c};u.resetScale2d={name:"resetScale2d",title:function(t){return l(t,"Reset axes")},attr:"zoom",val:"reset",icon:s.home,click:c};u.hoverClosestCartesian={name:"hoverClosestCartesian",title:function(t){return l(t,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:s.tooltip_basic,gravity:"ne",click:c};u.hoverCompareCartesian={name:"hoverCompareCartesian",title:function(t){return l(t,"Compare data on hover")},attr:"hovermode",val:function(t){return t._fullLayout._isHoriz?"y":"x"},icon:s.tooltip_compare,gravity:"ne",click:c};function c(t,e){var r=e.currentTarget;var a=r.getAttribute("data-attr");var o=r.getAttribute("data-val")||true;var s=t._fullLayout;var l={};var u=i.list(t,null,true);var c="on";var f,h;if(a==="zoom"){var p=o==="in"?.5:2,d=(1+p)/2,v=(1-p)/2;var g;for(h=0;h<u.length;h++){f=u[h];if(!f.fixedrange){g=f._name;if(o==="auto")l[g+".autorange"]=true;else if(o==="reset"){if(f._rangeInitial===undefined){l[g+".autorange"]=true}else{var m=f._rangeInitial.slice();l[g+".range[0]"]=m[0];l[g+".range[1]"]=m[1]}if(f._showSpikeInitial!==undefined){l[g+".showspikes"]=f._showSpikeInitial;if(c==="on"&&!f._showSpikeInitial){c="off"}}}else{var y=[f.r2l(f.range[0]),f.r2l(f.range[1])];var x=[d*y[0]+v*y[1],d*y[1]+v*y[0]];l[g+".range[0]"]=f.l2r(x[0]);l[g+".range[1]"]=f.l2r(x[1])}}}s._cartesianSpikesEnabled=c}else{if(a==="hovermode"&&(o==="x"||o==="y")){o=s._isHoriz?"y":"x";r.setAttribute("data-val",o)}else if(a==="hovermode"&&o==="closest"){for(h=0;h<u.length;h++){f=u[h];if(c==="on"&&!f.showspikes){c="off"}}s._cartesianSpikesEnabled=c}l[a]=o}n.call("relayout",t,l)}u.zoom3d={name:"zoom3d",title:function(t){return l(t,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:s.zoombox,click:f};u.pan3d={name:"pan3d",title:function(t){return l(t,"Pan")},attr:"scene.dragmode",val:"pan",icon:s.pan,click:f};u.orbitRotation={name:"orbitRotation",title:function(t){return l(t,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:s["3d_rotate"],click:f};u.tableRotation={name:"tableRotation",title:function(t){return l(t,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:s["z-axis"],click:f};function f(t,e){var r=e.currentTarget;var a=r.getAttribute("data-attr");var i=r.getAttribute("data-val")||true;var o=t._fullLayout._subplots.gl3d;var s={};var l=a.split(".");for(var u=0;u<o.length;u++){s[o[u]+"."+l[1]]=i}var c=i==="pan"?i:"zoom";s.dragmode=c;n.call("relayout",t,s)}u.resetCameraDefault3d={name:"resetCameraDefault3d",title:function(t){return l(t,"Reset camera to default")},attr:"resetDefault",icon:s.home,click:h};u.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:function(t){return l(t,"Reset camera to last save")},attr:"resetLastSave",icon:s.movie,click:h};function h(t,e){var r=e.currentTarget;var a=r.getAttribute("data-attr");var i=t._fullLayout;var s=i._subplots.gl3d;var l={};for(var u=0;u<s.length;u++){var c=s[u],f=c+".camera",h=i[c]._scene;if(a==="resetDefault"){l[f]=null}else if(a==="resetLastSave"){l[f]=o.extendDeep({},h.cameraInitial)}}n.call("relayout",t,l)}u.hoverClosest3d={name:"hoverClosest3d",title:function(t){return l(t,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:p};function p(t,e){var r=e.currentTarget;var a=r._previousVal||false;var i=t.layout;var s=t._fullLayout;var l=s._subplots.gl3d;var u=["xaxis","yaxis","zaxis"];var c=["showspikes","spikesides","spikethickness","spikecolor"];var f={};var h={};var p={};if(a){p=o.extendDeep(i,a);r._previousVal=null}else{p={"allaxes.showspikes":false};for(var d=0;d<l.length;d++){var v=l[d],g=s[v],m=f[v]={};m.hovermode=g.hovermode;p[v+".hovermode"]=false;for(var y=0;y<3;y++){var x=u[y];h=m[x]={};for(var b=0;b<c.length;b++){var _=c[b];h[_]=g[x][_]}}}r._previousVal=o.extendDeep({},f)}n.call("relayout",t,p)}u.zoomInGeo={name:"zoomInGeo",title:function(t){return l(t,"Zoom in")},attr:"zoom",val:"in",icon:s.zoom_plus,click:d};u.zoomOutGeo={name:"zoomOutGeo",title:function(t){return l(t,"Zoom out")},attr:"zoom",val:"out",icon:s.zoom_minus,click:d};u.resetGeo={name:"resetGeo",title:function(t){return l(t,"Reset")},attr:"reset",val:null,icon:s.autoscale,click:d};u.hoverClosestGeo={name:"hoverClosestGeo",title:function(t){return l(t,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:v};function d(t,e){var r=e.currentTarget;var a=r.getAttribute("data-attr");var i=r.getAttribute("data-val")||true;var o=t._fullLayout;var s=o._subplots.geo;for(var l=0;l<s.length;l++){var u=s[l];var c=o[u];if(a==="zoom"){var f=c.projection.scale;var h=i==="in"?2*f:.5*f;n.call("relayout",t,u+".projection.scale",h)}else if(a==="reset"){m(t,"geo")}}}u.hoverClosestGl2d={name:"hoverClosestGl2d",title:function(t){return l(t,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:v};u.hoverClosestPie={name:"hoverClosestPie",title:function(t){return l(t,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:s.tooltip_basic,gravity:"ne",click:v};function v(t){var e=t._fullLayout;var r;if(e._has("cartesian")){r=e._isHoriz?"y":"x"}else r="closest";var a=t._fullLayout.hovermode?false:r;n.call("relayout",t,"hovermode",a)}u.toggleHover={name:"toggleHover",title:function(t){return l(t,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:function(t,e){v(t);p(t,e)}};u.resetViews={name:"resetViews",title:function(t){return l(t,"Reset views")},icon:s.home,click:function(t,e){var r=e.currentTarget;r.setAttribute("data-attr","zoom");r.setAttribute("data-val","reset");c(t,e);r.setAttribute("data-attr","resetLastSave");h(t,e);m(t,"geo");m(t,"mapbox")}};u.toggleSpikelines={name:"toggleSpikelines",title:function(t){return l(t,"Toggle Spike Lines")},icon:s.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(t){var e=t._fullLayout;e._cartesianSpikesEnabled=e._cartesianSpikesEnabled==="on"?"off":"on";var r=g(t);n.call("relayout",t,r)}};function g(t){var e=t._fullLayout;var r=i.list(t,null,true);var n={};var a,o;for(var s=0;s<r.length;s++){a=r[s];o=a._name;n[o+".showspikes"]=e._cartesianSpikesEnabled==="on"?true:a._showSpikeInitial}return n}u.resetViewMapbox={name:"resetViewMapbox",title:function(t){return l(t,"Reset view")},attr:"reset",icon:s.home,click:function(t){m(t,"mapbox")}};function m(t,e){var r=t._fullLayout;var a=r._subplots[e];var i={};for(var o=0;o<a.length;o++){var s=a[o];var l=r[s]._subplot;var u=l.viewInitial;var c=Object.keys(u);for(var f=0;f<c.length;f++){var h=c[f];i[s+"."+h]=u[h]}}n.call("relayout",t,i)}},{"../../../build/ploticon":2,"../../lib":684,"../../plots/cartesian/axis_ids":735,"../../plots/plots":795,"../../registry":817}],621:[function(t,e,r){"use strict";r.manage=t("./manage")},{"./manage":622}],622:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/axis_ids");var a=t("../../traces/scatter/subtypes");var i=t("../../registry");var o=t("./modebar");var s=t("./buttons");e.exports=function t(e){var r=e._fullLayout,n=e._context,a=r._modeBar;if(!n.displayModeBar){if(a){a.destroy();delete r._modeBar}return}if(!Array.isArray(n.modeBarButtonsToRemove)){throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "))}if(!Array.isArray(n.modeBarButtonsToAdd)){throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "))}var i=n.modeBarButtons;var s;if(Array.isArray(i)&&i.length){s=h(i)}else{s=l(e,n.modeBarButtonsToRemove,n.modeBarButtonsToAdd)}if(a)a.update(e,s);else r._modeBar=o(e,s)};function l(t,e,r){var n=t._fullLayout;var a=t._fullData;var i=n._has("cartesian");var o=n._has("gl3d");var l=n._has("geo");var h=n._has("pie");var p=n._has("gl2d");var d=n._has("ternary");var v=n._has("mapbox");var g=n._has("polar");var m=u(n);var y=[];function x(t){if(!t.length)return;var r=[];for(var n=0;n<t.length;n++){var a=t[n];if(e.indexOf(a)!==-1)continue;r.push(s[a])}y.push(r)}x(["toImage","sendDataToCloud"]);var b=[];var _=[];var w=[];var k=[];if((i||p||h||d)+l+o+v+g>1){_=["toggleHover"];w=["resetViews"]}else if(l){b=["zoomInGeo","zoomOutGeo"];_=["hoverClosestGeo"];w=["resetGeo"]}else if(o){_=["hoverClosest3d"];w=["resetCameraDefault3d","resetCameraLastSave3d"]}else if(v){_=["toggleHover"];w=["resetViewMapbox"]}else if(p){_=["hoverClosestGl2d"]}else if(h){_=["hoverClosestPie"]}else{_=["toggleHover"]}if(i){_=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]}if((i||p)&&!m){b=["zoomIn2d","zoomOut2d","autoScale2d"];if(w[0]!=="resetViews")w=["resetScale2d"]}if(o){k=["zoom3d","pan3d","orbitRotation","tableRotation"]}else if((i||p)&&!m||d){k=["zoom2d","pan2d"]}else if(v||l){k=["pan2d"]}else if(g){k=["zoom2d"]}if(c(a)){k.push("select2d","lasso2d")}x(k);x(b.concat(w));x(_);return f(y,r)}function u(t){var e=n.list({_fullLayout:t},null,true);for(var r=0;r<e.length;r++){if(!e[r].fixedrange){return false}}return true}function c(t){var e=false;for(var r=0;r<t.length;r++){if(e)break;var n=t[r];if(!n._module||!n._module.selectPoints)continue;if(i.traceIs(n,"scatter-like")){if(a.hasMarkers(n)||a.hasText(n)){e=true}}else if(i.traceIs(n,"box-violin")){if(n.boxpoints==="all"||n.points==="all"){e=true}}else e=true}return e}function f(t,e){if(e.length){if(Array.isArray(e[0])){for(var r=0;r<e.length;r++){t.push(e[r])}}else t.push(e)}return t}function h(t){for(var e=0;e<t.length;e++){var r=t[e];for(var n=0;n<r.length;n++){var a=r[n];if(typeof a==="string"){if(s[a]!==undefined){t[e][n]=s[a]}else{throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}}}}return t}},{"../../plots/cartesian/axis_ids":735,"../../registry":817,"../../traces/scatter/subtypes":1037,"./buttons":620,"./modebar":623}],623:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("../../lib");var o=t("../../../build/ploticon");function s(t){this.container=t.container;this.element=document.createElement("div");this.update(t.graphInfo,t.buttons);this.container.appendChild(this.element)}var l=s.prototype;l.update=function(t,e){this.graphInfo=t;var r=this.graphInfo._context;if(r.displayModeBar==="hover"){this.element.className="modebar modebar--hover"}else this.element.className="modebar";var n=!this.hasButtons(e);var a=this.hasLogo!==r.displaylogo;var i=this.locale!==r.locale;this.locale=r.locale;if(n||a||i){this.removeAllButtons();this.updateButtons(e);if(r.displaylogo){this.element.appendChild(this.getLogo());this.hasLogo=true}}this.updateActiveButton()};l.updateButtons=function(t){var e=this;this.buttons=t;this.buttonElements=[];this.buttonsNames=[];this.buttons.forEach(function(t){var r=e.createGroup();t.forEach(function(t){var n=t.name;if(!n){throw new Error("must provide button 'name' in button config")}if(e.buttonsNames.indexOf(n)!==-1){throw new Error("button name '"+n+"' is taken")}e.buttonsNames.push(n);var a=e.createButton(t);e.buttonElements.push(a);r.appendChild(a)});e.element.appendChild(r)})};l.createGroup=function(){var t=document.createElement("div");t.className="modebar-group";return t};l.createButton=function(t){var e=this,r=document.createElement("a");r.setAttribute("rel","tooltip");r.className="modebar-btn";var a=t.title;if(a===undefined)a=t.name;else if(typeof a==="function")a=a(this.graphInfo);if(a||a===0)r.setAttribute("data-title",a);if(t.attr!==undefined)r.setAttribute("data-attr",t.attr);var i=t.val;if(i!==undefined){if(typeof i==="function")i=i(this.graphInfo);r.setAttribute("data-val",i)}var s=t.click;if(typeof s!=="function"){throw new Error("must provide button 'click' function in button config")}else{r.addEventListener("click",function(r){t.click(e.graphInfo,r);e.updateActiveButton(r.currentTarget)})}r.setAttribute("data-toggle",t.toggle||false);if(t.toggle)n.select(r).classed("active",true);var l=t.icon;if(typeof l==="function"){r.appendChild(l())}else{r.appendChild(this.createIcon(l||o.question))}r.setAttribute("data-gravity",t.gravity||"n");return r};l.createIcon=function(t){var e=a(t.height)?Number(t.height):t.ascent-t.descent,r="http://www.w3.org/2000/svg",n=document.createElementNS(r,"svg"),i=document.createElementNS(r,"path");n.setAttribute("height","1em");n.setAttribute("width",t.width/e+"em");n.setAttribute("viewBox",[0,0,t.width,e].join(" "));i.setAttribute("d",t.path);if(t.transform){i.setAttribute("transform",t.transform)}else if(t.ascent!==undefined){i.setAttribute("transform","matrix(1 0 0 -1 0 "+t.ascent+")")}n.appendChild(i);return n};l.updateActiveButton=function(t){var e=this.graphInfo._fullLayout,r=t!==undefined?t.getAttribute("data-attr"):null;this.buttonElements.forEach(function(t){var a=t.getAttribute("data-val")||true,o=t.getAttribute("data-attr"),s=t.getAttribute("data-toggle")==="true",l=n.select(t);if(s){if(o===r){l.classed("active",!l.classed("active"))}}else{var u=o===null?o:i.nestedProperty(e,o).get();l.classed("active",u===a)}})};l.hasButtons=function(t){var e=this.buttons;if(!e)return false;if(t.length!==e.length)return false;for(var r=0;r<t.length;++r){if(t[r].length!==e[r].length)return false;for(var n=0;n<t[r].length;n++){if(t[r][n].name!==e[r][n].name)return false}}return true};l.getLogo=function(){var t=this.createGroup(),e=document.createElement("a");e.href="https://plot.ly/";e.target="_blank";e.setAttribute("data-title",i._(this.graphInfo,"Produced with Plotly"));e.className="modebar-btn plotlyjsicon modebar-btn--logo";e.appendChild(this.createIcon(o.plotlylogo));t.appendChild(e);return t};l.removeAllButtons=function(){while(this.element.firstChild){this.element.removeChild(this.element.firstChild)}this.hasLogo=false};l.destroy=function(){i.removeElement(this.container.querySelector(".modebar"))};function u(t,e){var r=t._fullLayout;var a=new s({graphInfo:t,container:r._paperdiv.node(),buttons:e});if(r._privateplot){n.select(a.element).append("span").classed("badge-private float--left",true).text("PRIVATE")}return a}e.exports=u},{"../../../build/ploticon":2,"../../lib":684,d3:147,"fast-isnumeric":214}],624:[function(t,e,r){"use strict";var n=t("../../plots/font_attributes");var a=t("../color/attributes");var i=t("../../plot_api/plot_template").templatedArray;var o=i("button",{visible:{valType:"boolean",dflt:true,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});e.exports={visible:{valType:"boolean",editType:"plot"},buttons:o,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:n({editType:"plot"}),bgcolor:{valType:"color",dflt:a.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:a.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":722,"../../plots/font_attributes":758,"../color/attributes":557}],625:[function(t,e,r){"use strict";e.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],626:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../color");var i=t("../../plot_api/plot_template");var o=t("../../plots/array_container_defaults");var s=t("./attributes");var l=t("./constants");e.exports=function t(e,r,f,h,p){var d=e.rangeselector||{};var v=i.newContainer(r,"rangeselector");function g(t,e){return n.coerce(d,v,s,t,e)}var m=o(d,v,{name:"buttons",handleItemDefaults:u,calendar:p});var y=g("visible",m.length>0);if(y){var x=c(r,f,h);g("x",x[0]);g("y",x[1]);n.noneOrAll(e,r,["x","y"]);g("xanchor");g("yanchor");n.coerceFont(g,"font",f.font);var b=g("bgcolor");g("activecolor",a.contrast(b,l.lightAmount,l.darkAmount));g("bordercolor");g("borderwidth")}};function u(t,e,r,a){var i=a.calendar;function o(r,a){return n.coerce(t,e,s.buttons,r,a)}var l=o("visible");if(l){var u=o("step");if(u!=="all"){if(i&&i!=="gregorian"&&(u==="month"||u==="year")){e.stepmode="backward"}else{o("stepmode")}o("count")}o("label")}}function c(t,e,r){var n=r.filter(function(r){return e[r].anchor===t._id});var a=0;for(var i=0;i<n.length;i++){var o=e[n[i]].domain;if(o)a=Math.max(o[1],a)}return[t.domain[0],a+l.yPad]}},{"../../lib":684,"../../plot_api/plot_template":722,"../../plots/array_container_defaults":728,"../color":558,"./attributes":624,"./constants":625}],627:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../registry");var i=t("../../plots/plots");var o=t("../color");var s=t("../drawing");var l=t("../../lib");var u=t("../../lib/svg_text_utils");var c=t("../../plots/cartesian/axis_ids");var f=t("../legend/anchor_utils");var h=t("../../constants/alignment");var p=h.LINE_SPACING;var d=h.FROM_TL;var v=h.FROM_BR;var g=t("./constants");var m=t("./get_update_object");e.exports=function t(e){var r=e._fullLayout;var i=r._infolayer.selectAll(".rangeselector").data(y(e),x);i.enter().append("g").classed("rangeselector",true);i.exit().remove();i.style({cursor:"pointer","pointer-events":"all"});i.each(function(t){var r=n.select(this),i=t,o=i.rangeselector;var s=r.selectAll("g.button").data(l.filterVisible(o.buttons));s.enter().append("g").classed("button",true);s.exit().remove();s.each(function(t){var r=n.select(this);var s=m(i,t);t._isActive=b(i,t,s);r.call(_,o,t);r.call(k,o,t,e);r.on("click",function(){if(e._dragged)return;a.call("relayout",e,s)});r.on("mouseover",function(){t._isHovered=true;r.call(_,o,t)});r.on("mouseout",function(){t._isHovered=false;r.call(_,o,t)})});A(e,s,o,i._name,r)})};function y(t){var e=c.list(t,"x",true);var r=[];for(var n=0;n<e.length;n++){var a=e[n];if(a.rangeselector&&a.rangeselector.visible){r.push(a)}}return r}function x(t){return t._id}function b(t,e,r){if(e.step==="all"){return t.autorange===true}else{var n=Object.keys(r);return t.range[0]===r[n[0]]&&t.range[1]===r[n[1]]}}function _(t,e,r){var n=l.ensureSingle(t,"rect","selector-rect",function(t){t.attr("shape-rendering","crispEdges")});n.attr({rx:g.rx,ry:g.ry});n.call(o.stroke,e.bordercolor).call(o.fill,w(e,r)).style("stroke-width",e.borderwidth+"px")}function w(t,e){return e._isActive||e._isHovered?t.activecolor:t.bgcolor}function k(t,e,r,n){function a(t){u.convertToTspans(t,n)}var i=l.ensureSingle(t,"text","selector-text",function(t){t.classed("user-select-none",true).attr("text-anchor","middle")});i.call(s.font,e.font).text(M(r)).call(a)}function M(t){if(t.label)return t.label;if(t.step==="all")return"all";return t.count+t.step.charAt(0)}function A(t,e,r,a,o){var l=0;var c=0;var h=r.borderwidth;e.each(function(){var t=n.select(this);var e=t.select(".selector-text");var a=r.font.size*p;var i=Math.max(a*u.lineCount(e),16)+3;c=Math.max(c,i)});e.each(function(){var t=n.select(this);var e=t.select(".selector-rect");var a=t.select(".selector-text");var i=a.node()&&s.bBox(a.node()).width;var o=r.font.size*p;var f=u.lineCount(a);var d=Math.max(i+10,g.minButtonWidth);t.attr("transform","translate("+(h+l)+","+h+")");e.attr({x:0,y:0,width:d,height:c});u.positionText(a,d/2,c/2-(f-1)*o/2+3);l+=d+5});var m=t._fullLayout._size;var y=m.l+m.w*r.x;var x=m.t+m.h*(1-r.y);var b="left";if(f.isRightAnchor(r)){y-=l;b="right"}if(f.isCenterAnchor(r)){y-=l/2;b="center"}var _="top";if(f.isBottomAnchor(r)){x-=c;_="bottom"}if(f.isMiddleAnchor(r)){x-=c/2;_="middle"}l=Math.ceil(l);c=Math.ceil(c);y=Math.round(y);x=Math.round(x);i.autoMargin(t,a+"-range-selector",{x:r.x,y:r.y,l:l*d[b],r:l*v[b],b:c*v[_],t:c*d[_]});o.attr("transform","translate("+y+","+x+")")}},{"../../constants/alignment":656,"../../lib":684,"../../lib/svg_text_utils":708,"../../plots/cartesian/axis_ids":735,"../../plots/plots":795,"../../registry":817,"../color":558,"../drawing":583,"../legend/anchor_utils":610,"./constants":625,"./get_update_object":628,d3:147}],628:[function(t,e,r){"use strict";var n=t("d3");e.exports=function t(e,r){var n=e._name;var i={};if(r.step==="all"){i[n+".autorange"]=true}else{var o=a(e,r);i[n+".range[0]"]=o[0];i[n+".range[1]"]=o[1]}return i};function a(t,e){var r=t.range;var a=new Date(t.r2l(r[1]));var i=e.step,o=e.count;var s;switch(e.stepmode){case"backward":s=t.l2r(+n.time[i].utc.offset(a,-o));break;case"todate":var l=n.time[i].utc.offset(a,-o);s=t.l2r(+n.time[i].utc.ceil(l));break}var u=r[1];return[s,u]}},{d3:147}],629:[function(t,e,r){"use strict";e.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:t("./attributes")}}},layoutAttributes:t("./attributes"),handleDefaults:t("./defaults"),draw:t("./draw")}},{"./attributes":624,"./defaults":626,"./draw":627}],630:[function(t,e,r){"use strict";var n=t("../color/attributes");e.exports={bgcolor:{valType:"color",dflt:n.background,editType:"plot"},bordercolor:{valType:"color",dflt:n.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:true,editType:"calc",impliedEdits:{"range[0]":undefined,"range[1]":undefined}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":false}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":false}}],editType:"calc",impliedEdits:{autorange:false}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:true,editType:"calc"},editType:"calc"}},{"../color/attributes":557}],631:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/axis_ids").list;var a=t("../../plots/cartesian/autorange").getAutoRange;var i=t("./constants");e.exports=function t(e){var r=n(e,"x",true);for(var o=0;o<r.length;o++){var s=r[o],l=s[i.name];if(l&&l.visible&&l.autorange&&s._min.length&&s._max.length){l._input.autorange=true;l._input.range=l.range=a(s)}}}},{"../../plots/cartesian/autorange":731,"../../plots/cartesian/axis_ids":735,"./constants":632}],632:[function(t,e,r){"use strict";e.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],633:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plot_api/plot_template");var i=t("../../plots/cartesian/axis_ids");var o=t("./attributes");var s=t("./oppaxis_attributes");e.exports=function t(e,r,l){var u=e[l];var c=r[l];if(!(u.rangeslider||r._requestRangeslider[c._id]))return;if(!n.isPlainObject(u.rangeslider)){u.rangeslider={}}var f=u.rangeslider;var h=a.newContainer(c,"rangeslider");function p(t,e){return n.coerce(f,h,o,t,e)}var d,v;function g(t,e){return n.coerce(d,v,s,t,e)}var m=p("visible");if(!m)return;p("bgcolor",r.plot_bgcolor);p("bordercolor");p("borderwidth");p("thickness");c._rangesliderAutorange=p("autorange",!c.isValidRange(f.range));p("range");var y=r._subplots;if(y){var x=y.cartesian.filter(function(t){return t.substr(0,t.indexOf("y"))===i.name2id(l)}).map(function(t){return t.substr(t.indexOf("y"),t.length)});var b=n.simpleMap(x,i.id2name);for(var _=0;_<b.length;_++){var w=b[_];d=f[w]||{};v=a.newContainer(h,w,"yaxis");var k=r[w];var M;if(d.range&&k.isValidRange(d.range)){M="fixed"}var A=g("rangemode",M);if(A!=="match"){g("range",k.range.slice())}k._rangesliderAutorange=A==="auto"}}h._input=f}},{"../../lib":684,"../../plot_api/plot_template":722,"../../plots/cartesian/axis_ids":735,"./attributes":630,"./oppaxis_attributes":636}],634:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../registry");var i=t("../../plots/plots");var o=t("../../lib");var s=t("../drawing");var l=t("../color");var u=t("../titles");var c=t("../../plots/cartesian");var f=t("../../plots/cartesian/axes");var h=t("../dragelement");var p=t("../../lib/setcursor");var d=t("./constants");e.exports=function(t){var e=t._fullLayout,r=v(e);function a(t){return t._name}var o=e._infolayer.selectAll("g."+d.containerClassName).data(r,a);o.enter().append("g").classed(d.containerClassName,true).attr("pointer-events","all");o.exit().each(function(t){var r=t[d.name];e._topdefs.select("#"+r._clipId).remove()}).remove();if(r.length===0)return;o.each(function(r){var a=n.select(this),o=r[d.name],s=e[f.id2name(r.anchor)],l=o[f.id2name(r.anchor)];if(o.range){var c=o.range;var h=r.range;c[0]=r.l2r(Math.min(r.r2l(c[0]),r.r2l(h[0])));c[1]=r.l2r(Math.max(r.r2l(c[1]),r.r2l(h[1])));o._input.range=c.slice()}r.cleanRange("rangeslider.range");var p=e.margin;var v=e._size;var m=r.domain;var w=(r._boundingBox||{}).height||0;var T=Infinity;var S=f.getSubplots(t,r);for(var E=0;E<S.length;E++){var C=f.getFromId(t,S[E].substr(S[E].indexOf("y")));T=Math.min(T,C.domain[0])}o._id=d.name+r._id;o._clipId=o._id+"-"+e._uid;o._width=v.w*(m[1]-m[0]);o._height=(e.height-p.b-p.t)*o.thickness;o._offsetShift=Math.floor(o.borderwidth/2);var L=Math.round(p.l+v.w*m[0]);var I=Math.round(v.t+v.h*(1-T)+w+o._offsetShift+d.extraPad);a.attr("transform","translate("+L+","+I+")");var z=r.r2l(o.range[0]),P=r.r2l(o.range[1]),O=P-z;o.p2d=function(t){return t/o._width*O+z};o.d2p=function(t){return(t-z)/O*o._width};o._rl=[z,P];if(l.rangemode!=="match"){var D=s.r2l(l.range[0]),R=s.r2l(l.range[1]),B=R-D;o.d2pOppAxis=function(t){return(t-D)/B*o._height}}a.call(x,t,r,o).call(b,t,r,o).call(_,t,r,o).call(k,t,r,o,l).call(M,t,r,o).call(A,t,r,o);g(a,t,r,o);y(a,t,r,o,s,l);if(r.side==="bottom"){u.draw(t,r._id+"title",{propContainer:r,propName:r._name+".title",placeholder:e._dfltTitle.x,attributes:{x:r._offset+r._length/2,y:I+o._height+o._offsetShift+10+1.5*r.titlefont.size,"text-anchor":"middle"}})}i.autoMargin(t,o._id,{x:m[0],y:T,l:0,r:0,t:0,b:o._height+p.b+w,pad:d.extraPad+o._offsetShift*2})})};function v(t){var e=f.list({_fullLayout:t},"x",true),r=d.name,n=[];if(t._has("gl2d"))return n;for(var a=0;a<e.length;a++){var i=e[a];if(i[r]&&i[r].visible)n.push(i)}return n}function g(t,e,r,a){var i=t.select("rect."+d.slideBoxClassName).node(),s=t.select("rect."+d.grabAreaMinClassName).node(),l=t.select("rect."+d.grabAreaMaxClassName).node();t.on("mousedown",function(){var u=n.event,c=u.target,f=u.clientX,d=f-t.node().getBoundingClientRect().left,v=a.d2p(r._rl[0]),g=a.d2p(r._rl[1]);var y=h.coverSlip();y.addEventListener("mousemove",x);y.addEventListener("mouseup",b);function x(o){var u=+o.clientX-f;var h,x,b;switch(c){case i:b="ew-resize";h=v+u;x=g+u;break;case s:b="col-resize";h=v+u;x=g;break;case l:b="col-resize";h=v;x=g+u;break;default:b="ew-resize";h=d;x=d+u;break}if(x<h){var _=x;x=h;h=_}a._pixelMin=h;a._pixelMax=x;p(n.select(y),b);m(t,e,r,a)}function b(){y.removeEventListener("mousemove",x);y.removeEventListener("mouseup",b);o.removeElement(y)}})}function m(t,e,r,n){function i(t){return r.l2r(o.constrain(t,n._rl[0],n._rl[1]))}var s=i(n.p2d(n._pixelMin)),l=i(n.p2d(n._pixelMax));window.requestAnimationFrame(function(){a.call("relayout",e,r._name+".range",[s,l])})}function y(t,e,r,n,a,i){var s=d.handleWidth/2;function l(t){return o.constrain(t,0,n._width)}function u(t){return o.constrain(t,0,n._height)}function c(t){return o.constrain(t,-s,n._width+s)}var f=l(n.d2p(r._rl[0])),h=l(n.d2p(r._rl[1]));t.select("rect."+d.slideBoxClassName).attr("x",f).attr("width",h-f);t.select("rect."+d.maskMinClassName).attr("width",f);t.select("rect."+d.maskMaxClassName).attr("x",h).attr("width",n._width-h);if(i.rangemode!=="match"){var p=n._height-u(n.d2pOppAxis(a._rl[1])),v=n._height-u(n.d2pOppAxis(a._rl[0]));t.select("rect."+d.maskMinOppAxisClassName).attr("x",f).attr("height",p).attr("width",h-f);t.select("rect."+d.maskMaxOppAxisClassName).attr("x",f).attr("y",v).attr("height",n._height-v).attr("width",h-f);t.select("rect."+d.slideBoxClassName).attr("y",p).attr("height",v-p)}var g=.5;var m=Math.round(c(f-s))-g,y=Math.round(c(h-s))+g;t.select("g."+d.grabberMinClassName).attr("transform","translate("+m+","+g+")");t.select("g."+d.grabberMaxClassName).attr("transform","translate("+y+","+g+")")}function x(t,e,r,n){var a=o.ensureSingle(t,"rect",d.bgClassName,function(t){t.attr({x:0,y:0,"shape-rendering":"crispEdges"})});var i=n.borderwidth%2===0?n.borderwidth:n.borderwidth-1;var l=-n._offsetShift;var u=s.crispRound(e,n.borderwidth);a.attr({width:n._width+i,height:n._height+i,transform:"translate("+l+","+l+")",fill:n.bgcolor,stroke:n.bordercolor,"stroke-width":u})}function b(t,e,r,n){var a=e._fullLayout;var i=o.ensureSingleById(a._topdefs,"clipPath",n._clipId,function(t){t.append("rect").attr({x:0,y:0})});i.select("rect").attr({width:n._width,height:n._height})}function _(t,e,r,a){var l=f.getSubplots(e,r),u=e.calcdata;var h=t.selectAll("g."+d.rangePlotClassName).data(l,o.identity);h.enter().append("g").attr("class",function(t){return d.rangePlotClassName+" "+t}).call(s.setClipUrl,a._clipId);h.order();h.exit().remove();var p;h.each(function(t,o){var s=n.select(this),l=o===0;var h=f.getFromId(e,t,"y"),d=h._name,v=a[d];var g={data:[],layout:{xaxis:{type:r.type,domain:[0,1],range:a.range.slice(),calendar:r.calendar},width:a._width,height:a._height,margin:{t:0,b:0,l:0,r:0}},_context:e._context};g.layout[d]={type:h.type,domain:[0,1],range:v.rangemode!=="match"?v.range.slice():h.range.slice(),calendar:h.calendar};i.supplyDefaults(g);var m=g._fullLayout.xaxis;var y=g._fullLayout[d];var x={id:t,plotgroup:s,xaxis:m,yaxis:y,isRangePlot:true};if(l)p=x;else{x.mainplot="xy";x.mainplotinfo=p}c.rangePlot(e,x,w(u,t))})}function w(t,e){var r=[];for(var n=0;n<t.length;n++){var a=t[n],i=a[0].trace;if(i.xaxis+i.yaxis===e){r.push(a)}}return r}function k(t,e,r,n,a){var i=o.ensureSingle(t,"rect",d.maskMinClassName,function(t){t.attr({x:0,y:0,"shape-rendering":"crispEdges"})});i.attr("height",n._height).call(l.fill,d.maskColor);var s=o.ensureSingle(t,"rect",d.maskMaxClassName,function(t){t.attr({y:0,"shape-rendering":"crispEdges"})});s.attr("height",n._height).call(l.fill,d.maskColor);if(a.rangemode!=="match"){var u=o.ensureSingle(t,"rect",d.maskMinOppAxisClassName,function(t){t.attr({y:0,"shape-rendering":"crispEdges"})});u.attr("width",n._width).call(l.fill,d.maskOppAxisColor);var c=o.ensureSingle(t,"rect",d.maskMaxOppAxisClassName,function(t){t.attr({y:0,"shape-rendering":"crispEdges"})});c.attr("width",n._width).style("border-top",d.maskOppBorder).call(l.fill,d.maskOppAxisColor)}}function M(t,e,r,n){if(e._context.staticPlot)return;var a=o.ensureSingle(t,"rect",d.slideBoxClassName,function(t){t.attr({y:0,cursor:d.slideBoxCursor,"shape-rendering":"crispEdges"})});a.attr({height:n._height,fill:d.slideBoxFill})}function A(t,e,r,n){var a=o.ensureSingle(t,"g",d.grabberMinClassName);var i=o.ensureSingle(t,"g",d.grabberMaxClassName);var s={x:0,width:d.handleWidth,rx:d.handleRadius,fill:l.background,stroke:l.defaultLine,"stroke-width":d.handleStrokeWidth,"shape-rendering":"crispEdges"};var u={y:Math.round(n._height/4),height:Math.round(n._height/2)};var c=o.ensureSingle(a,"rect",d.handleMinClassName,function(t){t.attr(s)});c.attr(u);var f=o.ensureSingle(i,"rect",d.handleMaxClassName,function(t){t.attr(s)});f.attr(u);if(e._context.staticPlot)return;var h={width:d.grabAreaWidth,x:0,y:0,fill:d.grabAreaFill,cursor:d.grabAreaCursor};var p=o.ensureSingle(a,"rect",d.grabAreaMinClassName,function(t){t.attr(h)});p.attr("height",n._height);var v=o.ensureSingle(i,"rect",d.grabAreaMaxClassName,function(t){t.attr(h)});v.attr("height",n._height)}},{"../../lib":684,"../../lib/setcursor":704,"../../plots/cartesian":743,"../../plots/cartesian/axes":732,"../../plots/plots":795,"../../registry":817,"../color":558,"../dragelement":580,"../drawing":583,"../titles":649,"./constants":632,d3:147}],635:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./attributes");var i=t("./oppaxis_attributes");e.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:n.extendFlat({},a,{yaxis:i})}}},layoutAttributes:t("./attributes"),handleDefaults:t("./defaults"),calcAutorange:t("./calc_autorange"),draw:t("./draw")}},{"../../lib":684,"./attributes":630,"./calc_autorange":631,"./defaults":633,"./draw":634,"./oppaxis_attributes":636}],636:[function(t,e,r){"use strict";e.exports={_isSubplotObj:true,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],637:[function(t,e,r){"use strict";var n=t("../annotations/attributes");var a=t("../../traces/scatter/attributes").line;var i=t("../drawing/attributes").dash;var o=t("../../lib/extend").extendFlat;var s=t("../../plot_api/plot_template").templatedArray;e.exports=s("shape",{visible:{valType:"boolean",dflt:true,editType:"calcIfAutorange+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calcIfAutorange+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:o({},n.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calcIfAutorange+arraydraw"},xanchor:{valType:"any",editType:"calcIfAutorange+arraydraw"},x0:{valType:"any",editType:"calcIfAutorange+arraydraw"},x1:{valType:"any",editType:"calcIfAutorange+arraydraw"},yref:o({},n.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calcIfAutorange+arraydraw"},yanchor:{valType:"any",editType:"calcIfAutorange+arraydraw"},y0:{valType:"any",editType:"calcIfAutorange+arraydraw"},y1:{valType:"any",editType:"calcIfAutorange+arraydraw"},path:{valType:"string",editType:"calcIfAutorange+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:o({},a.color,{editType:"arraydraw"}),width:o({},a.width,{editType:"calcIfAutorange+arraydraw"}),dash:o({},i,{editType:"arraydraw"}),editType:"calcIfAutorange+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},editType:"arraydraw"})},{"../../lib/extend":673,"../../plot_api/plot_template":722,"../../traces/scatter/attributes":1015,"../annotations/attributes":541,"../drawing/attributes":582}],638:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/cartesian/axes");var i=t("./constants");var o=t("./helpers");e.exports=function t(e){var r=e._fullLayout,o=n.filterVisible(r.shapes);if(!o.length||!e._fullData.length)return;for(var u=0;u<o.length;u++){var f=o[u];var h,p;if(f.xref!=="paper"){var d=f.xsizemode==="pixel"?f.xanchor:f.x0,v=f.xsizemode==="pixel"?f.xanchor:f.x1;h=a.getFromId(e,f.xref);p=c(h,d,v,f.path,i.paramIsX);if(p)a.expand(h,p,s(f))}if(f.yref!=="paper"){var g=f.ysizemode==="pixel"?f.yanchor:f.y0,m=f.ysizemode==="pixel"?f.yanchor:f.y1;h=a.getFromId(e,f.yref);p=c(h,g,m,f.path,i.paramIsY);if(p)a.expand(h,p,l(f))}}};function s(t){return u(t.line.width,t.xsizemode,t.x0,t.x1,t.path,false)}function l(t){return u(t.line.width,t.ysizemode,t.y0,t.y1,t.path,true)}function u(t,e,r,a,s,l){var u=t/2,c=l;if(e==="pixel"){var f=s?o.extractPathCoords(s,l?i.paramIsY:i.paramIsX):[r,a];var h=n.aggNums(Math.max,null,f),p=n.aggNums(Math.min,null,f),d=p<0?Math.abs(p)+u:u,v=h>0?h+u:u;return{ppad:u,ppadplus:c?d:v,ppadminus:c?v:d}}else{return{ppad:u}}}function c(t,e,r,n,a){var s=t.type==="category"?t.r2c:t.d2c;if(e!==undefined)return[s(e),s(r)];if(!n)return;var l=Infinity,u=-Infinity,c=n.match(i.segmentRE),f,h,p,d,v;if(t.type==="date")s=o.decodeDate(s);for(f=0;f<c.length;f++){h=c[f];p=a[h.charAt(0)].drawn;if(p===undefined)continue;d=c[f].substr(1).match(i.paramRE);if(!d||d.length<p)continue;v=s(d[p]);if(v<l)l=v;if(v>u)u=v}if(u>=l)return[l,u]}},{"../../lib":684,"../../plots/cartesian/axes":732,"./constants":639,"./helpers":642}],639:[function(t,e,r){"use strict";e.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:true,drawn:0},L:{0:true,drawn:0},H:{0:true,drawn:0},V:{},Q:{0:true,2:true,drawn:2},C:{0:true,2:true,4:true,drawn:4},T:{0:true,drawn:0},S:{0:true,2:true,drawn:2},Z:{}},paramIsY:{M:{1:true,drawn:1},L:{1:true,drawn:1},H:{},V:{0:true,drawn:0},Q:{1:true,3:true,drawn:3},C:{1:true,3:true,5:true,drawn:5},T:{1:true,drawn:1},S:{1:true,3:true,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],640:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/cartesian/axes");var i=t("../../plots/array_container_defaults");var o=t("./attributes");var s=t("./helpers");e.exports=function t(e,r){i(e,r,{name:"shapes",handleItemDefaults:l})};function l(t,e,r){function i(r,a){return n.coerce(t,e,o,r,a)}var l=i("visible");if(!l)return;i("layer");i("opacity");i("fillcolor");i("line.color");i("line.width");i("line.dash");var u=t.path?"path":"rect",c=i("type",u),f=i("xsizemode"),h=i("ysizemode");var p=["x","y"];for(var d=0;d<2;d++){var v=p[d],g=v+"anchor",m=v==="x"?f:h,y={_fullLayout:r},x,b,_;var w=a.coerceRef(t,e,y,v,"","paper");if(w!=="paper"){x=a.getFromId(y,w);_=s.rangeToShapePosition(x);b=s.shapePositionToRange(x)}else{b=_=n.identity}if(c!=="path"){var k=.25,M=.75;var A=v+"0",T=v+"1",S=t[A],E=t[T];t[A]=b(t[A],true);t[T]=b(t[T],true);if(m==="pixel"){i(A,0);i(T,10)}else{a.coercePosition(e,y,i,w,A,k);a.coercePosition(e,y,i,w,T,M)}e[A]=_(e[A]);e[T]=_(e[T]);t[A]=S;t[T]=E}if(m==="pixel"){var C=t[g];t[g]=b(t[g],true);a.coercePosition(e,y,i,w,g,.25);e[g]=_(e[g]);t[g]=C}}if(c==="path"){i("path")}else{n.noneOrAll(t,e,["x0","x1","y0","y1"])}}},{"../../lib":684,"../../plots/array_container_defaults":728,"../../plots/cartesian/axes":732,"./attributes":637,"./helpers":642}],641:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");var i=t("../../plots/cartesian/axes");var o=t("../color");var s=t("../drawing");var l=t("../../plot_api/plot_template").arrayEditor;var u=t("../dragelement");var c=t("../../lib/setcursor");var f=t("./constants");var h=t("./helpers");e.exports={draw:p,drawOne:d};function p(t){var e=t._fullLayout;e._shapeUpperLayer.selectAll("path").remove();e._shapeLowerLayer.selectAll("path").remove();for(var r in e._plots){var n=e._plots[r].shapelayer;if(n)n.selectAll("path").remove()}for(var a=0;a<e.shapes.length;a++){if(e.shapes[a].visible){d(t,a)}}}function d(t,e){t._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+e+'"]').remove();var r=t._fullLayout.shapes[e]||{};if(!r._input||r.visible===false)return;if(r.layer!=="below"){i(t._fullLayout._shapeUpperLayer)}else if(r.xref==="paper"||r.yref==="paper"){i(t._fullLayout._shapeLowerLayer)}else{var n=t._fullLayout._plots[r.xref+r.yref];if(n){var a=n.mainplotinfo||n;i(a.shapelayer)}else{i(t._fullLayout._shapeLowerLayer)}}function i(n){var a={"data-index":e,"fill-rule":"evenodd",d:m(t,r)},i=r.line.width?r.line.color:"rgba(0,0,0,0)";var l=n.append("path").attr(a).style("opacity",r.opacity).call(o.stroke,i).call(o.fill,r.fillcolor).call(s.dashLine,r.line.dash,r.line.width);v(l,t,r);if(t._context.edits.shapePosition)g(t,l,r,e,n)}}function v(t,e,r){var n=(r.xref+r.yref).replace(/paper/g,"");t.call(s.setClipUrl,n?"clip"+e._fullLayout._uid+n:null)}function g(t,e,r,o,p){var d=10;var g=10;var y=r.xsizemode==="pixel";var b=r.ysizemode==="pixel";var _=r.type==="line";var w=r.type==="path";var k=l(t.layout,"shapes",r);var M=k.modifyItem;var A,T,S,E,C,L;var I,z,P,O,D,R,B,F;var N;var j=i.getFromId(t,r.xref),V=i.getFromId(t,r.yref),U=h.getDataToPixel(t,j),q=h.getDataToPixel(t,V,true),H=h.getPixelToData(t,j),G=h.getPixelToData(t,V,true);var W=Z();var Y={element:W.node(),gd:t,prepFn:K,doneFn:Q,clickFn:tt},X;u.init(Y);W.node().onmousemove=J;function Z(){return _?$():e}function $(){var t=10,n=Math.max(r.line.width,t);var a=p.append("g").attr("data-index",o);a.append("path").attr("d",e.attr("d")).style({cursor:"move","stroke-width":n,"stroke-opacity":"0"});var i={"fill-opacity":"0"};var s=n/2>t?n/2:t;a.append("circle").attr({"data-line-point":"start-point",cx:y?U(r.xanchor)+r.x0:U(r.x0),cy:b?q(r.yanchor)-r.y0:q(r.y0),r:s}).style(i).classed("cursor-grab",true);a.append("circle").attr({"data-line-point":"end-point",cx:y?U(r.xanchor)+r.x1:U(r.x1),cy:b?q(r.yanchor)-r.y1:q(r.y1),r:s}).style(i).classed("cursor-grab",true);return a}function J(t){if(_){if(t.target.tagName==="path"){X="move"}else{X=t.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point"}}else{var r=Y.element.getBoundingClientRect();var n=r.right-r.left,a=r.bottom-r.top,i=t.clientX-r.left,o=t.clientY-r.top,s=!w&&n>d&&a>g&&!t.shiftKey?u.getCursor(i/n,1-o/a):"move";c(e,s);X=s.split("-")[0]}}function K(n){if(y){C=U(r.xanchor)}if(b){L=q(r.yanchor)}if(r.type==="path"){N=r.path}else{A=y?r.x0:U(r.x0);T=b?r.y0:q(r.y0);S=y?r.x1:U(r.x1);E=b?r.y1:q(r.y1)}if(A<S){P=A;B="x0";O=S;F="x1"}else{P=S;B="x1";O=A;F="x0"}if(!b&&T<E||b&&T>E){I=T;D="y0";z=E;R="y1"}else{I=E;D="y1";z=T;R="y0"}J(n);nt(p,r);it(e,r,t);Y.moveFn=X==="move"?et:rt}function Q(){c(e);at(p);v(e,t,r);n.call("relayout",t,k.getUpdateObj())}function tt(){at(p)}function et(n,a){if(r.type==="path"){var i=function(t){return t},o=i,s=i;if(y){M("xanchor",r.xanchor=H(C+n))}else{o=function t(e){return H(U(e)+n)};if(j&&j.type==="date")o=h.encodeDate(o)}if(b){M("yanchor",r.yanchor=G(L+a))}else{s=function t(e){return G(q(e)+a)};if(V&&V.type==="date")s=h.encodeDate(s)}M("path",r.path=x(N,o,s))}else{if(y){M("xanchor",r.xanchor=H(C+n))}else{M("x0",r.x0=H(A+n));M("x1",r.x1=H(S+n))}if(b){M("yanchor",r.yanchor=G(L+a))}else{M("y0",r.y0=G(T+a));M("y1",r.y1=G(E+a))}}e.attr("d",m(t,r));nt(p,r)}function rt(n,a){if(w){var i=function(t){return t},o=i,s=i;if(y){M("xanchor",r.xanchor=H(C+n))}else{o=function t(e){return H(U(e)+n)};if(j&&j.type==="date")o=h.encodeDate(o)}if(b){M("yanchor",r.yanchor=G(L+a))}else{s=function t(e){return G(q(e)+a)};if(V&&V.type==="date")s=h.encodeDate(s)}M("path",r.path=x(N,o,s))}else if(_){if(X==="resize-over-start-point"){var l=A+n;var u=b?T-a:T+a;M("x0",r.x0=y?l:H(l));M("y0",r.y0=b?u:G(u))}else if(X==="resize-over-end-point"){var c=S+n;var f=b?E-a:E+a;M("x1",r.x1=y?c:H(c));M("y1",r.y1=b?f:G(f))}}else{var v=~X.indexOf("n")?I+a:I,k=~X.indexOf("s")?z+a:z,W=~X.indexOf("w")?P+n:P,Y=~X.indexOf("e")?O+n:O;if(~X.indexOf("n")&&b)v=I-a;if(~X.indexOf("s")&&b)k=z-a;if(!b&&k-v>g||b&&v-k>g){M(D,r[D]=b?v:G(v));M(R,r[R]=b?k:G(k))}if(Y-W>d){M(B,r[B]=y?W:H(W));M(F,r[F]=y?Y:H(Y))}}e.attr("d",m(t,r));nt(p,r)}function nt(t,e){if(y||b){r()}function r(){var r=e.type!=="path";var n=t.selectAll(".visual-cue").data([0]);var i=1;n.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":i}).classed("visual-cue",true);var o=U(y?e.xanchor:a.midRange(r?[e.x0,e.x1]:h.extractPathCoords(e.path,f.paramIsX)));var s=q(b?e.yanchor:a.midRange(r?[e.y0,e.y1]:h.extractPathCoords(e.path,f.paramIsY)));o=h.roundPositionForSharpStrokeRendering(o,i);s=h.roundPositionForSharpStrokeRendering(s,i);if(y&&b){var l="M"+(o-1-i)+","+(s-1-i)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";n.attr("d",l)}else if(y){var u="M"+(o-1-i)+","+(s-9-i)+"v18 h2 v-18 Z";n.attr("d",u)}else{var c="M"+(o-9-i)+","+(s-1-i)+"h18 v2 h-18 Z";n.attr("d",c)}}}function at(t){t.selectAll(".visual-cue").remove()}function it(t,e,r){var n=e.xref,a=e.yref,o=i.getFromId(r,n),l=i.getFromId(r,a);var u="";if(n!=="paper"&&!o.autorange)u+=n;if(a!=="paper"&&!l.autorange)u+=a;t.call(s.setClipUrl,u?"clip"+r._fullLayout._uid+u:null)}}function m(t,e){var r=e.type,n=i.getFromId(t,e.xref),a=i.getFromId(t,e.yref),o=t._fullLayout._size,s,l,u,c,f,p,d,v;if(n){s=h.shapePositionToRange(n);l=function(t){return n._offset+n.r2p(s(t,true))}}else{l=function(t){return o.l+o.w*t}}if(a){u=h.shapePositionToRange(a);c=function(t){return a._offset+a.r2p(u(t,true))}}else{c=function(t){return o.t+o.h*(1-t)}}if(r==="path"){if(n&&n.type==="date")l=h.decodeDate(l);if(a&&a.type==="date")c=h.decodeDate(c);return y(e,l,c)}if(e.xsizemode==="pixel"){var g=l(e.xanchor);f=g+e.x0;p=g+e.x1}else{f=l(e.x0);p=l(e.x1)}if(e.ysizemode==="pixel"){var m=c(e.yanchor);d=m-e.y0;v=m-e.y1}else{d=c(e.y0);v=c(e.y1)}if(r==="line")return"M"+f+","+d+"L"+p+","+v;if(r==="rect")return"M"+f+","+d+"H"+p+"V"+v+"H"+f+"Z";var x=(f+p)/2,b=(d+v)/2,_=Math.abs(x-f),w=Math.abs(b-d),k="A"+_+","+w,M=x+_+","+b,A=x+","+(b-w);return"M"+M+k+" 0 1,1 "+A+k+" 0 0,1 "+M+"Z"}function y(t,e,r){var n=t.path,i=t.xsizemode,o=t.ysizemode,s=t.xanchor,l=t.yanchor;return n.replace(f.segmentRE,function(t){var n=0,u=t.charAt(0),c=f.paramIsX[u],h=f.paramIsY[u],p=f.numParams[u];var d=t.substr(1).replace(f.paramRE,function(t){if(c[n]){if(i==="pixel")t=e(s)+Number(t);else t=e(t)}else if(h[n]){if(o==="pixel")t=r(l)-Number(t);else t=r(t)}n++;if(n>p)t="X";return t});if(n>p){d=d.replace(/[\s,]*X.*/,"");a.log("Ignoring extra params in segment "+t)}return u+d})}function x(t,e,r){return t.replace(f.segmentRE,function(t){var n=0,a=t.charAt(0),i=f.paramIsX[a],o=f.paramIsY[a],s=f.numParams[a];var l=t.substr(1).replace(f.paramRE,function(t){if(n>=s)return t;if(i[n])t=e(t);else if(o[n])t=r(t);n++;return t});return a+l})}},{"../../lib":684,"../../lib/setcursor":704,"../../plot_api/plot_template":722,"../../plots/cartesian/axes":732,"../../registry":817,"../color":558,"../dragelement":580,"../drawing":583,"./constants":639,"./helpers":642}],642:[function(t,e,r){"use strict";var n=t("./constants");var a=t("../../lib");r.rangeToShapePosition=function(t){return t.type==="log"?t.r2d:function(t){return t}};r.shapePositionToRange=function(t){return t.type==="log"?t.d2r:function(t){return t}};r.decodeDate=function(t){return function(e){if(e.replace)e=e.replace("_"," ");return t(e)}};r.encodeDate=function(t){return function(e){return t(e).replace(" ","_")}};r.extractPathCoords=function(t,e){var r=[];var i=t.match(n.segmentRE);i.forEach(function(t){var i=e[t.charAt(0)].drawn;if(i===undefined)return;var o=t.substr(1).match(n.paramRE);if(!o||o.length<i)return;r.push(a.cleanNumber(o[i]))});return r};r.getDataToPixel=function(t,e,n){var a=t._fullLayout._size,i;if(e){var o=r.shapePositionToRange(e);i=function(t){return e._offset+e.r2p(o(t,true))};if(e.type==="date")i=r.decodeDate(i)}else if(n){i=function(t){return a.t+a.h*(1-t)}}else{i=function(t){return a.l+a.w*t}}return i};r.getPixelToData=function(t,e,n){var a=t._fullLayout._size,i;if(e){var o=r.rangeToShapePosition(e);i=function(t){return o(e.p2r(t-e._offset))}}else if(n){i=function(t){return 1-(t-a.t)/a.h}}else{i=function(t){return(t-a.l)/a.w}}return i};r.roundPositionForSharpStrokeRendering=function(t,e){var r=Math.round(e%2)===1;var n=Math.round(t);return r?n+.5:n}},{"../../lib":684,"./constants":639}],643:[function(t,e,r){"use strict";var n=t("./draw");e.exports={moduleType:"component",name:"shapes",layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),includeBasePlot:t("../../plots/cartesian/include_components")("shapes"),calcAutorange:t("./calc_autorange"),draw:n.draw,drawOne:n.drawOne}},{"../../plots/cartesian/include_components":742,"./attributes":637,"./calc_autorange":638,"./defaults":640,"./draw":641}],644:[function(t,e,r){"use strict";var n=t("../../plots/font_attributes");var a=t("../../plots/pad_attributes");var i=t("../../lib/extend").extendDeepAll;var o=t("../../plot_api/edit_types").overrideAll;var s=t("../../plots/animation_attributes");var l=t("../../plot_api/plot_template").templatedArray;var u=t("./constants");var c=l("step",{visible:{valType:"boolean",dflt:true},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:true}});e.exports=o(l("slider",{visible:{valType:"boolean",dflt:true},active:{valType:"number",min:0,dflt:0},steps:c,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:i({},a,{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:s.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:true},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:n({})},font:n({}),activebgcolor:{valType:"color",dflt:u.gripBgActiveColor},bgcolor:{valType:"color",dflt:u.railBgColor},bordercolor:{valType:"color",dflt:u.railBorderColor},borderwidth:{valType:"number",min:0,dflt:u.railBorderWidth},ticklen:{valType:"number",min:0,dflt:u.tickLength},tickcolor:{valType:"color",dflt:u.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:u.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":673,"../../plot_api/edit_types":715,"../../plot_api/plot_template":722,"../../plots/animation_attributes":727,"../../plots/font_attributes":758,"../../plots/pad_attributes":794,"./constants":645}],645:[function(t,e,r){"use strict";e.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],646:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/array_container_defaults");var i=t("./attributes");var o=t("./constants");var s=o.name;var l=i.steps;e.exports=function t(e,r){a(e,r,{name:s,handleItemDefaults:u})};function u(t,e,r){function o(r,a){return n.coerce(t,e,i,r,a)}var s=a(t,e,{name:"steps",handleItemDefaults:c});var l=0;for(var u=0;u<s.length;u++){if(s[u].visible)l++}var f;if(l<2)f=e.visible=false;else f=o("visible");if(!f)return;e._stepCount=l;var h=e._visibleSteps=n.filterVisible(s);var p=o("active");if(!(s[p]||{}).visible)e.active=h[0]._index;o("x");o("y");n.noneOrAll(t,e,["x","y"]);o("xanchor");o("yanchor");o("len");o("lenmode");o("pad.t");o("pad.r");o("pad.b");o("pad.l");n.coerceFont(o,"font",r.font);var d=o("currentvalue.visible");if(d){o("currentvalue.xanchor");o("currentvalue.prefix");o("currentvalue.suffix");o("currentvalue.offset");n.coerceFont(o,"currentvalue.font",e.font)}o("transition.duration");o("transition.easing");o("bgcolor");o("activebgcolor");o("bordercolor");o("borderwidth");o("ticklen");o("tickwidth");o("tickcolor");o("minorticklen")}function c(t,e){function r(r,a){return n.coerce(t,e,l,r,a)}var a;if(t.method!=="skip"&&!Array.isArray(t.args)){a=e.visible=false}else a=r("visible");if(a){r("method");r("args");var i=r("label","step-"+e._index);r("value",i);r("execute")}}},{"../../lib":684,"../../plots/array_container_defaults":728,"./attributes":644,"./constants":645}],647:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../plots/plots");var i=t("../color");var o=t("../drawing");var s=t("../../lib");var l=t("../../lib/svg_text_utils");var u=t("../legend/anchor_utils");var c=t("../../plot_api/plot_template").arrayEditor;var f=t("./constants");var h=t("../../constants/alignment");var p=h.LINE_SPACING;var d=h.FROM_TL;var v=h.FROM_BR;e.exports=function t(e){var r=e._fullLayout,i=m(r,e);var o=r._infolayer.selectAll("g."+f.containerClassName).data(i.length>0?[0]:[]);o.enter().append("g").classed(f.containerClassName,true).style("cursor","ew-resize");function s(t){if(t._commandObserver){t._commandObserver.remove();delete t._commandObserver}a.autoMargin(e,g(t))}o.exit().each(function(){n.select(this).selectAll("g."+f.groupClassName).each(s)}).remove();if(i.length===0)return;var l=o.selectAll("g."+f.groupClassName).data(i,y);l.enter().append("g").classed(f.groupClassName,true);l.exit().each(s).remove();for(var u=0;u<i.length;u++){var c=i[u];x(e,c)}l.each(function(t){var r=n.select(this);C(t);a.manageCommandObserver(e,t,t._visibleSteps,function(t){var n=r.data()[0];if(n.active===t.index)return;if(n._dragging)return;T(e,r,n,t.index,false,true)});b(e,n.select(this),t)})};function g(t){return f.autoMarginIdRoot+t._index}function m(t,e){var r=t[f.name],n=[];for(var a=0;a<r.length;a++){var i=r[a];if(!i.visible)continue;i._gd=e;n.push(i)}return n}function y(t){return t._index}function x(t,e){var r=o.tester.selectAll("g."+f.labelGroupClass).data(e._visibleSteps);r.enter().append("g").classed(f.labelGroupClass,true);var i=0;var s=0;r.each(function(t){var r=n.select(this);var a=k(r,{step:t},e);var l=a.node();if(l){var u=o.bBox(l);s=Math.max(s,u.height);i=Math.max(i,u.width)}});r.remove();var c=e._dims={};c.inputAreaWidth=Math.max(f.railWidth,f.gripHeight);var h=t._fullLayout._size;c.lx=h.l+h.w*e.x;c.ly=h.t+h.h*(1-e.y);if(e.lenmode==="fraction"){c.outerLength=Math.round(h.w*e.len)}else{c.outerLength=e.len}c.inputAreaStart=0;c.inputAreaLength=Math.round(c.outerLength-e.pad.l-e.pad.r);var p=c.inputAreaLength-2*f.stepInset;var m=p/(e._stepCount-1);var y=i+f.labelPadding;c.labelStride=Math.max(1,Math.ceil(y/m));c.labelHeight=s;c.currentValueMaxWidth=0;c.currentValueHeight=0;c.currentValueTotalHeight=0;c.currentValueMaxLines=1;if(e.currentvalue.visible){var x=o.tester.append("g");r.each(function(t){var r=_(x,e,t.label);var n=r.node()&&o.bBox(r.node())||{width:0,height:0};var a=l.lineCount(r);c.currentValueMaxWidth=Math.max(c.currentValueMaxWidth,Math.ceil(n.width));c.currentValueHeight=Math.max(c.currentValueHeight,Math.ceil(n.height));c.currentValueMaxLines=Math.max(c.currentValueMaxLines,a)});c.currentValueTotalHeight=c.currentValueHeight+e.currentvalue.offset;x.remove()}c.height=c.currentValueTotalHeight+f.tickOffset+e.ticklen+f.labelOffset+c.labelHeight+e.pad.t+e.pad.b;var b="left";if(u.isRightAnchor(e)){c.lx-=c.outerLength;b="right"}if(u.isCenterAnchor(e)){c.lx-=c.outerLength/2;b="center"}var w="top";if(u.isBottomAnchor(e)){c.ly-=c.height;w="bottom"}if(u.isMiddleAnchor(e)){c.ly-=c.height/2;w="middle"}c.outerLength=Math.ceil(c.outerLength);c.height=Math.ceil(c.height);c.lx=Math.round(c.lx);c.ly=Math.round(c.ly);var M={y:e.y,b:c.height*v[w],t:c.height*d[w]};if(e.lenmode==="fraction"){M.l=0;M.xl=e.x-e.len*d[b];M.r=0;M.xr=e.x+e.len*v[b]}else{M.x=e.x;M.l=c.outerLength*d[b];M.r=c.outerLength*v[b]}a.autoMargin(t,g(e),M)}function b(t,e,r){if(!(r.steps[r.active]||{}).visible){r.active=r._visibleSteps[0]._index}e.call(_,r).call(O,r).call(M,r).call(E,r).call(P,t,r).call(w,t,r);var n=r._dims;o.setTranslate(e,n.lx+r.pad.l,n.ly+r.pad.t);e.call(L,r,false);e.call(_,r)}function _(t,e,r){if(!e.currentvalue.visible)return;var n=e._dims;var a,i;switch(e.currentvalue.xanchor){case"right":a=n.inputAreaLength-f.currentValueInset-n.currentValueMaxWidth;i="left";break;case"center":a=n.inputAreaLength*.5;i="middle";break;default:a=f.currentValueInset;i="left"}var u=s.ensureSingle(t,"text",f.labelClass,function(t){t.classed("user-select-none",true).attr({"text-anchor":i,"data-notex":1})});var c=e.currentvalue.prefix?e.currentvalue.prefix:"";if(typeof r==="string"){c+=r}else{var h=e.steps[e.active].label;c+=h}if(e.currentvalue.suffix){c+=e.currentvalue.suffix}u.call(o.font,e.currentvalue.font).text(c).call(l.convertToTspans,e._gd);var d=l.lineCount(u);var v=(n.currentValueMaxLines+1-d)*e.currentvalue.font.size*p;l.positionText(u,a,v);return u}function w(t,e,r){var n=s.ensureSingle(t,"rect",f.gripRectClass,function(n){n.call(S,e,t,r).style("pointer-events","all")});n.attr({width:f.gripWidth,height:f.gripHeight,rx:f.gripRadius,ry:f.gripRadius}).call(i.stroke,r.bordercolor).call(i.fill,r.bgcolor).style("stroke-width",r.borderwidth+"px")}function k(t,e,r){var n=s.ensureSingle(t,"text",f.labelClass,function(t){t.classed("user-select-none",true).attr({"text-anchor":"middle","data-notex":1})});n.call(o.font,r.font).text(e.step.label).call(l.convertToTspans,r._gd);return n}function M(t,e){var r=s.ensureSingle(t,"g",f.labelsClass);var a=e._dims;var i=r.selectAll("g."+f.labelGroupClass).data(a.labelSteps);i.enter().append("g").classed(f.labelGroupClass,true);i.exit().remove();i.each(function(t){var r=n.select(this);r.call(k,t,e);o.setTranslate(r,I(e,t.fraction),f.tickOffset+e.ticklen+e.font.size*p+f.labelOffset+a.currentValueTotalHeight)})}function A(t,e,r,n,a){var i=Math.round(n*(r._stepCount-1));var o=r._visibleSteps[i]._index;if(o!==r.active){T(t,e,r,o,true,a)}}function T(t,e,r,n,i,o){var s=r.active;r.active=n;c(t.layout,f.name,r).applyUpdate("active",n);var l=r.steps[r.active];e.call(L,r,o);e.call(_,r);t.emit("plotly_sliderchange",{slider:r,step:r.steps[r.active],interaction:i,previousActive:s});if(l&&l.method&&i){if(e._nextMethod){e._nextMethod.step=l;e._nextMethod.doCallback=i;e._nextMethod.doTransition=o}else{e._nextMethod={step:l,doCallback:i,doTransition:o};e._nextMethodRaf=window.requestAnimationFrame(function(){var r=e._nextMethod.step;if(!r.method)return;if(r.execute){a.executeAPICommand(t,r.method,r.args)}e._nextMethod=null;e._nextMethodRaf=null})}}}function S(t,e,r){var a=r.node();var o=n.select(e);function s(){return r.data()[0]}t.on("mousedown",function(){var t=s();e.emit("plotly_sliderstart",{slider:t});var l=r.select("."+f.gripRectClass);n.event.stopPropagation();n.event.preventDefault();l.call(i.fill,t.activebgcolor);var u=z(t,n.mouse(a)[0]);A(e,r,t,u,true);t._dragging=true;o.on("mousemove",function(){var t=s();var i=z(t,n.mouse(a)[0]);A(e,r,t,i,false)});o.on("mouseup",function(){var t=s();t._dragging=false;l.call(i.fill,t.bgcolor);o.on("mouseup",null);o.on("mousemove",null);e.emit("plotly_sliderend",{slider:t,step:t.steps[t.active]})})})}function E(t,e){var r=t.selectAll("rect."+f.tickRectClass).data(e._visibleSteps);var a=e._dims;r.enter().append("rect").classed(f.tickRectClass,true);r.exit().remove();r.attr({width:e.tickwidth+"px","shape-rendering":"crispEdges"});r.each(function(t,r){var s=r%a.labelStride===0;var l=n.select(this);l.attr({height:s?e.ticklen:e.minorticklen}).call(i.fill,s?e.tickcolor:e.tickcolor);o.setTranslate(l,I(e,r/(e._stepCount-1))-.5*e.tickwidth,(s?f.tickOffset:f.minorTickOffset)+a.currentValueTotalHeight)})}function C(t){var e=t._dims;e.labelSteps=[];var r=t._stepCount;for(var n=0;n<r;n+=e.labelStride){e.labelSteps.push({fraction:n/(r-1),step:t._visibleSteps[n]})}}function L(t,e,r){var n=t.select("rect."+f.gripRectClass);var a=0;for(var i=0;i<e._stepCount;i++){if(e._visibleSteps[i]._index===e.active){a=i;break}}var o=I(e,a/(e._stepCount-1));if(e._invokingCommand)return;var s=n;if(r&&e.transition.duration>0){s=s.transition().duration(e.transition.duration).ease(e.transition.easing)}s.attr("transform","translate("+(o-f.gripWidth*.5)+","+e._dims.currentValueTotalHeight+")")}function I(t,e){var r=t._dims;return r.inputAreaStart+f.stepInset+(r.inputAreaLength-2*f.stepInset)*Math.min(1,Math.max(0,e))}function z(t,e){var r=t._dims;return Math.min(1,Math.max(0,(e-f.stepInset-r.inputAreaStart)/(r.inputAreaLength-2*f.stepInset-2*r.inputAreaStart)))}function P(t,e,r){var n=r._dims;var a=s.ensureSingle(t,"rect",f.railTouchRectClass,function(n){n.call(S,e,t,r).style("pointer-events","all")});a.attr({width:n.inputAreaLength,height:Math.max(n.inputAreaWidth,f.tickOffset+r.ticklen+n.labelHeight)}).call(i.fill,r.bgcolor).attr("opacity",0);o.setTranslate(a,0,n.currentValueTotalHeight)}function O(t,e){var r=e._dims;var n=r.inputAreaLength-f.railInset*2;var a=s.ensureSingle(t,"rect",f.railRectClass);a.attr({width:n,height:f.railWidth,rx:f.railRadius,ry:f.railRadius,"shape-rendering":"crispEdges"}).call(i.stroke,e.bordercolor).call(i.fill,e.bgcolor).style("stroke-width",e.borderwidth+"px");o.setTranslate(a,f.railInset,(r.inputAreaWidth-f.railWidth)*.5+r.currentValueTotalHeight)}},{"../../constants/alignment":656,"../../lib":684,"../../lib/svg_text_utils":708,"../../plot_api/plot_template":722,"../../plots/plots":795,"../color":558,"../drawing":583,"../legend/anchor_utils":610,"./constants":645,d3:147}],648:[function(t,e,r){"use strict";var n=t("./constants");e.exports={moduleType:"component",name:n.name,layoutAttributes:t("./attributes"),supplyLayoutDefaults:t("./defaults"),draw:t("./draw")}},{"./attributes":644,"./constants":645,"./defaults":646,"./draw":647}],649:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("../../plots/plots");var o=t("../../registry");var s=t("../../lib");var l=t("../drawing");var u=t("../color");var c=t("../../lib/svg_text_utils");var f=t("../../constants/interactions");e.exports={draw:p};var h=/ [XY][0-9]* /;function p(t,e,r){var p=r.propContainer;var d=r.propName;var v=r.placeholder;var g=r.traceIndex;var m=r.avoid||{};var y=r.attributes;var x=r.transform;var b=r.containerGroup;var _=t._fullLayout;var w=p.titlefont||{};var k=w.family;var M=w.size;var A=w.color;var T=1;var S=false;var E=(p.title||"").trim();var C;if(d==="title")C="titleText";else if(d.indexOf("axis")!==-1)C="axisTitleText";else if(d.indexOf("colorbar"!==-1))C="colorbarTitleText";var L=t._context.edits[C];if(E==="")T=0;else if(E.replace(h," % ")===v.replace(h," % ")){T=.2;S=true;if(!L)E=""}var I=E||L;if(!b){b=s.ensureSingle(_._infolayer,"g","g-"+e)}var z=b.selectAll("text").data(I?[0]:[]);z.enter().append("text");z.text(E).attr("class",e);z.exit().remove();if(!I)return b;function P(t){s.syncOrAsync([O,D],t)}function O(e){var r;if(x){r="";if(x.rotate){r+="rotate("+[x.rotate,y.x,y.y]+")"}if(x.offset){r+="translate(0, "+x.offset+")"}}else{r=null}e.attr("transform",r);e.style({"font-family":k,"font-size":n.round(M,2)+"px",fill:u.rgb(A),opacity:T*u.opacity(A),"font-weight":i.fontWeight}).attr(y).call(c.convertToTspans,t);return i.previousPromises(t)}function D(t){var e=n.select(t.node().parentNode);if(m&&m.selection&&m.side&&E){e.attr("transform",null);var r=0;var i={left:"right",right:"left",top:"bottom",bottom:"top"}[m.side];var o=["left","top"].indexOf(m.side)!==-1?-1:1;var u=a(m.pad)?m.pad:2;var c=l.bBox(e.node());var f={left:0,top:0,right:_.width,bottom:_.height};var h=m.maxShift||(f[m.side]-c[m.side])*(m.side==="left"||m.side==="top"?-1:1);if(h<0)r=h;else{var p=m.offsetLeft||0;var d=m.offsetTop||0;c.left-=p;c.right-=p;c.top-=d;c.bottom-=d;m.selection.each(function(){var t=l.bBox(this);if(s.bBoxIntersect(c,t,u)){r=Math.max(r,o*(t[m.side]-c[i])+u)}});r=Math.min(h,r)}if(r>0||h<0){var v={left:[-r,0],right:[r,0],top:[0,-r],bottom:[0,r]}[m.side];e.attr("transform","translate("+v+")")}}}z.call(P);function R(){T=0;S=true;z.text(v).on("mouseover.opacity",function(){n.select(this).transition().duration(f.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){n.select(this).transition().duration(f.HIDE_PLACEHOLDER).style("opacity",0)})}if(L){if(!E)R();else z.on(".opacity",null);z.call(c.makeEditable,{gd:t}).on("edit",function(e){if(g!==undefined){o.call("restyle",t,d,e,g)}else{o.call("relayout",t,d,e)}}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(P)}).on("input",function(t){this.text(t||" ").call(c.positionText,y.x,y.y)})}z.classed("js-placeholder",S);return b}},{"../../constants/interactions":660,"../../lib":684,"../../lib/svg_text_utils":708,"../../plots/plots":795,"../../registry":817,"../color":558,"../drawing":583,d3:147,"fast-isnumeric":214}],650:[function(t,e,r){"use strict";var n=t("../../plots/font_attributes");var a=t("../color/attributes");var i=t("../../lib/extend").extendFlat;var o=t("../../plot_api/edit_types").overrideAll;var s=t("../../plots/pad_attributes");var l=t("../../plot_api/plot_template").templatedArray;var u=l("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:true}});e.exports=o(l("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:true},buttons:u,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:i({},s,{}),font:n({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:a.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":673,"../../plot_api/edit_types":715,"../../plot_api/plot_template":722,"../../plots/font_attributes":758,"../../plots/pad_attributes":794,"../color/attributes":557}],651:[function(t,e,r){"use strict";e.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25c4",right:"\u25ba",up:"\u25b2",down:"\u25bc"}}},{}],652:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/array_container_defaults");var i=t("./attributes");var o=t("./constants");var s=o.name;var l=i.buttons;e.exports=function t(e,r){var n={name:s,handleItemDefaults:u};a(e,r,n)};function u(t,e,r){function o(r,a){return n.coerce(t,e,i,r,a)}var s=a(t,e,{name:"buttons",handleItemDefaults:c});var l=o("visible",s.length>0);if(!l)return;o("active");o("direction");o("type");o("showactive");o("x");o("y");n.noneOrAll(t,e,["x","y"]);o("xanchor");o("yanchor");o("pad.t");o("pad.r");o("pad.b");o("pad.l");n.coerceFont(o,"font",r.font);o("bgcolor",r.paper_bgcolor);o("bordercolor");o("borderwidth")}function c(t,e){function r(r,a){return n.coerce(t,e,l,r,a)}var a=r("visible",t.method==="skip"||Array.isArray(t.args));if(a){r("method");r("args");r("label");r("execute")}}},{"../../lib":684,"../../plots/array_container_defaults":728,"./attributes":650,"./constants":651}],653:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../plots/plots");var i=t("../color");var o=t("../drawing");var s=t("../../lib");var l=t("../../lib/svg_text_utils");var u=t("../legend/anchor_utils");var c=t("../../plot_api/plot_template").arrayEditor;var f=t("../../constants/alignment").LINE_SPACING;var h=t("./constants");var p=t("./scrollbox");e.exports=function t(e){var r=e._fullLayout,i=s.filterVisible(r[h.name]);function o(t){a.autoMargin(e,C(t))}var l=r._menulayer.selectAll("g."+h.containerClassName).data(i.length>0?[0]:[]);l.enter().append("g").classed(h.containerClassName,true).style("cursor","pointer");l.exit().each(function(){n.select(this).selectAll("g."+h.headerGroupClassName).each(o)}).remove();if(i.length===0)return;var u=l.selectAll("g."+h.headerGroupClassName).data(i,d);u.enter().append("g").classed(h.headerGroupClassName,true);var c=s.ensureSingle(l,"g",h.dropdownButtonGroupClassName,function(t){t.style("pointer-events","all")});for(var f=0;f<i.length;f++){var v=i[f];E(e,v)}var b="updatemenus"+r._uid,_=new p(e,c,b);if(u.enter().size()){c.node().parentNode.appendChild(c.node());c.call(I)}u.exit().each(function(t){c.call(I);o(t)}).remove();u.each(function(t){var r=n.select(this);var i=t.type==="dropdown"?c:null;a.manageCommandObserver(e,t,t.buttons,function(n){m(e,t,t.buttons[n.index],r,i,_,n.index,true)});if(t.type==="dropdown"){y(e,r,c,_,t);if(g(c,t)){x(e,r,c,_,t)}}else{x(e,r,null,null,t)}})};function d(t){return t._index}function v(t){return+t.attr(h.menuIndexAttrName)===-1}function g(t,e){return+t.attr(h.menuIndexAttrName)===e._index}function m(t,e,r,n,a,i,o,s){e.active=o;c(t.layout,h.name,e).applyUpdate("active",o);if(e.type==="buttons"){x(t,n,null,null,e)}else if(e.type==="dropdown"){a.attr(h.menuIndexAttrName,"-1");y(t,n,a,i,e);if(!s){x(t,n,a,i,e)}}}function y(t,e,r,n,a){var i=s.ensureSingle(e,"g",h.headerClassName,function(t){t.style("pointer-events","all")});var l=a._dims;var u=a.active;var c=a.buttons[u]||h.blankHeaderOpts;var f={y:a.pad.t,yPad:0,x:a.pad.l,xPad:0,index:0};var p={width:l.headerWidth,height:l.headerHeight};i.call(w,a,c,t).call(L,a,f,p);var d=s.ensureSingle(e,"text",h.headerArrowClassName,function(t){t.classed("user-select-none",true).attr("text-anchor","end").call(o.font,a.font).text(h.arrowSymbol[a.direction])});d.attr({x:l.headerWidth-h.arrowOffsetX+a.pad.l,y:l.headerHeight/2+h.textOffsetY+a.pad.t});i.on("click",function(){r.call(I,String(g(r,a)?-1:a._index));x(t,e,r,n,a)});i.on("mouseover",function(){i.call(T)});i.on("mouseout",function(){i.call(S,a)});o.setTranslate(e,l.lx,l.ly)}function x(t,e,r,i,o){if(!r){r=e;r.attr("pointer-events","all")}var l=!v(r)||o.type==="buttons"?o.buttons:[];var u=o.type==="dropdown"?h.dropdownButtonClassName:h.buttonClassName;var c=r.selectAll("g."+u).data(s.filterVisible(l));var f=c.enter().append("g").classed(u,true);var p=c.exit();if(o.type==="dropdown"){f.attr("opacity","0").transition().attr("opacity","1");p.transition().attr("opacity","0").remove()}else{p.remove()}var d=0;var g=0;var y=o._dims;var x=["up","down"].indexOf(o.direction)!==-1;if(o.type==="dropdown"){if(x){g=y.headerHeight+h.gapButtonHeader}else{d=y.headerWidth+h.gapButtonHeader}}if(o.type==="dropdown"&&o.direction==="up"){g=-h.gapButtonHeader+h.gapButton-y.openHeight}if(o.type==="dropdown"&&o.direction==="left"){d=-h.gapButtonHeader+h.gapButton-y.openWidth}var k={x:y.lx+d+o.pad.l,y:y.ly+g+o.pad.t,yPad:h.gapButton,xPad:h.gapButton,index:0};var M={l:k.x+o.borderwidth,t:k.y+o.borderwidth};c.each(function(s,l){var u=n.select(this);u.call(w,o,s,t).call(L,o,k);u.on("click",function(){if(n.event.defaultPrevented)return;m(t,o,s,e,r,i,l);if(s.execute){a.executeAPICommand(t,s.method,s.args)}t.emit("plotly_buttonclicked",{menu:o,button:s,active:o.active})});u.on("mouseover",function(){u.call(T)});u.on("mouseout",function(){u.call(S,o);c.call(A,o)})});c.call(A,o);if(x){M.w=Math.max(y.openWidth,y.headerWidth);M.h=k.y-M.t}else{M.w=k.x-M.l;M.h=Math.max(y.openHeight,y.headerHeight)}M.direction=o.direction;if(i){if(c.size()){b(t,e,r,i,o,M)}else{_(i)}}}function b(t,e,r,n,a,i){var o=a.direction;var s=o==="up"||o==="down";var l=a._dims;var u=a.active,c,f,p;if(s){f=0;for(p=0;p<u;p++){f+=l.heights[p]+h.gapButton}}else{c=0;for(p=0;p<u;p++){c+=l.widths[p]+h.gapButton}}n.enable(i,c,f);if(n.hbar){n.hbar.attr("opacity","0").transition().attr("opacity","1")}if(n.vbar){n.vbar.attr("opacity","0").transition().attr("opacity","1")}}function _(t){var e=!!t.hbar,r=!!t.vbar;if(e){t.hbar.transition().attr("opacity","0").each("end",function(){e=false;if(!r)t.disable()})}if(r){t.vbar.transition().attr("opacity","0").each("end",function(){r=false;if(!e)t.disable()})}}function w(t,e,r,n){t.call(k,e).call(M,e,r,n)}function k(t,e){var r=s.ensureSingle(t,"rect",h.itemRectClassName,function(t){t.attr({rx:h.rx,ry:h.ry,"shape-rendering":"crispEdges"})});r.call(i.stroke,e.bordercolor).call(i.fill,e.bgcolor).style("stroke-width",e.borderwidth+"px")}function M(t,e,r,n){var a=s.ensureSingle(t,"text",h.itemTextClassName,function(t){t.classed("user-select-none",true).attr({"text-anchor":"start","data-notex":1})});a.call(o.font,e.font).text(r.label).call(l.convertToTspans,n)}function A(t,e){var r=e.active;t.each(function(t,a){var o=n.select(this);if(a===r&&e.showactive){o.select("rect."+h.itemRectClassName).call(i.fill,h.activeColor)}})}function T(t){t.select("rect."+h.itemRectClassName).call(i.fill,h.hoverColor)}function S(t,e){t.select("rect."+h.itemRectClassName).call(i.fill,e.bgcolor)}function E(t,e){var r=e._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0};var i=o.tester.selectAll("g."+h.dropdownButtonClassName).data(s.filterVisible(e.buttons));i.enter().append("g").classed(h.dropdownButtonClassName,true);var c=["up","down"].indexOf(e.direction)!==-1;i.each(function(a,i){var s=n.select(this);s.call(w,e,a,t);var u=s.select("."+h.itemTextClassName);var p=u.node()&&o.bBox(u.node()).width;var d=Math.max(p+h.textPadX,h.minWidth);var v=e.font.size*f;var g=l.lineCount(u);var m=Math.max(v*g,h.minHeight)+h.textOffsetY;m=Math.ceil(m);d=Math.ceil(d);r.widths[i]=d;r.heights[i]=m;r.height1=Math.max(r.height1,m);r.width1=Math.max(r.width1,d);if(c){r.totalWidth=Math.max(r.totalWidth,d);r.openWidth=r.totalWidth;r.totalHeight+=m+h.gapButton;r.openHeight+=m+h.gapButton}else{r.totalWidth+=d+h.gapButton;r.openWidth+=d+h.gapButton;r.totalHeight=Math.max(r.totalHeight,m);r.openHeight=r.totalHeight}});if(c){r.totalHeight-=h.gapButton}else{r.totalWidth-=h.gapButton}r.headerWidth=r.width1+h.arrowPadX;r.headerHeight=r.height1;if(e.type==="dropdown"){if(c){r.width1+=h.arrowPadX;r.totalHeight=r.height1}else{r.totalWidth=r.width1}r.totalWidth+=h.arrowPadX}i.remove();var p=r.totalWidth+e.pad.l+e.pad.r;var d=r.totalHeight+e.pad.t+e.pad.b;var v=t._fullLayout._size;r.lx=v.l+v.w*e.x;r.ly=v.t+v.h*(1-e.y);var g="left";if(u.isRightAnchor(e)){r.lx-=p;g="right"}if(u.isCenterAnchor(e)){r.lx-=p/2;g="center"}var m="top";if(u.isBottomAnchor(e)){r.ly-=d;m="bottom"}if(u.isMiddleAnchor(e)){r.ly-=d/2;m="middle"}r.totalWidth=Math.ceil(r.totalWidth);r.totalHeight=Math.ceil(r.totalHeight);r.lx=Math.round(r.lx);r.ly=Math.round(r.ly);a.autoMargin(t,C(e),{x:e.x,y:e.y,l:p*({right:1,center:.5}[g]||0),r:p*({left:1,center:.5}[g]||0),b:d*({top:1,middle:.5}[m]||0),t:d*({bottom:1,middle:.5}[m]||0)})}function C(t){return h.autoMarginIdRoot+t._index}function L(t,e,r,n){n=n||{};var a=t.select("."+h.itemRectClassName);var i=t.select("."+h.itemTextClassName);var s=e.borderwidth;var u=r.index;var c=e._dims;o.setTranslate(t,s+r.x,s+r.y);var p=["up","down"].indexOf(e.direction)!==-1;var d=n.height||(p?c.heights[u]:c.height1);a.attr({x:0,y:0,width:n.width||(p?c.width1:c.widths[u]),height:d});var v=e.font.size*f;var g=l.lineCount(i);var m=(g-1)*v/2;l.positionText(i,h.textOffsetX,d/2-m+h.textOffsetY);if(p){r.y+=c.heights[u]+r.yPad}else{r.x+=c.widths[u]+r.xPad}r.index++}function I(t,e){t.attr(h.menuIndexAttrName,e||"-1").selectAll("g."+h.dropdownButtonClassName).remove()}},{"../../constants/alignment":656,"../../lib":684,"../../lib/svg_text_utils":708,"../../plot_api/plot_template":722,"../../plots/plots":795,"../color":558,"../drawing":583,"../legend/anchor_utils":610,"./constants":651,"./scrollbox":655,d3:147}],654:[function(t,e,r){arguments[4][648][0].apply(r,arguments)},{"./attributes":650,"./constants":651,"./defaults":652,"./draw":653,dup:648}],655:[function(t,e,r){"use strict";e.exports=s;var n=t("d3");var a=t("../color");var i=t("../drawing");var o=t("../../lib");function s(t,e,r){this.gd=t;this.container=e;this.id=r;this.position=null;this.translateX=null;this.translateY=null;this.hbar=null;this.vbar=null;this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]);this.bg.exit().on(".drag",null).on("wheel",null).remove();this.bg.enter().append("rect").classed("scrollbox-bg",true).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}s.barWidth=2;s.barLength=20;s.barRadius=2;s.barPad=1;s.barColor="#808BA4";s.prototype.enable=function t(e,r,o){var l=this.gd._fullLayout,u=l.width,c=l.height;this.position=e;var f=this.position.l,h=this.position.w,p=this.position.t,d=this.position.h,v=this.position.direction,g=v==="down",m=v==="left",y=v==="right",x=v==="up",b=h,_=d,w,k,M,A;if(!g&&!m&&!y&&!x){this.position.direction="down";g=true}var T=g||x;if(T){w=f;k=w+b;if(g){M=p;A=Math.min(M+_,c);_=A-M}else{A=p+_;M=Math.max(A-_,0);_=A-M}}else{M=p;A=M+_;if(m){k=f+b;w=Math.max(k-b,0);b=k-w}else{w=f;k=Math.min(w+b,u);b=k-w}}this._box={l:w,t:M,w:b,h:_};var S=h>b,E=s.barLength+2*s.barPad,C=s.barWidth+2*s.barPad,L=f,I=p+d;if(I+C>c)I=c-C;var z=this.container.selectAll("rect.scrollbar-horizontal").data(S?[0]:[]);z.exit().on(".drag",null).remove();z.enter().append("rect").classed("scrollbar-horizontal",true).call(a.fill,s.barColor);if(S){this.hbar=z.attr({rx:s.barRadius,ry:s.barRadius,x:L,y:I,width:E,height:C});this._hbarXMin=L+E/2;this._hbarTranslateMax=b-E}else{delete this.hbar;delete this._hbarXMin;delete this._hbarTranslateMax}var P=d>_,O=s.barWidth+2*s.barPad,D=s.barLength+2*s.barPad,R=f+h,B=p;if(R+O>u)R=u-O;var F=this.container.selectAll("rect.scrollbar-vertical").data(P?[0]:[]);F.exit().on(".drag",null).remove();F.enter().append("rect").classed("scrollbar-vertical",true).call(a.fill,s.barColor);if(P){this.vbar=F.attr({rx:s.barRadius,ry:s.barRadius,x:R,y:B,width:O,height:D});this._vbarYMin=B+D/2;this._vbarTranslateMax=_-D}else{delete this.vbar;delete this._vbarYMin;delete this._vbarTranslateMax}var N=this.id,j=w-.5,V=P?k+O+.5:k+.5,U=M-.5,q=S?A+C+.5:A+.5;var H=l._topdefs.selectAll("#"+N).data(S||P?[0]:[]);H.exit().remove();H.enter().append("clipPath").attr("id",N).append("rect");if(S||P){this._clipRect=H.select("rect").attr({x:Math.floor(j),y:Math.floor(U),width:Math.ceil(V)-Math.floor(j),height:Math.ceil(q)-Math.floor(U)});this.container.call(i.setClipUrl,N);this.bg.attr({x:f,y:p,width:h,height:d})}else{this.bg.attr({width:0,height:0});this.container.on("wheel",null).on(".drag",null).call(i.setClipUrl,null);delete this._clipRect}if(S||P){var G=n.behavior.drag().on("dragstart",function(){n.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(G);var W=n.behavior.drag().on("dragstart",function(){n.event.sourceEvent.preventDefault();n.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));if(S){this.hbar.on(".drag",null).call(W)}if(P){this.vbar.on(".drag",null).call(W)}}this.setTranslate(r,o)};s.prototype.disable=function t(){if(this.hbar||this.vbar){this.bg.attr({width:0,height:0});this.container.on("wheel",null).on(".drag",null).call(i.setClipUrl,null);delete this._clipRect}if(this.hbar){this.hbar.on(".drag",null);this.hbar.remove();delete this.hbar;delete this._hbarXMin;delete this._hbarTranslateMax}if(this.vbar){this.vbar.on(".drag",null);this.vbar.remove();delete this.vbar;delete this._vbarYMin;delete this._vbarTranslateMax}};s.prototype._onBoxDrag=function t(){var e=this.translateX,r=this.translateY;if(this.hbar){e-=n.event.dx}if(this.vbar){r-=n.event.dy}this.setTranslate(e,r)};s.prototype._onBoxWheel=function t(){var e=this.translateX,r=this.translateY;if(this.hbar){e+=n.event.deltaY}if(this.vbar){r+=n.event.deltaY}this.setTranslate(e,r)};s.prototype._onBarDrag=function t(){var e=this.translateX,r=this.translateY;if(this.hbar){var a=e+this._hbarXMin,i=a+this._hbarTranslateMax,s=o.constrain(n.event.x,a,i),l=(s-a)/(i-a);var u=this.position.w-this._box.w;e=l*u}if(this.vbar){var c=r+this._vbarYMin,f=c+this._vbarTranslateMax,h=o.constrain(n.event.y,c,f),p=(h-c)/(f-c);var d=this.position.h-this._box.h;r=p*d}this.setTranslate(e,r)};s.prototype.setTranslate=function t(e,r){var n=this.position.w-this._box.w,a=this.position.h-this._box.h;e=o.constrain(e||0,0,n);r=o.constrain(r||0,0,a);this.translateX=e;this.translateY=r;this.container.call(i.setTranslate,this._box.l-this.position.l-e,this._box.t-this.position.t-r);if(this._clipRect){this._clipRect.attr({x:Math.floor(this.position.l+e-.5),y:Math.floor(this.position.t+r-.5)})}if(this.hbar){var s=e/n;this.hbar.call(i.setTranslate,e+s*this._hbarTranslateMax,r)}if(this.vbar){var l=r/a;this.vbar.call(i.setTranslate,e,r+l*this._vbarTranslateMax)}}},{"../../lib":684,"../color":558,"../drawing":583,d3:147}],656:[function(t,e,r){"use strict";e.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],657:[function(t,e,r){"use strict";e.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],658:[function(t,e,r){"use strict";e.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],659:[function(t,e,r){"use strict";e.exports={circle:"\u25cf","circle-open":"\u25cb",square:"\u25a0","square-open":"\u25a1",diamond:"\u25c6","diamond-open":"\u25c7",cross:"+",x:"\u274c"}},{}],660:[function(t,e,r){"use strict";e.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DBLCLICKDELAY:300,DESELECTDIM:.2}},{}],661:[function(t,e,r){"use strict";e.exports={BADNUM:undefined,FP_SAFE:Number.MAX_VALUE/1e4,ONEAVGYEAR:315576e5,ONEAVGMONTH:26298e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:1-1e-6,MINUS_SIGN:"\u2212"}},{}],662:[function(t,e,r){"use strict";e.exports={entityToUnicode:{mu:"\u03bc","#956":"\u03bc",amp:"&","#28":"&",lt:"<","#60":"<",gt:">","#62":">",nbsp:"\xa0","#160":"\xa0",times:"\xd7","#215":"\xd7",plusmn:"\xb1","#177":"\xb1",deg:"\xb0","#176":"\xb0"}}},{}],663:[function(t,e,r){"use strict";r.xmlns="http://www.w3.org/2000/xmlns/";r.svg="http://www.w3.org/2000/svg";r.xlink="http://www.w3.org/1999/xlink";r.svgAttrs={xmlns:r.svg,"xmlns:xlink":r.xlink}},{}],664:[function(t,e,r){"use strict";r.version="1.39.1";t("es6-promise").polyfill();t("../build/plotcss");t("./fonts/mathjax_config");var n=t("./registry");var a=r.register=n.register;var i=t("./plot_api");var o=Object.keys(i);for(var s=0;s<o.length;s++){var l=o[s];r[l]=i[l];a({moduleType:"apiMethod",name:l,fn:i[l]})}a(t("./traces/scatter"));a([t("./components/fx"),t("./components/legend"),t("./components/annotations"),t("./components/annotations3d"),t("./components/shapes"),t("./components/images"),t("./components/updatemenus"),t("./components/sliders"),t("./components/rangeslider"),t("./components/rangeselector"),t("./components/grid"),t("./components/errorbars")]);a([t("./locale-en"),t("./locale-en-us")]);r.Icons=t("../build/ploticon");r.Plots=t("./plots/plots");r.Fx=t("./components/fx");r.Snapshot=t("./snapshot");r.PlotSchema=t("./plot_api/plot_schema");r.Queue=t("./lib/queue");r.d3=t("d3")},{"../build/plotcss":1,"../build/ploticon":2,"./components/annotations":549,"./components/annotations3d":554,"./components/errorbars":589,"./components/fx":600,"./components/grid":604,"./components/images":609,"./components/legend":618,"./components/rangeselector":629,"./components/rangeslider":635,"./components/shapes":643,"./components/sliders":648,"./components/updatemenus":654,"./fonts/mathjax_config":665,"./lib/queue":699,"./locale-en":713,"./locale-en-us":712,"./plot_api":717,"./plot_api/plot_schema":721,"./plots/plots":795,"./registry":817,"./snapshot":822,"./traces/scatter":1026,d3:147,"es6-promise":202}],665:[function(t,e,r){"use strict";if(typeof MathJax!=="undefined"){r.MathJax=true;MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:true,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}});MathJax.Hub.Configured()}else{r.MathJax=false}},{}],666:[function(t,e,r){"use strict";var n=Math.PI;r.deg2rad=function(t){return t/180*n};r.rad2deg=function(t){return t/n*180};r.wrap360=function(t){var e=t%360;return e<0?e+360:e};r.wrap180=function(t){if(Math.abs(t)>180)t-=Math.round(t/360)*360;return t}},{}],667:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../constants/numerical").BADNUM;var i=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;e.exports=function t(e){if(typeof e==="string"){e=e.replace(i,"")}if(n(e))return Number(e);return a}},{"../constants/numerical":661,"fast-isnumeric":214}],668:[function(t,e,r){"use strict";e.exports=function t(e){var r=e._fullLayout;if(r._glcanvas&&r._glcanvas.size()){r._glcanvas.each(function(t){if(t.regl)t.regl.clear({color:true,depth:true})})}}},{}],669:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("tinycolor2");var i=t("../plots/attributes");var o=t("../components/colorscale/get_scale");var s=Object.keys(t("../components/colorscale/scales"));var l=t("./nested_property");var u=t("./regex").counter;var c=t("../constants/interactions").DESELECTDIM;var f=t("./angles").wrap180;var h=t("./is_array").isArrayOrTypedArray;r.valObjectMeta={data_array:{coerceFunction:function(t,e,r){if(h(t))e.set(t);else if(r!==undefined)e.set(r)}},enumerated:{coerceFunction:function(t,e,r,n){if(n.coerceNumber)t=+t;if(n.values.indexOf(t)===-1)e.set(r);else e.set(t)},validateFunction:function(t,e){if(e.coerceNumber)t=+t;var r=e.values;for(var n=0;n<r.length;n++){var a=String(r[n]);if(a.charAt(0)==="/"&&a.charAt(a.length-1)==="/"){var i=new RegExp(a.substr(1,a.length-2));if(i.test(t))return true}else if(t===r[n])return true}return false}},boolean:{coerceFunction:function(t,e,r){if(t===true||t===false)e.set(t);else e.set(r)}},number:{coerceFunction:function(t,e,r,a){if(!n(t)||a.min!==undefined&&t<a.min||a.max!==undefined&&t>a.max){e.set(r)}else e.set(+t)}},integer:{coerceFunction:function(t,e,r,a){if(t%1||!n(t)||a.min!==undefined&&t<a.min||a.max!==undefined&&t>a.max){e.set(r)}else e.set(+t)}},string:{coerceFunction:function(t,e,r,n){if(typeof t!=="string"){var a=typeof t==="number";if(n.strict===true||!a)e.set(r);else e.set(String(t))}else if(n.noBlank&&!t)e.set(r);else e.set(t)}},color:{coerceFunction:function(t,e,r){if(a(t).isValid())e.set(t);else e.set(r)}},colorlist:{coerceFunction:function(t,e,r){function n(t){return a(t).isValid()}if(!Array.isArray(t)||!t.length)e.set(r);else if(t.every(n))e.set(t);else e.set(r)}},colorscale:{coerceFunction:function(t,e,r){e.set(o(t,r))}},angle:{coerceFunction:function(t,e,r){if(t==="auto")e.set("auto");else if(!n(t))e.set(r);else e.set(f(+t))}},subplotid:{coerceFunction:function(t,e,r,n){var a=n.regex||u(r);if(typeof t==="string"&&a.test(t)){e.set(t);return}e.set(r)},validateFunction:function(t,e){var r=e.dflt;if(t===r)return true;if(typeof t!=="string")return false;if(u(r).test(t))return true;return false}},flaglist:{coerceFunction:function(t,e,r,n){if(typeof t!=="string"){e.set(r);return}if((n.extras||[]).indexOf(t)!==-1){e.set(t);return}var a=t.split("+"),i=0;while(i<a.length){var o=a[i];if(n.flags.indexOf(o)===-1||a.indexOf(o)<i){a.splice(i,1)}else i++}if(!a.length)e.set(r);else e.set(a.join("+"))}},any:{coerceFunction:function(t,e,r){if(t===undefined)e.set(r);else e.set(t)}},info_array:{coerceFunction:function(t,e,n,a){function i(t,e,n){var a;var i={set:function(t){a=t}};if(n===undefined)n=e.dflt;r.valObjectMeta[e.valType].coerceFunction(t,i,n,e);return a}var o=a.dimensions===2||a.dimensions==="1-2"&&Array.isArray(t)&&Array.isArray(t[0]);if(!Array.isArray(t)){e.set(n);return}var s=a.items;var l=[];var u=Array.isArray(s);var c=u&&o&&Array.isArray(s[0]);var f=o&&u&&!c;var h=u&&!f?s.length:t.length;var p,d,v,g,m,y;n=Array.isArray(n)?n:[];if(o){for(p=0;p<h;p++){l[p]=[];v=Array.isArray(t[p])?t[p]:[];if(f)m=s.length;else if(u)m=s[p].length;else m=v.length;for(d=0;d<m;d++){if(f)g=s[d];else if(u)g=s[p][d];else g=s;y=i(v[d],g,(n[p]||[])[d]);if(y!==undefined)l[p][d]=y}}}else{for(p=0;p<h;p++){y=i(t[p],u?s[p]:s,n[p]);if(y!==undefined)l[p]=y}}e.set(l)},validateFunction:function(t,e){if(!Array.isArray(t))return false;var r=e.items;var n=Array.isArray(r);var a=e.dimensions===2;if(!e.freeLength&&t.length!==r.length)return false;for(var i=0;i<t.length;i++){if(a){if(!Array.isArray(t[i])||!e.freeLength&&t[i].length!==r[i].length){return false}for(var o=0;o<t[i].length;o++){if(!p(t[i][o],n?r[i][o]:r)){return false}}}else if(!p(t[i],n?r[i]:r))return false}return true}}};r.coerce=function(t,e,n,a,i){var o=l(n,a).get();var s=l(t,a);var u=l(e,a);var c=s.get();var f=e._template;if(c===undefined&&f){c=l(f,a).get();f=0}if(i===undefined)i=o.dflt;if(o.arrayOk&&h(c)){u.set(c);return c}var d=r.valObjectMeta[o.valType].coerceFunction;d(c,u,i,o);var v=u.get();if(f&&v===i&&!p(c,o)){c=l(f,a).get();d(c,u,i,o);v=u.get()}return v};r.coerce2=function(t,e,n,a,i){var o=l(t,a),s=r.coerce(t,e,n,a,i),u=o.get();return u!==undefined&&u!==null?s:false};r.coerceFont=function(t,e,r){var n={};r=r||{};n.family=t(e+".family",r.family);n.size=t(e+".size",r.size);n.color=t(e+".color",r.color);return n};r.coerceHoverinfo=function(t,e,n){var a=e._module.attributes;var o=a.hoverinfo?a:i;var s=o.hoverinfo;var l;if(n._dataLength===1){var u=s.dflt==="all"?s.flags.slice():s.dflt.split("+");u.splice(u.indexOf("name"),1);l=u.join("+")}return r.coerce(t,e,o,"hoverinfo",l)};r.coerceSelectionMarkerOpacity=function(t,e){if(!t.marker)return;var r=t.marker.opacity;if(r===undefined)return;var n;var a;if(!h(r)&&!t.selected&&!t.unselected){n=r;a=c*r}e("selected.marker.opacity",n);e("unselected.marker.opacity",a)};function p(t,e){var n=r.valObjectMeta[e.valType];if(e.arrayOk&&h(t))return true;if(n.validateFunction){return n.validateFunction(t,e)}var a={},i=a,o={set:function(t){i=t}};n.coerceFunction(t,o,a,e);return i!==a}r.validate=p},{"../components/colorscale/get_scale":571,"../components/colorscale/scales":577,"../constants/interactions":660,"../plots/attributes":729,"./angles":666,"./is_array":685,"./nested_property":692,"./regex":700,"fast-isnumeric":214,tinycolor2:499}],670:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("./loggers");var o=t("./mod");var s=t("../constants/numerical");var l=s.BADNUM;var u=s.ONEDAY;var c=s.ONEHOUR;var f=s.ONEMIN;var h=s.ONESEC;var p=s.EPOCHJD;var d=t("../registry");var v=n.time.format.utc;var g=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m;var m=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m;var y=(new Date).getFullYear()-70;function x(t){return t&&d.componentsRegistry.calendars&&typeof t==="string"&&t!=="gregorian"}r.dateTick0=function(t,e){if(x(t)){return e?d.getComponentMethod("calendars","CANONICAL_SUNDAY")[t]:d.getComponentMethod("calendars","CANONICAL_TICK")[t]}else{return e?"2000-01-02":"2000-01-01"}};r.dfltRange=function(t){if(x(t)){return d.getComponentMethod("calendars","DFLTRANGE")[t]}else{return["2000-01-01","2001-01-01"]}};r.isJSDate=function(t){return typeof t==="object"&&t!==null&&typeof t.getTime==="function"};var b,_;r.dateTime2ms=function(t,e){if(r.isJSDate(t)){var n=t.getTimezoneOffset()*f;var a=(t.getUTCMinutes()-t.getMinutes())*f+(t.getUTCSeconds()-t.getSeconds())*h+(t.getUTCMilliseconds()-t.getMilliseconds());if(a){var i=3*f;n=n-i/2+o(a-n+i/2,i)}t=Number(t)-n;if(t>=b&&t<=_)return t;return l}if(typeof t!=="string"&&typeof t!=="number")return l;t=String(t);var s=x(e);var v=t.charAt(0);if(s&&(v==="G"||v==="g")){t=t.substr(1);e=""}var w=s&&e.substr(0,7)==="chinese";var k=t.match(w?m:g);if(!k)return l;var M=k[1],A=k[3]||"1",T=Number(k[5]||1),S=Number(k[7]||0),E=Number(k[9]||0),C=Number(k[11]||0);if(s){if(M.length===2)return l;M=Number(M);var L;try{var I=d.getComponentMethod("calendars","getCal")(e);if(w){var z=A.charAt(A.length-1)==="i";A=parseInt(A,10);L=I.newDate(M,I.toMonthIndex(M,A,z),T)}else{L=I.newDate(M,Number(A),T)}}catch(t){return l}if(!L)return l;return(L.toJD()-p)*u+S*c+E*f+C*h}if(M.length===2){M=(Number(M)+2e3-y)%100+y}else M=Number(M);A-=1;var P=new Date(Date.UTC(2e3,A,T,S,E));P.setUTCFullYear(M);if(P.getUTCMonth()!==A)return l;if(P.getUTCDate()!==T)return l;return P.getTime()+C*h};b=r.MIN_MS=r.dateTime2ms("-9999");_=r.MAX_MS=r.dateTime2ms("9999-12-31 23:59:59.9999");r.isDateTime=function(t,e){return r.dateTime2ms(t,e)!==l};function w(t,e){return String(t+Math.pow(10,e)).substr(1)}var k=90*u;var M=3*c;var A=5*f;r.ms2DateTime=function(t,e,r){if(typeof t!=="number"||!(t>=b&&t<=_))return l;if(!e)e=0;var n=Math.floor(o(t+.05,1)*10),a=Math.round(t-n/10),i,s,g,m,y,w;if(x(r)){var S=Math.floor(a/u)+p,E=Math.floor(o(t,u));try{i=d.getComponentMethod("calendars","getCal")(r).fromJD(S).formatDate("yyyy-mm-dd")}catch(t){i=v("G%Y-%m-%d")(new Date(a))}if(i.charAt(0)==="-"){while(i.length<11)i="-0"+i.substr(1)}else{while(i.length<10)i="0"+i}s=e<k?Math.floor(E/c):0;g=e<k?Math.floor(E%c/f):0;m=e<M?Math.floor(E%f/h):0;y=e<A?E%h*10+n:0}else{w=new Date(a);i=v("%Y-%m-%d")(w);s=e<k?w.getUTCHours():0;g=e<k?w.getUTCMinutes():0;m=e<M?w.getUTCSeconds():0;y=e<A?w.getUTCMilliseconds()*10+n:0}return T(i,s,g,m,y)};r.ms2DateTimeLocal=function(t){if(!(t>=b+u&&t<=_-u))return l;var e=Math.floor(o(t+.05,1)*10),r=new Date(Math.round(t-e/10)),a=n.time.format("%Y-%m-%d")(r),i=r.getHours(),s=r.getMinutes(),c=r.getSeconds(),f=r.getUTCMilliseconds()*10+e;return T(a,i,s,c,f)};function T(t,e,r,n,a){if(e||r||n||a){t+=" "+w(e,2)+":"+w(r,2);if(n||a){t+=":"+w(n,2);if(a){var i=4;while(a%10===0){i-=1;a/=10}t+="."+w(a,i)}}}return t}r.cleanDate=function(t,e,n){if(r.isJSDate(t)||typeof t==="number"){if(x(n)){i.error("JS Dates and milliseconds are incompatible with world calendars",t);return e}t=r.ms2DateTimeLocal(+t);if(!t&&e!==undefined)return e}else if(!r.isDateTime(t,n)){i.error("unrecognized date",t);return e}return t};var S=/%\d?f/g;function E(t,e,r,n){t=t.replace(S,function(t){var r=Math.min(+t.charAt(1)||6,6),n=(e/1e3%1+2).toFixed(r).substr(2).replace(/0+$/,"")||"0";return n});var a=new Date(Math.floor(e+.05));if(x(n)){try{t=d.getComponentMethod("calendars","worldCalFmt")(t,e,n)}catch(t){return"Invalid"}}return r(t)(a)}var C=[59,59.9,59.99,59.999,59.9999];function L(t,e){var r=o(t+.05,u);var n=w(Math.floor(r/c),2)+":"+w(o(Math.floor(r/f),60),2);if(e!=="M"){if(!a(e))e=0;var i=Math.min(o(t/h,60),C[e]);var s=(100+i).toFixed(e).substr(1);if(e>0){s=s.replace(/0+$/,"").replace(/[\.]$/,"")}n+=":"+s}return n}r.formatDate=function(t,e,r,n,a,i){a=x(a)&&a;if(!e){if(r==="y")e=i.year;else if(r==="m")e=i.month;else if(r==="d"){e=i.dayMonth+"\n"+i.year}else{return L(t,r)+"\n"+E(i.dayMonthYear,t,n,a)}}return E(e,t,n,a)};var I=3*u;r.incrementMonth=function(t,e,r){r=x(r)&&r;var n=o(t,u);t=Math.round(t-n);if(r){try{var a=Math.round(t/u)+p,s=d.getComponentMethod("calendars","getCal")(r),l=s.fromJD(a);if(e%12)s.add(l,e,"m");else s.add(l,e/12,"y");return(l.toJD()-p)*u+n}catch(e){i.error("invalid ms "+t+" in calendar "+r)}}var c=new Date(t+I);return c.setUTCMonth(c.getUTCMonth()+e)+n-I};r.findExactDates=function(t,e){var r=0,n=0,i=0,o=0,s,l;var c=x(e)&&d.getComponentMethod("calendars","getCal")(e);for(var f=0;f<t.length;f++){l=t[f];if(!a(l)){o++;continue}if(l%u)continue;if(c){try{s=c.fromJD(l/u+p);if(s.day()===1){if(s.month()===1)r++;else n++}else i++}catch(t){}}else{s=new Date(l);if(s.getUTCDate()===1){if(s.getUTCMonth()===0)r++;else n++}else i++}}n+=r;i+=n;var h=t.length-o;return{exactYears:r/h,exactMonths:n/h,exactDays:i/h}}},{"../constants/numerical":661,"../registry":817,"./loggers":689,"./mod":691,d3:147,"fast-isnumeric":214}],671:[function(t,e,r){"use strict";e.exports=function t(e,r){if(!Array.isArray(e))e=[];e.length=r;return e}},{}],672:[function(t,e,r){"use strict";var n=t("events").EventEmitter;var a={init:function(t){if(t._ev instanceof n)return t;var e=new n;var r=new n;t._ev=e;t._internalEv=r;t.on=e.on.bind(e);t.once=e.once.bind(e);t.removeListener=e.removeListener.bind(e);t.removeAllListeners=e.removeAllListeners.bind(e);t._internalOn=r.on.bind(r);t._internalOnce=r.once.bind(r);t._removeInternalListener=r.removeListener.bind(r);t._removeAllInternalListeners=r.removeAllListeners.bind(r);t.emit=function(n,a){if(typeof jQuery!=="undefined"){jQuery(t).trigger(n,a)}e.emit(n,a);r.emit(n,a)};return t},triggerHandler:function(t,e,r){var n;var a;if(typeof jQuery!=="undefined"){n=jQuery(t).triggerHandler(e,r)}var i=t._ev;if(!i)return n;var o=i._events[e];if(!o)return n;function s(t){if(t.listener){i.removeListener(e,t.listener);if(!t.fired){t.fired=true;return t.listener.apply(i,[r])}}else{return t.apply(i,[r])}}o=Array.isArray(o)?o:[o];var l;for(l=0;l<o.length-1;l++){s(o[l])}a=s(o[l]);return n!==undefined?n:a},purge:function(t){delete t._ev;delete t.on;delete t.once;delete t.removeListener;delete t.removeAllListeners;delete t.emit;delete t._ev;delete t._internalEv;delete t._internalOn;delete t._internalOnce;delete t._removeInternalListener;delete t._removeAllInternalListeners;return t}};e.exports=a},{events:212}],673:[function(t,e,r){"use strict";var n=t("./is_plain_object.js");var a=Array.isArray;function i(t,e){var r,n;for(r=0;r<t.length;r++){n=t[r];if(n!==null&&typeof n==="object"){return false}if(n!==void 0){e[r]=n}}return true}r.extendFlat=function(){return o(arguments,false,false,false)};r.extendDeep=function(){return o(arguments,true,false,false)};r.extendDeepAll=function(){return o(arguments,true,true,false)};r.extendDeepNoArrays=function(){return o(arguments,true,false,true)};function o(t,e,r,s){var l=t[0],u=t.length;var c,f,h,p,d,v,g;if(u===2&&a(l)&&a(t[1])&&l.length===0){g=i(t[1],l);if(g){return l}else{l.splice(0,l.length)}}for(var m=1;m<u;m++){c=t[m];for(f in c){h=l[f];p=c[f];if(s&&a(p)){l[f]=p}else if(e&&p&&(n(p)||(d=a(p)))){if(d){d=false;v=h&&a(h)?h:[]}else{v=h&&n(h)?h:{}}l[f]=o([v,p],e,r,s)}else if(typeof p!=="undefined"||r){l[f]=p}}}return l}},{"./is_plain_object.js":686}],674:[function(t,e,r){"use strict";e.exports=function t(e){var r={},n=[],a=0;for(var i=0;i<e.length;i++){var o=e[i];if(r[o]!==1){r[o]=1;n[a++]=o}}return n}},{}],675:[function(t,e,r){"use strict";e.exports=function t(e){var r=i(e)?a:n;var o=[];for(var s=0;s<e.length;s++){var l=e[s];if(r(l))o.push(l)}return o};function n(t){return t.visible===true}function a(t){return t[0].trace.visible===true}function i(t){return Array.isArray(t)&&Array.isArray(t[0])&&t[0][0]&&t[0][0].trace}},{}],676:[function(t,e,r){"use strict";var n=t("country-regex");var a=t("../lib");var i=Object.keys(n);var o={"ISO-3":a.identity,"USA-states":a.identity,"country names":l};r.locationToFeature=function(t,e,r){if(!e||typeof e!=="string")return false;var n=s(t,e);if(n){for(var i=0;i<r.length;i++){var o=r[i];if(o.id===n)return o}a.log(["Location with id",n,"does not have a matching topojson feature at this resolution."].join(" "))}return false};function s(t,e){var r=o[t];return r(e)}function l(t){for(var e=0;e<i.length;e++){var r=i[e],o=new RegExp(n[r]);if(o.test(t.trim().toLowerCase()))return r}a.log("Unrecognized country name: "+t+".");return false}},{"../lib":684,"country-regex":121}],677:[function(t,e,r){"use strict";var n=t("../constants/numerical").BADNUM;r.calcTraceToLineCoords=function(t){var e=t[0].trace;var r=e.connectgaps;var a=[];var i=[];for(var o=0;o<t.length;o++){var s=t[o];var l=s.lonlat;if(l[0]!==n){i.push(l)}else if(!r&&i.length>0){a.push(i);i=[]}}if(i.length>0){a.push(i)}return a};r.makeLine=function(t){if(t.length===1){return{type:"LineString",coordinates:t[0]}}else{return{type:"MultiLineString",coordinates:t}}};r.makePolygon=function(t){if(t.length===1){return{type:"Polygon",coordinates:t}}else{var e=new Array(t.length);for(var r=0;r<t.length;r++){e[r]=[t[r]]}return{type:"MultiPolygon",coordinates:e}}};r.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":661}],678:[function(t,e,r){"use strict";var n=t("./mod");r.segmentsIntersect=a;function a(t,e,r,n,a,i,o,s){var l=r-t,u=a-t,c=o-a,f=n-e,h=i-e,p=s-i,d=l*p-c*f;if(d===0)return null;var v=(u*p-c*h)/d,g=(u*f-l*h)/d;if(g<0||g>1||v<0||v>1)return null;return{x:t+l*v,y:e+f*v}}r.segmentDistance=function t(e,r,n,o,s,l,u,c){if(a(e,r,n,o,s,l,u,c))return 0;var f=n-e;var h=o-r;var p=u-s;var d=c-l;var v=f*f+h*h;var g=p*p+d*d;var m=Math.min(i(f,h,v,s-e,l-r),i(f,h,v,u-e,c-r),i(p,d,g,e-s,r-l),i(p,d,g,n-s,o-l));return Math.sqrt(m)};function i(t,e,r,n,a){var i=n*t+a*e;if(i<0){return n*n+a*a}else if(i>r){var o=n-t;var s=a-e;return o*o+s*s}else{var l=n*e-a*t;return l*l/r}}var o,s,l;r.getTextLocation=function t(e,r,a,i){if(e!==s||i!==l){o={};s=e;l=i}if(o[a]){return o[a]}var u=e.getPointAtLength(n(a-i/2,r));var c=e.getPointAtLength(n(a+i/2,r));var f=Math.atan((c.y-u.y)/(c.x-u.x));var h=e.getPointAtLength(n(a,r));var p=(h.x*4+u.x+c.x)/6;var d=(h.y*4+u.y+c.y)/6;var v={x:p,y:d,theta:f};o[a]=v;return v};r.clearLocationCache=function(){s=null};r.getVisibleSegment=function t(e,r,n){var a=r.left;var i=r.right;var o=r.top;var s=r.bottom;var l=0;var u=e.getTotalLength();var c=u;var f,h;function p(t){var r=e.getPointAtLength(t);if(t===0)f=r;else if(t===u)h=r;var n=r.x<a?a-r.x:r.x>i?r.x-i:0;var l=r.y<o?o-r.y:r.y>s?r.y-s:0;return Math.sqrt(n*n+l*l)}var d=p(l);while(d){l+=d+n;if(l>c)return;d=p(l)}d=p(c);while(d){c-=d+n;if(l>c)return;d=p(c)}return{min:l,max:c,len:c-l,total:u,isClosed:l===0&&c===u&&Math.abs(f.x-h.x)<.1&&Math.abs(f.y-h.y)<.1}};r.findPointOnPath=function t(e,r,n,a){a=a||{};var i=a.pathLength||e.getTotalLength();var o=a.tolerance||.001;var s=a.iterationLimit||30;var l=e.getPointAtLength(0)[n]>e.getPointAtLength(i)[n]?-1:1;var u=0;var c=0;var f=i;var h;var p;var d;while(u<s){h=(c+f)/2;p=e.getPointAtLength(h);d=p[n]-r;if(Math.abs(d)<o){return p}else{if(l*d>0){f=h}else{c=h}u++}}return p}},{"./mod":691}],679:[function(t,e,r){"use strict";e.exports=function(t){var e;if(typeof t==="string"){e=document.getElementById(t);if(e===null){throw new Error("No DOM element with id '"+t+"' exists on the page.")}return e}else if(t===null||t===undefined){throw new Error("DOM element provided is null or undefined")}return t}},{}],680:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("tinycolor2");var i=t("color-normalize");var o=t("../components/colorscale");var s=t("../components/color/attributes").defaultLine;var l=t("./is_array").isArrayOrTypedArray;var u=i(s);var c=1;function f(t,e){var r=t;r[3]*=e;return r}function h(t){if(n(t))return u;var e=i(t);return e.length?e:u}function p(t){return n(t)?t:c}function d(t,e,r){var n=t.color;var a=l(n);var s=l(e);var d=[];var v,g,m,y,x;if(t.colorscale!==undefined){v=o.makeColorScaleFunc(o.extractScale(t.colorscale,t.cmin,t.cmax))}else{v=h}if(a){g=function(t,e){return t[e]===undefined?u:i(v(t[e]))}}else g=h;if(s){m=function(t,e){return t[e]===undefined?c:p(t[e])}}else m=p;if(a||s){for(var b=0;b<r;b++){y=g(n,b);x=m(e,b);d[b]=f(y,x)}}else d=f(i(n),e);return d}function v(t,e){if(e===undefined)e=1;return t.map(function(t){var r=t[0];var n=a(t[1]);var i=n.toRgb();return{index:r,rgb:[i.r,i.g,i.b,e]}})}e.exports={formatColor:d,parseColorScale:v}},{"../components/color/attributes":557,"../components/colorscale":573,"./is_array":685,"color-normalize":107,"fast-isnumeric":214,tinycolor2:499}],681:[function(t,e,r){"use strict";var n=t("./identity");function a(t){return[t]}e.exports={keyFun:function(t){return t.key},repeat:a,descend:n,wrap:a,unwrap:function(t){return t[0]}}},{"./identity":683}],682:[function(t,e,r){"use strict";var n=t("superscript-text");var a=t("../constants/string_mappings");function i(t){var e=0;while((e=t.indexOf("<sup>",e))>=0){var r=t.indexOf("</sup>",e);if(r<e)break;t=t.slice(0,e)+n(t.slice(e+5,r))+t.slice(r+6)}return t}function o(t){return t.replace(/\<br\>/g,"\n")}function s(t){return t.replace(/\<.*\>/g,"")}function l(t){var e=a.entityToUnicode;var r=0;while((r=t.indexOf("&",r))>=0){var n=t.indexOf(";",r);if(n<r){r+=1;continue}var i=e[t.slice(r+1,n)];if(i){t=t.slice(0,r)+i+t.slice(n+1)}else{t=t.slice(0,r)+t.slice(n+1)}}return t}function u(t){return""+l(s(i(o(t))))}e.exports=u},{"../constants/string_mappings":662,"superscript-text":492}],683:[function(t,e,r){"use strict";e.exports=function t(e){return e}},{}],684:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("../constants/numerical");var o=i.FP_SAFE;var s=i.BADNUM;var l=e.exports={};l.nestedProperty=t("./nested_property");l.keyedContainer=t("./keyed_container");l.relativeAttr=t("./relative_attr");l.isPlainObject=t("./is_plain_object");l.mod=t("./mod");l.toLogRange=t("./to_log_range");l.relinkPrivateKeys=t("./relink_private");l.ensureArray=t("./ensure_array");var u=t("./is_array");l.isTypedArray=u.isTypedArray;l.isArrayOrTypedArray=u.isArrayOrTypedArray;l.isArray1D=u.isArray1D;var c=t("./coerce");l.valObjectMeta=c.valObjectMeta;l.coerce=c.coerce;l.coerce2=c.coerce2;l.coerceFont=c.coerceFont;l.coerceHoverinfo=c.coerceHoverinfo;l.coerceSelectionMarkerOpacity=c.coerceSelectionMarkerOpacity;l.validate=c.validate;var f=t("./dates");l.dateTime2ms=f.dateTime2ms;l.isDateTime=f.isDateTime;l.ms2DateTime=f.ms2DateTime;l.ms2DateTimeLocal=f.ms2DateTimeLocal;l.cleanDate=f.cleanDate;l.isJSDate=f.isJSDate;l.formatDate=f.formatDate;l.incrementMonth=f.incrementMonth;l.dateTick0=f.dateTick0;l.dfltRange=f.dfltRange;l.findExactDates=f.findExactDates;l.MIN_MS=f.MIN_MS;l.MAX_MS=f.MAX_MS;var h=t("./search");l.findBin=h.findBin;l.sorterAsc=h.sorterAsc;l.sorterDes=h.sorterDes;l.distinctVals=h.distinctVals;l.roundUp=h.roundUp;var p=t("./stats");l.aggNums=p.aggNums;l.len=p.len;l.mean=p.mean;l.midRange=p.midRange;l.variance=p.variance;l.stdev=p.stdev;l.interp=p.interp;var d=t("./matrix");l.init2dArray=d.init2dArray;l.transposeRagged=d.transposeRagged;l.dot=d.dot;l.translationMatrix=d.translationMatrix;l.rotationMatrix=d.rotationMatrix;l.rotationXYMatrix=d.rotationXYMatrix;l.apply2DTransform=d.apply2DTransform;l.apply2DTransform2=d.apply2DTransform2;var v=t("./angles");l.deg2rad=v.deg2rad;l.rad2deg=v.rad2deg;l.wrap360=v.wrap360;l.wrap180=v.wrap180;var g=t("./geometry2d");l.segmentsIntersect=g.segmentsIntersect;l.segmentDistance=g.segmentDistance;l.getTextLocation=g.getTextLocation;l.clearLocationCache=g.clearLocationCache;l.getVisibleSegment=g.getVisibleSegment;l.findPointOnPath=g.findPointOnPath;var m=t("./extend");l.extendFlat=m.extendFlat;l.extendDeep=m.extendDeep;l.extendDeepAll=m.extendDeepAll;l.extendDeepNoArrays=m.extendDeepNoArrays;var y=t("./loggers");l.log=y.log;l.warn=y.warn;l.error=y.error;var x=t("./regex");l.counterRegex=x.counter;var b=t("./throttle");l.throttle=b.throttle;l.throttleDone=b.done;l.clearThrottle=b.clear;l.getGraphDiv=t("./get_graph_div");l._=t("./localize");l.notifier=t("./notifier");l.filterUnique=t("./filter_unique");l.filterVisible=t("./filter_visible");l.pushUnique=t("./push_unique");l.cleanNumber=t("./clean_number");l.ensureNumber=function t(e){if(!a(e))return s;e=Number(e);if(e<-o||e>o)return s;return a(e)?Number(e):s};l.isIndex=function(t,e){if(e!==undefined&&t>=e)return false;return a(t)&&t>=0&&t%1===0};l.noop=t("./noop");l.identity=t("./identity");l.swapAttrs=function(t,e,r,n){if(!r)r="x";if(!n)n="y";for(var a=0;a<e.length;a++){var i=e[a],o=l.nestedProperty(t,i.replace("?",r)),s=l.nestedProperty(t,i.replace("?",n)),u=o.get();o.set(s.get());s.set(u)}};l.raiseToTop=function t(e){e.parentNode.appendChild(e)};l.cancelTransition=function(t){return t.transition().duration(0)};l.constrain=function(t,e,r){if(e>r)return Math.max(r,Math.min(e,t));return Math.max(e,Math.min(r,t))};l.bBoxIntersect=function(t,e,r){r=r||0;return t.left<=e.right+r&&e.left<=t.right+r&&t.top<=e.bottom+r&&e.top<=t.bottom+r};l.simpleMap=function(t,e,r,n){var a=t.length,i=new Array(a);for(var o=0;o<a;o++)i[o]=e(t[o],r,n);return i};l.randstr=function t(e,r,n,a){if(!n)n=16;if(r===undefined)r=24;if(r<=0)return"0";var i=Math.log(Math.pow(2,r))/Math.log(n);var o="";var s,u,c;for(s=2;i===Infinity;s*=2){i=Math.log(Math.pow(2,r/s))/Math.log(n)*s}var f=i-Math.floor(i);for(s=0;s<Math.floor(i);s++){c=Math.floor(Math.random()*n).toString(n);o=c+o}if(f){u=Math.pow(n,f);c=Math.floor(Math.random()*u).toString(n);o=c+o}var h=parseInt(o,n);if(e&&e[o]||h!==Infinity&&h>=Math.pow(2,r)){if(a>10){l.warn("randstr failed uniqueness");return o}return t(e,r,n,(a||0)+1)}else return o};l.OptionControl=function(t,e){if(!t)t={};if(!e)e="opt";var r={};r.optionList=[];r._newoption=function(n){n[e]=t;r[n.name]=n;r.optionList.push(n)};r["_"+e]=t;return r};l.smooth=function(t,e){e=Math.round(e)||0;if(e<2)return t;var r=t.length,n=2*r,a=2*e-1,i=new Array(a),o=new Array(r),s,l,u,c;for(s=0;s<a;s++){i[s]=(1-Math.cos(Math.PI*(s+1)/e))/(2*e)}for(s=0;s<r;s++){c=0;for(l=0;l<a;l++){u=s+l+1-e;if(u<-r)u-=n*Math.round(u/n);else if(u>=n)u-=n*Math.floor(u/n);if(u<0)u=-1-u;else if(u>=r)u=n-1-u;c+=t[u]*i[l]}o[s]=c}return o};l.syncOrAsync=function(t,e,r){var n,a;function i(){return l.syncOrAsync(t,e,r)}while(t.length){a=t.splice(0,1)[0];n=a(e);if(n&&n.then){return n.then(i).then(undefined,l.promiseError)}}return r&&r(e)};l.stripTrailingSlash=function(t){if(t.substr(-1)==="/")return t.substr(0,t.length-1);return t};l.noneOrAll=function(t,e,r){if(!t)return;var n=false,a=true,i,o;for(i=0;i<r.length;i++){o=t[r[i]];if(o!==undefined&&o!==null)n=true;else a=false}if(n&&!a){for(i=0;i<r.length;i++){t[r[i]]=e[r[i]]}}};l.mergeArray=function(t,e,r){if(l.isArrayOrTypedArray(t)){var n=Math.min(t.length,e.length);for(var a=0;a<n;a++)e[a][r]=t[a]}};l.fillArray=function(t,e,r,n){n=n||l.identity;if(l.isArrayOrTypedArray(t)){for(var a=0;a<e.length;a++){e[a][r]=n(t[a])}}};l.castOption=function(t,e,r,n){n=n||l.identity;var a=l.nestedProperty(t,r).get();if(l.isArrayOrTypedArray(a)){if(Array.isArray(e)&&l.isArrayOrTypedArray(a[e[0]])){return n(a[e[0]][e[1]])}else{return n(a[e])}}else{return a}};l.extractOption=function(t,e,r,n){if(r in t)return t[r];var a=l.nestedProperty(e,n).get();if(!Array.isArray(a))return a};function _(t){var e={};for(var r in t){var n=t[r];for(var a=0;a<n.length;a++){e[n[a]]=+r}}return e}l.tagSelected=function(t,e,r){var n=e.selectedpoints;var a=e._indexToPoints;var i;if(a){i=_(a)}function o(e){return e!==undefined&&e<t.length}for(var s=0;s<n.length;s++){var u=n[s];if(l.isIndex(u)){var c=i?i[u]:u;var f=r?r[c]:c;if(o(f)){t[f].selected=1}}}};l.selIndices2selPoints=function(t){var e=t.selectedpoints;var r=t._indexToPoints;if(r){var n=_(r);var a=[];for(var i=0;i<e.length;i++){var o=e[i];if(l.isIndex(o)){var s=n[o];if(l.isIndex(s)){a.push(s)}}}return a}else{return e}};l.getTargetArray=function(t,e){var r=e.target;if(typeof r==="string"&&r){var n=l.nestedProperty(t,r).get();return Array.isArray(n)?n:false}else if(Array.isArray(r)){return r}return false};l.minExtend=function(t,e){var r={};if(typeof e!=="object")e={};var n=3,a=Object.keys(t),i,o,s;for(i=0;i<a.length;i++){o=a[i];s=t[o];if(o.charAt(0)==="_"||typeof s==="function")continue;else if(o==="module")r[o]=s;else if(Array.isArray(s))r[o]=s.slice(0,n);else if(s&&typeof s==="object")r[o]=l.minExtend(t[o],e[o]);else r[o]=s}a=Object.keys(e);for(i=0;i<a.length;i++){o=a[i];s=e[o];if(typeof s!=="object"||!(o in r)||typeof r[o]!=="object"){r[o]=s}}return r};l.titleCase=function(t){return t.charAt(0).toUpperCase()+t.substr(1)};l.containsAny=function(t,e){for(var r=0;r<e.length;r++){if(t.indexOf(e[r])!==-1)return true}return false};l.isPlotDiv=function(t){var e=n.select(t);return e.node()instanceof HTMLElement&&e.size()&&e.classed("js-plotly-plot")};l.removeElement=function(t){var e=t&&t.parentNode;if(e)e.removeChild(t)};l.addStyleRule=function(t,e){if(!l.styleSheet){var r=document.createElement("style");r.appendChild(document.createTextNode(""));document.head.appendChild(r);l.styleSheet=r.sheet}var n=l.styleSheet;if(n.insertRule){n.insertRule(t+"{"+e+"}",0)}else if(n.addRule){n.addRule(t,e,0)}else l.warn("addStyleRule failed")};l.isIE=function(){return typeof window.navigator.msSaveBlob!=="undefined"};l.isD3Selection=function(t){return t&&typeof t.classed==="function"};l.ensureSingle=function(t,e,r,n){var a=t.select(e+(r?"."+r:""));if(a.size())return a;var i=t.append(e).classed(r,true);if(n)i.call(n);return i};l.ensureSingleById=function(t,e,r,n){var a=t.select(e+"#"+r);if(a.size())return a;var i=t.append(e).attr("id",r);if(n)i.call(n);return i};l.objectFromPath=function(t,e){var r=t.split("."),n,a=n={};for(var i=0;i<r.length;i++){var o=r[i];var s=null;var l=r[i].match(/(.*)\[([0-9]+)\]/);if(l){o=l[1];s=l[2];n=n[o]=[];if(i===r.length-1){n[s]=e}else{n[s]={}}n=n[s]}else{if(i===r.length-1){n[o]=e}else{n[o]={}}n=n[o]}}return a};var w=/^([^\[\.]+)\.(.+)?/;var k=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;l.expandObjectPaths=function(t){var e,r,n,a,i,o,s;if(typeof t==="object"&&!Array.isArray(t)){for(r in t){if(t.hasOwnProperty(r)){if(e=r.match(w)){a=t[r];n=e[1];delete t[r];t[n]=l.extendDeepNoArrays(t[n]||{},l.objectFromPath(r,l.expandObjectPaths(a))[n])}else if(e=r.match(k)){a=t[r];n=e[1];i=parseInt(e[2]);delete t[r];t[n]=t[n]||[];if(e[3]==="."){s=e[4];o=t[n][i]=t[n][i]||{};l.extendDeepNoArrays(o,l.objectFromPath(s,l.expandObjectPaths(a)))}else{t[n][i]=l.expandObjectPaths(a)}}else{t[r]=l.expandObjectPaths(t[r])}}}}return t};l.numSeparate=function(t,e,r){if(!r)r=false;if(typeof e!=="string"||e.length===0){throw new Error("Separator string required for formatting!")}if(typeof t==="number"){t=String(t)}var n=/(\d+)(\d{3})/,a=e.charAt(0),i=e.charAt(1);var o=t.split("."),s=o[0],l=o.length>1?a+o[1]:"";if(i&&(o.length>1||s.length>4||r)){while(n.test(s)){s=s.replace(n,"$1"+i+"$2")}}return s+l};var M=/%{([^\s%{}]*)}/g;var A=/^\w*$/;l.templateString=function(t,e){var r={};return t.replace(M,function(t,n){if(A.test(n)){return e[n]||""}r[n]=r[n]||l.nestedProperty(e,n).get;return r[n]()||""})};var T=48;var S=57;l.subplotSort=function(t,e){var r=Math.min(t.length,e.length)+1;var n=0;var a=0;for(var i=0;i<r;i++){var o=t.charCodeAt(i)||0;var s=e.charCodeAt(i)||0;var l=o>=T&&o<=S;var u=s>=T&&s<=S;if(l)n=10*n+o-T;if(u)a=10*a+s-T;if(!l||!u){if(n!==a)return n-a;if(o!==s)return o-s}}return a-n};var E=2e9;l.seedPseudoRandom=function(){E=2e9};l.pseudoRandom=function(){var t=E;E=(69069*E+1)%4294967296;if(Math.abs(E-t)<429496729)return l.pseudoRandom();return E/4294967296}},{"../constants/numerical":661,"./angles":666,"./clean_number":667,"./coerce":669,"./dates":670,"./ensure_array":671,"./extend":673,"./filter_unique":674,"./filter_visible":675,"./geometry2d":678,"./get_graph_div":679,"./identity":683,"./is_array":685,"./is_plain_object":686,"./keyed_container":687,"./localize":688,"./loggers":689,"./matrix":690,"./mod":691,"./nested_property":692,"./noop":693,"./notifier":694,"./push_unique":698,"./regex":700,"./relative_attr":701,"./relink_private":702,"./search":703,"./stats":706,"./throttle":709,"./to_log_range":710,d3:147,"fast-isnumeric":214}],685:[function(t,e,r){"use strict";var n=typeof ArrayBuffer==="undefined"||!ArrayBuffer.isView?{isView:function(){return false}}:ArrayBuffer;var a=typeof DataView==="undefined"?function(){}:DataView;function i(t){return n.isView(t)&&!(t instanceof a)}function o(t){return Array.isArray(t)||i(t)}function s(t){return!o(t[0])}e.exports={isTypedArray:i,isArrayOrTypedArray:o,isArray1D:s}},{}],686:[function(t,e,r){"use strict";e.exports=function t(e){if(window&&window.process&&window.process.versions){return Object.prototype.toString.call(e)==="[object Object]"}return Object.prototype.toString.call(e)==="[object Object]"&&Object.getPrototypeOf(e)===Object.prototype}},{}],687:[function(t,e,r){"use strict";var n=t("./nested_property");var a=/^\w*$/;var i=0;var o=1;var s=2;var l=3;var u=4;e.exports=function t(e,r,c,f){c=c||"name";f=f||"value";var h,p,d;var v={};if(r&&r.length){d=n(e,r);p=d.get()}else{p=e}r=r||"";var g={};if(p){for(h=0;h<p.length;h++){g[p[h][c]]=h}}var m=a.test(f);var y={set:function(t,e){var r=e===null?u:i;if(!p){if(!d||r===u)return;p=[];d.set(p)}var a=g[t];if(a===undefined){if(r===u)return;r=r|l;a=p.length;g[t]=a}else if(e!==(m?p[a][f]:n(p[a],f).get())){r=r|s}var o=p[a]=p[a]||{};o[c]=t;if(m){o[f]=e}else{n(o,f).set(e)}if(e!==null){r=r&~u}v[a]=v[a]|r;return y},get:function(t){if(!p)return;var e=g[t];if(e===undefined){return undefined}else if(m){return p[e][f]}else{return n(p[e],f).get()}},rename:function(t,e){var r=g[t];if(r===undefined)return y;v[r]=v[r]|o;g[e]=r;delete g[t];p[r][c]=e;return y},remove:function(t){var e=g[t];if(e===undefined)return y;var r=p[e];if(Object.keys(r).length>2){v[e]=v[e]|s;return y.set(t,null)}if(m){for(h=e;h<p.length;h++){v[h]=v[h]|l}for(h=e;h<p.length;h++){g[p[h][c]]--}p.splice(e,1);delete g[t]}else{n(r,f).set(null);v[e]=v[e]|s|u}return y},constructUpdate:function(){var t,e;var a={};var i=Object.keys(v);for(var l=0;l<i.length;l++){e=i[l];t=r+"["+e+"]";if(p[e]){if(v[e]&o){a[t+"."+c]=p[e][c]}if(v[e]&s){if(m){a[t+"."+f]=v[e]&u?null:p[e][f]}else{a[t+"."+f]=v[e]&u?null:n(p[e],f).get()}}}else{a[t]=null}}return a}};return y}},{"./nested_property":692}],688:[function(t,e,r){"use strict";var n=t("../registry");e.exports=function t(e,r){var a=e._context.locale;for(var i=0;i<2;i++){var o=e._context.locales;for(var s=0;s<2;s++){var l=(o[a]||{}).dictionary;if(l){var u=l[r];if(u)return u}o=n.localeRegistry}var c=a.split("-")[0];if(c===a)break;a=c}return r}},{"../registry":817}],689:[function(t,e,r){"use strict";var n=t("../plot_api/plot_config");var a=e.exports={};a.log=function(){if(n.logging>1){var t=["LOG:"];for(var e=0;e<arguments.length;e++){t.push(arguments[e])}i(console.trace||console.log,t)}};a.warn=function(){if(n.logging>0){var t=["WARN:"];for(var e=0;e<arguments.length;e++){t.push(arguments[e])}i(console.trace||console.log,t)}};a.error=function(){if(n.logging>0){var t=["ERROR:"];for(var e=0;e<arguments.length;e++){t.push(arguments[e])}i(console.error,t)}};function i(t,e){if(t.apply){t.apply(t,e)}else{for(var r=0;r<e.length;r++){t(e[r])}}}},{"../plot_api/plot_config":720}],690:[function(t,e,r){"use strict";r.init2dArray=function(t,e){var r=new Array(t);for(var n=0;n<t;n++)r[n]=new Array(e);return r};r.transposeRagged=function(t){var e=0,r=t.length,n,a;for(n=0;n<r;n++)e=Math.max(e,t[n].length);var i=new Array(e);for(n=0;n<e;n++){i[n]=new Array(r);for(a=0;a<r;a++)i[n][a]=t[a][n]}return i};r.dot=function(t,e){if(!(t.length&&e.length)||t.length!==e.length)return null;var n=t.length,a,i;if(t[0].length){a=new Array(n);for(i=0;i<n;i++)a[i]=r.dot(t[i],e)}else if(e[0].length){var o=r.transposeRagged(e);a=new Array(o.length);for(i=0;i<o.length;i++)a[i]=r.dot(t,o[i])}else{a=0;for(i=0;i<n;i++)a+=t[i]*e[i]}return a};r.translationMatrix=function(t,e){return[[1,0,t],[0,1,e],[0,0,1]]};r.rotationMatrix=function(t){var e=t*Math.PI/180;return[[Math.cos(e),-Math.sin(e),0],[Math.sin(e),Math.cos(e),0],[0,0,1]]};r.rotationXYMatrix=function(t,e,n){return r.dot(r.dot(r.translationMatrix(e,n),r.rotationMatrix(t)),r.translationMatrix(-e,-n))};r.apply2DTransform=function(t){return function(){var e=arguments;if(e.length===3){e=e[0]}var n=arguments.length===1?e[0]:[e[0],e[1]];return r.dot(t,[n[0],n[1],1]).slice(0,2)}};r.apply2DTransform2=function(t){var e=r.apply2DTransform(t);return function(t){return e(t.slice(0,2)).concat(e(t.slice(2,4)))}}},{}],691:[function(t,e,r){"use strict";e.exports=function t(e,r){var n=e%r;return n<0?n+r:n}},{}],692:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("./is_array").isArrayOrTypedArray;e.exports=function t(e,r){if(n(r))r=String(r);else if(typeof r!=="string"||r.substr(r.length-4)==="[-1]"){throw"bad property string"}var a=0,o=r.split("."),s,u,c;while(a<o.length){s=String(o[a]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/);if(s){if(s[1])o[a]=s[1];else if(a===0)o.splice(0,1);else throw"bad property string";u=s[2].substr(1,s[2].length-2).split("][");for(c=0;c<u.length;c++){a++;o.splice(a,0,Number(u[c]))}}a++}if(typeof e!=="object"){return h(e,r,o)}return{set:l(e,o,r),get:i(e,o),astr:r,parts:o,obj:e}};function i(t,e){return function(){var r=t,n,o,s,l,u;for(l=0;l<e.length-1;l++){n=e[l];if(n===-1){o=true;s=[];for(u=0;u<r.length;u++){s[u]=i(r[u],e.slice(l+1))();if(s[u]!==s[0])o=false}return o?s[0]:s}if(typeof n==="number"&&!a(r)){return undefined}r=r[n];if(typeof r!=="object"||r===null){return undefined}}if(typeof r!=="object"||r===null)return undefined;s=r[e[l]];if(s===null)return undefined;return s}}var o=/(^|\.)args\[/;function s(t,e){return t===undefined||t===null&&!e.match(o)}function l(t,e,r){return function(n){var i=t,o="",l=[[t,o]],h=s(n,r),p,d;for(d=0;d<e.length-1;d++){p=e[d];if(typeof p==="number"&&!a(i)){throw"array index but container is not an array"}if(p===-1){h=!c(i,e.slice(d+1),n,r);if(h)break;else return}if(!f(i,p,e[d+1],h)){break}i=i[p];if(typeof i!=="object"||i===null){throw"container is not an object"}o=u(o,p);l.push([i,o])}if(h){if(d===e.length-1){delete i[e[d]];if(Array.isArray(i)&&+e[d]===i.length-1){while(i.length&&i[i.length-1]===undefined){i.pop()}}}}else i[e[d]]=n}}function u(t,e){var r=e;if(n(e))r="["+e+"]";else if(t)r="."+e;return t+r}function c(t,e,r,n){var i=a(r),o=true,u=r,c=n.replace("-1",0),h=i?false:s(r,c),p=e[0],d;for(d=0;d<t.length;d++){c=n.replace("-1",d);if(i){u=r[d%r.length];h=s(u,c)}if(h)o=false;if(!f(t,d,p,h)){continue}l(t[d],e,n.replace("-1",d))(u)}return o}function f(t,e,r,n){if(t[e]===undefined){if(n)return false;if(typeof r==="number")t[e]=[];else t[e]={}}return true}function h(t,e,r){return{set:function(){throw"bad container"},get:function(){},astr:e,parts:r,obj:t}}},{"./is_array":685,"fast-isnumeric":214}],693:[function(t,e,r){"use strict";e.exports=function t(){}},{}],694:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=[];e.exports=function(t,e){if(i.indexOf(t)!==-1)return;i.push(t);var r=1e3;if(a(e))r=e;else if(e==="long")r=3e3;var o=n.select("body").selectAll(".plotly-notifier").data([0]);o.enter().append("div").classed("plotly-notifier",true);var s=o.selectAll(".notifier-note").data(i);function l(t){t.duration(700).style("opacity",0).each("end",function(t){var e=i.indexOf(t);if(e!==-1)i.splice(e,1);n.select(this).remove()})}s.enter().append("div").classed("notifier-note",true).style("opacity",0).each(function(t){var e=n.select(this);e.append("button").classed("notifier-close",true).html("&times;").on("click",function(){e.transition().call(l)});var a=e.append("p");var i=t.split(/<br\s*\/?>/g);for(var o=0;o<i.length;o++){if(o)a.append("br");a.append("span").text(i[o])}e.transition().duration(700).style("opacity",1).transition().delay(r).call(l)})}},{d3:147,"fast-isnumeric":214}],695:[function(t,e,r){"use strict";var n=t("./setcursor");var a="data-savedcursor";var i="!!";e.exports=function t(e,r){var o=e.attr(a);if(r){if(!o){var s=(e.attr("class")||"").split(" ");for(var l=0;l<s.length;l++){var u=s[l];if(u.indexOf("cursor-")===0){e.attr(a,u.substr(7)).classed(u,false)}}if(!e.attr(a)){e.attr(a,i)}}n(e,r)}else if(o){e.attr(a,null);if(o===i)n(e);else n(e,o)}}},{"./setcursor":704}],696:[function(t,e,r){"use strict";var n=t("./matrix").dot;var a=t("../constants/numerical").BADNUM;var i=e.exports={};i.tester=function t(e){if(Array.isArray(e[0][0]))return i.multitester(e);var r=e.slice(),n=r[0][0],o=n,s=r[0][1],l=s,u;r.push(r[0]);for(u=1;u<r.length;u++){n=Math.min(n,r[u][0]);o=Math.max(o,r[u][0]);s=Math.min(s,r[u][1]);l=Math.max(l,r[u][1])}var c=false,f;if(r.length===5){if(r[0][0]===r[1][0]){if(r[2][0]===r[3][0]&&r[0][1]===r[3][1]&&r[1][1]===r[2][1]){c=true;f=function(t){return t[0]===r[0][0]}}}else if(r[0][1]===r[1][1]){if(r[2][1]===r[3][1]&&r[0][0]===r[3][0]&&r[1][0]===r[2][0]){c=true;f=function(t){return t[1]===r[0][1]}}}}function h(t,e){var r=t[0],i=t[1];if(r===a||r<n||r>o||i===a||i<s||i>l){return false}if(e&&f(t))return false;return true}function p(t,e){var i=t[0],u=t[1];if(i===a||i<n||i>o||u===a||u<s||u>l){return false}var c=r.length,f=r[0][0],h=r[0][1],p=0,d,v,g,m,y;for(d=1;d<c;d++){v=f;g=h;f=r[d][0];h=r[d][1];m=Math.min(v,f);if(i<m||i>Math.max(v,f)||u>Math.max(g,h)){continue}else if(u<Math.min(g,h)){if(i!==m)p++}else{if(f===v)y=u;else y=g+(i-v)*(h-g)/(f-v);if(u===y){if(d===1&&e)return false;return true}if(u<=y&&i!==m)p++}}return p%2===1}var d=true;var v=r[0];for(u=1;u<r.length;u++){if(v[0]!==r[u][0]||v[1]!==r[u][1]){d=false;break}}return{xmin:n,xmax:o,ymin:s,ymax:l,pts:r,contains:c?h:p,isRect:c,degenerate:d}};i.multitester=function t(e){var r=[],n=e[0][0][0],a=n,o=e[0][0][1],s=o;for(var l=0;l<e.length;l++){var u=i.tester(e[l]);u.subtract=e[l].subtract;r.push(u);n=Math.min(n,u.xmin);a=Math.max(a,u.xmax);o=Math.min(o,u.ymin);s=Math.max(s,u.ymax)}function c(t,e){var n=false;for(var a=0;a<r.length;a++){if(r[a].contains(t,e)){n=r[a].subtract===false}}return n}return{xmin:n,xmax:a,ymin:o,ymax:s,pts:[],contains:c,isRect:false,degenerate:false}};var o=i.isSegmentBent=function t(e,r,a,i){var o=e[r],s=[e[a][0]-o[0],e[a][1]-o[1]],l=n(s,s),u=Math.sqrt(l),c=[-s[1]/u,s[0]/u],f,h,p;for(f=r+1;f<a;f++){h=[e[f][0]-o[0],e[f][1]-o[1]];p=n(h,s);if(p<0||p>l||Math.abs(n(h,c))>i)return true}return false};i.filter=function t(e,r){var n=[e[0]],a=0,i=0;function s(t){e.push(t);var s=n.length,l=a;n.splice(i+1);for(var u=l+1;u<e.length;u++){if(u===e.length-1||o(e,l,u+1,r)){n.push(e[u]);if(n.length<s-2){a=u;i=n.length-1}l=u}}}if(e.length>1){var l=e.pop();s(l)}return{addPt:s,raw:e,filtered:n}}},{"../constants/numerical":661,"./matrix":690}],697:[function(t,e,r){(function(r){"use strict";var n=t("./show_no_webgl_msg");var a=t("regl");e.exports=function t(e,i){var o=e._fullLayout;var s=true;o._glcanvas.each(function(t){if(t.regl)return;if(t.pick&&!o._has("parcoords"))return;try{t.regl=a({canvas:this,attributes:{antialias:!t.pick,preserveDrawingBuffer:true},pixelRatio:e._context.plotGlPixelRatio||r.devicePixelRatio,extensions:i||[]})}catch(t){s=false}});if(!s){n({container:o._glcontainer.node()})}return s}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./show_no_webgl_msg":705,regl:463}],698:[function(t,e,r){"use strict";e.exports=function t(e,r){if(r instanceof RegExp){var n=r.toString(),a;for(a=0;a<e.length;a++){if(e[a]instanceof RegExp&&e[a].toString()===n){return e}}e.push(r)}else if((r||r===0)&&e.indexOf(r)===-1)e.push(r);return e}},{}],699:[function(t,e,r){"use strict";var n=t("../lib");var a=t("../plot_api/plot_config");function i(t,e){var r=[];var a;for(var i=0;i<e.length;i++){a=e[i];if(a===t)r[i]=a;else if(typeof a==="object"){r[i]=Array.isArray(a)?n.extendDeep([],a):n.extendDeepAll({},a)}else r[i]=a}return r}var o={};o.add=function(t,e,r,n,i){var o,s;t.undoQueue=t.undoQueue||{index:0,queue:[],sequence:false};s=t.undoQueue.index;if(t.autoplay){if(!t.undoQueue.inSequence)t.autoplay=false;return}if(!t.undoQueue.sequence||t.undoQueue.beginSequence){o={undo:{calls:[],args:[]},redo:{calls:[],args:[]}};t.undoQueue.queue.splice(s,t.undoQueue.queue.length-s,o);t.undoQueue.index+=1}else{o=t.undoQueue.queue[s-1]}t.undoQueue.beginSequence=false;if(o){o.undo.calls.unshift(e);o.undo.args.unshift(r);o.redo.calls.push(n);o.redo.args.push(i)}if(t.undoQueue.queue.length>a.queueLength){t.undoQueue.queue.shift();t.undoQueue.index--}};o.startSequence=function(t){t.undoQueue=t.undoQueue||{index:0,queue:[],sequence:false};t.undoQueue.sequence=true;t.undoQueue.beginSequence=true};o.stopSequence=function(t){t.undoQueue=t.undoQueue||{index:0,queue:[],sequence:false};t.undoQueue.sequence=false;t.undoQueue.beginSequence=false};o.undo=function t(e){var r,n;if(e.framework&&e.framework.isPolar){e.framework.undo();return}if(e.undoQueue===undefined||isNaN(e.undoQueue.index)||e.undoQueue.index<=0){return}e.undoQueue.index--;r=e.undoQueue.queue[e.undoQueue.index];e.undoQueue.inSequence=true;for(n=0;n<r.undo.calls.length;n++){o.plotDo(e,r.undo.calls[n],r.undo.args[n])}e.undoQueue.inSequence=false;e.autoplay=false};o.redo=function t(e){var r,n;if(e.framework&&e.framework.isPolar){e.framework.redo();return}if(e.undoQueue===undefined||isNaN(e.undoQueue.index)||e.undoQueue.index>=e.undoQueue.queue.length){return}r=e.undoQueue.queue[e.undoQueue.index];e.undoQueue.inSequence=true;for(n=0;n<r.redo.calls.length;n++){o.plotDo(e,r.redo.calls[n],r.redo.args[n])}e.undoQueue.inSequence=false;e.autoplay=false;e.undoQueue.index++};o.plotDo=function(t,e,r){t.autoplay=true;r=i(t,r);e.apply(null,r)};e.exports=o},{"../lib":684,"../plot_api/plot_config":720}],700:[function(t,e,r){"use strict";r.counter=function(t,e,r){var n=(e||"")+(r?"":"$");if(t==="xy"){return new RegExp("^x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+n)}return new RegExp("^"+t+"([2-9]|[1-9][0-9]+)?"+n)}},{}],701:[function(t,e,r){"use strict";var n=/^(.*)(\.[^\.\[\]]+|\[\d\])$/;var a=/^[^\.\[\]]+$/;e.exports=function(t,e){while(e){var r=t.match(n);if(r)t=r[1];else if(t.match(a))t="";else throw new Error("bad relativeAttr call:"+[t,e]);if(e.charAt(0)==="^")e=e.slice(1);else break}if(t&&e.charAt(0)!=="["){return t+"."+e}return t+e}},{}],702:[function(t,e,r){"use strict";var n=t("./is_array").isArrayOrTypedArray;var a=t("./is_plain_object");e.exports=function t(e,r){for(var i in r){var o=r[i];var s=e[i];if(s===o){continue}if(i.charAt(0)==="_"||typeof o==="function"){if(i in e)continue;e[i]=o}else if(n(o)&&n(s)&&a(o[0])){if(i==="customdata"||i==="ids")continue;var l=Math.min(o.length,s.length);for(var u=0;u<l;u++){if(s[u]!==o[u]&&a(o[u])&&a(s[u])){t(s[u],o[u])}}}else if(a(o)&&a(s)){t(s,o);if(!Object.keys(s).length)delete e[i]}}}},{"./is_array":685,"./is_plain_object":686}],703:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("./loggers");var i=1e-9;r.findBin=function(t,e,r){if(n(e.start)){return r?Math.ceil((t-e.start)/e.size-i)-1:Math.floor((t-e.start)/e.size+i)}else{var c=0;var f=e.length;var h=0;var p=f>1?(e[f-1]-e[0])/(f-1):1;var d,v;if(p>=0){v=r?o:s}else{v=r?u:l}t+=p*i*(r?-1:1)*(p>=0?1:-1);while(c<f&&h++<100){d=Math.floor((c+f)/2);if(v(e[d],t))c=d+1;else f=d}if(h>90)a.log("Long binary search...");return c-1}};function o(t,e){return t<e}function s(t,e){return t<=e}function l(t,e){return t>e}function u(t,e){return t>=e}r.sorterAsc=function(t,e){return t-e};r.sorterDes=function(t,e){return e-t};r.distinctVals=function(t){var e=t.slice();e.sort(r.sorterAsc);var n=e.length-1,a=e[n]-e[0]||1,i=a/(n||1)/1e4,o=[e[0]];for(var s=0;s<n;s++){if(e[s+1]>e[s]+i){a=Math.min(a,e[s+1]-e[s]);o.push(e[s+1])}}return{vals:o,minDiff:a}};r.roundUp=function(t,e,r){var n=0,a=e.length-1,i,o=0,s=r?0:1,l=r?1:0,u=r?Math.ceil:Math.floor;while(n<a&&o++<100){i=u((n+a)/2);if(e[i]<=t)n=i+s;else a=i-l}return e[n]}},{"./loggers":689,"fast-isnumeric":214}],704:[function(t,e,r){"use strict";e.exports=function t(e,r){(e.attr("class")||"").split(" ").forEach(function(t){if(t.indexOf("cursor-")===0)e.classed(t,false)});if(r)e.classed("cursor-"+r,true)}},{}],705:[function(t,e,r){"use strict";var n=t("../components/color");var a=function(){};e.exports=function t(e){for(var r in e){if(typeof e[r]==="function")e[r]=a}e.destroy=function(){e.container.parentNode.removeChild(e.container)};var i=document.createElement("div");i.className="no-webgl";i.style.cursor="pointer";i.style.fontSize="24px";i.style.color=n.defaults[0];i.style.position="absolute";i.style.left=i.style.top="0px";i.style.width=i.style.height="100%";i.style["background-color"]=n.lightLine;i.style["z-index"]=30;var o=document.createElement("p");o.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info";o.style.position="relative";o.style.top="50%";o.style.left="50%";o.style.height="30%";o.style.width="50%";o.style.margin="-15% 0 0 -25%";i.appendChild(o);e.container.appendChild(i);e.container.style.background="#FFFFFF";e.container.onclick=function(){window.open("https://get.webgl.org")};return false}},{"../components/color":558}],706:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("./is_array").isArrayOrTypedArray;r.aggNums=function(t,e,i,o){var s,l;if(!o||o>i.length)o=i.length;if(!n(e))e=false;if(a(i[0])){l=new Array(o);for(s=0;s<o;s++)l[s]=r.aggNums(t,e,i[s]);i=l}for(s=0;s<o;s++){if(!n(e))e=i[s];else if(n(i[s]))e=t(+e,+i[s])}return e};r.len=function(t){return r.aggNums(function(t){return t+1},0,t)};r.mean=function(t,e){if(!e)e=r.len(t);return r.aggNums(function(t,e){return t+e},0,t)/e};r.midRange=function(t){if(t===undefined||t.length===0)return undefined;return(r.aggNums(Math.max,null,t)+r.aggNums(Math.min,null,t))/2};r.variance=function(t,e,a){if(!e)e=r.len(t);if(!n(a))a=r.mean(t,e);return r.aggNums(function(t,e){return t+Math.pow(e-a,2)},0,t)/e};r.stdev=function(t,e,n){return Math.sqrt(r.variance(t,e,n))};r.interp=function(t,e){if(!n(e))throw"n should be a finite number";e=e*t.length-.5;if(e<0)return t[0];if(e>t.length-1)return t[t.length-1];var r=e%1;return r*t[Math.ceil(e)]+(1-r)*t[Math.floor(e)]}},{"./is_array":685,"fast-isnumeric":214}],707:[function(t,e,r){"use strict";var n=t("color-normalize");function a(t){if(!t)return[0,0,0,1];return n(t)}e.exports=a},{"color-normalize":107}],708:[function(t,e,r){"use strict";var n=t("d3");var a=t("../lib");var i=t("../constants/xmlns_namespaces");var o=t("../constants/string_mappings");var s=t("../constants/alignment").LINE_SPACING;function l(t,e){return t.node().getBoundingClientRect()[e]}var u=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;r.convertToTspans=function(t,e,a){var i=t.text();var o=!t.attr("data-notex")&&typeof MathJax!=="undefined"&&i.match(u);var s=n.select(t.node().parentNode);if(s.empty())return;var c=t.attr("class")?t.attr("class").split(" ")[0]:"text";c+="-math";s.selectAll("svg."+c).remove();s.selectAll("g."+c+"-group").remove();t.style("display",null).attr({"data-unformatted":i,"data-math":"N"});function f(){if(!s.empty()){c=t.attr("class")+"-math";s.select("svg."+c).remove()}t.text("").style("white-space","pre");var e=P(t.node(),i);if(e){t.style("pointer-events","all")}r.positionText(t);if(a)a.call(t)}if(o){(e&&e._promises||[]).push(new Promise(function(e){t.style("display","none");var r=parseInt(t.node().style.fontSize,10);var n={fontSize:r};p(o[2],n,function(n,o,u){s.selectAll("svg."+c).remove();s.selectAll("g."+c+"-group").remove();var h=n&&n.select("svg");if(!h||!h.node()){f();e();return}var p=s.append("g").classed(c+"-group",true).attr({"pointer-events":"none","data-unformatted":i,"data-math":"Y"});p.node().appendChild(h.node());if(o&&o.node()){h.node().insertBefore(o.node().cloneNode(true),h.node().firstChild)}h.attr({class:c,height:u.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var d=t.node().style.fill||"black";h.select("g").attr({fill:d,stroke:d});var v=l(h,"width"),g=l(h,"height"),m=+t.attr("x")-v*{start:0,middle:.5,end:1}[t.attr("text-anchor")||"start"],y=r||l(t,"height"),x=-y/4;if(c[0]==="y"){p.attr({transform:"rotate("+[-90,+t.attr("x"),+t.attr("y")]+") translate("+[-v/2,x-g/2]+")"});h.attr({x:+t.attr("x"),y:+t.attr("y")})}else if(c[0]==="l"){h.attr({x:t.attr("x"),y:x-g/2})}else if(c[0]==="a"){h.attr({x:0,y:x})}else{h.attr({x:m,y:+t.attr("y")+x-g/2})}if(a)a.call(t,p);e(p)})}))}else f();return t};var c=/(<|&lt;|&#60;)/g;var f=/(>|&gt;|&#62;)/g;function h(t){return t.replace(c,"\\lt ").replace(f,"\\gt ")}function p(t,e,r){var i="math-output-"+a.randstr({},64);var o=n.select("body").append("div").attr({id:i}).style({visibility:"hidden",position:"absolute"}).style({"font-size":e.fontSize+"px"}).text(h(t));MathJax.Hub.Queue(["Typeset",MathJax.Hub,o.node()],function(){var e=n.select("body").select("#MathJax_SVG_glyphs");if(o.select(".MathJax_SVG").empty()||!o.select("svg").node()){a.log("There was an error in the tex syntax.",t);r()}else{var i=o.select("svg").node().getBoundingClientRect();r(o.select(".MathJax_SVG"),e,i)}o.remove()})}var d={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"};var v={sub:"0.3em",sup:"-0.6em"};var g={sub:"-0.21em",sup:"0.42em"};var m="\u200b";var y=["http:","https:","mailto:","",undefined,":"];var x=new RegExp("</?("+Object.keys(d).join("|")+")( [^>]*)?/?>","g");var b=Object.keys(o.entityToUnicode).map(function(t){return{regExp:new RegExp("&"+t+";","g"),sub:o.entityToUnicode[t]}});var _=/(\r\n?|\n)/g;var w=/(<[^<>]*>)/;var k=/<(\/?)([^ >]*)(\s+(.*))?>/i;var M=/<br(\s+.*)?>/i;var A=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i;var T=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i;var S=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i;var E=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function C(t,e){if(!t)return null;var r=t.match(e);return r&&(r[3]||r[4])}var L=/(^|;)\s*color:/;r.plainText=function(t){return(t||"").replace(x," ")};function I(t,e){if(!t)return"";for(var r=0;r<e.length;r++){var n=e[r];t=t.replace(n.regExp,n.sub)}return t}function z(t){return I(t,b)}function P(t,e){e=z(e).replace(_," ");var r=false;var o=[];var l;var u=-1;function c(){u++;var e=document.createElementNS(i.svg,"tspan");n.select(e).attr({class:"line",dy:u*s+"em"});t.appendChild(e);l=e;var r=o;o=[{node:e}];if(r.length>1){for(var a=1;a<r.length;a++){f(r[a])}}}function f(t){var e=t.type;var r={};var a;if(e==="a"){a="a";var s=t.target;var u=t.href;var c=t.popup;if(u){r={"xlink:xlink:show":s==="_blank"||s.charAt(0)!=="_"?"new":"replace",target:s,"xlink:xlink:href":u};if(c){r.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+c+'");return false;'}}}else a="tspan";if(t.style)r.style=t.style;var f=document.createElementNS(i.svg,a);if(e==="sup"||e==="sub"){h(l,m);l.appendChild(f);var p=document.createElementNS(i.svg,"tspan");h(p,m);n.select(p).attr("dy",g[e]);r.dy=v[e];l.appendChild(f);l.appendChild(p)}else{l.appendChild(f)}n.select(f).attr(r);l=t.node=f;o.push(t)}function h(t,e){t.appendChild(document.createTextNode(e))}function p(t){if(o.length===1){a.log("Ignoring unexpected end tag </"+t+">.",e);return}var r=o.pop();if(t!==r.type){a.log("Start tag <"+r.type+"> doesnt match end tag <"+t+">. Pretending it did match.",e)}l=o[o.length-1].node}var x=M.test(e);if(x)c();else{l=t;o=[{node:t}]}var b=e.split(w);for(var I=0;I<b.length;I++){var P=b[I];var O=P.match(k);var D=O&&O[2].toLowerCase();var R=d[D];if(D==="br"){c()}else if(R===undefined){h(l,P)}else{if(O[1]){p(D)}else{var B=O[4];var F={type:D};var N=C(B,A);if(N){N=N.replace(L,"$1 fill:");if(R)N+=";"+R}else if(R)N=R;if(N)F.style=N;if(D==="a"){r=true;var j=C(B,T);if(j){var V=document.createElement("a");V.href=j;if(y.indexOf(V.protocol)!==-1){F.href=encodeURI(decodeURI(j));F.target=C(B,S)||"_blank";F.popup=C(B,E)}}}f(F)}}}return r}r.lineCount=function t(e){return e.selectAll("tspan.line").size()||1};r.positionText=function t(e,r,a){return e.each(function(){var t=n.select(this);function e(e,r){if(r===undefined){r=t.attr(e);if(r===null){t.attr(e,0);r=0}}else t.attr(e,r);return r}var i=e("x",r);var o=e("y",a);if(this.nodeName==="text"){t.selectAll("tspan.line").attr({x:i,y:o})}})};function O(t,e,r){var n=r.horizontalAlign,a=r.verticalAlign||"top",i=t.node().getBoundingClientRect(),o=e.node().getBoundingClientRect(),s,l,u;if(a==="bottom"){l=function(){return i.bottom-s.height}}else if(a==="middle"){l=function(){return i.top+(i.height-s.height)/2}}else{l=function(){return i.top}}if(n==="right"){u=function(){return i.right-s.width}}else if(n==="center"){u=function(){return i.left+(i.width-s.width)/2}}else{u=function(){return i.left}}return function(){s=this.node().getBoundingClientRect();this.style({top:l()-o.top+"px",left:u()-o.left+"px","z-index":1e3});return this}}r.makeEditable=function(t,e){var r=e.gd;var a=e.delegate;var i=n.dispatch("edit","input","cancel");var o=a||t;t.style({"pointer-events":a?"none":"all"});if(t.size()!==1)throw new Error("boo");function s(){u();t.style({opacity:0});var e=o.attr("class"),r;if(e)r="."+e.split(" ")[0]+"-math-group";else r="[class*=-math-group]";if(r){n.select(t.node().parentNode).select(r).style({opacity:0})}}function l(t){var e=t.node();var r=document.createRange();r.selectNodeContents(e);var n=window.getSelection();n.removeAllRanges();n.addRange(r);e.focus()}function u(){var a=n.select(r);var o=a.select(".svg-container");var s=o.append("div");var u=t.node().style;var c=parseFloat(u.fontSize||12);var f=e.text;if(f===undefined)f=t.attr("data-unformatted");s.classed("plugin-editable editable",true).style({position:"absolute","font-family":u.fontFamily||"Arial","font-size":c,color:e.fill||u.fill||"black",opacity:1,"background-color":e.background||"transparent",outline:"#ffffff33 1px solid",margin:[-c/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:true}).text(f).call(O(t,o,e)).on("blur",function(){r._editing=false;t.text(this.textContent).style({opacity:1});var e=n.select(this).attr("class"),a;if(e)a="."+e.split(" ")[0]+"-math-group";else a="[class*=-math-group]";if(a){n.select(t.node().parentNode).select(a).style({opacity:0})}var o=this.textContent;n.select(this).transition().duration(0).remove();n.select(document).on("mouseup",null);i.edit.call(t,o)}).on("focus",function(){var t=this;r._editing=true;n.select(document).on("mouseup",function(){if(n.event.target===t)return false;if(document.activeElement===s.node())s.node().blur()})}).on("keyup",function(){if(n.event.which===27){r._editing=false;t.style({opacity:1});n.select(this).style({opacity:0}).on("blur",function(){return false}).transition().remove();i.cancel.call(t,this.textContent)}else{i.input.call(t,this.textContent);n.select(this).call(O(t,o,e))}}).on("keydown",function(){if(n.event.which===13)this.blur()}).call(l)}if(e.immediate)s();else o.on("click",s);return n.rebind(t,i,"on")}},{"../constants/alignment":656,"../constants/string_mappings":662,"../constants/xmlns_namespaces":663,"../lib":684,d3:147}],709:[function(t,e,r){"use strict";var n={};r.throttle=function t(e,r,i){var o=n[e];var s=Date.now();if(!o){for(var l in n){if(n[l].ts<s-6e4){delete n[l]}}o=n[e]={ts:0,timer:null}}a(o);function u(){i();o.ts=Date.now();if(o.onDone){o.onDone();o.onDone=null}}if(s>o.ts+r){u();return}o.timer=setTimeout(function(){u();o.timer=null},r)};r.done=function(t){var e=n[t];if(!e||!e.timer)return Promise.resolve();return new Promise(function(t){var r=e.onDone;e.onDone=function n(){if(r)r();t();e.onDone=null}})};r.clear=function(t){if(t){a(n[t]);delete n[t]}else{for(var e in n)r.clear(e)}};function a(t){if(t&&t.timer!==null){clearTimeout(t.timer);t.timer=null}}},{}],710:[function(t,e,r){"use strict";var n=t("fast-isnumeric");e.exports=function t(e,r){if(e>0)return Math.log(e)/Math.LN10;var a=Math.log(Math.min(r[0],r[1]))/Math.LN10;if(!n(a))a=Math.log(Math.max(r[0],r[1]))/Math.LN10-6;return a}},{"fast-isnumeric":214}],711:[function(t,e,r){"use strict";var n=e.exports={};var a=t("../plots/geo/constants").locationmodeToLayer;var i=t("topojson-client").feature;n.getTopojsonName=function(t){return[t.scope.replace(/ /g,"-"),"_",t.resolution.toString(),"m"].join("")};n.getTopojsonPath=function(t,e){return t+e+".json"};n.getTopojsonFeatures=function(t,e){var r=a[t.locationmode],n=e.objects[r];return i(e,n).features}},{"../plots/geo/constants":760,"topojson-client":502}],712:[function(t,e,r){"use strict";e.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],713:[function(t,e,r){"use strict";e.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],714:[function(t,e,r){"use strict";var n=t("../registry");e.exports=function t(e){var r=n.layoutArrayContainers,a=n.layoutArrayRegexes,i=e.split("[")[0],o,s;for(var l=0;l<a.length;l++){s=e.match(a[l]);if(s&&s.index===0){o=s[0];break}}if(!o)o=r[r.indexOf(i)];if(!o)return false;var u=e.substr(o.length);if(!u)return{array:o,index:"",property:""};s=u.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/);if(!s)return false;return{array:o,index:Number(s[1]),property:s[3]||""}}},{"../registry":817}],715:[function(t,e,r){"use strict";var n=t("../lib");var a=n.extendFlat;var i=n.isPlainObject;var o={valType:"flaglist",extras:["none"],flags:["calc","calcIfAutorange","clearAxisTypes","plot","style","colorbars"]};var s={valType:"flaglist",extras:["none"],flags:["calc","calcIfAutorange","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw"]};var l=o.flags.slice().concat(["clearCalc","fullReplot"]);var u=s.flags.slice().concat("layoutReplot");e.exports={traces:o,layout:s,traceFlags:function(){return c(l)},layoutFlags:function(){return c(u)},update:function(t,e){var r=e.editType;if(r&&r!=="none"){var n=r.split("+");for(var a=0;a<n.length;a++){t[n[a]]=true}}},overrideAll:f};function c(t){var e={};for(var r=0;r<t.length;r++)e[t[r]]=false;return e}function f(t,e,r){var n=a({},t);for(var o in n){var s=n[o];if(i(s)){n[o]=h(s,e,r,o)}}if(r==="from-root")n.editType=e;return n}function h(t,e,r,n){if(t.valType){var i=a({},t);i.editType=e;if(Array.isArray(t.items)){i.items=new Array(t.items.length);for(var o=0;o<t.items.length;o++){i.items[o]=h(t.items[o],e,"from-root")}}return i}else{return f(t,e,n.charAt(0)==="_"?"nested":"from-root")}}},{"../lib":684}],716:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("gl-mat4/fromQuat");var i=t("../registry");var o=t("../lib");var s=t("../plots/plots");var l=t("../plots/cartesian/axis_ids");var u=l.cleanId;var c=l.getFromTrace;var f=t("../components/color");r.clearPromiseQueue=function(t){if(Array.isArray(t._promises)&&t._promises.length>0){o.log("Clearing previous rejected promises from queue.")}t._promises=[]};r.cleanLayout=function(t){var e,r;if(!t)t={};if(t.xaxis1){if(!t.xaxis)t.xaxis=t.xaxis1;delete t.xaxis1}if(t.yaxis1){if(!t.yaxis)t.yaxis=t.yaxis1;delete t.yaxis1}if(t.scene1){if(!t.scene)t.scene=t.scene1;delete t.scene1}var n=(s.subplotsRegistry.cartesian||{}).attrRegex;var i=(s.subplotsRegistry.gl3d||{}).attrRegex;var l=Object.keys(t);for(e=0;e<l.length;e++){var c=l[e];if(n&&n.test(c)){var p=t[c];if(p.anchor&&p.anchor!=="free"){p.anchor=u(p.anchor)}if(p.overlaying)p.overlaying=u(p.overlaying);if(!p.type){if(p.isdate)p.type="date";else if(p.islog)p.type="log";else if(p.isdate===false&&p.islog===false)p.type="linear"}if(p.autorange==="withzero"||p.autorange==="tozero"){p.autorange=true;p.rangemode="tozero"}delete p.islog;delete p.isdate;delete p.categories;if(g(p,"domain"))delete p.domain;if(p.autotick!==undefined){if(p.tickmode===undefined){p.tickmode=p.autotick?"auto":"linear"}delete p.autotick}}else if(i&&i.test(c)){var d=t[c];var v=d.cameraposition;if(Array.isArray(v)&&v[0].length===4){var m=v[0],y=v[1],x=v[2],b=a([],m),_=[];for(r=0;r<3;++r){_[r]=y[r]+x*b[2+4*r]}d.camera={eye:{x:_[0],y:_[1],z:_[2]},center:{x:y[0],y:y[1],z:y[2]},up:{x:b[1],y:b[5],z:b[9]}};delete d.cameraposition}}}var w=Array.isArray(t.annotations)?t.annotations.length:0;for(e=0;e<w;e++){var k=t.annotations[e];if(!o.isPlainObject(k))continue;if(k.ref){if(k.ref==="paper"){k.xref="paper";k.yref="paper"}else if(k.ref==="data"){k.xref="x";k.yref="y"}delete k.ref}h(k,"xref");h(k,"yref")}var M=Array.isArray(t.shapes)?t.shapes.length:0;for(e=0;e<M;e++){var A=t.shapes[e];if(!o.isPlainObject(A))continue;h(A,"xref");h(A,"yref")}var T=t.legend;if(T){if(T.x>3){T.x=1.02;T.xanchor="left"}else if(T.x<-2){T.x=-.02;T.xanchor="right"}if(T.y>3){T.y=1.02;T.yanchor="bottom"}else if(T.y<-2){T.y=-.02;T.yanchor="top"}}if(t.dragmode==="rotate")t.dragmode="orbit";f.clean(t);return t};function h(t,e){var r=t[e],n=e.charAt(0);if(r&&r!=="paper"){t[e]=u(r,n)}}r.cleanData=function(t){for(var e=0;e<t.length;e++){var n=t[e];var a;if(n.type==="histogramy"&&"xbins"in n&&!("ybins"in n)){n.ybins=n.xbins;delete n.xbins}if(n.error_y&&"opacity"in n.error_y){var l=f.defaults,c=n.error_y.color||(i.traceIs(n,"bar")?f.defaultLine:l[e%l.length]);n.error_y.color=f.addOpacity(f.rgb(c),f.opacity(c)*n.error_y.opacity);delete n.error_y.opacity}if("bardir"in n){if(n.bardir==="h"&&(i.traceIs(n,"bar")||n.type.substr(0,9)==="histogram")){n.orientation="h";r.swapXYData(n)}delete n.bardir}if(n.type==="histogramy")r.swapXYData(n);if(n.type==="histogramx"||n.type==="histogramy"){n.type="histogram"}if("scl"in n){n.colorscale=n.scl;delete n.scl}if("reversescl"in n){n.reversescale=n.reversescl;delete n.reversescl}if(n.xaxis)n.xaxis=u(n.xaxis,"x");if(n.yaxis)n.yaxis=u(n.yaxis,"y");if(i.traceIs(n,"gl3d")&&n.scene){n.scene=s.subplotsRegistry.gl3d.cleanId(n.scene)}if(!i.traceIs(n,"pie")&&!i.traceIs(n,"bar")){if(Array.isArray(n.textposition)){for(a=0;a<n.textposition.length;a++){n.textposition[a]=v(n.textposition[a])}}else if(n.textposition){n.textposition=v(n.textposition)}}var h=i.getModule(n);if(h&&h.colorbar){var m=h.colorbar.container;var y=m?n[m]:n;if(y&&y.colorscale){if(y.colorscale==="YIGnBu")y.colorscale="YlGnBu";if(y.colorscale==="YIOrRd")y.colorscale="YlOrRd"}}if(n.type==="surface"&&o.isPlainObject(n.contours)){var x=["x","y","z"];for(a=0;a<x.length;a++){var b=n.contours[x[a]];if(!o.isPlainObject(b))continue;if(b.highlightColor){b.highlightcolor=b.highlightColor;delete b.highlightColor}if(b.highlightWidth){b.highlightwidth=b.highlightWidth;delete b.highlightWidth}}}if(n.type==="candlestick"||n.type==="ohlc"){var _=(n.increasing||{}).showlegend!==false;var w=(n.decreasing||{}).showlegend!==false;var k=p(n.increasing);var M=p(n.decreasing);if(k!==false&&M!==false){var A=d(k,M,_,w);if(A)n.name=A}else if((k||M)&&!n.name){n.name=k||M}}if(Array.isArray(n.transforms)){var T=n.transforms;for(a=0;a<T.length;a++){var S=T[a];if(!o.isPlainObject(S))continue;switch(S.type){case"filter":if(S.filtersrc){S.target=S.filtersrc;delete S.filtersrc}if(S.calendar){if(!S.valuecalendar){S.valuecalendar=S.calendar}delete S.calendar}break;case"groupby":S.styles=S.styles||S.style;if(S.styles&&!Array.isArray(S.styles)){var E=S.styles;var C=Object.keys(E);S.styles=[];for(var L=0;L<C.length;L++){S.styles.push({target:C[L],value:E[C[L]]})}}break}}}if(g(n,"line"))delete n.line;if("marker"in n){if(g(n.marker,"line"))delete n.marker.line;if(g(n,"marker"))delete n.marker}f.clean(n)}};function p(t){if(!o.isPlainObject(t))return false;var e=t.name;delete t.name;delete t.showlegend;return(typeof e==="string"||typeof e==="number")&&String(e)}function d(t,e,r,n){if(r&&!n)return t;if(n&&!r)return e;if(!t.trim())return e;if(!e.trim())return t;var a=Math.min(t.length,e.length);var i;for(i=0;i<a;i++){if(t.charAt(i)!==e.charAt(i))break}var o=t.substr(0,i);return o.trim()}function v(t){var e="middle",r="center";if(t.indexOf("top")!==-1)e="top";else if(t.indexOf("bottom")!==-1)e="bottom";if(t.indexOf("left")!==-1)r="left";else if(t.indexOf("right")!==-1)r="right";return e+" "+r}function g(t,e){return e in t&&typeof t[e]==="object"&&Object.keys(t[e]).length===0}r.swapXYData=function(t){var e;o.swapAttrs(t,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]);if(Array.isArray(t.z)&&Array.isArray(t.z[0])){if(t.transpose)delete t.transpose;else t.transpose=true}if(t.error_x&&t.error_y){var r=t.error_y,n="copy_ystyle"in r?r.copy_ystyle:!(r.color||r.thickness||r.width);o.swapAttrs(t,["error_?.copy_ystyle"]);if(n){o.swapAttrs(t,["error_?.color","error_?.thickness","error_?.width"])}}if(typeof t.hoverinfo==="string"){var a=t.hoverinfo.split("+");for(e=0;e<a.length;e++){if(a[e]==="x")a[e]="y";else if(a[e]==="y")a[e]="x"}t.hoverinfo=a.join("+")}};r.coerceTraceIndices=function(t,e){if(n(e)){return[e]}else if(!Array.isArray(e)||!e.length){return t.data.map(function(t,e){return e})}return e};r.manageArrayContainers=function(t,e,r){var a=t.obj,i=t.parts,s=i.length,l=i[s-1];var u=n(l);if(u&&e===null){var c=i.slice(0,s-1).join("."),f=o.nestedProperty(a,c).get();f.splice(l,1)}else if(u&&t.get()===undefined){if(t.get()===undefined)r[t.astr]=null;t.set(e)}else{t.set(e)}};var m=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function y(t){var e=t.search(m);if(e>0)return t.substr(0,e)}r.hasParent=function(t,e){var r=y(e);while(r){if(r in t)return true;r=y(r)}return false};var x=["x","y","z"];r.clearAxisTypes=function(t,e,r){for(var n=0;n<e.length;n++){var a=t._fullData[n];for(var i=0;i<3;i++){var s=c(t,a,x[i]);if(s&&s.type!=="log"){var l=s._name;var u=s._id.substr(1);if(u.substr(0,5)==="scene"){if(r[u]!==undefined)continue;l=u+"."+l}var f=l+".type";if(r[l]===undefined&&r[f]===undefined){o.nestedProperty(t.layout,f).set(null)}}}}}},{"../components/color":558,"../lib":684,"../plots/cartesian/axis_ids":735,"../plots/plots":795,"../registry":817,"fast-isnumeric":214,"gl-mat4/fromQuat":251}],717:[function(t,e,r){"use strict";var n=t("./plot_api");r.plot=n.plot;r.newPlot=n.newPlot;r.restyle=n.restyle;r.relayout=n.relayout;r.redraw=n.redraw;r.update=n.update;r.react=n.react;r.extendTraces=n.extendTraces;r.prependTraces=n.prependTraces;r.addTraces=n.addTraces;r.deleteTraces=n.deleteTraces;r.moveTraces=n.moveTraces;r.purge=n.purge;r.addFrames=n.addFrames;r.deleteFrames=n.deleteFrames;r.animate=n.animate;r.setPlotConfig=n.setPlotConfig;r.toImage=t("./to_image");r.validate=t("./validate");r.downloadImage=t("../snapshot/download");var a=t("./template_api");r.makeTemplate=a.makeTemplate;r.validateTemplate=a.validateTemplate},{"../snapshot/download":819,"./plot_api":719,"./template_api":724,"./to_image":725,"./validate":726}],718:[function(t,e,r){"use strict";var n=t("../lib/nested_property");var a=t("../lib/is_plain_object");var i=t("../lib/noop");var o=t("../lib/loggers");var s=t("../lib/search").sorterAsc;var l=t("../registry");r.containerArrayMatch=t("./container_array_match");var u=r.isAddVal=function t(e){return e==="add"||a(e)};var c=r.isRemoveVal=function t(e){return e===null||e==="remove"};r.applyContainerArrayChanges=function t(e,r,a,f){var h=r.astr,p=l.getComponentMethod(h,"supplyLayoutDefaults"),d=l.getComponentMethod(h,"draw"),v=l.getComponentMethod(h,"drawOne"),g=f.replot||f.recalc||p===i||d===i,m=e.layout,y=e._fullLayout;if(a[""]){if(Object.keys(a).length>1){o.warn("Full array edits are incompatible with other edits",h)}var x=a[""][""];if(c(x))r.set(null);else if(Array.isArray(x))r.set(x);else{o.warn("Unrecognized full array edit value",h,x);return true}if(g)return false;p(m,y);d(e);return true}var b=Object.keys(a).map(Number).sort(s),_=r.get(),w=_||[],k=n(y,h).get();var M=[],A=-1,T=w.length,S,E,C,L,I,z,P;for(S=0;S<b.length;S++){C=b[S];L=a[C];I=Object.keys(L);z=L[""],P=u(z);if(C<0||C>w.length-(P?0:1)){o.warn("index out of range",h,C);continue}if(z!==undefined){if(I.length>1){o.warn("Insertion & removal are incompatible with edits to the same index.",h,C)}if(c(z)){M.push(C)}else if(P){if(z==="add")z={};w.splice(C,0,z);if(k)k.splice(C,0,{})}else{o.warn("Unrecognized full object edit value",h,C,z)}if(A===-1)A=C}else{for(E=0;E<I.length;E++){n(w[C],I[E]).set(L[I[E]])}}}for(S=M.length-1;S>=0;S--){w.splice(M[S],1);if(k)k.splice(M[S],1)}if(!w.length)r.set(null);else if(!_)r.set(w);if(g)return false;p(m,y);if(v!==i){var O;if(A===-1){O=b}else{T=Math.max(w.length,T);O=[];for(S=0;S<b.length;S++){C=b[S];if(C>=A)break;O.push(C)}for(S=A;S<T;S++){O.push(S)}}for(S=0;S<O.length;S++){v(e,O[S])}}else d(e);return true}},{"../lib/is_plain_object":686,"../lib/loggers":689,"../lib/nested_property":692,"../lib/noop":693,"../lib/search":703,"../registry":817,"./container_array_match":714}],719:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("has-hover");var o=t("../lib");var s=t("../lib/events");var l=t("../lib/queue");var u=t("../registry");var c=t("./plot_schema");var f=t("../plots/plots");var h=t("../plots/polar/legacy");var p=t("../plots/cartesian/axes");var d=t("../components/drawing");var v=t("../components/color");var g=t("../components/colorbar/connect");var m=t("../plots/cartesian/graph_interact").initInteractions;var y=t("../constants/xmlns_namespaces");var x=t("../lib/svg_text_utils");var b=t("./plot_config");var _=t("./manage_arrays");var w=t("./helpers");var k=t("./subroutines");var M=t("./edit_types");var A=t("../plots/cartesian/constants").AX_NAME_PATTERN;var T=0;var S=5;r.plot=function(t,e,a,i){var l;t=o.getGraphDiv(t);s.init(t);if(o.isPlainObject(e)){var c=e;e=c.data;a=c.layout;i=c.config;l=c.frames}var h=s.triggerHandler(t,"plotly_beforeplot",[e,a,i]);if(h===false)return Promise.reject();if(!e&&!a&&!o.isPlotDiv(t)){o.warn("Calling Plotly.plot as if redrawing "+"but this container doesn't yet have a plot.",t)}function v(){if(l){return r.addFrames(t,l)}}I(t,i);if(!a)a={};n.select(t).classed("js-plotly-plot",true);d.makeTester();delete d.baseUrl;if(!Array.isArray(t._promises))t._promises=[];var y=(t.data||[]).length===0&&Array.isArray(e);if(Array.isArray(e)){w.cleanData(e);if(y)t.data=e;else t.data.push.apply(t.data,e);t.empty=false}if(!t.layout||y)t.layout=w.cleanLayout(a);if(t._dragging&&!t._transitioning){t._replotPending=true;return Promise.reject()}else{t._replotPending=false}f.supplyDefaults(t);var x=t._fullLayout;var b=x._has("cartesian");if(!x._has("polar")&&e&&e[0]&&e[0].r){o.log("Legacy polar charts are deprecated!");return z(t,e,a)}x._replotting=true;if(y)tt(t);if(t.framework!==tt){t.framework=tt;tt(t)}d.initGradients(t);if(y)p.saveShowSpikeInitial(t);var _=!t.calcdata||t.calcdata.length!==(t._fullData||[]).length;if(_)f.doCalcdata(t);for(var M=0;M<t.calcdata.length;M++){t.calcdata[M][0].trace=t._fullData[M]}var A=JSON.stringify(x._size);function T(){var e=x._basePlotModules;for(var r=0;r<e.length;r++){if(e[r].drawFramework){e[r].drawFramework(t)}}if(!x._glcanvas&&x._has("gl")){x._glcanvas=x._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:true,pick:false},{key:"focusLayer",context:false,pick:false},{key:"pickLayer",context:false,pick:true}],function(t){return t.key});x._glcanvas.enter().append("canvas").attr("class",function(t){return"gl-canvas gl-canvas-"+t.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"visible","pointer-events":"none"})}if(x._glcanvas){x._glcanvas.attr("width",x.width).attr("height",x.height)}return f.previousPromises(t)}function S(){var e=t.calcdata;var r,n,a;f.clearAutoMarginIds(t);k.drawMarginPushers(t);p.allowAutoMargin(t);for(r=0;r<e.length;r++){n=e[r];a=n[0].trace;var i=a._module.colorbar;if(a.visible!==true||!i){f.autoMargin(t,"cb"+a.uid)}else g(t,n,i)}f.doAutoMargin(t);return f.previousPromises(t)}function C(){if(JSON.stringify(x._size)===A)return;return o.syncOrAsync([S,k.layoutStyles],t)}function L(){if(!_){P();return}var e=x._subplots.cartesian;var r=x._modules;var n=[];var a,i,s;for(s=0;s<r.length;s++){o.pushUnique(n,r[s].setPositions)}if(n.length){for(i=0;i<e.length;i++){a=x._plots[e[i]];for(s=0;s<n.length;s++){n[s](t,a)}}}u.getComponentMethod("errorbars","calc")(t);return o.syncOrAsync([u.getComponentMethod("shapes","calcAutorange"),u.getComponentMethod("annotations","calcAutorange"),P,u.getComponentMethod("rangeslider","calcAutorange")],t)}function P(){if(t._transitioning)return;k.doAutoRangeAndConstraints(t);if(y)p.saveRangeInitial(t)}function O(){return p.doTicks(t,y?"":"redraw")}var D=[f.previousPromises,v,T,S,C];if(b)D.push(L);D.push(k.layoutStyles);if(b)D.push(O);D.push(k.drawData,k.finalDraw,m,f.addLinks,f.rehover,f.doAutoMargin,f.previousPromises);var R=o.syncOrAsync(D,t);if(!R||!R.then)R=Promise.resolve();return R.then(function(){E(t);return t})};function E(t){var e=t._fullLayout;if(e._redrawFromAutoMarginCount){e._redrawFromAutoMarginCount--}else{t.emit("plotly_afterplot")}}r.setPlotConfig=function t(e){return o.extendFlat(b,e)};function C(t,e){try{t._fullLayout._paper.style("background",e)}catch(t){o.error(t)}}function L(t,e){var r=v.combine(e,"white");C(t,r)}function I(t,e){if(!t._context)t._context=o.extendDeep({},b);var r=t._context;var n,a,s;if(e){a=Object.keys(e);for(n=0;n<a.length;n++){s=a[n];if(s==="editable"||s==="edits")continue;if(s in r){if(s==="setBackground"&&e[s]==="opaque"){r[s]=L}else{r[s]=e[s]}}}if(e.plot3dPixelRatio&&!r.plotGlPixelRatio){r.plotGlPixelRatio=r.plot3dPixelRatio}var l=e.editable;if(l!==undefined){r.editable=l;a=Object.keys(r.edits);for(n=0;n<a.length;n++){r.edits[a[n]]=l}}if(e.edits){a=Object.keys(e.edits);for(n=0;n<a.length;n++){s=a[n];if(s in r.edits){r.edits[s]=e.edits[s]}}}}if(r.staticPlot){r.editable=false;r.edits={};r.autosizable=false;r.scrollZoom=false;r.doubleClick=false;r.showTips=false;r.showLink=false;r.displayModeBar=false}if(r.displayModeBar==="hover"&&!i){r.displayModeBar=true}if(r.setBackground==="transparent"||typeof r.setBackground!=="function"){r.setBackground=C}}function z(t,e,r){var a=n.select(t).selectAll(".plot-container").data([0]);a.enter().insert("div",":first-child").classed("plot-container plotly",true);var i=a.selectAll(".svg-container").data([0]);i.enter().append("div").classed("svg-container",true).style("position","relative");i.html("");if(e)t.data=e;if(r)t.layout=r;h.manager.fillLayout(t);i.style({width:t._fullLayout.width+"px",height:t._fullLayout.height+"px"});t.framework=h.manager.framework(t);t.framework({data:t.data,layout:t.layout},i.node());t.framework.setUndoPoint();var s=t.framework.svg();var l=1;var u=t._fullLayout.title;if(u===""||!u)l=0;var c=function(){this.call(x.convertToTspans,t)};var p=s.select(".title-group text").call(c);if(t._context.edits.titleText){var d=o._(t,"Click to enter Plot title");if(!u||u===d){l=.2;p.attr({"data-unformatted":d}).text(d).style({opacity:l}).on("mouseover.opacity",function(){n.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){n.select(this).transition().duration(1e3).style("opacity",0)})}var v=function(){this.call(x.makeEditable,{gd:t}).on("edit",function(e){t.framework({layout:{title:e}});this.text(e).call(c);this.call(v)}).on("cancel",function(){var t=this.attr("data-unformatted");this.text(t).call(c)})};p.call(v)}t._context.setBackground(t,t._fullLayout.paper_bgcolor);f.addLinks(t);return Promise.resolve()}r.redraw=function(t){t=o.getGraphDiv(t);if(!o.isPlotDiv(t)){throw new Error("This element is not a Plotly plot: "+t)}w.cleanData(t.data);w.cleanLayout(t.layout);t.calcdata=undefined;return r.plot(t).then(function(){t.emit("plotly_redraw");return t})};r.newPlot=function(t,e,n,a){t=o.getGraphDiv(t);f.cleanPlot([],{},t._fullData||[],t._fullLayout||{},t.calcdata||[]);f.purge(t);return r.plot(t,e,n,a)};function P(t,e){var r=e+1,n=[],a,i;for(a=0;a<t.length;a++){i=t[a];if(i<0){n.push(r+i)}else{n.push(i)}}return n}function O(t,e,r){var n,a;for(n=0;n<e.length;n++){a=e[n];if(a!==parseInt(a,10)){throw new Error("all values in "+r+" must be integers")}if(a>=t.data.length||a<-t.data.length){throw new Error(r+" must be valid indices for gd.data.")}if(e.indexOf(a,n+1)>-1||a>=0&&e.indexOf(-t.data.length+a)>-1||a<0&&e.indexOf(t.data.length+a)>-1){throw new Error("each index in "+r+" must be unique.")}}}function D(t,e,r){if(!Array.isArray(t.data)){throw new Error("gd.data must be an array.")}if(typeof e==="undefined"){throw new Error("currentIndices is a required argument.")}else if(!Array.isArray(e)){e=[e]}O(t,e,"currentIndices");if(typeof r!=="undefined"&&!Array.isArray(r)){r=[r]}if(typeof r!=="undefined"){O(t,r,"newIndices")}if(typeof r!=="undefined"&&e.length!==r.length){throw new Error("current and new indices must be of equal length.")}}function R(t,e,r){var n,a;if(!Array.isArray(t.data)){throw new Error("gd.data must be an array.")}if(typeof e==="undefined"){throw new Error("traces must be defined.")}if(!Array.isArray(e)){e=[e]}for(n=0;n<e.length;n++){a=e[n];if(typeof a!=="object"||(Array.isArray(a)||a===null)){throw new Error("all values in traces array must be non-array objects")}}if(typeof r!=="undefined"&&!Array.isArray(r)){r=[r]}if(typeof r!=="undefined"&&r.length!==e.length){throw new Error("if indices is specified, traces.length must equal indices.length")}}function B(t,e,r,n){var a=o.isPlainObject(n);if(!Array.isArray(t.data)){throw new Error("gd.data must be an array")}if(!o.isPlainObject(e)){throw new Error("update must be a key:value object")}if(typeof r==="undefined"){throw new Error("indices must be an integer or array of integers")}O(t,r,"indices");for(var i in e){if(!Array.isArray(e[i])||e[i].length!==r.length){throw new Error("attribute "+i+" must be an array of length equal to indices array length")}if(a&&(!(i in n)||!Array.isArray(n[i])||n[i].length!==e[i].length)){throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 "+"corrispondence with the keys and number of traces in the update object")}}}function F(t,e,r,n){var i=o.isPlainObject(n),s=[];var l,u,c,f,h;if(!Array.isArray(r))r=[r];r=P(r,t.data.length-1);for(var p in e){for(var d=0;d<r.length;d++){l=t.data[r[d]];c=o.nestedProperty(l,p);u=c.get();f=e[p][d];if(!o.isArrayOrTypedArray(f)){throw new Error("attribute: "+p+" index: "+d+" must be an array")}if(!o.isArrayOrTypedArray(u)){throw new Error("cannot extend missing or non-array attribute: "+p)}if(u.constructor!==f.constructor){throw new Error("cannot extend array with an array of a different type: "+p)}h=i?n[p][d]:n;if(!a(h))h=-1;s.push({prop:c,target:u,insert:f,maxp:Math.floor(h)})}}return s}function N(t,e,r,n,a){B(t,e,r,n);var i=F(t,e,r,n);var o={};var s={};for(var l=0;l<i.length;l++){var u=i[l].prop;var c=i[l].maxp;var f=a(i[l].target,i[l].insert,c);u.set(f[0]);if(!Array.isArray(o[u.astr]))o[u.astr]=[];o[u.astr].push(f[1]);if(!Array.isArray(s[u.astr]))s[u.astr]=[];s[u.astr].push(i[l].target.length)}return{update:o,maxPoints:s}}function j(t,e){var r=new t.constructor(t.length+e.length);r.set(t);r.set(e,t.length);return r}r.extendTraces=function t(e,n,a,i){e=o.getGraphDiv(e);function s(t,e,r){var n,a;if(o.isTypedArray(t)){if(r<0){var i=new t.constructor(0);var s=j(t,e);if(r<0){n=s;a=i}else{n=i;a=s}}else{n=new t.constructor(r);a=new t.constructor(t.length+e.length-r);if(r===e.length){n.set(e);a.set(t)}else if(r<e.length){var l=e.length-r;n.set(e.subarray(l));a.set(t);a.set(e.subarray(0,l),t.length)}else{var u=r-e.length;var c=t.length-u;n.set(t.subarray(c));n.set(e,u);a.set(t.subarray(0,c))}}}else{n=t.concat(e);a=r>=0&&r<n.length?n.splice(0,n.length-r):[]}return[n,a]}var u=N(e,n,a,i,s);var c=r.redraw(e);var f=[e,u.update,a,u.maxPoints];l.add(e,r.prependTraces,f,t,arguments);return c};r.prependTraces=function t(e,n,a,i){e=o.getGraphDiv(e);function s(t,e,r){var n,a;if(o.isTypedArray(t)){if(r<=0){var i=new t.constructor(0);var s=j(e,t);if(r<0){n=s;a=i}else{n=i;a=s}}else{n=new t.constructor(r);a=new t.constructor(t.length+e.length-r);if(r===e.length){n.set(e);a.set(t)}else if(r<e.length){var l=e.length-r;n.set(e.subarray(0,l));a.set(e.subarray(l));a.set(t,l)}else{var u=r-e.length;n.set(e);n.set(t.subarray(0,u),e.length);a.set(t.subarray(u))}}}else{n=e.concat(t);a=r>=0&&r<n.length?n.splice(r,n.length):[]}return[n,a]}var u=N(e,n,a,i,s);var c=r.redraw(e);var f=[e,u.update,a,u.maxPoints];l.add(e,r.extendTraces,f,t,arguments);return c};r.addTraces=function t(e,n,a){e=o.getGraphDiv(e);var i=[],s=r.deleteTraces,u=t,c=[e,i],f=[e,n],h,p;R(e,n,a);if(!Array.isArray(n)){n=[n]}n=n.map(function(t){return o.extendFlat({},t)});w.cleanData(n);for(h=0;h<n.length;h++){e.data.push(n[h])}for(h=0;h<n.length;h++){i.push(-n.length+h)}if(typeof a==="undefined"){p=r.redraw(e);l.add(e,s,c,u,f);return p}if(!Array.isArray(a)){a=[a]}try{D(e,i,a)}catch(t){e.data.splice(e.data.length-n.length,n.length);throw t}l.startSequence(e);l.add(e,s,c,u,f);p=r.moveTraces(e,i,a);l.stopSequence(e);return p};r.deleteTraces=function t(e,n){e=o.getGraphDiv(e);var a=[],i=r.addTraces,s=t,u=[e,a,n],c=[e,n],f,h;if(typeof n==="undefined"){throw new Error("indices must be an integer or array of integers.")}else if(!Array.isArray(n)){n=[n]}O(e,n,"indices");n=P(n,e.data.length-1);n.sort(o.sorterDes);for(f=0;f<n.length;f+=1){h=e.data.splice(n[f],1)[0];a.push(h)}var p=r.redraw(e);l.add(e,i,u,s,c);return p};r.moveTraces=function t(e,n,a){e=o.getGraphDiv(e);var i=[],s=[],u=t,c=t,f=[e,a,n],h=[e,n,a],p;D(e,n,a);n=Array.isArray(n)?n:[n];if(typeof a==="undefined"){a=[];for(p=0;p<n.length;p++){a.push(-n.length+p)}}a=Array.isArray(a)?a:[a];n=P(n,e.data.length-1);a=P(a,e.data.length-1);for(p=0;p<e.data.length;p++){if(n.indexOf(p)===-1){i.push(e.data[p])}}for(p=0;p<n.length;p++){s.push({newIndex:a[p],trace:e.data[n[p]]})}s.sort(function(t,e){return t.newIndex-e.newIndex});for(p=0;p<s.length;p+=1){i.splice(s[p].newIndex,0,s[p].trace)}e.data=i;var d=r.redraw(e);l.add(e,u,f,c,h);return d};r.restyle=function t(e,n,a,i){e=o.getGraphDiv(e);w.clearPromiseQueue(e);var s={};if(typeof n==="string")s[n]=a;else if(o.isPlainObject(n)){s=o.extendFlat({},n);if(i===undefined)i=a}else{o.warn("Restyle fail.",n,a,i);return Promise.reject()}if(Object.keys(s).length)e.changed=true;var u=w.coerceTraceIndices(e,i);var c=U(e,s,u);var h=c.flags;if(h.clearCalc)e.calcdata=undefined;if(h.clearAxisTypes)w.clearAxisTypes(e,u,{});var p=[];if(h.fullReplot){p.push(r.plot)}else{p.push(f.previousPromises);f.supplyDefaults(e);if(h.style)p.push(k.doTraceStyle);if(h.colorbars)p.push(k.doColorBars);p.push(E)}p.push(f.rehover);l.add(e,t,[e,c.undoit,c.traces],t,[e,c.redoit,c.traces]);var d=o.syncOrAsync(p,e);if(!d||!d.then)d=Promise.resolve();return d.then(function(){e.emit("plotly_restyle",c.eventData);return e})};function V(t){if(t===undefined)return null;return t}function U(t,e,r){var n=t._fullLayout,a=t._fullData,i=t.data,s;var l=M.traceFlags();var h={},d={},v;function g(){return r.map(function(){return undefined})}function m(t){var e=p.id2name(t);if(v.indexOf(e)===-1)v.push(e)}function y(t){return"LAYOUT"+t+".autorange"}function x(t){return"LAYOUT"+t+".range"}function b(n,a,s){if(Array.isArray(n)){n.forEach(function(t){b(t,a,s)});return}if(n in e||w.hasParent(e,n))return;var l;if(n.substr(0,6)==="LAYOUT"){l=o.nestedProperty(t.layout,n.replace("LAYOUT",""))}else{l=o.nestedProperty(i[r[s]],n)}if(!(n in d)){d[n]=g()}if(d[n][s]===undefined){d[n][s]=V(l.get())}if(a!==undefined){l.set(a)}}for(var _ in e){if(w.hasParent(e,_)){throw new Error("cannot set "+_+"and a parent attribute simultaneously")}var k=e[_],A,T,S,E,C,L;h[_]=k;if(_.substr(0,6)==="LAYOUT"){S=o.nestedProperty(t.layout,_.replace("LAYOUT",""));d[_]=[V(S.get())];S.set(Array.isArray(k)?k[0]:k);l.calc=true;continue}d[_]=g();for(s=0;s<r.length;s++){A=i[r[s]];T=a[r[s]];S=o.nestedProperty(A,_);E=S.get();C=Array.isArray(k)?k[s%k.length]:k;if(C===undefined)continue;var I=S.parts[S.parts.length-1];var z=_.substr(0,_.length-I.length-1);var P=z?z+".":"";var O=z?o.nestedProperty(T,z).get():T;L=c.getTraceValObject(T,S.parts);if(L&&L.impliedEdits&&C!==null){for(var D in L.impliedEdits){b(o.relativeAttr(_,D),L.impliedEdits[D],s)}}else if((I==="thicknessmode"||I==="lenmode")&&E!==C&&(C==="fraction"||C==="pixels")&&O){var R=n._size;var B=O.orient;var F=B==="top"||B==="bottom";if(I==="thicknessmode"){var N=F?R.h:R.w;b(P+"thickness",O.thickness*(C==="fraction"?1/N:N),s)}else{var j=F?R.w:R.h;b(P+"len",O.len*(C==="fraction"?1/j:j),s)}}else if(_==="type"&&C==="pie"!==(E==="pie")){var U="x",q="y";if((C==="bar"||E==="bar")&&A.orientation==="h"){U="y";q="x"}o.swapAttrs(A,["?","?src"],"labels",U);o.swapAttrs(A,["d?","?0"],"label",U);o.swapAttrs(A,["?","?src"],"values",q);if(E==="pie"){o.nestedProperty(A,"marker.color").set(o.nestedProperty(A,"marker.colors").get());n._pielayer.selectAll("g.trace").remove()}else if(u.traceIs(A,"cartesian")){o.nestedProperty(A,"marker.colors").set(o.nestedProperty(A,"marker.color").get())}}d[_][s]=V(E);var H=["swapxy","swapxyaxes","orientation","orientationaxes"];if(H.indexOf(_)!==-1){if(_==="orientation"){S.set(C);var G=A.x&&!A.y?"h":"v";if((S.get()||G)===T.orientation){continue}}else if(_==="orientationaxes"){A.orientation={v:"h",h:"v"}[T.orientation]}w.swapXYData(A);l.calc=l.clearAxisTypes=true}else if(f.dataArrayContainers.indexOf(S.parts[0])!==-1){w.manageArrayContainers(S,C,d);l.calc=true}else{if(L){if(L.arrayOk&&(o.isArrayOrTypedArray(C)||o.isArrayOrTypedArray(E))){l.calc=true}else M.update(l,L)}else{l.calc=true}S.set(C)}}if(["swapxyaxes","orientationaxes"].indexOf(_)!==-1){p.swap(t,r)}if(_==="orientationaxes"){var W=o.nestedProperty(t.layout,"hovermode");if(W.get()==="x"){W.set("y")}else if(W.get()==="y"){W.set("x")}}if(["orientation","type"].indexOf(_)!==-1){v=[];for(s=0;s<r.length;s++){var Y=i[r[s]];if(u.traceIs(Y,"cartesian")){m(Y.xaxis||"x");m(Y.yaxis||"y");if(_==="type"){b(["autobinx","autobiny"],true,s)}}}b(v.map(y),true,0);b(v.map(x),[0,1],0)}}var X=false;var Z=p.list(t);for(s=0;s<Z.length;s++){if(Z[s].autorange){X=true;break}}if(l.calc||l.calcIfAutorange&&X){l.clearCalc=true}if(l.calc||l.plot||l.calcIfAutorange){l.fullReplot=true}return{flags:l,undoit:d,redoit:h,traces:r,eventData:o.extendDeepNoArrays([],[h,r])}}r.relayout=function t(e,r,n){e=o.getGraphDiv(e);w.clearPromiseQueue(e);if(e.framework&&e.framework.isPolar){return Promise.resolve(e)}var a={};if(typeof r==="string"){a[r]=n}else if(o.isPlainObject(r)){a=o.extendFlat({},r)}else{o.warn("Relayout fail.",r,n);return Promise.reject()}if(Object.keys(a).length)e.changed=true;var i=Y(e,a);var s=i.flags;if(s.calc)e.calcdata=undefined;var u=[f.previousPromises];if(s.layoutReplot){u.push(k.layoutReplot)}else if(Object.keys(a).length){f.supplyDefaults(e);if(s.legend)u.push(k.doLegend);if(s.layoutstyle)u.push(k.layoutStyles);if(s.axrange){q(u,i.rangesAltered)}if(s.ticks)u.push(k.doTicksRelayout);if(s.modebar)u.push(k.doModeBar);if(s.camera)u.push(k.doCamera);u.push(E)}u.push(f.rehover);l.add(e,t,[e,i.undoit],t,[e,i.redoit]);var c=o.syncOrAsync(u,e);if(!c||!c.then)c=Promise.resolve(e);return c.then(function(){e.emit("plotly_relayout",i.eventData);return e})};function q(t,e){var r=e?function(t){return k.doTicksRelayout(t,e)}:k.doTicksRelayout;t.push(r,k.drawData,k.finalDraw)}var H=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/;var G=/^[xyz]axis[0-9]*\.autorange$/;var W=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function Y(t,e){var r=t.layout,n=t._fullLayout,a=Object.keys(e),i=p.list(t),s={},l,f,h;for(f=0;f<a.length;f++){if(a[f].indexOf("allaxes")===0){for(h=0;h<i.length;h++){var d=i[h]._id.substr(1),v=d.indexOf("scene")!==-1?d+".":"",g=a[f].replace("allaxes",v+i[h]._name);if(!e[g])e[g]=e[a[f]]}delete e[a[f]]}}var m=M.layoutFlags();var y={},x={};function b(t,n){if(Array.isArray(t)){t.forEach(function(t){b(t,n)});return}if(t in e||w.hasParent(e,t))return;var a=o.nestedProperty(r,t);if(!(t in x)){x[t]=V(a.get())}if(n!==undefined)a.set(n)}var k={};var T;function S(t){var e=p.name2id(t.split(".")[0]);k[e]=1;return e}for(var E in e){if(w.hasParent(e,E)){throw new Error("cannot set "+E+"and a parent attribute simultaneously")}var C=o.nestedProperty(r,E);var L=e[E];var I=C.parts.length;var z=I-1;while(z>0&&typeof C.parts[z]!=="string")z--;var P=C.parts[z];var O=C.parts[z-1]+"."+P;var D=C.parts.slice(0,z).join(".");var R=o.nestedProperty(t.layout,D).get();var B=o.nestedProperty(n,D).get();var F=C.get();if(L===undefined)continue;y[E]=L;x[E]=P==="reverse"?L:V(F);var N=c.getLayoutValObject(n,C.parts);if(N&&N.impliedEdits&&L!==null){for(var j in N.impliedEdits){b(o.relativeAttr(E,j),N.impliedEdits[j])}}if(["width","height"].indexOf(E)!==-1&&L===null){n[E]=t._initialAutoSize[E]}else if(O.match(H)){S(O);o.nestedProperty(n,D+"._inputRange").set(null)}else if(O.match(G)){S(O);o.nestedProperty(n,D+"._inputRange").set(null);var U=o.nestedProperty(n,D).get();if(U._inputDomain){U._input.domain=U._inputDomain.slice()}}else if(O.match(W)){o.nestedProperty(n,D+"._inputDomain").set(null)}if(P==="type"){var q=R,Y=B.type==="linear"&&L==="log",$=B.type==="log"&&L==="linear";if(Y||$){if(!q||!q.range){b(D+".autorange",true)}else if(!B.autorange){var J=q.range[0],K=q.range[1];if(Y){if(J<=0&&K<=0){b(D+".autorange",true)}if(J<=0)J=K/1e6;else if(K<=0)K=J/1e6;b(D+".range[0]",Math.log(J)/Math.LN10);b(D+".range[1]",Math.log(K)/Math.LN10)}else{b(D+".range[0]",Math.pow(10,J));b(D+".range[1]",Math.pow(10,K))}}else if(Y){q.range=q.range[1]>q.range[0]?[1,2]:[2,1]}if(Array.isArray(n._subplots.polar)&&n._subplots.polar.length&&n[C.parts[0]]&&C.parts[1]==="radialaxis"){delete n[C.parts[0]]._subplot.viewInitial["radialaxis.range"]}u.getComponentMethod("annotations","convertCoords")(t,B,L,b);u.getComponentMethod("images","convertCoords")(t,B,L,b)}else{b(D+".autorange",true);b(D+".range",null)}o.nestedProperty(n,D+"._inputRange").set(null)}else if(P.match(A)){var Q=o.nestedProperty(n,E).get(),tt=(L||{}).type;if(!tt||tt==="-")tt="linear";u.getComponentMethod("annotations","convertCoords")(t,Q,tt,b);u.getComponentMethod("images","convertCoords")(t,Q,tt,b)}var et=_.containerArrayMatch(E);if(et){l=et.array;f=et.index;var rt=et.property;var nt=o.nestedProperty(r,l);var at=(nt||[])[f]||{};var it=at;var ot=N||{editType:"calc"};var st=ot.editType.indexOf("calcIfAutorange")!==-1;if(f===""){if(st)m.calc=true;else M.update(m,ot);st=false}else if(rt===""){it=L;if(_.isAddVal(L)){x[E]=null}else if(_.isRemoveVal(L)){x[E]=at;it=at}else o.warn("unrecognized full object value",e)}if(st&&(Z(t,it,"x")||Z(t,it,"y"))){m.calc=true}else{M.update(m,ot)}if(!s[l])s[l]={};var lt=s[l][f];if(!lt)lt=s[l][f]={};lt[rt]=L;delete e[E]}else if(P==="reverse"){if(R.range)R.range.reverse();else{b(D+".autorange",true);R.range=[1,0]}if(B.autorange)m.calc=true;else m.plot=true}else{if(n._has("scatter-like")&&n._has("regl")&&(E==="dragmode"&&(L==="lasso"||L==="select")&&!(F==="lasso"||F==="select"))){m.plot=true}else if(N)M.update(m,N);else m.calc=true;C.set(L)}}for(l in s){var ut=_.applyContainerArrayChanges(t,o.nestedProperty(r,l),s[l],m);if(!ut)m.plot=true}var ct=n._axisConstraintGroups||[];for(T in k){for(f=0;f<ct.length;f++){var ft=ct[f];if(ft[T]){m.calc=true;for(var ht in ft){if(!k[ht]){p.getFromId(t,ht)._constraintShrinkable=true}}}}}if(X(t)||e.height||e.width)m.plot=true;if(m.plot||m.calc){m.layoutReplot=true}return{flags:m,rangesAltered:k,undoit:x,redoit:y,eventData:o.extendDeep({},y)}}function X(t){var e=t._fullLayout;var r=e.width;var n=e.height;if(t.layout.autosize)f.plotAutoSize(t,t.layout,e);return e.width!==r||e.height!==n}function Z(t,e,r){if(!o.isPlainObject(e))return false;var n=e[r+"ref"]||r,a=p.getFromId(t,n);if(!a&&n.charAt(0)===r){a=p.getFromId(t,r)}return(a||{}).autorange}r.update=function t(e,n,a,i){e=o.getGraphDiv(e);w.clearPromiseQueue(e);if(e.framework&&e.framework.isPolar){return Promise.resolve(e)}if(!o.isPlainObject(n))n={};if(!o.isPlainObject(a))a={};if(Object.keys(n).length)e.changed=true;if(Object.keys(a).length)e.changed=true;var s=w.coerceTraceIndices(e,i);var u=U(e,o.extendFlat({},n),s);var c=u.flags;var h=Y(e,o.extendFlat({},a));var p=h.flags;if(c.clearCalc||p.calc)e.calcdata=undefined;if(c.clearAxisTypes)w.clearAxisTypes(e,s,a);var d=[];if(c.fullReplot&&p.layoutReplot){var v=e.data,g=e.layout;e.data=undefined;e.layout=undefined;d.push(function(){return r.plot(e,v,g)})}else if(c.fullReplot){d.push(r.plot)}else if(p.layoutReplot){d.push(k.layoutReplot)}else{d.push(f.previousPromises);f.supplyDefaults(e);if(c.style)d.push(k.doTraceStyle);if(c.colorbars)d.push(k.doColorBars);if(p.legend)d.push(k.doLegend);if(p.layoutstyle)d.push(k.layoutStyles);if(p.axrange){q(d,h.rangesAltered)}if(p.ticks)d.push(k.doTicksRelayout);if(p.modebar)d.push(k.doModeBar);if(p.camera)d.push(k.doCamera);d.push(E)}d.push(f.rehover);l.add(e,t,[e,u.undoit,h.undoit,u.traces],t,[e,u.redoit,h.redoit,u.traces]);var m=o.syncOrAsync(d,e);if(!m||!m.then)m=Promise.resolve(e);return m.then(function(){e.emit("plotly_update",{data:u.eventData,layout:h.eventData});return e})};r.react=function(t,e,n,a){var i,s;function l(){return r.addFrames(t,i)}t=o.getGraphDiv(t);var c=t._fullData;var h=t._fullLayout;if(!o.isPlotDiv(t)||!c||!h){s=r.newPlot(t,e,n,a)}else{if(o.isPlainObject(e)){var p=e;e=p.data;n=p.layout;a=p.config;i=p.frames}var d=false;if(a){var v=o.extendDeep({},t._context);t._context=undefined;I(t,a);d=Q(v,t._context)}t.data=e||[];w.cleanData(t.data);t.layout=n||{};w.cleanLayout(t.layout);f.supplyDefaults(t,{skipUpdateCalc:true});var g=t._fullData;var m=t._fullLayout;var y=m.datarevision===undefined;var x=$(t,c,g,y);var b=J(t,h,m,y);if(X(t))b.layoutReplot=true;if(x.calc||b.calc)t.calcdata=undefined;else f.supplyDefaultsUpdateCalc(t.calcdata,g);var _=[];if(i){t._transitionData={};f.createTransitionData(t);_.push(l)}if(x.fullReplot||b.layoutReplot||d){t._fullLayout._skipDefaults=true;_.push(r.plot)}else{for(var M in b.arrays){var A=b.arrays[M];if(A.length){var T=u.getComponentMethod(M,"drawOne");if(T!==o.noop){for(var S=0;S<A.length;S++){T(t,A[S])}}else{var C=u.getComponentMethod(M,"draw");if(C===o.noop){throw new Error("cannot draw components: "+M)}C(t)}}}_.push(f.previousPromises);if(x.style)_.push(k.doTraceStyle);if(x.colorbars)_.push(k.doColorBars);if(b.legend)_.push(k.doLegend);if(b.layoutstyle)_.push(k.layoutStyles);if(b.axrange)q(_);if(b.ticks)_.push(k.doTicksRelayout);if(b.modebar)_.push(k.doModeBar);if(b.camera)_.push(k.doCamera);_.push(E)}_.push(f.rehover);s=o.syncOrAsync(_,t);if(!s||!s.then)s=Promise.resolve(t)}return s.then(function(){t.emit("plotly_react",{data:e,layout:n});return t})};function $(t,e,r,n){if(e.length!==r.length){return{fullReplot:true,calc:true}}var a=M.traceFlags();a.arrays={};var i,o;function s(t){return c.getTraceValObject(o,t)}var l={getValObject:s,flags:a,immutable:n,gd:t};var u={};for(i=0;i<e.length;i++){o=r[i]._fullInput;if(u[o.uid])continue;u[o.uid]=1;l.autoranged=o.xaxis?p.getFromId(t,o.xaxis).autorange||p.getFromId(t,o.yaxis).autorange:false;K(e[i]._fullInput,o,[],l)}if(a.calc||a.plot||a.calcIfAutorange){a.fullReplot=true}return a}function J(t,e,r,n){var a=M.layoutFlags();a.arrays={};function i(t){return c.getLayoutValObject(r,t)}var o={getValObject:i,flags:a,immutable:n,gd:t};K(e,r,[],o);if(a.plot||a.calc){a.layoutReplot=true}return a}function K(t,e,r,n){var a,i;var s=n.getValObject;var l=n.flags;var u=n.immutable;var c=n.inArray;var f=n.arrayIndex;var h=n.gd;var p=n.autoranged;function d(){var t=a.editType;if(t.indexOf("calcIfAutorange")!==-1&&(p||p===undefined&&(Z(h,e,"x")||Z(h,e,"y")))){l.calc=true;return}if(c&&t.indexOf("arraydraw")!==-1){o.pushUnique(l.arrays[c],f);return}M.update(l,a)}function v(t){return t.valType==="data_array"||t.arrayOk}for(i in t){if(l.calc)return;var g=t[i];var m=e[i];if(i.charAt(0)==="_"||typeof g==="function"||g===m)continue;if(i==="tick0"||i==="dtick"){var y=e.tickmode;if(y==="auto"||y==="array"||!y)continue}if(i==="range"&&e.autorange)continue;if((i==="zmin"||i==="zmax")&&e.type==="contourcarpet")continue;var x=r.concat(i);a=s(x);if(!a)continue;if(a._compareAsJSON&&JSON.stringify(g)===JSON.stringify(m))continue;var b=a.valType;var _;var w=v(a);var k=Array.isArray(g);var A=Array.isArray(m);if(k&&A){var T="_input_"+i;var S=t[T];var E=e[T];if(Array.isArray(S)&&S===E)continue}if(m===undefined){if(w&&k)l.calc=true;else d()}else if(a._isLinkedToArray){var C=[];var L=false;if(!c)l.arrays[i]=C;var I=Math.min(g.length,m.length);var z=Math.max(g.length,m.length);if(I!==z){if(a.editType==="arraydraw"){L=true}else{d();continue}}for(_=0;_<I;_++){K(g[_],m[_],x.concat(_),o.extendFlat({inArray:i,arrayIndex:_},n))}if(L){for(_=I;_<z;_++){C.push(_)}}}else if(!b&&o.isPlainObject(g)){K(g,m,x,n)}else if(w){if(k&&A){if(u){l.calc=true}}else if(k!==A){l.calc=true}else d()}else if(k&&A){if(g.length!==m.length||String(g)!==String(m)){d()}}else{d()}}for(i in e){if(!(i in t||i.charAt(0)==="_"||typeof e[i]==="function")){a=s(r.concat(i));if(v(a)&&Array.isArray(e[i])){l.calc=true;return}else d()}}}function Q(t,e){var r;for(r in t){var n=t[r];var a=e[r];if(n!==a){if(o.isPlainObject(n)&&o.isPlainObject(a)){if(Q(n,a)){return true}}else if(Array.isArray(n)&&Array.isArray(a)){if(n.length!==a.length){return true}for(var i=0;i<n.length;i++){if(n[i]!==a[i]){if(o.isPlainObject(n[i])&&o.isPlainObject(a[i])){if(Q(n[i],a[i])){return true}}else{return true}}}}else{return true}}}}r.animate=function(t,e,r){t=o.getGraphDiv(t);if(!o.isPlotDiv(t)){throw new Error("This element is not a Plotly plot: "+t+". It's likely that you've failed "+"to create a plot before animating it. For more details, see "+"https://plot.ly/javascript/animations/")}var n=t._transitionData;if(!n._frameQueue){n._frameQueue=[]}r=f.supplyAnimationDefaults(r);var a=r.transition;var i=r.frame;if(n._frameWaitingCnt===undefined){n._frameWaitingCnt=0}function s(t){if(Array.isArray(a)){if(t>=a.length){return a[0]}else{return a[t]}}else{return a}}function l(t){if(Array.isArray(i)){if(t>=i.length){return i[0]}else{return i[t]}}else{return i}}function u(t,e){var r=0;return function(){if(t&&++r===e){return t()}}}return new Promise(function(i,c){function h(){if(n._frameQueue.length===0){return}while(n._frameQueue.length){var e=n._frameQueue.pop();if(e.onInterrupt){e.onInterrupt()}}t.emit("plotly_animationinterrupted",[])}function p(e){if(e.length===0)return;for(var a=0;a<e.length;a++){var o;if(e[a].type==="byname"){o=f.computeFrame(t,e[a].name)}else{o=e[a].data}var h=l(a);var p=s(a);p.duration=Math.min(p.duration,h.duration);var d={frame:o,name:e[a].name,frameOpts:h,transitionOpts:p};if(a===e.length-1){d.onComplete=u(i,2);d.onInterrupt=c}n._frameQueue.push(d)}if(r.mode==="immediate"){n._lastFrameAt=-Infinity}if(!n._animationRaf){g()}}function d(){t.emit("plotly_animated");window.cancelAnimationFrame(n._animationRaf);n._animationRaf=null}function v(){if(n._currentFrame&&n._currentFrame.onComplete){n._currentFrame.onComplete()}var e=n._currentFrame=n._frameQueue.shift();if(e){var r=e.name?e.name.toString():null;t._fullLayout._currentFrame=r;n._lastFrameAt=Date.now();n._timeToNext=e.frameOpts.duration;f.transition(t,e.frame.data,e.frame.layout,w.coerceTraceIndices(t,e.frame.traces),e.frameOpts,e.transitionOpts).then(function(){if(e.onComplete){e.onComplete()}});t.emit("plotly_animatingframe",{name:r,frame:e.frame,animation:{frame:e.frameOpts,transition:e.transitionOpts}})}else{d()}}function g(){t.emit("plotly_animating");n._lastFrameAt=-Infinity;n._timeToNext=0;n._runningTransitions=0;n._currentFrame=null;var e=function(){n._animationRaf=window.requestAnimationFrame(e);if(Date.now()-n._lastFrameAt>n._timeToNext){v()}};e()}var m=0;function y(t){if(Array.isArray(a)){if(m>=a.length){t.transitionOpts=a[m]}else{t.transitionOpts=a[0]}}else{t.transitionOpts=a}m++;return t}var x,b;var _=[];var k=e===undefined||e===null;var M=Array.isArray(e);var A=!k&&!M&&o.isPlainObject(e);if(A){_.push({type:"object",data:y(o.extendFlat({},e))})}else if(k||["string","number"].indexOf(typeof e)!==-1){for(x=0;x<n._frames.length;x++){b=n._frames[x];if(!b)continue;if(k||String(b.group)===String(e)){_.push({type:"byname",name:String(b.name),data:y({name:b.name})})}}}else if(M){for(x=0;x<e.length;x++){var T=e[x];if(["number","string"].indexOf(typeof T)!==-1){T=String(T);_.push({type:"byname",name:T,data:y({name:T})})}else if(o.isPlainObject(T)){_.push({type:"object",data:y(o.extendFlat({},T))})}}}for(x=0;x<_.length;x++){b=_[x];if(b.type==="byname"&&!n._frameHash[b.data.name]){o.warn('animate failure: frame not found: "'+b.data.name+'"');c();return}}if(["next","immediate"].indexOf(r.mode)!==-1){h()}if(r.direction==="reverse"){_.reverse()}var S=t._fullLayout._currentFrame;if(S&&r.fromcurrent){var E=-1;for(x=0;x<_.length;x++){b=_[x];if(b.type==="byname"&&b.name===S){E=x;break}}if(E>0&&E<_.length-1){var C=[];for(x=0;x<_.length;x++){b=_[x];if(_[x].type!=="byname"||x>E){C.push(b)}}_=C}}if(_.length>0){p(_)}else{t.emit("plotly_animated");i()}})};r.addFrames=function(t,e,r){t=o.getGraphDiv(t);if(e===null||e===undefined){return Promise.resolve()}if(!o.isPlotDiv(t)){throw new Error("This element is not a Plotly plot: "+t+". It's likely that you've failed "+"to create a plot before adding frames. For more details, see "+"https://plot.ly/javascript/animations/")}var n,a,i,s;var u=t._transitionData._frames;var c=t._transitionData._frameHash;if(!Array.isArray(e)){throw new Error("addFrames failure: frameList must be an Array of frame definitions"+e)}var h=u.length+e.length*2;var p=[];var d={};for(n=e.length-1;n>=0;n--){if(!o.isPlainObject(e[n]))continue;var v=e[n].name;var g=(c[v]||d[v]||{}).name;var m=e[n].name;var y=c[g]||d[g];if(g&&m&&typeof m==="number"&&y&&T<S){T++;o.warn('addFrames: overwriting frame "'+(c[g]||d[g]).name+'" with a frame whose name of type "number" also equates to "'+g+'". This is valid but may potentially lead to unexpected '+"behavior since all plotly.js frame names are stored internally "+"as strings.");if(T===S){o.warn("addFrames: This API call has yielded too many of these warnings. "+"For the rest of this call, further warnings about numeric frame "+"names will be suppressed.")}}d[v]={name:v};p.push({frame:f.supplyFrameDefaults(e[n]),index:r&&r[n]!==undefined&&r[n]!==null?r[n]:h+n})}p.sort(function(t,e){if(t.index>e.index)return-1;if(t.index<e.index)return 1;return 0});var x=[];var b=[];var _=u.length;for(n=p.length-1;n>=0;n--){a=p[n].frame;if(typeof a.name==="number"){o.warn("Warning: addFrames accepts frames with numeric names, but the numbers are"+"implicitly cast to strings")}if(!a.name){while(c[a.name="frame "+t._transitionData._counter++]);}if(c[a.name]){for(i=0;i<u.length;i++){if((u[i]||{}).name===a.name)break}x.push({type:"replace",index:i,value:a});b.unshift({type:"replace",index:i,value:u[i]})}else{s=Math.max(0,Math.min(p[n].index,_));x.push({type:"insert",index:s,value:a});b.unshift({type:"delete",index:s});_++}}var w=f.modifyFrames,k=f.modifyFrames,M=[t,b],A=[t,x];if(l)l.add(t,w,M,k,A);return f.modifyFrames(t,x)};r.deleteFrames=function(t,e){t=o.getGraphDiv(t);if(!o.isPlotDiv(t)){throw new Error("This element is not a Plotly plot: "+t)}var r,n;var a=t._transitionData._frames;var i=[];var s=[];if(!e){e=[];for(r=0;r<a.length;r++){e.push(r)}}e=e.slice(0);e.sort();for(r=e.length-1;r>=0;r--){n=e[r];i.push({type:"delete",index:n});s.unshift({type:"insert",index:n,value:a[n]})}var u=f.modifyFrames,c=f.modifyFrames,h=[t,s],p=[t,i];if(l)l.add(t,u,h,c,p);return f.modifyFrames(t,i)};r.purge=function t(e){e=o.getGraphDiv(e);var r=e._fullLayout||{};var n=e._fullData||[];var a=e.calcdata||[];f.cleanPlot([],{},n,r,a);f.purge(e);s.purge(e);if(r._container)r._container.remove();delete e._context;return e};function tt(t){var e=n.select(t);var r=t._fullLayout;r._container=e.selectAll(".plot-container").data([0]);r._container.enter().insert("div",":first-child").classed("plot-container",true).classed("plotly",true);r._paperdiv=r._container.selectAll(".svg-container").data([0]);r._paperdiv.enter().append("div").classed("svg-container",true).style("position","relative");r._glcontainer=r._paperdiv.selectAll(".gl-container").data([{}]);r._glcontainer.enter().append("div").classed("gl-container",true);r._glcanvas=null;r._paperdiv.selectAll(".main-svg").remove();r._paper=r._paperdiv.insert("svg",":first-child").classed("main-svg",true);r._toppaper=r._paperdiv.append("svg").classed("main-svg",true);if(!r._uid){var a={};n.selectAll("defs").each(function(){if(this.id)a[this.id.split("-")[1]]=1});r._uid=o.randstr(a)}r._paperdiv.selectAll(".main-svg").attr(y.svgAttrs);r._defs=r._paper.append("defs").attr("id","defs-"+r._uid);r._clips=r._defs.append("g").classed("clips",true);r._topdefs=r._toppaper.append("defs").attr("id","topdefs-"+r._uid);r._topclips=r._topdefs.append("g").classed("clips",true);r._bgLayer=r._paper.append("g").classed("bglayer",true);r._draggers=r._paper.append("g").classed("draglayer",true);var i=r._paper.append("g").classed("layer-below",true);r._imageLowerLayer=i.append("g").classed("imagelayer",true);r._shapeLowerLayer=i.append("g").classed("shapelayer",true);r._cartesianlayer=r._paper.append("g").classed("cartesianlayer",true);r._polarlayer=r._paper.append("g").classed("polarlayer",true);r._ternarylayer=r._paper.append("g").classed("ternarylayer",true);r._geolayer=r._paper.append("g").classed("geolayer",true);r._pielayer=r._paper.append("g").classed("pielayer",true);r._glimages=r._paper.append("g").classed("glimages",true);var s=r._toppaper.append("g").classed("layer-above",true);r._imageUpperLayer=s.append("g").classed("imagelayer",true);r._shapeUpperLayer=s.append("g").classed("shapelayer",true);r._infolayer=r._toppaper.append("g").classed("infolayer",true);r._menulayer=r._toppaper.append("g").classed("menulayer",true);r._zoomlayer=r._toppaper.append("g").classed("zoomlayer",true);r._hoverlayer=r._toppaper.append("g").classed("hoverlayer",true);t.emit("plotly_framework")}},{"../components/color":558,"../components/colorbar/connect":560,"../components/drawing":583,"../constants/xmlns_namespaces":663,"../lib":684,"../lib/events":672,"../lib/queue":699,"../lib/svg_text_utils":708,"../plots/cartesian/axes":732,"../plots/cartesian/constants":737,"../plots/cartesian/graph_interact":741,"../plots/plots":795,"../plots/polar/legacy":803,"../registry":817,"./edit_types":715,"./helpers":716,"./manage_arrays":718,"./plot_config":720,"./plot_schema":721,"./subroutines":723,d3:147,"fast-isnumeric":214,"has-hover":378}],720:[function(t,e,r){"use strict";e.exports={staticPlot:false,plotlyServerURL:"https://plot.ly",editable:false,edits:{annotationPosition:false,annotationTail:false,annotationText:false,axisTitleText:false,colorbarPosition:false,colorbarTitleText:false,legendPosition:false,legendText:false,shapePosition:false,titleText:false},autosizable:false,queueLength:0,fillFrame:false,frameMargins:0,scrollZoom:false,doubleClick:"reset+autosize",showTips:true,showAxisDragHandles:true,showAxisRangeEntryBoxes:true,showLink:false,sendData:true,linkText:"Edit chart",showSources:false,displayModeBar:"hover",modeBarButtonsToRemove:[],modeBarButtonsToAdd:[],modeBarButtons:false,toImageButtonOptions:{},displaylogo:true,plotGlPixelRatio:2,setBackground:"transparent",topojsonURL:"https://cdn.plot.ly/",mapboxAccessToken:null,logging:1,globalTransforms:[],locale:"en-US",locales:{}}},{}],721:[function(t,e,r){"use strict";var n=t("../registry");var a=t("../lib");var i=t("../plots/attributes");var o=t("../plots/layout_attributes");var s=t("../plots/frame_attributes");var l=t("../plots/animation_attributes");var u=t("../plots/polar/legacy/area_attributes");var c=t("../plots/polar/legacy/axis_attributes");var f=t("./edit_types");var h=a.extendFlat;var p=a.extendDeepAll;var d=a.isPlainObject;var v="_isSubplotObj";var g="_isLinkedToArray";var m="_arrayAttrRegexps";var y="_deprecated";var x=[v,g,m,y];r.IS_SUBPLOT_OBJ=v;r.IS_LINKED_TO_ARRAY=g;r.DEPRECATED=y;r.UNDERSCORE_ATTRS=x;r.get=function(){var t={};n.allTypes.concat("area").forEach(function(e){t[e]=k(e)});var e={};Object.keys(n.transformsRegistry).forEach(function(t){e[t]=A(t)});return{defs:{valObjects:a.valObjectMeta,metaKeys:x.concat(["description","role","editType","impliedEdits"]),editType:{traces:f.traces,layout:f.layout},impliedEdits:{}},traces:t,layout:M(),transforms:e,frames:T(),animation:S(l)}};r.crawl=function(t,e,n,a){var i=n||0;a=a||"";Object.keys(t).forEach(function(n){var o=t[n];if(x.indexOf(n)!==-1)return;var s=(a?a+".":"")+n;e(o,n,t,i,s);if(r.isValObject(o))return;if(d(o)&&n!=="impliedEdits"){r.crawl(o,e,i+1,s)}})};r.isValObject=function(t){return t&&t.valType!==undefined};r.findArrayAttributes=function(t){var e=[];var n=[];var o=[];var s,l;function u(t,e,r,a){n=n.slice(0,a).concat([e]);o=o.slice(0,a).concat([t&&t._isLinkedToArray]);var i=t&&(t.valType==="data_array"||t.arrayOk===true)&&!(n[a-1]==="colorbar"&&(e==="ticktext"||e==="tickvals"));if(!i)return;c(s,0,"")}function c(t,r,i){var s=t[n[r]];var u=i+n[r];if(r===n.length-1){if(a.isArrayOrTypedArray(s)){e.push(l+u)}}else{if(o[r]){if(Array.isArray(s)){for(var f=0;f<s.length;f++){if(a.isPlainObject(s[f])){c(s[f],r+1,u+"["+f+"].")}}}}else if(a.isPlainObject(s)){c(s,r+1,u+".")}}}s=t;l="";r.crawl(i,u);if(t._module&&t._module.attributes){r.crawl(t._module.attributes,u)}var f=t.transforms;if(f){for(var h=0;h<f.length;h++){var p=f[h];var d=p._module;if(d){l="transforms["+h+"].";s=p;r.crawl(d.attributes,u)}}}return e};r.getTraceValObject=function(t,e){var r=e[0];var a=1;var o,s;if(r==="transforms"){if(e.length===1){return i.transforms}var l=t.transforms;if(!Array.isArray(l)||!l.length)return false;var c=e[1];if(!w(c)||c>=l.length){return false}o=(n.transformsRegistry[l[c].type]||{}).attributes;s=o&&o[e[2]];a=3}else if(t.type==="area"){s=u[r]}else{var f=t._module;if(!f)f=(n.modules[t.type||i.type.dflt]||{})._module;if(!f)return false;o=f.attributes;s=o&&o[r];if(!s){var h=f.basePlotModule;if(h&&h.attributes){s=h.attributes[r]}}if(!s)s=i[r]}return _(s,e,a)};r.getLayoutValObject=function(t,e){var r=b(t,e[0]);return _(r,e,1)};function b(t,e){var r,a,i,s;var l=t._basePlotModules;if(l){var u;for(r=0;r<l.length;r++){i=l[r];if(i.attrRegex&&i.attrRegex.test(e)){if(i.layoutAttrOverrides)return i.layoutAttrOverrides;if(!u&&i.layoutAttributes)u=i.layoutAttributes}var f=i.baseLayoutAttrOverrides;if(f&&e in f)return f[e]}if(u)return u}var h=t._modules;if(h){for(r=0;r<h.length;r++){s=h[r].layoutAttributes;if(s&&e in s){return s[e]}}}for(a in n.componentsRegistry){i=n.componentsRegistry[a];if(!i.schema&&e===i.name){return i.layoutAttributes}}if(e in o)return o[e];if(e==="radialaxis"||e==="angularaxis"){return c[e]}return c.layout[e]||false}function _(t,e,r){if(!t)return false;if(t._isLinkedToArray){if(w(e[r]))r++;else if(r<e.length)return false}for(;r<e.length;r++){var n=t[e[r]];if(d(n))t=n;else break;if(r===e.length-1)break;if(t._isLinkedToArray){r++;if(!w(e[r]))return false}else if(t.valType==="info_array"){r++;var a=e[r];if(!w(a))return false;var i=t.items;if(Array.isArray(i)){if(a>=i.length)return false;if(t.dimensions===2){r++;if(e.length===r)return t;var o=e[r];if(!w(o))return false;t=i[a][o]}else t=i[a]}else{t=i}}}return t}function w(t){return t===Math.round(t)&&t>=0}function k(t){var e,r;if(t==="area"){e={attributes:u};r={}}else{e=n.modules[t]._module,r=e.basePlotModule}var a={};a.type=null;p(a,i);p(a,e.attributes);if(r.attributes){p(a,r.attributes)}a.type=t;var o={meta:e.meta||{},attributes:S(a)};if(e.layoutAttributes){var s={};p(s,e.layoutAttributes);o.layoutAttributes=S(s)}return o}function M(){var t={};var e,r;p(t,o);for(e in n.subplotsRegistry){r=n.subplotsRegistry[e];if(!r.layoutAttributes)continue;if(Array.isArray(r.attr)){for(var a=0;a<r.attr.length;a++){z(t,r,r.attr[a])}}else{var i=r.attr==="subplot"?r.name:r.attr;z(t,r,i)}}t=I(t);for(e in n.componentsRegistry){r=n.componentsRegistry[e];var s=r.schema;if(s&&(s.subplots||s.layout)){var l=s.subplots;if(l&&l.xaxis&&!l.yaxis){for(var u in l.xaxis)delete t.yaxis[u]}}else if(r.layoutAttributes){P(t,r.layoutAttributes,r.name)}}return{layoutAttributes:S(t)}}function A(t){var e=n.transformsRegistry[t];var r=p({},e.attributes);Object.keys(n.componentsRegistry).forEach(function(e){var a=n.componentsRegistry[e];if(a.schema&&a.schema.transforms&&a.schema.transforms[t]){Object.keys(a.schema.transforms[t]).forEach(function(e){P(r,a.schema.transforms[t][e],e)})}});return{attributes:S(r)}}function T(){var t={frames:a.extendDeepAll({},s)};S(t);return t.frames}function S(t){E(t);C(t);L(t);return t}function E(t){function e(t){return{valType:"string",editType:"none"}}function n(t,n,a){if(r.isValObject(t)){if(t.valType==="data_array"){t.role="data";a[n+"src"]=e(n)}else if(t.arrayOk===true){a[n+"src"]=e(n)}}else if(d(t)){t.role="object"}}r.crawl(t,n)}function C(t){function e(t,e,r){if(!t)return;var n=t[g];if(!n)return;delete t[g];r[e]={items:{}};r[e].items[n]=t;r[e].role="object"}r.crawl(t,e)}function L(t){function e(t){for(var r in t){if(d(t[r])){e(t[r])}else if(Array.isArray(t[r])){for(var n=0;n<t[r].length;n++){e(t[r][n])}}else{if(t[r]instanceof RegExp){t[r]=t[r].toString()}}}}e(t)}function I(t){h(t,{radialaxis:c.radialaxis,angularaxis:c.angularaxis});h(t,c.layout);return t}function z(t,e,r){var n=a.nestedProperty(t,r),i=p({},e.layoutAttributes);i[v]=true;n.set(i)}function P(t,e,r){var n=a.nestedProperty(t,r);n.set(p(n.get()||{},e))}},{"../lib":684,"../plots/animation_attributes":727,"../plots/attributes":729,"../plots/frame_attributes":759,"../plots/layout_attributes":786,"../plots/polar/legacy/area_attributes":801,"../plots/polar/legacy/axis_attributes":802,"../registry":817,"./edit_types":715}],722:[function(t,e,r){"use strict";var n=t("../lib");var a=t("../plots/attributes");var i="templateitemname";var o={name:{valType:"string",editType:"none"}};o[i]={valType:"string",editType:"calc"};r.templatedArray=function(t,e){e._isLinkedToArray=t;e.name=o.name;e[i]=o[i];return e};r.traceTemplater=function(t){var e={};var r,i;for(r in t){i=t[r];if(Array.isArray(i)&&i.length){e[r]=0}}function o(o){r=n.coerce(o,{},a,"type");var s={type:r,_template:null};if(r in e){i=t[r];var l=e[r]%i.length;e[r]++;s._template=i[l]}else{}return s}return{newTrace:o}};r.newContainer=function(t,e,r){var a=t._template;var i=a&&(a[e]||r&&a[r]);if(!n.isPlainObject(i))i=null;var o=t[e]={_template:i};return o};r.arrayTemplater=function(t,e,r){var n=t._template;var a=n&&n[l(e)];var o=n&&n[e];if(!Array.isArray(o)||!o.length){o=[]}var u={};function c(t){var e={name:t.name,_input:t};var n=e[i]=t[i];if(!s(n)){e._template=a;return e}for(var l=0;l<o.length;l++){var c=o[l];if(c.name===n){u[n]=1;e._template=c;return e}}e[r]=t[r]||false;e._template=false;return e}function f(){var t=[];for(var e=0;e<o.length;e++){var r=o[e];var n=r.name;if(s(n)&&!u[n]){var a={_template:r,name:n,_input:{_templateitemname:n}};a[i]=r[i];t.push(a);u[n]=1}}return t}return{newItem:c,defaultItems:f}};function s(t){return t&&typeof t==="string"}function l(t){var e=t.length-1;if(t.charAt(e)!=="s"){n.warn("bad argument to arrayDefaultKey: "+t)}return t.substr(0,t.length-1)+"defaults"}r.arrayDefaultKey=l;r.arrayEditor=function(t,e,r){var a=(n.nestedProperty(t,e).get()||[]).length;var o=r._index;var s=o>=a&&(r._input||{})._templateitemname;if(s)o=a;var l=e+"["+o+"]";var u;function c(){u={};if(s){u[l]={};u[l][i]=s}}c();function f(t,e){u[t]=e}function h(t,e){if(s){n.nestedProperty(u[l],t).set(e)}else{u[l+"."+t]=e}}function p(){var t=u;c();return t}function d(e,r){if(e)h(e,r);var a=p();for(var i in a){n.nestedProperty(t,i).set(a[i])}}return{modifyBase:f,modifyItem:h,getUpdateObj:p,applyUpdate:d}}},{"../lib":684,"../plots/attributes":729}],723:[function(t,e,r){"use strict";var n=t("d3");var a=t("../registry");var i=t("../plots/plots");var o=t("../lib");var s=t("../lib/clear_gl_canvases");var l=t("../components/color");var u=t("../components/drawing");var c=t("../components/titles");var f=t("../components/modebar");var h=t("../plots/cartesian/axes");var p=t("../constants/alignment");var d=t("../plots/cartesian/constraints");var v=d.enforce;var g=d.clean;var m=t("../plots/cartesian/autorange").doAutoRange;r.layoutStyles=function(t){return o.syncOrAsync([i.doAutoMargin,x],t)};function y(t,e,r){for(var n=0;n<r.length;n++){var a=r[n][0],i=r[n][1];if(a[0]>=t[1]||a[1]<=t[0]){continue}if(i[0]<e[1]&&i[1]>e[0]){return true}}return false}function x(t){var e=t._fullLayout;var a=e._size;var i=a.p;var s=h.list(t,"",true);var c=e._has("cartesian");var d;function v(t,e,r){var n=t._lw/2;if(t._id.charAt(0)==="x"){if(!e)return a.t+a.h*(1-(t.position||0))+n%1;else if(r==="top")return e._offset-i-n;return e._offset+e._length+i+n}if(!e)return a.l+a.w*(t.position||0)+n%1;else if(r==="right")return e._offset+e._length+i+n;return e._offset-i-n}for(d=0;d<s.length;d++){var g=s[d];g.setScale();var m=g._anchorAxis;g._linepositions={};g._lw=u.crispRound(t,g.linewidth,1);g._mainLinePosition=v(g,m,g.side);g._mainMirrorPosition=g.mirror&&m?v(g,m,p.OPPOSITE_SIDE[g.side]):null;g._mainSubplot=b(g,e)}e._paperdiv.style({width:e.width+"px",height:e.height+"px"}).selectAll(".main-svg").call(u.setSize,e.width,e.height);t._context.setBackground(t,e.paper_bgcolor);var x=e._paper.selectAll("g.subplot");var w=[];var M=[];x.each(function(t){var r=e._plots[t];if(r.mainplot){if(r.bg){r.bg.remove()}r.bg=undefined;return}var n=r.xaxis.domain;var a=r.yaxis.domain;var i=r.plotgroup;if(y(n,a,M)){var s=i.node();var l=r.bg=o.ensureSingle(i,"rect","bg");s.insertBefore(l.node(),s.childNodes[0])}else{i.select("rect.bg").remove();w.push(t);M.push([n,a])}});var A=e._bgLayer.selectAll(".bg").data(w);A.enter().append("rect").classed("bg",true);A.exit().remove();A.each(function(t){e._plots[t].bg=n.select(this)});x.each(function(t){var r=e._plots[t];var n=r.xaxis;var a=r.yaxis;if(r.bg&&c){r.bg.call(u.setRect,n._offset-i,a._offset-i,n._length+2*i,a._length+2*i).call(l.fill,e.plot_bgcolor).style("stroke-width",0)}var f=r.clipId="clip"+e._uid+t+"plot";var h=o.ensureSingleById(e._clips,"clipPath",f,function(t){t.classed("plotclip",true).append("rect")});r.clipRect=h.select("rect").attr({width:n._length,height:a._length});u.setTranslate(r.plot,n._offset,a._offset);var p;var d;if(r._hasClipOnAxisFalse){p=null;d=f}else{p=f;d=null}u.setClipUrl(r.plot,p);r.layerClipId=d;if(!c)return;var g,m,y,x,b,w;var M,A,T,S,E,C;var L;function I(t){return"M"+g+","+t+"H"+m}function z(t){return"M"+n._offset+","+t+"h"+n._length}function P(t){return"M"+t+","+A+"V"+M}function O(t){return"M"+t+","+a._offset+"v"+a._length}function D(e,r,n){if(!e.showline||t!==e._mainSubplot)return"";if(!e._anchorAxis)return n(e._mainLinePosition);var a=r(e._mainLinePosition);if(e.mirror)a+=r(e._mainMirrorPosition);return a}var R="M0,0";if(_(n,t)){b=k(n,"left",a,s);g=n._offset-(b?i+b:0);w=k(n,"right",a,s);m=n._offset+n._length+(w?i+w:0);y=v(n,a,"bottom");x=v(n,a,"top");L=!n._anchorAxis||t!==n._mainSubplot;if(L&&n.ticks&&n.mirror==="allticks"){n._linepositions[t]=[y,x]}R=D(n,I,z);if(L&&n.showline&&(n.mirror==="all"||n.mirror==="allticks")){R+=I(y)+I(x)}r.xlines.style("stroke-width",n._lw+"px").call(l.stroke,n.showline?n.linecolor:"rgba(0,0,0,0)")}r.xlines.attr("d",R);var B="M0,0";if(_(a,t)){E=k(a,"bottom",n,s);M=a._offset+a._length+(E?i:0);C=k(a,"top",n,s);A=a._offset-(C?i:0);T=v(a,n,"left");S=v(a,n,"right");L=!a._anchorAxis||t!==n._mainSubplot;if(L&&a.ticks&&a.mirror==="allticks"){a._linepositions[t]=[T,S]}B=D(a,P,O);if(L&&a.showline&&(a.mirror==="all"||a.mirror==="allticks")){B+=P(T)+P(S)}r.ylines.style("stroke-width",a._lw+"px").call(l.stroke,a.showline?a.linecolor:"rgba(0,0,0,0)")}r.ylines.attr("d",B)});h.makeClipPaths(t);r.drawMainTitle(t);f.manage(t);return t._promises.length&&Promise.all(t._promises)}function b(t,e){var r=e._subplots;var n=r.cartesian.concat(r.gl2d||[]);var a={_fullLayout:e};var i=t._id.charAt(0)==="x";var o=t._mainAxis._anchorAxis;var s="";var l="";var u="";if(o){u=o._mainAxis._id;s=i?t._id+u:u+t._id}if(!s||!e._plots[s]){s="";for(var c=0;c<n.length;c++){var f=n[c];var p=f.indexOf("y");var d=i?f.substr(0,p):f.substr(p);var v=i?f.substr(p):f.substr(0,p);if(d===t._id){if(!l)l=f;var g=h.getFromId(a,v);if(u&&g.overlaying===u){s=f;break}}}}return s||l}function _(t,e){return(t.ticks||t.showline)&&(e===t._mainSubplot||t.mirror==="all"||t.mirror==="allticks")}function w(t,e,r){if(!r.showline||!r._lw)return false;if(r.mirror==="all"||r.mirror==="allticks")return true;var n=r._anchorAxis;if(!n)return false;var a=p.FROM_BL[e];if(r.side===e){return n.domain[a]===t.domain[a]}return r.mirror&&n.domain[1-a]===t.domain[1-a]}function k(t,e,r,n){if(w(t,e,r)){return r._lw}for(var a=0;a<n.length;a++){var i=n[a];if(i._mainAxis===r._mainAxis&&w(t,e,i)){return i._lw}}return 0}r.drawMainTitle=function(t){var e=t._fullLayout;c.draw(t,"gtitle",{propContainer:e,propName:"title",placeholder:e._dfltTitle.plot,attributes:{x:e.width/2,y:e._size.t/2,"text-anchor":"middle"}})};r.doTraceStyle=function(t){for(var e=0;e<t.calcdata.length;e++){var r=t.calcdata[e],n=((r[0]||{}).trace||{})._module||{},o=n.arraysToCalcdata;if(o)o(r,r[0].trace)}i.style(t);a.getComponentMethod("legend","draw")(t);return i.previousPromises(t)};r.doColorBars=function(t){for(var e=0;e<t.calcdata.length;e++){var r=t.calcdata[e][0];if((r.t||{}).cb){var n=r.trace,o=r.t.cb;if(a.traceIs(n,"contour")){o.line({width:n.contours.showlines!==false?n.line.width:0,dash:n.line.dash,color:n.contours.coloring==="line"?o._opts.line.color:n.line.color})}var s=n._module.colorbar;var l=s.container;var u=(l?n[l]:n).colorbar;o.options(u)()}}return i.previousPromises(t)};r.layoutReplot=function(t){var e=t.layout;t.layout=undefined;return a.call("plot",t,"",e)};r.doLegend=function(t){a.getComponentMethod("legend","draw")(t);return i.previousPromises(t)};r.doTicksRelayout=function(t,e){if(e){h.doTicks(t,Object.keys(e),true)}else{h.doTicks(t,"redraw")}if(t._fullLayout._hasOnlyLargeSploms){s(t);a.subplotsRegistry.splom.plot(t)}r.drawMainTitle(t);return i.previousPromises(t)};r.doModeBar=function(t){var e=t._fullLayout;f.manage(t);for(var r=0;r<e._basePlotModules.length;r++){var n=e._basePlotModules[r].updateFx;if(n)n(e)}return i.previousPromises(t)};r.doCamera=function(t){var e=t._fullLayout;var r=e._subplots.gl3d;for(var n=0;n<r.length;n++){var a=e[r[n]];var i=a._scene;i.setCamera(a.camera)}};r.drawData=function(t){var e=t._fullLayout;var r=t.calcdata;var n;for(n=0;n<r.length;n++){var o=r[n][0].trace;if(o.visible!==true||!o._module.colorbar){e._infolayer.select(".cb"+o.uid).remove()}}s(t);var l=e._basePlotModules;for(n=0;n<l.length;n++){l[n].plot(t)}i.style(t);a.getComponentMethod("shapes","draw")(t);a.getComponentMethod("annotations","draw")(t);e._replotting=false;return i.previousPromises(t)};r.doAutoRangeAndConstraints=function(t){var e=h.list(t,"",true);for(var r=0;r<e.length;r++){var n=e[r];g(t,n);m(n)}v(t)};r.finalDraw=function(t){a.getComponentMethod("shapes","draw")(t);a.getComponentMethod("images","draw")(t);a.getComponentMethod("annotations","draw")(t);a.getComponentMethod("rangeslider","draw")(t);a.getComponentMethod("rangeselector","draw")(t)};r.drawMarginPushers=function(t){a.getComponentMethod("legend","draw")(t);a.getComponentMethod("rangeselector","draw")(t);a.getComponentMethod("sliders","draw")(t);a.getComponentMethod("updatemenus","draw")(t)}},{"../components/color":558,"../components/drawing":583,"../components/modebar":621,"../components/titles":649,"../constants/alignment":656,"../lib":684,"../lib/clear_gl_canvases":668,"../plots/cartesian/autorange":731,"../plots/cartesian/axes":732,"../plots/cartesian/constraints":739,"../plots/plots":795,"../registry":817,d3:147}],724:[function(t,e,r){"use strict";var n=t("../lib");var a=n.isPlainObject;var i=t("./plot_schema");var o=t("../plots/plots");var s=t("../plots/attributes");var l=t("./plot_template");var u=t("./plot_config");r.makeTemplate=function(t){t=n.extendDeep({_context:u},t);o.supplyDefaults(t);var e=t.data||[];var r=t.layout||{};r._basePlotModules=t._fullLayout._basePlotModules;r._modules=t._fullLayout._modules;var i={data:{},layout:{}};e.forEach(function(t){var e={};h(t,e,d.bind(null,t));var r=n.coerce(t,{},s,"type");var a=i.data[r];if(!a)a=i.data[r]=[];a.push(e)});h(r,i.layout,p.bind(null,r));delete i.layout.template;var l=r.template;if(a(l)){var f=l.layout;var v,g,m,y,x,b;if(a(f)){c(f,i.layout)}var _=l.data;if(a(_)){for(g in i.data){m=_[g];if(Array.isArray(m)){x=i.data[g];b=x.length;y=m.length;for(v=0;v<b;v++){c(m[v%y],x[v])}for(v=b;v<y;v++){x.push(n.extendDeep({},m[v]))}}}for(g in _){if(!(g in i.data)){i.data[g]=n.extendDeep([],_[g])}}}}return i};function c(t,e){t=n.extendDeep({},t);var r=Object.keys(t).sort();var i,o;function s(e,r,n){if(a(r)&&a(e)){c(e,r)}else if(Array.isArray(r)&&Array.isArray(e)){var i=l.arrayTemplater({_template:t},n);for(o=0;o<r.length;o++){var s=r[o];var u=i.newItem(s)._template;if(u)c(u,s)}var f=i.defaultItems();for(o=0;o<f.length;o++)r.push(f[o]._template);for(o=0;o<r.length;o++)delete r[o].templateitemname}}for(i=0;i<r.length;i++){var u=r[i];var h=t[u];if(u in e){s(h,e[u],u)}else e[u]=h;if(f(u)===u){for(var p in e){var d=f(p);if(p!==d&&d===u&&!(p in t)){s(h,e[p],u)}}}}}function f(t){return t.replace(/[0-9]+$/,"")}function h(t,e,r,i,o){var s=o&&r(o);for(var u in t){var c=t[u];var p=v(t,u,i);var d=v(t,u,o);var g=r(d);if(!g){var m=f(u);if(m!==u){d=v(t,m,o);g=r(d)}}if(s&&s===g)continue;if(!g||g._noTemplating||g.valType==="data_array"||g.arrayOk&&Array.isArray(c)){continue}if(!g.valType&&a(c)){h(c,e,r,p,d)}else if(g._isLinkedToArray&&Array.isArray(c)){var y=false;var x=0;var b={};for(var _=0;_<c.length;_++){var w=c[_];if(a(w)){var k=w.name;if(k){if(!b[k]){h(w,e,r,v(c,x,p),v(c,x,d));x++;b[k]=1}}else if(!y){var M=l.arrayDefaultKey(u);var A=v(t,M,i);var T=v(c,x,p);h(w,e,r,T,v(c,x,d));var S=n.nestedProperty(e,T);var E=n.nestedProperty(e,A);E.set(S.get());S.set(null);y=true}}}}else{var C=n.nestedProperty(e,p);C.set(c)}}}function p(t,e){return i.getLayoutValObject(t,n.nestedProperty({},e).parts)}function d(t,e){return i.getTraceValObject(t,n.nestedProperty({},e).parts)}function v(t,e,r){var n;if(!r)n=e;else if(Array.isArray(t))n=r+"["+e+"]";else n=r+"."+e;return n}r.validateTemplate=function(t,e){var r=n.extendDeep({},{_context:u,data:t.data,layout:t.layout});var i=r.layout||{};if(!a(e))e=i.template||{};var s=e.layout;var l=e.data;var c=[];r.layout=i;r.layout.template=e;o.supplyDefaults(r);var h=r._fullLayout;var p=r._fullData;var d={};function y(t,e){for(var r in t){if(r.charAt(0)!=="_"&&a(t[r])){var n=f(r);var i=[];var o;for(o=0;o<e.length;o++){i.push(v(t,r,e[o]));if(n!==r)i.push(v(t,n,e[o]))}for(o=0;o<i.length;o++){d[i[o]]=1}y(t[r],i)}}}function x(t,e){for(var r in t){if(r.indexOf("defaults")===-1&&a(t[r])){var n=v(t,r,e);if(d[n]){x(t[r],n)}else{c.push({code:"unused",path:n})}}}}if(!a(s)){c.push({code:"layout"})}else{y(h,["layout"]);x(s,"layout")}if(!a(l)){c.push({code:"data"})}else{var b={};var _;for(var w=0;w<p.length;w++){var k=p[w];_=k.type;b[_]=(b[_]||0)+1;if(!k._fullInput._template){c.push({code:"missing",index:k._fullInput.index,traceType:_})}}for(_ in l){var M=l[_].length;var A=b[_]||0;if(M>A){c.push({code:"unused",traceType:_,templateCount:M,dataCount:A})}else if(A>M){c.push({code:"reused",traceType:_,templateCount:M,dataCount:A})}}}function T(t,e){for(var r in t){if(r.charAt(0)==="_")continue;var n=t[r];var i=v(t,r,e);if(a(n)){if(Array.isArray(t)&&n._template===false&&n.templateitemname){c.push({code:"missing",path:i,templateitemname:n.templateitemname})}T(n,i)}else if(Array.isArray(n)&&g(n)){T(n,i)}}}T({data:p,layout:h},"");if(c.length)return c.map(m)};function g(t){for(var e=0;e<t.length;e++){if(a(t[e]))return true}}function m(t){var e;switch(t.code){case"data":e="The template has no key data.";break;case"layout":e="The template has no key layout.";break;case"missing":if(t.path){e="There are no templates for item "+t.path+" with name "+t.templateitemname}else{e="There are no templates for trace "+t.index+", of type "+t.traceType+"."}break;case"unused":if(t.path){e="The template item at "+t.path+" was not used in constructing the plot."}else if(t.dataCount){e="Some of the templates of type "+t.traceType+" were not used. The template has "+t.templateCount+" traces, the data only has "+t.dataCount+" of this type."}else{e="The template has "+t.templateCount+" traces of type "+t.traceType+" but there are none in the data."}break;case"reused":e="Some of the templates of type "+t.traceType+" were used more than once. The template has "+t.templateCount+" traces, the data has "+t.dataCount+" of this type.";break}t.msg=e;return t}},{"../lib":684,"../plots/attributes":729,"../plots/plots":795,"./plot_config":720,"./plot_schema":721,"./plot_template":722}],725:[function(t,e,r){"use strict";var n=t("./plot_api");var a=t("../lib");var i=t("../snapshot/helpers");var o=t("../snapshot/tosvg");var s=t("../snapshot/svgtoimg");var l={format:{valType:"enumerated",values:["png","jpeg","webp","svg"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:false},imageDataOnly:{valType:"boolean",dflt:false}};var u=/^data:image\/\w+;base64,/;function c(t,e){e=e||{};var r;var c;var f;if(a.isPlainObject(t)){r=t.data||[];c=t.layout||{};f=t.config||{}}else{t=a.getGraphDiv(t);r=a.extendDeep([],t.data);c=a.extendDeep({},t.layout);f=t._context}function h(t){return!(t in e)||a.validate(e[t],l[t])}if(!h("width")||!h("height")){throw new Error("Height and width should be pixel values.")}if(!h("format")){throw new Error("Image format is not jpeg, png, svg or webp.")}var p={};function d(t,r){return a.coerce(e,p,l,t,r)}var v=d("format");var g=d("width");var m=d("height");var y=d("scale");var x=d("setBackground");var b=d("imageDataOnly");var _=document.createElement("div");_.style.position="absolute";_.style.left="-5000px";document.body.appendChild(_);var w=a.extendFlat({},c);if(g)w.width=g;if(m)w.height=m;var k=a.extendFlat({},f,{staticPlot:true,setBackground:x});var M=i.getRedrawFunc(_);function A(){return new Promise(function(t){setTimeout(t,i.getDelay(_._fullLayout))})}function T(){return new Promise(function(t,e){var r=o(_,v,y);var i=_._fullLayout.width;var l=_._fullLayout.height;n.purge(_);document.body.removeChild(_);if(v==="svg"){if(b){return t(r)}else{return t("data:image/svg+xml,"+encodeURIComponent(r))}}var u=document.createElement("canvas");u.id=a.randstr();s({format:v,width:i,height:l,scale:y,canvas:u,svg:r,promise:true}).then(t).catch(e)})}function S(t){if(b){return t.replace(u,"")}else{return t}}return new Promise(function(t,e){n.plot(_,r,w,k).then(M).then(A).then(T).then(function(e){t(S(e))}).catch(function(t){e(t)})})}e.exports=c},{"../lib":684,"../snapshot/helpers":821,"../snapshot/svgtoimg":823,"../snapshot/tosvg":825,"./plot_api":719}],726:[function(t,e,r){"use strict";var n=t("../lib");var a=t("../plots/plots");var i=t("./plot_schema");var o=t("./plot_config");var s=n.isPlainObject;var l=Array.isArray;var u=n.isArrayOrTypedArray;e.exports=function t(e,r){var u=i.get();var h=[];var p={_context:n.extendFlat({},o)};var v,g;if(l(e)){p.data=n.extendDeep([],e);v=e}else{p.data=[];v=[];h.push(d("array","data"))}if(s(r)){p.layout=n.extendDeep({},r);g=r}else{p.layout={};g={};if(arguments.length>1){h.push(d("object","layout"))}}a.supplyDefaults(p);var m=p._fullData,y=v.length;for(var x=0;x<y;x++){var b=v[x],_=["data",x];if(!s(b)){h.push(d("object",_));continue}var w=m[x],k=w.type,M=u.traces[k].attributes;M.type={valType:"enumerated",values:[k]};if(w.visible===false&&b.visible!==false){h.push(d("invisible",_))}c(b,w,M,h,_);var A=b.transforms,T=w.transforms;if(A){if(!l(A)){h.push(d("array",_,["transforms"]))}_.push("transforms");for(var S=0;S<A.length;S++){var E=["transforms",S],C=A[S].type;if(!s(A[S])){h.push(d("object",_,E));continue}var L=u.transforms[C]?u.transforms[C].attributes:{};L.type={valType:"enumerated",values:Object.keys(u.transforms)};c(A[S],T[S],L,h,_,E)}}}var I=p._fullLayout,z=f(u,m);c(g,I,z,h,"layout");return h.length===0?void 0:h};function c(t,e,r,a,i,o){o=o||[];var f=Object.keys(t);for(var h=0;h<f.length;h++){var p=f[h];if(p==="transforms")continue;var m=o.slice();m.push(p);var y=t[p],x=e[p];var b=g(r,p);var _=(b||{}).valType==="info_array";var w=(b||{}).valType==="colorscale";var k=(b||{}).items;if(!v(r,p)){a.push(d("schema",i,m))}else if(s(y)&&s(x)){c(y,x,b,a,i,m)}else if(_&&l(y)){if(y.length>x.length){a.push(d("unused",i,m.concat(x.length)))}var M=x.length;var A=Array.isArray(k);if(A)M=Math.min(M,k.length);var T,S,E,C,L;if(b.dimensions===2){for(S=0;S<M;S++){if(l(y[S])){if(y[S].length>x[S].length){a.push(d("unused",i,m.concat(S,x[S].length)))}var I=x[S].length;for(T=0;T<(A?Math.min(I,k[S].length):I);T++){E=A?k[S][T]:k;C=y[S][T];L=x[S][T];if(!n.validate(C,E)){a.push(d("value",i,m.concat(S,T),C))}else if(L!==C&&L!==+C){a.push(d("dynamic",i,m.concat(S,T),C,L))}}}else{a.push(d("array",i,m.concat(S),y[S]))}}}else{for(S=0;S<M;S++){E=A?k[S]:k;C=y[S];L=x[S];if(!n.validate(C,E)){a.push(d("value",i,m.concat(S),C))}else if(L!==C&&L!==+C){a.push(d("dynamic",i,m.concat(S),C,L))}}}}else if(b.items&&!_&&l(y)){var z=k[Object.keys(k)[0]],P=[];var O,D;for(O=0;O<x.length;O++){var R=x[O]._index||O;D=m.slice();D.push(R);if(s(y[R])&&s(x[O])){P.push(R);var B=y[R];var F=x[O];if(s(B)&&B.visible!==false&&F.visible===false){a.push(d("invisible",i,D))}else c(B,F,z,a,i,D)}}for(O=0;O<y.length;O++){D=m.slice();D.push(O);if(!s(y[O])){a.push(d("object",i,D,y[O]))}else if(P.indexOf(O)===-1){a.push(d("unused",i,D))}}}else if(!s(y)&&s(x)){a.push(d("object",i,m,y))}else if(!u(y)&&u(x)&&!_&&!w){a.push(d("array",i,m,y))}else if(!(p in e)){a.push(d("unused",i,m,y))}else if(!n.validate(y,b)){a.push(d("value",i,m,y))}else if(b.valType==="enumerated"&&(b.coerceNumber&&y!==+x||y!==x)){a.push(d("dynamic",i,m,y,x))}}return a}function f(t,e){for(var r=0;r<e.length;r++){var a=e[r].type,i=t.traces[a].layoutAttributes;if(i){n.extendFlat(t.layout.layoutAttributes,i)}}return t.layout.layoutAttributes}var h={object:function(t,e){var r;if(t==="layout"&&e==="")r="The layout argument";else if(t[0]==="data"&&e===""){r="Trace "+t[1]+" in the data argument"}else r=p(t)+"key "+e;return r+" must be linked to an object container"},array:function(t,e){var r;if(t==="data")r="The data argument";else r=p(t)+"key "+e;return r+" must be linked to an array container"},schema:function(t,e){return p(t)+"key "+e+" is not part of the schema"},unused:function(t,e,r){var n=s(r)?"container":"key";return p(t)+n+" "+e+" did not get coerced"},dynamic:function(t,e,r,n){return[p(t)+"key",e,"(set to '"+r+"')","got reset to","'"+n+"'","during defaults."].join(" ")},invisible:function(t,e){return(e?p(t)+"item "+e:"Trace "+t[1])+" got defaulted to be not visible"},value:function(t,e,r){return[p(t)+"key "+e,"is set to an invalid value ("+r+")"].join(" ")}};function p(t){if(l(t))return"In data trace "+t[1]+", ";return"In "+t+", "}function d(t,e,r,a,i){r=r||"";var o,s;if(l(e)){o=e[0];s=e[1]}else{o=e;s=null}var u=x(r);var c=h[t](e,u,a,i);n.log(c);return{code:t,container:o,trace:s,path:r,astr:u,msg:c}}function v(t,e){var r=y(e),n=r.keyMinusId,a=r.id;if(n in t&&t[n]._isSubplotObj&&a){return true}return e in t}function g(t,e){if(e in t)return t[e];var r=y(e);return t[r.keyMinusId]}var m=n.counterRegex("([a-z]+)");function y(t){var e=t.match(m);return{keyMinusId:e&&e[1],id:e&&e[2]}}function x(t){if(!l(t))return String(t);var e="";for(var r=0;r<t.length;r++){var n=t[r];if(typeof n==="number"){e=e.substr(0,e.length-1)+"["+n+"]"}else{e+=n}if(r<t.length-1)e+="."}return e}},{"../lib":684,"../plots/plots":795,"./plot_config":720,"./plot_schema":721}],727:[function(t,e,r){"use strict";e.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:false},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:true}},transition:{duration:{valType:"number",min:0,dflt:500},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"]}}}},{}],728:[function(t,e,r){"use strict";var n=t("../lib");var a=t("../plot_api/plot_template");e.exports=function t(e,r,i){var o=i.name;var s=i.inclusionAttr||"visible";var l=r[o];var u=n.isArrayOrTypedArray(e[o])?e[o]:[];var c=r[o]=[];var f=a.arrayTemplater(r,o,s);var h,p;for(h=0;h<u.length;h++){var d=u[h];if(!n.isPlainObject(d)){p=f.newItem({});p[s]=false}else{p=f.newItem(d)}p._index=h;if(p[s]!==false){i.handleItemDefaults(d,p,r,i)}c.push(p)}var v=f.defaultItems();for(h=0;h<v.length;h++){p=v[h];p._index=c.length;i.handleItemDefaults({},p,r,i,{});c.push(p)}if(n.isArrayOrTypedArray(l)){var g=Math.min(l.length,c.length);for(h=0;h<g;h++){n.relinkPrivateKeys(c[h],l[h])}}return c}},{"../lib":684,"../plot_api/plot_template":722}],729:[function(t,e,r){"use strict";var n=t("../components/fx/attributes");e.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:true},visible:{valType:"enumerated",values:[true,false,"legendonly"],dflt:true,editType:"calc"},showlegend:{valType:"boolean",dflt:true,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot"},ids:{valType:"data_array",editType:"calc"},customdata:{valType:"data_array",editType:"calc"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:true,dflt:"all",editType:"none"},hoverlabel:n.hoverlabel,stream:{token:{valType:"string",noBlank:true,strict:true,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"}}},{"../components/fx/attributes":592}],730:[function(t,e,r){"use strict";e.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],731:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib");var i=t("../../constants/numerical").FP_SAFE;e.exports={getAutoRange:o,makePadFn:s,doAutoRange:l,expand:c};function o(t){var e=[];var r=t._min[0].val;var n=t._max[0].val;var i=0;var o=false;var l=s(t);var u,c,f,h,p,d,v,g;for(u=1;u<t._min.length;u++){if(r!==n)break;r=Math.min(r,t._min[u].val)}for(u=1;u<t._max.length;u++){if(r!==n)break;n=Math.max(n,t._max[u].val)}if(t.range){var m=a.simpleMap(t.range,t.r2l);o=m[1]<m[0]}if(t.autorange==="reversed"){o=true;t.autorange=true}for(u=0;u<t._min.length;u++){f=t._min[u];for(c=0;c<t._max.length;c++){h=t._max[c];g=h.val-f.val;v=t._length-l(f)-l(h);if(g>0&&v>0&&g/v>i){p=f;d=h;i=g/v}}}if(r===n){var y=r-1;var x=r+1;if(t.rangemode==="tozero"){e=r<0?[y,0]:[0,x]}else if(t.rangemode==="nonnegative"){e=[Math.max(0,y),Math.max(0,x)]}else{e=[y,x]}}else if(i){if(t.type==="linear"||t.type==="-"){if(t.rangemode==="tozero"){if(p.val>=0){p={val:0,pad:0}}if(d.val<=0){d={val:0,pad:0}}}else if(t.rangemode==="nonnegative"){if(p.val-i*l(p)<0){p={val:0,pad:0}}if(d.val<0){d={val:1,pad:0}}}i=(d.val-p.val)/(t._length-l(p)-l(d))}e=[p.val-i*l(p),d.val+i*l(d)]}if(e[0]===e[1]){if(t.rangemode==="tozero"){if(e[0]<0){e=[e[0],0]}else if(e[0]>0){e=[0,e[0]]}else{e=[0,1]}}else{e=[e[0]-1,e[0]+1];if(t.rangemode==="nonnegative"){e[0]=Math.max(0,e[0])}}}if(o)e.reverse();return a.simpleMap(e,t.l2r||Number)}function s(t){var e=t._length/20;if(t.constrain==="domain"&&t._inputDomain){e*=(t._inputDomain[1]-t._inputDomain[0])/(t.domain[1]-t.domain[0])}return function t(r){return r.pad+(r.extrapad?e:0)}}function l(t){if(!t._length)t.setScale();var e=t._min&&t._max&&t._min.length&&t._max.length;var r;if(t.autorange&&e){t.range=o(t);t._r=t.range.slice();t._rl=a.simpleMap(t._r,t.r2l);r=t._input;r.range=t.range.slice();r.autorange=t.autorange}if(t._anchorAxis&&t._anchorAxis.rangeslider){var n=t._anchorAxis.rangeslider[t._name];if(n){if(n.rangemode==="auto"){if(e){n.range=o(t)}else{n.range=t._rangeInitial?t._rangeInitial.slice():t.range.slice()}}}r=t._anchorAxis._input;r.rangeslider[t._name]=a.extendFlat({},n)}}function u(t){return t.autorange||t._rangesliderAutorange}function c(t,e,r){if(!u(t)||!e)return;if(!t._min)t._min=[];if(!t._max)t._max=[];if(!r)r={};if(!t._m)t.setScale();var a=e.length;var o=r.padded||false;var s=r.tozero&&(t.type==="linear"||t.type==="-");var l=t.type==="log";var c,d,v,g,m,y,x,b,_,w,k,M;var A=false;function T(t){if(Array.isArray(t)){A=true;return function(e){return Math.max(Number(t[e]||0),0)}}else{var e=Math.max(Number(t||0),0);return function(){return e}}}var S=T((t._m>0?r.ppadplus:r.ppadminus)||r.ppad||0);var E=T((t._m>0?r.ppadminus:r.ppadplus)||r.ppad||0);var C=T(r.vpadplus||r.vpad);var L=T(r.vpadminus||r.vpad);if(!A){k=Infinity;M=-Infinity;if(l){for(c=0;c<a;c++){g=e[c];if(g<k&&g>0)k=g;if(g>M&&g<i)M=g}}else{for(c=0;c<a;c++){g=e[c];if(g<k&&g>-i)k=g;if(g>M&&g<i)M=g}}e=[k,M];a=2}function I(r){m=e[r];if(!n(m))return;b=S(r);_=E(r);k=m-L(r);M=m+C(r);if(l&&k<M/10)k=M/10;y=t.c2l(k);x=t.c2l(M);if(s){y=Math.min(0,y);x=Math.max(0,x)}for(v=0;v<2;v++){var a=v?x:y;if(f(a)){var i=v?t._max:t._min;var u=v?b:_;var c=v?p:h;w=true;for(d=0;d<i.length&&w;d++){g=i[d];if(c(g.val,a)&&g.pad>=u&&(g.extrapad||!o)){w=false;break}else if(c(a,g.val)&&g.pad<=u&&(o||!g.extrapad)){i.splice(d,1);d--}}if(w){var A=s&&a===0;i.push({val:a,pad:A?0:u,extrapad:A?false:o})}}}}var z=Math.min(6,a);for(c=0;c<z;c++)I(c);for(c=a-1;c>=z;c--)I(c)}function f(t){return n(t)&&Math.abs(t)<i}function h(t,e){return t<=e}function p(t,e){return t>=e}},{"../../constants/numerical":661,"../../lib":684,"fast-isnumeric":214}],732:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("../../plots/plots");var o=t("../../registry");var s=t("../../lib");var l=t("../../lib/svg_text_utils");var u=t("../../components/titles");var c=t("../../components/color");var f=t("../../components/drawing");var h=t("../../constants/numerical");var p=h.ONEAVGYEAR;var d=h.ONEAVGMONTH;var v=h.ONEDAY;var g=h.ONEHOUR;var m=h.ONEMIN;var y=h.ONESEC;var x=h.MINUS_SIGN;var b=h.BADNUM;var _=t("../../constants/alignment").MID_SHIFT;var w=t("../../constants/alignment").LINE_SPACING;var k=e.exports={};k.setConvert=t("./set_convert");var M=t("./axis_autotype");var A=t("./axis_ids");k.id2name=A.id2name;k.name2id=A.name2id;k.cleanId=A.cleanId;k.list=A.list;k.listIds=A.listIds;k.getFromId=A.getFromId;k.getFromTrace=A.getFromTrace;var T=t("./autorange");k.expand=T.expand;k.getAutoRange=T.getAutoRange;k.coerceRef=function(t,e,r,n,a,i){var o=n.charAt(n.length-1);var l=r._fullLayout._subplots[o+"axis"];var u=n+"ref";var c={};if(!a)a=l[0]||i;if(!i)i=a;c[u]={valType:"enumerated",values:l.concat(i?[i]:[]),dflt:a};return s.coerce(t,e,c,u)};k.coercePosition=function(t,e,r,n,a,i){var o,l;if(n==="paper"||n==="pixel"){o=s.ensureNumber;l=r(a,i)}else{var u=k.getFromId(e,n);i=u.fraction2r(i);l=r(a,i);o=u.cleanPos}t[a]=o(l)};k.cleanPosition=function(t,e,r){var n=r==="paper"||r==="pixel"?s.ensureNumber:k.getFromId(e,r).cleanPos;return n(t)};var S=k.getDataConversions=function(t,e,r,n){var a;var i=r==="x"||r==="y"||r==="z"?r:n;if(Array.isArray(i)){a={type:M(n),_categories:[]};k.setConvert(a);if(a.type==="category"){for(var o=0;o<n.length;o++){a.d2c(n[o])}}}else{a=k.getFromTrace(t,e,i)}if(a)return{d2c:a.d2c,c2d:a.c2d};if(i==="ids")return{d2c:C,c2d:C};return{d2c:E,c2d:E}};function E(t){return+t}function C(t){return String(t)}k.getDataToCoordFunc=function(t,e,r,n){return S(t,e,r,n).d2c};k.counterLetter=function(t){var e=t.charAt(0);if(e==="x")return"y";if(e==="y")return"x"};k.minDtick=function(t,e,r,n){if(["log","category"].indexOf(t.type)!==-1||!n){t._minDtick=0}else if(t._minDtick===undefined){t._minDtick=e;t._forceTick0=r}else if(t._minDtick){if((t._minDtick/e+1e-6)%1<2e-6&&((r-t._forceTick0)/e%1+1.000001)%1<2e-6){t._minDtick=e;t._forceTick0=r}else if((e/t._minDtick+1e-6)%1>2e-6||((r-t._forceTick0)/t._minDtick%1+1.000001)%1>2e-6){t._minDtick=0}}};k.saveRangeInitial=function(t,e){var r=k.list(t,"",true),n=false;for(var a=0;a<r.length;a++){var i=r[a];var o=i._rangeInitial===undefined;var s=o||!(i.range[0]===i._rangeInitial[0]&&i.range[1]===i._rangeInitial[1]);if(o&&i.autorange===false||e&&s){i._rangeInitial=i.range.slice();n=true}}return n};k.saveShowSpikeInitial=function(t,e){var r=k.list(t,"",true),n=false,a="on";for(var i=0;i<r.length;i++){var o=r[i];var s=o._showSpikeInitial===undefined;var l=s||!(o.showspikes===o._showspikes);if(s||e&&l){o._showSpikeInitial=o.showspikes;n=true}if(a==="on"&&!o.showspikes){a="off"}}t._fullLayout._cartesianSpikesEnabled=a;return n};k.autoBin=function(t,e,r,n,i){var o=s.aggNums(Math.min,null,t),l=s.aggNums(Math.max,null,t);if(!i)i=e.calendar;if(e.type==="category"){return{start:o-.5,end:l+.5,size:1,_dataSpan:l-o}}var u;if(r)u=(l-o)/r;else{var c=s.distinctVals(t),f=Math.pow(10,Math.floor(Math.log(c.minDiff)/Math.LN10)),h=f*s.roundUp(c.minDiff/f,[.9,1.9,4.9,9.9],true);u=Math.max(h,2*s.stdev(t)/Math.pow(t.length,n?.25:.4));if(!a(u))u=1}var p;if(e.type==="log"){p={type:"linear",range:[o,l]}}else{p={type:e.type,range:s.simpleMap([o,l],e.c2r,0,i),calendar:i}}k.setConvert(p);k.autoTicks(p,u);var d=k.tickIncrement(k.tickFirst(p),p.dtick,"reverse",i);var v,g;if(typeof p.dtick==="number"){d=L(d,t,p,o,l);g=1+Math.floor((l-d)/p.dtick);v=d+g*p.dtick}else{if(p.dtick.charAt(0)==="M"){d=I(d,t,p.dtick,o,i)}v=d;g=0;while(v<=l){v=k.tickIncrement(v,p.dtick,false,i);g++}}return{start:e.c2r(d,0,i),end:e.c2r(v,0,i),size:p.dtick,_dataSpan:l-o}};function L(t,e,r,n,i){var o=0,s=0,l=0,u=0;function c(e){return(1+(e-t)*100/r.dtick)%100<2}for(var f=0;f<e.length;f++){if(e[f]%1===0)l++;else if(!a(e[f]))u++;if(c(e[f]))o++;if(c(e[f]+r.dtick/2))s++}var h=e.length-u;if(l===h&&r.type!=="date"){if(r.dtick<1){t=n-.5*r.dtick}else{t-=.5;if(t+r.dtick<n)t+=r.dtick}}else if(s<h*.1){if(o>h*.3||c(n)||c(i)){var p=r.dtick/2;t+=t+p<n?p:-p}}return t}function I(t,e,r,n,a){var i=s.findExactDates(e,a);var o=.8;if(i.exactDays>o){var l=Number(r.substr(1));if(i.exactYears>o&&l%12===0){t=k.tickIncrement(t,"M6","reverse")+v*1.5}else if(i.exactMonths>o){t=k.tickIncrement(t,"M1","reverse")+v*15.5}else{t-=v/2}var u=k.tickIncrement(t,r);if(u<=n)return u}return t}k.prepTicks=function(t){var e=s.simpleMap(t.range,t.r2l);if(t.tickmode==="auto"||!t.dtick){var r=t.nticks,n;if(!r){if(t.type==="category"){n=t.tickfont?(t.tickfont.size||12)*1.2:15;r=t._length/n}else{n=t._id.charAt(0)==="y"?40:80;r=s.constrain(t._length/n,4,9)+1}if(t._name==="radialaxis")r*=2}if(t.tickmode==="array")r*=100;k.autoTicks(t,Math.abs(e[1]-e[0])/r);if(t._minDtick>0&&t.dtick<t._minDtick*2){t.dtick=t._minDtick;t.tick0=t.l2r(t._forceTick0)}}if(!t.tick0){t.tick0=t.type==="date"?"2000-01-01":0}V(t)};k.calcTicks=function t(e){k.prepTicks(e);var r=s.simpleMap(e.range,e.r2l);if(e.tickmode==="array")return z(e);e._tmin=k.tickFirst(e);var n=r[0]*1.0001-r[1]*1e-4;var a=r[1]*1.0001-r[0]*1e-4;var i=r[1]<r[0];if(e._tmin<n!==i)return[];var o=[];if(e.type==="category"){a=i?Math.max(-.5,a):Math.min(e._categories.length-.5,a)}var l=null;var u=Math.max(1e3,e._length||0);for(var c=e._tmin;i?c>=a:c<=a;c=k.tickIncrement(c,e.dtick,i,e.calendar)){if(o.length>u||c===l)break;l=c;o.push(c)}if(e._id==="angular"&&Math.abs(r[1]-r[0])===360){o.pop()}e._tmax=o[o.length-1];e._prevDateHead="";e._inCalcTicks=true;var f=new Array(o.length);for(var h=0;h<o.length;h++)f[h]=k.tickText(e,o[h]);e._inCalcTicks=false;return f};function z(t){var e=t.tickvals,r=t.ticktext,n=new Array(e.length),a=s.simpleMap(t.range,t.r2l),i=a[0]*1.0001-a[1]*1e-4,o=a[1]*1.0001-a[0]*1e-4,l=Math.min(i,o),u=Math.max(i,o),c,f,h=0;if(!Array.isArray(r))r=[];var p=t.type==="category"?t.d2l_noadd:t.d2l;if(t.type==="log"&&String(t.dtick).charAt(0)!=="L"){t.dtick="L"+Math.pow(10,Math.floor(Math.min(t.range[0],t.range[1]))-1)}for(f=0;f<e.length;f++){c=p(e[f]);if(c>l&&c<u){if(r[f]===undefined)n[h]=k.tickText(t,c);else n[h]=U(t,c,String(r[f]));h++}}if(h<e.length)n.splice(h,e.length-h);return n}var P=[2,5,10],O=[1,2,3,6,12],D=[1,2,5,10,15,30],R=[1,2,3,7,14],B=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],F=[-.301,0,.301,.699,1],N=[15,30,45,90,180];function j(t,e,r){return e*s.roundUp(t/e,r)}k.autoTicks=function(t,e){var r;function n(t){return Math.pow(t,Math.floor(Math.log(e)/Math.LN10))}if(t.type==="date"){t.tick0=s.dateTick0(t.calendar);var i=2*e;if(i>p){e/=p;r=n(10);t.dtick="M"+12*j(e,r,P)}else if(i>d){e/=d;t.dtick="M"+j(e,1,O)}else if(i>v){t.dtick=j(e,v,R);t.tick0=s.dateTick0(t.calendar,true)}else if(i>g){t.dtick=j(e,g,O)}else if(i>m){t.dtick=j(e,m,D)}else if(i>y){t.dtick=j(e,y,D)}else{r=n(10);t.dtick=j(e,r,P)}}else if(t.type==="log"){t.tick0=0;var o=s.simpleMap(t.range,t.r2l);if(e>.7){t.dtick=Math.ceil(e)}else if(Math.abs(o[1]-o[0])<1){var l=1.5*Math.abs((o[1]-o[0])/e);e=Math.abs(Math.pow(10,o[1])-Math.pow(10,o[0]))/l;r=n(10);t.dtick="L"+j(e,r,P)}else{t.dtick=e>.3?"D2":"D1"}}else if(t.type==="category"){t.tick0=0;t.dtick=Math.ceil(Math.max(e,1))}else if(t._id==="angular"){t.tick0=0;r=1;t.dtick=j(e,r,N)}else{t.tick0=0;r=n(10);t.dtick=j(e,r,P)}if(t.dtick===0)t.dtick=1;if(!a(t.dtick)&&typeof t.dtick!=="string"){var u=t.dtick;t.dtick=1;throw"ax.dtick error: "+String(u)}};function V(t){var e=t.dtick;t._tickexponent=0;if(!a(e)&&typeof e!=="string"){e=1}if(t.type==="category"){t._tickround=null}if(t.type==="date"){var r=t.r2l(t.tick0),n=t.l2r(r).replace(/(^-|i)/g,""),i=n.length;if(String(e).charAt(0)==="M"){if(i>10||n.substr(5)!=="01-01")t._tickround="d";else t._tickround=+e.substr(1)%12===0?"y":"m"}else if(e>=v&&i<=10||e>=v*15)t._tickround="d";else if(e>=m&&i<=16||e>=g)t._tickround="M";else if(e>=y&&i<=19||e>=m)t._tickround="S";else{var o=t.l2r(r+e).replace(/^-/,"").length;t._tickround=Math.max(i,o)-20}}else if(a(e)||e.charAt(0)==="L"){var s=t.range.map(t.r2d||Number);if(!a(e))e=Number(e.substr(1));t._tickround=2-Math.floor(Math.log(e)/Math.LN10+.01);var l=Math.max(Math.abs(s[0]),Math.abs(s[1]));var u=Math.floor(Math.log(l)/Math.LN10+.01);if(Math.abs(u)>3){if($(t.exponentformat)&&!J(u)){t._tickexponent=3*Math.round((u-1)/3)}else t._tickexponent=u}}else t._tickround=null}k.tickIncrement=function(t,e,r,i){var o=r?-1:1;if(a(e))return t+o*e;var l=e.charAt(0),u=o*Number(e.substr(1));if(l==="M")return s.incrementMonth(t,u,i);else if(l==="L")return Math.log(Math.pow(10,t)+u)/Math.LN10;else if(l==="D"){var c=e==="D2"?F:B,f=t+o*.01,h=s.roundUp(s.mod(f,1),c,r);return Math.floor(f)+Math.log(n.round(Math.pow(10,h),1))/Math.LN10}else throw"unrecognized dtick "+String(e)};k.tickFirst=function(t){var e=t.r2l||Number,r=s.simpleMap(t.range,e),i=r[1]<r[0],o=i?Math.floor:Math.ceil,l=r[0]*1.0001-r[1]*1e-4,u=t.dtick,c=e(t.tick0);if(a(u)){var f=o((l-c)/u)*u+c;if(t.type==="category"){f=s.constrain(f,0,t._categories.length-1)}return f}var h=u.charAt(0),p=Number(u.substr(1));if(h==="M"){var d=0,v=c,g,m,y;while(d<10){g=k.tickIncrement(v,u,i,t.calendar);if((g-l)*(v-l)<=0){if(i)return Math.min(v,g);return Math.max(v,g)}m=(l-(v+g)/2)/(g-v);y=h+(Math.abs(Math.round(m))||1)*p;v=k.tickIncrement(v,y,m<0?!i:i,t.calendar);d++}s.error("tickFirst did not converge",t);return v}else if(h==="L"){return Math.log(o((Math.pow(10,l)-c)/p)*p+c)/Math.LN10}else if(h==="D"){var x=u==="D2"?F:B,b=s.roundUp(s.mod(l,1),x,i);return Math.floor(l)+Math.log(n.round(Math.pow(10,b),1))/Math.LN10}else throw"unrecognized dtick "+String(u)};k.tickText=function(t,e,r){var n=U(t,e),a,i=t.tickmode==="array",o=r||i,l,u=t.type==="category"?t.d2l_noadd:t.d2l;if(i&&Array.isArray(t.ticktext)){var c=s.simpleMap(t.range,t.r2l),f=Math.abs(c[1]-c[0])/1e4;for(l=0;l<t.ticktext.length;l++){if(Math.abs(e-u(t.tickvals[l]))<f)break}if(l<t.ticktext.length){n.text=String(t.ticktext[l]);return n}}function h(n){var a;if(n===undefined)return true;if(r)return n==="none";a={first:t._tmin,last:t._tmax}[n];return n!=="all"&&e!==a}if(r){a="never"}else{a=t.exponentformat!=="none"&&h(t.showexponent)?"hide":""}if(t.type==="date")q(t,n,r,o);else if(t.type==="log")H(t,n,r,o,a);else if(t.type==="category")G(t,n);else if(t._id==="angular")Y(t,n,r,o,a);else W(t,n,r,o,a);if(t.tickprefix&&!h(t.showtickprefix))n.text=t.tickprefix+n.text;if(t.ticksuffix&&!h(t.showticksuffix))n.text+=t.ticksuffix;return n};k.hoverLabelText=function(t,e,r){if(r!==b&&r!==e){return k.hoverLabelText(t,e)+" - "+k.hoverLabelText(t,r)}var n=t.type==="log"&&e<=0;var a=k.tickText(t,t.c2l(n?-e:e),"hover").text;if(n){return e===0?"0":x+a}return a};function U(t,e,r){var n=t.tickfont||{};return{x:e,dx:0,dy:0,text:r||"",fontSize:n.size,font:n.family,fontColor:n.color}}function q(t,e,r,n){var i=t._tickround,o=r&&t.hoverformat||k.getTickFormat(t);if(n){if(a(i))i=4;else i={y:"m",m:"d",d:"M",M:"S",S:4}[i]}var l=s.formatDate(e.x,o,i,t._dateFormat,t.calendar,t._extraFormat),u;var c=l.indexOf("\n");if(c!==-1){u=l.substr(c+1);l=l.substr(0,c)}if(n){if(l==="00:00:00"||l==="00:00"){l=u;u=""}else if(l.length===8){l=l.replace(/:00$/,"")}}if(u){if(r){if(i==="d")l+=", "+u;else l=u+(l?", "+l:"")}else if(!t._inCalcTicks||u!==t._prevDateHead){l+="<br>"+u;t._prevDateHead=u}}e.text=l}function H(t,e,r,n,i){var o=t.dtick,l=e.x,u=t.tickformat;if(i==="never"){i=""}if(n&&(typeof o!=="string"||o.charAt(0)!=="L"))o="L3";if(u||typeof o==="string"&&o.charAt(0)==="L"){e.text=K(Math.pow(10,l),t,i,n)}else if(a(o)||o.charAt(0)==="D"&&s.mod(l+.01,1)<.1){var c=Math.round(l);if(["e","E","power"].indexOf(t.exponentformat)!==-1||$(t.exponentformat)&&J(c)){if(c===0)e.text=1;else if(c===1)e.text="10";else if(c>1)e.text="10<sup>"+c+"</sup>";else e.text="10<sup>"+x+-c+"</sup>";e.fontSize*=1.25}else{e.text=K(Math.pow(10,l),t,"","fakehover");if(o==="D1"&&t._id.charAt(0)==="y"){e.dy-=e.fontSize/6}}}else if(o.charAt(0)==="D"){e.text=String(Math.round(Math.pow(10,s.mod(l,1))));e.fontSize*=.75}else throw"unrecognized dtick "+String(o);if(t.dtick==="D1"){var f=String(e.text).charAt(0);if(f==="0"||f==="1"){if(t._id.charAt(0)==="y"){e.dx-=e.fontSize/4}else{e.dy+=e.fontSize/2;e.dx+=(t.range[1]>t.range[0]?1:-1)*e.fontSize*(l<0?.5:.25)}}}}function G(t,e){var r=t._categories[Math.round(e.x)];if(r===undefined)r="";e.text=String(r)}function W(t,e,r,n,a){if(a==="never"){a=""}else if(t.showexponent==="all"&&Math.abs(e.x/t.dtick)<1e-6){a="hide"}e.text=K(e.x,t,a,n)}function Y(t,e,r,n,a){if(t.thetaunit==="radians"&&!r){var i=e.x/180;if(i===0){e.text="0"}else{var o=X(i);if(o[1]>=100){e.text=K(s.deg2rad(e.x),t,a,n)}else{var l=e.x<0;if(o[1]===1){if(o[0]===1)e.text="\u03c0";else e.text=o[0]+"\u03c0"}else{e.text=["<sup>",o[0],"</sup>","\u2044","<sub>",o[1],"</sub>","\u03c0"].join("")}if(l)e.text=x+e.text}}}else{e.text=K(e.x,t,a,n)}}function X(t){function e(t,e){return Math.abs(t-e)<=1e-6}function r(t,n){return e(n,0)?t:r(n,t%n)}function n(t){var r=1;while(!e(Math.round(t*r)/r,t)){r*=10}return r}var a=n(t);var i=t*a;var o=Math.abs(r(i,a));return[Math.round(i/o),Math.round(a/o)]}var Z=["f","p","n","\u03bc","m","","k","M","G","T"];function $(t){return t==="SI"||t==="B"}function J(t){return t>14||t<-15}function K(t,e,r,n){var i=t<0,o=e._tickround,l=r||e.exponentformat||"B",u=e._tickexponent,c=k.getTickFormat(e),f=e.separatethousands;if(n){var h={exponentformat:l,dtick:e.showexponent==="none"?e.dtick:a(t)?Math.abs(t)||1:1,range:e.showexponent==="none"?e.range.map(e.r2d):[0,t||1]};V(h);o=(Number(h._tickround)||0)+4;u=h._tickexponent;if(e.hoverformat)c=e.hoverformat}if(c)return e._numFormat(c)(t).replace(/-/g,x);var p=Math.pow(10,-o)/2;if(l==="none")u=0;t=Math.abs(t);if(t<p){t="0";i=false}else{t+=p;if(u){t*=Math.pow(10,-u);o+=u}if(o===0)t=String(Math.floor(t));else if(o<0){t=String(Math.round(t));t=t.substr(0,t.length+o);for(var d=o;d<0;d++)t+="0"}else{t=String(t);var v=t.indexOf(".")+1;if(v)t=t.substr(0,v+o).replace(/\.?0+$/,"")}t=s.numSeparate(t,e._separators,f)}if(u&&l!=="hide"){if($(l)&&J(u))l="power";var g;if(u<0)g=x+-u;else if(l!=="power")g="+"+u;else g=String(u);if(l==="e"){t+="e"+g}else if(l==="E"){t+="E"+g}else if(l==="power"){t+="\xd710<sup>"+g+"</sup>"}else if(l==="B"&&u===9){t+="B"}else if($(l)){t+=Z[u/3+5]}}if(i)return x+t;return t}k.getTickFormat=function(t){var e;function r(t){return typeof t!=="string"?t:Number(t.replace("M",""))*d}function n(t,e){var r=["L","D"];if(typeof t===typeof e){if(typeof t==="number"){return t-e}else{var n=r.indexOf(t.charAt(0));var a=r.indexOf(e.charAt(0));if(n===a){return Number(t.replace(/(L|D)/g,""))-Number(e.replace(/(L|D)/g,""))}else{return n-a}}}else{return typeof t==="number"?1:-1}}function a(t,e,r){var n=r||function(t){return t};var a=e[0];var i=e[1];return(!a&&typeof a!=="number"||n(a)<=n(t))&&(!i&&typeof i!=="number"||n(i)>=n(t))}function i(t,e){var r=e[0]===null;var a=e[1]===null;var i=n(t,e[0])>=0;var o=n(t,e[1])<=0;return(r||i)&&(a||o)}var o,s;if(t.tickformatstops&&t.tickformatstops.length>0){switch(t.type){case"date":case"linear":{for(e=0;e<t.tickformatstops.length;e++){s=t.tickformatstops[e];if(s.enabled&&a(t.dtick,s.dtickrange,r)){o=s;break}}break}case"log":{for(e=0;e<t.tickformatstops.length;e++){s=t.tickformatstops[e];if(s.enabled&&i(t.dtick,s.dtickrange)){o=s;break}}break}default:}}return o?o.value:t.tickformat};k.getSubplots=function(t,e){var r=t._fullLayout._subplots;var n=r.cartesian.concat(r.gl2d||[]);var a=e?k.findSubplotsWithAxis(n,e):n;a.sort(function(t,e){var r=t.substr(1).split("y");var n=e.substr(1).split("y");if(r[0]===n[0])return+r[1]-+n[1];return+r[0]-+n[0]});return a};k.findSubplotsWithAxis=function(t,e){var r=new RegExp(e._id.charAt(0)==="x"?"^"+e._id+"y":e._id+"$");var n=[];for(var a=0;a<t.length;a++){var i=t[a];if(r.test(i))n.push(i)}return n};k.makeClipPaths=function(t){var e=t._fullLayout;if(e._hasOnlyLargeSploms)return;var r={_offset:0,_length:e.width,_id:""};var a={_offset:0,_length:e.height,_id:""};var i=k.list(t,"x",true);var o=k.list(t,"y",true);var s=[];var l,u;for(l=0;l<i.length;l++){s.push({x:i[l],y:a});for(u=0;u<o.length;u++){if(l===0)s.push({x:r,y:o[u]});s.push({x:i[l],y:o[u]})}}var c=e._clips.selectAll(".axesclip").data(s,function(t){return t.x._id+t.y._id});c.enter().append("clipPath").classed("axesclip",true).attr("id",function(t){return"clip"+e._uid+t.x._id+t.y._id}).append("rect");c.exit().remove();c.each(function(t){n.select(this).select("rect").attr({x:t.x._offset||0,y:t.y._offset||0,width:t.x._length||1,height:t.y._length||1})})};k.doTicks=function(t,e,r){var n=t._fullLayout;if(e==="redraw"){n._paper.selectAll("g.subplot").each(function(t){var e=n._plots[t];var r=e.xaxis;var a=e.yaxis;e.xaxislayer.selectAll("."+r._id+"tick").remove();e.yaxislayer.selectAll("."+a._id+"tick").remove();if(e.gridlayer)e.gridlayer.selectAll("path").remove();if(e.zerolinelayer)e.zerolinelayer.selectAll("path").remove();n._infolayer.select(".g-"+r._id+"title").remove();n._infolayer.select(".g-"+a._id+"title").remove()})}var a=!e||e==="redraw"?k.listIds(t):e;s.syncOrAsync(a.map(function(e){return function(){if(!e)return;var n=k.doTicksSingle(t,e,r);var a=k.getFromId(t,e);a._r=a.range.slice();a._rl=s.simpleMap(a._r,a.r2l);return n}}))};k.doTicksSingle=function(t,e,r){var h=t._fullLayout;var p=false;var d;if(s.isPlainObject(e)){d=e;p=true}else{d=k.getFromId(t,e)}d.setScale();var v=d._id;var g=v.charAt(0);var m=k.counterLetter(v);var y=d._vals=k.calcTicks(d);var x=function(t){return[t.text,t.x,d.mirror,t.font,t.fontSize,t.fontColor].join("_")};var b=v+"tick";var M=v+"grid";var T=v+"zl";var S=(d.linewidth||1)/2;var E=d.ticks==="outside"?d.ticklen:0;var C=0;var L=f.crispRound(t,d.gridwidth,1);var I=f.crispRound(t,d.zerolinewidth,L);var z=f.crispRound(t,d.tickwidth,1);var P,O,D,R;var B;var F;if(d._counterangle&&d.ticks==="outside"){var N=d._counterangle*Math.PI/180;E=d.ticklen*Math.cos(N)+1;C=d.ticklen*Math.sin(N)}if(d.showticklabels&&(d.ticks==="outside"||d.showline)){E+=.2*d.tickfont.size}if(g==="x"){P=["bottom","top"];O=d._transfn||function(t){return"translate("+(d._offset+d.l2p(t.x))+",0)"};D=function(t,e){if(d._counterangle){var r=d._counterangle*Math.PI/180;return"M0,"+t+"l"+Math.sin(r)*e+","+Math.cos(r)*e}else return"M0,"+t+"v"+e}}else if(g==="y"){P=["left","right"];O=d._transfn||function(t){return"translate(0,"+(d._offset+d.l2p(t.x))+")"};D=function(t,e){if(d._counterangle){var r=d._counterangle*Math.PI/180;return"M"+t+",0l"+Math.cos(r)*e+","+-Math.sin(r)*e}else return"M"+t+",0h"+e}}else if(v==="angular"){P=["left","right"];O=d._transfn;D=function(t,e){return"M"+t+",0h"+e}}else{s.warn("Unrecognized doTicks axis:",v);return}var j=d.side||P[0];var V=[-1,1,j===P[1]?1:-1];if(d.ticks!=="inside"===(g==="x")){V=V.map(function(t){return-t})}if(!d.visible)return;if(d._tickFilter){y=y.filter(d._tickFilter)}function U(t){var e=d.l2p(t.x);return e>1&&e<d._length-1}var q=y.filter(U);if(d._id==="angular"){q=y}function H(t,e){var r=t.selectAll("path."+b).data(d.ticks==="inside"?q:y,x);if(e&&d.ticks){r.enter().append("path").classed(b,1).classed("ticks",1).classed("crisp",1).call(c.stroke,d.tickcolor).style("stroke-width",z+"px").attr("d",e);r.attr("transform",O);r.exit().remove()}else r.remove()}function G(e,r){B=e.selectAll("g."+b).data(y,x);if(!a(r)){B.remove();W();return}if(!d.showticklabels){B.remove();W();P();return}var o,u,c,p,m;if(g==="x"){m=j==="bottom"?1:-1;o=function(t){return t.dx+C*m};p=r+(E+S)*m;u=function(t){return t.dy+p+t.fontSize*(j==="bottom"?1:-.2)};c=function(t){if(!a(t)||t===0||t===180){return"middle"}return t*m<0?"end":"start"}}else if(g==="y"){m=j==="right"?1:-1;u=function(t){return t.dy+t.fontSize*_-C*m};o=function(t){return t.dx+r+(E+S+(Math.abs(d.tickangle)===90?t.fontSize/2:0))*m};c=function(t){if(a(t)&&Math.abs(t)===90){return"middle"}return j==="right"?"start":"end"}}else if(v==="angular"){d._labelShift=C;d._labelStandoff=E;d._pad=S;o=d._labelx;u=d._labely;c=d._labelanchor}var k=0,M=0,A=[];B.enter().append("g").classed(b,1).append("text").attr("text-anchor","middle").each(function(e){var r=n.select(this),a=t._promises.length;r.call(l.positionText,o(e),u(e)).call(f.font,e.font,e.fontSize,e.fontColor).text(e.text).call(l.convertToTspans,t);a=t._promises[a];if(a){A.push(t._promises.pop().then(function(){L(r,d.tickangle)}))}else{L(r,d.tickangle)}});B.exit().remove();B.each(function(t){k=Math.max(k,t.fontSize)});if(v==="angular"){B.each(function(t){n.select(this).select("text").call(l.positionText,o(t),u(t))})}function T(t,e,r){var n=(t-1)*e;if(g==="x"){if(r<-60||60<r){return-.5*n}else if(j==="top"){return-n}}else{r*=j==="left"?1:-1;if(r<-30){return-n}else if(r<30){return-.5*n}}return 0}function L(t,e){t.each(function(t){var r=c(e,t);var i=n.select(this),s=i.select(".text-math-group"),h=O.call(i.node(),t)+(a(e)&&+e!==0?" rotate("+e+","+o(t)+","+(u(t)-t.fontSize/2)+")":"");var p=T(l.lineCount(i),w*t.fontSize,a(e)?+e:0);if(p){h+=" translate(0, "+p+")"}if(s.empty()){i.select("text").attr({transform:h,"text-anchor":r})}else{var d=f.bBox(s.node()).width*{end:-.5,start:.5}[r];s.attr("transform",h+(d?"translate("+d+",0)":""))}})}L(B,d._lastangle||d.tickangle);function I(){return A.length&&Promise.all(A)}function z(){L(B,d.tickangle);if(g==="x"&&!a(d.tickangle)&&(d.type!=="log"||String(d.dtick).charAt(0)!=="D")){var t=[];B.each(function(e){var r=n.select(this),a=r.select(".text-math-group"),i=d.l2p(e.x);if(a.empty())a=r.select("text");var o=f.bBox(a.node());t.push({top:0,bottom:10,height:10,left:i-o.width/2,right:i+o.width/2+2,width:o.width+2})});for(F=0;F<t.length-1;F++){if(s.bBoxIntersect(t[F],t[F+1])){M=30;break}}if(M){var e=Math.abs((y[y.length-1].x-y[0].x)*d._m)/(y.length-1);if(e<k*2.5){M=90}L(B,M)}d._lastangle=M}W();return v+" done"}function P(){if(d.showticklabels){var r=t.getBoundingClientRect();var n=e.node().getBoundingClientRect();d._boundingBox={width:n.width,height:n.height,left:n.left-r.left,right:n.right-r.left,top:n.top-r.top,bottom:n.bottom-r.top}}else{var a=h._size;var i;if(g==="x"){i=d.anchor==="free"?a.t+a.h*(1-d.position):a.t+a.h*(1-d._anchorAxis.domain[{bottom:0,top:1}[d.side]]);d._boundingBox={top:i,bottom:i,left:d._offset,right:d._offset+d._length,width:d._length,height:0}}else{i=d.anchor==="free"?a.l+a.w*d.position:a.l+a.w*d._anchorAxis.domain[{left:0,right:1}[d.side]];d._boundingBox={left:i,right:i,bottom:d._offset+d._length,top:d._offset,height:d._length,width:0}}}if(R){var o=d._counterSpan=[Infinity,-Infinity];for(F=0;F<R.length;F++){var s=h._plots[R[F]];var l=s[g==="x"?"yaxis":"xaxis"];u(o,[l._offset,l._offset+l._length])}if(d.anchor==="free"){u(o,g==="x"?[d._boundingBox.bottom,d._boundingBox.top]:[d._boundingBox.right,d._boundingBox.left])}}function u(t,e){t[0]=Math.min(t[0],e[0]);t[1]=Math.max(t[1],e[1])}}function D(){var e=d._name+".automargin";if(g!=="x"&&g!=="y"){return}if(!d.automargin){i.autoMargin(t,e);return}var r=d.side[0];var n={x:0,y:0,r:0,l:0,t:0,b:0};if(g==="x"){n.y=d.anchor==="free"?d.position:d._anchorAxis.domain[r==="t"?1:0];n[r]+=d._boundingBox.height}else{n.x=d.anchor==="free"?d.position:d._anchorAxis.domain[r==="r"?1:0];n[r]+=d._boundingBox.width}if(d.title!==h._dfltTitle[g]){n[r]+=d.titlefont.size}i.autoMargin(t,e,n)}var N=s.syncOrAsync([I,z,P,D]);if(N&&N.then)t._promises.push(N);return N}function W(){if(r)return;if(d.rangeslider&&d.rangeslider.visible&&d._boundingBox&&d.side==="bottom")return;var e={selection:B,side:d.side};var n=v.charAt(0);var a=t._fullLayout._size;var i=1.5;var o=d.titlefont.size;var s,l,c,p;if(B.size()){var g=f.getTranslate(B.node().parentNode);e.offsetLeft=g.x;e.offsetTop=g.y}var m=10+o*i+(d.linewidth?d.linewidth-1:0);if(n==="x"){l=d.anchor==="free"?{_offset:a.t+(1-(d.position||0))*a.h,_length:0}:A.getFromId(t,d.anchor);c=d._offset+d._length/2;if(d.side==="top"){p=-m-o*(d.showticklabels?1:0)}else{p=l._length+m+o*(d.showticklabels?1.5:.5)}p+=l._offset;if(!e.side)e.side="bottom"}else{l=d.anchor==="free"?{_offset:a.l+(d.position||0)*a.w,_length:0}:A.getFromId(t,d.anchor);p=d._offset+d._length/2;if(d.side==="right"){c=l._length+m+o*(d.showticklabels?1:.5)}else{c=-m-o*(d.showticklabels?.5:0)}c+=l._offset;s={rotate:"-90",offset:0};if(!e.side)e.side="left"}u.draw(t,v+"title",{propContainer:d,propName:d._name+".title",placeholder:h._dfltTitle[n],avoid:e,transform:s,attributes:{x:c,y:p,"text-anchor":"middle"}})}function Y(t,e){if(t.visible!==true||t.xaxis+t.yaxis!==e)return false;if(o.traceIs(t,"bar")&&t.orientation==={x:"h",y:"v"}[g])return true;return t.fill&&t.fill.charAt(t.fill.length-1)===g}function X(e,r,a){if(h._hasOnlyLargeSploms)return;var i=e.gridlayer.selectAll("."+v);var o=e.zerolinelayer;var l=e["hidegrid"+g]?[]:q;var u=d._gridpath||(g==="x"?"M0,"+r._offset+"v":"M"+r._offset+",0h")+r._length;var f=i.selectAll("path."+M).data(d.showgrid===false?[]:l,x);f.enter().append("path").classed(M,1).classed("crisp",1).attr("d",u).each(function(t){if(d.zeroline&&(d.type==="linear"||d.type==="-")&&Math.abs(t.x)<d.dtick/100){n.select(this).remove()}});f.attr("transform",O).call(c.stroke,d.gridcolor||"#ddd").style("stroke-width",L+"px");if(typeof u==="function")f.attr("d",u);f.exit().remove();if(o){var p=false;for(var m=0;m<t._fullData.length;m++){if(Y(t._fullData[m],a)){p=true;break}}var y=s.simpleMap(d.range,d.r2l),b=y[0]*y[1]<=0&&d.zeroline&&(d.type==="linear"||d.type==="-")&&l.length&&(p||U({x:0})||!d.showline);var _=o.selectAll("path."+T).data(b?[{x:0,id:v}]:[]);_.enter().append("path").classed(T,1).classed("zl",1).classed("crisp",1).attr("d",u).each(function(){o.selectAll("path").sort(function(t,e){return A.idSort(t.id,e.id)})});_.attr("transform",O).call(c.stroke,d.zerolinecolor||c.defaultLine).style("stroke-width",I+"px");_.exit().remove()}}if(p){H(d._axislayer,D(d._pos+S*V[2],V[2]*d.ticklen));if(d._counteraxis){var Z={gridlayer:d._gridlayer,zerolinelayer:d._zerolinelayer};X(Z,d._counteraxis)}return G(d._axislayer,d._pos)}else if(h._has("cartesian")){R=k.getSubplots(t,d);var $={};R.map(function(t){var e=h._plots[t];var r=e[m+"axis"];var n=r._mainAxis._id;if($[n])return;$[n]=1;X(e,r,t)});var J=d._mainSubplot;var K=h._plots[J];var Q=[];if(d.ticks){var tt=V[2];var et=D(d._mainLinePosition+S*tt,tt*d.ticklen);if(d._anchorAxis&&d.mirror&&d.mirror!==true){et+=D(d._mainMirrorPosition-S*tt,-tt*d.ticklen)}H(K[g+"axislayer"],et);Q=Object.keys(d._linepositions||{})}Q.map(function(t){var e=h._plots[t];var r=e[g+"axislayer"];var n=d._linepositions[t]||[];function a(t){var e=V[t];return D(n[t]+S*e,e*d.ticklen)}H(r,a(0)+a(1))});var rt=K[g+"axislayer"];return G(rt,d._mainLinePosition)}};k.allowAutoMargin=function(t){var e=k.list(t,"",true);for(var r=0;r<e.length;r++){var n=e[r];if(n.automargin){i.allowAutoMargin(t,n._name+".automargin")}if(n.rangeslider&&n.rangeslider.visible){i.allowAutoMargin(t,"rangeslider"+n._id)}}};k.swap=function(t,e){var r=Q(t,e);for(var n=0;n<r.length;n++){et(t,r[n].x,r[n].y)}};function Q(t,e){var r=[],n,a;for(n=0;n<e.length;n++){var i=[],o=t._fullData[e[n]].xaxis,s=t._fullData[e[n]].yaxis;if(!o||!s)continue;for(a=0;a<r.length;a++){if(r[a].x.indexOf(o)!==-1||r[a].y.indexOf(s)!==-1){i.push(a)}}if(!i.length){r.push({x:[o],y:[s]});continue}var l=r[i[0]],u;if(i.length>1){for(a=1;a<i.length;a++){u=r[i[a]];tt(l.x,u.x);tt(l.y,u.y)}}tt(l.x,[o]);tt(l.y,[s])}return r}function tt(t,e){for(var r=0;r<e.length;r++){if(t.indexOf(e[r])===-1)t.push(e[r])}}function et(t,e,r){var n,a,i=[],o=[],l=t.layout;for(n=0;n<e.length;n++)i.push(k.getFromId(t,e[n]));for(n=0;n<r.length;n++)o.push(k.getFromId(t,r[n]));var u=Object.keys(i[0]),c=["anchor","domain","overlaying","position","side","tickangle"],f=["linear","log"];for(n=0;n<u.length;n++){var h=u[n],p=i[0][h],d=o[0][h],v=true,g=false,m=false;if(h.charAt(0)==="_"||typeof p==="function"||c.indexOf(h)!==-1){continue}for(a=1;a<i.length&&v;a++){var y=i[a][h];if(h==="type"&&f.indexOf(p)!==-1&&f.indexOf(y)!==-1&&p!==y){g=true}else if(y!==p)v=false}for(a=1;a<o.length&&v;a++){var x=o[a][h];if(h==="type"&&f.indexOf(d)!==-1&&f.indexOf(x)!==-1&&d!==x){m=true}else if(o[a][h]!==d)v=false}if(v){if(g)l[i[0]._name].type="linear";if(m)l[o[0]._name].type="linear";rt(l,h,i,o,t._fullLayout._dfltTitle)}}for(n=0;n<t._fullLayout.annotations.length;n++){var b=t._fullLayout.annotations[n];if(e.indexOf(b.xref)!==-1&&r.indexOf(b.yref)!==-1){s.swapAttrs(l.annotations[n],["?"])}}}function rt(t,e,r,n,a){var i=s.nestedProperty,o=i(t[r[0]._name],e).get(),l=i(t[n[0]._name],e).get(),u;if(e==="title"){if(o===a.x){o=a.y}if(l===a.y){l=a.x}}for(u=0;u<r.length;u++){i(t,r[u]._name+"."+e).set(l)}for(u=0;u<n.length;u++){i(t,n[u]._name+"."+e).set(o)}}},{"../../components/color":558,"../../components/drawing":583,"../../components/titles":649,"../../constants/alignment":656,"../../constants/numerical":661,"../../lib":684,"../../lib/svg_text_utils":708,"../../plots/plots":795,"../../registry":817,"./autorange":731,"./axis_autotype":733,"./axis_ids":735,"./set_convert":750,d3:147,"fast-isnumeric":214}],733:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib");var i=t("../../constants/numerical").BADNUM;e.exports=function t(e,r){if(s(e,r))return"date";if(l(e))return"category";if(o(e))return"linear";else return"-"};function o(t){if(!t)return false;for(var e=0;e<t.length;e++){if(n(t[e]))return true}return false}function s(t,e){var r=0,i=0,o=Math.max(1,(t.length-1)/1e3),s;for(var l=0;l<t.length;l+=o){s=t[Math.round(l)];if(a.isDateTime(s,e))r+=1;if(n(s))i+=1}return r>i*2}function l(t){var e=Math.max(1,(t.length-1)/1e3),r=0,n=0,o;for(var s=0;s<t.length;s+=e){o=t[Math.round(s)];if(a.cleanNumber(o)!==i)r++;else if(typeof o==="string"&&o!==""&&o!=="None")n++}return n>r*2}},{"../../constants/numerical":661,"../../lib":684,"fast-isnumeric":214}],734:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");var i=t("./layout_attributes");var o=t("./tick_value_defaults");var s=t("./tick_mark_defaults");var l=t("./tick_label_defaults");var u=t("./category_order_defaults");var c=t("./line_grid_defaults");var f=t("./set_convert");e.exports=function t(e,r,h,p,d){var v=p.letter;var g=r._id;var m=p.font||{};var y=h("visible",!p.cheateronly);var x=r.type;if(x==="date"){var b=n.getComponentMethod("calendars","handleDefaults");b(e,r,"calendar",p.calendar)}f(r,d);var _=h("autorange",!r.isValidRange(e.range));r._rangesliderAutorange=false;if(_)h("rangemode");h("range");r.cleanRange();u(e,r,h,p);if(x!=="category"&&!p.noHover)h("hoverformat");if(!y)return r;var w=h("color");var k=w!==i.color.dflt?w:m.color;var M=((d._splomAxes||{})[v]||{})[g]||d._dfltTitle[v];h("title",M);a.coerceFont(h,"titlefont",{family:m.family,size:Math.round(m.size*1.2),color:k});o(e,r,h,x);l(e,r,h,x,p);s(e,r,h,p);c(e,r,h,{dfltColor:w,bgColor:p.bgColor,showGrid:p.showGrid,attributes:i});if(r.showline||r.ticks)h("mirror");if(p.automargin)h("automargin");return r}},{"../../lib":684,"../../registry":817,"./category_order_defaults":736,"./layout_attributes":744,"./line_grid_defaults":746,"./set_convert":750,"./tick_label_defaults":751,"./tick_mark_defaults":752,"./tick_value_defaults":753}],735:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("./constants");r.id2name=function t(e){if(typeof e!=="string"||!e.match(a.AX_ID_PATTERN))return;var r=e.substr(1);if(r==="1")r="";return e.charAt(0)+"axis"+r};r.name2id=function t(e){if(!e.match(a.AX_NAME_PATTERN))return;var r=e.substr(5);if(r==="1")r="";return e.charAt(0)+r};r.cleanId=function t(e,r){if(!e.match(a.AX_ID_PATTERN))return;if(r&&e.charAt(0)!==r)return;var n=e.substr(1).replace(/^0+/,"");if(n==="1")n="";return e.charAt(0)+n};r.list=function(t,e,n){var a=t._fullLayout;if(!a)return[];var i=r.listIds(t,e);var o=new Array(i.length);var s;for(s=0;s<i.length;s++){var l=i[s];o[s]=a[l.charAt(0)+"axis"+l.substr(1)]}if(!n){var u=a._subplots.gl3d||[];for(s=0;s<u.length;s++){var c=a[u[s]];if(e)o.push(c[e+"axis"]);else o.push(c.xaxis,c.yaxis,c.zaxis)}}return o};r.listIds=function(t,e){var r=t._fullLayout;if(!r)return[];var n=r._subplots;if(e)return n[e+"axis"];return n.xaxis.concat(n.yaxis)};r.getFromId=function(t,e,n){var a=t._fullLayout;if(n==="x")e=e.replace(/y[0-9]*/,"");else if(n==="y")e=e.replace(/x[0-9]*/,"");return a[r.id2name(e)]};r.getFromTrace=function(t,e,a){var i=t._fullLayout;var o=null;if(n.traceIs(e,"gl3d")){var s=e.scene;if(s.substr(0,5)==="scene"){o=i[s][a+"axis"]}}else{o=r.getFromId(t,e[a+"axis"]||a)}return o};r.idSort=function(t,e){var r=t.charAt(0);var n=e.charAt(0);if(r!==n)return r>n?1:-1;return+(t.substr(1)||1)-+(e.substr(1)||1)}},{"../../registry":817,"./constants":737}],736:[function(t,e,r){"use strict";function n(t,e){var r=e.dataAttr||t._id.charAt(0);var n={};var a;var i,o;if(e.axData){a=e.axData}else{a=[];for(i=0;i<e.data.length;i++){var s=e.data[i];if(s[r+"axis"]===t._id){a.push(s)}}}for(i=0;i<a.length;i++){var l=a[i][r];for(o=0;o<l.length;o++){var u=l[o];if(u!==null&&u!==undefined){n[u]=1}}}return Object.keys(n)}e.exports=function t(e,r,a,i){if(r.type!=="category")return;var o=e.categoryarray;var s=Array.isArray(o)&&o.length>0;var l;if(s)l="array";var u=a("categoryorder",l);var c;if(u==="array"){c=a("categoryarray")}if(!s&&u==="array"){u=r.categoryorder="trace"}if(u==="trace"){r._initialCategories=[]}else if(u==="array"){r._initialCategories=c.slice()}else{c=n(r,i).sort();if(u==="category ascending"){r._initialCategories=c}else if(u==="category descending"){r._initialCategories=c.reverse()}}}},{}],737:[function(t,e,r){"use strict";var n=t("../../lib/regex").counter;e.exports={idRegex:{x:n("x"),y:n("y")},attrRegex:n("[xy]axis"),xAxisMatch:n("xaxis"),yAxisMatch:n("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["heatmaplayer","contourcarpetlayer","contourlayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":700}],738:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./axis_ids").id2name;e.exports=function t(e,r,a,s,l){var u=l._axisConstraintGroups;var c=r._id;var f=c.charAt(0);if(r.fixedrange)return;a("constrain");n.coerce(e,r,{constraintoward:{valType:"enumerated",values:f==="x"?["left","center","right"]:["bottom","middle","top"],dflt:f==="x"?"center":"middle"}},"constraintoward");if(!e.scaleanchor)return;var h=i(u,c,s,l);var p=n.coerce(e,r,{scaleanchor:{valType:"enumerated",values:h.linkableAxes}},"scaleanchor");if(p){var d=a("scaleratio");if(!d)d=r.scaleratio=1;o(u,h.thisGroup,c,p,d)}else if(s.indexOf(e.scaleanchor)!==-1){n.warn("ignored "+r._name+'.scaleanchor: "'+e.scaleanchor+'" to avoid either an infinite loop '+"and possibly inconsistent scaleratios, or because the target"+"axis has fixed range.")}};function i(t,e,r,n){var i=n[a(e)].type;var o,s,l,u;var c=[];for(s=0;s<r.length;s++){l=r[s];if(l===e)continue;u=n[a(l)];if(u.type===i&&!u.fixedrange)c.push(l)}for(o=0;o<t.length;o++){if(t[o][e]){var f=t[o];var h=[];for(s=0;s<c.length;s++){l=c[s];if(!f[l])h.push(l)}return{linkableAxes:h,thisGroup:f}}}return{linkableAxes:c,thisGroup:null}}function o(t,e,r,n,a){var i,o,s,l,u;if(e===null){e={};e[r]=1;u=t.length;t.push(e)}else{u=t.indexOf(e)}var c=Object.keys(e);for(i=0;i<t.length;i++){s=t[i];if(i!==u&&s[n]){var f=s[n];for(o=0;o<c.length;o++){l=c[o];s[l]=f*a*e[l]}t.splice(u,1);return}}if(a!==1){for(o=0;o<c.length;o++){e[c[o]]*=a}}e[n]=1}},{"../../lib":684,"./axis_ids":735}],739:[function(t,e,r){"use strict";var n=t("./axis_ids").id2name;var a=t("./scale_zoom");var i=t("./autorange").makePadFn;var o=t("../../constants/numerical").ALMOST_EQUAL;var s=t("../../constants/alignment").FROM_BL;r.enforce=function t(e){var r=e._fullLayout;var s=r._axisConstraintGroups||[];var u,c,f,h,p,d,v;for(u=0;u<s.length;u++){var g=s[u];var m=Object.keys(g);var y=Infinity;var x=0;var b=Infinity;var _={};var w={};var k=false;for(c=0;c<m.length;c++){f=m[c];w[f]=h=r[n(f)];if(h._inputDomain)h.domain=h._inputDomain.slice();else h._inputDomain=h.domain.slice();if(!h._inputRange)h._inputRange=h.range.slice();h.setScale();_[f]=p=Math.abs(h._m)/g[f];y=Math.min(y,p);if(h.constrain==="domain"||!h._constraintShrinkable){b=Math.min(b,p)}delete h._constraintShrinkable;x=Math.max(x,p);if(h.constrain==="domain")k=true}if(y>o*x&&!k)continue;for(c=0;c<m.length;c++){f=m[c];p=_[f];h=w[f];d=h.constrain;if(p!==b||d==="domain"){v=p/b;if(d==="range"){a(h,v)}else{var M=h._inputDomain;var A=(h.domain[1]-h.domain[0])/(M[1]-M[0]);var T=(h.r2l(h.range[1])-h.r2l(h.range[0]))/(h.r2l(h._inputRange[1])-h.r2l(h._inputRange[0]));v/=A;if(v*T<1){h.domain=h._input.domain=M.slice();a(h,v);continue}if(T<1){h.range=h._input.range=h._inputRange.slice();v*=T}if(h.autorange&&h._min.length&&h._max.length){var S=h.r2l(h.range[0]);var E=h.r2l(h.range[1]);var C=(S+E)/2;var L=C;var I=C;var z=Math.abs(E-C);var P=C-z*v*1.0001;var O=C+z*v*1.0001;var D=i(h);l(h,v);h.setScale();var R=Math.abs(h._m);var B;var F;for(F=0;F<h._min.length;F++){B=h._min[F].val-D(h._min[F])/R;if(B>P&&B<L){L=B}}for(F=0;F<h._max.length;F++){B=h._max[F].val+D(h._max[F])/R;if(B<O&&B>I){I=B}}var N=(I-L)/(2*z);v/=N;L=h.l2r(L);I=h.l2r(I);h.range=h._input.range=S<E?[L,I]:[I,L]}l(h,v)}}}}};r.clean=function t(e,r){if(r._inputDomain){var n=false;var a=r._id;var i=e._fullLayout._axisConstraintGroups;for(var o=0;o<i.length;o++){if(i[o][a]){n=true;break}}if(!n||r.constrain!=="domain"){r._input.domain=r.domain=r._inputDomain;delete r._inputDomain}}};function l(t,e){var r=t._inputDomain;var n=s[t.constraintoward];var a=r[0]+(r[1]-r[0])*n;t.domain=t._input.domain=[a+(r[0]-a)/e,a+(r[1]-a)/e]}},{"../../constants/alignment":656,"../../constants/numerical":661,"./autorange":731,"./axis_ids":735,"./scale_zoom":748}],740:[function(t,e,r){"use strict";var n=t("d3");var a=t("tinycolor2");var i=t("has-passive-events");var o=t("../../registry");var s=t("../../lib");var l=t("../../lib/svg_text_utils");var u=t("../../lib/clear_gl_canvases");var c=t("../../components/color");var f=t("../../components/drawing");var h=t("../../components/fx");var p=t("../../lib/setcursor");var d=t("../../components/dragelement");var v=t("../../constants/alignment").FROM_TL;var g=t("../plots");var m=t("./axes").doTicksSingle;var y=t("./axis_ids").getFromId;var x=t("./select").prepSelect;var b=t("./select").clearSelect;var _=t("./scale_zoom");var w=t("./constants");var k=w.MINDRAG;var M=w.MINZOOM;var A=true;function T(t,e,r,i,c,p,A,T){var S=t._fullLayout._zoomlayer;var F=A+T==="nsew";var X=(A+T).length===1;var Z,$;var J,K;var Q,tt;var et,rt;var nt,at;var it;var ot,st;var lt;var ut;var ct,ft;var ht,pt,dt,vt;function gt(){Z=e.xaxis;$=e.yaxis;nt=Z._length;at=$._length;et=Z._offset;rt=$._offset;J={};J[Z._id]=Z;K={};K[$._id]=$;if(A&&T){var r=e.overlays;for(var n=0;n<r.length;n++){var a=r[n].xaxis;J[a._id]=a;var i=r[n].yaxis;K[i._id]=i}}Q=Y(J);tt=Y(K);ot=C(Q,T);st=C(tt,A);lt=!st&&!ot;it=G(t,J,K);ut=it.isSubplotConstrained;ct=T||ut;ft=A||ut;var o=t._fullLayout;ht=o._has("scattergl");pt=o._hasOnlyLargeSploms;dt=pt||o._has("splom");vt=o._has("svg")}gt();var mt=O(st+ot,t._fullLayout.dragmode,F);var yt=E(e,A+T+"drag",mt,r,i,c,p);if(lt&&!F){yt.onmousedown=null;yt.style.pointerEvents="none";return yt}var xt={element:yt,gd:t,plotinfo:e};xt.prepFn=function(e,r,n){var a=t._fullLayout.dragmode;gt();if(!lt){if(F){if(e.shiftKey){if(a==="pan")a="zoom";else if(!V(a))a="pan"}else if(e.ctrlKey){a="pan"}}else a="pan"}if(a==="lasso")xt.minDrag=1;else xt.minDrag=undefined;if(V(a)){xt.xaxes=Q;xt.yaxes=tt;x(e,r,n,xt,a)}else{xt.clickFn=_t;bt();if(!lt){if(a==="zoom"){xt.moveFn=Ot;xt.doneFn=Dt;xt.minDrag=1;Pt(e,r,n)}else if(a==="pan"){xt.moveFn=Vt;xt.doneFn=Ht}}}};function bt(){xt.plotinfo.selection=false;b(S)}function _t(r,a){N(t);if(r===2&&!X)qt();if(F){h.click(t,a,e.id)}else if(r===1&&X){var i=A?$:Z,s=A==="s"||T==="w"?0:1,u=i._name+".range["+s+"]",c=L(i,s),f="left",p="middle";if(i.fixedrange)return;if(A){p=A==="n"?"top":"bottom";if(i.side==="right")f="right"}else if(T==="e")f="right";if(t._context.showAxisRangeEntryBoxes){n.select(yt).call(l.makeEditable,{gd:t,immediate:true,background:t._fullLayout.paper_bgcolor,text:String(c),fill:i.tickfont?i.tickfont.color:"#444",horizontalAlign:f,verticalAlign:p}).on("edit",function(e){var r=i.d2r(e);if(r!==undefined){o.call("relayout",t,u,r)}})}}}d.init(xt);var wt,kt,Mt,At,Tt,St,Et,Ct,Lt;var It;var zt={};function Pt(e,r,n){var i=yt.getBoundingClientRect();wt=r-i.left;kt=n-i.top;Mt={l:wt,r:wt,w:0,t:kt,b:kt,h:0};At=t._hmpixcount?t._hmlumcount/t._hmpixcount:a(t._fullLayout.plot_bgcolor).getLuminance();Tt="M0,0H"+nt+"V"+at+"H0V0";St=false;Et="xy";It=false;Ct=D(S,At,et,rt,Tt);Lt=R(S,et,rt)}function Ot(e,r){if(t._transitioningWithDuration){return false}var n=Math.max(0,Math.min(nt,e+wt)),a=Math.max(0,Math.min(at,r+kt)),i=Math.abs(n-wt),o=Math.abs(a-kt);Mt.l=Math.min(wt,n);Mt.r=Math.max(wt,n);Mt.t=Math.min(kt,a);Mt.b=Math.max(kt,a);function s(){Et="";Mt.r=Mt.l;Mt.t=Mt.b;Lt.attr("d","M0,0Z")}if(ut){if(i>M||o>M){Et="xy";if(i/nt>o/at){o=i*at/nt;if(kt>a)Mt.t=kt-o;else Mt.b=kt+o}else{i=o*nt/at;if(wt>n)Mt.l=wt-i;else Mt.r=wt+i}Lt.attr("d",H(Mt))}else{s()}}else if(!st||o<Math.min(Math.max(i*.6,k),M)){if(i<k||!ot){s()}else{Mt.t=0;Mt.b=at;Et="x";Lt.attr("d",U(Mt,kt))}}else if(!ot||i<Math.min(o*.6,M)){Mt.l=0;Mt.r=nt;Et="y";Lt.attr("d",q(Mt,wt))}else{Et="xy";Lt.attr("d",H(Mt))}Mt.w=Mt.r-Mt.l;Mt.h=Mt.b-Mt.t;if(Et)It=true;t._dragged=It;B(Ct,Lt,Mt,Tt,St,At);St=true}function Dt(){if(Math.min(Mt.h,Mt.w)<k*2){return N(t)}if(Et==="xy"||Et==="x"){I(Q,Mt.l/nt,Mt.r/nt,zt,it.xaxes)}if(Et==="xy"||Et==="y"){I(tt,(at-Mt.b)/at,(at-Mt.t)/at,zt,it.yaxes)}N(t);Ht();j(t)}var Rt=[0,0,nt,at];var Bt=null;var Ft=w.REDRAWDELAY;var Nt=e.mainplot?t._fullLayout._plots[e.mainplot]:e;function jt(e){if(!t._context.scrollZoom&&!t._fullLayout._enablescrollzoom){return}bt();if(t._transitioningWithDuration){e.preventDefault();e.stopPropagation();return}var r=t.querySelector(".plotly");gt();if(r.scrollHeight-r.clientHeight>10||r.scrollWidth-r.clientWidth>10){return}clearTimeout(Bt);var n=-e.deltaY;if(!isFinite(n))n=e.wheelDelta/10;if(!isFinite(n)){s.log("Did not find wheel motion attributes: ",e);return}var a=Math.exp(-Math.min(Math.max(n,-20),20)/200),i=Nt.draglayer.select(".nsewdrag").node().getBoundingClientRect(),o=(e.clientX-i.left)/i.width,l=(i.bottom-e.clientY)/i.height,u;function c(t,e,r){if(t.fixedrange)return;var n=s.simpleMap(t.range,t.r2l),a=n[0]+(n[1]-n[0])*e;function i(e){return t.l2r(a+(e-a)*r)}t.range=n.map(i)}if(ct){if(!T)o=.5;for(u=0;u<Q.length;u++){c(Q[u],o,a)}Rt[2]*=a;Rt[0]+=Rt[2]*o*(1/a-1)}if(ft){if(!A)l=.5;for(u=0;u<tt.length;u++){c(tt[u],l,a)}Rt[3]*=a;Rt[1]+=Rt[3]*(1-l)*(1/a-1)}Yt(Rt);Ut(A,T);Bt=setTimeout(function(){Rt=[0,0,nt,at];Ht()},Ft);e.preventDefault();return}if(A.length*T.length!==1){W(yt,jt)}function Vt(e,r){if(t._transitioningWithDuration){return}if(ot==="ew"||st==="ns"){if(ot)z(Q,e);if(st)z(tt,r);Yt([ot?-e:0,st?-r:0,nt,at]);Ut(st,ot);return}function n(t,e,r){var n=1-e,a,i;for(var o=0;o<t.length;o++){var s=t[o];if(s.fixedrange)continue;a=s;i=s._rl[n]+(s._rl[e]-s._rl[n])/P(r/s._length);var l=s.l2r(i);if(l!==false&&l!==undefined)s.range[e]=l}return a._length*(a._rl[e]-i)/(a._rl[e]-a._rl[n])}if(ut&&ot&&st){var a=ot==="w"===(st==="n")?1:-1;var i=(e/nt+a*r/at)/2;e=i*nt;r=a*i*at}if(ot==="w")e=n(Q,0,e);else if(ot==="e")e=n(Q,1,-e);else if(!ot)e=0;if(st==="n")r=n(tt,1,r);else if(st==="s")r=n(tt,0,-r);else if(!st)r=0;var o=ot==="w"?e:0;var s=st==="n"?r:0;if(ut){var l;if(!ot&&st.length===1){for(l=0;l<Q.length;l++){Q[l].range=Q[l]._r.slice();_(Q[l],1-r/at)}e=r*nt/at;o=e/2}if(!st&&ot.length===1){for(l=0;l<tt.length;l++){tt[l].range=tt[l]._r.slice();_(tt[l],1-e/nt)}r=e*at/nt;s=r/2}}Yt([o,s,nt-e,at-r]);Ut(st,ot)}function Ut(e,r){var n=[],a;function i(t){for(a=0;a<t.length;a++){if(!t[a].fixedrange)n.push(t[a]._id)}}if(ct){i(Q);i(it.xaxes)}if(ft){i(tt);i(it.yaxes)}zt={};for(a=0;a<n.length;a++){var s=n[a];m(t,s,true);var l=y(t,s);zt[l._name+".range[0]"]=l.range[0];zt[l._name+".range[1]"]=l.range[1]}function u(i,o,s){for(a=0;a<i.length;a++){var l=i[a];if(r&&n.indexOf(l.xref)!==-1||e&&n.indexOf(l.yref)!==-1){o(t,a);if(s)return}}}u(t._fullLayout.annotations||[],o.getComponentMethod("annotations","drawOne"));u(t._fullLayout.shapes||[],o.getComponentMethod("shapes","drawOne"));u(t._fullLayout.images||[],o.getComponentMethod("images","draw"),true)}function qt(){if(t._transitioningWithDuration)return;var e=t._context.doubleClick,r=(ot?Q:[]).concat(st?tt:[]),n={};var a,i,s;if(e==="reset+autosize"){e="autosize";for(i=0;i<r.length;i++){a=r[i];if(a._rangeInitial&&(a.range[0]!==a._rangeInitial[0]||a.range[1]!==a._rangeInitial[1])||!a._rangeInitial&&!a.autorange){e="reset";break}}}if(e==="autosize"){for(i=0;i<r.length;i++){a=r[i];if(!a.fixedrange)n[a._name+".autorange"]=true}}else if(e==="reset"){if(ot||ut)r=r.concat(it.xaxes);if(st&&!ut)r=r.concat(it.yaxes);if(ut){if(!ot)r=r.concat(Q);else if(!st)r=r.concat(tt)}for(i=0;i<r.length;i++){a=r[i];if(!a._rangeInitial){n[a._name+".autorange"]=true}else{s=a._rangeInitial;n[a._name+".range[0]"]=s[0];n[a._name+".range[1]"]=s[1]}}}t.emit("plotly_doubleclick",null);o.call("relayout",t,n)}function Ht(){Yt([0,0,nt,at]);s.syncOrAsync([g.previousPromises,function(){o.call("relayout",t,zt)}],t)}var Gt,Wt;function Yt(e){var r=t._fullLayout;var n=r._plots;var a=r._subplots.cartesian;var i,l,c,h;if(dt||ht){u(t)}if(dt){o.subplotsRegistry.splom.drag(t);if(pt)return}if(ht){for(i=0;i<a.length;i++){l=n[a[i]];c=l.xaxis;h=l.yaxis;var p=l._scene;if(p){var d=s.simpleMap(c.range,c.r2l);var v=s.simpleMap(h.range,h.r2l);p.update({range:[d[0],v[0],d[1],v[1]]})}}}if(vt){var g=e[2]/Z._length;var m=e[3]/$._length;for(i=0;i<a.length;i++){l=n[a[i]];c=l.xaxis;h=l.yaxis;var y=ct&&!c.fixedrange&&J[c._id];var x=ft&&!h.fixedrange&&K[h._id];var b,_;var w,k;if(y){b=g;w=T?e[0]:$t(c,b)}else{b=Xt(c,g,m);w=Zt(c,b)}if(x){_=m;k=A?e[1]:$t(h,_)}else{_=Xt(h,g,m);k=Zt(h,_)}if(!b&&!_){continue}if(!b)b=1;if(!_)_=1;var M=c._offset-w/b;var S=h._offset-k/_;l.clipRect.call(f.setTranslate,w,k).call(f.setScale,b,_);l.plot.call(f.setTranslate,M,S).call(f.setScale,1/b,1/_);if(b!==Gt||_!==Wt){f.setPointGroupScale(l.zoomScalePts,b,_);f.setTextPointsScale(l.zoomScaleTxt,b,_)}f.hideOutsideRangePoints(l.clipOnAxisFalseTraces,l);Gt=b;Wt=_}}}function Xt(t,e,r){if(t.fixedrange)return 0;if(ct&&it.xaHash[t._id]){return e}if(ft&&(ut?it.xaHash:it.yaHash)[t._id]){return r}return 0}function Zt(t,e){if(e){t.range=t._r.slice();_(t,e);return $t(t,e)}return 0}function $t(t,e){return t._length*(1-e)*v[t.constraintoward||"middle"]}return yt}function S(t,e,r,n){var a=s.ensureSingle(t.draglayer,e,r,function(e){e.classed("drag",true).style({fill:"transparent","stroke-width":0}).attr("data-subplot",t.id)});a.call(p,n);return a.node()}function E(t,e,r,a,i,o,s){var l=S(t,"rect",e,r);n.select(l).call(f.setRect,a,i,o,s);return l}function C(t,e){for(var r=0;r<t.length;r++){if(!t[r].fixedrange)return e}return""}function L(t,e){var r=t.range[e],a=Math.abs(r-t.range[1-e]),i;if(t.type==="date"){return r}else if(t.type==="log"){i=Math.ceil(Math.max(0,-Math.log(a)/Math.LN10))+3;return n.format("."+i+"g")(Math.pow(10,r))}else{i=Math.floor(Math.log(Math.abs(r))/Math.LN10)-Math.floor(Math.log(a)/Math.LN10)+4;return n.format("."+String(i)+"g")(r)}}function I(t,e,r,n,a){var i,o,s,l;for(i=0;i<t.length;i++){o=t[i];if(o.fixedrange)continue;s=o._rl[0];l=o._rl[1]-s;o.range=[o.l2r(s+l*e),o.l2r(s+l*r)];n[o._name+".range[0]"]=o.range[0];n[o._name+".range[1]"]=o.range[1]}if(a&&a.length){var u=(e+(1-r))/2;I(a,u,1-u,n)}}function z(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(!n.fixedrange){n.range=[n.l2r(n._rl[0]-e/n._m),n.l2r(n._rl[1]-e/n._m)]}}}function P(t){return 1-(t>=0?Math.min(t,.9):1/(1/Math.max(t,-.3)+3.222))}function O(t,e,r){if(!t)return"pointer";if(t==="nsew"){if(r)return"";if(e==="pan")return"move";return"crosshair"}return t.toLowerCase()+"-resize"}function D(t,e,r,n,a){return t.append("path").attr("class","zoombox").style({fill:e>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform","translate("+r+", "+n+")").attr("d",a+"Z")}function R(t,e,r){return t.append("path").attr("class","zoombox-corners").style({fill:c.background,stroke:c.defaultLine,"stroke-width":1,opacity:0}).attr("transform","translate("+e+", "+r+")").attr("d","M0,0Z")}function B(t,e,r,n,a,i){t.attr("d",n+"M"+r.l+","+r.t+"v"+r.h+"h"+r.w+"v-"+r.h+"h-"+r.w+"Z");F(t,e,a,i)}function F(t,e,r,n){if(!r){t.transition().style("fill",n>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200);e.transition().style("opacity",1).duration(200)}}function N(t){n.select(t).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function j(t){if(A&&t.data&&t._context.showTips){s.notifier(s._(t,"Double-click to zoom back out"),"long");A=false}}function V(t){return t==="lasso"||t==="select"}function U(t,e){return"M"+(t.l-.5)+","+(e-M-.5)+"h-3v"+(2*M+1)+"h3ZM"+(t.r+.5)+","+(e-M-.5)+"h3v"+(2*M+1)+"h-3Z"}function q(t,e){return"M"+(e-M-.5)+","+(t.t-.5)+"v-3h"+(2*M+1)+"v3ZM"+(e-M-.5)+","+(t.b+.5)+"v3h"+(2*M+1)+"v-3Z"}function H(t){var e=Math.floor(Math.min(t.b-t.t,t.r-t.l,M)/2);return"M"+(t.l-3.5)+","+(t.t-.5+e)+"h3v"+-e+"h"+e+"v-3h-"+(e+3)+"ZM"+(t.r+3.5)+","+(t.t-.5+e)+"h-3v"+-e+"h"+-e+"v-3h"+(e+3)+"ZM"+(t.r+3.5)+","+(t.b+.5-e)+"h-3v"+e+"h"+-e+"v3h"+(e+3)+"ZM"+(t.l-3.5)+","+(t.b+.5-e)+"h3v"+e+"h"+e+"v3h-"+(e+3)+"Z"}function G(t,e,r){var n=t._fullLayout._axisConstraintGroups;var a=false;var i={};var o={};var l,u,c,f;for(var h=0;h<n.length;h++){var p=n[h];for(l in e){if(p[l]){for(c in p){if(!(c.charAt(0)==="x"?e:r)[c]){i[c]=1}}for(u in r){if(p[u])a=true}}}for(u in r){if(p[u]){for(f in p){if(!(f.charAt(0)==="x"?e:r)[f]){o[f]=1}}}}}if(a){s.extendFlat(i,o);o={}}var d={};var v=[];for(c in i){var g=y(t,c);v.push(g);d[g._id]=g}var m={};var x=[];for(f in o){var b=y(t,f);x.push(b);m[b._id]=b}return{xaHash:d,yaHash:m,xaxes:v,yaxes:x,isSubplotConstrained:a}}function W(t,e){if(!i){if(t.onwheel!==undefined)t.onwheel=e;else if(t.onmousewheel!==undefined)t.onmousewheel=e}else{var r=t.onwheel!==undefined?"wheel":"mousewheel";if(t._onwheel){t.removeEventListener(r,t._onwheel)}t._onwheel=e;t.addEventListener(r,e,{passive:false})}}function Y(t){var e=[];for(var r in t)e.push(t[r]);return e}e.exports={makeDragBox:T,makeDragger:S,makeRectDragger:E,makeZoombox:D,makeCorners:R,updateZoombox:B,xyCorners:H,transitionZoombox:F,removeZoombox:N,showDoubleClickNotifier:j,attachWheelEventHandler:W}},{"../../components/color":558,"../../components/dragelement":580,"../../components/drawing":583,"../../components/fx":600,"../../constants/alignment":656,"../../lib":684,"../../lib/clear_gl_canvases":668,"../../lib/setcursor":704,"../../lib/svg_text_utils":708,"../../registry":817,"../plots":795,"./axes":732,"./axis_ids":735,"./constants":737,"./scale_zoom":748,"./select":749,d3:147,"has-passive-events":379,tinycolor2:499}],741:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/fx");var i=t("../../components/dragelement");var o=t("../../lib/setcursor");var s=t("./dragbox").makeDragBox;var l=t("./constants").DRAGGERSIZE;r.initInteractions=function t(e){var o=e._fullLayout;if(e._context.staticPlot){n.select(e).selectAll(".drag").remove();return}if(!o._has("cartesian")&&!o._has("gl2d")&&!o._has("splom"))return;var u=Object.keys(o._plots||{}).sort(function(t,e){if((o._plots[t].mainplot&&true)===(o._plots[e].mainplot&&true)){var r=t.split("y"),n=e.split("y");return r[0]===n[0]?Number(r[1]||1)-Number(n[1]||1):Number(r[0]||1)-Number(n[0]||1)}return o._plots[t].mainplot?1:-1});u.forEach(function(t){var r=o._plots[t];var n=r.xaxis;var u=r.yaxis;if(!r.mainplot){var c=s(e,r,n._offset,u._offset,n._length,u._length,"ns","ew");c.onmousemove=function(r){e._fullLayout._rehover=function(){if(e._fullLayout._hoversubplot===t){a.hover(e,r,t)}};a.hover(e,r,t);e._fullLayout._lasthover=c;e._fullLayout._hoversubplot=t};c.onmouseout=function(t){if(e._dragging)return;e._fullLayout._hoversubplot=null;i.unhover(e,t)};if(e._context.showAxisDragHandles){s(e,r,n._offset-l,u._offset-l,l,l,"n","w");s(e,r,n._offset+n._length,u._offset-l,l,l,"n","e");s(e,r,n._offset-l,u._offset+u._length,l,l,"s","w");s(e,r,n._offset+n._length,u._offset+u._length,l,l,"s","e")}}if(e._context.showAxisDragHandles){if(t===n._mainSubplot){var f=n._mainLinePosition;if(n.side==="top")f-=l;s(e,r,n._offset+n._length*.1,f,n._length*.8,l,"","ew");s(e,r,n._offset,f,n._length*.1,l,"","w");s(e,r,n._offset+n._length*.9,f,n._length*.1,l,"","e")}if(t===u._mainSubplot){var h=u._mainLinePosition;if(u.side!=="right")h-=l;s(e,r,h,u._offset+u._length*.1,l,u._length*.8,"ns","");s(e,r,h,u._offset+u._length*.9,l,u._length*.1,"s","");s(e,r,h,u._offset,l,u._length*.1,"n","")}}});var c=o._hoverlayer.node();c.onmousemove=function(t){t.target=e._fullLayout._lasthover;a.hover(e,t,o._hoversubplot)};c.onclick=function(t){t.target=e._fullLayout._lasthover;a.click(e,t)};c.onmousedown=function(t){e._fullLayout._lasthover.onmousedown(t)};r.updateFx(o)};r.updateFx=function(t){var e=t.dragmode==="pan"?"move":"crosshair";o(t._draggers,e)}},{"../../components/dragelement":580,"../../components/fx":600,"../../lib/setcursor":704,"./constants":737,"./dragbox":740,d3:147}],742:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");e.exports=function t(e){return function t(r,i){var o=r[e];if(!Array.isArray(o))return;var s=n.subplotsRegistry.cartesian;var l=s.idRegex;var u=i._subplots;var c=u.xaxis;var f=u.yaxis;var h=u.cartesian;var p=i._has("cartesian")||i._has("gl2d");for(var d=0;d<o.length;d++){var v=o[d];if(!a.isPlainObject(v))continue;var g=v.xref;var m=v.yref;var y=l.x.test(g);var x=l.y.test(m);if(y||x){if(!p)a.pushUnique(i._basePlotModules,s);var b=false;if(y&&c.indexOf(g)===-1){c.push(g);b=true}if(x&&f.indexOf(m)===-1){f.push(m);b=true}if(b&&y&&x){h.push(g+m)}}}}}},{"../../lib":684,"../../registry":817}],743:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../registry");var i=t("../../lib");var o=t("../plots");var s=t("../../components/drawing");var l=t("../get_data").getModuleCalcData;var u=t("./axis_ids");var c=t("./constants");var f=t("../../constants/xmlns_namespaces");var h=i.ensureSingle;function p(t,e,r){return i.ensureSingle(t,e,r,function(t){t.datum(r)})}r.name="cartesian";r.attr=["xaxis","yaxis"];r.idRoot=["x","y"];r.idRegex=c.idRegex;r.attrRegex=c.attrRegex;r.attributes=t("./attributes");r.layoutAttributes=t("./layout_attributes");r.supplyLayoutDefaults=t("./layout_defaults");r.transitionAxes=t("./transition_axes");r.finalizeSubplots=function(t,e){var r=e._subplots;var n=r.xaxis;var a=r.yaxis;var o=r.cartesian;var s=o.concat(r.gl2d||[]);var l={};var f={};var h,p,d;for(h=0;h<s.length;h++){var v=s[h].split("y");l[v[0]]=1;f["y"+v[1]]=1}for(h=0;h<n.length;h++){p=n[h];if(!l[p]){d=(t[u.id2name(p)]||{}).anchor;if(!c.idRegex.y.test(d))d="y";o.push(p+d);s.push(p+d);if(!f[d]){f[d]=1;i.pushUnique(a,d)}}}for(h=0;h<a.length;h++){d=a[h];if(!f[d]){p=(t[u.id2name(d)]||{}).anchor;if(!c.idRegex.x.test(p))p="x";o.push(p+d);s.push(p+d);if(!l[p]){l[p]=1;i.pushUnique(n,p)}}}if(!s.length){p="";d="";for(var g in t){if(c.attrRegex.test(g)){var m=g.charAt(0);if(m==="x"){if(!p||+g.substr(5)<+p.substr(5)){p=g}}else if(!d||+g.substr(5)<+d.substr(5)){d=g}}}p=p?u.name2id(p):"x";d=d?u.name2id(d):"y";n.push(p);a.push(d);o.push(p+d)}};r.plot=function(t,e,r,n){var a=t._fullLayout;var i=a._subplots.cartesian;var o=t.calcdata;var s;if(!Array.isArray(e)){e=[];for(s=0;s<o.length;s++)e.push(s)}for(s=0;s<i.length;s++){var l=i[s];var u=a._plots[l];var c=[];var f;for(var h=0;h<o.length;h++){var p=o[h];var v=p[0].trace;if(v.xaxis+v.yaxis===l){if(e.indexOf(v.index)!==-1||v.carpet){if(f&&f[0].trace.xaxis+f[0].trace.yaxis===l&&["tonextx","tonexty","tonext"].indexOf(v.fill)!==-1&&c.indexOf(f)===-1){c.push(f)}c.push(p)}f=p}}d(t,u,c,r,n)}};function d(t,e,r,i,o){var u=c.traceLayerClasses;var f=t._fullLayout;var h=f._modules;var p,d,v;var g=[];var m=[];for(var y=0;y<h.length;y++){p=h[y];var x=p.name;var b=a.modules[x].categories;if(b.svg){var _=p.layerName||x+"layer";var w=p.plot;d=l(r,w);v=d[0];r=d[1];if(v.length){g.push({i:u.indexOf(_),className:_,plotMethod:w,cdModule:v})}if(b.zoomScale){m.push("."+_)}}}g.sort(function(t,e){return t.i-e.i});var k=e.plot.selectAll("g.mlayer").data(g,function(t){return t.className});k.enter().append("g").attr("class",function(t){return t.className}).classed("mlayer",true);k.exit().remove();k.order();k.each(function(r){var a=n.select(this);var l=r.className;r.plotMethod(t,e,r.cdModule,a,i,o);if(l!=="scatterlayer"&&l!=="barlayer"){s.setClipUrl(a,e.layerClipId)}});if(f._has("scattergl")){p=a.getModule("scattergl");v=l(r,p)[0];p.plot(t,e,v)}if(!t._context.staticPlot){if(e._hasClipOnAxisFalse){e.clipOnAxisFalseTraces=e.plot.selectAll(".scatterlayer, .barlayer").selectAll(".trace")}if(m.length){var M=e.plot.selectAll(m.join(",")).selectAll(".trace");e.zoomScalePts=M.selectAll("path.point");e.zoomScaleTxt=M.selectAll(".textpoint")}}}r.clean=function(t,e,r,n){var a=n._plots||{};var i=e._plots||{};var o=n._subplots||{};var s;var l,c;if(n._hasOnlyLargeSploms&&!e._hasOnlyLargeSploms){for(c in a){s=a[c];if(s.plotgroup)s.plotgroup.remove()}}var f=n._has&&n._has("gl");var h=e._has&&e._has("gl");if(f&&!h){for(c in a){s=a[c];if(s._scene)s._scene.destroy()}}if(o.xaxis&&o.yaxis){var p=u.listIds({_fullLayout:n});for(l=0;l<p.length;l++){var d=p[l];if(!e[u.id2name(d)]){n._infolayer.selectAll(".g-"+d+"title").remove()}}}var v=n._has&&n._has("cartesian");var g=e._has&&e._has("cartesian");if(v&&!g){m(n._cartesianlayer.selectAll(".subplot"),n);n._defs.selectAll(".axesclip").remove();delete n._axisConstraintGroups}else if(o.cartesian){for(l=0;l<o.cartesian.length;l++){var x=o.cartesian[l];if(!i[x]){var b="."+x+",."+x+"-x,."+x+"-y";n._cartesianlayer.selectAll(b).remove();y(x,n)}}}};r.drawFramework=function(t){var e=t._fullLayout;var r=v(t);var a=e._cartesianlayer.selectAll(".subplot").data(r,i.identity);a.enter().append("g").attr("class",function(t){return"subplot "+t});a.order();a.exit().call(m,e);a.each(function(r){var a=e._plots[r];a.plotgroup=n.select(this);a.overlays=[];g(t,a);if(a.mainplot){var i=e._plots[a.mainplot];i.overlays.push(a)}a.draglayer=h(e._draggers,"g",r)})};r.rangePlot=function(t,e,r){g(t,e);d(t,e,r);o.style(t)};function v(t){var e=t._fullLayout;var r=[];var n=[];for(var a in e._plots){var i=e._plots[a];var o=i.xaxis._mainAxis;var s=i.yaxis._mainAxis;var l=o._id+s._id;if(l!==a&&e._plots[l]){i.mainplot=l;i.mainplotinfo=e._plots[l];n.push(a)}else{r.push(a);i.mainplot=undefined}}r=r.concat(n);return r}function g(t,e){var r=e.plotgroup;var n=e.id;var a=c.layerValue2layerClass[e.xaxis.layer];var i=c.layerValue2layerClass[e.yaxis.layer];var o=t._fullLayout._hasOnlyLargeSploms;if(!e.mainplot){if(o){e.plot=h(r,"g","plot");e.xlines=h(r,"path","xlines-above");e.ylines=h(r,"path","ylines-above");e.xaxislayer=h(r,"g","xaxislayer-above");e.yaxislayer=h(r,"g","yaxislayer-above")}else{var s=h(r,"g","layer-subplot");e.shapelayer=h(s,"g","shapelayer");e.imagelayer=h(s,"g","imagelayer");e.gridlayer=h(r,"g","gridlayer");e.zerolinelayer=h(r,"g","zerolinelayer");h(r,"path","xlines-below");h(r,"path","ylines-below");e.overlinesBelow=h(r,"g","overlines-below");h(r,"g","xaxislayer-below");h(r,"g","yaxislayer-below");e.overaxesBelow=h(r,"g","overaxes-below");e.plot=h(r,"g","plot");e.overplot=h(r,"g","overplot");e.xlines=h(r,"path","xlines-above");e.ylines=h(r,"path","ylines-above");e.overlinesAbove=h(r,"g","overlines-above");h(r,"g","xaxislayer-above");h(r,"g","yaxislayer-above");e.overaxesAbove=h(r,"g","overaxes-above");e.xlines=r.select(".xlines-"+a);e.ylines=r.select(".ylines-"+i);e.xaxislayer=r.select(".xaxislayer-"+a);e.yaxislayer=r.select(".yaxislayer-"+i)}}else{var l=e.mainplotinfo;var f=l.plotgroup;var d=n+"-x";var v=n+"-y";e.gridlayer=l.gridlayer;e.zerolinelayer=l.zerolinelayer;h(l.overlinesBelow,"path",d);h(l.overlinesBelow,"path",v);h(l.overaxesBelow,"g",d);h(l.overaxesBelow,"g",v);e.plot=h(l.overplot,"g",n);h(l.overlinesAbove,"path",d);h(l.overlinesAbove,"path",v);h(l.overaxesAbove,"g",d);h(l.overaxesAbove,"g",v);e.xlines=f.select(".overlines-"+a).select("."+d);e.ylines=f.select(".overlines-"+i).select("."+v);e.xaxislayer=f.select(".overaxes-"+a).select("."+d);e.yaxislayer=f.select(".overaxes-"+i).select("."+v)}if(!o){p(e.gridlayer,"g",e.xaxis._id);p(e.gridlayer,"g",e.yaxis._id);e.gridlayer.selectAll("g").sort(u.idSort)}e.xlines.style("fill","none").classed("crisp",true);e.ylines.style("fill","none").classed("crisp",true)}function m(t,e){if(!t)return;var r={};t.each(function(t){var a=n.select(this);a.remove();y(t,e);r[t]=true});for(var a in e._plots){var i=e._plots[a];var o=i.overlays||[];for(var s=0;s<o.length;s++){var l=o[s];if(r[l.id]){l.plot.selectAll(".trace").remove()}}}}function y(t,e){e._draggers.selectAll("g."+t).remove();e._defs.select("#clip"+e._uid+t+"plot").remove()}r.toSVG=function(t){var e=t._fullLayout._glimages;var r=n.select(t).selectAll(".svg-container");var a=r.filter(function(t,e){return e===r.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function i(){var t=this;var r=t.toDataURL("image/png");var n=e.append("svg:image");n.attr({xmlns:f.svg,"xlink:href":r,preserveAspectRatio:"none",x:0,y:0,width:t.width,height:t.height})}a.each(i)};r.updateFx=t("./graph_interact").updateFx},{"../../components/drawing":583,"../../constants/xmlns_namespaces":663,"../../lib":684,"../../registry":817,"../get_data":768,"../plots":795,"./attributes":730,"./axis_ids":735,"./constants":737,"./graph_interact":741,"./layout_attributes":744,"./layout_defaults":745,"./transition_axes":754,d3:147}],744:[function(t,e,r){"use strict";var n=t("../font_attributes");var a=t("../../components/color/attributes");var i=t("../../components/drawing/attributes").dash;var o=t("../../lib/extend").extendFlat;var s=t("../../plot_api/plot_template").templatedArray;var l=t("./constants");e.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:a.defaultLine,editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:n({editType:"ticks"}),type:{valType:"enumerated",values:["-","linear","log","date","category"],dflt:"-",editType:"calc",_noTemplating:true},autorange:{valType:"enumerated",values:[true,false,"reversed"],dflt:true,editType:"calc",impliedEdits:{"range[0]":undefined,"range[1]":undefined}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":false}},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":false}}],editType:"axrange",impliedEdits:{autorange:false}},fixedrange:{valType:"boolean",dflt:false,editType:"calc"},scaleanchor:{valType:"enumerated",values:[l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],dflt:"range",editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:undefined,dtick:undefined}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},mirror:{valType:"enumerated",values:[true,"ticks",false,"all","allticks"],dflt:false,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:a.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:true,editType:"ticks"},automargin:{valType:"boolean",dflt:false,editType:"ticks"},showspikes:{valType:"boolean",dflt:false,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:o({},i,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor"],dflt:"data",editType:"none"},tickfont:n({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},separatethousands:{valType:"boolean",dflt:false,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks"},tickformatstops:s("tickformatstop",{enabled:{valType:"boolean",dflt:true,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none"},showline:{valType:"boolean",dflt:false,editType:"layoutstyle"},linecolor:{valType:"color",dflt:a.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:a.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:a.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"}}}},{"../../components/color/attributes":557,"../../components/drawing/attributes":582,"../../lib/extend":673,"../../plot_api/plot_template":722,"../font_attributes":758,"./constants":737}],745:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");var i=t("../../components/color");var o=t("../../plot_api/plot_template");var s=t("../layout_attributes");var l=t("./layout_attributes");var u=t("./type_defaults");var c=t("./axis_defaults");var f=t("./constraint_defaults");var h=t("./position_defaults");var p=t("./axis_ids");e.exports=function t(e,r,d){var v={};var g={};var m={};var y={};var x;for(x=0;x<d.length;x++){var b=d[x];if(!n.traceIs(b,"cartesian")&&!n.traceIs(b,"gl2d")){continue}var _=p.id2name(b.xaxis);var w=p.id2name(b.yaxis);if(!n.traceIs(b,"carpet")||b.type==="carpet"&&!b._cheater){if(_)g[_]=1}if(b.type==="carpet"&&b._cheater){if(_)v[_]=1}if(n.traceIs(b,"2dMap")){m[_]=true;m[w]=true}if(n.traceIs(b,"oriented")){var k=b.orientation==="h"?w:_;y[k]=true}}var M=r._subplots;var A=M.xaxis;var T=M.yaxis;var S=a.simpleMap(A,p.id2name);var E=a.simpleMap(T,p.id2name);var C=S.concat(E);var L=i.background;if(A.length&&T.length){L=a.coerce(e,r,s,"plot_bgcolor")}var I=i.combine(L,r.paper_bgcolor);var z,P,O,D;function R(t,e){return a.coerce(O,D,l,t,e)}function B(t,e){return a.coerce2(O,D,l,t,e)}function F(t){return t==="x"?T:A}var N={x:F("x"),y:F("y")};function j(t,r){var n=t==="x"?S:E;var a=[];for(var i=0;i<n.length;i++){var o=n[i];if(o!==r&&!(e[o]||{}).overlaying){a.push(p.name2id(o))}}return a}for(x=0;x<C.length;x++){z=C[x];P=z.charAt(0);if(!a.isPlainObject(e[z])){e[z]={}}O=e[z];D=o.newContainer(r,z,P+"axis");u(O,D,R,d,z);var V=j(P,z);var U={letter:P,font:r.font,outerTicks:m[z],showGrid:!y[z],data:d,bgColor:I,calendar:r.calendar,automargin:true,cheateronly:P==="x"&&v[z]&&!g[z]};c(O,D,R,U,r);var q=B("spikecolor"),H=B("spikethickness"),G=B("spikedash"),W=B("spikemode"),Y=B("spikesnap"),X=R("showspikes",!!q||!!H||!!G||!!W||!!Y);if(!X){delete D.spikecolor;delete D.spikethickness;delete D.spikedash;delete D.spikemode;delete D.spikesnap}var Z={letter:P,counterAxes:N[P],overlayableAxes:V,grid:r.grid};h(O,D,R,Z);D._input=O}var $=n.getComponentMethod("rangeslider","handleDefaults");var J=n.getComponentMethod("rangeselector","handleDefaults");for(x=0;x<S.length;x++){z=S[x];O=e[z];D=r[z];$(e,r,z);if(D.type==="date"){J(O,D,r,E,D.calendar)}R("fixedrange")}for(x=0;x<E.length;x++){z=E[x];O=e[z];D=r[z];var K=r[p.id2name(D.anchor)];var Q=K&&K.rangeslider&&K.rangeslider.visible;R("fixedrange",Q)}r._axisConstraintGroups=[];var tt=N.x.concat(N.y);for(x=0;x<C.length;x++){z=C[x];P=z.charAt(0);O=e[z];D=r[z];f(O,D,R,tt,r)}}},{"../../components/color":558,"../../lib":684,"../../plot_api/plot_template":722,"../../registry":817,"../layout_attributes":786,"./axis_defaults":734,"./axis_ids":735,"./constraint_defaults":738,"./layout_attributes":744,"./position_defaults":747,"./type_defaults":755}],746:[function(t,e,r){"use strict";var n=t("tinycolor2").mix;var a=t("../../components/color/attributes").lightFraction;var i=t("../../lib");e.exports=function t(e,r,o,s){s=s||{};var l=s.dfltColor;function u(t,n){return i.coerce2(e,r,s.attributes,t,n)}var c=u("linecolor",l);var f=u("linewidth");var h=o("showline",s.showLine||!!c||!!f);if(!h){delete r.linecolor;delete r.linewidth}var p=n(l,s.bgColor,s.blend||a).toRgbString();var d=u("gridcolor",p);var v=u("gridwidth");var g=o("showgrid",s.showGrid||!!d||!!v);if(!g){delete r.gridcolor;delete r.gridwidth}if(!s.noZeroLine){var m=u("zerolinecolor",l);var y=u("zerolinewidth");var x=o("zeroline",s.showGrid||!!m||!!y);if(!x){delete r.zerolinecolor;delete r.zerolinewidth}}}},{"../../components/color/attributes":557,"../../lib":684,tinycolor2:499}],747:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib");e.exports=function t(e,r,i,o){var s=o.counterAxes||[];var l=o.overlayableAxes||[];var u=o.letter;var c=o.grid;var f,h,p,d;if(c){h=c._domains[u][c._axisMap[r._id]];f=c._anchors[r._id];if(h){p=c[u+"side"].split(" ")[0];d=c.domain[u][p==="right"||p==="top"?1:0]}}h=h||[0,1];f=f||(n(e.position)?"free":s[0]||"free");p=p||(u==="x"?"bottom":"left");d=d||0;var v=a.coerce(e,r,{anchor:{valType:"enumerated",values:["free"].concat(s),dflt:f}},"anchor");if(v==="free")i("position",d);a.coerce(e,r,{side:{valType:"enumerated",values:u==="x"?["bottom","top"]:["left","right"],dflt:p}},"side");var g=false;if(l.length){g=a.coerce(e,r,{overlaying:{valType:"enumerated",values:[false].concat(l),dflt:false}},"overlaying")}if(!g){var m=i("domain",h);if(m[0]>m[1]-.01)r.domain=h;a.noneOrAll(e.domain,r.domain,h)}i("layer");return r}},{"../../lib":684,"fast-isnumeric":214}],748:[function(t,e,r){"use strict";var n=t("../../constants/alignment").FROM_BL;e.exports=function t(e,r,a){if(a===undefined){a=n[e.constraintoward||"center"]}var i=[e.r2l(e.range[0]),e.r2l(e.range[1])];var o=i[0]+(i[1]-i[0])*a;e.range=e._input.range=[e.l2r(o+(i[0]-o)*r),e.l2r(o+(i[1]-o)*r)]}},{"../../constants/alignment":656}],749:[function(t,e,r){"use strict";var n=t("polybooljs");var a=t("../../registry");var i=t("../../components/color");var o=t("../../components/fx");var s=t("../../lib/polygon");var l=t("../../lib/throttle");var u=t("../../components/fx/helpers").makeEventData;var c=t("./axis_ids").getFromId;var f=t("../sort_modules").sortModules;var h=t("./constants");var p=h.MINSELECT;var d=s.filter;var v=s.tester;var g=s.multitester;function m(t){return t._id}function y(t,e,r,n,a){var s=n.gd;var u=s._fullLayout;var f=u._zoomlayer;var y=n.element.getBoundingClientRect();var k=n.plotinfo;var M=k.xaxis._offset;var A=k.yaxis._offset;var T=e-y.left;var S=r-y.top;var E=T;var C=S;var L="M"+T+","+S;var I=n.xaxes[0]._length;var z=n.yaxes[0]._length;var P=n.xaxes.map(m);var O=n.yaxes.map(m);var D=n.xaxes.concat(n.yaxes);var R=t.altKey;var B,F,N,j;var V,U,q,H,G;var W=u._lastSelectedSubplot&&u._lastSelectedSubplot===k.id;if(W&&(t.shiftKey||t.altKey)&&(k.selection&&k.selection.polygons)&&!n.polygons){n.polygons=k.selection.polygons;n.mergedPolygons=k.selection.mergedPolygons}else if(!t.shiftKey&&!t.altKey||(t.shiftKey||t.altKey)&&!k.selection){k.selection={};k.selection.polygons=n.polygons=[];k.selection.mergedPolygons=n.mergedPolygons=[]}if(!W){w(f);u._lastSelectedSubplot=k.id}if(a==="lasso"){B=d([[T,S]],h.BENDPX)}var Y=f.selectAll("path.select-outline-"+k.id).data([1,2]);Y.enter().append("path").attr("class",function(t){return"select-outline select-outline-"+t+" select-outline-"+k.id}).attr("transform","translate("+M+", "+A+")").attr("d",L+"Z");var X=f.append("path").attr("class","zoombox-corners").style({fill:i.background,stroke:i.defaultLine,"stroke-width":1}).attr("transform","translate("+M+", "+A+")").attr("d","M0,0Z");var Z=[];var $=u._uid+h.SELECTID;var J=[];for(V=0;V<s.calcdata.length;V++){U=s.calcdata[V];q=U[0].trace;if(q.visible!==true||!q._module||!q._module.selectPoints)continue;if(n.subplot){if(q.subplot===n.subplot||q.geo===n.subplot){Z.push({_module:q._module,cd:U,xaxis:n.xaxes[0],yaxis:n.yaxes[0]})}}else if(q.type==="splom"&&q._xaxes[P[0]]&&q._yaxes[O[0]]){Z.push({_module:q._module,cd:U,xaxis:n.xaxes[0],yaxis:n.yaxes[0]})}else{if(P.indexOf(q.xaxis)===-1)continue;if(O.indexOf(q.yaxis)===-1)continue;Z.push({_module:q._module,cd:U,xaxis:c(s,q.xaxis),yaxis:c(s,q.yaxis)})}}function K(t){var e=t._id.charAt(0)==="y"?1:0;return function(r){return t.p2d(r[e])}}function Q(t,e){return t-e}var tt;if(k.fillRangeItems){tt=k.fillRangeItems}else{if(a==="select"){tt=function(t,e){var r=t.range={};for(V=0;V<D.length;V++){var n=D[V];var a=n._id.charAt(0);r[n._id]=[n.p2d(e[a+"min"]),n.p2d(e[a+"max"])].sort(Q)}}}else{tt=function(t,e,r){var n=t.lassoPoints={};for(V=0;V<D.length;V++){var a=D[V];n[a._id]=r.filtered.map(K(a))}}}}n.moveFn=function(t,e){E=Math.max(0,Math.min(I,t+T));C=Math.max(0,Math.min(z,e+S));var r=Math.abs(E-T),i=Math.abs(C-S);if(a==="select"){var o=u.selectdirection;if(u.selectdirection==="any"){if(i<Math.min(r*.6,p))o="h";else if(r<Math.min(i*.6,p))o="v";else o="d"}else{o=u.selectdirection}if(o==="h"){j=[[T,0],[T,z],[E,z],[E,0]];j.xmin=Math.min(T,E);j.xmax=Math.max(T,E);j.ymin=Math.min(0,z);j.ymax=Math.max(0,z);X.attr("d","M"+j.xmin+","+(S-p)+"h-4v"+2*p+"h4Z"+"M"+(j.xmax-1)+","+(S-p)+"h4v"+2*p+"h-4Z")}else if(o==="v"){j=[[0,S],[0,C],[I,C],[I,S]];j.xmin=Math.min(0,I);j.xmax=Math.max(0,I);j.ymin=Math.min(S,C);j.ymax=Math.max(S,C);X.attr("d","M"+(T-p)+","+j.ymin+"v-4h"+2*p+"v4Z"+"M"+(T-p)+","+(j.ymax-1)+"v4h"+2*p+"v-4Z")}else if(o==="d"){j=[[T,S],[T,C],[E,C],[E,S]];j.xmin=Math.min(T,E);j.xmax=Math.max(T,E);j.ymin=Math.min(S,C);j.ymax=Math.max(S,C);X.attr("d","M0,0Z")}}else if(a==="lasso"){B.addPt([E,C]);j=B.filtered}if(n.polygons&&n.polygons.length){N=b(n.mergedPolygons,j,R);j.subtract=R;F=g(n.polygons.concat([j]))}else{N=[j];F=v(j)}var c=[];for(V=0;V<N.length;V++){var f=N[V];c.push(f.join("L")+"L"+f[0])}Y.attr("d","M"+c.join("M")+"Z");l.throttle($,h.SELECTDELAY,function(){J=[];var t,e=[],r;for(V=0;V<Z.length;V++){H=Z[V];r=H._module.selectPoints(H,F);e.push(r);t=_(r,H);if(J.length){for(var a=0;a<t.length;a++){J.push(t[a])}}else J=t}G={points:J};x(s,Z,G);tt(G,j,B);n.gd.emit("plotly_selecting",G)})};n.clickFn=function(t,e){X.remove();l.done($).then(function(){l.clear($);if(t===2){Y.remove();for(V=0;V<Z.length;V++){H=Z[V];H._module.selectPoints(H,false)}x(s,Z);s.emit("plotly_deselect",null)}else{s.emit("plotly_selected",undefined)}o.click(s,e)})};n.doneFn=function(){X.remove();l.done($).then(function(){l.clear($);n.gd.emit("plotly_selected",G);if(j&&n.polygons){j.subtract=R;n.polygons.push(j);n.mergedPolygons.length=0;[].push.apply(n.mergedPolygons,N)}})}}function x(t,e,r){var n,i,o,s;if(r){var l=r.points||[];for(n=0;n<e.length;n++){s=e[n].cd[0].trace;s.selectedpoints=[];s._input.selectedpoints=[]}for(n=0;n<l.length;n++){var u=l[n];var c=u.data;var h=u.fullData;if(u.pointIndices){[].push.apply(c.selectedpoints,u.pointIndices);[].push.apply(h.selectedpoints,u.pointIndices)}else{c.selectedpoints.push(u.pointIndex);h.selectedpoints.push(u.pointIndex)}}}else{for(n=0;n<e.length;n++){s=e[n].cd[0].trace;delete s.selectedpoints;delete s._input.selectedpoints}}var p={};for(n=0;n<e.length;n++){o=e[n];var d=o._module.name;if(p[d]){p[d].push(o)}else{p[d]=[o]}}var v=Object.keys(p).sort(f);for(n=0;n<v.length;n++){var g=p[v[n]];var m=g.length;var y=g[0];var x=y.cd[0].trace;var b=y._module;var _=b.styleOnSelect||b.style;if(a.traceIs(x,"regl")){var w=new Array(m);for(i=0;i<m;i++){w[i]=g[i].cd}_(t,w)}else{for(i=0;i<m;i++){_(t,g[i].cd)}}}}function b(t,e,r){var a;if(r){a=n.difference({regions:t,inverted:false},{regions:[e],inverted:false});return a.regions}a=n.union({regions:t,inverted:false},{regions:[e],inverted:false});return a.regions}function _(t,e){if(Array.isArray(t)){var r=e.cd;var n=e.cd[0].trace;for(var a=0;a<t.length;a++){t[a]=u(t[a],n,r)}}return t}function w(t){t.selectAll(".select-outline").remove()}e.exports={prepSelect:y,clearSelect:w}},{"../../components/color":558,"../../components/fx":600,"../../components/fx/helpers":597,"../../lib/polygon":696,"../../lib/throttle":709,"../../registry":817,"../sort_modules":808,"./axis_ids":735,"./constants":737,polybooljs:440}],750:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("../../lib");var o=i.cleanNumber;var s=i.ms2DateTime;var l=i.dateTime2ms;var u=i.ensureNumber;var c=t("../../constants/numerical");var f=c.FP_SAFE;var h=c.BADNUM;var p=t("./constants");var d=t("./axis_ids");function v(t){return Math.pow(10,t)}e.exports=function t(e,r){r=r||{};var c=(e._id||"x").charAt(0);var g=10;function m(t,r){if(t>0)return Math.log(t)/Math.LN10;else if(t<=0&&r&&e.range&&e.range.length===2){var n=e.range[0],a=e.range[1];return.5*(n+a-3*g*Math.abs(n-a))}else return h}function y(t,r,n){var i=l(t,n||e.calendar);if(i===h){if(a(t))i=l(new Date(+t));else return h}return i}function x(t,r,n){return s(t,r,n||e.calendar)}function b(t){return e._categories[Math.round(t)]}function _(t){if(t!==null&&t!==undefined){if(e._categoriesMap===undefined){e._categoriesMap={}}if(e._categoriesMap[t]!==undefined){return e._categoriesMap[t]}else{e._categories.push(t);var r=e._categories.length-1;e._categoriesMap[t]=r;return r}}return h}function w(t){if(e._categoriesMap){var r=e._categoriesMap[t];if(r!==undefined)return r}if(a(t))return+t}function k(t){if(!a(t))return h;return n.round(e._b+e._m*t,2)}function M(t){return(t-e._b)/e._m}e.c2l=e.type==="log"?m:u;e.l2c=e.type==="log"?v:u;e.l2p=k;e.p2l=M;e.c2p=e.type==="log"?function(t,e){return k(m(t,e))}:k;e.p2c=e.type==="log"?function(t){return v(M(t))}:M;if(["linear","-"].indexOf(e.type)!==-1){e.d2r=e.r2d=e.d2c=e.r2c=e.d2l=e.r2l=o;e.c2d=e.c2r=e.l2d=e.l2r=u;e.d2p=e.r2p=function(t){return e.l2p(o(t))};e.p2d=e.p2r=M;e.cleanPos=u}else if(e.type==="log"){e.d2r=e.d2l=function(t,e){return m(o(t),e)};e.r2d=e.r2c=function(t){return v(o(t))};e.d2c=e.r2l=o;e.c2d=e.l2r=u;e.c2r=m;e.l2d=v;e.d2p=function(t,r){return e.l2p(e.d2r(t,r))};e.p2d=function(t){return v(M(t))};e.r2p=function(t){return e.l2p(o(t))};e.p2r=M;e.cleanPos=u}else if(e.type==="date"){e.d2r=e.r2d=i.identity;e.d2c=e.r2c=e.d2l=e.r2l=y;e.c2d=e.c2r=e.l2d=e.l2r=x;e.d2p=e.r2p=function(t,r,n){return e.l2p(y(t,0,n))};e.p2d=e.p2r=function(t,e,r){return x(M(t),e,r)};e.cleanPos=function(t){return i.cleanDate(t,h,e.calendar)}}else if(e.type==="category"){e.d2c=e.d2l=_;e.r2d=e.c2d=e.l2d=b;e.d2r=e.d2l_noadd=w;e.r2c=function(t){var r=w(t);return r!==undefined?r:e.fraction2r(.5)};e.l2r=e.c2r=u;e.r2l=w;e.d2p=function(t){return e.l2p(e.r2c(t))};e.p2d=function(t){return b(M(t))};e.r2p=e.d2p;e.p2r=M;e.cleanPos=function(t){if(typeof t==="string"&&t!=="")return t;return u(t)}}e.fraction2r=function(t){var r=e.r2l(e.range[0]),n=e.r2l(e.range[1]);return e.l2r(r+t*(n-r))};e.r2fraction=function(t){var r=e.r2l(e.range[0]),n=e.r2l(e.range[1]);return(e.r2l(t)-r)/(n-r)};e.cleanRange=function(t,r){if(!r)r={};if(!t)t="range";var n=i.nestedProperty(e,t).get();var o,s;if(e.type==="date")s=i.dfltRange(e.calendar);else if(c==="y")s=p.DFLTRANGEY;else s=r.dfltRange||p.DFLTRANGEX;s=s.slice();if(!n||n.length!==2){i.nestedProperty(e,t).set(s);return}if(e.type==="date"){n[0]=i.cleanDate(n[0],h,e.calendar);n[1]=i.cleanDate(n[1],h,e.calendar)}for(o=0;o<2;o++){if(e.type==="date"){if(!i.isDateTime(n[o],e.calendar)){e[t]=s;break}if(e.r2l(n[0])===e.r2l(n[1])){var l=i.constrain(e.r2l(n[0]),i.MIN_MS+1e3,i.MAX_MS-1e3);n[0]=e.l2r(l-1e3);n[1]=e.l2r(l+1e3);break}}else{if(!a(n[o])){if(a(n[1-o])){n[o]=n[1-o]*(o?10:.1)}else{e[t]=s;break}}if(n[o]<-f)n[o]=-f;else if(n[o]>f)n[o]=f;if(n[0]===n[1]){var u=Math.max(1,Math.abs(n[0]*1e-6));n[0]-=u;n[1]+=u}}}};e.setScale=function(t){var n=r._size;if(!e._categories)e._categories=[];if(!e._categoriesMap)e._categoriesMap={};if(e.overlaying){var a=d.getFromId({_fullLayout:r},e.overlaying);e.domain=a.domain}var i=t&&e._r?"_r":"range",o=e.calendar;e.cleanRange(i);var s=e.r2l(e[i][0],o),l=e.r2l(e[i][1],o);if(c==="y"){e._offset=n.t+(1-e.domain[1])*n.h;e._length=n.h*(e.domain[1]-e.domain[0]);e._m=e._length/(s-l);e._b=-e._m*l}else{e._offset=n.l+e.domain[0]*n.w;e._length=n.w*(e.domain[1]-e.domain[0]);e._m=e._length/(l-s);e._b=-e._m*s}if(!isFinite(e._m)||!isFinite(e._b)){r._replotting=false;throw new Error("Something went wrong with axis scaling")}};e.makeCalcdata=function(t,r){var n,a,o,s;var l=e.type;var u=l==="date"&&t[r+"calendar"];if(r in t){n=t[r];s=t._length||n.length;if(i.isTypedArray(n)&&(l==="linear"||l==="log")){if(s===n.length){return n}else if(n.subarray){return n.subarray(0,s)}}a=new Array(s);for(o=0;o<s;o++){a[o]=e.d2c(n[o],0,u)}}else{var c=r+"0"in t?e.d2c(t[r+"0"],0,u):0;var f=t["d"+r]?Number(t["d"+r]):1;n=t[{x:"y",y:"x"}[r]];s=t._length||n.length;a=new Array(s);for(o=0;o<s;o++){a[o]=c+o*f}}return a};e.isValidRange=function(t){return Array.isArray(t)&&t.length===2&&a(e.r2l(t[0]))&&a(e.r2l(t[1]))};e.isPtWithinRange=function(t,r){var n=e.c2l(t[c],null,r);var a=e.r2l(e.range[0]);var i=e.r2l(e.range[1]);if(a<i){return a<=n&&n<=i}else{return i<=n&&n<=a}};e.clearCalc=function(){e._min=[];e._max=[];e._categories=(e._initialCategories||[]).slice();e._categoriesMap={};for(var t=0;t<e._categories.length;t++){e._categoriesMap[e._categories[t]]=t}};var A=r._d3locale;if(e.type==="date"){e._dateFormat=A?A.timeFormat.utc:n.time.format.utc;e._extraFormat=r._extraFormat}e._separators=r.separators;e._numFormat=A?A.numberFormat:n.format;delete e._minDtick;delete e._forceTick0}},{"../../constants/numerical":661,"../../lib":684,"./axis_ids":735,"./constants":737,d3:147,"fast-isnumeric":214}],751:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./layout_attributes");var i=t("../array_container_defaults");e.exports=function t(e,r,l,u,c){var f=o(e);var h=l("tickprefix");if(h)l("showtickprefix",f);var p=l("ticksuffix",c.tickSuffixDflt);if(p)l("showticksuffix",f);var d=l("showticklabels");if(d){var v=c.font||{};var g=r.color!==a.color.dflt?r.color:v.color;n.coerceFont(l,"tickfont",{family:v.family,size:v.size,color:g});l("tickangle");if(u!=="category"){var m=l("tickformat");var y=e.tickformatstops;if(Array.isArray(y)&&y.length){i(e,r,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:s})}if(!m&&u!=="date"){l("showexponent",f);l("exponentformat");l("separatethousands")}}}};function o(t){var e=["showexponent","showtickprefix","showticksuffix"],r=e.filter(function(e){return t[e]!==undefined}),n=function(e){return t[e]===t[r[0]]};if(r.every(n)||r.length===1){return t[r[0]]}}function s(t,e){function r(r,i){return n.coerce(t,e,a.tickformatstops,r,i)}var i=r("enabled");if(i){r("dtickrange");r("value")}}},{"../../lib":684,"../array_container_defaults":728,"./layout_attributes":744}],752:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./layout_attributes");e.exports=function t(e,r,i,o){var s=n.coerce2(e,r,a,"ticklen"),l=n.coerce2(e,r,a,"tickwidth"),u=n.coerce2(e,r,a,"tickcolor",r.color),c=i("ticks",o.outerTicks||s||l||u?"outside":"");if(!c){delete r.ticklen;delete r.tickwidth;delete r.tickcolor}}},{"../../lib":684,"./layout_attributes":744}],753:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib");var i=t("../../constants/numerical").ONEDAY;e.exports=function t(e,r,o,s){var l;if(e.tickmode==="array"&&(s==="log"||s==="date")){l=r.tickmode="auto"}else{var u=Array.isArray(e.tickvals)?"array":e.dtick?"linear":"auto";l=o("tickmode",u)}if(l==="auto")o("nticks");else if(l==="linear"){var c=s==="date"?i:1;var f=o("dtick",c);if(n(f)){r.dtick=f>0?Number(f):c}else if(typeof f!=="string"){r.dtick=c}else{var h=f.charAt(0),p=f.substr(1);p=n(p)?Number(p):0;if(p<=0||!(s==="date"&&h==="M"&&p===Math.round(p)||s==="log"&&h==="L"||s==="log"&&h==="D"&&(p===1||p===2))){r.dtick=c}}var d=s==="date"?a.dateTick0(r.calendar):0;var v=o("tick0",d);if(s==="date"){r.tick0=a.cleanDate(v,d)}else if(n(v)&&f!=="D1"&&f!=="D2"){r.tick0=Number(v)}else{r.tick0=d}}else{var g=o("tickvals");if(g===undefined)r.tickmode="auto";else o("ticktext")}}},{"../../constants/numerical":661,"../../lib":684,"fast-isnumeric":214}],754:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../registry");var i=t("../../components/drawing");var o=t("./axes");var s=t("./constants").attrRegex;e.exports=function t(e,r,l,u){var c=e._fullLayout;var f=[];function h(t){var e,r,n,a,i;var o={};for(e in t){r=e.split(".");n=r[0].match(s);if(n){var l=e.charAt(0);var u=r[0];a=c[u];i={};if(Array.isArray(t[e])){i.to=t[e].slice(0)}else{if(Array.isArray(t[e].range)){i.to=t[e].range.slice(0)}}if(!i.to)continue;i.axisName=u;i.length=a._length;f.push(l);o[l]=i}}return o}function p(t,e,r){var n;var a=t._plots;var i=[];var o,s;for(n in a){var l=a[n];if(i.indexOf(l)!==-1)continue;var u=l.xaxis._id;var c=l.yaxis._id;var f=l.xaxis.range;var h=l.yaxis.range;l.xaxis._r=l.xaxis.range.slice();l.yaxis._r=l.yaxis.range.slice();if(r[u]){o=r[u].to}else{o=f}if(r[c]){s=r[c].to}else{s=h}if(f[0]===o[0]&&f[1]===o[1]&&h[0]===s[0]&&h[1]===s[1])continue;if(e.indexOf(u)!==-1||e.indexOf(c)!==-1){i.push(l)}}return i}var d=h(r);var v=Object.keys(d);var g=p(c,v,d);function m(){function t(t,r,n){for(var a=0;a<t.length;a++){r(e,a);if(n)return}}t(c.annotations||[],a.getComponentMethod("annotations","drawOne"));t(c.shapes||[],a.getComponentMethod("shapes","drawOne"));t(c.images||[],a.getComponentMethod("images","draw"),true)}if(!g.length){m();return false}function y(t,r){var n=[],i;n=[t._id,r._id];for(i=0;i<n.length;i++){o.doTicksSingle(e,n[i],true)}function s(t,r,a){for(i=0;i<t.length;i++){var o=t[i];if(n.indexOf(o.xref)!==-1||n.indexOf(o.yref)!==-1){r(e,i)}if(a)return}}s(c.annotations||[],a.getComponentMethod("annotations","drawOne"));s(c.shapes||[],a.getComponentMethod("shapes","drawOne"));s(c.images||[],a.getComponentMethod("images","draw"),true)}function x(t){var e=t.xaxis;var r=t.yaxis;c._defs.select("#"+t.clipId+"> rect").call(i.setTranslate,0,0).call(i.setScale,1,1);t.plot.call(i.setTranslate,e._offset,r._offset).call(i.setScale,1,1);var n=t.plot.selectAll(".scatterlayer .trace");n.selectAll(".point").call(i.setPointGroupScale,1,1);n.selectAll(".textpoint").call(i.setTextPointsScale,1,1);n.call(i.hideOutsideRangePoints,t)}function b(t,r){var n,a,o;var s=d[t.xaxis._id];var l=d[t.yaxis._id];var u=[];if(s){n=e._fullLayout[s.axisName];a=n._r;o=s.to;u[0]=(a[0]*(1-r)+r*o[0]-a[0])/(a[1]-a[0])*t.xaxis._length;var c=a[1]-a[0];var f=o[1]-o[0];n.range[0]=a[0]*(1-r)+r*o[0];n.range[1]=a[1]*(1-r)+r*o[1];u[2]=t.xaxis._length*(1-r+r*f/c)}else{u[0]=0;u[2]=t.xaxis._length}if(l){n=e._fullLayout[l.axisName];a=n._r;o=l.to;u[1]=(a[1]*(1-r)+r*o[1]-a[1])/(a[0]-a[1])*t.yaxis._length;var h=a[1]-a[0];var p=o[1]-o[0];n.range[0]=a[0]*(1-r)+r*o[0];n.range[1]=a[1]*(1-r)+r*o[1];u[3]=t.yaxis._length*(1-r+r*p/h)}else{u[1]=0;u[3]=t.yaxis._length}y(t.xaxis,t.yaxis);var v=t.xaxis;var g=t.yaxis;var m=!!s;var x=!!l;var b=m?v._length/u[2]:1,_=x?g._length/u[3]:1;var w=m?u[0]:0,k=x?u[1]:0;var M=m?u[0]/u[2]*v._length:0,A=x?u[1]/u[3]*g._length:0;var T=v._offset-M,S=g._offset-A;t.clipRect.call(i.setTranslate,w,k).call(i.setScale,1/b,1/_);t.plot.call(i.setTranslate,T,S).call(i.setScale,b,_);i.setPointGroupScale(t.zoomScalePts,1/b,1/_);i.setTextPointsScale(t.zoomScaleTxt,1/b,1/_)}var _;if(u){_=u()}function w(){var t={};for(var r=0;r<v.length;r++){var n=e._fullLayout[d[v[r]].axisName];var i=d[v[r]].to;t[n._name+".range[0]"]=i[0];t[n._name+".range[1]"]=i[1];n.range=i.slice()}_&&_();return a.call("relayout",e,t).then(function(){for(var t=0;t<g.length;t++){x(g[t])}})}function k(){var t={};for(var r=0;r<v.length;r++){var n=e._fullLayout[v[r]+"axis"];t[n._name+".range[0]"]=n.range[0];t[n._name+".range[1]"]=n.range[1];n.range=n._r.slice()}return a.call("relayout",e,t).then(function(){for(var t=0;t<g.length;t++){x(g[t])}})}var M,A,T;var S=n.ease(l.easing);e._transitionData._interruptCallbacks.push(function(){window.cancelAnimationFrame(T);T=null;return k()});function E(){A=Date.now();var t=Math.min(1,(A-M)/l.duration);var e=S(t);for(var r=0;r<g.length;r++){b(g[r],e)}if(A-M>l.duration){w();T=window.cancelAnimationFrame(E)}else{T=window.requestAnimationFrame(E)}}M=Date.now();T=window.requestAnimationFrame(E);return Promise.resolve()}},{"../../components/drawing":583,"../../registry":817,"./axes":732,"./constants":737,d3:147}],755:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("./axis_autotype");var i=t("./axis_ids").name2id;e.exports=function t(e,r,n,a,s){if(s){r._name=s;r._id=i(s)}var l=n("type");if(l==="-"){o(r,a);if(r.type==="-"){r.type="linear"}else{e.type=r.type}}};function o(t,e){if(t.type!=="-")return;var r=t._id;var i=r.charAt(0);if(r.indexOf("scene")!==-1)r=i;var o=s(e,r,i);if(!o)return;if(o.type==="histogram"&&i==={v:"y",h:"x"}[o.orientation||"v"]){t.type="linear";return}var c=i+"calendar";var f=o[c];var h;if(u(o,i)){var p=l(o);var d=[];for(h=0;h<e.length;h++){var v=e[h];if(!n.traceIs(v,"box-violin")||(v[i+"axis"]||i)!==r)continue;if(v[p]!==undefined)d.push(v[p][0]);else if(v.name!==undefined)d.push(v.name);else d.push("text");if(v[c]!==f)f=undefined}t.type=a(d,f)}else if(o.type==="splom"){var g=o.dimensions;for(h=0;h<g.length;h++){var m=g[h];if(m.visible){t.type=a(m.values,f);break}}}else{t.type=a(o[i]||[o[i+"0"]],f)}}function s(t,e,r){for(var n=0;n<t.length;n++){var a=t[n];if(a.type==="splom"&&a._length>0&&a["_"+r+"axes"][e]){return a}if((a[r+"axis"]||r)===e){if(u(a,r)){return a}else if((a[r]||[]).length||a[r+"0"]){return a}}}}function l(t){return{v:"x",h:"y"}[t.orientation||"v"]}function u(t,e){var r=l(t),a=n.traceIs(t,"box-violin"),i=n.traceIs(t._fullInput||{},"candlestick");return a&&!i&&e===r&&t[r]===undefined&&t[r+"0"]===undefined}},{"../../registry":817,"./axis_autotype":733,"./axis_ids":735}],756:[function(t,e,r){"use strict";var n=t("../registry");var a=t("../lib");r.manageCommandObserver=function(t,e,n,o){var s={};var l=true;if(e&&e._commandObserver){s=e._commandObserver}if(!s.cache){s.cache={}}s.lookupTable={};var u=r.hasSimpleAPICommandBindings(t,n,s.lookupTable);if(e&&e._commandObserver){if(!u){if(e._commandObserver.remove){e._commandObserver.remove();e._commandObserver=null;return s}}else{return s}}if(u){i(t,u,s.cache);s.check=function e(){if(!l)return;var r=i(t,u,s.cache);if(r.changed&&o){if(s.lookupTable[r.value]!==undefined){s.disable();Promise.resolve(o({value:r.value,type:u.type,prop:u.prop,traces:u.traces,index:s.lookupTable[r.value]})).then(s.enable,s.enable)}}return r.changed};var c=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"];for(var f=0;f<c.length;f++){t._internalOn(c[f],s.check)}s.remove=function(){for(var e=0;e<c.length;e++){t._removeInternalListener(c[e],s.check)}}}else{a.log("Unable to automatically bind plot updates to API command");s.lookupTable={};s.remove=function(){}}s.disable=function t(){l=false};s.enable=function t(){l=true};if(e){e._commandObserver=s}return s};r.hasSimpleAPICommandBindings=function(t,e,n){var a;var i=e.length;var o;for(a=0;a<i;a++){var s;var l=e[a];var u=l.method;var c=l.args;if(!Array.isArray(c))c=[];if(!u){return false}var f=r.computeAPICommandBindings(t,u,c);if(f.length!==1){return false}if(!o){o=f[0];if(Array.isArray(o.traces)){o.traces.sort()}}else{s=f[0];if(s.type!==o.type){return false}if(s.prop!==o.prop){return false}if(Array.isArray(o.traces)){if(Array.isArray(s.traces)){s.traces.sort();for(var h=0;h<o.traces.length;h++){if(o.traces[h]!==s.traces[h]){return false}}}else{return false}}else{if(s.prop!==o.prop){return false}}}s=f[0];var p=s.value;if(Array.isArray(p)){if(p.length===1){p=p[0]}else{return false}}if(n){n[p]=a}}return o};function i(t,e,r){var n,i,o;var s=false;if(e.type==="data"){n=t._fullData[e.traces!==null?e.traces[0]:0]}else if(e.type==="layout"){n=t._fullLayout}else{return false}i=a.nestedProperty(n,e.prop).get();o=r[e.type]=r[e.type]||{};if(o.hasOwnProperty(e.prop)){if(o[e.prop]!==i){s=true}}o[e.prop]=i;return{changed:s,value:i}}r.executeAPICommand=function(t,e,r){if(e==="skip")return Promise.resolve();var i=n.apiMethodRegistry[e];var o=[t];if(!Array.isArray(r))r=[];for(var s=0;s<r.length;s++){o.push(r[s])}return i.apply(null,o).catch(function(t){a.warn("API call to Plotly."+e+" rejected.",t);return Promise.reject(t)})};r.computeAPICommandBindings=function(t,e,r){var n;if(!Array.isArray(r))r=[];switch(e){case"restyle":n=l(t,r);break;case"relayout":n=s(t,r);break;case"update":n=l(t,[r[0],r[2]]).concat(s(t,[r[1]]));break;case"animate":n=o(t,r);break;default:n=[]}return n};function o(t,e){if(Array.isArray(e[0])&&e[0].length===1&&["string","number"].indexOf(typeof e[0][0])!==-1){return[{type:"layout",prop:"_currentFrame",value:e[0][0].toString()}]}else{return[]}}function s(t,e){var r=[];var n=e[0];var i={};if(typeof n==="string"){i[n]=e[1]}else if(a.isPlainObject(n)){i=n}else{return r}u(i,function(t,e,n){r.push({type:"layout",prop:t,value:n})},"",0);return r}function l(t,e){var r,n,i,o;var s=[];n=e[0];i=e[1];r=e[2];o={};if(typeof n==="string"){o[n]=i}else if(a.isPlainObject(n)){o=n;if(r===undefined){r=i}}else{return s}if(r===undefined){r=null}u(o,function(e,n,a){var i;if(Array.isArray(a)){var o=Math.min(a.length,t.data.length);if(r){o=Math.min(o,r.length)}i=[];for(var l=0;l<o;l++){i[l]=r?r[l]:l}}else{i=r?r.slice(0):null}if(i===null){if(Array.isArray(a)){a=a[0]}}else if(Array.isArray(i)){if(!Array.isArray(a)){var u=a;a=[];for(var c=0;c<i.length;c++){a[c]=u}}a.length=Math.min(i.length,a.length)}s.push({type:"data",prop:e,traces:i,value:a})},"",0);return s}function u(t,e,r,n){Object.keys(t).forEach(function(i){var o=t[i];if(i[0]==="_")return;var s=r+(n>0?".":"")+i;if(a.isPlainObject(o)){u(o,e,s,n+1)}else{e(s,i,o)}})}},{"../lib":684,"../registry":817}],757:[function(t,e,r){"use strict";var n=t("../lib/extend").extendFlat;r.attributes=function(t,e){t=t||{};e=e||{};var r={valType:"info_array",editType:t.editType,items:[{valType:"number",min:0,max:1,editType:t.editType},{valType:"number",min:0,max:1,editType:t.editType}],dflt:[0,1]};var a=t.name?t.name+" ":"";var i=t.trace?"trace ":"subplot ";var o=e.description?" "+e.description:"";var s={x:n({},r,{}),y:n({},r,{}),editType:t.editType};if(!t.noGridCell){s.row={valType:"integer",min:0,dflt:0,editType:t.editType};s.column={valType:"integer",min:0,dflt:0,editType:t.editType}}return s};r.defaults=function(t,e,r,n){var a=n&&n.x||[0,1];var i=n&&n.y||[0,1];var o=e.grid;if(o){var s=r("domain.column");if(s!==undefined){if(s<o.columns)a=o._domains.x[s];else delete t.domain.column}var l=r("domain.row");if(l!==undefined){if(l<o.rows)i=o._domains.y[l];else delete t.domain.row}}r("domain.x",a);r("domain.y",i)}},{"../lib/extend":673}],758:[function(t,e,r){"use strict";e.exports=function(t){var e=t.editType;var r=t.colorEditType;if(r===undefined)r=e;var n={family:{valType:"string",noBlank:true,strict:true,editType:e},size:{valType:"number",min:1,editType:e},color:{valType:"color",editType:r},editType:e};if(t.arrayOk){n.family.arrayOk=true;n.size.arrayOk=true;n.color.arrayOk=true}return n}},{}],759:[function(t,e,r){"use strict";e.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],760:[function(t,e,r){"use strict";r.projNames={equirectangular:"equirectangular",mercator:"mercator",orthographic:"orthographic","natural earth":"naturalEarth",kavrayskiy7:"kavrayskiy7",miller:"miller",robinson:"robinson",eckert4:"eckert4","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant","conic equal area":"conicEqualArea","conic conformal":"conicConformal","conic equidistant":"conicEquidistant",gnomonic:"gnomonic",stereographic:"stereographic",mollweide:"mollweide",hammer:"hammer","transverse mercator":"transverseMercator","albers usa":"albersUsa","winkel tripel":"winkel3",aitoff:"aitoff",sinusoidal:"sinusoidal"};r.axesNames=["lonaxis","lataxis"];r.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360};r.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180};r.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}};r.clipPad=.001;r.precision=.1;r.landColor="#F0DC82";r.waterColor="#3399FF";r.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"};r.sphereSVG={type:"Sphere"};r.fillLayers={ocean:1,land:1,lakes:1};r.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1};r.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"];r.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"];r.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],761:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../registry");var i=t("../../lib");var o=t("../../components/color");var s=t("../../components/drawing");var l=t("../../components/fx");var u=t("../plots");var c=t("../cartesian/axes");var f=t("../../components/dragelement");var h=t("../cartesian/select").prepSelect;var p=t("./zoom");var d=t("./constants");var v=t("../../lib/topojson_utils");var g=t("topojson-client").feature;t("./projections")(n);function m(t){this.id=t.id;this.graphDiv=t.graphDiv;this.container=t.container;this.topojsonURL=t.topojsonURL;this.isStatic=t.staticPlot;this.topojsonName=null;this.topojson=null;this.projection=null;this.viewInitial=null;this.fitScale=null;this.bounds=null;this.midPt=null;this.hasChoropleth=false;this.traceHash={};this.layers={};this.basePaths={};this.dataPaths={};this.dataPoints={};this.clipDef=null;this.clipRect=null;this.bgRect=null;this.makeFramework()}var y=m.prototype;e.exports=function t(e){return new m(e)};y.plot=function(t,e,r){var n=this;var a=e[this.id];var i=v.getTopojsonName(a);if(n.topojson===null||i!==n.topojsonName){n.topojsonName=i;if(PlotlyGeoAssets.topojson[n.topojsonName]===undefined){r.push(n.fetchTopojson().then(function(r){PlotlyGeoAssets.topojson[n.topojsonName]=r;n.topojson=r;n.update(t,e)}))}else{n.topojson=PlotlyGeoAssets.topojson[n.topojsonName];n.update(t,e)}}else{n.update(t,e)}};y.fetchTopojson=function(){var t=v.getTopojsonPath(this.topojsonURL,this.topojsonName);return new Promise(function(e,r){n.json(t,function(n,a){if(n){if(n.status===404){return r(new Error(["plotly.js could not find topojson file at",t,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" ")))}else{return r(new Error(["unexpected error while fetching topojson file at",t].join(" ")))}}e(a)})})};y.update=function(t,e){var r=e[this.id];var n=this.updateProjection(e,r);if(n)return;this.hasChoropleth=false;for(var a=0;a<t.length;a++){if(t[a][0].trace.type==="choropleth"){this.hasChoropleth=true;break}}if(!this.viewInitial){this.saveViewInitial(r)}this.updateBaseLayers(e,r);this.updateDims(e,r);this.updateFx(e,r);u.generalUpdatePerTraceModule(this.graphDiv,this,t,r);var i=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=i.selectAll(".point");this.dataPoints.text=i.selectAll("text");this.dataPaths.line=i.selectAll(".js-line");var o=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=o.selectAll("path");this.render()};y.updateProjection=function(t,e){var r=t._size;var n=e.domain;var o=e.projection;var s=o.rotation||{};var l=e.center||{};var u=this.projection=x(e);u.center([l.lon-s.lon,l.lat-s.lat]).rotate([-s.lon,-s.lat,s.roll]).parallels(o.parallels);var c=[[r.l+r.w*n.x[0],r.t+r.h*(1-n.y[1])],[r.l+r.w*n.x[1],r.t+r.h*(1-n.y[0])]];var f=e.lonaxis;var h=e.lataxis;var p=_(f.range,h.range);u.fitExtent(c,p);var d=this.bounds=u.getBounds(p);var v=this.fitScale=u.scale();var g=u.translate();if(!isFinite(d[0][0])||!isFinite(d[0][1])||!isFinite(d[1][0])||!isFinite(d[1][1])||isNaN(g[0])||isNaN(g[0])){var m=this.graphDiv;var y=["projection.rotation","center","lonaxis.range","lataxis.range"];var b="Invalid geo settings, relayout'ing to default view.";var w={};for(var k=0;k<y.length;k++){w[this.id+"."+y[k]]=null}this.viewInitial=null;i.warn(b);m._promises.push(a.call("relayout",m,w));return b}var M=this.midPt=[(d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2];u.scale(o.scale*v).translate([g[0]+(M[0]-g[0]),g[1]+(M[1]-g[1])]).clipExtent(d);if(e._isAlbersUsa){var A=u([l.lon,l.lat]);var T=u.translate();u.translate([T[0]-(A[0]-T[0]),T[1]-(A[1]-T[1])])}};y.updateBaseLayers=function(t,e){var r=this;var a=r.topojson;var i=r.layers;var l=r.basePaths;function u(t){return t==="lonaxis"||t==="lataxis"}function c(t){return Boolean(d.lineLayers[t])}function f(t){return Boolean(d.fillLayers[t])}var h=this.hasChoropleth?d.layersForChoropleth:d.layers;var p=h.filter(function(t){return c(t)||f(t)?e["show"+t]:u(t)?e[t].showgrid:true});var v=r.framework.selectAll(".layer").data(p,String);v.exit().each(function(t){delete i[t];delete l[t];n.select(this).remove()});v.enter().append("g").attr("class",function(t){return"layer "+t}).each(function(t){var e=i[t]=n.select(this);if(t==="bg"){r.bgRect=e.append("rect").style("pointer-events","all")}else if(u(t)){l[t]=e.append("path").style("fill","none")}else if(t==="backplot"){e.append("g").classed("choroplethlayer",true)}else if(t==="frontplot"){e.append("g").classed("scatterlayer",true)}else if(c(t)){l[t]=e.append("path").style("fill","none").style("stroke-miterlimit",2)}else if(f(t)){l[t]=e.append("path").style("stroke","none")}});v.order();v.each(function(t){var r=l[t];var n=d.layerNameToAdjective[t];if(t==="frame"){r.datum(d.sphereSVG)}else if(c(t)||f(t)){r.datum(g(a,a.objects[t]))}else if(u(t)){r.datum(b(t,e)).call(o.stroke,e[t].gridcolor).call(s.dashLine,"",e[t].gridwidth)}if(c(t)){r.call(o.stroke,e[n+"color"]).call(s.dashLine,"",e[n+"width"])}else if(f(t)){r.call(o.fill,e[n+"color"])}})};y.updateDims=function(t,e){var r=this.bounds;var n=(e.framewidth||0)/2;var a=r[0][0]-n;var i=r[0][1]-n;var l=r[1][0]-a+n;var u=r[1][1]-i+n;s.setRect(this.clipRect,a,i,l,u);this.bgRect.call(s.setRect,a,i,l,u).call(o.fill,e.bgcolor);this.xaxis._offset=a;this.xaxis._length=l;this.yaxis._offset=i;this.yaxis._length=u};y.updateFx=function(t,e){var r=this;var i=r.graphDiv;var o=r.bgRect;var s=t.dragmode;if(r.isStatic)return;function u(){var t=r.viewInitial;var e={};for(var n in t){e[r.id+"."+n]=t[n]}a.call("relayout",i,e);i.emit("plotly_doubleclick",null)}function c(t){return r.projection.invert([t[0]+r.xaxis._offset,t[1]+r.yaxis._offset])}if(s==="pan"){o.node().onmousedown=null;o.call(p(r,e));o.on("dblclick.zoom",u)}else if(s==="select"||s==="lasso"){o.on(".zoom",null);var d;if(s==="select"){d=function(t,e){var n=t.range={};n[r.id]=[c([e.xmin,e.ymin]),c([e.xmax,e.ymax])]}}else if(s==="lasso"){d=function(t,e,n){var a=t.lassoPoints={};a[r.id]=n.filtered.map(c)}}var v={element:r.bgRect.node(),gd:i,plotinfo:{xaxis:r.xaxis,yaxis:r.yaxis,fillRangeItems:d},xaxes:[r.xaxis],yaxes:[r.yaxis],subplot:r.id,clickFn:function(e){if(e===2){t._zoomlayer.selectAll(".select-outline").remove()}}};v.prepFn=function(t,e,r){h(t,e,r,v,s)};f.init(v)}o.on("mousemove",function(){var t=r.projection.invert(n.mouse(this));if(!t||isNaN(t[0])||isNaN(t[1])){return f.unhover(i,n.event)}r.xaxis.p2c=function(){return t[0]};r.yaxis.p2c=function(){return t[1]};l.hover(i,n.event,r.id)});o.on("mouseout",function(){f.unhover(i,n.event)});o.on("click",function(){l.click(i,n.event)})};y.makeFramework=function(){var t=this;var e=t.graphDiv._fullLayout;var r="clip"+e._uid+t.id;t.clipDef=e._clips.append("clipPath").attr("id",r);t.clipRect=t.clipDef.append("rect");t.framework=n.select(t.container).append("g").attr("class","geo "+t.id).call(s.setClipUrl,r);t.project=function(e){var r=t.projection(e);return r?[r[0]-t.xaxis._offset,r[1]-t.yaxis._offset]:[null,null]};t.xaxis={_id:"x",c2p:function(e){return t.project(e)[0]}};t.yaxis={_id:"y",c2p:function(e){return t.project(e)[1]}};t.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"};c.setConvert(t.mockAxis,e)};y.saveViewInitial=function(t){var e=t.center||{};var r=t.projection;var n=r.rotation||{};if(t._isScoped){this.viewInitial={"center.lon":e.lon,"center.lat":e.lat,"projection.scale":r.scale}}else if(t._isClipped){this.viewInitial={"projection.scale":r.scale,"projection.rotation.lon":n.lon,"projection.rotation.lat":n.lat}}else{this.viewInitial={"center.lon":e.lon,"center.lat":e.lat,"projection.scale":r.scale,"projection.rotation.lon":n.lon}}};y.render=function(){var t=this.projection;var e=t.getPath();var r;function n(e){var r=t(e.lonlat);return r?"translate("+r[0]+","+r[1]+")":null}function a(e){return t.isLonLatOverEdges(e.lonlat)?"none":null}for(r in this.basePaths){this.basePaths[r].attr("d",e)}for(r in this.dataPaths){this.dataPaths[r].attr("d",function(t){return e(t.geojson)})}for(r in this.dataPoints){this.dataPoints[r].attr("display",a).attr("transform",n)}};function x(t){var e=t.projection;var r=e.type;var a=n.geo[d.projNames[r]]();var i=t._isClipped?d.lonaxisSpan[r]/2:null;var o=["center","rotate","parallels","clipExtent"];var s=function(t){return t?a:[]};for(var l=0;l<o.length;l++){var u=o[l];if(typeof a[u]!=="function"){a[u]=s}}a.isLonLatOverEdges=function(t){if(a(t)===null){return true}if(i){var e=a.rotate();var r=n.geo.distance(t,[-e[0],-e[1]]);var o=i*Math.PI/180;return r>o}else{return false}};a.getPath=function(){return n.geo.path().projection(a)};a.getBounds=function(t){return a.getPath().bounds(t)};a.fitExtent=function(t,e){var r=t[1][0]-t[0][0];var n=t[1][1]-t[0][1];var i=a.clipExtent&&a.clipExtent();a.scale(150).translate([0,0]);if(i)a.clipExtent(null);var o=a.getBounds(e);var s=Math.min(r/(o[1][0]-o[0][0]),n/(o[1][1]-o[0][1]));var l=+t[0][0]+(r-s*(o[1][0]+o[0][0]))/2;var u=+t[0][1]+(n-s*(o[1][1]+o[0][1]))/2;if(i)a.clipExtent(i);return a.scale(s*150).translate([l,u])};a.precision(d.precision);if(i){a.clipAngle(i-d.clipPad)}return a}function b(t,e){var r=e[t];var a=r.dtick;var i=d.scopeDefaults[e.scope];var o=i.lonaxisRange;var s=i.lataxisRange;var l=t==="lonaxis"?[a]:[0,a];return n.geo.graticule().extent([[o[0],s[0]],[o[1],s[1]]]).step(l)}function _(t,e){var r=d.clipPad;var n=t[0]+r;var a=t[1]-r;var i=e[0]+r;var o=e[1]-r;if(n>0&&a<0)a+=360;var s=(a-n)/4;return{type:"Polygon",coordinates:[[[n,i],[n,o],[n+s,o],[n+2*s,o],[n+3*s,o],[a,o],[a,i],[a-s,i],[a-2*s,i],[a-3*s,i],[n,i]]]}}},{"../../components/color":558,"../../components/dragelement":580,"../../components/drawing":583,"../../components/fx":600,"../../lib":684,"../../lib/topojson_utils":711,"../../registry":817,"../cartesian/axes":732,"../cartesian/select":749,"../plots":795,"./constants":760,"./projections":766,"./zoom":767,d3:147,"topojson-client":502}],762:[function(t,e,r){"use strict";var n=t("./geo");var a=t("../../plots/get_data").getSubplotCalcData;var i=t("../../lib").counterRegex;var o="geo";r.name=o;r.attr=o;r.idRoot=o;r.idRegex=r.attrRegex=i(o);r.attributes=t("./layout/attributes");r.layoutAttributes=t("./layout/layout_attributes");r.supplyLayoutDefaults=t("./layout/defaults");r.plot=function t(e){var r=e._fullLayout;var i=e.calcdata;var s=r._subplots[o];if(window.PlotlyGeoAssets===undefined){window.PlotlyGeoAssets={topojson:{}}}for(var l=0;l<s.length;l++){var u=s[l];var c=a(i,o,u);var f=r[u];var h=f._subplot;if(!h){h=n({id:u,graphDiv:e,container:r._geolayer.node(),topojsonURL:e._context.topojsonURL,staticPlot:e._context.staticPlot});r[u]._subplot=h}h.plot(c,r,e._promises)}};r.clean=function(t,e,r,n){var a=n._subplots[o]||[];for(var i=0;i<a.length;i++){var s=a[i];var l=n[s]._subplot;if(!e[s]&&!!l){l.framework.remove();l.clipDef.remove()}}};r.updateFx=function(t){var e=t._subplots[o];for(var r=0;r<e.length;r++){var n=t[e[r]];var a=n._subplot;a.updateFx(t,n)}}},{"../../lib":684,"../../plots/get_data":768,"./geo":761,"./layout/attributes":763,"./layout/defaults":764,"./layout/layout_attributes":765}],763:[function(t,e,r){"use strict";e.exports={geo:{valType:"subplotid",dflt:"geo",editType:"calc"}}},{}],764:[function(t,e,r){"use strict";var n=t("../../subplot_defaults");var a=t("../constants");var i=t("./layout_attributes");var o=a.axesNames;e.exports=function t(e,r,a){n(e,r,a,{type:"geo",attributes:i,handleDefaults:s,partition:"y"})};function s(t,e,r){var n;var i=r("resolution");var s=r("scope");var l=a.scopeDefaults[s];var u=r("projection.type",l.projType);var c=e._isAlbersUsa=u==="albers usa";if(c)s=e.scope="usa";var f=e._isScoped=s!=="world";var h=e._isConic=u.indexOf("conic")!==-1;e._isClipped=!!a.lonaxisSpan[u];for(var p=0;p<o.length;p++){var d=o[p];var v=[30,10][p];var g;if(f){g=l[d+"Range"]}else{var m=a[d+"Span"];var y=(m[u]||m["*"])/2;var x=r("projection.rotation."+d.substr(0,3),l.projRotate[p]);g=[x-y,x+y]}var b=r(d+".range",g);r(d+".tick0",b[0]);r(d+".dtick",v);n=r(d+".showgrid");if(n){r(d+".gridcolor");r(d+".gridwidth")}}var _=e.lonaxis.range;var w=e.lataxis.range;var k=_[0];var M=_[1];if(k>0&&M<0)M+=360;var A=(k+M)/2;var T;if(!c){var S=f?l.projRotate:[A,0,0];T=r("projection.rotation.lon",S[0]);r("projection.rotation.lat",S[1]);r("projection.rotation.roll",S[2]);n=r("showcoastlines",!f);if(n){r("coastlinecolor");r("coastlinewidth")}n=r("showocean");if(n)r("oceancolor")}var E;var C;if(c){E=-96.6;C=38.7}else{E=f?A:T;C=(w[0]+w[1])/2}r("center.lon",E);r("center.lat",C);if(h){var L=l.projParallels||[0,60];r("projection.parallels",L)}r("projection.scale");n=r("showland");if(n)r("landcolor");n=r("showlakes");if(n)r("lakecolor");n=r("showrivers");if(n){r("rivercolor");r("riverwidth")}n=r("showcountries",f&&s!=="usa");if(n){r("countrycolor");r("countrywidth")}if(s==="usa"||s==="north america"&&i===50){r("showsubunits",true);r("subunitcolor");r("subunitwidth")}if(!f){n=r("showframe",true);if(n){r("framecolor");r("framewidth")}}r("bgcolor")}},{"../../subplot_defaults":809,"../constants":760,"./layout_attributes":765}],765:[function(t,e,r){"use strict";var n=t("../../../components/color/attributes");var a=t("../../domain").attributes;var i=t("../constants");var o=t("../../../plot_api/edit_types").overrideAll;var s={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:false},tick0:{valType:"number"},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:n.lightLine},gridwidth:{valType:"number",min:0,dflt:1}};e.exports=o({domain:a({name:"geo"},{}),resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:true},scope:{valType:"enumerated",values:Object.keys(i.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:Object.keys(i.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:n.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:false},landcolor:{valType:"color",dflt:i.landColor},showocean:{valType:"boolean",dflt:false},oceancolor:{valType:"color",dflt:i.waterColor},showlakes:{valType:"boolean",dflt:false},lakecolor:{valType:"color",dflt:i.waterColor},showrivers:{valType:"boolean",dflt:false},rivercolor:{valType:"color",dflt:i.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:n.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:n.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:n.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:n.background},lonaxis:s,lataxis:s},"plot","from-root")},{"../../../components/color/attributes":557,"../../../plot_api/edit_types":715,"../../domain":757,"../constants":760}],766:[function(t,e,r){"use strict";function n(t){t.geo.project=function(t,e){var a=e.stream;if(!a)throw new Error("not yet supported");return(t&&n.hasOwnProperty(t.type)?n[t.type]:r)(t,a)};function e(t,e){return{type:"Feature",id:t.id,properties:t.properties,geometry:r(t.geometry,e)}}function r(e,n){if(!e)return null;if(e.type==="GeometryCollection")return{type:"GeometryCollection",geometries:object.geometries.map(function(t){return r(t,n)})};if(!u.hasOwnProperty(e.type))return null;var a=u[e.type];t.geo.stream(e,n(a));return a.result()}var n={Feature:e,FeatureCollection:function(t,r){return{type:"FeatureCollection",features:t.features.map(function(t){return e(t,r)})}}};var a=[],i=[];var o={point:function(t,e){a.push([t,e])},result:function(){var t=!a.length?null:a.length<2?{type:"Point",coordinates:a[0]}:{type:"MultiPoint",coordinates:a};a=[];return t}};var s={lineStart:c,point:function(t,e){a.push([t,e])},lineEnd:function(){if(a.length)i.push(a),a=[]},result:function(){var t=!i.length?null:i.length<2?{type:"LineString",coordinates:i[0]}:{type:"MultiLineString",coordinates:i};i=[];return t}};var l={polygonStart:c,lineStart:c,point:function(t,e){a.push([t,e])},lineEnd:function(){var t=a.length;if(t){do{a.push(a[0].slice())}while(++t<4);i.push(a),a=[]}},polygonEnd:c,result:function(){if(!i.length)return null;var t=[],e=[];i.forEach(function(r){if(f(r))t.push([r]);else e.push(r)});e.forEach(function(e){var r=e[0];t.some(function(t){if(h(t[0],r)){t.push(e);return true}})||t.push([e])});i=[];return!t.length?null:t.length>1?{type:"MultiPolygon",coordinates:t}:{type:"Polygon",coordinates:t[0]}}};var u={Point:o,MultiPoint:o,LineString:s,MultiLineString:s,Polygon:l,MultiPolygon:l,Sphere:l};function c(){}function f(t){if((r=t.length)<4)return false;var e=0,r,n=t[r-1][1]*t[0][0]-t[r-1][0]*t[0][1];while(++e<r)n+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return n<=0}function h(t,e){var r=e[0],n=e[1],a=false;for(var i=0,o=t.length,s=o-1;i<o;s=i++){var l=t[i],u=l[0],c=l[1],f=t[s],h=f[0],p=f[1];if(c>n^p>n&&r<(h-u)*(n-c)/(p-c)+u)a=!a}return a}var p=1e-6,d=p*p,v=Math.PI,g=v/2,m=Math.sqrt(v),y=v/180,x=180/v;function b(t){return t?t/Math.sin(t):1}function _(t){return t>0?1:t<0?-1:0}function w(t){return t>1?g:t<-1?-g:Math.asin(t)}function k(t){return t>1?0:t<-1?v:Math.acos(t)}function M(t){return t>0?Math.sqrt(t):0}var A=t.geo.projection,T=t.geo.projectionMutator;t.geo.interrupt=function(e){var r=[[[[-v,0],[0,g],[v,0]]],[[[-v,0],[0,-g],[v,0]]]];var n;function a(t,n){var a=n<0?-1:+1,i=r[+(n<0)];for(var o=0,s=i.length-1;o<s&&t>i[o][2][0];++o);var l=e(t-i[o][1][0],n);l[0]+=e(i[o][1][0],a*n>a*i[o][0][1]?i[o][0][1]:n)[0];return l}function i(){n=r.map(function(t){return t.map(function(t){var r=e(t[0][0],t[0][1])[0],n=e(t[2][0],t[2][1])[0],a=e(t[1][0],t[0][1])[1],i=e(t[1][0],t[1][1])[1],o;if(a>i)o=a,a=i,i=o;return[[r,a],[n,i]]})})}if(e.invert)a.invert=function(t,i){var o=n[+(i<0)],s=r[+(i<0)];for(var l=0,u=o.length;l<u;++l){var f=o[l];if(f[0][0]<=t&&t<f[1][0]&&f[0][1]<=i&&i<f[1][1]){var h=e.invert(t-e(s[l][1][0],0)[0],i);h[0]+=s[l][1][0];return c(a(h[0],h[1]),[t,i])?h:null}}};var o=t.geo.projection(a),s=o.stream;o.stream=function(e){var r=o.rotate(),n=s(e),a=(o.rotate([0,0]),s(e));o.rotate(r);n.sphere=function(){t.geo.stream(l(),a)};return n};o.lobes=function(t){if(!arguments.length)return r.map(function(t){return t.map(function(t){return[[t[0][0]*180/v,t[0][1]*180/v],[t[1][0]*180/v,t[1][1]*180/v],[t[2][0]*180/v,t[2][1]*180/v]]})});r=t.map(function(t){return t.map(function(t){return[[t[0][0]*v/180,t[0][1]*v/180],[t[1][0]*v/180,t[1][1]*v/180],[t[2][0]*v/180,t[2][1]*v/180]]})});i();return o};function l(){var e=1e-6,n=[];for(var a=0,i=r[0].length;a<i;++a){var o=r[0][a],s=o[0][0]*180/v,l=o[0][1]*180/v,c=o[1][1]*180/v,f=o[2][0]*180/v,h=o[2][1]*180/v;n.push(u([[s+e,l+e],[s+e,c-e],[f-e,c-e],[f-e,h+e]],30))}for(var a=r[1].length-1;a>=0;--a){var o=r[1][a],s=o[0][0]*180/v,l=o[0][1]*180/v,c=o[1][1]*180/v,f=o[2][0]*180/v,h=o[2][1]*180/v;n.push(u([[f-e,h-e],[f-e,c+e],[s+e,c+e],[s+e,l-e]],30))}return{type:"Polygon",coordinates:[t.merge(n)]}}function u(t,e){var r=-1,n=t.length,a=t[0],i,o,s,l=[];while(++r<n){i=t[r];o=(i[0]-a[0])/e;s=(i[1]-a[1])/e;for(var u=0;u<e;++u)l.push([a[0]+u*o,a[1]+u*s]);a=i}l.push(i);return l}function c(t,e){return Math.abs(t[0]-e[0])<p&&Math.abs(t[1]-e[1])<p}return o};function S(t,e){var r=(2+g)*Math.sin(e);e/=2;for(var n=0,a=Infinity;n<10&&Math.abs(a)>p;n++){var i=Math.cos(e);e-=a=(e+Math.sin(e)*(i+2)-r)/(2*i*(1+i))}return[2/Math.sqrt(v*(4+v))*t*(1+Math.cos(e)),2*Math.sqrt(v/(4+v))*Math.sin(e)]}S.invert=function(t,e){var r=.5*e*Math.sqrt((4+v)/v),n=w(r),a=Math.cos(n);return[t/(2/Math.sqrt(v*(4+v))*(1+a)),w((n+r*(a+2))/(2+g))]};(t.geo.eckert4=function(){return A(S)}).raw=S;var E=t.geo.azimuthalEqualArea.raw;function C(t,e){if(arguments.length<2)e=t;if(e===1)return E;if(e===Infinity)return I;function r(r,n){var a=E(r/e,n);a[0]*=t;return a}r.invert=function(r,n){var a=E.invert(r/t,n);a[0]*=e;return a};return r}function L(){var t=2,e=T(C),r=e(t);r.coefficient=function(r){if(!arguments.length)return t;return e(t=+r)};return r}function I(t,e){return[t*Math.cos(e)/Math.cos(e/=2),2*Math.sin(e)]}I.invert=function(t,e){var r=2*w(e/2);return[t*Math.cos(r/2)/Math.cos(r),r]};(t.geo.hammer=L).raw=C;function z(t,e){return[3*t/(2*v)*Math.sqrt(v*v/3-e*e),e]}z.invert=function(t,e){return[2/3*v*t/Math.sqrt(v*v/3-e*e),e]};(t.geo.kavrayskiy7=function(){return A(z)}).raw=z;function P(t,e){return[t,1.25*Math.log(Math.tan(v/4+.4*e))]}P.invert=function(t,e){return[t,2.5*Math.atan(Math.exp(.8*e))-.625*v]};(t.geo.miller=function(){return A(P)}).raw=P;function O(t){return function(e){var r=t*Math.sin(e),n=30,a;do{e-=a=(e+Math.sin(e)-r)/(1+Math.cos(e))}while(Math.abs(a)>p&&--n>0);return e/2}}function D(t,e,r){var n=O(r);function a(r,a){return[t*r*Math.cos(a=n(a)),e*Math.sin(a)]}a.invert=function(n,a){var i=w(a/e);return[n/(t*Math.cos(i)),w((2*i+Math.sin(2*i))/r)]};return a}var R=O(v),B=D(Math.SQRT2/g,Math.SQRT2,v);(t.geo.mollweide=function(){return A(B)}).raw=B;function F(t,e){var r=e*e,n=r*r;return[t*(.8707-.131979*r+n*(-.013791+n*(.003971*r-.001529*n))),e*(1.007226+r*(.015085+n*(-.044475+.028874*r-.005916*n)))]}F.invert=function(t,e){var r=e,n=25,a;do{var i=r*r,o=i*i;r-=a=(r*(1.007226+i*(.015085+o*(-.044475+.028874*i-.005916*o)))-e)/(1.007226+i*(.015085*3+o*(-.044475*7+.028874*9*i-.005916*11*o)))}while(Math.abs(a)>p&&--n>0);return[t/(.8707+(i=r*r)*(-.131979+i*(-.013791+i*i*i*(.003971-.001529*i)))),r]};(t.geo.naturalEarth=function(){return A(F)}).raw=F;var N=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];N.forEach(function(t){t[1]*=1.0144});function j(t,e){var r=Math.min(18,Math.abs(e)*36/v),n=Math.floor(r),a=r-n,i=(f=N[n])[0],o=f[1],s=(f=N[++n])[0],l=f[1],u=(f=N[Math.min(19,++n)])[0],c=f[1],f;return[t*(s+a*(u-i)/2+a*a*(u-2*s+i)/2),(e>0?g:-g)*(l+a*(c-o)/2+a*a*(c-2*l+o)/2)]}j.invert=function(t,e){var r=e/g,n=r*90,a=Math.min(18,Math.abs(n/5)),i=Math.max(0,Math.floor(a));do{var o=N[i][1],s=N[i+1][1],l=N[Math.min(19,i+2)][1],u=l-o,c=l-2*s+o,f=2*(Math.abs(r)-s)/u,h=c/u,p=f*(1-h*f*(1-2*h*f));if(p>=0||i===1){n=(e>=0?5:-5)*(p+a);var v=50,m;do{a=Math.min(18,Math.abs(n)/5);i=Math.floor(a);p=a-i;o=N[i][1];s=N[i+1][1];l=N[Math.min(19,i+2)][1];n-=(m=(e>=0?g:-g)*(s+p*(l-o)/2+p*p*(l-2*s+o)/2)-e)*x}while(Math.abs(m)>d&&--v>0);break}}while(--i>=0);var b=N[i][0],_=N[i+1][0],w=N[Math.min(19,i+2)][0];return[t/(_+p*(w-b)/2+p*p*(w-2*_+b)/2),n*y]};(t.geo.robinson=function(){return A(j)}).raw=j;function V(t,e){return[t*Math.cos(e),e]}V.invert=function(t,e){return[t/Math.cos(e),e]};(t.geo.sinusoidal=function(){return A(V)}).raw=V;function U(t,e){var r=Math.cos(e),n=b(k(r*Math.cos(t/=2)));return[2*r*Math.sin(t)*n,Math.sin(e)*n]}U.invert=function(t,e){if(t*t+4*e*e>v*v+p)return;var r=t,n=e,a=25;do{var i=Math.sin(r),o=Math.sin(r/2),s=Math.cos(r/2),l=Math.sin(n),u=Math.cos(n),c=Math.sin(2*n),f=l*l,h=u*u,d=o*o,g=1-h*s*s,m=g?k(u*s)*Math.sqrt(y=1/g):y=0,y,x=2*m*u*o-t,b=m*l-e,_=y*(h*d+m*u*s*f),w=y*(.5*i*c-m*2*l*o),M=y*.25*(c*o-m*l*h*i),A=y*(f*s+m*d*u),T=w*M-A*_;if(!T)break;var S=(b*w-x*A)/T,E=(x*M-b*_)/T;r-=S,n-=E}while((Math.abs(S)>p||Math.abs(E)>p)&&--a>0);return[r,n]};(t.geo.aitoff=function(){return A(U)}).raw=U;function q(t,e){var r=U(t,e);return[(r[0]+t/g)/2,(r[1]+e)/2]}q.invert=function(t,e){var r=t,n=e,a=25;do{var i=Math.cos(n),o=Math.sin(n),s=Math.sin(2*n),l=o*o,u=i*i,c=Math.sin(r),f=Math.cos(r/2),h=Math.sin(r/2),d=h*h,v=1-u*f*f,m=v?k(i*f)*Math.sqrt(y=1/v):y=0,y,x=.5*(2*m*i*h+r/g)-t,b=.5*(m*o+n)-e,_=.5*y*(u*d+m*i*f*l)+.5/g,w=y*(c*s/4-m*o*h),M=.125*y*(s*h-m*o*u*c),A=.5*y*(l*f+m*d*i)+.5,T=w*M-A*_,S=(b*w-x*A)/T,E=(x*M-b*_)/T;r-=S,n-=E}while((Math.abs(S)>p||Math.abs(E)>p)&&--a>0);return[r,n]};(t.geo.winkel3=function(){return A(q)}).raw=q}e.exports=n},{}],767:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../lib");var i=Math.PI/180;var o=180/Math.PI;var s={cursor:"pointer"};var l={cursor:"auto"};function u(t,e){var r=t.projection;var n;if(e._isScoped){n=h}else if(e._isClipped){n=d}else{n=p}return n(t,r)}e.exports=u;function c(t,e){return n.behavior.zoom().translate(e.translate()).scale(e.scale())}function f(t,e,r){var n=t.id;var i=t.graphDiv;var o=i.layout[n];var s=i._fullLayout[n];var l={};function u(t,e){var r=a.nestedProperty(s,t);if(r.get()!==e){r.set(e);a.nestedProperty(o,t).set(e);l[n+"."+t]=e}}r(u);u("projection.scale",e.scale()/t.fitScale);i.emit("plotly_relayout",l)}function h(t,e){var r=c(t,e);function a(){n.select(this).style(s)}function i(){e.scale(n.event.scale).translate(n.event.translate);t.render()}function o(r){var n=e.invert(t.midPt);r("center.lon",n[0]);r("center.lat",n[1])}function u(){n.select(this).style(l);f(t,e,o)}r.on("zoomstart",a).on("zoom",i).on("zoomend",u);return r}function p(t,e){var r=c(t,e);var a=2;var i,o,u,h,p,d,v,g;function m(t){return e.invert(t)}function y(t){var r=e(m(t));return Math.abs(r[0]-t[0])>a||Math.abs(r[1]-t[1])>a}function x(){n.select(this).style(s);i=n.mouse(this);o=e.rotate();u=e.translate();h=o;p=m(i)}function b(){d=n.mouse(this);if(y(i)){r.scale(e.scale());r.translate(e.translate());return}e.scale(n.event.scale);e.translate([u[0],n.event.translate[1]]);if(!p){i=d;p=m(i)}else if(m(d)){g=m(d);v=[h[0]+(g[0]-p[0]),o[1],o[2]];e.rotate(v);h=v}t.render()}function _(){n.select(this).style(l);f(t,e,w)}function w(r){var n=e.rotate();var a=e.invert(t.midPt);r("projection.rotation.lon",-n[0]);r("center.lon",a[0]);r("center.lat",a[1])}r.on("zoomstart",x).on("zoom",b).on("zoomend",_);return r}function d(t,e){var r={r:e.rotate(),k:e.scale()},a=c(t,e),i=S(a,"zoomstart","zoom","zoomend"),o=0,u=a.on;var h;a.on("zoomstart",function(){n.select(this).style(s);var t=n.mouse(this),o=e.rotate(),l=o,c=e.translate(),f=g(o);h=v(e,t);u.call(a,"zoom",function(){var a=n.mouse(this);e.scale(r.k=n.event.scale);if(!h){t=a;h=v(e,t)}else if(v(e,a)){e.rotate(o).translate(c);var s=v(e,a),u=y(h,s),p=k(m(f,u)),g=r.r=x(p,h,l);if(!isFinite(g[0])||!isFinite(g[1])||!isFinite(g[2])){g=l}e.rotate(g);l=g}d(i.of(this,arguments))});p(i.of(this,arguments))}).on("zoomend",function(){n.select(this).style(l);u.call(a,"zoom",null);b(i.of(this,arguments));f(t,e,_)}).on("zoom.redraw",function(){t.render()});function p(t){if(!o++)t({type:"zoomstart"})}function d(t){t({type:"zoom"})}function b(t){if(!--o)t({type:"zoomend"})}function _(t){var r=e.rotate();t("projection.rotation.lon",-r[0]);t("projection.rotation.lat",-r[1])}return n.rebind(a,i,"on")}function v(t,e){var r=t.invert(e);return r&&isFinite(r[0])&&isFinite(r[1])&&M(r)}function g(t){var e=.5*t[0]*i,r=.5*t[1]*i,n=.5*t[2]*i,a=Math.sin(e),o=Math.cos(e),s=Math.sin(r),l=Math.cos(r),u=Math.sin(n),c=Math.cos(n);return[o*l*c+a*s*u,a*l*c-o*s*u,o*s*c+a*l*u,o*l*u-a*s*c]}function m(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=e[0],s=e[1],l=e[2],u=e[3];return[r*o-n*s-a*l-i*u,r*s+n*o+a*u-i*l,r*l-n*u+a*o+i*s,r*u+n*l-a*s+i*o]}function y(t,e){if(!t||!e)return;var r=T(t,e),n=Math.sqrt(A(r,r)),a=.5*Math.acos(Math.max(-1,Math.min(1,A(t,e)))),i=Math.sin(a)/n;return n&&[Math.cos(a),r[2]*i,-r[1]*i,r[0]*i]}function x(t,e,r){var n=w(e,2,t[0]);n=w(n,1,t[1]);n=w(n,0,t[2]-r[2]);var a=e[0],i=e[1],s=e[2],l=n[0],u=n[1],c=n[2],f=Math.atan2(i,a)*o,h=Math.sqrt(a*a+i*i),p,d;if(Math.abs(u)>h){d=(u>0?90:-90)-f;p=0}else{d=Math.asin(u/h)*o-f;p=Math.sqrt(h*h-u*u)}var v=180-d-2*f,g=(Math.atan2(c,l)-Math.atan2(s,p))*o,m=(Math.atan2(c,l)-Math.atan2(s,-p))*o;var y=b(r[0],r[1],d,g),x=b(r[0],r[1],v,m);if(y<=x)return[d,g,r[2]];else return[v,m,r[2]]}function b(t,e,r,n){var a=_(r-t),i=_(n-e);return Math.sqrt(a*a+i*i)}function _(t){return(t%360+540)%360-180}function w(t,e,r){var n=r*i,a=t.slice(),o=e===0?1:0,s=e===2?1:2,l=Math.cos(n),u=Math.sin(n);a[o]=t[o]*l-t[s]*u;a[s]=t[s]*l+t[o]*u;return a}function k(t){return[Math.atan2(2*(t[0]*t[1]+t[2]*t[3]),1-2*(t[1]*t[1]+t[2]*t[2]))*o,Math.asin(Math.max(-1,Math.min(1,2*(t[0]*t[2]-t[3]*t[1]))))*o,Math.atan2(2*(t[0]*t[3]+t[1]*t[2]),1-2*(t[2]*t[2]+t[3]*t[3]))*o]}function M(t){var e=t[0]*i,r=t[1]*i,n=Math.cos(r);return[n*Math.cos(e),n*Math.sin(e),Math.sin(r)]}function A(t,e){var r=0;for(var n=0,a=t.length;n<a;++n)r+=t[n]*e[n];return r}function T(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function S(t){var e=0,r=arguments.length,a=[];while(++e<r)a.push(arguments[e]);var i=n.dispatch.apply(null,a);i.of=function(e,r){return function(a){var o;try{o=a.sourceEvent=n.event;a.target=t;n.event=a;i[a.type].apply(e,r)}finally{n.event=o}}};return i}},{"../../lib":684,d3:147}],768:[function(t,e,r){"use strict";var n=t("../registry");var a=t("./cartesian/constants").SUBPLOT_PATTERN;r.getSubplotCalcData=function(t,e,r){var a=n.subplotsRegistry[e];if(!a)return[];var i=a.attr;var o=[];for(var s=0;s<t.length;s++){var l=t[s];var u=l[0].trace;if(u[i]===r)o.push(l)}return o};r.getModuleCalcData=function(t,e){var r=[];var a=[];var i;if(typeof e==="string"){i=n.getModule(e).plot}else if(typeof e==="function"){i=e}else{i=e.plot}if(!i){return[r,t]}for(var o=0;o<t.length;o++){var s=t[o];var l=s[0].trace;if(l.visible!==true)continue;if(l._module.plot===i){r.push(s)}else{a.push(s)}}return[r,a]};r.getSubplotData=function t(e,r,i){if(!n.subplotsRegistry[r])return[];var o=n.subplotsRegistry[r].attr;var s=[];var l,u,c;if(r==="gl2d"){var f=i.match(a);u="x"+f[1];c="y"+f[2]}for(var h=0;h<e.length;h++){l=e[h];if(r==="gl2d"&&n.traceIs(l,"gl2d")){if(l[o[0]]===u&&l[o[1]]===c){s.push(l)}}else{if(l[o]===i)s.push(l)}}return s};r.getUidsFromCalcData=function(t){var e={};for(var r=0;r<t.length;r++){var n=t[r][0].trace;e[n.uid]=1}return e}},{"../registry":817,"./cartesian/constants":737}],769:[function(t,e,r){"use strict";var n=t("mouse-change");var a=t("mouse-wheel");var i=t("mouse-event-offset");var o=t("../cartesian/constants");var s=t("has-passive-events");e.exports=u;function l(t,e){this.element=t;this.plot=e;this.mouseListener=null;this.wheelListener=null;this.lastInputTime=Date.now();this.lastPos=[0,0];this.boxEnabled=false;this.boxInited=false;this.boxStart=[0,0];this.boxEnd=[0,0];this.dragStart=[0,0]}function u(t){var e=t.mouseContainer,r=t.glplot,u=new l(e,r);function c(){t.xaxis.autorange=false;t.yaxis.autorange=false}function f(){var e=t.graphDiv._fullLayout._axisConstraintGroups;var r=t.xaxis._id;var n=t.yaxis._id;for(var a=0;a<e.length;a++){if(e[a][r]!==-1){if(e[a][n]!==-1)return true;break}}return false}u.mouseListener=n(e,h);e.addEventListener("touchstart",function(t){var r=i(t.changedTouches[0],e);h(0,r[0],r[1]);h(1,r[0],r[1]);t.preventDefault()},s?{passive:false}:false);e.addEventListener("touchmove",function(t){t.preventDefault();var r=i(t.changedTouches[0],e);h(1,r[0],r[1]);t.preventDefault()},s?{passive:false}:false);e.addEventListener("touchend",function(t){h(0,u.lastPos[0],u.lastPos[1]);t.preventDefault()},s?{passive:false}:false);function h(e,n,a){var i=t.calcDataBox(),s=r.viewBox;var l=u.lastPos[0],h=u.lastPos[1];var p=o.MINDRAG*r.pixelRatio;var d=o.MINZOOM*r.pixelRatio;var v,g;n*=r.pixelRatio;a*=r.pixelRatio;a=s[3]-s[1]-a;function m(e,r,n){var a=Math.min(r,n),o=Math.max(r,n);if(a!==o){i[e]=a;i[e+2]=o;u.dataBox=i;t.setRanges(i)}else{t.selectBox.selectBox=[0,0,1,1];t.glplot.setDirty()}}switch(t.fullLayout.dragmode){case"zoom":if(e){var y=n/(s[2]-s[0])*(i[2]-i[0])+i[0];var x=a/(s[3]-s[1])*(i[3]-i[1])+i[1];if(!u.boxInited){u.boxStart[0]=y;u.boxStart[1]=x;u.dragStart[0]=n;u.dragStart[1]=a}u.boxEnd[0]=y;u.boxEnd[1]=x;u.boxInited=true;if(!u.boxEnabled&&(u.boxStart[0]!==u.boxEnd[0]||u.boxStart[1]!==u.boxEnd[1])){u.boxEnabled=true}var b=Math.abs(u.dragStart[0]-n)<d;var _=Math.abs(u.dragStart[1]-a)<d;if(f()&&!(b&&_)){v=u.boxEnd[0]-u.boxStart[0];g=u.boxEnd[1]-u.boxStart[1];var w=(i[3]-i[1])/(i[2]-i[0]);if(Math.abs(v*w)>Math.abs(g)){u.boxEnd[1]=u.boxStart[1]+Math.abs(v)*w*(g>=0?1:-1);if(u.boxEnd[1]<i[1]){u.boxEnd[1]=i[1];u.boxEnd[0]=u.boxStart[0]+(i[1]-u.boxStart[1])/Math.abs(w)}else if(u.boxEnd[1]>i[3]){u.boxEnd[1]=i[3];u.boxEnd[0]=u.boxStart[0]+(i[3]-u.boxStart[1])/Math.abs(w)}}else{u.boxEnd[0]=u.boxStart[0]+Math.abs(g)/w*(v>=0?1:-1);if(u.boxEnd[0]<i[0]){u.boxEnd[0]=i[0];u.boxEnd[1]=u.boxStart[1]+(i[0]-u.boxStart[0])*Math.abs(w)}else if(u.boxEnd[0]>i[2]){u.boxEnd[0]=i[2];u.boxEnd[1]=u.boxStart[1]+(i[2]-u.boxStart[0])*Math.abs(w)}}}else{if(b)u.boxEnd[0]=u.boxStart[0];if(_)u.boxEnd[1]=u.boxStart[1]}}else if(u.boxEnabled){v=u.boxStart[0]!==u.boxEnd[0];g=u.boxStart[1]!==u.boxEnd[1];if(v||g){if(v){m(0,u.boxStart[0],u.boxEnd[0]);t.xaxis.autorange=false}if(g){m(1,u.boxStart[1],u.boxEnd[1]);t.yaxis.autorange=false}t.relayoutCallback()}else{t.glplot.setDirty()}u.boxEnabled=false;u.boxInited=false}else if(u.boxInited){u.boxInited=false}break;case"pan":u.boxEnabled=false;u.boxInited=false;if(e){if(!u.panning){u.dragStart[0]=n;u.dragStart[1]=a}if(Math.abs(u.dragStart[0]-n)<p)n=u.dragStart[0];if(Math.abs(u.dragStart[1]-a)<p)a=u.dragStart[1];v=(l-n)*(i[2]-i[0])/(r.viewBox[2]-r.viewBox[0]);g=(h-a)*(i[3]-i[1])/(r.viewBox[3]-r.viewBox[1]);i[0]+=v;i[2]+=v;i[1]+=g;i[3]+=g;t.setRanges(i);u.panning=true;u.lastInputTime=Date.now();c();t.cameraChanged();t.handleAnnotations()}else if(u.panning){u.panning=false;t.relayoutCallback()}break}u.lastPos[0]=n;u.lastPos[1]=a}u.wheelListener=a(e,function(e,n){if(!t.scrollZoom)return false;var a=t.calcDataBox(),i=r.viewBox;var o=u.lastPos[0],s=u.lastPos[1];var l=Math.exp(5*n/(i[3]-i[1]));var f=o/(i[2]-i[0])*(a[2]-a[0])+a[0];var h=s/(i[3]-i[1])*(a[3]-a[1])+a[1];a[0]=(a[0]-f)*l+f;a[2]=(a[2]-f)*l+f;a[1]=(a[1]-h)*l+h;a[3]=(a[3]-h)*l+h;t.setRanges(a);u.lastInputTime=Date.now();c();t.cameraChanged();t.handleAnnotations();t.relayoutCallback();return true},true);return u}},{"../cartesian/constants":737,"has-passive-events":379,"mouse-change":402,"mouse-event-offset":403,"mouse-wheel":405}],770:[function(t,e,r){"use strict";var n=t("../cartesian/axes");var a=t("../../lib/html2unicode");var i=t("../../lib/str2rgbarray");function o(t){this.scene=t;this.gl=t.gl;this.pixelRatio=t.pixelRatio;this.screenBox=[0,0,1,1];this.viewBox=[0,0,1,1];this.dataBox=[-1,-1,1,1];this.borderLineEnable=[false,false,false,false];this.borderLineWidth=[1,1,1,1];this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.ticks=[[],[]];this.tickEnable=[true,true,false,false];this.tickPad=[15,15,15,15];this.tickAngle=[0,0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickMarkLength=[0,0,0,0];this.tickMarkWidth=[0,0,0,0];this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labels=["x","y"];this.labelEnable=[true,true,false,false];this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2];this.labelPad=[15,15,15,15];this.labelSize=[12,12];this.labelFont=["sans-serif","sans-serif"];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.title="";this.titleEnable=true;this.titleCenter=[0,0,0,0];this.titleAngle=0;this.titleColor=[0,0,0,1];this.titleFont="sans-serif";this.titleSize=18;this.gridLineEnable=[true,true];this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]];this.gridLineWidth=[1,1];this.zeroLineEnable=[true,true];this.zeroLineWidth=[1,1];this.zeroLineColor=[[0,0,0,1],[0,0,0,1]];this.borderColor=false;this.backgroundColor=[0,0,0,0];this.static=this.scene.staticPlot}var s=o.prototype;var l=["xaxis","yaxis"];s.merge=function(t){this.titleEnable=false;this.backgroundColor=i(t.plot_bgcolor);var e,r,n,o;var s,u,c,f,h;var p,d;for(p=0;p<2;++p){e=l[p];var v=e.charAt(0);r=t[this.scene[e]._name];n=r.title===this.scene.fullLayout._dfltTitle[v]?"":r.title;for(d=0;d<=2;d+=2){this.labelEnable[p+d]=false;this.labels[p+d]=a(n);this.labelColor[p+d]=i(r.titlefont.color);this.labelFont[p+d]=r.titlefont.family;this.labelSize[p+d]=r.titlefont.size;this.labelPad[p+d]=this.getLabelPad(e,r);this.tickEnable[p+d]=false;this.tickColor[p+d]=i((r.tickfont||{}).color);this.tickAngle[p+d]=r.tickangle==="auto"?0:Math.PI*-r.tickangle/180;this.tickPad[p+d]=this.getTickPad(r);this.tickMarkLength[p+d]=0;this.tickMarkWidth[p+d]=r.tickwidth||0;this.tickMarkColor[p+d]=i(r.tickcolor);this.borderLineEnable[p+d]=false;this.borderLineColor[p+d]=i(r.linecolor);this.borderLineWidth[p+d]=r.linewidth||0}c=this.hasSharedAxis(r);s=this.hasAxisInDfltPos(e,r)&&!c;u=this.hasAxisInAltrPos(e,r)&&!c;o=r.mirror||false;f=c?String(o).indexOf("all")!==-1:!!o;h=c?o==="allticks":String(o).indexOf("ticks")!==-1;if(s)this.labelEnable[p]=true;else if(u)this.labelEnable[p+2]=true;if(s)this.tickEnable[p]=r.showticklabels;else if(u)this.tickEnable[p+2]=r.showticklabels;if(s||f)this.borderLineEnable[p]=r.showline;if(u||f)this.borderLineEnable[p+2]=r.showline;if(s||h)this.tickMarkLength[p]=this.getTickMarkLength(r);if(u||h)this.tickMarkLength[p+2]=this.getTickMarkLength(r);this.gridLineEnable[p]=r.showgrid;this.gridLineColor[p]=i(r.gridcolor);this.gridLineWidth[p]=r.gridwidth;this.zeroLineEnable[p]=r.zeroline;this.zeroLineColor[p]=i(r.zerolinecolor);this.zeroLineWidth[p]=r.zerolinewidth}};s.hasSharedAxis=function(t){var e=this.scene;var r=e.fullLayout._subplots.gl2d;var a=n.findSubplotsWithAxis(r,t);return a.indexOf(e.id)!==0};s.hasAxisInDfltPos=function(t,e){var r=e.side;if(t==="xaxis")return r==="bottom";else if(t==="yaxis")return r==="left"};s.hasAxisInAltrPos=function(t,e){var r=e.side;if(t==="xaxis")return r==="top";else if(t==="yaxis")return r==="right"};s.getLabelPad=function(t,e){var r=1.5,n=e.titlefont.size,a=e.showticklabels;if(t==="xaxis"){return e.side==="top"?-10+n*(r+(a?1:0)):-10+n*(r+(a?.5:0))}else if(t==="yaxis"){return e.side==="right"?10+n*(r+(a?1:.5)):10+n*(r+(a?.5:0))}};s.getTickPad=function(t){return t.ticks==="outside"?10+t.ticklen:15};s.getTickMarkLength=function(t){if(!t.ticks)return 0;var e=t.ticklen;return t.ticks==="inside"?-e:e};function u(t){return new o(t)}e.exports=u},{"../../lib/html2unicode":682,"../../lib/str2rgbarray":707,"../cartesian/axes":732}],771:[function(t,e,r){"use strict";var n=t("../../plot_api/edit_types").overrideAll;var a=t("./scene2d");var i=t("../layout_attributes");var o=t("../../constants/xmlns_namespaces");var s=t("../cartesian/constants");var l=t("../cartesian");var u=t("../../components/fx/layout_attributes");var c=t("../get_data").getSubplotData;r.name="gl2d";r.attr=["xaxis","yaxis"];r.idRoot=["x","y"];r.idRegex=s.idRegex;r.attrRegex=s.attrRegex;r.attributes=t("../cartesian/attributes");r.supplyLayoutDefaults=function(t,e,r){if(!e._has("cartesian")){l.supplyLayoutDefaults(t,e,r)}};r.layoutAttrOverrides=n(l.layoutAttributes,"plot","from-root");r.baseLayoutAttrOverrides=n({plot_bgcolor:i.plot_bgcolor,hoverlabel:u.hoverlabel},"plot","nested");r.plot=function t(e){var r=e._fullLayout;var n=e._fullData;var i=r._subplots.gl2d;for(var o=0;o<i.length;o++){var s=i[o],l=r._plots[s],u=c(n,"gl2d",s);var f=l._scene2d;if(f===undefined){f=new a({id:s,graphDiv:e,container:e.querySelector(".gl-container"),staticPlot:e._context.staticPlot,plotGlPixelRatio:e._context.plotGlPixelRatio},r);l._scene2d=f}f.plot(u,e.calcdata,r,e.layout)}};r.clean=function(t,e,r,n){var a=n._subplots.gl2d||[];for(var i=0;i<a.length;i++){var o=a[i],s=n._plots[o];if(!s._scene2d)continue;var u=c(t,"gl2d",o);if(u.length===0){s._scene2d.destroy();delete n._plots[o]}}l.clean.apply(this,arguments)};r.drawFramework=function(t){if(!t._context.staticPlot){l.drawFramework(t)}};r.toSVG=function(t){var e=t._fullLayout;var r=e._subplots.gl2d;for(var n=0;n<r.length;n++){var a=e._plots[r[n]],i=a._scene2d;var s=i.toImage("png");var l=e._glimages.append("svg:image");l.attr({xmlns:o.svg,"xlink:href":s,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"});i.destroy()}};r.updateFx=function(t){var e=t._subplots.gl2d;for(var r=0;r<e.length;r++){var n=t._plots[e[r]]._scene2d;n.updateFx(t.dragmode)}}},{"../../components/fx/layout_attributes":601,"../../constants/xmlns_namespaces":663,"../../plot_api/edit_types":715,"../cartesian":743,"../cartesian/attributes":730,"../cartesian/constants":737,"../get_data":768,"../layout_attributes":786,"./scene2d":772}],772:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../plots/cartesian/axes");var i=t("../../components/fx");var o=t("gl-plot2d");var s=t("gl-spikes2d");var l=t("gl-select-box");var u=t("webgl-context");var c=t("./convert");var f=t("./camera");var h=t("../../lib/html2unicode");var p=t("../../lib/show_no_webgl_msg");var d=t("../cartesian/constraints");var v=d.enforce;var g=d.clean;var m=t("../cartesian/autorange").doAutoRange;var y=["xaxis","yaxis"];var x,b;var _=t("../cartesian/constants").SUBPLOT_PATTERN;function w(t,e){this.container=t.container;this.graphDiv=t.graphDiv;this.pixelRatio=t.plotGlPixelRatio||window.devicePixelRatio;this.id=t.id;this.staticPlot=!!t.staticPlot;this.scrollZoom=this.graphDiv._context.scrollZoom;this.fullData=null;this.updateRefs(e);this.makeFramework();if(this.stopped)return;this.glplotOptions=c(this);this.glplotOptions.merge(e);this.glplot=o(this.glplotOptions);this.camera=f(this);this.traces={};this.spikes=s(this.glplot);this.selectBox=l(this.glplot,{innerFill:false,outerFill:true});this.lastButtonState=0;this.pickResult=null;this.isMouseOver=true;this.stopped=false;this.redraw=this.draw.bind(this);this.redraw()}e.exports=w;var k=w.prototype;k.makeFramework=function(){if(this.staticPlot){if(!b){x=document.createElement("canvas");b=u({canvas:x,preserveDrawingBuffer:false,premultipliedAlpha:true,antialias:true});if(!b){throw new Error("Error creating static canvas/context for image server")}}this.canvas=x;this.gl=b}else{var t=this.container.querySelector(".gl-canvas-focus");var e=u({canvas:t,preserveDrawingBuffer:true,premultipliedAlpha:true});if(!e){p(this);this.stopped=true;return}this.canvas=t;this.gl=e}var r=this.canvas;r.style.width="100%";r.style.height="100%";r.style.position="absolute";r.style.top="0px";r.style.left="0px";r.style["pointer-events"]="none";this.updateSize(r);r.className+=" user-select-none";var n=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");n.style.position="absolute";n.style.top=n.style.left="0px";n.style.width=n.style.height="100%";n.style["z-index"]=20;n.style["pointer-events"]="none";var a=this.mouseContainer=document.createElement("div");a.style.position="absolute";a.style["pointer-events"]="auto";this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var i=this.container;i.appendChild(n);i.appendChild(a);var o=this;a.addEventListener("mouseout",function(){o.isMouseOver=false;o.unhover()});a.addEventListener("mouseover",function(){o.isMouseOver=true})};k.toImage=function(t){if(!t)t="png";this.stopped=true;if(this.staticPlot)this.container.appendChild(x);this.updateSize(this.canvas);var e=this.glplot.gl,r=e.drawingBufferWidth,n=e.drawingBufferHeight;e.clearColor(1,1,1,0);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);this.glplot.setDirty();this.glplot.draw();e.bindFramebuffer(e.FRAMEBUFFER,null);var a=new Uint8Array(r*n*4);e.readPixels(0,0,r,n,e.RGBA,e.UNSIGNED_BYTE,a);for(var i=0,o=n-1;i<o;++i,--o){for(var s=0;s<r;++s){for(var l=0;l<4;++l){var u=a[4*(r*i+s)+l];a[4*(r*i+s)+l]=a[4*(r*o+s)+l];a[4*(r*o+s)+l]=u}}}var c=document.createElement("canvas");c.width=r;c.height=n;var f=c.getContext("2d");var h=f.createImageData(r,n);h.data.set(a);f.putImageData(h,0,0);var p;switch(t){case"jpeg":p=c.toDataURL("image/jpeg");break;case"webp":p=c.toDataURL("image/webp");break;default:p=c.toDataURL("image/png")}if(this.staticPlot)this.container.removeChild(x);return p};k.updateSize=function(t){if(!t)t=this.canvas;var e=this.pixelRatio,r=this.fullLayout;var n=r.width,a=r.height,i=Math.ceil(e*n)|0,o=Math.ceil(e*a)|0;if(t.width!==i||t.height!==o){t.width=i;t.height=o}return t};k.computeTickMarks=function(){this.xaxis.setScale();this.yaxis.setScale();var t=[a.calcTicks(this.xaxis),a.calcTicks(this.yaxis)];for(var e=0;e<2;++e){for(var r=0;r<t[e].length;++r){t[e][r].text=h(t[e][r].text+"")}}return t};function M(t,e){for(var r=0;r<2;++r){var n=t[r],a=e[r];if(n.length!==a.length)return true;for(var i=0;i<n.length;++i){if(n[i].x!==a[i].x)return true}}return false}k.updateRefs=function(t){this.fullLayout=t;var e=this.id.match(_);var r="xaxis"+e[1];var n="yaxis"+e[2];this.xaxis=this.fullLayout[r];this.yaxis=this.fullLayout[n]};k.relayoutCallback=function(){var t=this.graphDiv,e=this.xaxis,r=this.yaxis,n=t.layout;n.xaxis.autorange=e.autorange;n.xaxis.range=e.range.slice(0);n.yaxis.autorange=r.autorange;n.yaxis.range=r.range.slice(0);var a={lastInputTime:this.camera.lastInputTime};a[e._name]=e.range.slice(0);a[r._name]=r.range.slice(0);t.emit("plotly_relayout",a)};k.cameraChanged=function(){var t=this.camera;this.glplot.setDataBox(this.calcDataBox());var e=this.computeTickMarks();var r=this.glplotOptions.ticks;if(M(e,r)){this.glplotOptions.ticks=e;this.glplotOptions.dataBox=t.dataBox;this.glplot.update(this.glplotOptions);this.handleAnnotations()}};k.handleAnnotations=function(){var t=this.graphDiv,e=this.fullLayout.annotations;for(var r=0;r<e.length;r++){var a=e[r];if(a.xref===this.xaxis._id&&a.yref===this.yaxis._id){n.getComponentMethod("annotations","drawOne")(t,r)}}};k.destroy=function(){if(!this.glplot)return;var t=this.traces;if(t){Object.keys(t).map(function(e){t[e].dispose();delete t[e]})}this.glplot.dispose();this.container.removeChild(this.svgContainer);this.container.removeChild(this.mouseContainer);this.fullData=null;this.glplot=null;this.stopped=true;this.camera.mouseListener.enabled=false;this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener);this.camera=null};k.plot=function(t,e,r){var n=this.glplot;this.updateRefs(r);this.xaxis.clearCalc();this.yaxis.clearCalc();this.updateTraces(t,e);this.updateFx(r.dragmode);var a=r.width,i=r.height;this.updateSize(this.canvas);var o=this.glplotOptions;o.merge(r);o.screenBox=[0,0,a,i];var s={_fullLayout:{_axisConstraintGroups:this.graphDiv._fullLayout._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis}};g(s,this.xaxis);g(s,this.yaxis);var l=r._size,u=this.xaxis.domain,c=this.yaxis.domain;o.viewBox=[l.l+u[0]*l.w,l.b+c[0]*l.h,a-l.r-(1-u[1])*l.w,i-l.t-(1-c[1])*l.h];this.mouseContainer.style.width=l.w*(u[1]-u[0])+"px";this.mouseContainer.style.height=l.h*(c[1]-c[0])+"px";this.mouseContainer.height=l.h*(c[1]-c[0]);this.mouseContainer.style.left=l.l+u[0]*l.w+"px";this.mouseContainer.style.top=l.t+(1-c[1])*l.h+"px";var f,h;for(h=0;h<2;++h){f=this[y[h]];f._length=o.viewBox[h+2]-o.viewBox[h];m(f);f.setScale()}v(s);o.ticks=this.computeTickMarks();o.dataBox=this.calcDataBox();o.merge(r);n.update(o);this.glplot.draw()};k.calcDataBox=function(){var t=this.xaxis,e=this.yaxis,r=t.range,n=e.range,a=t.r2l,i=e.r2l;return[a(r[0]),i(n[0]),a(r[1]),i(n[1])]};k.setRanges=function(t){var e=this.xaxis,r=this.yaxis,n=e.l2r,a=r.l2r;e.range=[n(t[0]),n(t[2])];r.range=[a(t[1]),a(t[3])]};k.updateTraces=function(t,e){var r=Object.keys(this.traces);var n,a,i;this.fullData=t;t:for(n=0;n<r.length;n++){var o=r[n],s=this.traces[o];for(a=0;a<t.length;a++){i=t[a];if(i.uid===o&&i.type===s.type){continue t}}s.dispose();delete this.traces[o]}for(n=0;n<t.length;n++){i=t[n];var l=e[n],u=this.traces[i.uid];if(u)u.update(i,l);else{u=i._module.plot(this,i,l);this.traces[i.uid]=u}}this.glplot.objects.sort(function(t,e){return t._trace.index-e._trace.index})};k.updateFx=function(t){if(t==="lasso"||t==="select"){this.pickCanvas.style["pointer-events"]="none";this.mouseContainer.style["pointer-events"]="none"}else{this.pickCanvas.style["pointer-events"]="auto";this.mouseContainer.style["pointer-events"]="auto"}if(t==="pan"){this.mouseContainer.style.cursor="move"}else if(t==="zoom"){this.mouseContainer.style.cursor="crosshair"}else{this.mouseContainer.style.cursor=null}};k.emitPointAction=function(t,e){var r=t.trace.uid;var n=t.pointIndex;var a;for(var o=0;o<this.fullData.length;o++){if(this.fullData[o].uid===r){a=this.fullData[o]}}var s={x:t.traceCoord[0],y:t.traceCoord[1],curveNumber:a.index,pointNumber:n,data:a._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};i.appendArrayPointValue(s,a,n);this.graphDiv.emit(e,{points:[s]})};k.draw=function(){if(this.stopped)return;requestAnimationFrame(this.redraw);var t=this.glplot,e=this.camera,r=e.mouseListener,n=this.lastButtonState===1&&r.buttons===0,a=this.fullLayout;this.lastButtonState=r.buttons;this.cameraChanged();var o=r.x*t.pixelRatio;var s=this.canvas.height-t.pixelRatio*r.y;var l;if(e.boxEnabled&&a.dragmode==="zoom"){this.selectBox.enabled=true;var u=this.selectBox.selectBox=[Math.min(e.boxStart[0],e.boxEnd[0]),Math.min(e.boxStart[1],e.boxEnd[1]),Math.max(e.boxStart[0],e.boxEnd[0]),Math.max(e.boxStart[1],e.boxEnd[1])];for(var c=0;c<2;c++){if(e.boxStart[c]===e.boxEnd[c]){u[c]=t.dataBox[c];u[c+2]=t.dataBox[c+2]}}t.setDirty()}else if(!e.panning&&this.isMouseOver){this.selectBox.enabled=false;var f=a._size,h=this.xaxis.domain,p=this.yaxis.domain;l=t.pick(o/t.pixelRatio+f.l+h[0]*f.w,s/t.pixelRatio-(f.t+(1-p[1])*f.h));var d=l&&l.object._trace.handlePick(l);if(d&&n){this.emitPointAction(d,"plotly_click")}if(l&&l.object._trace.hoverinfo!=="skip"&&a.hovermode){if(d&&(!this.lastPickResult||this.lastPickResult.traceUid!==d.trace.uid||this.lastPickResult.dataCoord[0]!==d.dataCoord[0]||this.lastPickResult.dataCoord[1]!==d.dataCoord[1])){var v=d;this.lastPickResult={traceUid:d.trace?d.trace.uid:null,dataCoord:d.dataCoord.slice()};this.spikes.update({center:l.dataCoord});v.screenCoord=[((t.viewBox[2]-t.viewBox[0])*(l.dataCoord[0]-t.dataBox[0])/(t.dataBox[2]-t.dataBox[0])+t.viewBox[0])/t.pixelRatio,(this.canvas.height-(t.viewBox[3]-t.viewBox[1])*(l.dataCoord[1]-t.dataBox[1])/(t.dataBox[3]-t.dataBox[1])-t.viewBox[1])/t.pixelRatio];this.emitPointAction(d,"plotly_hover");var g=this.fullData[v.trace.index]||{};var m=v.pointIndex;var y=i.castHoverinfo(g,a,m);if(y&&y!=="all"){var x=y.split("+");if(x.indexOf("x")===-1)v.traceCoord[0]=undefined;if(x.indexOf("y")===-1)v.traceCoord[1]=undefined;if(x.indexOf("z")===-1)v.traceCoord[2]=undefined;if(x.indexOf("text")===-1)v.textLabel=undefined;if(x.indexOf("name")===-1)v.name=undefined}i.loneHover({x:v.screenCoord[0],y:v.screenCoord[1],xLabel:this.hoverFormatter("xaxis",v.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",v.traceCoord[1]),zLabel:v.traceCoord[2],text:v.textLabel,name:v.name,color:i.castHoverOption(g,m,"bgcolor")||v.color,borderColor:i.castHoverOption(g,m,"bordercolor"),fontFamily:i.castHoverOption(g,m,"font.family"),fontSize:i.castHoverOption(g,m,"font.size"),fontColor:i.castHoverOption(g,m,"font.color")},{container:this.svgContainer,gd:this.graphDiv})}}}if(!l){this.unhover()}t.draw()};k.unhover=function(){if(this.lastPickResult){this.spikes.update({});this.lastPickResult=null;this.graphDiv.emit("plotly_unhover");i.loneUnhover(this.svgContainer)}};k.hoverFormatter=function(t,e){if(e===undefined)return undefined;var r=this[t];return a.tickText(r,r.c2l(e),"hover").text}},{"../../components/fx":600,"../../lib/html2unicode":682,"../../lib/show_no_webgl_msg":705,"../../plots/cartesian/axes":732,"../../registry":817,"../cartesian/autorange":731,"../cartesian/constants":737,"../cartesian/constraints":739,"./camera":769,"./convert":770,"gl-plot2d":275,"gl-select-box":285,"gl-spikes2d":294,"webgl-context":521}],773:[function(t,e,r){"use strict";e.exports=u;var n=t("right-now");var a=t("3d-view");var i=t("mouse-change");var o=t("mouse-wheel");var s=t("mouse-event-offset");var l=t("has-passive-events");function u(t,e){t=t||document.body;e=e||{};var r=[.01,Infinity];if("distanceLimits"in e){r[0]=e.distanceLimits[0];r[1]=e.distanceLimits[1]}if("zoomMin"in e){r[0]=e.zoomMin}if("zoomMax"in e){r[1]=e.zoomMax}var u=a({center:e.center||[0,0,0],up:e.up||[0,1,0],eye:e.eye||[0,0,10],mode:e.mode||"orbit",distanceLimits:r});var c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var f=0;var h=t.clientWidth;var p=t.clientHeight;var d={keyBindingMode:"rotate",view:u,element:t,delay:e.delay||16,rotateSpeed:e.rotateSpeed||1,zoomSpeed:e.zoomSpeed||1,translateSpeed:e.translateSpeed||1,flipX:!!e.flipX,flipY:!!e.flipY,modes:u.modes,tick:function(){var e=n();var r=this.delay;var a=e-2*r;u.idle(e-r);u.recalcMatrix(a);u.flush(e-(100+r*2));var i=true;var o=u.computedMatrix;for(var s=0;s<16;++s){i=i&&c[s]===o[s];c[s]=o[s]}var l=t.clientWidth===h&&t.clientHeight===p;h=t.clientWidth;p=t.clientHeight;if(i)return!l;f=Math.exp(u.computedRadius[0]);return true},lookAt:function(t,e,r){u.lookAt(u.lastT(),t,e,r)},rotate:function(t,e,r){u.rotate(u.lastT(),t,e,r)},pan:function(t,e,r){u.pan(u.lastT(),t,e,r)},translate:function(t,e,r){u.translate(u.lastT(),t,e,r)}};Object.defineProperties(d,{matrix:{get:function(){return u.computedMatrix},set:function(t){u.setMatrix(u.lastT(),t);return u.computedMatrix},enumerable:true},mode:{get:function(){return u.getMode()},set:function(t){var e=u.computedUp.slice();var r=u.computedEye.slice();var a=u.computedCenter.slice();u.setMode(t);if(t==="turntable"){var i=n();u._active.lookAt(i,r,a,e);u._active.lookAt(i+500,r,a,[0,0,1]);u._active.flush(i)}return u.getMode()},enumerable:true},center:{get:function(){return u.computedCenter},set:function(t){u.lookAt(u.lastT(),null,t);return u.computedCenter},enumerable:true},eye:{get:function(){return u.computedEye},set:function(t){u.lookAt(u.lastT(),t);return u.computedEye},enumerable:true},up:{get:function(){return u.computedUp},set:function(t){u.lookAt(u.lastT(),null,null,t);return u.computedUp},enumerable:true},distance:{get:function(){return f},set:function(t){u.setDistance(u.lastT(),t);return t},enumerable:true},distanceLimits:{get:function(){return u.getDistanceLimits(r)},set:function(t){u.setDistanceLimits(t);return t},enumerable:true}});t.addEventListener("contextmenu",function(t){t.preventDefault();return false});var v=0,g=0,m={shift:false,control:false,alt:false,meta:false};d.mouseListener=i(t,y);t.addEventListener("touchstart",function(e){var r=s(e.changedTouches[0],t);y(0,r[0],r[1],m);y(1,r[0],r[1],m);e.preventDefault()},l?{passive:false}:false);t.addEventListener("touchmove",function(e){var r=s(e.changedTouches[0],t);y(1,r[0],r[1],m);e.preventDefault()},l?{passive:false}:false);t.addEventListener("touchend",function(t){y(0,v,g,m);t.preventDefault()},l?{passive:false}:false);function y(e,r,a,i){var o=d.keyBindingMode;if(o===false)return;var s=o==="rotate";var l=o==="pan";var c=o==="zoom";var h=!!i.control;var p=!!i.alt;var y=!!i.shift;var x=!!(e&1);var b=!!(e&2);var _=!!(e&4);var w=1/t.clientHeight;var k=w*(r-v);var M=w*(a-g);var A=d.flipX?1:-1;var T=d.flipY?1:-1;var S=n();var E=Math.PI*d.rotateSpeed;if(s&&x&&!h&&!p&&!y||x&&!h&&!p&&y){u.rotate(S,A*E*k,-T*E*M,0)}if(l&&x&&!h&&!p&&!y||b||x&&h&&!p&&!y){u.pan(S,-d.translateSpeed*k*f,d.translateSpeed*M*f,0)}if(c&&x&&!h&&!p&&!y||_||x&&!h&&p&&!y){var C=-d.zoomSpeed*M/window.innerHeight*(S-u.lastT())*100;u.pan(S,0,0,f*(Math.exp(C)-1))}v=r;g=a;m=i;return true}d.wheelListener=o(t,function(t,e){if(d.keyBindingMode===false)return;var r=d.flipX?1:-1;var a=d.flipY?1:-1;var i=n();if(Math.abs(t)>Math.abs(e)){u.rotate(i,0,0,-t*r*Math.PI*d.rotateSpeed/window.innerWidth)}else{var o=-d.zoomSpeed*a*e/window.innerHeight*(i-u.lastT())/20;u.pan(i,0,0,f*(Math.exp(o)-1))}},true);return d}},{"3d-view":43,"has-passive-events":379,"mouse-change":402,"mouse-event-offset":403,"mouse-wheel":405,"right-now":465}],774:[function(t,e,r){"use strict";var n=t("../../plot_api/edit_types").overrideAll;var a=t("../../components/fx/layout_attributes");var i=t("./scene");var o=t("../get_data").getSubplotData;var s=t("../../lib");var l=t("../../constants/xmlns_namespaces");var u="gl3d";var c="scene";r.name=u;r.attr=c;r.idRoot=c;r.idRegex=r.attrRegex=s.counterRegex("scene");r.attributes=t("./layout/attributes");r.layoutAttributes=t("./layout/layout_attributes");r.baseLayoutAttrOverrides=n({hoverlabel:a.hoverlabel},"plot","nested");r.supplyLayoutDefaults=t("./layout/defaults");r.plot=function t(e){var r=e._fullLayout;var n=e._fullData;var a=r._subplots[u];for(var l=0;l<a.length;l++){var c=a[l],f=o(n,u,c),h=r[c],p=h._scene;if(!p){p=new i({id:c,graphDiv:e,container:e.querySelector(".gl-container"),staticPlot:e._context.staticPlot,plotGlPixelRatio:e._context.plotGlPixelRatio},r);h._scene=p}if(!p.cameraInitial){p.cameraInitial=s.extendDeep({},h.camera)}p.plot(f,r,e.layout)}};r.clean=function(t,e,r,n){var a=n._subplots[u]||[];for(var i=0;i<a.length;i++){var o=a[i];if(!e[o]&&!!n[o]._scene){n[o]._scene.destroy();if(n._infolayer){n._infolayer.selectAll(".annotation-"+o).remove()}}}};r.toSVG=function(t){var e=t._fullLayout;var r=e._subplots[u];var n=e._size;for(var a=0;a<r.length;a++){var i=e[r[a]];var o=i.domain;var s=i._scene;var c=s.toImage("png");var f=e._glimages.append("svg:image");f.attr({xmlns:l.svg,"xlink:href":c,x:n.l+n.w*o.x[0],y:n.t+n.h*(1-o.y[1]),width:n.w*(o.x[1]-o.x[0]),height:n.h*(o.y[1]-o.y[0]),preserveAspectRatio:"none"});s.destroy()}};r.cleanId=function t(e){if(!e.match(/^scene[0-9]*$/))return;var r=e.substr(5);if(r==="1")r="";return c+r};r.updateFx=function(t){var e=t._subplots[u];for(var r=0;r<e.length;r++){var n=t[e[r]]._scene;n.updateFx(t.dragmode,t.hovermode)}}},{"../../components/fx/layout_attributes":601,"../../constants/xmlns_namespaces":663,"../../lib":684,"../../plot_api/edit_types":715,"../get_data":768,"./layout/attributes":775,"./layout/defaults":779,"./layout/layout_attributes":780,"./scene":784}],775:[function(t,e,r){"use strict";e.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],776:[function(t,e,r){"use strict";var n=t("../../../components/color");var a=t("../../cartesian/layout_attributes");var i=t("../../../lib/extend").extendFlat;var o=t("../../../plot_api/edit_types").overrideAll;e.exports=o({visible:a.visible,showspikes:{valType:"boolean",dflt:true},spikesides:{valType:"boolean",dflt:true},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:n.defaultLine},showbackground:{valType:"boolean",dflt:false},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:true},color:a.color,categoryorder:a.categoryorder,categoryarray:a.categoryarray,title:a.title,titlefont:a.titlefont,type:a.type,autorange:a.autorange,rangemode:a.rangemode,range:a.range,tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:a.ticks,mirror:a.mirror,ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,showticklabels:a.showticklabels,tickfont:a.tickfont,tickangle:a.tickangle,tickprefix:a.tickprefix,showtickprefix:a.showtickprefix,ticksuffix:a.ticksuffix,showticksuffix:a.showticksuffix,showexponent:a.showexponent,exponentformat:a.exponentformat,separatethousands:a.separatethousands,tickformat:a.tickformat,tickformatstops:a.tickformatstops,hoverformat:a.hoverformat,showline:a.showline,linecolor:a.linecolor,linewidth:a.linewidth,showgrid:a.showgrid,gridcolor:i({},a.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:a.gridwidth,zeroline:a.zeroline,zerolinecolor:a.zerolinecolor,zerolinewidth:a.zerolinewidth},"plot","from-root")},{"../../../components/color":558,"../../../lib/extend":673,"../../../plot_api/edit_types":715,"../../cartesian/layout_attributes":744}],777:[function(t,e,r){"use strict";var n=t("tinycolor2").mix;var a=t("../../../lib");var i=t("../../../plot_api/plot_template");var o=t("./axis_attributes");var s=t("../../cartesian/type_defaults");var l=t("../../cartesian/axis_defaults");var u=["xaxis","yaxis","zaxis"];var c=100*(204-68)/(255-68);e.exports=function t(e,r,f){var h,p;function d(t,e){return a.coerce(h,p,o,t,e)}for(var v=0;v<u.length;v++){var g=u[v];h=e[g]||{};p=i.newContainer(r,g);p._id=g[0]+f.scene;p._name=g;s(h,p,d,f.data);l(h,p,d,{font:f.font,letter:g[0],data:f.data,showGrid:true,bgColor:f.bgColor,calendar:f.calendar},f.fullLayout);d("gridcolor",n(p.color,f.bgColor,c).toRgbString());d("title",g[0]);p.setScale=a.noop;if(d("showspikes")){d("spikesides");d("spikethickness");d("spikecolor",p.color)}d("showaxeslabels");if(d("showbackground"))d("backgroundcolor")}}},{"../../../lib":684,"../../../plot_api/plot_template":722,"../../cartesian/axis_defaults":734,"../../cartesian/type_defaults":755,"./axis_attributes":776,tinycolor2:499}],778:[function(t,e,r){"use strict";var n=t("../../../lib/html2unicode");var a=t("../../../lib/str2rgbarray");var i=["xaxis","yaxis","zaxis"];function o(){this.bounds=[[-10,-10,-10],[10,10,10]];this.ticks=[[],[],[]];this.tickEnable=[true,true,true];this.tickFont=["sans-serif","sans-serif","sans-serif"];this.tickSize=[12,12,12];this.tickAngle=[0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[18,18,18];this.labels=["x","y","z"];this.labelEnable=[true,true,true];this.labelFont=["Open Sans","Open Sans","Open Sans"];this.labelSize=[20,20,20];this.labelAngle=[0,0,0];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[30,30,30];this.lineEnable=[true,true,true];this.lineMirror=[false,false,false];this.lineWidth=[1,1,1];this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.lineTickEnable=[true,true,true];this.lineTickMirror=[false,false,false];this.lineTickLength=[10,10,10];this.lineTickWidth=[1,1,1];this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.gridEnable=[true,true,true];this.gridWidth=[1,1,1];this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroEnable=[true,true,true];this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroLineWidth=[2,2,2];this.backgroundEnable=[true,true,true];this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this._defaultTickPad=this.tickPad.slice();this._defaultLabelPad=this.labelPad.slice();this._defaultLineTickLength=this.lineTickLength.slice()}var s=o.prototype;s.merge=function(t){var e=this;for(var r=0;r<3;++r){var o=t[i[r]];if(!o.visible){e.tickEnable[r]=false;e.labelEnable[r]=false;e.lineEnable[r]=false;e.lineTickEnable[r]=false;e.gridEnable[r]=false;e.zeroEnable[r]=false;e.backgroundEnable[r]=false;continue}e.labels[r]=n(o.title);if("titlefont"in o){if(o.titlefont.color)e.labelColor[r]=a(o.titlefont.color);if(o.titlefont.family)e.labelFont[r]=o.titlefont.family;if(o.titlefont.size)e.labelSize[r]=o.titlefont.size}if("showline"in o)e.lineEnable[r]=o.showline;if("linecolor"in o)e.lineColor[r]=a(o.linecolor);if("linewidth"in o)e.lineWidth[r]=o.linewidth;if("showgrid"in o)e.gridEnable[r]=o.showgrid;if("gridcolor"in o)e.gridColor[r]=a(o.gridcolor);if("gridwidth"in o)e.gridWidth[r]=o.gridwidth;if(o.type==="log")e.zeroEnable[r]=false;else if("zeroline"in o)e.zeroEnable[r]=o.zeroline;if("zerolinecolor"in o)e.zeroLineColor[r]=a(o.zerolinecolor);if("zerolinewidth"in o)e.zeroLineWidth[r]=o.zerolinewidth;if("ticks"in o&&!!o.ticks)e.lineTickEnable[r]=true;else e.lineTickEnable[r]=false;if("ticklen"in o){e.lineTickLength[r]=e._defaultLineTickLength[r]=o.ticklen}if("tickcolor"in o)e.lineTickColor[r]=a(o.tickcolor);if("tickwidth"in o)e.lineTickWidth[r]=o.tickwidth;if("tickangle"in o){e.tickAngle[r]=o.tickangle==="auto"?0:Math.PI*-o.tickangle/180}if("showticklabels"in o)e.tickEnable[r]=o.showticklabels;if("tickfont"in o){if(o.tickfont.color)e.tickColor[r]=a(o.tickfont.color);if(o.tickfont.family)e.tickFont[r]=o.tickfont.family;if(o.tickfont.size)e.tickSize[r]=o.tickfont.size}if("mirror"in o){if(["ticks","all","allticks"].indexOf(o.mirror)!==-1){e.lineTickMirror[r]=true;e.lineMirror[r]=true}else if(o.mirror===true){e.lineTickMirror[r]=false;e.lineMirror[r]=true}else{e.lineTickMirror[r]=false;e.lineMirror[r]=false}}else e.lineMirror[r]=false;if("showbackground"in o&&o.showbackground!==false){e.backgroundEnable[r]=true;e.backgroundColor[r]=a(o.backgroundcolor)}else e.backgroundEnable[r]=false}};function l(t){var e=new o;e.merge(t);return e}e.exports=l},{"../../../lib/html2unicode":682,"../../../lib/str2rgbarray":707}],779:[function(t,e,r){"use strict";var n=t("../../../lib");var a=t("../../../components/color");var i=t("../../../registry");var o=t("../../subplot_defaults");var s=t("./axis_defaults");var l=t("./layout_attributes");e.exports=function t(e,r,a){var i=r._basePlotModules.length>1;function s(t){if(i)return;var r=n.validate(e[t],l[t]);if(r)return e[t]}o(e,r,a,{type:"gl3d",attributes:l,handleDefaults:u,fullLayout:r,font:r.font,fullData:a,getDfltFromLayout:s,paper_bgcolor:r.paper_bgcolor,calendar:r.calendar})};function u(t,e,r,n){var o=r("bgcolor"),l=a.combine(o,n.paper_bgcolor);var u=["up","center","eye"];for(var c=0;c<u.length;c++){r("camera."+u[c]+".x");r("camera."+u[c]+".y");r("camera."+u[c]+".z")}var f=!!r("aspectratio.x")&&!!r("aspectratio.y")&&!!r("aspectratio.z");var h=f?"manual":"auto";var p=r("aspectmode",h);if(!f){t.aspectratio=e.aspectratio={x:1,y:1,z:1};if(p==="manual")e.aspectmode="auto";t.aspectmode=e.aspectmode}s(t,e,{font:n.font,scene:n.id,data:n.fullData,bgColor:l,calendar:n.calendar,fullLayout:n.fullLayout});i.getComponentMethod("annotations3d","handleDefaults")(t,e,n);r("dragmode",n.getDfltFromLayout("dragmode"));r("hovermode",n.getDfltFromLayout("hovermode"))}},{"../../../components/color":558,"../../../lib":684,"../../../registry":817,"../../subplot_defaults":809,"./axis_defaults":777,"./layout_attributes":780}],780:[function(t,e,r){"use strict";var n=t("./axis_attributes");var a=t("../../domain").attributes;var i=t("../../../lib/extend").extendFlat;var o=t("../../../lib").counterRegex;function s(t,e,r){return{x:{valType:"number",dflt:t,editType:"camera"},y:{valType:"number",dflt:e,editType:"camera"},z:{valType:"number",dflt:r,editType:"camera"},editType:"camera"}}e.exports={_arrayAttrRegexps:[o("scene",".annotations",true)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:i(s(0,0,1),{}),center:i(s(0,0,0),{}),eye:i(s(1.25,1.25,1.25),{}),editType:"camera"},domain:a({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":undefined,"aspectratio.y":undefined,"aspectratio.z":undefined}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:n,yaxis:n,zaxis:n,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",false],dflt:"turntable",editType:"plot"},hovermode:{valType:"enumerated",values:["closest",false],dflt:"closest",editType:"modebar"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":684,"../../../lib/extend":673,"../../domain":757,"./axis_attributes":776}],781:[function(t,e,r){"use strict";var n=t("../../../lib/str2rgbarray");var a=["xaxis","yaxis","zaxis"];function i(){this.enabled=[true,true,true];this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.drawSides=[true,true,true];this.lineWidth=[1,1,1]}var o=i.prototype;o.merge=function(t){for(var e=0;e<3;++e){var r=t[a[e]];if(!r.visible){this.enabled[e]=false;this.drawSides[e]=false;continue}this.enabled[e]=r.showspikes;this.colors[e]=n(r.spikecolor);this.drawSides[e]=r.spikesides;this.lineWidth[e]=r.spikethickness}};function s(t){var e=new i;e.merge(t);return e}e.exports=s},{"../../../lib/str2rgbarray":707}],782:[function(t,e,r){"use strict";e.exports=u;var n=t("../../cartesian/axes");var a=t("../../../lib");var i=t("../../../lib/html2unicode");var o=["xaxis","yaxis","zaxis"];var s=[0,0,0];function l(t){var e=new Array(3);for(var r=0;r<3;++r){var n=t[r];var a=new Array(n.length);for(var i=0;i<n.length;++i){a[i]=n[i].x}e[r]=a}return e}function u(t){var e=t.axesOptions;var r=t.glplot.axesPixels;var u=t.fullSceneLayout;var c=[[],[],[]];for(var f=0;f<3;++f){var h=u[o[f]];h._length=(r[f].hi-r[f].lo)*r[f].pixelsPerDataUnit/t.dataScale[f];if(Math.abs(h._length)===Infinity){c[f]=[]}else{h._input_range=h.range.slice();h.range[0]=r[f].lo/t.dataScale[f];h.range[1]=r[f].hi/t.dataScale[f];h._m=1/(t.dataScale[f]*r[f].pixelsPerDataUnit);if(h.range[0]===h.range[1]){h.range[0]-=1;h.range[1]+=1}var p=h.tickmode;if(h.tickmode==="auto"){h.tickmode="linear";var d=h.nticks||a.constrain(h._length/40,4,9);n.autoTicks(h,Math.abs(h.range[1]-h.range[0])/d)}var v=n.calcTicks(h);for(var g=0;g<v.length;++g){v[g].x=v[g].x*t.dataScale[f];v[g].text=i(v[g].text)}c[f]=v;h.tickmode=p}}e.ticks=c;for(var f=0;f<3;++f){s[f]=.5*(t.glplot.bounds[0][f]+t.glplot.bounds[1][f]);for(var g=0;g<2;++g){e.bounds[g][f]=t.glplot.bounds[g][f]}}t.contourLevels=l(c)}},{"../../../lib":684,"../../../lib/html2unicode":682,"../../cartesian/axes":732}],783:[function(t,e,r){"use strict";function n(t,e){var r=[0,0,0,0];var n,a;for(n=0;n<4;++n){for(a=0;a<4;++a){r[a]+=t[4*n+a]*e[n]}}return r}function a(t,e){var r=n(t.projection,n(t.view,n(t.model,[e[0],e[1],e[2],1])));return r}e.exports=a},{}],784:[function(t,e,r){"use strict";var n=t("gl-plot3d");var a=t("webgl-context");var i=t("has-passive-events");var o=t("../../registry");var s=t("../../lib");var l=t("../../plots/cartesian/axes");var u=t("../../components/fx");var c=t("../../lib/str2rgbarray");var f=t("../../lib/show_no_webgl_msg");var h=t("./camera");var p=t("./project");var d=t("./layout/convert");var v=t("./layout/spikes");var g=t("./layout/tick_marks");var m,y;function x(t){var e;var r=t.svgContainer;var n=t.container.getBoundingClientRect();var a=n.width,i=n.height;r.setAttributeNS(null,"viewBox","0 0 "+a+" "+i);r.setAttributeNS(null,"width",a);r.setAttributeNS(null,"height",i);g(t);t.glplot.axes.update(t.axesOptions);var o=Object.keys(t.traces);var s=null;var c=t.glplot.selection;for(var f=0;f<o.length;++f){e=t.traces[o[f]];if(e.data.hoverinfo!=="skip"&&e.handlePick(c)){s=e}if(e.setContourLevels)e.setContourLevels()}function h(e,r){var n=t.fullSceneLayout[e];return l.tickText(n,n.d2l(r),"hover").text}var d;if(s!==null){var v=p(t.glplot.cameraParams,c.dataCoordinate);e=s.data;var m=c.index;var y=u.castHoverinfo(e,t.fullLayout,m);var x=y.split("+");var b=y==="all";var _=h("xaxis",c.traceCoordinate[0]);var w=h("yaxis",c.traceCoordinate[1]);var k=h("zaxis",c.traceCoordinate[2]);if(!b){if(x.indexOf("x")===-1)_=undefined;if(x.indexOf("y")===-1)w=undefined;if(x.indexOf("z")===-1)k=undefined;if(x.indexOf("text")===-1)c.textLabel=undefined;if(x.indexOf("name")===-1)s.name=undefined}var M;if(e.type==="cone"||e.type==="streamtube"){var A=[];if(b||x.indexOf("u")!==-1){A.push("u: "+h("xaxis",c.traceCoordinate[3]))}if(b||x.indexOf("v")!==-1){A.push("v: "+h("yaxis",c.traceCoordinate[4]))}if(b||x.indexOf("w")!==-1){A.push("w: "+h("zaxis",c.traceCoordinate[5]))}if(b||x.indexOf("norm")!==-1){A.push("norm: "+c.traceCoordinate[6].toPrecision(3))}if(e.type==="streamtube"&&(b||x.indexOf("divergence")!==-1)){A.push("divergence: "+c.traceCoordinate[7].toPrecision(3))}if(c.textLabel){A.push(c.textLabel)}M=A.join("<br>")}else{M=c.textLabel}if(t.fullSceneLayout.hovermode){u.loneHover({x:(.5+.5*v[0]/v[3])*a,y:(.5-.5*v[1]/v[3])*i,xLabel:_,yLabel:w,zLabel:k,text:M,name:s.name,color:u.castHoverOption(e,m,"bgcolor")||s.color,borderColor:u.castHoverOption(e,m,"bordercolor"),fontFamily:u.castHoverOption(e,m,"font.family"),fontSize:u.castHoverOption(e,m,"font.size"),fontColor:u.castHoverOption(e,m,"font.color")},{container:r,gd:t.graphDiv})}var T={x:c.traceCoordinate[0],y:c.traceCoordinate[1],z:c.traceCoordinate[2],data:e._input,fullData:e,curveNumber:e.index,pointNumber:m};if(e._module.eventData){T=e._module.eventData(T,c,e,{},m)}u.appendArrayPointValue(T,e,m);var S={points:[T]};if(c.buttons&&c.distance<5){t.graphDiv.emit("plotly_click",S)}else{t.graphDiv.emit("plotly_hover",S)}d=S}else{u.loneUnhover(r);t.graphDiv.emit("plotly_unhover",d)}t.drawAnnotations(t)}function b(t,e,r,o){var l={canvas:r,gl:o,container:t.container,axes:t.axesOptions,spikes:t.spikeOptions,pickRadius:10,snapToData:true,autoScale:true,autoBounds:false};if(t.staticMode){if(!y){m=document.createElement("canvas");y=a({canvas:m,preserveDrawingBuffer:true,premultipliedAlpha:true,antialias:true});if(!y){throw new Error("error creating static canvas/context for image server")}}l.pixelRatio=t.pixelRatio;l.gl=y;l.canvas=m}try{t.glplot=n(l)}catch(e){return f(t)}var u=function(t){if(t.fullSceneLayout.dragmode===false)return;var e={};e[t.id+".camera"]=T(t.camera);t.saveCamera(t.graphDiv.layout);t.graphDiv.emit("plotly_relayout",e)};t.glplot.canvas.addEventListener("mouseup",u.bind(null,t));t.glplot.canvas.addEventListener("wheel",u.bind(null,t),i?{passive:false}:false);if(!t.staticMode){t.glplot.canvas.addEventListener("webglcontextlost",function(t){s.warn("Lost WebGL context.");t.preventDefault()})}if(!t.camera){var c=t.fullSceneLayout.camera;t.camera=h(t.container,{center:[c.center.x,c.center.y,c.center.z],eye:[c.eye.x,c.eye.y,c.eye.z],up:[c.up.x,c.up.y,c.up.z],zoomMin:.1,zoomMax:100,mode:"orbit"})}t.glplot.camera=t.camera;t.glplot.oncontextloss=function(){t.recoverContext()};t.glplot.onrender=x.bind(null,t);t.traces={};return true}function _(t,e){var r=document.createElement("div");var n=t.container;this.graphDiv=t.graphDiv;var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.style.position="absolute";a.style.top=a.style.left="0px";a.style.width=a.style.height="100%";a.style["z-index"]=20;a.style["pointer-events"]="none";r.appendChild(a);this.svgContainer=a;r.id=t.id;r.style.position="absolute";r.style.top=r.style.left="0px";r.style.width=r.style.height="100%";n.appendChild(r);this.fullLayout=e;this.id=t.id||"scene";this.fullSceneLayout=e[this.id];this.plotArgs=[[],{},{}];this.axesOptions=d(e[this.id]);this.spikeOptions=v(e[this.id]);this.container=r;this.staticMode=!!t.staticPlot;this.pixelRatio=t.plotGlPixelRatio||2;this.dataScale=[1,1,1];this.contourLevels=[[],[],[]];this.convertAnnotations=o.getComponentMethod("annotations3d","convert");this.drawAnnotations=o.getComponentMethod("annotations3d","draw");if(!b(this,e))return}var w=_.prototype;w.recoverContext=function(){var t=this;var e=this.glplot.gl;var r=this.glplot.canvas;this.glplot.dispose();function n(){if(e.isContextLost()){requestAnimationFrame(n);return}if(!b(t,t.fullLayout,r,e)){s.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}t.plot.apply(t,t.plotArgs)}requestAnimationFrame(n)};var k=["xaxis","yaxis","zaxis"];function M(t,e,r){var n=t.fullSceneLayout;for(var a=0;a<3;a++){var i=k[a];var o=i.charAt(0);var l=n[i];var u=e[o];var c=e[o+"calendar"];var f=e["_"+o+"length"];if(!s.isArrayOrTypedArray(u)){r[0][a]=Math.min(r[0][a],0);r[1][a]=Math.max(r[1][a],f-1)}else{var h;for(var p=0;p<(f||u.length);p++){if(s.isArrayOrTypedArray(u[p])){for(var d=0;d<u[p].length;++d){h=l.d2l(u[p][d],0,c);if(!isNaN(h)&&isFinite(h)){r[0][a]=Math.min(r[0][a],h);r[1][a]=Math.max(r[1][a],h)}}}else{h=l.d2l(u[p],0,c);if(!isNaN(h)&&isFinite(h)){r[0][a]=Math.min(r[0][a],h);r[1][a]=Math.max(r[1][a],h)}}}}}}w.plot=function(t,e,r){this.plotArgs=[t,e,r];if(this.glplot.contextLost)return;var n,a;var i,o,s,l;var u=e[this.id];var f=r[this.id];if(u.bgcolor)this.glplot.clearColor=c(u.bgcolor);else this.glplot.clearColor=[0,0,0,0];this.glplot.snapToData=true;this.fullLayout=e;this.fullSceneLayout=u;this.glplotLayout=u;this.axesOptions.merge(u);this.spikeOptions.merge(u);this.setCamera(u.camera);this.updateFx(u.dragmode,u.hovermode);this.glplot.update({});this.setConvert(s);if(!t)t=[];else if(!Array.isArray(t))t=[t];var h=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(i=0;i<t.length;++i){n=t[i];if(n.visible!==true)continue;M(this,n,h)}var p=[1,1,1];for(o=0;o<3;++o){if(h[0][o]>h[1][o]){p[o]=1}else{if(h[1][o]===h[0][o]){p[o]=1}else{p[o]=1/(h[1][o]-h[0][o])}}}this.dataScale=p;this.convertAnnotations(this);for(i=0;i<t.length;++i){n=t[i];if(n.visible!==true){continue}a=this.traces[n.uid];if(a){if(a.data.type===n.type){a.update(n)}else{a.dispose();a=n._module.plot(this,n);this.traces[n.uid]=a}}else{a=n._module.plot(this,n);this.traces[n.uid]=a}a.name=n.name}var d=Object.keys(this.traces);t:for(i=0;i<d.length;++i){for(o=0;o<t.length;++o){if(t[o].uid===d[i]&&t[o].visible===true){continue t}}a=this.traces[d[i]];a.dispose();delete this.traces[d[i]]}this.glplot.objects.sort(function(t,e){return t._trace.data.index-e._trace.data.index});var v=[[0,0,0],[0,0,0]],g=[],m={};for(i=0;i<3;++i){s=u[k[i]];l=s.type;if(l in m){m[l].acc*=p[i];m[l].count+=1}else{m[l]={acc:p[i],count:1}}if(s.autorange){v[0][i]=Infinity;v[1][i]=-Infinity;var y=this.glplot.objects;var x=this.fullSceneLayout.annotations||[];var b=s._name.charAt(0);for(o=0;o<y.length;o++){var _=y[o];var w=_.bounds;var A=_._trace.data._pad||0;v[0][i]=Math.min(v[0][i],w[0][i]/p[i]-A);v[1][i]=Math.max(v[1][i],w[1][i]/p[i]+A)}for(o=0;o<x.length;o++){var T=x[o];if(T.visible){var S=s.r2l(T[b]);v[0][i]=Math.min(v[0][i],S);v[1][i]=Math.max(v[1][i],S)}}if("rangemode"in s&&s.rangemode==="tozero"){v[0][i]=Math.min(v[0][i],0);v[1][i]=Math.max(v[1][i],0)}if(v[0][i]>v[1][i]){v[0][i]=-1;v[1][i]=1}else{var E=v[1][i]-v[0][i];v[0][i]-=E/32;v[1][i]+=E/32}}else{var C=s.range;v[0][i]=s.r2l(C[0]);v[1][i]=s.r2l(C[1])}if(v[0][i]===v[1][i]){v[0][i]-=1;v[1][i]+=1}g[i]=v[1][i]-v[0][i];this.glplot.bounds[0][i]=v[0][i]*p[i];this.glplot.bounds[1][i]=v[1][i]*p[i]}var L=[1,1,1];for(i=0;i<3;++i){s=u[k[i]];l=s.type;var I=m[l];L[i]=Math.pow(I.acc,1/I.count)/p[i]}var z=4;var P;if(u.aspectmode==="auto"){if(Math.max.apply(null,L)/Math.min.apply(null,L)<=z){P=L}else{P=[1,1,1]}}else if(u.aspectmode==="cube"){P=[1,1,1]}else if(u.aspectmode==="data"){P=L}else if(u.aspectmode==="manual"){var O=u.aspectratio;P=[O.x,O.y,O.z]}else{throw new Error("scene.js aspectRatio was not one of the enumerated types")}u.aspectratio.x=f.aspectratio.x=P[0];u.aspectratio.y=f.aspectratio.y=P[1];u.aspectratio.z=f.aspectratio.z=P[2];this.glplot.aspect=P;var D=u.domain||null,R=e._size||null;if(D&&R){var B=this.container.style;B.position="absolute";B.left=R.l+D.x[0]*R.w+"px";B.top=R.t+(1-D.y[1])*R.h+"px";B.width=R.w*(D.x[1]-D.x[0])+"px";B.height=R.h*(D.y[1]-D.y[0])+"px"}this.glplot.redraw()};w.destroy=function(){if(!this.glplot)return;this.camera.mouseListener.enabled=false;this.container.removeEventListener("wheel",this.camera.wheelListener);this.camera=this.glplot.camera=null;this.glplot.dispose();this.container.parentNode.removeChild(this.container);this.glplot=null};function A(t){return[[t.eye.x,t.eye.y,t.eye.z],[t.center.x,t.center.y,t.center.z],[t.up.x,t.up.y,t.up.z]]}function T(t){return{up:{x:t.up[0],y:t.up[1],z:t.up[2]},center:{x:t.center[0],y:t.center[1],z:t.center[2]},eye:{x:t.eye[0],y:t.eye[1],z:t.eye[2]}}}w.getCamera=function t(){this.glplot.camera.view.recalcMatrix(this.camera.view.lastT());return T(this.glplot.camera)};w.setCamera=function t(e){this.glplot.camera.lookAt.apply(this,A(e))};w.saveCamera=function t(e){var r=this.getCamera(),n=s.nestedProperty(e,this.id+".camera"),a=n.get(),i=false;function o(t,e,r,n){var a=["up","center","eye"],i=["x","y","z"];return e[a[r]]&&t[a[r]][i[n]]===e[a[r]][i[n]]}if(a===undefined)i=true;else{for(var l=0;l<3;l++){for(var u=0;u<3;u++){if(!o(r,a,l,u)){i=true;break}}}}if(i)n.set(r);return i};w.updateFx=function(t,e){var r=this.camera;if(r){if(t==="orbit"){r.mode="orbit";r.keyBindingMode="rotate"}else if(t==="turntable"){r.up=[0,0,1];r.mode="turntable";r.keyBindingMode="rotate"}else{r.keyBindingMode=t}}this.fullSceneLayout.hovermode=e};w.toImage=function(t){if(!t)t="png";if(this.staticMode)this.container.appendChild(m);this.glplot.redraw();var e=this.glplot.gl;var r=e.drawingBufferWidth;var n=e.drawingBufferHeight;e.bindFramebuffer(e.FRAMEBUFFER,null);var a=new Uint8Array(r*n*4);e.readPixels(0,0,r,n,e.RGBA,e.UNSIGNED_BYTE,a);for(var i=0,o=n-1;i<o;++i,--o){for(var s=0;s<r;++s){for(var l=0;l<4;++l){var u=a[4*(r*i+s)+l];a[4*(r*i+s)+l]=a[4*(r*o+s)+l];a[4*(r*o+s)+l]=u}}}var c=document.createElement("canvas");c.width=r;c.height=n;var f=c.getContext("2d");var h=f.createImageData(r,n);h.data.set(a);f.putImageData(h,0,0);var p;switch(t){case"jpeg":p=c.toDataURL("image/jpeg");break;case"webp":p=c.toDataURL("image/webp");break;default:p=c.toDataURL("image/png")}if(this.staticMode)this.container.removeChild(m);return p};w.setConvert=function(){for(var t=0;t<3;t++){var e=this.fullSceneLayout[k[t]];l.setConvert(e,this.fullLayout);e.setScale=s.noop}};e.exports=_},{"../../components/fx":600,"../../lib":684,"../../lib/show_no_webgl_msg":705,"../../lib/str2rgbarray":707,"../../plots/cartesian/axes":732,"../../registry":817,"./camera":773,"./layout/convert":778,"./layout/spikes":781,"./layout/tick_marks":782,"./project":783,"gl-plot3d":277,"has-passive-events":379,"webgl-context":521}],785:[function(t,e,r){"use strict";e.exports=function t(e,r,n,a){a=a||e.length;var i=new Array(a);for(var o=0;o<a;o++){i[o]=[e[o],r[o],n[o]]}return i}},{}],786:[function(t,e,r){"use strict";var n=t("./font_attributes");var a=t("../components/color/attributes");var i=n({editType:"calc"});i.family.dflt='"Open Sans", verdana, arial, sans-serif';i.size.dflt=12;i.color.dflt=a.defaultLine;e.exports={font:i,title:{valType:"string",editType:"layoutstyle"},titlefont:n({editType:"layoutstyle"}),autosize:{valType:"boolean",dflt:false,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},paper_bgcolor:{valType:"color",dflt:a.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:a.background,editType:"layoutstyle"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:false,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:a.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},template:{valType:"any",editType:"calc"}}},{"../components/color/attributes":557,"./font_attributes":758}],787:[function(t,e,r){"use strict";var n="0.45.0";e.exports={requiredVersion:n,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",controlContainerClassName:"mapboxgl-control-container",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+n+"."].join("\n"),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.plot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join("\n"),mapOnErrorMsg:"Mapbox error.",styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none"}}},{}],788:[function(t,e,r){"use strict";var n=t("../../lib");e.exports=function t(e,r){var a=e.split(" "),i=a[0],o=a[1];var s=n.isArrayOrTypedArray(r)?n.mean(r):r,l=.5+s/100,u=1.5+s/100;var c=["",""],f=[0,0];switch(i){case"top":c[0]="top";f[1]=-u;break;case"bottom":c[0]="bottom";f[1]=u;break}switch(o){case"left":c[1]="right";f[0]=-l;break;case"right":c[1]="left";f[0]=l;break}var h;if(c[0]&&c[1])h=c.join("-");else if(c[0])h=c[0];else if(c[1])h=c[1];else h="center";return{anchor:h,offset:f}}},{"../../lib":684}],789:[function(t,e,r){"use strict";var n=t("mapbox-gl");var a=t("../../lib");var i=t("../../plots/get_data").getSubplotCalcData;var o=t("../../constants/xmlns_namespaces");var s=t("./mapbox");var l=t("./constants");var u="mapbox";for(var c in l.styleRules){a.addStyleRule(".mapboxgl-"+c,l.styleRules[c])}r.name=u;r.attr="subplot";r.idRoot=u;r.idRegex=r.attrRegex=a.counterRegex(u);r.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}};r.layoutAttributes=t("./layout_attributes");r.supplyLayoutDefaults=t("./layout_defaults");r.plot=function t(e){var r=e._fullLayout;var o=e.calcdata;var c=r._subplots[u];if(n.version!==l.requiredVersion){throw new Error(l.wrongVersionErrorMsg)}var h=f(e,c);n.accessToken=h;for(var p=0;p<c.length;p++){var d=c[p],v=i(o,u,d),g=r[d],m=g._subplot;if(!m){m=s({gd:e,container:r._glcontainer.node(),id:d,fullLayout:r,staticPlot:e._context.staticPlot});r[d]._subplot=m}if(!m.viewInitial){m.viewInitial={center:a.extendFlat({},g.center),zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}}m.plot(v,r,e._promises)}};r.clean=function(t,e,r,n){var a=n._subplots[u]||[];for(var i=0;i<a.length;i++){var o=a[i];if(!e[o]&&!!n[o]._subplot){n[o]._subplot.destroy()}}};r.toSVG=function(t){var e=t._fullLayout;var r=e._subplots[u];var n=e._size;for(var a=0;a<r.length;a++){var i=e[r[a]],s=i.domain,l=i._subplot;var c=l.toImage("png");var f=e._glimages.append("svg:image");f.attr({xmlns:o.svg,"xlink:href":c,x:n.l+n.w*s.x[0],y:n.t+n.h*(1-s.y[1]),width:n.w*(s.x[1]-s.x[0]),height:n.h*(s.y[1]-s.y[0]),preserveAspectRatio:"none"});l.destroy()}};function f(t,e){var r=t._fullLayout,n=t._context;if(n.mapboxAccessToken==="")return"";for(var a=0;a<e.length;a++){var i=r[e[a]];if(i.accesstoken){return i.accesstoken}}throw new Error(l.noAccessTokenErrorMsg)}r.updateFx=function(t){var e=t._subplots[u];for(var r=0;r<e.length;r++){var n=t[e[r]]._subplot;n.updateFx(t)}}},{"../../constants/xmlns_namespaces":663,"../../lib":684,"../../plots/get_data":768,"./constants":787,"./layout_attributes":791,"./layout_defaults":792,"./mapbox":793,"mapbox-gl":393}],790:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./convert_text_opts");function i(t,e){this.mapbox=t;this.map=t.map;this.uid=t.uid+"-"+"layer"+e;this.idSource=this.uid+"-source";this.idLayer=this.uid+"-layer";this.sourceType=null;this.source=null;this.layerType=null;this.below=null;this.visible=false}var o=i.prototype;o.update=function t(e){if(!this.visible){this.updateSource(e);this.updateLayer(e)}else if(this.needsNewSource(e)){this.removeLayer();this.updateSource(e);this.updateLayer(e)}else if(this.needsNewLayer(e)){this.updateLayer(e)}else{this.updateStyle(e)}this.visible=s(e)};o.needsNewSource=function(t){return this.sourceType!==t.sourcetype||this.source!==t.source||this.layerType!==t.type};o.needsNewLayer=function(t){return this.layerType!==t.type||this.below!==t.below};o.updateSource=function(t){var e=this.map;if(e.getSource(this.idSource))e.removeSource(this.idSource);this.sourceType=t.sourcetype;this.source=t.source;if(!s(t))return;var r=u(t);e.addSource(this.idSource,r)};o.updateLayer=function(t){var e=this.map;var r=l(t);this.removeLayer();this.layerType=t.type;if(s(t)){e.addLayer({id:this.idLayer,source:this.idSource,"source-layer":t.sourcelayer||"",type:t.type,layout:r.layout,paint:r.paint},t.below)}};o.updateStyle=function(t){if(s(t)){var e=l(t);this.mapbox.setOptions(this.idLayer,"setLayoutProperty",e.layout);this.mapbox.setOptions(this.idLayer,"setPaintProperty",e.paint)}};o.removeLayer=function(){var t=this.map;if(t.getLayer(this.idLayer)){t.removeLayer(this.idLayer)}};o.dispose=function t(){var e=this.map;e.removeLayer(this.idLayer);e.removeSource(this.idSource)};function s(t){var e=t.source;return t.visible&&(n.isPlainObject(e)||typeof e==="string"&&e.length>0)}function l(t){var e={},r={};switch(t.type){case"circle":n.extendFlat(r,{"circle-radius":t.circle.radius,"circle-color":t.color,"circle-opacity":t.opacity});break;case"line":n.extendFlat(r,{"line-width":t.line.width,"line-color":t.color,"line-opacity":t.opacity});break;case"fill":n.extendFlat(r,{"fill-color":t.color,"fill-outline-color":t.fill.outlinecolor,"fill-opacity":t.opacity});break;case"symbol":var i=t.symbol,o=a(i.textposition,i.iconsize);n.extendFlat(e,{"icon-image":i.icon+"-15","icon-size":i.iconsize/10,"text-field":i.text,"text-size":i.textfont.size,"text-anchor":o.anchor,"text-offset":o.offset});n.extendFlat(r,{"icon-color":t.color,"text-color":i.textfont.color,"text-opacity":t.opacity});break}return{layout:e,paint:r}}function u(t){var e=t.sourcetype;var r=t.source;var n={type:e};var a;if(e==="geojson"){a="data"}else if(e==="vector"){a=typeof r==="string"?"url":"tiles"}n[a]=r;return n}e.exports=function t(e,r,n){var a=new i(e,r);a.update(n);return a}},{"../../lib":684,"./convert_text_opts":788}],791:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../components/color").defaultLine;var i=t("../domain").attributes;var o=t("../font_attributes");var s=t("../../traces/scatter/attributes").textposition;var l=t("../../plot_api/edit_types").overrideAll;var u=t("../../plot_api/plot_template").templatedArray;var c=o({});c.family.dflt="Open Sans Regular, Arial Unicode MS Regular";e.exports=l({_arrayAttrRegexps:[n.counterRegex("mapbox",".layers",true)],domain:i({name:"mapbox"}),accesstoken:{valType:"string",noBlank:true,strict:true},style:{valType:"any",values:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],dflt:"basic"},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:u("layer",{visible:{valType:"boolean",dflt:true},sourcetype:{valType:"enumerated",values:["geojson","vector"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},type:{valType:"enumerated",values:["circle","line","fill","symbol"],dflt:"circle"},below:{valType:"string",dflt:""},color:{valType:"color",dflt:a},opacity:{valType:"number",min:0,max:1,dflt:1},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2}},fill:{outlinecolor:{valType:"color",dflt:a}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},textfont:c,textposition:n.extendFlat({},s,{arrayOk:false})}})},"plot","from-root")},{"../../components/color":558,"../../lib":684,"../../plot_api/edit_types":715,"../../plot_api/plot_template":722,"../../traces/scatter/attributes":1015,"../domain":757,"../font_attributes":758}],792:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../subplot_defaults");var i=t("../array_container_defaults");var o=t("./layout_attributes");e.exports=function t(e,r,n){a(e,r,n,{type:"mapbox",attributes:o,handleDefaults:s,partition:"y",accessToken:r._mapboxAccessToken})};function s(t,e,r,n){r("accesstoken",n.accessToken);r("style");r("center.lon");r("center.lat");r("zoom");r("bearing");r("pitch");i(t,e,{name:"layers",handleItemDefaults:l});e._input=t}function l(t,e){function r(r,a){return n.coerce(t,e,o.layers,r,a)}var a=r("visible");if(a){var i=r("sourcetype");r("source");if(i==="vector")r("sourcelayer");var s=r("type");r("below");r("color");r("opacity");if(s==="circle"){r("circle.radius")}if(s==="line"){r("line.width")}if(s==="fill"){r("fill.outlinecolor")}if(s==="symbol"){r("symbol.icon");r("symbol.iconsize");r("symbol.text");n.coerceFont(r,"symbol.textfont");r("symbol.textposition")}}}},{"../../lib":684,"../array_container_defaults":728,"../subplot_defaults":809,"./layout_attributes":791}],793:[function(t,e,r){"use strict";var n=t("mapbox-gl");var a=t("../../components/fx");var i=t("../../lib");var o=t("../../components/dragelement");var s=t("../cartesian/select").prepSelect;var l=t("./constants");var u=t("./layout_attributes");var c=t("./layers");function f(t){this.id=t.id;this.gd=t.gd;this.container=t.container;this.isStatic=t.staticPlot;var e=t.fullLayout;this.uid=e._uid+"-"+this.id;this.opts=e[this.id];this.div=null;this.xaxis=null;this.yaxis=null;this.createFramework(e);this.map=null;this.accessToken=null;this.styleObj=null;this.traceHash={};this.layerList=[]}var h=f.prototype;e.exports=function t(e){return new f(e)};h.plot=function(t,e,r){var n=this;var a=n.opts=e[this.id];if(n.map&&a.accesstoken!==n.accessToken){n.map.remove();n.map=null;n.styleObj=null;n.traceHash=[];n.layerList={}}var i;if(!n.map){i=new Promise(function(r,a){n.createMap(t,e,r,a)})}else{i=new Promise(function(r,a){n.updateMap(t,e,r,a)})}r.push(i)};h.createMap=function(t,e,r,i){var o=this;var s=o.gd;var u=o.opts;var c=o.styleObj=p(u.style);o.accessToken=u.accesstoken;var f=o.map=new n.Map({container:o.div,style:c.style,center:v(u.center),zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,interactive:!o.isStatic,preserveDrawingBuffer:o.isStatic,doubleClickZoom:false,boxZoom:false});var h=l.controlContainerClassName;var d=o.div.getElementsByClassName(h)[0];o.div.removeChild(d);f._canvas.style.left="0px";f._canvas.style.top="0px";o.rejectOnError(i);f.once("load",function(){o.updateData(t);o.updateLayout(e);o.resolveOnRender(r)});if(o.isStatic)return;var g=false;f.on("moveend",function(t){if(!o.map)return;var e=o.getView();u._input.center=u.center=e.center;u._input.zoom=u.zoom=e.zoom;u._input.bearing=u.bearing=e.bearing;u._input.pitch=u.pitch=e.pitch;if(t.originalEvent||g){y(e)}g=false});f.on("wheel",function(){g=true});f.on("mousemove",function(t){var e=o.div.getBoundingClientRect();t.clientX=t.point.x+e.left;t.clientY=t.point.y+e.top;t.target.getBoundingClientRect=function(){return e};o.xaxis.p2c=function(){return t.lngLat.lng};o.yaxis.p2c=function(){return t.lngLat.lat};a.hover(s,t,o.id)});f.on("click",function(t){a.click(s,t.originalEvent)});function m(){a.loneUnhover(e._toppaper)}f.on("dragstart",m);f.on("zoomstart",m);f.on("dblclick",function(){s.emit("plotly_doubleclick",null);var t=o.viewInitial;f.setCenter(v(t.center));f.setZoom(t.zoom);f.setBearing(t.bearing);f.setPitch(t.pitch);var e=o.getView();u._input.center=u.center=e.center;u._input.zoom=u.zoom=e.zoom;u._input.bearing=u.bearing=e.bearing;u._input.pitch=u.pitch=e.pitch;y(e)});function y(t){var e=o.id;var r={};for(var n in t){r[e+"."+n]=t[n]}s.emit("plotly_relayout",r)}o.clearSelect=function(){s._fullLayout._zoomlayer.selectAll(".select-outline").remove()}};h.updateMap=function(t,e,r,n){var a=this;var i=a.map;a.rejectOnError(n);var o=p(a.opts.style);if(a.styleObj.id!==o.id){a.styleObj=o;i.setStyle(o.style);i.once("styledata",function(){a.traceHash={};a.updateData(t);a.updateLayout(e);a.resolveOnRender(r)})}else{a.updateData(t);a.updateLayout(e);a.resolveOnRender(r)}};h.updateData=function(t){var e=this.traceHash;var r,n,a,i;for(a=0;a<t.length;a++){var o=t[a];n=o[0].trace;r=e[n.uid];if(r){r.update(o)}else if(n._module){e[n.uid]=n._module.plot(this,o)}}var s=Object.keys(e);t:for(a=0;a<s.length;a++){var l=s[a];for(i=0;i<t.length;i++){n=t[i][0].trace;if(l===n.uid)continue t}r=e[l];r.dispose();delete e[l]}};h.updateLayout=function(t){var e=this.map,r=this.opts;e.setCenter(v(r.center));e.setZoom(r.zoom);e.setBearing(r.bearing);e.setPitch(r.pitch);this.updateLayers();this.updateFramework(t);this.updateFx(t);this.map.resize()};h.resolveOnRender=function(t){var e=this.map;e.on("render",function r(){if(e.loaded()){e.off("render",r);setTimeout(t,0)}})};h.rejectOnError=function(t){var e=this.map;function r(){t(new Error(l.mapOnErrorMsg))}e.once("error",r);e.once("style.error",r);e.once("source.error",r);e.once("tile.error",r);e.once("layer.error",r)};h.createFramework=function(t){var e=this;var r=e.div=document.createElement("div");r.id=e.uid;r.style.position="absolute";e.container.appendChild(r);e.xaxis={_id:"x",c2p:function(t){return e.project(t).x}};e.yaxis={_id:"y",c2p:function(t){return e.project(t).y}};e.updateFramework(t)};h.updateFx=function(t){var e=this;var r=e.map;var n=e.gd;if(e.isStatic)return;function a(t){var r=e.map.unproject(t);return[r.lng,r.lat]}var i=t.dragmode;var l;if(i==="select"){l=function(t,r){var n=t.range={};n[e.id]=[a([r.xmin,r.ymin]),a([r.xmax,r.ymax])]}}else{l=function(t,r,n){var i=t.lassoPoints={};i[e.id]=n.filtered.map(a)}}if(i==="select"||i==="lasso"){r.dragPan.disable();r.on("zoomstart",e.clearSelect);var u={element:e.div,gd:n,plotinfo:{xaxis:e.xaxis,yaxis:e.yaxis,fillRangeItems:l},xaxes:[e.xaxis],yaxes:[e.yaxis],subplot:e.id};u.prepFn=function(t,e,r){s(t,e,r,u,i)};o.init(u)}else{r.dragPan.enable();r.off("zoomstart",e.clearSelect);e.div.onmousedown=null}};h.updateFramework=function(t){var e=t[this.id].domain;var r=t._size;var n=this.div.style;n.width=r.w*(e.x[1]-e.x[0])+"px";n.height=r.h*(e.y[1]-e.y[0])+"px";n.left=r.l+e.x[0]*r.w+"px";n.top=r.t+(1-e.y[1])*r.h+"px";this.xaxis._offset=r.l+e.x[0]*r.w;this.xaxis._length=r.w*(e.x[1]-e.x[0]);this.yaxis._offset=r.t+(1-e.y[1])*r.h;this.yaxis._length=r.h*(e.y[1]-e.y[0])};h.updateLayers=function(){var t=this.opts;var e=t.layers;var r=this.layerList;var n;if(e.length!==r.length){for(n=0;n<r.length;n++){r[n].dispose()}r=this.layerList=[];for(n=0;n<e.length;n++){r.push(c(this,n,e[n]))}}else{for(n=0;n<e.length;n++){r[n].update(e[n])}}};h.destroy=function(){if(this.map){this.map.remove();this.map=null;this.container.removeChild(this.div)}};h.toImage=function(){this.map.stop();return this.map.getCanvas().toDataURL()};h.setOptions=function(t,e,r){for(var n in r){this.map[e](t,n,r[n])}};h.project=function(t){return this.map.project(new n.LngLat(t[0],t[1]))};h.getView=function(){var t=this.map;var e=t.getCenter();var r={lon:e.lng,lat:e.lat};return{center:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch()}};function p(t){var e=u.style.values;var r=u.style.dflt;var n={};if(i.isPlainObject(t)){n.id=t.id;n.style=t}else if(typeof t==="string"){n.id=t;n.style=e.indexOf(t)!==-1?d(t):t}else{n.id=r;n.style=d(r)}n.transition={duration:0,delay:0};return n}function d(t){return l.styleUrlPrefix+t+"-"+l.styleUrlSuffix}function v(t){return[t.lon,t.lat]}},{"../../components/dragelement":580,"../../components/fx":600,"../../lib":684,"../cartesian/select":749,"./constants":787,"./layers":790,"./layout_attributes":791,"mapbox-gl":393}],794:[function(t,e,r){"use strict";e.exports={t:{valType:"number",dflt:0,editType:"arraydraw"},r:{valType:"number",dflt:0,editType:"arraydraw"},b:{valType:"number",dflt:0,editType:"arraydraw"},l:{valType:"number",dflt:0,editType:"arraydraw"},editType:"arraydraw"}},{}],795:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("../registry");var o=t("../plot_api/plot_schema");var s=t("../plot_api/plot_template");var l=t("../lib");var u=t("../components/color");var c=t("../constants/numerical").BADNUM;var f=t("../plots/cartesian/axis_ids");var h=t("./sort_modules").sortBasePlotModules;var p=t("./animation_attributes");var d=t("./frame_attributes");var v=l.relinkPrivateKeys;var g=l._;var m=e.exports={};l.extendFlat(m,i);m.attributes=t("./attributes");m.attributes.type.values=m.allTypes;m.fontAttrs=t("./font_attributes");m.layoutAttributes=t("./layout_attributes");m.fontWeight="normal";var y=m.transformsRegistry;var x=t("./command");m.executeAPICommand=x.executeAPICommand;m.computeAPICommandBindings=x.computeAPICommandBindings;m.manageCommandObserver=x.manageCommandObserver;m.hasSimpleAPICommandBindings=x.hasSimpleAPICommandBindings;m.redrawText=function(t){t=l.getGraphDiv(t);if(t.data&&t.data[0]&&t.data[0].r)return;return new Promise(function(e){setTimeout(function(){i.getComponentMethod("annotations","draw")(t);i.getComponentMethod("legend","draw")(t);(t.calcdata||[]).forEach(function(t){if(t[0]&&t[0].t&&t[0].t.cb)t[0].t.cb()});e(m.previousPromises(t))},300)})};m.resize=function(t){t=l.getGraphDiv(t);return new Promise(function(e,r){function n(t){var e=window.getComputedStyle(t).display;return!e||e==="none"}if(!t||n(t)){r(new Error("Resize must be passed a displayed plot div element."))}if(t._redrawTimer)clearTimeout(t._redrawTimer);t._redrawTimer=setTimeout(function(){if(!t.layout||t.layout.width&&t.layout.height||n(t)){e(t);return}delete t.layout.width;delete t.layout.height;var r=t.changed;t.autoplay=true;i.call("relayout",t,{autosize:true}).then(function(){t.changed=r;e(t)})},100)})};m.previousPromises=function(t){if((t._promises||[]).length){return Promise.all(t._promises).then(function(){t._promises=[]})}};m.addLinks=function(t){if(!t._context.showLink&&!t._context.showSources)return;var e=t._fullLayout;var r=l.ensureSingle(e._paper,"text","js-plot-link-container",function(t){t.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:u.defaultLine,"pointer-events":"all"}).each(function(){var t=n.select(this);t.append("tspan").classed("js-link-to-tool",true);t.append("tspan").classed("js-link-spacer",true);t.append("tspan").classed("js-sourcelinks",true)})});var a=r.node();var i={y:e._paper.attr("height")-9};if(document.body.contains(a)&&a.getComputedTextLength()>=e.width-20){i["text-anchor"]="start";i.x=5}else{i["text-anchor"]="end";i.x=e._paper.attr("width")-7}r.attr(i);var o=r.select(".js-link-to-tool"),s=r.select(".js-link-spacer"),c=r.select(".js-sourcelinks");if(t._context.showSources)t._context.showSources(t);if(t._context.showLink)b(t,o);s.text(o.text()&&c.text()?" - ":"")};function b(t,e){e.text("");var r=e.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(t._context.linkText+" "+String.fromCharCode(187));if(t._context.sendData){r.on("click",function(){m.sendDataToCloud(t)})}else{var n=window.location.pathname.split("/");var a=window.location.search;r.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+n[2].split(".")[0]+"/"+n[1]+a})}}m.sendDataToCloud=function(t){t.emit("plotly_beforeexport");var e=(window.PLOTLYENV||{}).BASE_URL||t._context.plotlyServerURL;var r=n.select(t).append("div").attr("id","hiddenform").style("display","none");var a=r.append("form").attr({action:e+"/external",method:"post",target:"_blank"});var i=a.append("input").attr({type:"text",name:"data"});i.node().value=m.graphJson(t,false,"keepdata");a.node().submit();r.remove();t.emit("plotly_afterexport");return false};var _=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"];var w=["year","month","dayMonth","dayMonthYear"];m.supplyDefaults=function(t,e){var r=e&&e.skipUpdateCalc;var n=t._fullLayout||{};if(n._skipDefaults){delete n._skipDefaults;return}var a=t._fullLayout={};var o=t.layout||{};var s=t._fullData||[];var u=t._fullData=[];var c=t.data||[];var p=t.calcdata||[];var d=t._context||{};var y;if(!t._transitionData)m.createTransitionData(t);a._dfltTitle={plot:g(t,"Click to enter Plot title"),x:g(t,"Click to enter X axis title"),y:g(t,"Click to enter Y axis title"),colorbar:g(t,"Click to enter Colorscale title"),annotation:g(t,"new text")};a._traceWord=g(t,"trace");var x=T(t,_);a._mapboxAccessToken=d.mapboxAccessToken;if(n._initialAutoSizeIsDone){var b=n.width,M=n.height;m.supplyLayoutGlobalDefaults(o,a,x);if(!o.width)a.width=b;if(!o.height)a.height=M;m.sanitizeMargins(a)}else{m.supplyLayoutGlobalDefaults(o,a,x);var E=!o.width||!o.height,C=a.autosize,L=d.autosizable,I=E&&(C||L);if(I)m.plotAutoSize(t,o,a);else if(E)m.sanitizeMargins(a);if(!C&&E){o.width=a.width;o.height=a.height}}a._d3locale=S(x,a.separators);a._extraFormat=T(t,w);a._initialAutoSizeIsDone=true;a._dataLength=c.length;a._modules=[];a._basePlotModules=[];var z=a._subplots=A();var P=a._splomAxes={x:{},y:{}};var O=a._splomSubplots={};a._splomGridDflt={};a._requestRangeslider={};a._traceUids=k(s,c);a._globalTransforms=(t._context||{}).globalTransforms;m.supplyDataDefaults(c,u,o,a);var D=Object.keys(P.x);var R=Object.keys(P.y);if(D.length>1&&R.length>1){i.getComponentMethod("grid","sizeDefaults")(o,a);for(y=0;y<D.length;y++){l.pushUnique(z.xaxis,D[y])}for(y=0;y<R.length;y++){l.pushUnique(z.yaxis,R[y])}for(var B in O){l.pushUnique(z.cartesian,B)}}a._has=m._hasPlotType.bind(a);var F=a._modules;for(y=0;y<F.length;y++){var N=F[y];if(N.cleanData)N.cleanData(u)}if(s.length===u.length){for(y=0;y<u.length;y++){v(u[y],s[y])}}m.supplyLayoutModuleDefaults(o,a,u,t._transitionData);a._hasOnlyLargeSploms=a._basePlotModules.length===1&&a._basePlotModules[0].name==="splom"&&D.length>15&&R.length>15&&a.shapes.length===0&&a.images.length===0;a._hasCartesian=a._has("cartesian");a._hasGeo=a._has("geo");a._hasGL3D=a._has("gl3d");a._hasGL2D=a._has("gl2d");a._hasTernary=a._has("ternary");a._hasPie=a._has("pie");m.linkSubplots(u,a,s,n);m.cleanPlot(u,a,s,n,p);v(a,n);m.doAutoMargin(t);var j=f.list(t);for(y=0;y<j.length;y++){var V=j[y];V.setScale()}if(!r&&p.length===u.length){m.supplyDefaultsUpdateCalc(p,u)}a._basePlotModules.sort(h)};m.supplyDefaultsUpdateCalc=function(t,e){for(var r=0;r<e.length;r++){var n=e[r];var a=t[r][0];if(a&&a.trace){var i=a.trace;if(i._hasCalcTransform){var o=i._arrayAttrs;var s,u,c;for(s=0;s<o.length;s++){u=o[s];c=l.nestedProperty(i,u).get().slice();l.nestedProperty(n,u).set(c)}}a.trace=n}}};function k(t,e){var r=e.length;var n=[];var a,i;for(a=0;a<t.length;a++){var o=t[a]._fullInput;if(o!==i)n.push(o);i=o}var s=n.length;var u=new Array(r);var c={};function f(t,e){u[e]=t;c[t]=1}function h(t,e){if(t&&typeof t==="string"&&!c[t]){f(t,e);return true}}for(a=0;a<r;a++){if(h(e[a].uid,a))continue;if(a<s&&h(n[a].uid,a))continue;f(l.randstr(c),a)}return u}var M;function A(){var t={};var e,r;if(!M){M=[];var n=i.subplotsRegistry;for(var a in n){var o=n[a];var s=o.attr;if(s){M.push(a);if(Array.isArray(s)){for(r=0;r<s.length;r++){l.pushUnique(M,s[r])}}}}}for(e=0;e<M.length;e++){t[M[e]]=[]}return t}function T(t,e){var r=t._context.locale;if(!r)r==="en-US";var n=false;var a={};function o(t){var r=true;for(var i=0;i<e.length;i++){var o=e[i];if(!a[o]){if(t[o]){a[o]=t[o]}else r=false}}if(r)n=true}for(var s=0;s<2;s++){var l=t._context.locales;for(var u=0;u<2;u++){var c=(l[r]||{}).format;if(c){o(c);if(n)break}l=i.localeRegistry}var f=r.split("-")[0];if(n||f===r)break;r=f}if(!n)o(i.localeRegistry.en.format);return a}function S(t,e){t.decimal=e.charAt(0);t.thousands=e.charAt(1);return n.locale(t)}m.createTransitionData=function(t){if(!t._transitionData){t._transitionData={}}if(!t._transitionData._frames){t._transitionData._frames=[]}if(!t._transitionData._frameHash){t._transitionData._frameHash={}}if(!t._transitionData._counter){t._transitionData._counter=0}if(!t._transitionData._interruptCallbacks){t._transitionData._interruptCallbacks=[]}};m._hasPlotType=function(t){var e;var r=this._basePlotModules||[];for(e=0;e<r.length;e++){if(r[e].name===t)return true}var n=this._modules||[];for(e=0;e<n.length;e++){var a=n[e].name;if(a===t)return true;var o=i.modules[a];if(o&&o.categories[t])return true}return false};m.cleanPlot=function(t,e,r,n,a){var i,o;var s=n._basePlotModules||[];for(i=0;i<s.length;i++){var l=s[i];if(l.clean){l.clean(t,e,r,n,a)}}var u=n._has&&n._has("gl");var c=e._has&&e._has("gl");if(u&&!c){if(n._glcontainer!==undefined){n._glcontainer.selectAll(".gl-canvas").remove();n._glcontainer.selectAll(".no-webgl").remove();n._glcanvas=null}}var f=!!n._infolayer;t:for(i=0;i<r.length;i++){var h=r[i],p=h.uid;for(o=0;o<t.length;o++){var d=t[o];if(p===d.uid)continue t}if(f){n._infolayer.select(".cb"+p).remove()}}if(n._zoomlayer){n._zoomlayer.selectAll(".select-outline").remove()}};m.linkSubplots=function(t,e,r,n){var a=n._plots||{};var i=e._plots={};var o=e._subplots;var s={_fullData:t,_fullLayout:e};var l=o.cartesian.concat(o.gl2d||[]);var u,c,h,p;for(u=0;u<l.length;u++){h=l[u];var d=a[h];var v=f.getFromId(s,h,"x");var g=f.getFromId(s,h,"y");var m;if(d){m=i[h]=d;if(m.xaxis.layer!==v.layer){m.xlines.attr("d",null);m.xaxislayer.selectAll("*").remove()}if(m.yaxis.layer!==g.layer){m.ylines.attr("d",null);m.yaxislayer.selectAll("*").remove()}}else{m=i[h]={};m.id=h}m.xaxis=v;m.yaxis=g;m._hasClipOnAxisFalse=false;for(c=0;c<t.length;c++){var y=t[c];if(y.xaxis===m.xaxis._id&&y.yaxis===m.yaxis._id&&y.cliponaxis===false){m._hasClipOnAxisFalse=true;break}}}var x=f.list(s,null,true);for(u=0;u<x.length;u++){p=x[u];var b=null;if(p.overlaying){b=f.getFromId(s,p.overlaying);if(b&&b.overlaying){p.overlaying=false;b=null}}p._mainAxis=b||p;if(b)p.domain=b.domain.slice();p._anchorAxis=p.anchor==="free"?null:f.getFromId(s,p.anchor)}};m.clearExpandedTraceDefaultColors=function(t){var e,r,n;function a(t,n,a,i){r[i]=n;r.length=i+1;if(t.valType==="color"&&t.dflt===undefined){e.push(r.join("."))}}r=[];e=t._module._colorAttrs;if(!e){t._module._colorAttrs=e=[];o.crawl(t._module.attributes,a)}for(n=0;n<e.length;n++){var i=l.nestedProperty(t,"_input."+e[n]);if(!i.get()){l.nestedProperty(t,e[n]).set(null)}}};m.supplyDataDefaults=function(t,e,r,n){var a=n._modules;var o=n._basePlotModules;var u=0;var c=0;var f,h,p;n._transformModules=[];function d(t){e.push(t);var r=t._module;if(!r)return;if(t.visible===true)l.pushUnique(a,r);l.pushUnique(o,t._module.basePlotModule);u++;if(t._input.visible!==false)c++}var g={};var y=[];var x=(r.template||{}).data||{};var b=s.traceTemplater(x);for(f=0;f<t.length;f++){p=t[f];h=b.newTrace(p);h.uid=n._traceUids[f];m.supplyTraceDefaults(p,h,c,n,f);h.uid=n._traceUids[f];h.index=f;h._input=p;h._expandedIndex=u;if(h.transforms&&h.transforms.length){var _=C(h,e,r,n);for(var w=0;w<_.length;w++){var k=_[w];var M={_template:h._template,type:h.type,uid:h.uid+w};m.supplyTraceDefaults(k,M,u,n,f);v(M,k);M.index=f;M._input=p;M._fullInput=h;M._expandedIndex=u;M._expandedInput=k;d(M)}}else{h._fullInput=h;h._expandedInput=h;d(h)}if(i.traceIs(h,"carpetAxis")){g[h.carpet]=h}if(i.traceIs(h,"carpetDependent")){y.push(f)}}for(f=0;f<y.length;f++){h=e[y[f]];if(!h.visible)continue;var A=g[h.carpet];h._carpet=A;if(!A||!A.visible){h.visible=false;continue}h.xaxis=A.xaxis;h.yaxis=A.yaxis}};m.supplyAnimationDefaults=function(t){t=t||{};var e;var r={};function n(e,n){return l.coerce(t||{},r,p,e,n)}n("mode");n("direction");n("fromcurrent");if(Array.isArray(t.frame)){r.frame=[];for(e=0;e<t.frame.length;e++){r.frame[e]=m.supplyAnimationFrameDefaults(t.frame[e]||{})}}else{r.frame=m.supplyAnimationFrameDefaults(t.frame||{})}if(Array.isArray(t.transition)){r.transition=[];for(e=0;e<t.transition.length;e++){r.transition[e]=m.supplyAnimationTransitionDefaults(t.transition[e]||{})}}else{r.transition=m.supplyAnimationTransitionDefaults(t.transition||{})}return r};m.supplyAnimationFrameDefaults=function(t){var e={};function r(r,n){return l.coerce(t||{},e,p.frame,r,n)}r("duration");r("redraw");return e};m.supplyAnimationTransitionDefaults=function(t){var e={};function r(r,n){return l.coerce(t||{},e,p.transition,r,n)}r("duration");r("easing");return e};m.supplyFrameDefaults=function(t){var e={};function r(r,n){return l.coerce(t,e,d,r,n)}r("group");r("name");r("traces");r("baseframe");r("data");r("layout");return e};m.supplyTraceDefaults=function(t,e,r,n,a){var o=n.colorway||u.defaults;var s=o[r%o.length];var c;function f(r,n){return l.coerce(t,e,m.attributes,r,n)}var h=f("visible");f("type");f("name",n._traceWord+" "+a);var p=m.getModule(e);e._module=p;if(p){var d=p.basePlotModule;var v=d.attr;var g=d.attributes;if(v&&g){var y=n._subplots;var x="";if(d.name!=="gl2d"||h){if(Array.isArray(v)){for(c=0;c<v.length;c++){var b=v[c];var _=l.coerce(t,e,g,b);if(y[b])l.pushUnique(y[b],_);x+=_}}else{x=l.coerce(t,e,g,v)}if(y[d.name]){l.pushUnique(y[d.name],x)}}}}if(h){f("customdata");f("ids");if(i.traceIs(e,"showLegend")){f("showlegend");f("legendgroup")}i.getComponentMethod("fx","supplyDefaults")(t,e,s,n);if(p){p.supplyDefaults(t,e,s,n);l.coerceHoverinfo(t,e,n)}if(!i.traceIs(e,"noOpacity"))f("opacity");if(i.traceIs(e,"notLegendIsolatable")){e.visible=!!e.visible}if(p&&p.selectPoints){f("selectedpoints")}m.supplyTransformDefaults(t,e,n)}return e};function E(t){var e=t.transforms;if(Array.isArray(e)&&e.length){for(var r=0;r<e.length;r++){var n=y[e[r].type];if(n&&n.makesData)return true}}return false}m.supplyTransformDefaults=function(t,e,r){if(!(e._length||E(t)))return;var n=r._globalTransforms||[];var a=r._transformModules||[];if(!Array.isArray(t.transforms)&&n.length===0)return;var i=t.transforms||[],o=n.concat(i),s=e.transforms=[];for(var u=0;u<o.length;u++){var c=o[u],f=c.type,h=y[f],p;var d=!(c._module&&c._module===h),v=h&&typeof h.transform==="function";if(!h)l.warn("Unrecognized transform type "+f+".");if(h&&h.supplyDefaults&&(d||v)){p=h.supplyDefaults(c,e,r,t);p.type=f;p._module=h;l.pushUnique(a,h)}else{p=l.extendFlat({},c)}s.push(p)}};function C(t,e,r,n){var a=t.transforms,i=[t];for(var o=0;o<a.length;o++){var s=a[o],l=y[s.type];if(l&&l.transform){i=l.transform(i,{transform:s,fullTrace:t,fullData:e,layout:r,fullLayout:n,transformIndex:o})}}return i}m.supplyLayoutGlobalDefaults=function(t,e,r){function n(r,n){return l.coerce(t,e,m.layoutAttributes,r,n)}var a=t.template;if(l.isPlainObject(a)){e.template=a;e._template=a.layout;e._dataTemplate=a.data}var o=l.coerceFont(n,"font");n("title",e._dfltTitle.plot);l.coerceFont(n,"titlefont",{family:o.family,size:Math.round(o.size*1.4),color:o.color});n("autosize",!(t.width&&t.height));n("width");n("height");n("margin.l");n("margin.r");n("margin.t");n("margin.b");n("margin.pad");n("margin.autoexpand");if(t.width&&t.height)m.sanitizeMargins(e);i.getComponentMethod("grid","sizeDefaults")(t,e);n("paper_bgcolor");n("separators",r.decimal+r.thousands);n("hidesources");n("colorway");n("datarevision");i.getComponentMethod("calendars","handleDefaults")(t,e,"calendar");i.getComponentMethod("fx","supplyLayoutGlobalDefaults")(t,e,n)};m.plotAutoSize=function t(e,r,n){var i=e._context||{},o=i.frameMargins,s,u;var c=l.isPlotDiv(e);if(c)e.emit("plotly_autosize");if(i.fillFrame){s=window.innerWidth;u=window.innerHeight;document.body.style.overflow="hidden"}else if(a(o)&&o>0){var f=L(e._boundingBoxMargins),h=f.left+f.right,p=f.bottom+f.top,d=1-2*o;var v=n._container&&n._container.node?n._container.node().getBoundingClientRect():{width:n.width,height:n.height};s=Math.round(d*(v.width-h));u=Math.round(d*(v.height-p))}else{var g=c?window.getComputedStyle(e):{};s=parseFloat(g.width)||n.width;u=parseFloat(g.height)||n.height}var y=m.layoutAttributes.width.min,x=m.layoutAttributes.height.min;if(s<y)s=y;if(u<x)u=x;var b=!r.width&&Math.abs(n.width-s)>1,_=!r.height&&Math.abs(n.height-u)>1;if(_||b){if(b)n.width=s;if(_)n.height=u}if(!e._initialAutoSize){e._initialAutoSize={width:s,height:u}}m.sanitizeMargins(n)};function L(t){var e={left:0,right:0,bottom:0,top:0},r;if(t){for(r in t){if(t.hasOwnProperty(r)){e.left+=t[r].left||0;e.right+=t[r].right||0;e.bottom+=t[r].bottom||0;e.top+=t[r].top||0}}}return e}m.supplyLayoutModuleDefaults=function(t,e,r,n){var a=i.componentsRegistry;var o=e._basePlotModules;var s,u,c;var f=i.subplotsRegistry.cartesian;for(s in a){c=a[s];if(c.includeBasePlot){c.includeBasePlot(t,e)}}if(!o.length){o.push(f)}if(e._has("cartesian")){i.getComponentMethod("grid","contentDefaults")(t,e);f.finalizeSubplots(t,e)}for(var h in e._subplots){e._subplots[h].sort(l.subplotSort)}for(u=0;u<o.length;u++){c=o[u];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(t,e,r)}}var p=e._modules;for(u=0;u<p.length;u++){c=p[u];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(t,e,r)}}var d=e._transformModules;for(u=0;u<d.length;u++){c=d[u];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(t,e,r,n)}}for(s in a){c=a[s];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(t,e,r)}}};m.purge=function(t){var e=t._fullLayout||{};if(e._glcontainer!==undefined){e._glcontainer.selectAll(".gl-canvas").remove();e._glcontainer.remove();e._glcanvas=null}if(e._geocontainer!==undefined)e._geocontainer.remove();if(e._modeBar)e._modeBar.destroy();if(t._transitionData){if(t._transitionData._interruptCallbacks){t._transitionData._interruptCallbacks.length=0}if(t._transitionData._animationRaf){window.cancelAnimationFrame(t._transitionData._animationRaf)}}l.clearThrottle();delete t.data;delete t.layout;delete t._fullData;delete t._fullLayout;delete t.calcdata;delete t.framework;delete t.empty;delete t.fid;delete t.undoqueue;delete t.undonum;delete t.autoplay;delete t.changed;delete t._promises;delete t._redrawTimer;delete t.firstscatter;delete t._hmlumcount;delete t._hmpixcount;delete t._transitionData;delete t._transitioning;delete t._initialAutoSize;delete t._transitioningWithDuration;delete t._dragging;delete t._dragged;delete t._hoverdata;delete t._snapshotInProgress;delete t._editing;delete t._replotPending;delete t._mouseDownTime;delete t._legendMouseDownTime;if(t.removeAllListeners)t.removeAllListeners()};m.style=function(t){var e=t._fullLayout._modules;var r=[];var n;for(n=0;n<e.length;n++){var a=e[n];if(a.style){l.pushUnique(r,a.style)}}for(n=0;n<r.length;n++){r[n](t)}};m.sanitizeMargins=function(t){if(!t||!t.margin)return;var e=t.width,r=t.height,n=t.margin,a=e-(n.l+n.r),i=r-(n.t+n.b),o;if(a<0){o=(e-1)/(n.l+n.r);n.l=Math.floor(o*n.l);n.r=Math.floor(o*n.r)}if(i<0){o=(r-1)/(n.t+n.b);n.t=Math.floor(o*n.t);n.b=Math.floor(o*n.b)}};m.clearAutoMarginIds=function(t){t._fullLayout._pushmarginIds={}};m.allowAutoMargin=function(t,e){t._fullLayout._pushmarginIds[e]=1};function I(t){if(!t._pushmargin)t._pushmargin={};if(!t._pushmarginIds)t._pushmarginIds={}}m.autoMargin=function(t,e,r){var n=t._fullLayout;I(n);var a=n._pushmargin;var i=n._pushmarginIds;if(n.margin.autoexpand!==false){if(!r){delete a[e];delete i[e]}else{var o=r.pad;if(o===undefined){var s=n.margin;o=Math.min(12,s.l,s.r,s.t,s.b)}if(r.l+r.r>n.width*.5)r.l=r.r=0;if(r.b+r.t>n.height*.5)r.b=r.t=0;var l=r.xl!==undefined?r.xl:r.x;var u=r.xr!==undefined?r.xr:r.x;var c=r.yt!==undefined?r.yt:r.y;var f=r.yb!==undefined?r.yb:r.y;a[e]={l:{val:l,size:r.l+o},r:{val:u,size:r.r+o},b:{val:f,size:r.b+o},t:{val:c,size:r.t+o}};i[e]=1}if(!n._replotting)m.doAutoMargin(t)}};m.doAutoMargin=function(t){var e=t._fullLayout;if(!e._size)e._size={};I(e);var r=e._size,n=JSON.stringify(r);var o=Math.max(e.margin.l||0,0);var s=Math.max(e.margin.r||0,0);var l=Math.max(e.margin.t||0,0);var u=Math.max(e.margin.b||0,0);var c=e._pushmargin;var f=e._pushmarginIds;if(e.margin.autoexpand!==false){for(var h in c){if(!f[h])delete c[h]}c.base={l:{val:0,size:o},r:{val:1,size:s},t:{val:1,size:l},b:{val:0,size:u}};for(var p in c){var d=c[p].l||{},v=c[p].b||{},g=d.val,m=d.size,y=v.val,x=v.size;for(var b in c){if(a(m)&&c[b].r){var _=c[b].r.val,w=c[b].r.size;if(_>g){var k=(m*_+(w-e.width)*g)/(_-g),M=(w*(1-g)+(m-e.width)*(1-_))/(_-g);if(k>=0&&M>=0&&k+M>o+s){o=k;s=M}}}if(a(x)&&c[b].t){var A=c[b].t.val,T=c[b].t.size;if(A>y){var S=(x*A+(T-e.height)*y)/(A-y),E=(T*(1-y)+(x-e.height)*(1-A))/(A-y);if(S>=0&&E>=0&&S+E>u+l){u=S;l=E}}}}}}r.l=Math.round(o);r.r=Math.round(s);r.t=Math.round(l);r.b=Math.round(u);r.p=Math.round(e.margin.pad);r.w=Math.round(e.width)-r.l-r.r;r.h=Math.round(e.height)-r.t-r.b;if(!e._replotting&&n!=="{}"&&n!==JSON.stringify(e._size)){if("_redrawFromAutoMarginCount"in e){e._redrawFromAutoMarginCount++}else{e._redrawFromAutoMarginCount=1}return i.call("plot",t)}};m.graphJson=function(t,e,r,n,a){if(a&&e&&!t._fullData||a&&!e&&!t._fullLayout){m.supplyDefaults(t)}var i=a?t._fullData:t.data,o=a?t._fullLayout:t.layout,s=(t._transitionData||{})._frames;function u(t){if(typeof t==="function"){return null}if(l.isPlainObject(t)){var e={},n,a;for(n in t){if(typeof t[n]==="function"||["_","["].indexOf(n.charAt(0))!==-1){continue}if(r==="keepdata"){if(n.substr(n.length-3)==="src"){continue}}else if(r==="keepstream"){a=t[n+"src"];if(typeof a==="string"&&a.indexOf(":")>0){if(!l.isPlainObject(t.stream)){continue}}}else if(r!=="keepall"){a=t[n+"src"];if(typeof a==="string"&&a.indexOf(":")>0){continue}}e[n]=u(t[n])}return e}if(Array.isArray(t)){return t.map(u)}if(l.isJSDate(t))return l.ms2DateTimeLocal(+t);return t}var c={data:(i||[]).map(function(t){var r=u(t);if(e){delete r.fit}return r})};if(!e){c.layout=u(o)}if(t.framework&&t.framework.isPolar)c=t.framework.getConfig();if(s)c.frames=u(s);return n==="object"?c:JSON.stringify(c)};m.modifyFrames=function(t,e){var r,n,a;var i=t._transitionData._frames;var o=t._transitionData._frameHash;for(r=0;r<e.length;r++){n=e[r];switch(n.type){case"replace":a=n.value;var s=(i[n.index]||{}).name;var l=a.name;i[n.index]=o[l]=a;if(l!==s){delete o[s];o[l]=a}break;case"insert":a=n.value;o[a.name]=a;i.splice(n.index,0,a);break;case"delete":a=i[n.index];delete o[a.name];i.splice(n.index,1);break}}return Promise.resolve()};m.computeFrame=function(t,e){var r=t._transitionData._frameHash;var n,a,i,o;if(!e){throw new Error("computeFrame must be given a string frame name")}var s=r[e.toString()];if(!s){return false}var l=[s];var u=[s.name];while(s.baseframe&&(s=r[s.baseframe.toString()])){if(u.indexOf(s.name)!==-1)break;l.push(s);u.push(s.name)}var c={};while(s=l.pop()){if(s.layout){c.layout=m.extendLayout(c.layout,s.layout)}if(s.data){if(!c.data){c.data=[]}a=s.traces;if(!a){a=[];for(n=0;n<s.data.length;n++){a[n]=n}}if(!c.traces){c.traces=[]}for(n=0;n<s.data.length;n++){i=a[n];if(i===undefined||i===null){continue}o=c.traces.indexOf(i);if(o===-1){o=c.data.length;c.traces[o]=i}c.data[o]=m.extendTrace(c.data[o],s.data[n])}}}return c};m.recomputeFrameHash=function(t){var e=t._transitionData._frameHash={};var r=t._transitionData._frames;for(var n=0;n<r.length;n++){var a=r[n];if(a&&a.name){e[a.name]=a}}};m.extendObjectWithContainers=function(t,e,r){var n,a,i,o,s,u,c,f;var h=l.extendDeepNoArrays({},e||{});var p=l.expandObjectPaths(h);var d={};if(r&&r.length){for(i=0;i<r.length;i++){n=l.nestedProperty(p,r[i]);a=n.get();if(a===undefined){l.nestedProperty(d,r[i]).set(null)}else{n.set(null);l.nestedProperty(d,r[i]).set(a)}}}t=l.extendDeepNoArrays(t||{},p);if(r&&r.length){for(i=0;i<r.length;i++){s=l.nestedProperty(d,r[i]);c=s.get();if(!c)continue;u=l.nestedProperty(t,r[i]);f=u.get();if(!Array.isArray(f)){f=[];u.set(f)}for(o=0;o<c.length;o++){var v=c[o];if(v===null)f[o]=null;else{f[o]=m.extendObjectWithContainers(f[o],v)}}u.set(f)}}return t};m.dataArrayContainers=["transforms","dimensions"];m.layoutArrayContainers=i.layoutArrayContainers;m.extendTrace=function(t,e){return m.extendObjectWithContainers(t,e,m.dataArrayContainers)};m.extendLayout=function(t,e){return m.extendObjectWithContainers(t,e,m.layoutArrayContainers)};m.transition=function(t,e,r,n,a,o){var s,u;var c=Array.isArray(e)?e.length:0;var f=n.slice(0,c);var h=[];function p(){var n;for(n=0;n<f.length;n++){var a=f[n];var o=t._fullData[a];var s=o._module;if(!s)continue;if(s.animatable){h.push(a)}t.data[f[n]]=m.extendTrace(t.data[f[n]],e[n])}var u=l.expandObjectPaths(l.extendDeepNoArrays({},r));var c=/^[xy]axis[0-9]*$/;for(var p in u){if(!c.test(p))continue;delete u[p].range}m.extendLayout(t.layout,u);delete t.calcdata;m.supplyDefaults(t);m.doCalcdata(t);i.getComponentMethod("errorbars","calc")(t);return Promise.resolve()}function d(t){var e=Promise.resolve();if(!t)return e;while(t.length){e=e.then(t.shift())}return e}function v(t){if(!t)return;while(t.length){t.shift()}}var g=false;function y(){t.emit("plotly_transitioning",[]);return new Promise(function(e){t._transitioning=true;if(o.duration>0){t._transitioningWithDuration=true}t._transitionData._interruptCallbacks.push(function(){g=true});if(a.redraw){t._transitionData._interruptCallbacks.push(function(){return i.call("redraw",t)})}t._transitionData._interruptCallbacks.push(function(){t.emit("plotly_transitioninterrupted",[])});var n=0;var s=0;function u(){n++;return function(){s++;if(!g&&s===n){x(e)}}}var c;var f;var p=t._fullLayout._basePlotModules;var d=false;if(r){for(f=0;f<p.length;f++){if(p[f].transitionAxes){var v=l.expandObjectPaths(r);d=p[f].transitionAxes(t,v,o,u)||d}}}if(d){c=l.extendFlat({},o);c.duration=0}else{c=o}for(f=0;f<p.length;f++){p[f].plot(t,h,c,u)}setTimeout(u())})}function x(e){if(!t._transitionData)return;v(t._transitionData._interruptCallbacks);return Promise.resolve().then(function(){if(a.redraw){return i.call("redraw",t)}}).then(function(){t._transitioning=false;t._transitioningWithDuration=false;t.emit("plotly_transitioned",[])}).then(e)}function b(){if(!t._transitionData)return;t._transitioning=false;return d(t._transitionData._interruptCallbacks)}for(s=0;s<f.length;s++){u=f[s];var _=t._fullData[u];var w=_._module;if(!w)continue}var k=[m.previousPromises,b,p,m.rehover,y];var M=l.syncOrAsync(k,t);if(!M||!M.then){M=Promise.resolve()}return M.then(function(){return t})};m.doCalcdata=function(t,e){var r=f.list(t),n=t._fullData,a=t._fullLayout;var s,l,u,h;var p=new Array(n.length);var d=(t.calcdata||[]).slice(0);t.calcdata=p;t.firstscatter=true;a._numBoxes=0;a._numViolins=0;a._violinScaleGroupStats={};t._hmpixcount=0;t._hmlumcount=0;a._piecolormap={};a._piecolorway=null;a._piedefaultcolorcount=0;for(u=0;u<n.length;u++){if(Array.isArray(e)&&e.indexOf(u)===-1){p[u]=d[u];continue}}for(u=0;u<n.length;u++){s=n[u];s._arrayAttrs=o.findArrayAttributes(s)}var v=a._subplots.polar||[];for(u=0;u<v.length;u++){r.push(a[v[u]].radialaxis,a[v[u]].angularaxis)}z(r);var g=false;for(u=0;u<n.length;u++){s=n[u];if(s.visible===true&&s.transforms){l=s._module;if(l&&l.calc){var m=l.calc(t,s);if(m[0]&&m[0].t&&m[0].t._scene){delete m[0].t._scene.dirty}}for(h=0;h<s.transforms.length;h++){var x=s.transforms[h];l=y[x.type];if(l&&l.calcTransform){s._hasCalcTransform=true;g=true;l.calcTransform(t,s,x)}}}}if(g)z(r);function b(e,r){s=n[e];l=s._module;if(!!l.isContainer!==r)return;var a=[];if(s.visible===true){var i=s.transforms||[];for(h=i.length-1;h>=0;h--){if(i[h].enabled){s._indexToPoints=i[h]._indexToPoints;break}}if(l&&l.calc){a=l.calc(t,s)}}if(!Array.isArray(a)||!a[0]){a=[{x:c,y:c}]}if(!a[0].t)a[0].t={};a[0].trace=s;p[e]=a}for(u=0;u<n.length;u++)b(u,true);for(u=0;u<n.length;u++)b(u,false);i.getComponentMethod("fx","calc")(t)};function z(t){for(var e=0;e<t.length;e++){t[e].clearCalc()}}m.rehover=function(t){if(t._fullLayout._rehover){t._fullLayout._rehover()}};m.generalUpdatePerTraceModule=function(t,e,r,n){var a=e.traceHash;var i={};var o;for(o=0;o<r.length;o++){var s=r[o],u=s[0].trace;if(u.visible){i[u.type]=i[u.type]||[];i[u.type].push(s)}}for(var c in a){if(!i[c]){var f=a[c][0],h=f[0].trace;h.visible=false;i[c]=[f]}}for(var p in i){var d=i[p];var v=d[0][0].trace._module;v.plot(t,e,l.filterVisible(d),n)}e.traceHash=i}},{"../components/color":558,"../constants/numerical":661,"../lib":684,"../plot_api/plot_schema":721,"../plot_api/plot_template":722,"../plots/cartesian/axis_ids":735,"../registry":817,"./animation_attributes":727,"./attributes":729,"./command":756,"./font_attributes":758,"./frame_attributes":759,"./layout_attributes":786,"./sort_modules":808,d3:147,"fast-isnumeric":214}],796:[function(t,e,r){"use strict";e.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-axis","radial-axis","angular-line","radial-line"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],797:[function(t,e,r){"use strict";var n=t("../../lib");r.setConvertAngular=function t(e){var r={clockwise:-1,counterclockwise:1}[e.direction];var a=n.deg2rad(e.rotation);var i;var o;function s(){return e.period?Math.max(e.period,e._categories.length):e._categories.length}if(e.type==="linear"){i=function(t,e){if(e==="degrees")return n.deg2rad(t);return t};o=function(t,e){if(e==="degrees")return n.rad2deg(t);return t}}else if(e.type==="category"){i=function(t){var e=s();return t*2*Math.PI/e};o=function(t){var e=s();return t*e/Math.PI/2}}function l(t){return r*t+a}function u(t){return(t-a)/r}e.unTransformRad=u;e._c2rad=i;e.c2rad=function(t,e){return l(i(t,e))};e.rad2c=function(t,e){return o(u(t),e)};e.c2deg=function(t,r){return n.rad2deg(e.c2rad(t,r))};e.deg2c=function(t,r){return e.rad2c(n.deg2rad(t),r)}}},{"../../lib":684}],798:[function(t,e,r){"use strict";var n=t("../get_data").getSubplotCalcData;var a=t("../../lib").counterRegex;var i=t("./polar");var o=t("./constants");var s=o.attr;var l=o.name;var u=a(l);var c={};c[s]={valType:"subplotid",dflt:l,editType:"calc"};function f(t){var e=t._fullLayout;var r=t.calcdata;var a=e._subplots[l];for(var o=0;o<a.length;o++){var s=a[o];var u=n(r,l,s);var c=e[s]._subplot;if(!c){c=i(t,s);e[s]._subplot=c}c.plot(u,e,t._promises)}}function h(t,e,r,n){var a=n._subplots[l]||[];for(var i=0;i<a.length;i++){var o=a[i];var s=n[o]._subplot;if(!e[o]&&!!s){s.framework.remove();s.layers["radial-axis-title"].remove();for(var u in s.clipPaths){s.clipPaths[u].remove()}}}}e.exports={attr:s,name:l,idRoot:l,idRegex:u,attrRegex:u,attributes:c,layoutAttributes:t("./layout_attributes"),supplyLayoutDefaults:t("./layout_defaults"),plot:f,clean:h,toSVG:t("../cartesian").toSVG}},{"../../lib":684,"../cartesian":743,"../get_data":768,"./constants":796,"./layout_attributes":799,"./layout_defaults":800,"./polar":807}],799:[function(t,e,r){"use strict";var n=t("../../components/color/attributes");var a=t("../cartesian/layout_attributes");var i=t("../domain").attributes;var o=t("../../lib").extendFlat;var s=t("../../plot_api/edit_types").overrideAll;var l=s({color:a.color,showline:o({},a.showline,{dflt:true}),linecolor:a.linecolor,linewidth:a.linewidth,showgrid:o({},a.showgrid,{dflt:true}),gridcolor:a.gridcolor,gridwidth:a.gridwidth},"plot","from-root");var u=s({tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:a.ticks,ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,showticklabels:a.showticklabels,showtickprefix:a.showtickprefix,tickprefix:a.tickprefix,showticksuffix:a.showticksuffix,ticksuffix:a.ticksuffix,showexponent:a.showexponent,exponentformat:a.exponentformat,separatethousands:a.separatethousands,tickfont:a.tickfont,tickangle:a.tickangle,tickformat:a.tickformat,tickformatstops:a.tickformatstops,layer:a.layer},"plot","from-root");var c={visible:o({},a.visible,{dflt:true}),type:a.type,autorange:a.autorange,rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:a.range,categoryorder:a.categoryorder,categoryarray:a.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:o({},a.title,{editType:"plot",dflt:""}),titlefont:s(a.titlefont,"plot","from-root"),hoverformat:a.hoverformat,editType:"calc"};o(c,l,u);var f={visible:o({},a.visible,{dflt:true}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:true},categoryorder:a.categoryorder,categoryarray:a.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:a.hoverformat,editType:"calc"};o(f,l,u);e.exports={domain:i({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:n.background},radialaxis:c,angularaxis:f,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},editType:"calc"}},{"../../components/color/attributes":557,"../../lib":684,"../../plot_api/edit_types":715,"../cartesian/layout_attributes":744,"../domain":757}],800:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../components/color");var i=t("../subplot_defaults");var o=t("../get_data").getSubplotData;var s=t("../cartesian/tick_value_defaults");var l=t("../cartesian/tick_mark_defaults");var u=t("../cartesian/tick_label_defaults");var c=t("../cartesian/category_order_defaults");var f=t("../cartesian/line_grid_defaults");var h=t("../cartesian/axis_autotype");var p=t("../cartesian/set_convert");var d=t("./helpers").setConvertAngular;var v=t("./layout_attributes");var g=t("./constants");var m=g.axisNames;function y(t,e,r,i){var h=r("bgcolor");i.bgColor=a.combine(h,i.paper_bgcolor);var y=r("sector");var b=o(i.fullData,g.name,i.id);var _=i.layoutOut;var w;function k(t,e){return r(w+"."+t,e)}for(var M=0;M<m.length;M++){w=m[M];if(!n.isPlainObject(t[w])){t[w]={}}var A=t[w];var T=e[w]={};T._id=T._name=w;var S=g.axisName2dataArray[w];var E=x(A,T,k,b,S);c(A,T,k,{axData:b,dataAttr:S});var C=k("visible");p(T,_);var L;var I;if(C){L=k("color");I=L===A.color?L:i.font.color}T._m=1;switch(w){case"radialaxis":var z=k("autorange",!T.isValidRange(A.range));A.autorange=z;if(z)k("rangemode");if(z==="reversed")T._m=-1;k("range");T.cleanRange("range",{dfltRange:[0,1]});if(C){k("side");k("angle",y[0]);k("title");n.coerceFont(k,"titlefont",{family:i.font.family,size:Math.round(i.font.size*1.2),color:I})}break;case"angularaxis":if(E==="date"){n.log("Polar plots do not support date angular axes yet.");for(var P=0;P<b.length;P++){b[P].visible=false}E=A.type=T.type="linear"}if(E==="linear"){k("thetaunit")}else{k("period")}var O=k("direction");k("rotation",{counterclockwise:0,clockwise:90}[O]);d(T);break}if(C){s(A,T,k,T.type);u(A,T,k,T.type,{tickSuffixDflt:T.thetaunit==="degrees"?"\xb0":undefined});l(A,T,k,{outerTicks:true});var D=k("showticklabels");if(D){n.coerceFont(k,"tickfont",{family:i.font.family,size:i.font.size,color:I});k("tickangle");k("tickformat")}f(A,T,k,{dfltColor:L,bgColor:i.bgColor,blend:60,showLine:true,showGrid:true,noZeroLine:true,attributes:v[w]});k("layer")}if(E!=="category")k("hoverformat");T._input=A}if(e.angularaxis.type==="category"){r("gridshape")}}function x(t,e,r,n,a){var i=r("type");if(i==="-"){var o;for(var s=0;s<n.length;s++){if(n[s].visible){o=n[s];break}}if(o){e.type=h(o[a],"gregorian")}if(e.type==="-"){e.type="linear"}else{t.type=e.type}}return e.type}e.exports=function t(e,r,n){i(e,r,n,{type:g.name,attributes:v,handleDefaults:y,font:r.font,paper_bgcolor:r.paper_bgcolor,fullData:n,layoutOut:r})}},{"../../components/color":558,"../../lib":684,"../cartesian/axis_autotype":733,"../cartesian/category_order_defaults":736,"../cartesian/line_grid_defaults":746,"../cartesian/set_convert":750,"../cartesian/tick_label_defaults":751,"../cartesian/tick_mark_defaults":752,"../cartesian/tick_value_defaults":753,"../get_data":768,"../subplot_defaults":809,"./constants":796,"./helpers":797,"./layout_attributes":799}],801:[function(t,e,r){"use strict";var n=t("../../../traces/scatter/attributes");var a=n.marker;e.exports={r:n.r,t:n.t,marker:{color:a.color,size:a.size,symbol:a.symbol,opacity:a.opacity,editType:"calc"}}},{"../../../traces/scatter/attributes":1015}],802:[function(t,e,r){"use strict";var n=t("../../cartesian/layout_attributes");var a=t("../../../lib/extend").extendFlat;var i=t("../../../plot_api/edit_types").overrideAll;var o=a({},n.domain,{});function s(t,e){var r={showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number"},visible:{valType:"boolean"}};return a({},e,r)}e.exports=i({radialaxis:s("radial",{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:o,orientation:{valType:"number"}}),angularaxis:s("angular",{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:o}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}},"plot","nested")},{"../../../lib/extend":673,"../../../plot_api/edit_types":715,"../../cartesian/layout_attributes":744}],803:[function(t,e,r){"use strict";var n=e.exports=t("./micropolar");n.manager=t("./micropolar_manager")},{"./micropolar":804,"./micropolar_manager":805}],804:[function(t,e,r){var n=t("d3");var a=t("../../../lib");var i=a.extendDeepAll;var o=t("../../../constants/alignment").MID_SHIFT;var s=e.exports={version:"0.2.2"};s.Axis=function t(){var e={data:[],layout:{}},r={},a={};var l,u,c=n.dispatch("hover"),f,h;var p={};function d(t){u=t||u;var r=e.data;var c=e.layout;if(typeof u=="string"||u.nodeName)u=n.select(u);u.datum(r).each(function(t,e){var r=t.slice();a={data:s.util.cloneJson(r),layout:s.util.cloneJson(c)};var u=0;r.forEach(function(t,e){if(!t.color){t.color=c.defaultColorRange[u];u=(u+1)%c.defaultColorRange.length}if(!t.strokeColor){t.strokeColor=t.geometry==="LinePlot"?t.color:n.rgb(t.color).darker().toString()}a.data[e].color=t.color;a.data[e].strokeColor=t.strokeColor;a.data[e].strokeDash=t.strokeDash;a.data[e].strokeSize=t.strokeSize});var p=r.filter(function(t,e){var r=t.visible;return typeof r==="undefined"||r===true});var d=false;var v=p.map(function(t,e){d=d||typeof t.groupId!=="undefined";return t});if(d){var g=n.nest().key(function(t,e){return typeof t.groupId!="undefined"?t.groupId:"unstacked"}).entries(v);var m=[];var y=g.map(function(t,e){if(t.key==="unstacked")return t.values;else{var r=t.values[0].r.map(function(t,e){return 0});t.values.forEach(function(t,e,n){t.yStack=[r];m.push(r);r=s.util.sumArrays(t.r,r)});return t.values}});p=n.merge(y)}p.forEach(function(t,e){t.t=Array.isArray(t.t[0])?t.t:[t.t];t.r=Array.isArray(t.r[0])?t.r:[t.r]});var x=Math.min(c.width-c.margin.left-c.margin.right,c.height-c.margin.top-c.margin.bottom)/2;x=Math.max(10,x);var b=[c.margin.left+x,c.margin.top+x];var _;if(d){var w=n.max(s.util.sumArrays(s.util.arrayLast(p).r[0],s.util.arrayLast(m)));_=[0,w]}else _=n.extent(s.util.flattenArray(p.map(function(t,e){return t.r})));if(c.radialAxis.domain!=s.DATAEXTENT)_[0]=0;f=n.scale.linear().domain(c.radialAxis.domain!=s.DATAEXTENT&&c.radialAxis.domain?c.radialAxis.domain:_).range([0,x]);a.layout.radialAxis.domain=f.domain();var k=s.util.flattenArray(p.map(function(t,e){return t.t}));var M=typeof k[0]==="string";var A;if(M){k=s.util.deduplicate(k);A=k.slice();k=n.range(k.length);p=p.map(function(t,e){var r=t;t.t=[k];if(d)r.yStack=t.yStack;return r})}var T=p.filter(function(t,e){return t.geometry==="LinePlot"||t.geometry==="DotPlot"}).length===p.length;var S=c.needsEndSpacing===null?M||!T:c.needsEndSpacing;var E=c.angularAxis.domain&&c.angularAxis.domain!=s.DATAEXTENT&&!M&&c.angularAxis.domain[0]>=0;var C=E?c.angularAxis.domain:n.extent(k);var L=Math.abs(k[1]-k[0]);if(T&&!M)L=0;var I=C.slice();if(S&&M)I[1]+=L;var z=c.angularAxis.ticksCount||4;if(z>8)z=z/(z/8)+z%8;if(c.angularAxis.ticksStep){z=(I[1]-I[0])/z}var P=c.angularAxis.ticksStep||(I[1]-I[0])/(z*(c.minorTicks+1));if(A)P=Math.max(Math.round(P),1);if(!I[2])I[2]=P;var O=n.range.apply(this,I);O=O.map(function(t,e){return parseFloat(t.toPrecision(12))});h=n.scale.linear().domain(I.slice(0,2)).range(c.direction==="clockwise"?[0,360]:[360,0]);a.layout.angularAxis.domain=h.domain();a.layout.angularAxis.endPadding=S?L:0;l=n.select(this).select("svg.chart-root");if(typeof l==="undefined"||l.empty()){var D="<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>";var R=(new DOMParser).parseFromString(D,"application/xml");var B=this.appendChild(this.ownerDocument.importNode(R.documentElement,true));l=n.select(B)}l.select(".guides-group").style({"pointer-events":"none"});l.select(".angular.axis-group").style({"pointer-events":"none"});l.select(".radial.axis-group").style({"pointer-events":"none"});var F=l.select(".chart-group");var N={fill:"none",stroke:c.tickColor};var j={"font-size":c.font.size,"font-family":c.font.family,fill:c.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(t,e){return" "+t+" 0 "+c.font.outlineColor}).join(",")};var V;if(c.showLegend){V=l.select(".legend-group").attr({transform:"translate("+[x,c.margin.top]+")"}).style({display:"block"});var U=p.map(function(t,e){var r=s.util.cloneJson(t);r.symbol=t.geometry==="DotPlot"?t.dotType||"circle":t.geometry!="LinePlot"?"square":"line";r.visibleInLegend=typeof t.visibleInLegend==="undefined"||t.visibleInLegend;r.color=t.geometry==="LinePlot"?t.strokeColor:t.color;return r});s.Legend().config({data:p.map(function(t,e){return t.name||"Element"+e}),legendConfig:i({},s.Legend.defaultConfig().legendConfig,{container:V,elements:U,reverseOrder:c.legend.reverseOrder})})();var q=V.node().getBBox();x=Math.min(c.width-q.width-c.margin.left-c.margin.right,c.height-c.margin.top-c.margin.bottom)/2;x=Math.max(10,x);b=[c.margin.left+x,c.margin.top+x];f.range([0,x]);a.layout.radialAxis.domain=f.domain();V.attr("transform","translate("+[b[0]+x,b[1]-x]+")")}else{V=l.select(".legend-group").style({display:"none"})}l.attr({width:c.width,height:c.height}).style({opacity:c.opacity});F.attr("transform","translate("+b+")").style({cursor:"crosshair"});var H=[(c.width-(c.margin.left+c.margin.right+x*2+(q?q.width:0)))/2,(c.height-(c.margin.top+c.margin.bottom+x*2))/2];H[0]=Math.max(0,H[0]);H[1]=Math.max(0,H[1]);l.select(".outer-group").attr("transform","translate("+H+")");if(c.title){var G=l.select("g.title-group text").style(j).text(c.title);var W=G.node().getBBox();G.attr({x:b[0]-W.width/2,y:b[1]-x-20})}var Y=l.select(".radial.axis-group");if(c.radialAxis.gridLinesVisible){var X=Y.selectAll("circle.grid-circle").data(f.ticks(5));X.enter().append("circle").attr({class:"grid-circle"}).style(N);X.attr("r",f);X.exit().remove()}Y.select("circle.outside-circle").attr({r:x}).style(N);var Z=l.select("circle.background-circle").attr({r:x}).style({fill:c.backgroundColor,stroke:c.stroke});function $(t,e){return h(t)%360+c.orientation}if(c.radialAxis.visible){var J=n.svg.axis().scale(f).ticks(5).tickSize(5);Y.call(J).attr({transform:"rotate("+c.radialAxis.orientation+")"});Y.selectAll(".domain").style(N);Y.selectAll("g>text").text(function(t,e){return this.textContent+c.radialAxis.ticksSuffix}).style(j).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(t,e){if(c.radialAxis.tickOrientation==="horizontal"){return"rotate("+-c.radialAxis.orientation+") translate("+[0,j["font-size"]]+")"}else return"translate("+[0,j["font-size"]]+")"}});Y.selectAll("g>line").style({stroke:"black"})}var K=l.select(".angular.axis-group").selectAll("g.angular-tick").data(O);var Q=K.enter().append("g").classed("angular-tick",true);K.attr({transform:function(t,e){return"rotate("+$(t,e)+")"}}).style({display:c.angularAxis.visible?"block":"none"});K.exit().remove();Q.append("line").classed("grid-line",true).classed("major",function(t,e){return e%(c.minorTicks+1)==0}).classed("minor",function(t,e){return!(e%(c.minorTicks+1)==0)}).style(N);Q.selectAll(".minor").style({stroke:c.minorTickColor});K.select("line.grid-line").attr({x1:c.tickLength?x-c.tickLength:0,x2:x}).style({display:c.angularAxis.gridLinesVisible?"block":"none"});Q.append("text").classed("axis-text",true).style(j);var tt=K.select("text.axis-text").attr({x:x+c.labelOffset,dy:o+"em",transform:function(t,e){var r=$(t,e);var n=x+c.labelOffset;var a=c.angularAxis.tickOrientation;if(a=="horizontal")return"rotate("+-r+" "+n+" 0)";else if(a=="radial")return r<270&&r>90?"rotate(180 "+n+" 0)":null;else return"rotate("+(r<=180&&r>0?-90:90)+" "+n+" 0)"}}).style({"text-anchor":"middle",display:c.angularAxis.labelsVisible?"block":"none"}).text(function(t,e){if(e%(c.minorTicks+1)!=0)return"";if(A){return A[t]+c.angularAxis.ticksSuffix}else return t+c.angularAxis.ticksSuffix}).style(j);if(c.angularAxis.rewriteTicks)tt.text(function(t,e){if(e%(c.minorTicks+1)!=0)return"";return c.angularAxis.rewriteTicks(this.textContent,e)});var et=n.max(F.selectAll(".angular-tick text")[0].map(function(t,e){return t.getCTM().e+t.getBBox().width}));V.attr({transform:"translate("+[x+et,c.margin.top]+")"});var rt=l.select("g.geometry-group").selectAll("g").size()>0;var nt=l.select("g.geometry-group").selectAll("g.geometry").data(p);nt.enter().append("g").attr({class:function(t,e){return"geometry geometry"+e}});nt.exit().remove();if(p[0]||rt){var at=[];p.forEach(function(t,e){var r={};r.radialScale=f;r.angularScale=h;r.container=nt.filter(function(t,r){return r==e});r.geometry=t.geometry;r.orientation=c.orientation;r.direction=c.direction;r.index=e;at.push({data:t,geometryConfig:r})});var it=n.nest().key(function(t,e){return typeof t.data.groupId!="undefined"||"unstacked"}).entries(at);var ot=[];it.forEach(function(t,e){if(t.key==="unstacked")ot=ot.concat(t.values.map(function(t,e){return[t]}));else ot.push(t.values)});ot.forEach(function(t,e){var r;if(Array.isArray(t))r=t[0].geometryConfig.geometry;else r=t.geometryConfig.geometry;var n=t.map(function(t,e){return i(s[r].defaultConfig(),t)});s[r]().config(n)()})}var st=l.select(".guides-group");var lt=l.select(".tooltips-group");var ut=s.tooltipPanel().config({container:lt,fontSize:8})();var ct=s.tooltipPanel().config({container:lt,fontSize:8})();var ft=s.tooltipPanel().config({container:lt,hasTick:true})();var ht,pt;if(!M){var dt=st.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});F.on("mousemove.angular-guide",function(t,e){var r=s.util.getMousePos(Z).angle;dt.attr({x2:-x,transform:"rotate("+r+")"}).style({opacity:.5});var n=(r+180+360-c.orientation)%360;ht=h.invert(n);var a=s.util.convertToCartesian(x+12,r+180);ut.text(s.util.round(ht)).move([a[0]+b[0],a[1]+b[1]])}).on("mouseout.angular-guide",function(t,e){st.select("line").style({opacity:0})})}var vt=st.select("circle").style({stroke:"grey",fill:"none"});F.on("mousemove.radial-guide",function(t,e){var r=s.util.getMousePos(Z).radius;vt.attr({r:r}).style({opacity:.5});pt=f.invert(s.util.getMousePos(Z).radius);var n=s.util.convertToCartesian(r,c.radialAxis.orientation);ct.text(s.util.round(pt)).move([n[0]+b[0],n[1]+b[1]])}).on("mouseout.radial-guide",function(t,e){vt.style({opacity:0});ft.hide();ut.hide();ct.hide()});l.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(t,e){var r=n.select(this);var a=this.style.fill;var i="black";var o=this.style.opacity||1;r.attr({"data-opacity":o});if(a&&a!=="none"){r.attr({"data-fill":a});i=n.hsl(a).darker().toString();r.style({fill:i,opacity:1});var u={t:s.util.round(t[0]),r:s.util.round(t[1])};if(M)u.t=A[t[0]];var c="t: "+u.t+", r: "+u.r;var f=this.getBoundingClientRect();var h=l.node().getBoundingClientRect();var p=[f.left+f.width/2-H[0]-h.left,f.top+f.height/2-H[1]-h.top];ft.config({color:i}).text(c);ft.move(p)}else{a=this.style.stroke||"black";r.attr({"data-stroke":a});i=n.hsl(a).darker().toString();r.style({stroke:i,opacity:1})}}).on("mousemove.tooltip",function(t,e){if(n.event.which!=0)return false;if(n.select(this).attr("data-fill"))ft.show()}).on("mouseout.tooltip",function(t,e){ft.hide();var r=n.select(this);var a=r.attr("data-fill");if(a)r.style({fill:a,opacity:r.attr("data-opacity")});else r.style({stroke:r.attr("data-stroke"),opacity:r.attr("data-opacity")})})});return p}p.render=function(t){d(t);return this};p.config=function(t){if(!arguments.length)return e;var r=s.util.cloneJson(t);r.data.forEach(function(t,r){if(!e.data[r])e.data[r]={};i(e.data[r],s.Axis.defaultConfig().data[0]);i(e.data[r],t)});i(e.layout,s.Axis.defaultConfig().layout);i(e.layout,r.layout);return this};p.getLiveConfig=function(){return a};p.getinputConfig=function(){return r};p.radialScale=function(t){return f};p.angularScale=function(t){return h};p.svg=function(){return l};n.rebind(p,c,"on");return p};s.Axis.defaultConfig=function(t,e){var r={data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:true,opacity:1}],layout:{defaultColorRange:n.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:true,gridLinesVisible:true,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:true,gridLinesVisible:true,labelsVisible:true,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:true,legend:{reverseOrder:false},opacity:1}};return r};s.util={};s.DATAEXTENT="dataExtent";s.AREA="AreaChart";s.LINE="LinePlot";s.DOT="DotPlot";s.BAR="BarChart";s.util._override=function(t,e){for(var r in t)if(r in e)e[r]=t[r]};s.util._extend=function(t,e){for(var r in t)e[r]=t[r]};s.util._rndSnd=function(){return Math.random()*2-1+(Math.random()*2-1)+(Math.random()*2-1)};s.util.dataFromEquation2=function(t,e){var r=e||6;var a=n.range(0,360+r,r).map(function(e,r){var n=e*Math.PI/180;var a=t(n);return[e,a]});return a};s.util.dataFromEquation=function(t,e,r){var a=e||6;var i=[],o=[];n.range(0,360+a,a).forEach(function(e,r){var n=e*Math.PI/180;var a=t(n);i.push(e);o.push(a)});var s={t:i,r:o};if(r)s.name=r;return s};s.util.ensureArray=function(t,e){if(typeof t==="undefined")return null;var r=[].concat(t);return n.range(e).map(function(t,e){return r[e]||r[0]})};s.util.fillArrays=function(t,e,r){e.forEach(function(e,n){t[e]=s.util.ensureArray(t[e],r)});return t};s.util.cloneJson=function(t){return JSON.parse(JSON.stringify(t))};s.util.validateKeys=function(t,e){if(typeof e==="string")e=e.split(".");var r=e.shift();return t[r]&&(!e.length||objHasKeys(t[r],e))};s.util.sumArrays=function(t,e){return n.zip(t,e).map(function(t,e){return n.sum(t)})};s.util.arrayLast=function(t){return t[t.length-1]};s.util.arrayEqual=function(t,e){var r=Math.max(t.length,e.length,1);while(r-- >=0&&t[r]===e[r]);return r===-2};s.util.flattenArray=function(t){var e=[];while(!s.util.arrayEqual(e,t)){e=t;t=[].concat.apply([],t)}return t};s.util.deduplicate=function(t){return t.filter(function(t,e,r){return r.indexOf(t)==e})};s.util.convertToCartesian=function(t,e){var r=e*Math.PI/180;var n=t*Math.cos(r);var a=t*Math.sin(r);return[n,a]};s.util.round=function(t,e){var r=e||2;var n=Math.pow(10,r);return Math.round(t*n)/n};s.util.getMousePos=function(t){var e=n.mouse(t.node());var r=e[0];var a=e[1];var i={};i.x=r;i.y=a;i.pos=e;i.angle=(Math.atan2(a,r)+Math.PI)*180/Math.PI;i.radius=Math.sqrt(r*r+a*a);return i};s.util.duplicatesCount=function(t){var e={},r;var n={};for(var a=0,i=t.length;a<i;a++){r=t[a];if(r in e){e[r]++;n[r]=e[r]}else{e[r]=1}}return n};s.util.duplicates=function(t){return Object.keys(s.util.duplicatesCount(t))};s.util.translator=function(t,e,r,n){if(n){var a=r.slice();r=e;e=a}var i=e.reduce(function(t,e){if(typeof t!="undefined")return t[e]},t);if(typeof i==="undefined")return;e.reduce(function(t,r,n){if(typeof t=="undefined")return;if(n===e.length-1)delete t[r];return t[r]},t);r.reduce(function(t,e,n){if(typeof t[e]==="undefined")t[e]={};if(n===r.length-1)t[e]=i;return t[e]},t)};s.PolyChart=function t(){var e=[s.PolyChart.defaultConfig()];var r=n.dispatch("hover");var a={solid:"none",dash:[5,2],dot:[2,5]};var o;function l(){var t=e[0].geometryConfig;var r=t.container;if(typeof r=="string")r=n.select(r);r.datum(e).each(function(e,r){var i=!!e[0].data.yStack;var o=e.map(function(t,e){if(i)return n.zip(t.data.t[0],t.data.r[0],t.data.yStack[0]);else return n.zip(t.data.t[0],t.data.r[0])});var s=t.angularScale;var l=t.radialScale.domain()[0];var u={};u.bar=function(r,a,i){var o=e[i].data;var l=t.radialScale(r[1])-t.radialScale(0);var u=t.radialScale(r[2]||0);var c=o.barWidth;n.select(this).attr({class:"mark bar",d:"M"+[[l+u,-c/2],[l+u,c/2],[u,c/2],[u,-c/2]].join("L")+"Z",transform:function(e,r){return"rotate("+(t.orientation+s(e[0]))+")"}})};u.dot=function(t,r,a){var i=t[2]?[t[0],t[1]+t[2]]:t;var o=n.svg.symbol().size(e[a].data.dotSize).type(e[a].data.dotType)(t,r);n.select(this).attr({class:"mark dot",d:o,transform:function(t,e){var r=y(m(i));return"translate("+[r.x,r.y]+")"}})};var c=n.svg.line.radial().interpolate(e[0].data.lineInterpolation).radius(function(e){return t.radialScale(e[1])}).angle(function(e){return t.angularScale(e[0])*Math.PI/180});u.line=function(r,a,i){var s=r[2]?o[i].map(function(t,e){return[t[0],t[1]+t[2]]}):o[i];n.select(this).each(u["dot"]).style({opacity:function(t,r){return+e[i].data.dotVisible},fill:d.stroke(r,a,i)}).attr({class:"mark dot"});if(a>0)return;var l=n.select(this.parentNode).selectAll("path.line").data([0]);l.enter().insert("path");l.attr({class:"line",d:c(s),transform:function(e,r){return"rotate("+(t.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(t,e){return d.fill(r,a,i)},"fill-opacity":0,stroke:function(t,e){return d.stroke(r,a,i)},"stroke-width":function(t,e){return d["stroke-width"](r,a,i)},"stroke-dasharray":function(t,e){return d["stroke-dasharray"](r,a,i)},opacity:function(t,e){return d.opacity(r,a,i)},display:function(t,e){return d.display(r,a,i)}})};var f=t.angularScale.range();var h=Math.abs(f[1]-f[0])/o[0].length*Math.PI/180;var p=n.svg.arc().startAngle(function(t){return-h/2}).endAngle(function(t){return h/2}).innerRadius(function(e){return t.radialScale(l+(e[2]||0))}).outerRadius(function(e){return t.radialScale(l+(e[2]||0))+t.radialScale(e[1])});u.arc=function(e,r,a){n.select(this).attr({class:"mark arc",d:p,transform:function(e,r){return"rotate("+(t.orientation+s(e[0])+90)+")"}})};var d={fill:function(t,r,n){return e[n].data.color},stroke:function(t,r,n){return e[n].data.strokeColor},"stroke-width":function(t,r,n){return e[n].data.strokeSize+"px"},"stroke-dasharray":function(t,r,n){return a[e[n].data.strokeDash]},opacity:function(t,r,n){return e[n].data.opacity},display:function(t,r,n){return typeof e[n].data.visible==="undefined"||e[n].data.visible?"block":"none"}};var v=n.select(this).selectAll("g.layer").data(o);v.enter().append("g").attr({class:"layer"});var g=v.selectAll("path.mark").data(function(t,e){return t});g.enter().append("path").attr({class:"mark"});g.style(d).each(u[t.geometryType]);g.exit().remove();v.exit().remove();function m(e,r){var n=t.radialScale(e[1]);var a=(t.angularScale(e[0])+t.orientation)*Math.PI/180;return{r:n,t:a}}function y(t){var e=t.r*Math.cos(t.t);var r=t.r*Math.sin(t.t);return{x:e,y:r}}})}l.config=function(t){if(!arguments.length)return e;t.forEach(function(t,r){if(!e[r])e[r]={};i(e[r],s.PolyChart.defaultConfig());i(e[r],t)});return this};l.getColorScale=function(){return o};n.rebind(l,r,"on");return l};s.PolyChart.defaultConfig=function(){var t={data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:false,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:true,visibleInLegend:true},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:n.scale.category20()}};return t};s.BarChart=function t(){return s.PolyChart()};s.BarChart.defaultConfig=function(){var t={geometryConfig:{geometryType:"bar"}};return t};s.AreaChart=function t(){return s.PolyChart()};s.AreaChart.defaultConfig=function(){var t={geometryConfig:{geometryType:"arc"}};return t};s.DotPlot=function t(){return s.PolyChart()};s.DotPlot.defaultConfig=function(){var t={geometryConfig:{geometryType:"dot",dotType:"circle"}};return t};s.LinePlot=function t(){return s.PolyChart()};s.LinePlot.defaultConfig=function(){var t={geometryConfig:{geometryType:"line"}};return t};s.Legend=function t(){var e=s.Legend.defaultConfig();var r=n.dispatch("hover");function a(){var t=e.legendConfig;var r=e.data.map(function(e,r){return[].concat(e).map(function(e,n){var a=i({},t.elements[r]);a.name=e;a.color=[].concat(t.elements[r].color)[n];return a})});var o=n.merge(r);o=o.filter(function(e,r){return t.elements[r]&&(t.elements[r].visibleInLegend||typeof t.elements[r].visibleInLegend==="undefined")});if(t.reverseOrder)o=o.reverse();var s=t.container;if(typeof s=="string"||s.nodeName)s=n.select(s);var l=o.map(function(t,e){return t.color});var u=t.fontSize;var c=t.isContinuous==null?typeof o[0]==="number":t.isContinuous;var f=c?t.height:u*o.length;var h=s.classed("legend-group",true);var p=h.selectAll("svg").data([0]);var d=p.enter().append("svg").attr({width:300,height:f+u,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});d.append("g").classed("legend-axis",true);d.append("g").classed("legend-marks",true);var v=n.range(o.length);var g=n.scale[c?"linear":"ordinal"]().domain(v).range(l);var m=n.scale[c?"linear":"ordinal"]().domain(v)[c?"range":"rangePoints"]([0,f]);var y=function(t,e){var r=e*3;if(t==="line"){return"M"+[[-e/2,-e/12],[e/2,-e/12],[e/2,e/12],[-e/2,e/12]]+"Z"}else if(n.svg.symbolTypes.indexOf(t)!=-1)return n.svg.symbol().type(t).size(r)();else return n.svg.symbol().type("square").size(r)()};if(c){var x=p.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(l);x.enter().append("stop");x.attr({offset:function(t,e){return e/(l.length-1)*100+"%"}}).style({"stop-color":function(t,e){return t}});p.append("rect").classed("legend-mark",true).attr({height:t.height,width:t.colorBandWidth,fill:"url(#grad1)"})}else{var b=p.select(".legend-marks").selectAll("path.legend-mark").data(o);b.enter().append("path").classed("legend-mark",true);b.attr({transform:function(t,e){return"translate("+[u/2,m(e)+u/2]+")"},d:function(t,e){var r=t.symbol;return y(r,u)},fill:function(t,e){return g(e)}});b.exit().remove()}var _=n.svg.axis().scale(m).orient("right");var w=p.select("g.legend-axis").attr({transform:"translate("+[c?t.colorBandWidth:u,u/2]+")"}).call(_);w.selectAll(".domain").style({fill:"none",stroke:"none"});w.selectAll("line").style({fill:"none",stroke:c?t.textColor:"none"});w.selectAll("text").style({fill:t.textColor,"font-size":t.fontSize}).text(function(t,e){return o[e].name});return a}a.config=function(t){if(!arguments.length)return e;i(e,t);return this};n.rebind(a,r,"on");return a};s.Legend.defaultConfig=function(t,e){var r={data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:false}};return r};s.tooltipPanel=function(){var t,e,r;var a={container:null,hasTick:false,fontSize:12,color:"white",padding:5};var o="tooltip-"+s.tooltipPanel.uid++;var l=10;var u=function(){t=a.container.selectAll("g."+o).data([0]);var n=t.enter().append("g").classed(o,true).style({"pointer-events":"none",display:"none"});r=n.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"});e=n.append("text").attr({dx:a.padding+l,dy:+a.fontSize*.3});return u};u.text=function(i){var o=n.hsl(a.color).l;var s=o>=.5?"#aaa":"white";var c=o>=.5?"black":"white";var f=i||"";e.style({fill:c,"font-size":a.fontSize+"px"}).text(f);var h=a.padding;var p=e.node().getBBox();var d={fill:a.color,stroke:s,"stroke-width":"2px"};var v=p.width+h*2+l;var g=p.height+h*2;r.attr({d:"M"+[[l,-g/2],[l,-g/4],[a.hasTick?0:l,0],[l,g/4],[l,g/2],[v,g/2],[v,-g/2]].join("L")+"Z"}).style(d);t.attr({transform:"translate("+[l,-g/2+h*2]+")"});t.style({display:"block"});return u};u.move=function(e){if(!t)return;t.attr({transform:"translate("+[e[0],e[1]]+")"}).style({display:"block"});return u};u.hide=function(){if(!t)return;t.style({display:"none"});return u};u.show=function(){if(!t)return;t.style({display:"block"});return u};u.config=function(t){i(a,t);return u};return u};s.tooltipPanel.uid=1;s.adapter={};s.adapter.plotly=function t(){var e={};e.convert=function(t,e){var r={};if(t.data){r.data=t.data.map(function(t,r){var n=i({},t);var a=[[n,["marker","color"],["color"]],[n,["marker","opacity"],["opacity"]],[n,["marker","line","color"],["strokeColor"]],[n,["marker","line","dash"],["strokeDash"]],[n,["marker","line","width"],["strokeSize"]],[n,["marker","symbol"],["dotType"]],[n,["marker","size"],["dotSize"]],[n,["marker","barWidth"],["barWidth"]],[n,["line","interpolation"],["lineInterpolation"]],[n,["showlegend"],["visibleInLegend"]]];a.forEach(function(t,r){s.util.translator.apply(null,t.concat(e))});if(!e)delete n.marker;if(e)delete n.groupId;if(!e){if(n.type==="scatter"){if(n.mode==="lines")n.geometry="LinePlot";else if(n.mode==="markers")n.geometry="DotPlot";else if(n.mode==="lines+markers"){n.geometry="LinePlot";n.dotVisible=true}}else if(n.type==="area")n.geometry="AreaChart";else if(n.type==="bar")n.geometry="BarChart";delete n.mode;delete n.type}else{if(n.geometry==="LinePlot"){n.type="scatter";if(n.dotVisible===true){delete n.dotVisible;n.mode="lines+markers"}else n.mode="lines"}else if(n.geometry==="DotPlot"){n.type="scatter";n.mode="markers"}else if(n.geometry==="AreaChart")n.type="area";else if(n.geometry==="BarChart")n.type="bar";delete n.geometry}return n});if(!e&&t.layout&&t.layout.barmode==="stack"){var a=s.util.duplicates(r.data.map(function(t,e){return t.geometry}));r.data.forEach(function(t,e){var n=a.indexOf(t.geometry);if(n!=-1)r.data[e].groupId=n})}}if(t.layout){var o=i({},t.layout);var l=[[o,["plot_bgcolor"],["backgroundColor"]],[o,["showlegend"],["showLegend"]],[o,["radialaxis"],["radialAxis"]],[o,["angularaxis"],["angularAxis"]],[o.angularaxis,["showline"],["gridLinesVisible"]],[o.angularaxis,["showticklabels"],["labelsVisible"]],[o.angularaxis,["nticks"],["ticksCount"]],[o.angularaxis,["tickorientation"],["tickOrientation"]],[o.angularaxis,["ticksuffix"],["ticksSuffix"]],[o.angularaxis,["range"],["domain"]],[o.angularaxis,["endpadding"],["endPadding"]],[o.radialaxis,["showline"],["gridLinesVisible"]],[o.radialaxis,["tickorientation"],["tickOrientation"]],[o.radialaxis,["ticksuffix"],["ticksSuffix"]],[o.radialaxis,["range"],["domain"]],[o.angularAxis,["showline"],["gridLinesVisible"]],[o.angularAxis,["showticklabels"],["labelsVisible"]],[o.angularAxis,["nticks"],["ticksCount"]],[o.angularAxis,["tickorientation"],["tickOrientation"]],[o.angularAxis,["ticksuffix"],["ticksSuffix"]],[o.angularAxis,["range"],["domain"]],[o.angularAxis,["endpadding"],["endPadding"]],[o.radialAxis,["showline"],["gridLinesVisible"]],[o.radialAxis,["tickorientation"],["tickOrientation"]],[o.radialAxis,["ticksuffix"],["ticksSuffix"]],[o.radialAxis,["range"],["domain"]],[o.font,["outlinecolor"],["outlineColor"]],[o.legend,["traceorder"],["reverseOrder"]],[o,["labeloffset"],["labelOffset"]],[o,["defaultcolorrange"],["defaultColorRange"]]];l.forEach(function(t,r){s.util.translator.apply(null,t.concat(e))});if(!e){if(o.angularAxis&&typeof o.angularAxis.ticklen!=="undefined")o.tickLength=o.angularAxis.ticklen;if(o.angularAxis&&typeof o.angularAxis.tickcolor!=="undefined")o.tickColor=o.angularAxis.tickcolor}else{if(typeof o.tickLength!=="undefined"){o.angularaxis.ticklen=o.tickLength;delete o.tickLength}if(o.tickColor){o.angularaxis.tickcolor=o.tickColor;delete o.tickColor}}if(o.legend&&typeof o.legend.reverseOrder!="boolean"){o.legend.reverseOrder=o.legend.reverseOrder!="normal"}if(o.legend&&typeof o.legend.traceorder=="boolean"){o.legend.traceorder=o.legend.traceorder?"reversed":"normal";delete o.legend.reverseOrder}if(o.margin&&typeof o.margin.t!="undefined"){var u=["t","r","b","l","pad"];var c=["top","right","bottom","left","pad"];var f={};n.entries(o.margin).forEach(function(t,e){f[c[u.indexOf(t.key)]]=t.value});o.margin=f}if(e){delete o.needsEndSpacing;delete o.minorTickColor;delete o.minorTicks;delete o.angularaxis.ticksCount;delete o.angularaxis.ticksCount;delete o.angularaxis.ticksStep;delete o.angularaxis.rewriteTicks;delete o.angularaxis.nticks;delete o.radialaxis.ticksCount;delete o.radialaxis.ticksCount;delete o.radialaxis.ticksStep;delete o.radialaxis.rewriteTicks;delete o.radialaxis.nticks}r.layout=o}return r};return e}},{"../../../constants/alignment":656,"../../../lib":684,d3:147}],805:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../../lib");var i=t("../../../components/color");var o=t("./micropolar");var s=t("./undo_manager");var l=a.extendDeepAll;var u=e.exports={};u.framework=function(t){var e,r,a,i,c;var f=new s;function h(r,s){if(s)c=s;n.select(n.select(c).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove();e=!e?r:l(e,r);if(!a)a=o.Axis();i=o.adapter.plotly().convert(e);a.config(i).render(c);t.data=e.data;t.layout=e.layout;u.fillLayout(t);return e}h.isPolar=true;h.svg=function(){return a.svg()};h.getConfig=function(){return e};h.getLiveConfig=function(){return o.adapter.plotly().convert(a.getLiveConfig(),true)};h.getLiveScales=function(){return{t:a.angularScale(),r:a.radialScale()}};h.setUndoPoint=function(){var t=this;var n=o.util.cloneJson(e);(function(e,r){f.add({undo:function(){if(r)t(r)},redo:function(){t(e)}})})(n,r);r=o.util.cloneJson(n)};h.undo=function(){f.undo()};h.redo=function(){f.redo()};return h};u.fillLayout=function(t){var e=n.select(t).selectAll(".plot-container"),r=e.selectAll(".svg-container"),a=t.framework&&t.framework.svg&&t.framework.svg(),o={width:800,height:600,paper_bgcolor:i.background,_container:e,_paperdiv:r,_paper:a};t._fullLayout=l(o,t.layout)}},{"../../../components/color":558,"../../../lib":684,"./micropolar":804,"./undo_manager":806,d3:147}],806:[function(t,e,r){"use strict";e.exports=function t(){var e=[],r=-1,n=false,a;function i(t,e){if(!t)return this;n=true;t[e]();n=false;return this}return{add:function(t){if(n)return this;e.splice(r+1,e.length-r);e.push(t);r=e.length-1;return this},setCallback:function(t){a=t},undo:function(){var t=e[r];if(!t)return this;i(t,"undo");r-=1;if(a)a(t.undo);return this},redo:function(){var t=e[r+1];if(!t)return this;i(t,"redo");r+=1;if(a)a(t.redo);return this},clear:function(){e=[];r=-1},hasUndo:function(){return r!==-1},hasRedo:function(){return r<e.length-1},getCommands:function(){return e},getPreviousCommand:function(){return e[r-1]},getIndex:function(){return r}}}},{}],807:[function(t,e,r){"use strict";var n=t("d3");var a=t("tinycolor2");var i=t("../../registry");var o=t("../../lib");var s=t("../../components/color");var l=t("../../components/drawing");var u=t("../plots");var c=t("../cartesian/axes");var f=t("../cartesian/autorange").doAutoRange;var h=t("../../components/dragelement");var p=t("../cartesian/dragbox");var d=t("../../components/fx");var v=t("../../components/titles");var g=t("../cartesian/select").prepSelect;var m=t("../cartesian/select").clearSelect;var y=t("../../lib/setcursor");var x=t("../../lib/polygon").tester;var b=t("../../constants/alignment").MID_SHIFT;var _=o._;var w=o.deg2rad;var k=o.rad2deg;var M=o.wrap360;var A=o.wrap180;var T=t("./helpers").setConvertAngular;var S=t("./constants");function E(t,e){this.id=e;this.gd=t;this._hasClipOnAxisFalse=null;this.vangles=null;this.radialAxisAngle=null;this.traceHash={};this.layers={};this.clipPaths={};this.clipIds={};this.viewInitial={};var r=t._fullLayout;var n="clip"+r._uid+e;this.clipIds.forTraces=n+"-for-traces";this.clipPaths.forTraces=r._clips.append("clipPath").attr("id",this.clipIds.forTraces);this.clipPaths.forTraces.append("path");this.framework=r._polarlayer.append("g").attr("class",e);this.radialTickLayout=null;this.angularTickLayout=null}var C=E.prototype;e.exports=function t(e,r){return new E(e,r)};C.plot=function(t,e){var r=this;var n=e[r.id];r._hasClipOnAxisFalse=false;for(var a=0;a<t.length;a++){var i=t[a][0].trace;if(i.cliponaxis===false){r._hasClipOnAxisFalse=true;break}}r.updateLayers(e,n);r.updateLayout(e,n);u.generalUpdatePerTraceModule(r.gd,r,t,n);r.updateFx(e,n)};C.updateLayers=function(t,e){var r=this;var a=r.layers;var i=e.radialaxis;var o=e.angularaxis;var s=S.layerNames;var l=s.indexOf("frontplot");var u=s.slice(0,l);var c=o.layer==="below traces";var f=i.layer==="below traces";if(c)u.push("angular-axis");if(f)u.push("radial-axis");if(c)u.push("angular-line");if(f)u.push("radial-line");u.push("frontplot");if(!c)u.push("angular-axis");if(!f)u.push("radial-axis");if(!c)u.push("angular-line");if(!f)u.push("radial-line");var h=r.framework.selectAll(".polarsublayer").data(u,String);h.enter().append("g").attr("class",function(t){return"polarsublayer "+t}).each(function(t){var e=a[t]=n.select(this);switch(t){case"frontplot":e.append("g").classed("scatterlayer",true);break;case"backplot":e.append("g").classed("maplayer",true);break;case"plotbg":a.bg=e.append("path");break;case"radial-grid":e.style("fill","none");e.append("g").classed("x",1);break;case"angular-grid":e.style("fill","none");e.append("g").classed("angular",1);break;case"radial-line":e.append("line").style("fill","none");break;case"angular-line":e.append("path").style("fill","none");break}});h.order()};C.updateLayout=function(t,e){var r=this;var n=r.layers;var a=t._size;var i=e.domain.x;var u=e.domain.y;r.xOffset=a.l+a.w*i[0];r.yOffset=a.t+a.h*(1-u[1]);var f=r.xLength=a.w*(i[1]-i[0]);var h=r.yLength=a.h*(u[1]-u[0]);var p=r.sector=e.sector;var d=r.sectorBBox=z(p);var v=d[2]-d[0];var g=d[3]-d[1];var m=h/f;var y=Math.abs(g/v);var x,b;var _,w;var k;if(m>y){x=f;b=f*y;k=(h-b)/a.h/2;_=[i[0],i[1]];w=[u[0]+k,u[1]-k]}else{x=h/y;b=h;k=(f-x)/a.w/2;_=[i[0]+k,i[1]-k];w=[u[0],u[1]]}r.xLength2=x;r.yLength2=b;r.xDomain2=_;r.yDomain2=w;var M=r.xOffset2=a.l+a.w*_[0];var A=r.yOffset2=a.t+a.h*(1-w[1]);var T=r.radius=x/v;var S=r.cx=M-T*d[0];var E=r.cy=A+T*d[3];var C=r.cxx=S-M;var L=r.cyy=E-A;var I={anchor:"free",position:0,_counteraxis:true,automargin:false};r.radialAxis=o.extendFlat({},e.radialaxis,I,{_axislayer:n["radial-axis"],_gridlayer:n["radial-grid"],_id:"x",_pos:0,side:{counterclockwise:"top",clockwise:"bottom"}[e.radialaxis.side],domain:[0,T/a.w]});r.angularAxis=o.extendFlat({},e.angularaxis,I,{_axislayer:n["angular-axis"],_gridlayer:n["angular-grid"],_id:"angular",_pos:0,side:"right",domain:[0,Math.PI],autorange:false});r.doAutoRange(t,e);r.updateAngularAxis(t,e);r.updateRadialAxis(t,e);r.updateRadialAxisTitle(t,e);var P=r.radialAxis.range;var O=P[1]-P[0];var D=r.xaxis={type:"linear",_id:"x",range:[d[0]*O,d[2]*O],domain:_};c.setConvert(D,t);D.setScale();var R=r.yaxis={type:"linear",_id:"y",range:[d[1]*O,d[3]*O],domain:w};c.setConvert(R,t);R.setScale();D.isPtWithinRange=function(t){return r.isPtWithinSector(t)};R.isPtWithinRange=function(){return true};r.clipPaths.forTraces.select("path").attr("d",G(T,p,r.vangles)).attr("transform",Z(C,L));n.frontplot.attr("transform",Z(M,A)).call(l.setClipUrl,r._hasClipOnAxisFalse?null:r.clipIds.forTraces);n.bg.attr("d",G(T,p,r.vangles)).attr("transform",Z(S,E)).call(s.fill,e.bgcolor);r.framework.selectAll(".crisp").classed("crisp",0)};C.doAutoRange=function(t,e){var r=e.radialaxis;var n=this.radialAxis;L(n,r,t);f(n);r.range=n.range.slice();r._input.range=n.range.slice()};C.updateRadialAxis=function(t,e){var r=this;var n=r.gd;var a=r.layers;var i=r.radius;var o=r.cx;var l=r.cy;var u=e.radialaxis;var f=e.sector;var h=M(f[0]);var p=r.radialAxis;r.fillViewInitialKey("radialaxis.angle",u.angle);r.fillViewInitialKey("radialaxis.range",p.range.slice());if(p.tickangle==="auto"&&(h>90&&h<=270)){p.tickangle=180}p._transfn=function(t){return"translate("+p.l2p(t.x)+",0)"};p._gridpath=function(t){var e=p.r2p(t.x);return H(e,f,r.vangles)};var d=I(u);if(r.radialTickLayout!==d){a["radial-axis"].selectAll(".xtick").remove();r.radialTickLayout=d}c.doTicksSingle(n,p,true);var v=r.radialAxisAngle=r.vangles?k(O(w(u.angle),r.vangles)):u.angle;var g=Z(o,l)+$(-v);X(a["radial-axis"],u.showticklabels||u.ticks,{transform:g});X(a["radial-grid"],u.showgrid,{transform:Z(o,l)}).selectAll("path").attr("transform",null);X(a["radial-line"].select("line"),u.showline,{x1:0,y1:0,x2:i,y2:0,transform:g}).attr("stroke-width",u.linewidth).call(s.stroke,u.linecolor)};C.updateRadialAxisTitle=function(t,e,r){var n=this;var a=n.gd;var i=n.radius;var o=n.cx;var s=n.cy;var u=e.radialaxis;var c=n.id+"title";var f=r!==undefined?r:n.radialAxisAngle;var h=w(f);var p=Math.cos(h);var d=Math.sin(h);var g=0;if(u.title){var m=l.bBox(n.layers["radial-axis"].node()).height;var y=u.titlefont.size;g=u.side==="counterclockwise"?-m-y*.4:m+y*.8}n.layers["radial-axis-title"]=v.draw(a,c,{propContainer:u,propName:n.id+".radialaxis.title",placeholder:_(a,"Click to enter radial axis title"),attributes:{x:o+i/2*p+g*d,y:s-i/2*d+g*p,"text-anchor":"middle"},transform:{rotate:-f}})};C.updateAngularAxis=function(t,e){var r=this;var a=r.gd;var i=r.layers;var o=r.radius;var l=r.cx;var u=r.cy;var f=e.angularaxis;var h=e.sector;var p=h.map(w);var d=r.angularAxis;r.fillViewInitialKey("angularaxis.rotation",f.rotation);function v(t){return d.c2rad(t.x,"degrees")}function g(t){return[o*Math.cos(t),o*Math.sin(t)]}if(d.type==="linear"){if(Y(h)){d.range=h.slice()}else{d.range=p.map(d.unTransformRad).map(k)}if(d.thetaunit==="radians"){d.tick0=k(d.tick0);d.dtick=k(d.dtick)}}else if(d.type==="category"){var m=f.period?Math.max(f.period,f._categories.length):f._categories.length;d.range=[0,m];d._tickFilter=function(t){return P(v(t),h)}}L(d,f,t);d._transfn=function(t){var e=v(t);var r=g(e);var a=Z(l+r[0],u-r[1]);var i=n.select(this);if(i&&i.node()&&i.classed("ticks")){a+=$(-k(e))}return a};d._gridpath=function(t){var e=v(t);var r=g(e);return"M0,0L"+-r[0]+","+r[1]};var y=f.ticks!=="outside"?.7:.5;d._labelx=function(t){var e=v(t);var r=d._labelStandoff;var n=d._pad;var a=tt(e)===0?0:Math.cos(e)*(r+n+y*t.fontSize);var i=Q(e)*(t.dx+r+n);return a+i};d._labely=function(t){var e=v(t);var r=d._labelStandoff;var n=d._labelShift;var a=d._pad;var i=t.dy+t.fontSize*b-n;var o=-Math.sin(e)*(r+a+y*t.fontSize);return i+o};d._labelanchor=function(t,e){var r=v(e);return tt(r)===0?Q(r)>0?"start":"end":"middle"};var x=I(f);if(r.angularTickLayout!==x){i["angular-axis"].selectAll(".angulartick").remove();r.angularTickLayout=x}c.doTicksSingle(a,d,true);var _;if(e.gridshape==="linear"){_=d._vals.map(v);if(D(_[0],_[1])<0){_=_.slice().reverse()}}else{_=null}r.vangles=_;X(i["angular-line"].select("path"),f.showline,{d:G(o,h,_),transform:Z(l,u)}).attr("stroke-width",f.linewidth).call(s.stroke,f.linecolor)};C.updateFx=function(t,e){if(!this.gd._context.staticPlot){this.updateAngularDrag(t,e);this.updateRadialDrag(t,e);this.updateMainDrag(t,e)}};C.updateMainDrag=function(t,e){var r=this;var s=r.gd;var l=r.layers;var u=t._zoomlayer;var c=S.MINZOOM;var f=S.OFFEDGE;var v=r.radius;var y=r.cx;var x=r.cy;var b=r.cxx;var _=r.cyy;var w=e.sector;var k=r.vangles;var M=S.cornerHalfWidth;var A=S.cornerLen/2;var T=p.makeDragger(l,"path","maindrag","crosshair");n.select(T).attr("d",G(v,w,k)).attr("transform",Z(y,x));var E={element:T,gd:s,subplot:r.id,plotinfo:{xaxis:r.xaxis,yaxis:r.yaxis},xaxes:[r.xaxis],yaxes:[r.yaxis]};var C,L;var I,z;var P,O,N;var j,V;function q(t,e){return Math.sqrt(t*t+e*e)}function H(t,e){return q(t-b,e-_)}function W(t,e){return Math.atan2(_-e,t-b)}function Y(t,e){return[t*Math.cos(e),t*Math.sin(-e)]}function X(t){return G(t,w,k)}function $(t,e){if(t===0)return X(2*M);var r=A/t;var n=e-r;var a=e+r;var i=Math.max(0,Math.min(t,v));var o=i-M;var s=i+M;return"M"+Y(o,n)+"A"+[o,o]+" 0,0,0 "+Y(o,a)+"L"+Y(s,a)+"A"+[s,s]+" 0,0,1 "+Y(s,n)+"Z"}function K(t,e,r){if(t===0)return X(2*M);var n=Y(t,e);var a=Y(t,r);var i=J((n[0]+a[0])/2);var o=J((n[1]+a[1])/2);var s,l;if(i&&o){var u=o/i;var c=-1/u;var f=F(M,u,i,o);s=F(A,c,f[0][0],f[0][1]);l=F(A,c,f[1][0],f[1][1])}else{var h,p;if(o){h=A;p=M}else{h=M;p=A}s=[[i-h,o-p],[i+h,o-p]];l=[[i-h,o+p],[i+h,o+p]]}return"M"+s.join("L")+"L"+l.reverse().join("L")+"Z"}function Q(){I=null;z=null;P=X(v);O=false;var t=s._fullLayout[r.id];N=a(t.bgcolor).getLuminance();j=p.makeZoombox(u,N,y,x,P);j.attr("fill-rule","evenodd");V=p.makeCorners(u,y,x);m(u)}function tt(t,e){e=Math.min(e,v);if(t<f)t=0;else if(v-t<f)t=v;else if(e<f)e=0;else if(v-e<f)e=v;if(Math.abs(e-t)>c){if(t<e){I=t;z=e}else{I=e;z=t}return true}else{I=null;z=null;return false}}function et(t,e){t=t||P;e=e||"M0,0Z";j.attr("d",t);V.attr("d",e);p.transitionZoombox(j,V,O,N);O=true}function rt(t,e){var r=C+t;var n=L+e;var a=H(C,L);var i=Math.min(H(r,n),v);var o=W(C,L);var s;var l;if(tt(a,i)){s=P+X(z)+X(I);l=$(I,o)+$(z,o)}et(s,l)}function nt(t){var e=R(k,function(e){var r=D(e,t);return r>0?r:Infinity});var r=o.mod(e+1,k.length);return[k[e],k[r]]}function at(t,e,r,n){var a=B(r,n,r,[t-b,_-e]);return q(a[0],a[1])}function it(t,e){var r=C+t;var n=L+e;var a=W(C,L);var i=W(r,n);var o=nt(a);var s=nt(i);var l=at(C,L,o[0],o[1]);var u=Math.min(at(r,n,s[0],s[1]),v);var c;var f;if(tt(l,u)){c=P+X(z)+X(I);f=[K(I,o[0],o[1]),K(z,o[0],o[1])].join(" ")}et(c,f)}function ot(){p.removeZoombox(s);if(I===null||z===null)return;p.showDoubleClickNotifier(s);var t=r.radialAxis;var e=t.range;var n=e[1]-e[0];var a={};a[r.id+".radialaxis.range"]=[e[0]+I*n/v,e[0]+z*n/v];i.call("relayout",s,a)}E.prepFn=function(t,e,r){var n=s._fullLayout.dragmode;var a=T.getBoundingClientRect();C=e-a.left;L=r-a.top;if(k){var i=U(v,w,k);C+=b+i[0];L+=_+i[1]}switch(n){case"zoom":if(k){E.moveFn=it}else{E.moveFn=rt}E.doneFn=ot;Q(t,e,r);break;case"select":case"lasso":g(t,e,r,E,n);break}};E.clickFn=function(t,e){p.removeZoombox(s);if(t===2){var n={};for(var a in r.viewInitial){n[r.id+"."+a]=r.viewInitial[a]}s.emit("plotly_doubleclick",null);i.call("relayout",s,n)}d.click(s,e,r.id)};T.onmousemove=function(t){d.hover(s,t,r.id);s._fullLayout._lasthover=T;s._fullLayout._hoversubplot=r.id};T.onmouseout=function(t){if(s._dragging)return;h.unhover(s,t)};h.init(E)};C.updateRadialDrag=function(t,e){var r=this;var a=r.gd;var s=r.layers;var l=r.radius;var u=r.cx;var f=r.cy;var d=r.radialAxis;var v=e.radialaxis;var g=w(r.radialAxisAngle);var y=d.range.slice();var x=y[1]-y[0];var b=S.radialDragBoxSize;var _=b/2;if(!v.visible)return;var M=p.makeRectDragger(s,"radialdrag","crosshair",-_,-_,b,b);var A={element:M,gd:a};var T=u+(l+_)*Math.cos(g);var E=f-(l+_)*Math.sin(g);n.select(M).attr("transform",Z(T,E));var C;var L;var I;function z(t,e){if(C){C(t,e)}else{var r=[t,-e];var n=[Math.cos(g),Math.sin(g)];var a=Math.abs(o.dot(r,n)/Math.sqrt(o.dot(r,r)));if(!isNaN(a)){C=a<.5?D:R}}}function P(){if(L!==null){i.call("relayout",a,r.id+".radialaxis.angle",L)}else if(I!==null){i.call("relayout",a,r.id+".radialaxis.range[1]",I)}}function D(t,e){var n=T+t;var a=E+e;L=Math.atan2(f-a,n-u);if(r.vangles)L=O(L,r.vangles);L=k(L);var i=Z(u,f)+$(-L);s["radial-axis"].attr("transform",i);s["radial-line"].select("line").attr("transform",i);var o=r.gd._fullLayout;var l=o[r.id];r.updateRadialAxisTitle(o,l,L)}function R(t,e){var n=o.dot([t,-e],[Math.cos(g),Math.sin(g)]);var h=y[1]-x*n/l*.75;if(x>0!==h>y[0])return;I=d.range[1]=h;c.doTicksSingle(a,r.radialAxis,true);s["radial-grid"].attr("transform",Z(u,f)).selectAll("path").attr("transform",null);var p=I-y[0];var v=r.sectorBBox;r.xaxis.range=[v[0]*p,v[2]*p];r.yaxis.range=[v[1]*p,v[3]*p];r.xaxis.setScale();r.yaxis.setScale();for(var m in r.traceHash){var b=r.traceHash[m];var _=o.filterVisible(b);var w=b[0][0].trace._module;var k=a._fullLayout[r.id];w.plot(a,r,_,k);if(!i.traceIs(m,"gl")){for(var M=0;M<_.length;M++){w.style(a,_[M])}}}}A.prepFn=function(){C=null;L=null;I=null;A.moveFn=z;A.doneFn=P;m(t._zoomlayer)};A.clampFn=function(t,e){if(Math.sqrt(t*t+e*e)<S.MINDRAG){t=0;e=0}return[t,e]};h.init(A)};C.updateAngularDrag=function(t,e){var r=this;var a=r.gd;var s=r.layers;var u=r.radius;var f=r.cx;var d=r.cy;var v=r.cxx;var g=r.cyy;var x=e.sector;var b=S.angularDragBoxSize;var _=p.makeDragger(s,"path","angulardrag","move");var M={element:_,gd:a};var E;if(r.vangles){var C=q(V(u+b,x,r.vangles));var L=q(V(u,x,r.vangles));E="M"+C.reverse().join("L")+"M"+L.join("L")}else{E=W(u,u+b,x)}n.select(_).attr("d",E).attr("transform",Z(f,d)).call(y,"move");function I(t,e){return Math.atan2(g+b-e,t-v-b)}var z=s.frontplot.select(".scatterlayer").selectAll(".trace");var P=z.selectAll(".point");var O=z.selectAll(".textpoint");var D,R;var B,F;var N;var j;var U;function H(t,e){var u=r.gd._fullLayout;var h=u[r.id];var p=D+t;var m=R+e;var y=I(p,m);var b=k(y-U);F=B+b;s.frontplot.attr("transform",Z(r.xOffset2,r.yOffset2)+$([-b,v,g]));if(r.vangles){N=r.radialAxisAngle+b;var _=Z(f,d)+$(-b);var M=Z(f,d)+$(-N);s.bg.attr("transform",_);s["radial-grid"].attr("transform",_);s["angular-line"].select("path").attr("transform",_);s["radial-axis"].attr("transform",M);s["radial-line"].select("line").attr("transform",M);r.updateRadialAxisTitle(u,h,N)}else{r.clipPaths.forTraces.select("path").attr("transform",Z(v,g)+$(b))}P.each(function(){var t=n.select(this);var e=l.getTranslate(t);t.attr("transform",Z(e.x,e.y)+$([b]))});O.each(function(){var t=n.select(this);var e=t.select("text");var r=l.getTranslate(t);t.attr("transform",$([b,e.attr("x"),e.attr("y")])+Z(r.x,r.y))});var S=r.angularAxis;S.rotation=A(F);if(S.type==="linear"&&!Y(x)){S.range=j.map(w).map(S.unTransformRad).map(k)}T(S);c.doTicksSingle(a,S,true);if(r._hasClipOnAxisFalse&&!Y(x)){r.sector=[j[0]-b,j[1]-b];z.call(l.hideOutsideRangePoints,r)}for(var E in r.traceHash){if(i.traceIs(E,"gl")){var C=r.traceHash[E];var L=o.filterVisible(C);var V=C[0][0].trace._module;V.plot(a,r,L,h)}}}function G(){O.select("text").attr("transform",null);var t={};t[r.id+".angularaxis.rotation"]=F;if(r.vangles){t[r.id+".radialaxis.angle"]=N}i.call("relayout",a,t)}M.prepFn=function(e,n,a){var i=t[r.id];j=i.sector.slice();B=i.angularaxis.rotation;var o=_.getBoundingClientRect();D=n-o.left;R=a-o.top;U=I(D,R);M.moveFn=H;M.doneFn=G;m(t._zoomlayer)};if(r.vangles&&!Y(x)){M.prepFn=o.noop;y(n.select(_),null)}h.init(M)};C.isPtWithinSector=function(t){var e=this.sector;if(!P(t.rad,e)){return false}var r=this.vangles;var n=this.radialAxis;var a=n.range;var i=n.c2r(t.r);var o,s;if(a[1]>=a[0]){o=a[0];s=a[1]}else{o=a[1];s=a[0]}if(r){var l=x(V(o,e,r));var u=x(V(s,e,r));var c=[i*Math.cos(t.rad),i*Math.sin(t.rad)];return u.contains(c)&&!l.contains(c)}return i>=o&&i<=s};C.fillViewInitialKey=function(t,e){if(!(t in this.viewInitial)){this.viewInitial[t]=e}};function L(t,e,r){c.setConvert(t,r);t._min=e._min;t._max=e._max;t.setScale()}function I(t){var e=t.ticks+String(t.ticklen)+String(t.showticklabels);if("side"in t)e+=t.side;return e}function z(t){var e=t[0];var r=t[1];var n=r-e;var a=M(e);var i=a+n;var o=Math.cos(w(a));var s=Math.sin(w(a));var l=Math.cos(w(i));var u=Math.sin(w(i));var c,f,h,p;if(a<=90&&i>=90||a>90&&i>=450){p=1}else if(s<=0&&u<=0){p=0}else{p=Math.max(s,u)}if(a<=180&&i>=180||a>180&&i>=540){c=-1}else if(o>=0&&l>=0){c=0}else{c=Math.min(o,l)}if(a<=270&&i>=270||a>270&&i>=630){f=-1}else if(s>=0&&u>=0){f=0}else{f=Math.min(s,u)}if(i>=360){h=1}else if(o<=0&&l<=0){h=0}else{h=Math.max(o,l)}return[c,f,h,p]}function P(t,e){if(Y(e))return true;var r=M(e[0]);var n=M(e[1]);if(r>n)n+=360;var a=M(k(t));var i=a+360;return a>=r&&a<=n||i>=r&&i<=n}function O(t,e){function r(e){return Math.abs(D(t,e))}var n=R(e,r);return e[n]}function D(t,e){var r=e-t;return Math.atan2(Math.sin(r),Math.cos(r))}function R(t,e){e=e||o.identity;var r=Infinity;var n;for(var a=0;a<t.length;a++){var i=e(t[a]);if(i<r){r=i;n=a}}return n}function B(t,e,r,n){var a,i;var o=n[0];var s=n[1];var l=J(Math.sin(e)-Math.sin(t));var u=J(Math.cos(e)-Math.cos(t));var c=Math.tan(r);var f=J(1/c);var h=l/u;var p=s-h*o;if(f){if(l&&u){a=p/(c-h);i=c*a}else if(u){a=s*f;i=s}else{a=o;i=o*c}}else{if(l&&u){a=0;i=p}else if(u){a=0;i=s}else{a=i=NaN}}return[a,i]}function F(t,e,r,n){var a=-e*r;var i=e*e+1;var o=2*(e*a-r);var s=a*a+r*r-t*t;var l=Math.sqrt(o*o-4*i*s);var u=(-o+l)/(2*i);var c=(-o-l)/(2*i);return[[u,e*u+a+n],[c,e*c+a+n]]}function N(t,e){var r=e.length;var n=new Array(r+1);var a;for(a=0;a<r;a++){var i=e[a];n[a]=[t*Math.cos(i),t*Math.sin(i)]}n[a]=n[0].slice();return n}function j(t,e,r){var n=r.length;var a=[];var i,s;function l(e){return[t*Math.cos(e),t*Math.sin(e)]}function u(t,e,r){return B(t,e,r,l(t))}function c(t){return o.mod(t,n)}var f=w(e[0]);var h=w(e[1]);var p=R(r,function(t){return P(t,e)?Math.abs(D(t,f)):Infinity});var d=u(r[p],r[c(p-1)],f);a.push(d);for(i=p,s=0;s<n;i++,s++){var v=r[c(i)];if(!P(v,e))break;a.push(l(v))}var g=R(r,function(t){return P(t,e)?Math.abs(D(t,h)):Infinity});var m=u(r[g],r[c(g+1)],h);a.push(m);a.push([0,0]);a.push(a[0].slice());return a}function V(t,e,r){return Y(e)?N(t,r):j(t,e,r)}function U(t,e,r){var n=Infinity;var a=Infinity;var i=V(t,e,r);for(var o=0;o<i.length;o++){var s=i[o];n=Math.min(n,s[0]);a=Math.min(a,-s[1])}return[n,a]}function q(t){var e=t.length;var r=new Array(e);for(var n=0;n<e;n++){var a=t[n];r[n]=[a[0],-a[1]]}return r}function H(t,e,r){var n;if(r){n="M"+q(V(t,e,r)).join("L")}else if(Y(e)){n=l.symbolFuncs[0](t)}else{var a=Math.abs(e[1]-e[0]);var i=a<=180?[0,0,0]:[0,1,0];var o=t*Math.cos(w(e[0]));var s=-t*Math.sin(w(e[0]));var u=t*Math.cos(w(e[1]));var c=-t*Math.sin(w(e[1]));n="M"+[o,s]+"A"+[t,t]+" "+i+" "+[u,c]}return n}function G(t,e,r){var n=H(t,e,r);if(Y(e)||r)return n;return n+"L0,0Z"}function W(t,e,r){var n=Math.abs(r[1]-r[0])<=180?0:1;var a,i,o;function s(t,e){return[t*Math.cos(e),-t*Math.sin(e)]}function l(t,e,r){return"A"+[t,t]+" "+[0,n,r]+" "+s(t,e)}if(Y(r)){a=0;o=2*Math.PI;i=Math.PI;return"M"+s(t,a)+l(t,i,0)+l(t,o,0)+"Z"+"M"+s(e,a)+l(e,i,1)+l(e,o,1)+"Z"}else{a=w(r[0]);o=w(r[1]);return"M"+s(t,a)+"L"+s(e,a)+l(e,o,0)+"L"+s(t,o)+l(t,a,1)+"Z"}}function Y(t){var e=Math.abs(t[1]-t[0]);return e===360}function X(t,e,r){if(e){t.attr("display",null);t.attr(r)}else if(t){t.attr("display","none")}return t}function Z(t,e){return"translate("+t+","+e+")"}function $(t){return"rotate("+t+")"}function J(t){return Math.abs(t)>1e-10?t:0}function K(t){return Math.abs(t)<1e-10?0:t>0?1:-1}function Q(t){return K(Math.cos(t))}function tt(t){return K(Math.sin(t))}},{"../../components/color":558,"../../components/dragelement":580,"../../components/drawing":583,"../../components/fx":600,"../../components/titles":649,"../../constants/alignment":656,"../../lib":684,"../../lib/polygon":696,"../../lib/setcursor":704,"../../registry":817,"../cartesian/autorange":731,"../cartesian/axes":732,"../cartesian/dragbox":740,"../cartesian/select":749,"../plots":795,"./constants":796,"./helpers":797,d3:147,tinycolor2:499}],808:[function(t,e,r){"use strict";function n(t,e){if(t==="splom")return-1;if(e==="splom")return 1;return 0}function a(t,e){return n(t.name,e.name)}e.exports={sortBasePlotModules:a,sortModules:n}},{}],809:[function(t,e,r){"use strict";var n=t("../lib");var a=t("../plot_api/plot_template");var i=t("./domain").defaults;e.exports=function t(e,r,o,s){var l=s.type;var u=s.attributes;var c=s.handleDefaults;var f=s.partition||"x";var h=r._subplots[l];var p=h.length;var d=p&&h[0].replace(/\d+$/,"");var v,g;function m(t,e){return n.coerce(v,g,u,t,e)}for(var y=0;y<p;y++){var x=h[y];if(e[x])v=e[x];else v=e[x]={};g=a.newContainer(r,x,d);var b={};b[f]=[y/p,(y+1)/p];i(g,r,m,b);s.id=x;c(v,g,m,s)}}},{"../lib":684,"../plot_api/plot_template":722,"./domain":757}],810:[function(t,e,r){"use strict";var n=t("./ternary");var a=t("../../plots/get_data").getSubplotCalcData;var i=t("../../lib").counterRegex;var o="ternary";r.name=o;r.attr="subplot";r.idRoot=o;r.idRegex=r.attrRegex=i(o);r.attributes=t("./layout/attributes");r.layoutAttributes=t("./layout/layout_attributes");r.supplyLayoutDefaults=t("./layout/defaults");r.plot=function t(e){var r=e._fullLayout;var i=e.calcdata;var s=r._subplots[o];for(var l=0;l<s.length;l++){var u=s[l],c=a(i,o,u),f=r[u]._subplot;if(!f){f=new n({id:u,graphDiv:e,container:r._ternarylayer.node()},r);r[u]._subplot=f}f.plot(c,r,e._promises)}};r.clean=function(t,e,r,n){var a=n._subplots[o]||[];for(var i=0;i<a.length;i++){var s=a[i];var l=n[s]._subplot;if(!e[s]&&!!l){l.plotContainer.remove();l.clipDef.remove();l.clipDefRelative.remove();l.layers["a-title"].remove();l.layers["b-title"].remove();l.layers["c-title"].remove()}}}},{"../../lib":684,"../../plots/get_data":768,"./layout/attributes":811,"./layout/defaults":814,"./layout/layout_attributes":815,"./ternary":816}],811:[function(t,e,r){"use strict";e.exports={subplot:{valType:"subplotid",dflt:"ternary",editType:"calc"}}},{}],812:[function(t,e,r){"use strict";var n=t("../../cartesian/layout_attributes");var a=t("../../../lib/extend").extendFlat;e.exports={title:n.title,titlefont:n.titlefont,color:n.color,tickmode:n.tickmode,nticks:a({},n.nticks,{dflt:6,min:1}),tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:n.ticks,ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,showticklabels:n.showticklabels,showtickprefix:n.showtickprefix,tickprefix:n.tickprefix,showticksuffix:n.showticksuffix,ticksuffix:n.ticksuffix,showexponent:n.showexponent,exponentformat:n.exponentformat,separatethousands:n.separatethousands,tickfont:n.tickfont,tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,hoverformat:n.hoverformat,showline:a({},n.showline,{dflt:true}),linecolor:n.linecolor,linewidth:n.linewidth,showgrid:a({},n.showgrid,{dflt:true}),gridcolor:n.gridcolor,gridwidth:n.gridwidth,layer:n.layer,min:{valType:"number",dflt:0,min:0}}},{"../../../lib/extend":673,"../../cartesian/layout_attributes":744}],813:[function(t,e,r){"use strict";var n=t("../../../lib");var a=t("./axis_attributes");var i=t("../../cartesian/tick_label_defaults");var o=t("../../cartesian/tick_mark_defaults");var s=t("../../cartesian/tick_value_defaults");var l=t("../../cartesian/line_grid_defaults");e.exports=function t(e,r,u){function c(t,i){return n.coerce(e,r,a,t,i)}r.type="linear";var f=c("color");var h=f!==a.color.dflt?f:u.font.color;var p=r._name,d=p.charAt(0).toUpperCase(),v="Component "+d;var g=c("title",v);r._hovertitle=g===v?g:d;n.coerceFont(c,"titlefont",{family:u.font.family,size:Math.round(u.font.size*1.2),color:h});c("min");s(e,r,c,"linear");i(e,r,c,"linear",{});o(e,r,c,{outerTicks:true});var m=c("showticklabels");if(m){n.coerceFont(c,"tickfont",{family:u.font.family,size:u.font.size,color:h});c("tickangle");c("tickformat")}l(e,r,c,{dfltColor:f,bgColor:u.bgColor,blend:60,showLine:true,showGrid:true,noZeroLine:true,attributes:a});c("hoverformat");c("layer")}},{"../../../lib":684,"../../cartesian/line_grid_defaults":746,"../../cartesian/tick_label_defaults":751,"../../cartesian/tick_mark_defaults":752,"../../cartesian/tick_value_defaults":753,"./axis_attributes":812}],814:[function(t,e,r){"use strict";var n=t("../../../components/color");var a=t("../../../plot_api/plot_template");var i=t("../../subplot_defaults");var o=t("./layout_attributes");var s=t("./axis_defaults");var l=["aaxis","baxis","caxis"];e.exports=function t(e,r,n){i(e,r,n,{type:"ternary",attributes:o,handleDefaults:u,font:r.font,paper_bgcolor:r.paper_bgcolor})};function u(t,e,r,i){var o=r("bgcolor");var u=r("sum");i.bgColor=n.combine(o,i.paper_bgcolor);var c,f,h;for(var p=0;p<l.length;p++){c=l[p];f=t[c]||{};h=a.newContainer(e,c);h._name=c;s(f,h,i)}var d=e.aaxis,v=e.baxis,g=e.caxis;if(d.min+v.min+g.min>=u){d.min=0;v.min=0;g.min=0;if(t.aaxis)delete t.aaxis.min;if(t.baxis)delete t.baxis.min;if(t.caxis)delete t.caxis.min}}},{"../../../components/color":558,"../../../plot_api/plot_template":722,"../../subplot_defaults":809,"./axis_defaults":813,"./layout_attributes":815}],815:[function(t,e,r){"use strict";var n=t("../../../components/color/attributes");var a=t("../../domain").attributes;var i=t("./axis_attributes");var o=t("../../../plot_api/edit_types").overrideAll;e.exports=o({domain:a({name:"ternary"}),bgcolor:{valType:"color",dflt:n.background},sum:{valType:"number",dflt:1,min:0},aaxis:i,baxis:i,caxis:i},"plot","from-root")},{"../../../components/color/attributes":557,"../../../plot_api/edit_types":715,"../../domain":757,"./axis_attributes":812}],816:[function(t,e,r){"use strict";var n=t("d3");var a=t("tinycolor2");var i=t("../../registry");var o=t("../../lib");var s=o._;var l=t("../../components/color");var u=t("../../components/drawing");var c=t("../cartesian/set_convert");var f=t("../../lib/extend").extendFlat;var h=t("../plots");var p=t("../cartesian/axes");var d=t("../../components/dragelement");var v=t("../../components/fx");var g=t("../../components/titles");var m=t("../cartesian/select").prepSelect;var y=t("../cartesian/select").clearSelect;var x=t("../cartesian/constants");function b(t,e){this.id=t.id;this.graphDiv=t.graphDiv;this.init(e);this.makeFramework(e)}e.exports=b;var _=b.prototype;_.init=function(t){this.container=t._ternarylayer;this.defs=t._defs;this.layoutId=t._uid;this.traceHash={};this.layers={}};_.plot=function(t,e){var r=this;var n=e[r.id];var a=e._size;r._hasClipOnAxisFalse=false;for(var i=0;i<t.length;i++){var o=t[i][0].trace;if(o.cliponaxis===false){r._hasClipOnAxisFalse=true;break}}r.updateLayers(n);r.adjustLayout(n,a);h.generalUpdatePerTraceModule(r.graphDiv,r,t,n);r.layers.plotbg.select("path").call(l.fill,n.bgcolor)};_.makeFramework=function(t){var e=this;var r=t[e.id];var n=e.clipId="clip"+e.layoutId+e.id;var a=e.clipIdRelative="clip-relative"+e.layoutId+e.id;e.clipDef=o.ensureSingleById(t._clips,"clipPath",n,function(t){t.append("path").attr("d","M0,0Z")});e.clipDefRelative=o.ensureSingleById(t._clips,"clipPath",a,function(t){t.append("path").attr("d","M0,0Z")});e.plotContainer=o.ensureSingle(e.container,"g",e.id);e.updateLayers(r);u.setClipUrl(e.layers.backplot,n);u.setClipUrl(e.layers.grids,n)};_.updateLayers=function(t){var e=this;var r=e.layers;var a=["draglayer","plotbg","backplot","grids"];if(t.aaxis.layer==="below traces"){a.push("aaxis","aline")}if(t.baxis.layer==="below traces"){a.push("baxis","bline")}if(t.caxis.layer==="below traces"){a.push("caxis","cline")}a.push("frontplot");if(t.aaxis.layer==="above traces"){a.push("aaxis","aline")}if(t.baxis.layer==="above traces"){a.push("baxis","bline")}if(t.caxis.layer==="above traces"){a.push("caxis","cline")}var i=e.plotContainer.selectAll("g.toplevel").data(a,String);var o=["agrid","bgrid","cgrid"];i.enter().append("g").attr("class",function(t){return"toplevel "+t}).each(function(t){var e=n.select(this);r[t]=e;if(t==="frontplot"){e.append("g").classed("scatterlayer",true)}else if(t==="backplot"){e.append("g").classed("maplayer",true)}else if(t==="plotbg"){e.append("path").attr("d","M0,0Z")}else if(t==="aline"||t==="bline"||t==="cline"){e.append("path")}else if(t==="grids"){o.forEach(function(t){r[t]=e.append("g").classed("grid "+t,true);var n=t==="bgrid"?"x":"y";r[t].append("g").classed(n,true)})}});i.order()};var w=Math.sqrt(4/3);_.adjustLayout=function(t,e){var r=this,n=t.domain,a=(n.x[0]+n.x[1])/2,i=(n.y[0]+n.y[1])/2,o=n.x[1]-n.x[0],s=n.y[1]-n.y[0],h=o*e.w,p=s*e.h,d=t.sum,v=t.aaxis.min,g=t.baxis.min,m=t.caxis.min;var y,x,b,_,k,M;if(h>w*p){_=p;b=_*w}else{b=h;_=b/w}k=o*b/h;M=s*_/p;y=e.l+e.w*a-b/2;x=e.t+e.h*(1-i)-_/2;r.x0=y;r.y0=x;r.w=b;r.h=_;r.sum=d;r.xaxis={type:"linear",range:[v+2*m-d,d-v-2*g],domain:[a-k/2,a+k/2],_id:"x"};c(r.xaxis,r.graphDiv._fullLayout);r.xaxis.setScale();r.xaxis.isPtWithinRange=function(t){return t.a>=r.aaxis.range[0]&&t.a<=r.aaxis.range[1]&&t.b>=r.baxis.range[1]&&t.b<=r.baxis.range[0]&&t.c>=r.caxis.range[1]&&t.c<=r.caxis.range[0]};r.yaxis={type:"linear",range:[v,d-g-m],domain:[i-M/2,i+M/2],_id:"y"};c(r.yaxis,r.graphDiv._fullLayout);r.yaxis.setScale();r.yaxis.isPtWithinRange=function(){return true};var A=r.yaxis.domain[0];var T=r.aaxis=f({},t.aaxis,{visible:true,range:[v,d-g-m],side:"left",_counterangle:30,tickangle:(+t.aaxis.tickangle||0)-30,domain:[A,A+M*w],_axislayer:r.layers.aaxis,_gridlayer:r.layers.agrid,_pos:0,_id:"y",_length:b,_gridpath:"M0,0l"+_+",-"+b/2,automargin:false});c(T,r.graphDiv._fullLayout);T.setScale();var S=r.baxis=f({},t.baxis,{visible:true,range:[d-v-m,g],side:"bottom",_counterangle:30,domain:r.xaxis.domain,_axislayer:r.layers.baxis,_gridlayer:r.layers.bgrid,_counteraxis:r.aaxis,_pos:0,_id:"x",_length:b,_gridpath:"M0,0l-"+b/2+",-"+_,automargin:false});c(S,r.graphDiv._fullLayout);S.setScale();T._counteraxis=S;var E=r.caxis=f({},t.caxis,{visible:true,range:[d-v-g,m],side:"right",_counterangle:30,tickangle:(+t.caxis.tickangle||0)+30,domain:[A,A+M*w],_axislayer:r.layers.caxis,_gridlayer:r.layers.cgrid,_counteraxis:r.baxis,_pos:0,_id:"y",_length:b,_gridpath:"M0,0l-"+_+","+b/2,automargin:false});c(E,r.graphDiv._fullLayout);E.setScale();var C="M"+y+","+(x+_)+"h"+b+"l-"+b/2+",-"+_+"Z";r.clipDef.select("path").attr("d",C);r.layers.plotbg.select("path").attr("d",C);var L="M0,"+_+"h"+b+"l-"+b/2+",-"+_+"Z";r.clipDefRelative.select("path").attr("d",L);var I="translate("+y+","+x+")";r.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",I);r.clipDefRelative.select("path").attr("transform",null);var z="translate("+(y-S._offset)+","+(x+_)+")";r.layers.baxis.attr("transform",z);r.layers.bgrid.attr("transform",z);var P="translate("+(y+b/2)+","+x+")rotate(30)translate(0,"+-T._offset+")";r.layers.aaxis.attr("transform",P);r.layers.agrid.attr("transform",P);var O="translate("+(y+b/2)+","+x+")rotate(-30)translate(0,"+-E._offset+")";r.layers.caxis.attr("transform",O);r.layers.cgrid.attr("transform",O);r.drawAxes(true);r.plotContainer.selectAll(".crisp").classed("crisp",false);r.layers.aline.select("path").attr("d",T.showline?"M"+y+","+(x+_)+"l"+b/2+",-"+_:"M0,0").call(l.stroke,T.linecolor||"#000").style("stroke-width",(T.linewidth||0)+"px");r.layers.bline.select("path").attr("d",S.showline?"M"+y+","+(x+_)+"h"+b:"M0,0").call(l.stroke,S.linecolor||"#000").style("stroke-width",(S.linewidth||0)+"px");r.layers.cline.select("path").attr("d",E.showline?"M"+(y+b/2)+","+x+"l"+b/2+","+_:"M0,0").call(l.stroke,E.linecolor||"#000").style("stroke-width",(E.linewidth||0)+"px");if(!r.graphDiv._context.staticPlot){r.initInteractions()}u.setClipUrl(r.layers.frontplot,r._hasClipOnAxisFalse?null:r.clipId)};_.drawAxes=function(t){var e=this,r=e.graphDiv,n=e.id.substr(7)+"title",a=e.aaxis,i=e.baxis,o=e.caxis;p.doTicksSingle(r,a,true);p.doTicksSingle(r,i,true);p.doTicksSingle(r,o,true);if(t){var l=Math.max(a.showticklabels?a.tickfont.size/2:0,(o.showticklabels?o.tickfont.size*.75:0)+(o.ticks==="outside"?o.ticklen*.87:0));e.layers["a-title"]=g.draw(r,"a"+n,{propContainer:a,propName:e.id+".aaxis.title",placeholder:s(r,"Click to enter Component A title"),attributes:{x:e.x0+e.w/2,y:e.y0-a.titlefont.size/3-l,"text-anchor":"middle"}});var u=(i.showticklabels?i.tickfont.size:0)+(i.ticks==="outside"?i.ticklen:0)+3;e.layers["b-title"]=g.draw(r,"b"+n,{propContainer:i,propName:e.id+".baxis.title",placeholder:s(r,"Click to enter Component B title"),attributes:{x:e.x0-u,y:e.y0+e.h+i.titlefont.size*.83+u,"text-anchor":"middle"}});e.layers["c-title"]=g.draw(r,"c"+n,{propContainer:o,propName:e.id+".caxis.title",placeholder:s(r,"Click to enter Component C title"),attributes:{x:e.x0+e.w+u,y:e.y0+e.h+o.titlefont.size*.83+u,"text-anchor":"middle"}})}};var k=x.MINZOOM/2+.87;var M="m-0.87,.5h"+k+"v3h-"+(k+5.2)+"l"+(k/2+2.6)+",-"+(k*.87+4.5)+"l2.6,1.5l-"+k/2+","+k*.87+"Z";var A="m0.87,.5h-"+k+"v3h"+(k+5.2)+"l-"+(k/2+2.6)+",-"+(k*.87+4.5)+"l-2.6,1.5l"+k/2+","+k*.87+"Z";var T="m0,1l"+k/2+","+k*.87+"l2.6,-1.5l-"+(k/2+2.6)+",-"+(k*.87+4.5)+"l-"+(k/2+2.6)+","+(k*.87+4.5)+"l2.6,1.5l"+k/2+",-"+k*.87+"Z";var S="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z";var E=true;_.initInteractions=function(){var t=this,e=t.layers.plotbg.select("path").node(),r=t.graphDiv,n=r._fullLayout._zoomlayer;var c={element:e,gd:r,plotinfo:{xaxis:t.xaxis,yaxis:t.yaxis},subplot:t.id,prepFn:function(e,a,i){c.xaxes=[t.xaxis];c.yaxes=[t.yaxis];var o=r._fullLayout.dragmode;if(e.shiftKey){if(o==="pan")o="zoom";else o="pan"}if(o==="lasso")c.minDrag=1;else c.minDrag=undefined;if(o==="zoom"){c.moveFn=B;c.doneFn=F;P(e,a,i)}else if(o==="pan"){c.moveFn=j;c.doneFn=V;N();y(n)}else if(o==="select"||o==="lasso"){m(e,a,i,c,o)}},clickFn:function(e,n){C(r);if(e===2){var a={};a[t.id+".aaxis.min"]=0;a[t.id+".baxis.min"]=0;a[t.id+".caxis.min"]=0;r.emit("plotly_doubleclick",null);i.call("relayout",r,a)}v.click(r,n,t.id)}};var f,h,p,g,b,_,k,L,I,z;function P(r,i,o){var s=e.getBoundingClientRect();f=i-s.left;h=o-s.top;p={a:t.aaxis.range[0],b:t.baxis.range[1],c:t.caxis.range[1]};b=p;g=t.aaxis.range[1]-p.a;_=a(t.graphDiv._fullLayout[t.id].bgcolor).getLuminance();k="M0,"+t.h+"L"+t.w/2+", 0L"+t.w+","+t.h+"Z";L=false;I=n.append("path").attr("class","zoombox").attr("transform","translate("+t.x0+", "+t.y0+")").style({fill:_>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",k);z=n.append("path").attr("class","zoombox-corners").attr("transform","translate("+t.x0+", "+t.y0+")").style({fill:l.background,stroke:l.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z");y(n)}function O(e,r){return 1-r/t.h}function D(e,r){return 1-(e+(t.h-r)/Math.sqrt(3))/t.w}function R(e,r){return(e-(t.h-r)/Math.sqrt(3))/t.w}function B(e,r){var n=f+e,a=h+r,i=Math.max(0,Math.min(1,O(f,h),O(n,a))),o=Math.max(0,Math.min(1,D(f,h),D(n,a))),s=Math.max(0,Math.min(1,R(f,h),R(n,a))),l=(i/2+s)*t.w,u=(1-i/2-o)*t.w,c=(l+u)/2,d=u-l,v=(1-i)*t.h,m=v-d/w;if(d<x.MINZOOM){b=p;I.attr("d",k);z.attr("d","M0,0Z")}else{b={a:p.a+i*g,b:p.b+o*g,c:p.c+s*g};I.attr("d",k+"M"+l+","+v+"H"+u+"L"+c+","+m+"L"+l+","+v+"Z");z.attr("d","M"+f+","+h+S+"M"+l+","+v+M+"M"+u+","+v+A+"M"+c+","+m+T)}if(!L){I.transition().style("fill",_>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200);z.transition().style("opacity",1).duration(200);L=true}}function F(){C(r);if(b===p)return;var e={};e[t.id+".aaxis.min"]=b.a;e[t.id+".baxis.min"]=b.b;e[t.id+".caxis.min"]=b.c;i.call("relayout",r,e);if(E&&r.data&&r._context.showTips){o.notifier(s(r,"Double-click to zoom back out"),"long");E=false}}function N(){p={a:t.aaxis.range[0],b:t.baxis.range[1],c:t.caxis.range[1]};b=p}function j(e,r){var n=e/t.xaxis._m,a=r/t.yaxis._m;b={a:p.a-a,b:p.b+(n+a)/2,c:p.c-(n-a)/2};var i=[b.a,b.b,b.c].sort(),o={a:i.indexOf(b.a),b:i.indexOf(b.b),c:i.indexOf(b.c)};if(i[0]<0){if(i[1]+i[0]/2<0){i[2]+=i[0]+i[1];i[0]=i[1]=0}else{i[2]+=i[0]/2;i[1]+=i[0]/2;i[0]=0}b={a:i[o.a],b:i[o.b],c:i[o.c]};r=(p.a-b.a)*t.yaxis._m;e=(p.c-b.c-p.b+b.b)*t.xaxis._m}var s="translate("+(t.x0+e)+","+(t.y0+r)+")";t.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",s);var l="translate("+-e+","+-r+")";t.clipDefRelative.select("path").attr("transform",l);t.aaxis.range=[b.a,t.sum-b.b-b.c];t.baxis.range=[t.sum-b.a-b.c,b.b];t.caxis.range=[t.sum-b.a-b.b,b.c];t.drawAxes(false);t.plotContainer.selectAll(".crisp").classed("crisp",false);if(t._hasClipOnAxisFalse){t.plotContainer.select(".scatterlayer").selectAll(".trace").call(u.hideOutsideRangePoints,t)}}function V(){var e={};e[t.id+".aaxis.min"]=b.a;e[t.id+".baxis.min"]=b.b;e[t.id+".caxis.min"]=b.c;i.call("relayout",r,e)}e.onmousemove=function(n){v.hover(r,n,t.id);r._fullLayout._lasthover=e;r._fullLayout._hoversubplot=t.id};e.onmouseout=function(t){if(r._dragging)return;d.unhover(r,t)};d.init(c)};function C(t){n.select(t).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}},{"../../components/color":558,"../../components/dragelement":580,"../../components/drawing":583,"../../components/fx":600,"../../components/titles":649,"../../lib":684,"../../lib/extend":673,"../../registry":817,"../cartesian/axes":732,"../cartesian/constants":737,"../cartesian/select":749,"../cartesian/set_convert":750,"../plots":795,d3:147,tinycolor2:499}],817:[function(t,e,r){"use strict";var n=t("./lib/loggers");var a=t("./lib/noop");var i=t("./lib/push_unique");var o=t("./lib/is_plain_object");var s=t("./lib/extend");var l=t("./plots/attributes");var u=t("./plots/layout_attributes");var c=s.extendFlat;var f=s.extendDeepAll;r.modules={};r.allCategories={};r.allTypes=[];r.subplotsRegistry={};r.transformsRegistry={};r.componentsRegistry={};r.layoutArrayContainers=[];r.layoutArrayRegexes=[];r.traceLayoutAttributes={};r.localeRegistry={};r.apiMethodRegistry={};r.register=function t(e){if(!e){throw new Error("No argument passed to Plotly.register.")}else if(e&&!Array.isArray(e)){e=[e]}for(var n=0;n<e.length;n++){var a=e[n];if(!a){throw new Error("Invalid module was attempted to be registered!")}switch(a.moduleType){case"trace":h(a);break;case"transform":v(a);break;case"component":d(a);break;case"locale":g(a);break;case"apiMethod":var i=a.name;r.apiMethodRegistry[i]=a.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}};r.getModule=function(t){var e=r.modules[_(t)];if(!e)return false;return e._module};r.traceIs=function(t,e){t=_(t);if(t==="various")return false;var a=r.modules[t];if(!a){if(t&&t!=="area"){n.log("Unrecognized trace type "+t+".")}a=r.modules[l.type.dflt]}return!!a.categories[e]};r.getTransformIndices=function(t,e){var r=[];var n=t.transforms||[];for(var a=0;a<n.length;a++){if(n[a].type===e){r.push(a)}}return r};r.hasTransform=function(t,e){var r=t.transforms||[];for(var n=0;n<r.length;n++){if(r[n].type===e){return true}}return false};r.getComponentMethod=function(t,e){var n=r.componentsRegistry[t];if(!n)return a;return n[e]||a};r.call=function(){var t=arguments[0];var e=[].slice.call(arguments,1);return r.apiMethodRegistry[t].apply(null,e)};function h(t){var e=t.name;var a=t.categories;var i=t.meta;if(r.modules[e]){n.log("Type "+e+" already registered");return}if(!r.subplotsRegistry[t.basePlotModule.name]){p(t.basePlotModule)}var o={};for(var s=0;s<a.length;s++){o[a[s]]=true;r.allCategories[a[s]]=true}r.modules[e]={_module:t,categories:o};if(i&&Object.keys(i).length){r.modules[e].meta=i}r.allTypes.push(e);for(var l in r.componentsRegistry){y(l,e)}if(t.layoutAttributes){c(r.traceLayoutAttributes,t.layoutAttributes)}}function p(t){var e=t.name;if(r.subplotsRegistry[e]){n.log("Plot type "+e+" already registered.");return}m(t);r.subplotsRegistry[e]=t;for(var a in r.componentsRegistry){b(a,t.name)}}function d(t){if(typeof t.name!=="string"){throw new Error("Component module *name* must be a string.")}var e=t.name;r.componentsRegistry[e]=t;if(t.layoutAttributes){if(t.layoutAttributes._isLinkedToArray){i(r.layoutArrayContainers,e)}m(t)}for(var n in r.modules){y(e,n)}for(var a in r.subplotsRegistry){b(e,a)}for(var o in r.transformsRegistry){x(e,o)}if(t.schema&&t.schema.layout){f(u,t.schema.layout)}}function v(t){if(typeof t.name!=="string"){throw new Error("Transform module *name* must be a string.")}var e="Transform module "+t.name;var a=typeof t.transform==="function";var i=typeof t.calcTransform==="function";if(!a&&!i){throw new Error(e+" is missing a *transform* or *calcTransform* method.")}if(a&&i){n.log([e+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" "))}if(!o(t.attributes)){n.log(e+" registered without an *attributes* object.")}if(typeof t.supplyDefaults!=="function"){n.log(e+" registered without a *supplyDefaults* method.")}r.transformsRegistry[t.name]=t;for(var s in r.componentsRegistry){x(s,t.name)}}function g(t){var e=t.name;var n=e.split("-")[0];var a=t.dictionary;var i=t.format;var o=a&&Object.keys(a).length;var s=i&&Object.keys(i).length;var l=r.localeRegistry;var u=l[e];if(!u)l[e]=u={};if(n!==e){var c=l[n];if(!c)l[n]=c={};if(o&&c.dictionary===u.dictionary){c.dictionary=a}if(s&&c.format===u.format){c.format=i}}if(o)u.dictionary=a;if(s)u.format=i}function m(t){if(t.layoutAttributes){var e=t.layoutAttributes._arrayAttrRegexps;if(e){for(var n=0;n<e.length;n++){i(r.layoutArrayRegexes,e[n])}}}}function y(t,e){var n=r.componentsRegistry[t].schema;if(!n||!n.traces)return;var a=n.traces[e];if(a){f(r.modules[e]._module.attributes,a)}}function x(t,e){var n=r.componentsRegistry[t].schema;if(!n||!n.transforms)return;var a=n.transforms[e];if(a){f(r.transformsRegistry[e].attributes,a)}}function b(t,e){var n=r.componentsRegistry[t].schema;if(!n||!n.subplots)return;var a=r.subplotsRegistry[e];var i=a.layoutAttributes;var o=a.attr==="subplot"?a.name:a.attr;if(Array.isArray(o))o=o[0];var s=n.subplots[o];if(i&&s){f(i,s)}}function _(t){if(typeof t==="object")t=t.type;return t}},{"./lib/extend":673,"./lib/is_plain_object":686,"./lib/loggers":689,"./lib/noop":693,"./lib/push_unique":698,"./plots/attributes":729,"./plots/layout_attributes":786}],818:[function(t,e,r){"use strict";var n=t("../lib");var a=n.extendFlat;var i=n.extendDeep;function o(t){var e;switch(t){case"themes__thumb":e={autosize:true,width:150,height:150,title:"",showlegend:false,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":e={title:"",hidesources:true,showlegend:false,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:e={}}return e}function s(t){var e=["xaxis","yaxis","zaxis"];return e.indexOf(t.slice(0,5))>-1}e.exports=function t(e,r){if(e.framework&&e.framework.isPolar){e=e.framework.getConfig()}var n;var l=e.data;var u=e.layout;var c=i([],l);var f=i({},u,o(r.tileClass));var h=e._context||{};if(r.width)f.width=r.width;if(r.height)f.height=r.height;if(r.tileClass==="thumbnail"||r.tileClass==="themes__thumb"){f.annotations=[];var p=Object.keys(f);for(n=0;n<p.length;n++){if(s(p[n])){f[p[n]].title=""}}for(n=0;n<c.length;n++){var d=c[n];d.showscale=false;if(d.marker)d.marker.showscale=false;if(d.type==="pie")d.textposition="none"}}if(Array.isArray(r.annotations)){for(n=0;n<r.annotations.length;n++){f.annotations.push(r.annotations[n])}}var v=Object.keys(f).filter(function(t){return t.match(/^scene\d*$/)});if(v.length){var g={};if(r.tileClass==="thumbnail"){g={title:"",showaxeslabels:false,showticklabels:false,linetickenable:false}}for(n=0;n<v.length;n++){var m=f[v[n]];if(!m.xaxis){m.xaxis={}}if(!m.yaxis){m.yaxis={}}if(!m.zaxis){m.zaxis={}}a(m.xaxis,g);a(m.yaxis,g);a(m.zaxis,g);m._scene=null}}var y=document.createElement("div");if(r.tileClass)y.className=r.tileClass;var x={gd:y,td:y,layout:f,data:c,config:{staticPlot:r.staticPlot===undefined?true:r.staticPlot,plotGlPixelRatio:r.plotGlPixelRatio===undefined?2:r.plotGlPixelRatio,displaylogo:r.displaylogo||false,showLink:r.showLink||false,showTips:r.showTips||false,mapboxAccessToken:h.mapboxAccessToken}};if(r.setBackground!=="transparent"){x.config.setBackground=r.setBackground||"opaque"}x.gd.defaultLayout=o(r.tileClass);return x}},{"../lib":684}],819:[function(t,e,r){"use strict";var n=t("../plot_api/to_image");var a=t("../lib");var i=t("./filesaver");function o(t,e){e=e||{};e.format=e.format||"png";return new Promise(function(r,o){if(t._snapshotInProgress){o(new Error("Snapshotting already in progress."))}if(a.isIE()&&e.format!=="svg"){o(new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."))}t._snapshotInProgress=true;var s=n(t,e);var l=e.filename||t.fn||"newplot";l+="."+e.format;s.then(function(e){t._snapshotInProgress=false;return i(e,l)}).then(function(t){r(t)}).catch(function(e){t._snapshotInProgress=false;o(e)})})}e.exports=o},{"../lib":684,"../plot_api/to_image":725,"./filesaver":820}],820:[function(t,e,r){"use strict";var n=function(t,e){var r=document.createElement("a");var n="download"in r;var a=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent);var i=new Promise(function(i,o){if(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){o(new Error("IE < 10 unsupported"))}if(a){document.location.href="data:application/octet-stream"+t.slice(t.search(/[,;]/));i(e)}if(!e){e="download"}if(n){r.href=t;r.download=e;document.body.appendChild(r);r.click();document.body.removeChild(r);i(e)}if(typeof navigator!=="undefined"&&navigator.msSaveBlob){var s=t.split(/^data:image\/svg\+xml,/)[1];var l=decodeURIComponent(s);navigator.msSaveBlob(new Blob([l]),e);i(e)}o(new Error("download error"))});return i};e.exports=n},{}],821:[function(t,e,r){"use strict";r.getDelay=function(t){if(!t._has)return 0;return t._has("gl3d")||t._has("gl2d")||t._has("mapbox")?500:0};r.getRedrawFunc=function(t){var e=t._fullLayout||{};var r=e._has&&e._has("polar");var n=!r&&t.data&&t.data[0]&&t.data[0].r;if(n)return;return function(){(t.calcdata||[]).forEach(function(t){if(t[0]&&t[0].t&&t[0].t.cb)t[0].t.cb()})}}},{}],822:[function(t,e,r){"use strict";var n=t("./helpers");var a={getDelay:n.getDelay,getRedrawFunc:n.getRedrawFunc,clone:t("./cloneplot"),toSVG:t("./tosvg"),svgToImg:t("./svgtoimg"),toImage:t("./toimage"),downloadImage:t("./download")};e.exports=a},{"./cloneplot":818,"./download":819,"./helpers":821,"./svgtoimg":823,"./toimage":824,"./tosvg":825}],823:[function(t,e,r){"use strict";var n=t("../lib");var a=t("events").EventEmitter;function i(t){var e=t.emitter||new a;var r=new Promise(function(a,i){var o=window.Image;var s=t.svg;var l=t.format||"png";if(n.isIE()&&l!=="svg"){var u=new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead.");i(u);if(!t.promise){return e.emit("error",u)}else{return r}}var c=t.canvas;var f=t.scale||1;var h=t.width||300;var p=t.height||150;var d=f*h;var v=f*p;var g=c.getContext("2d");var m=new o;var y="data:image/svg+xml,"+encodeURIComponent(s);c.width=d;c.height=v;m.onload=function(){var r;if(l!=="svg"){g.drawImage(m,0,0,d,v)}switch(l){case"jpeg":r=c.toDataURL("image/jpeg");break;case"png":r=c.toDataURL("image/png");break;case"webp":r=c.toDataURL("image/webp");break;case"svg":r=y;break;default:var n="Image format is not jpeg, png, svg or webp.";i(new Error(n));if(!t.promise){return e.emit("error",n)}}a(r);if(!t.promise){e.emit("success",r)}};m.onerror=function(r){i(r);if(!t.promise){return e.emit("error",r)}};m.src=y});if(t.promise){return r}return e}e.exports=i},{"../lib":684,events:212}],824:[function(t,e,r){"use strict";var n=t("events").EventEmitter;var a=t("../registry");var i=t("../lib");var o=t("./helpers");var s=t("./cloneplot");var l=t("./tosvg");var u=t("./svgtoimg");function c(t,e){var r=new n;var c=s(t,{format:"png"});var f=c.gd;f.style.position="absolute";f.style.left="-5000px";document.body.appendChild(f);function h(){var t=o.getDelay(f._fullLayout);setTimeout(function(){var t=l(f);var n=document.createElement("canvas");n.id=i.randstr();r=u({format:e.format,width:f._fullLayout.width,height:f._fullLayout.height,canvas:n,emitter:r,svg:t});r.clean=function(){if(f)document.body.removeChild(f)}},t)}var p=o.getRedrawFunc(f);a.call("plot",f,c.data,c.layout,c.config).then(p).then(h).catch(function(t){r.emit("error",t)});return r}e.exports=c},{"../lib":684,"../registry":817,"./cloneplot":818,"./helpers":821,"./svgtoimg":823,"./tosvg":825,events:212}],825:[function(t,e,r){"use strict";var n=t("d3");var a=t("../lib");var i=t("../components/drawing");var o=t("../components/color");var s=t("../constants/xmlns_namespaces");var l=/"/g;var u="TOBESTRIPPED";var c=new RegExp('("'+u+")|("+u+'")',"g");function f(t){var e=n.select("body").append("div").style({display:"none"}).html("");var r=t.replace(/(&[^;]*;)/gi,function(t){if(t==="&lt;"){return"&#60;"}if(t==="&rt;"){return"&#62;"}if(t.indexOf("<")!==-1||t.indexOf(">")!==-1){return""}return e.html(t).text()});e.remove();return r}function h(t){return t.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}e.exports=function t(e,r,p){var d=e._fullLayout;var v=d._paper;var g=d._toppaper;var m=d.width;var y=d.height;var x;v.insert("rect",":first-child").call(i.setRect,0,0,m,y).call(o.fill,d.paper_bgcolor);var b=d._basePlotModules||[];for(x=0;x<b.length;x++){var _=b[x];if(_.toSVG)_.toSVG(e)}if(g){var w=g.node().childNodes;var k=Array.prototype.slice.call(w);for(x=0;x<k.length;x++){var M=k[x];if(M.childNodes.length)v.node().appendChild(M)}}if(d._draggers){d._draggers.remove()}v.node().style.background="";v.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var t=n.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){t.remove();return}else{t.style({visibility:null,display:null})}var e=this.style.fontFamily;if(e&&e.indexOf('"')!==-1){t.style("font-family",e.replace(l,u))}});v.selectAll(".point,.scatterpts").each(function(){var t=n.select(this);var e=this.style.fill;if(e&&e.indexOf("url(")!==-1){t.style("fill",e.replace(l,u))}});if(r==="pdf"||r==="eps"){v.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0)}v.node().setAttributeNS(s.xmlns,"xmlns",s.svg);v.node().setAttributeNS(s.xmlns,"xmlns:xlink",s.xlink);if(r==="svg"&&p){v.attr("width",p*m);v.attr("height",p*y);v.attr("viewBox","0 0 "+m+" "+y)}var A=(new window.XMLSerializer).serializeToString(v.node());A=f(A);A=h(A);A=A.replace(c,"'");if(a.isIE()){A=A.replace(/"/gi,"'");A=A.replace(/(\('#)([^']*)('\))/gi,'("#$2")');A=A.replace(/(\\')/gi,'"')}return A}},{"../components/color":558,"../components/drawing":583,"../constants/xmlns_namespaces":663,"../lib":684,d3:147}],826:[function(t,e,r){"use strict";var n=t("../../lib").mergeArray;e.exports=function t(e,r){for(var a=0;a<e.length;a++)e[a].i=a;n(r.text,e,"tx");n(r.hovertext,e,"htx");var i=r.marker;if(i){n(i.opacity,e,"mo");n(i.color,e,"mc");var o=i.line;if(o){n(o.color,e,"mlc");n(o.width,e,"mlw")}}}},{"../../lib":684}],827:[function(t,e,r){"use strict";var n=t("../scatter/attributes");var a=t("../../components/colorscale/attributes");var i=t("../../components/colorbar/attributes");var o=t("../../plots/font_attributes");var s=t("../../lib/extend").extendFlat;var l=o({editType:"calc",arrayOk:true});var u=n.marker;var c=u.line;var f=s({},c.width,{dflt:0});var h=s({width:f,editType:"calc"},a("marker.line"));var p=s({line:h,editType:"calc"},a("marker"),{colorbar:i,opacity:{valType:"number",arrayOk:true,dflt:1,min:0,max:1,editType:"style"}});e.exports={x:n.x,x0:n.x0,dx:n.dx,y:n.y,y0:n.y0,dy:n.dy,text:n.text,hovertext:n.hovertext,textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"none",arrayOk:true,editType:"calc"},textfont:s({},l,{}),insidetextfont:s({},l,{}),outsidetextfont:s({},l,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:s({},n.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:true,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:true,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:true,editType:"calc"},marker:p,selected:{marker:{opacity:n.selected.marker.opacity,color:n.selected.marker.color,editType:"style"},textfont:n.selected.textfont,editType:"style"},unselected:{marker:{opacity:n.unselected.marker.opacity,color:n.unselected.marker.color,editType:"style"},textfont:n.unselected.textfont,editType:"style"},r:n.r,t:n.t,_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../../plots/font_attributes":758,"../scatter/attributes":1015}],828:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib").isArrayOrTypedArray;var i=t("../../plots/cartesian/axes");var o=t("../../components/colorscale/has_colorscale");var s=t("../../components/colorscale/calc");var l=t("./arrays_to_calcdata");var u=t("../scatter/calc_selection");e.exports=function t(e,r){var c=i.getFromId(e,r.xaxis||"x"),f=i.getFromId(e,r.yaxis||"y"),h=r.orientation||(r.x&&!r.y?"h":"v"),p,d,v,g,m;if(h==="h"){p=c;v=c.makeCalcdata(r,"x");d=f.makeCalcdata(r,"y");m=r.xcalendar}else{p=f;v=f.makeCalcdata(r,"y");d=c.makeCalcdata(r,"x");m=r.ycalendar}var y=Math.min(d.length,v.length);var x=new Array(y);for(g=0;g<y;g++){x[g]={p:d[g],s:v[g]};if(r.ids){x[g].id=String(r.ids[g])}}var b=r.base,_;if(a(b)){for(g=0;g<Math.min(b.length,x.length);g++){_=p.d2c(b[g],0,m);if(n(_)){x[g].b=+_;x[g].hasB=1}else x[g].b=0}for(;g<x.length;g++){x[g].b=0}}else{_=p.d2c(b,0,m);var w=n(_);_=w?_:0;for(g=0;g<x.length;g++){x[g].b=_;if(w)x[g].hasB=1}}if(o(r,"marker")){s(r,r.marker.color,"marker","c")}if(o(r,"marker.line")){s(r,r.marker.line.color,"marker.line","c")}l(x,r);u(x,r);return x}},{"../../components/colorscale/calc":566,"../../components/colorscale/has_colorscale":572,"../../lib":684,"../../plots/cartesian/axes":732,"../scatter/calc_selection":1017,"./arrays_to_calcdata":826,"fast-isnumeric":214}],829:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../components/color");var i=t("../../registry");var o=t("../scatter/xy_defaults");var s=t("../bar/style_defaults");var l=t("./attributes");e.exports=function t(e,r,u,c){function f(t,a){return n.coerce(e,r,l,t,a)}var h=n.coerceFont;var p=o(e,r,c,f);if(!p){r.visible=false;return}f("orientation",r.x&&!r.y?"h":"v");f("base");f("offset");f("width");f("text");f("hovertext");var d=f("textposition");var v=Array.isArray(d)||d==="auto",g=v||d==="inside",m=v||d==="outside";if(g||m){var y=h(f,"textfont",c.font);if(g)h(f,"insidetextfont",y);if(m)h(f,"outsidetextfont",y);f("constraintext");f("selected.textfont.color");f("unselected.textfont.color");f("cliponaxis")}s(e,r,f,u,c);var x=i.getComponentMethod("errorbars","supplyDefaults");x(e,r,a.defaultLine,{axis:"y"});x(e,r,a.defaultLine,{axis:"x",inherit:"y"});n.coerceSelectionMarkerOpacity(r,f)}},{"../../components/color":558,"../../lib":684,"../../registry":817,"../bar/style_defaults":839,"../scatter/xy_defaults":1039,"./attributes":827}],830:[function(t,e,r){"use strict";var n=t("../../components/fx");var a=t("../../registry");var i=t("../../components/color");var o=t("../scatter/fill_hover_text");e.exports=function t(e,r,s,l){var u=e.cd;var c=u[0].trace;var f=u[0].t;var h=l==="closest";var p=e.maxHoverDistance;var d=e.maxSpikeDistance;var v,g,m,y,x,b,_;function w(t){return t[m]-t.w/2}function k(t){return t[m]+t.w/2}var M=h?w:function(t){return Math.min(w(t),t.p-f.bardelta/2)};var A=h?k:function(t){return Math.max(k(t),t.p+f.bardelta/2)};function T(t,e){return n.inbox(t-v,e-v,p+Math.min(1,Math.abs(e-t)/_)-1)}function S(t){return T(M(t),A(t))}function E(t){return T(w(t),k(t))}function C(t){return n.inbox(t.b-g,t[y]-g,p+(t[y]-g)/(t[y]-t.b)-1)}if(c.orientation==="h"){v=s;g=r;m="y";y="x";x=C;b=S}else{v=r;g=s;m="x";y="y";b=C;x=S}var L=e[m+"a"];var I=e[y+"a"];_=Math.abs(L.r2c(L.range[1])-L.r2c(L.range[0]));function z(t){return(x(t)+b(t))/2}var P=n.getDistanceFunction(l,x,b,z);n.getClosest(u,P,e);if(e.index===false)return;if(!h){M=function(t){return Math.min(w(t),t.p-f.bargroupwidth/2)};A=function(t){return Math.max(k(t),t.p+f.bargroupwidth/2)}}var O=e.index;var D=u[O];var R=D.mcc||c.marker.color;var B=D.mlcc||c.marker.line.color;var F=D.mlw||c.marker.line.width;if(i.opacity(R))e.color=R;else if(i.opacity(B)&&F)e.color=B;var N=c.base?D.b+D.s:D.s;e[y+"0"]=e[y+"1"]=I.c2p(D[y],true);e[y+"LabelVal"]=N;var j=f.extents[f.extents.round(D.p)];e[m+"0"]=L.c2p(h?M(D):j[0],true);e[m+"1"]=L.c2p(h?A(D):j[1],true);e[m+"LabelVal"]=D.p;e.spikeDistance=(C(D)+E(D))/2+d-p;e[m+"Spike"]=L.c2p(D.p,true);o(D,c,e);a.getComponentMethod("errorbars","hoverInfo")(D,c,e);return[e]}},{"../../components/color":558,"../../components/fx":600,"../../registry":817,"../scatter/fill_hover_text":1022}],831:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.layoutAttributes=t("./layout_attributes");n.supplyDefaults=t("./defaults");n.supplyLayoutDefaults=t("./layout_defaults");n.calc=t("./calc");n.setPositions=t("./set_positions");n.colorbar=t("../scatter/marker_colorbar");n.arraysToCalcdata=t("./arrays_to_calcdata");n.plot=t("./plot");n.style=t("./style").style;n.styleOnSelect=t("./style").styleOnSelect;n.hoverPoints=t("./hover");n.selectPoints=t("./select");n.moduleType="trace";n.name="bar";n.basePlotModule=t("../../plots/cartesian");n.categories=["cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"];n.meta={};e.exports=n},{"../../plots/cartesian":743,"../scatter/marker_colorbar":1032,"./arrays_to_calcdata":826,"./attributes":827,"./calc":828,"./defaults":829,"./hover":830,"./layout_attributes":832,"./layout_defaults":833,"./plot":834,"./select":835,"./set_positions":836,"./style":838}],832:[function(t,e,r){"use strict";e.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],833:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../plots/cartesian/axes");var i=t("../../lib");var o=t("./layout_attributes");e.exports=function(t,e,r){function s(r,n){return i.coerce(t,e,o,r,n)}var l=false,u=false,c=false,f={};for(var h=0;h<r.length;h++){var p=r[h];if(n.traceIs(p,"bar"))l=true;else continue;if(t.barmode!=="overlay"&&t.barmode!=="stack"){var d=p.xaxis+p.yaxis;if(f[d])c=true;f[d]=true}if(p.visible&&p.type==="histogram"){var v=a.getFromId({_fullLayout:e},p[p.orientation==="v"?"xaxis":"yaxis"]);if(v.type!=="category")u=true}}if(!l)return;var g=s("barmode");if(g!=="overlay")s("barnorm");s("bargap",u&&!c?0:.2);s("bargroupgap")}},{"../../lib":684,"../../plots/cartesian/axes":732,"../../registry":817,"./layout_attributes":832}],834:[function(t,e,r){"use strict";var n=t("d3");var a=t("fast-isnumeric");var i=t("tinycolor2");var o=t("../../lib");var s=t("../../lib/svg_text_utils");var l=t("../../components/color");var u=t("../../components/drawing");var c=t("../../registry");var f=t("./attributes"),h=f.text,p=f.textposition,d=f.textfont,v=f.insidetextfont,g=f.outsidetextfont;var m=3;e.exports=function t(e,r,i,s){var f=r.xaxis;var h=r.yaxis;var p=e._fullLayout;var d=s.selectAll("g.trace.bars").data(i,function(t){return t[0].trace.uid});d.enter().append("g").attr("class","trace bars").append("g").attr("class","points");d.exit().remove();d.order();d.each(function(t){var i=t[0];var s=i.t;var c=i.trace;var d=n.select(this);if(!r.isRangePlot)i.node3=d;var v=s.poffset;var g=Array.isArray(v);var m=d.select("g.points").selectAll("g.point").data(o.identity);m.enter().append("g").classed("point",true);m.exit().remove();m.each(function(i,s){var d=n.select(this);var m=i.p+(g?v[s]:v),x=m+i.w,b=i.b,_=b+i.s;var w,k,M,A;if(c.orientation==="h"){M=h.c2p(m,true);A=h.c2p(x,true);w=f.c2p(b,true);k=f.c2p(_,true);i.ct=[k,(M+A)/2]}else{w=f.c2p(m,true);k=f.c2p(x,true);M=h.c2p(b,true);A=h.c2p(_,true);i.ct=[(w+k)/2,A]}if(!a(w)||!a(k)||!a(M)||!a(A)||w===k||M===A){d.remove();return}var T=(i.mlw+1||c.marker.line.width+1||(i.trace?i.trace.marker.line.width:0)+1)-1,S=n.round(T/2%1,2);function E(t){return p.bargap===0&&p.bargroupgap===0?n.round(Math.round(t)-S,2):t}function C(t,e){return Math.abs(t-e)>=2?E(t):t>e?Math.ceil(t):Math.floor(t)}if(!e._context.staticPlot){var L=l.opacity(i.mc||c.marker.color),I=L<1||T>.01?E:C;w=I(w,k);k=I(k,w);M=I(M,A);A=I(A,M)}o.ensureSingle(d,"path").style("vector-effect","non-scaling-stroke").attr("d","M"+w+","+M+"V"+A+"H"+k+"V"+M+"Z").call(u.setClipUrl,r.layerClipId);y(e,d,t,s,w,k,M,A);if(r.layerClipId){u.hideOutsideRangePoint(t[s],d.select("text"),f,h,c.xcalendar,c.ycalendar)}});var x=t[0].trace.cliponaxis===false;u.setClipUrl(d,x?null:r.layerClipId)});c.getComponentMethod("errorbars","plot")(d,r)};function y(t,e,r,n,a,i,l,c){var f;function h(e,r,n){var a=o.ensureSingle(e,"text").text(r).attr({class:"bartext bartext-"+f,transform:"","text-anchor":"middle","data-notex":1}).call(u.font,n).call(s.convertToTspans,t);return a}var p=r[0].trace,d=p.orientation;var v=w(p,n);f=k(p,n);if(!v||f==="none"){e.select("text").remove();return}var g=M(p,n,t._fullLayout.font),y=A(p,n,g),_=T(p,n,g);var S=t._fullLayout.barmode,E=S==="stack",C=S==="relative",L=E||C,I=r[n],z=!L||I._outmost,P=Math.abs(i-a)-2*m,O=Math.abs(c-l)-2*m,D,R,B,F;if(f==="outside"){if(!z)f="inside"}if(f==="auto"){if(z){f="inside";D=h(e,v,y);R=u.bBox(D.node()),B=R.width,F=R.height;var N=B>0&&F>0,j=B<=P&&F<=O,V=B<=O&&F<=P,U=d==="h"?P>=B*(O/F):O>=F*(P/B);if(N&&(j||V||U)){f="inside"}else{f="outside";D.remove();D=null}}else f="inside"}if(!D){D=h(e,v,f==="outside"?_:y);R=u.bBox(D.node()),B=R.width,F=R.height;if(B<=0||F<=0){D.remove();return}}var q,H;if(f==="outside"){H=p.constraintext==="both"||p.constraintext==="outside";q=b(a,i,l,c,R,d,H)}else{H=p.constraintext==="both"||p.constraintext==="inside";q=x(a,i,l,c,R,d,H)}D.attr("transform",q)}function x(t,e,r,n,a,i,o){var s=a.width,l=a.height,u=(a.left+a.right)/2,c=(a.top+a.bottom)/2,f=Math.abs(e-t),h=Math.abs(n-r),p,d,v,g;var y;if(f>2*m&&h>2*m){y=m;f-=2*y;h-=2*y}else y=0;var x,b;if(s<=f&&l<=h){x=false;b=1}else if(s<=h&&l<=f){x=true;b=1}else if(s<l===f<h){x=false;b=o?Math.min(f/s,h/l):1}else{x=true;b=o?Math.min(h/s,f/l):1}if(x)x=90;if(x){p=b*l;d=b*s}else{p=b*s;d=b*l}if(i==="h"){if(e<t){v=e+y+p/2;g=(r+n)/2}else{v=e-y-p/2;g=(r+n)/2}}else{if(n>r){v=(t+e)/2;g=n-y-d/2}else{v=(t+e)/2;g=n+y+d/2}}return _(u,c,v,g,b,x)}function b(t,e,r,n,a,i,o){var s=i==="h"?Math.abs(n-r):Math.abs(e-t),l;if(s>2*m){l=m}var u=1;if(o){u=i==="h"?Math.min(1,s/a.height):Math.min(1,s/a.width)}var c=(a.left+a.right)/2,f=(a.top+a.bottom)/2,h,p,d,v;h=u*a.width;p=u*a.height;if(i==="h"){if(e<t){d=e-l-h/2;v=(r+n)/2}else{d=e+l+h/2;v=(r+n)/2}}else{if(n>r){d=(t+e)/2;v=n+l+p/2}else{d=(t+e)/2;v=n-l-p/2}}return _(c,f,d,v,u,false)}function _(t,e,r,n,a,i){var o,s,l;if(a<1)o="scale("+a+") ";else{a=1;o=""}s=i?"rotate("+i+" "+t+" "+e+") ":"";var u=r-a*t,c=n-a*e;l="translate("+u+" "+c+")";return l+o+s}function w(t,e){var r=E(t.text,e);return C(h,r)}function k(t,e){var r=E(t.textposition,e);return L(p,r)}function M(t,e,r){return S(d,t.textfont,e,r)}function A(t,e,r){return S(v,t.insidetextfont,e,r)}function T(t,e,r){return S(g,t.outsidetextfont,e,r)}function S(t,e,r,n){e=e||{};var a=E(e.family,r),i=E(e.size,r),o=E(e.color,r);return{family:C(t.family,a,n.family),size:I(t.size,i,n.size),color:z(t.color,o,n.color)}}function E(t,e){var r;if(!Array.isArray(t))r=t;else if(e<t.length)r=t[e];return r}function C(t,e,r){if(typeof e==="string"){if(e||!t.noBlank)return e}else if(typeof e==="number"){if(!t.strict)return String(e)}return r!==undefined?r:t.dflt}function L(t,e,r){if(t.coerceNumber)e=+e;if(t.values.indexOf(e)!==-1)return e;return r!==undefined?r:t.dflt}function I(t,e,r){if(a(e)){e=+e;var n=t.min,i=t.max,o=n!==undefined&&e<n||i!==undefined&&e>i;if(!o)return e}return r!==undefined?r:t.dflt}function z(t,e,r){if(i(e).isValid())return e;return r!==undefined?r:t.dflt}},{"../../components/color":558,"../../components/drawing":583,"../../lib":684,"../../lib/svg_text_utils":708,"../../registry":817,"./attributes":827,d3:147,"fast-isnumeric":214,tinycolor2:499}],835:[function(t,e,r){"use strict";e.exports=function t(e,r){var n=e.cd;var a=e.xaxis;var i=e.yaxis;var o=[];var s;if(r===false){for(s=0;s<n.length;s++){n[s].selected=0}}else{for(s=0;s<n.length;s++){var l=n[s];if(r.contains(l.ct)){o.push({pointNumber:s,x:a.c2d(l.x),y:i.c2d(l.y)});l.selected=1}else{l.selected=0}}}return o}},{}],836:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib").isArrayOrTypedArray;var i=t("../../constants/numerical").BADNUM;var o=t("../../registry");var s=t("../../plots/cartesian/axes");var l=t("./sieve.js");e.exports=function t(e,r){var n=r.xaxis,a=r.yaxis;var i=e._fullData,s=e.calcdata,l=[],c=[],f;for(f=0;f<i.length;f++){var h=i[f];if(h.visible===true&&o.traceIs(h,"bar")&&h.xaxis===n._id&&h.yaxis===a._id){if(h.orientation==="h"){l.push(s[f])}else{c.push(s[f])}}}u(e,n,a,c);u(e,a,n,l)};function u(t,e,r,n){if(!n.length)return;var a=t._fullLayout.barmode,i=a==="overlay",o=a==="group",s,l,u,p,d;if(i){c(t,e,r,n)}else if(o){s=[];l=[];for(u=0;u<n.length;u++){p=n[u];d=p[0].trace;if(d.offset===undefined)l.push(p);else s.push(p)}if(l.length){f(t,e,r,l)}if(s.length){c(t,e,r,s)}}else{s=[];l=[];for(u=0;u<n.length;u++){p=n[u];d=p[0].trace;if(d.base===undefined)l.push(p);else s.push(p)}if(l.length){h(t,e,r,l)}if(s.length){c(t,e,r,s)}}M(n,e)}function c(t,e,r,n){var a=t._fullLayout.barnorm,i=false,o=!a;for(var s=0;s<n.length;s++){var u=n[s];var c=new l([u],i,o);p(t,e,c);if(a){_(t,r,c);w(t,r,c)}else{x(t,r,c)}}}function f(t,e,r,n){var a=t._fullLayout,i=a.barnorm,o=false,s=!i,u=new l(n,o,s);d(t,e,u);if(i){_(t,r,u);w(t,r,u)}else{x(t,r,u)}}function h(t,e,r,n){var a=t._fullLayout,o=a.barmode,s=o==="stack",u=o==="relative",c=t._fullLayout.barnorm,f=u,h=!(c||s||u),d=new l(n,f,h);p(t,e,d);b(t,r,d);for(var v=0;v<n.length;v++){var g=n[v];for(var m=0;m<g.length;m++){var y=g[m];if(y.s===i)continue;var x=y.b+y.s===d.get(y.p,y.s);if(x)y._outmost=true}}if(c)w(t,r,d)}function p(t,e,r){var n=t._fullLayout,a=n.bargap,i=n.bargroupgap,o=r.minDiff,s=r.traces,l,u,c,f;var h=o*(1-a),p=h,d=p*(1-i);var y=-d/2;for(l=0;l<s.length;l++){u=s[l];c=u[0];f=c.t;f.barwidth=d;f.poffset=y;f.bargroupwidth=h;f.bardelta=o}r.binWidth=s[0][0].t.barwidth/100;v(r);g(t,e,r);m(t,e,r)}function d(t,e,r){var n=t._fullLayout,a=n.bargap,i=n.bargroupgap,o=r.positions,s=r.distinctPositions,l=r.minDiff,u=r.traces,c,f,h,p;var d=o.length!==s.length;var y=u.length,x=l*(1-a),b=d?x/y:x,_=b*(1-i);for(c=0;c<y;c++){f=u[c];h=f[0];var w=d?((2*c+1-y)*b-_)/2:-_/2;p=h.t;p.barwidth=_;p.poffset=w;p.bargroupwidth=x;p.bardelta=l}r.binWidth=u[0][0].t.barwidth/100;v(r);g(t,e,r);m(t,e,r,d)}function v(t){var e=t.traces,r,i,o,s,l,u;for(r=0;r<e.length;r++){i=e[r];o=i[0];s=o.trace;u=o.t;var c=s.offset,f=u.poffset,h;if(a(c)){h=c.slice(0,i.length);for(l=0;l<h.length;l++){if(!n(h[l])){h[l]=f}}for(l=h.length;l<i.length;l++){h.push(f)}u.poffset=h}else if(c!==undefined){u.poffset=c}var p=s.width,d=u.barwidth;if(a(p)){var v=p.slice(0,i.length);for(l=0;l<v.length;l++){if(!n(v[l]))v[l]=d}for(l=v.length;l<i.length;l++){v.push(d)}u.barwidth=v;if(c===undefined){h=[];for(l=0;l<i.length;l++){h.push(f+(d-v[l])/2)}u.poffset=h}}else if(p!==undefined){u.barwidth=p;if(c===undefined){u.poffset=f+(d-p)/2}}}}function g(t,e,r){var n=r.traces,a=k(e);for(var i=0;i<n.length;i++){var o=n[i],s=o[0].t,l=s.poffset,u=Array.isArray(l),c=s.barwidth,f=Array.isArray(c);for(var h=0;h<o.length;h++){var p=o[h];var d=p.w=f?c[h]:c;p[a]=p.p+(u?l[h]:l)+d/2}}}function m(t,e,r,n){var a=r.traces,i=r.distinctPositions,o=i[0],l=r.minDiff,u=l/2;s.minDtick(e,l,o,n);var c=Math.min.apply(Math,i)-u,f=Math.max.apply(Math,i)+u;for(var h=0;h<a.length;h++){var p=a[h],d=p[0],v=d.trace;if(v.width===undefined&&v.offset===undefined){continue}var g=d.t,m=g.poffset,y=g.barwidth,x=Array.isArray(m),b=Array.isArray(y);for(var _=0;_<p.length;_++){var w=p[_],k=x?m[_]:m,M=b?y[_]:y,A=w.p,T=A+k,S=T+M;c=Math.min(c,T);f=Math.max(f,S)}}s.expand(e,[c,f],{padded:false})}function y(t,e){if(n(t[0]))t[0]=Math.min(t[0],e);else t[0]=e;if(n(t[1]))t[1]=Math.max(t[1],e);else t[1]=e}function x(t,e,r){var a=r.traces,i=k(e),o=[null,null];for(var l=0;l<a.length;l++){var u=a[l];for(var c=0;c<u.length;c++){var f=u[c],h=f.b,p=h+f.s;f[i]=p;if(n(e.c2l(p)))y(o,p);if(f.hasB&&n(e.c2l(h)))y(o,h)}}s.expand(e,o,{tozero:true,padded:true})}function b(t,e,r){var a=t._fullLayout,o=a.barnorm,l=k(e),u=r.traces,c,f,h,p;var d=[null,null];for(c=0;c<u.length;c++){f=u[c];for(h=0;h<f.length;h++){p=f[h];if(p.s===i)continue;var v=r.put(p.p,p.b+p.s),g=v+p.b+p.s;p.b=v;p[l]=g;if(!o){if(n(e.c2l(g)))y(d,g);if(p.hasB&&n(e.c2l(v)))y(d,v)}}}if(!o)s.expand(e,d,{tozero:true,padded:true})}function _(t,e,r){var n=r.traces;for(var a=0;a<n.length;a++){var o=n[a];for(var s=0;s<o.length;s++){var l=o[s];if(l.s!==i)r.put(l.p,l.b+l.s)}}}function w(t,e,r){var a=r.traces,o=k(e),l=t._fullLayout.barnorm==="fraction"?1:100,u=l/1e9,c=e.l2c(e.c2l(0)),f=t._fullLayout.barmode==="stack"?l:c,h=[c,f],p=false;function d(t){if(n(e.c2l(t))&&(t<c-u||t>f+u||!n(c))){p=true;y(h,t)}}for(var v=0;v<a.length;v++){var g=a[v];for(var m=0;m<g.length;m++){var x=g[m];if(x.s===i)continue;var b=Math.abs(l/r.get(x.p,x.s));x.b*=b;x.s*=b;var _=x.b,w=_+x.s;x[o]=w;d(w);if(x.hasB)d(_)}}s.expand(e,h,{tozero:true,padded:p})}function k(t){return t._id.charAt(0)}function M(t,e){var r=e._id.charAt(0);var a={};var i=Infinity;var o=-Infinity;var s,l,u;for(s=0;s<t.length;s++){u=t[s];for(l=0;l<u.length;l++){var c=u[l].p;if(n(c)){i=Math.min(i,c);o=Math.max(o,c)}}}var f=1e4/(o-i);var h=a.round=function(t){return String(Math.round(f*(t-i)))};for(s=0;s<t.length;s++){u=t[s];u[0].t.extents=a;for(l=0;l<u.length;l++){var p=u[l];var d=p[r]-p.w/2;if(n(d)){var v=p[r]+p.w/2;var g=h(p.p);if(a[g]){a[g]=[Math.min(d,a[g][0]),Math.max(v,a[g][1])]}else{a[g]=[d,v]}}}}}},{"../../constants/numerical":661,"../../lib":684,"../../plots/cartesian/axes":732,"../../registry":817,"./sieve.js":837,"fast-isnumeric":214}],837:[function(t,e,r){"use strict";e.exports=i;var n=t("../../lib");var a=t("../../constants/numerical").BADNUM;function i(t,e,r){this.traces=t;this.separateNegativeValues=e;this.dontMergeOverlappingData=r;var i=Infinity;var o=[];for(var s=0;s<t.length;s++){var l=t[s];for(var u=0;u<l.length;u++){var c=l[u];if(c.p!==a)o.push(c.p)}if(l[0]&&l[0].width1){i=Math.min(l[0].width1,i)}}this.positions=o;var f=n.distinctVals(o);this.distinctPositions=f.vals;if(f.vals.length===1&&i!==Infinity)this.minDiff=i;else this.minDiff=Math.min(f.minDiff,i);this.binWidth=this.minDiff;this.bins={}}i.prototype.put=function t(e,r){var n=this.getLabel(e,r),a=this.bins[n]||0;this.bins[n]=a+r;return a};i.prototype.get=function t(e,r){var n=this.getLabel(e,r);return this.bins[n]||0};i.prototype.getLabel=function t(e,r){var n=r<0&&this.separateNegativeValues?"v":"^",a=this.dontMergeOverlappingData?e:Math.round(e/this.binWidth);return n+a}},{"../../constants/numerical":661,"../../lib":684}],838:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/drawing");var i=t("../../registry");function o(t,e){var r=e?e[0].node3:n.select(t).selectAll("g.trace.bars");var a=r.size();var o=t._fullLayout;r.style("opacity",function(t){return t[0].trace.opacity}).each(function(t){if(o.barmode==="stack"&&a>1||o.bargap===0&&o.bargroupgap===0&&!t[0].trace.marker.line.width){n.select(this).attr("shape-rendering","crispEdges")}});r.selectAll("g.points").each(function(e){var r=n.select(this);var a=e[0].trace;s(r,a,t)});i.getComponentMethod("errorbars","style")(r)}function s(t,e,r){var i=t.selectAll("path");var o=t.selectAll("text");a.pointStyle(i,e,r);o.each(function(t){var r=n.select(this);var i;if(r.classed("bartext-inside")){i=e.insidetextfont}else if(r.classed("bartext-outside")){i=e.outsidetextfont}if(!i)i=e.textfont;function o(e){var r=i[e];return Array.isArray(r)?r[t.i]:r}a.font(r,o("family"),o("size"),o("color"))})}function l(t,e){var r=e[0].node3;var n=e[0].trace;if(n.selectedpoints){a.selectedPointStyle(r.selectAll("path"),n);a.selectedTextStyle(r.selectAll("text"),n)}else{s(r,n,t)}}e.exports={style:o,styleOnSelect:l}},{"../../components/drawing":583,"../../registry":817,d3:147}],839:[function(t,e,r){"use strict";var n=t("../../components/color");var a=t("../../components/colorscale/has_colorscale");var i=t("../../components/colorscale/defaults");e.exports=function t(e,r,o,s,l){o("marker.color",s);if(a(e,"marker")){i(e,r,l,o,{prefix:"marker.",cLetter:"c"})}o("marker.line.color",n.defaultLine);if(a(e,"marker.line")){i(e,r,l,o,{prefix:"marker.line.",cLetter:"c"})}o("marker.line.width");o("marker.opacity");o("selected.marker.color");o("unselected.marker.color")}},{"../../components/color":558,"../../components/colorscale/defaults":568,"../../components/colorscale/has_colorscale":572}],840:[function(t,e,r){"use strict";var n=t("../scatter/attributes");var a=t("../../components/color/attributes");var i=t("../../lib/extend").extendFlat;var o=n.marker;var s=o.line;e.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},name:{valType:"string",editType:"calc+clearAxisTypes"},text:i({},n.text,{}),whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calcIfAutorange"},notched:{valType:"boolean",editType:"calcIfAutorange"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calcIfAutorange"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",false],dflt:"outliers",editType:"calcIfAutorange"},boxmean:{valType:"enumerated",values:[true,"sd",false],dflt:false,editType:"calcIfAutorange"},jitter:{valType:"number",min:0,max:1,editType:"calcIfAutorange"},pointpos:{valType:"number",min:-2,max:2,editType:"calcIfAutorange"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:i({},o.symbol,{arrayOk:false,editType:"plot"}),opacity:i({},o.opacity,{arrayOk:false,dflt:1,editType:"style"}),size:i({},o.size,{arrayOk:false,editType:"calcIfAutorange"}),color:i({},o.color,{arrayOk:false,editType:"style"}),line:{color:i({},s.color,{arrayOk:false,dflt:a.defaultLine,editType:"style"}),width:i({},s.width,{arrayOk:false,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:n.fillcolor,selected:{marker:n.selected.marker,editType:"style"},unselected:{marker:n.unselected.marker,editType:"style"},hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":557,"../../lib/extend":673,"../scatter/attributes":1015}],841:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib");var i=a._;var o=t("../../plots/cartesian/axes");e.exports=function t(e,r){var d=e._fullLayout;var v=o.getFromId(e,r.xaxis||"x");var g=o.getFromId(e,r.yaxis||"y");var m=[];var y=r.type==="violin"?"_numViolins":"_numBoxes";var x;var b,_;var w,k;if(r.orientation==="h"){b=v;_="x";w=g;k="y"}else{b=g;_="y";w=v;k="x"}var M=b.makeCalcdata(r,_);var A=s(r,k,w,M,d[y]);var T=a.distinctVals(A);var S=T.vals;var E=T.minDiff/2;var C=l(S,E);var L=S.length;var I=u(L);for(x=0;x<r._length;x++){var z=M[x];if(!n(z))continue;var P=a.findBin(A[x],C);if(P>=0&&P<L){var O={v:z,i:x};c(O,r,x);I[P].push(O)}}for(x=0;x<L;x++){if(I[x].length>0){var D=I[x].sort(h);var R=D.map(p);var B=R.length;var F={pos:S[x],pts:D};F.min=R[0];F.max=R[B-1];F.mean=a.mean(R,B);F.sd=a.stdev(R,B,F.mean);F.q1=a.interp(R,.25);F.med=a.interp(R,.5);F.q3=a.interp(R,.75);F.lf=Math.min(F.q1,R[Math.min(a.findBin(2.5*F.q1-1.5*F.q3,R,true)+1,B-1)]);F.uf=Math.max(F.q3,R[Math.max(a.findBin(2.5*F.q3-1.5*F.q1,R),0)]);F.lo=4*F.q1-3*F.q3;F.uo=4*F.q3-3*F.q1;var N=F.q3-F.q1;var j=1.57*N/Math.sqrt(B);F.ln=F.med-j;F.un=F.med+j;m.push(F)}}f(m,r);o.expand(b,M,{padded:true});if(m.length>0){m[0].t={num:d[y],dPos:E,posLetter:k,valLetter:_,labels:{med:i(e,"median:"),min:i(e,"min:"),q1:i(e,"q1:"),q3:i(e,"q3:"),max:i(e,"max:"),mean:r.boxmean==="sd"?i(e,"mean \xb1 \u03c3:"):i(e,"mean:"),lf:i(e,"lower fence:"),uf:i(e,"upper fence:")}};d[y]++;return m}else{return[{t:{empty:true}}]}};function s(t,e,r,i,o){if(e in t){return r.makeCalcdata(t,e)}var s;if(e+"0"in t){s=t[e+"0"]}else if("name"in t&&(r.type==="category"||n(t.name)&&["linear","log"].indexOf(r.type)!==-1||a.isDateTime(t.name)&&r.type==="date")){s=t.name}else{s=o}var l=r.d2c(s,0,t[e+"calendar"]);return i.map(function(){return l})}function l(t,e){var r=t.length;var n=new Array(r+1);for(var a=0;a<r;a++){n[a]=t[a]-e}n[r]=t[r-1]+e;return n}function u(t){var e=new Array(t);for(var r=0;r<t;r++){e[r]=[]}return e}function c(t,e,r){var n={text:"tx"};for(var a in n){if(Array.isArray(e[a])){t[n[a]]=e[a][r]}}}function f(t,e){if(a.isArrayOrTypedArray(e.selectedpoints)){for(var r=0;r<t.length;r++){var n=t[r].pts||[];var i={};for(var o=0;o<n.length;o++){i[n[o].i]=o}a.tagSelected(n,e,i)}}}function h(t,e){return t.v-e.v}function p(t){return t.v}},{"../../lib":684,"../../plots/cartesian/axes":732,"fast-isnumeric":214}],842:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../registry");var i=t("../../components/color");var o=t("./attributes");function s(t,e,r,a){function s(r,a){return n.coerce(t,e,o,r,a)}l(t,e,s,a);if(e.visible===false)return;s("line.color",(t.marker||{}).color||r);s("line.width");s("fillcolor",i.addOpacity(e.line.color,.5));s("whiskerwidth");s("boxmean");var c=s("notched",t.notchwidth!==undefined);if(c)s("notchwidth");u(t,e,s,{prefix:"box"})}function l(t,e,r,n){var i=r("y");var o=r("x");var s=o&&o.length;var l,u;if(i&&i.length){l="v";if(s){u=Math.min(o.length,i.length)}else{r("x0");u=i.length}}else if(s){l="h";r("y0");u=o.length}else{e.visible=false;return}e._length=u;var c=a.getComponentMethod("calendars","handleTraceDefaults");c(t,e,["x","y"],n);r("orientation",l)}function u(t,e,r,a){var i=a.prefix;var s=n.coerce2(t,e,o,"marker.outliercolor");var l=r("marker.line.outliercolor");var u=r(i+"points",s||l?"suspectedoutliers":undefined);if(u){r("jitter",u==="all"?.3:0);r("pointpos",u==="all"?-1.5:0);r("marker.symbol");r("marker.opacity");r("marker.size");r("marker.color",e.line.color);r("marker.line.color");r("marker.line.width");if(u==="suspectedoutliers"){r("marker.line.outliercolor",e.marker.color);r("marker.line.outlierwidth")}r("selected.marker.color");r("unselected.marker.color");r("selected.marker.size");r("unselected.marker.size");r("text")}else{delete e.marker}r("hoveron");n.coerceSelectionMarkerOpacity(e,r)}e.exports={supplyDefaults:s,handleSampleDefaults:l,handlePointsDefaults:u}},{"../../components/color":558,"../../lib":684,"../../registry":817,"./attributes":840}],843:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/axes");var a=t("../../lib");var i=t("../../components/fx");var o=t("../../components/color");var s=t("../scatter/fill_hover_text");function l(t,e,r,n){var a=t.cd;var i=a[0].trace;var o=i.hoveron;var s=[];var l;if(o.indexOf("boxes")!==-1){s=s.concat(u(t,e,r,n))}if(o.indexOf("points")!==-1){l=c(t,e,r)}if(n==="closest"){if(l)return[l];return s}if(l){s.push(l);return s}return s}function u(t,e,r,s){var l=t.cd;var u=t.xa;var c=t.ya;var f=l[0].trace;var h=l[0].t;var p=f.type==="violin";var d=[];var v,g,m,y,x,b,_,w,k,M,A;var T=h.bdPos;var S=h.wHover;var E=function(t){return t.pos+h.bPos-b};if(p&&f.side!=="both"){if(f.side==="positive"){k=function(t){var e=E(t);return i.inbox(e,e+S,M)}}if(f.side==="negative"){k=function(t){var e=E(t);return i.inbox(e-S,e,M)}}}else{k=function(t){var e=E(t);return i.inbox(e-S,e+S,M)}}var C;if(p){C=function(t){return i.inbox(t.span[0]-x,t.span[1]-x,M)}}else{C=function(t){return i.inbox(t.min-x,t.max-x,M)}}if(f.orientation==="h"){x=e;b=r;_=C;w=k;v="y";m=c;g="x";y=u}else{x=r;b=e;_=k;w=C;v="x";m=u;g="y";y=c}var L=Math.min(1,T/Math.abs(m.r2c(m.range[1])-m.r2c(m.range[0])));M=t.maxHoverDistance-L;A=t.maxSpikeDistance-L;function I(t){return(_(t)+w(t))/2}var z=i.getDistanceFunction(s,_,w,I);i.getClosest(l,z,t);if(t.index===false)return[];var P=l[t.index];var O=f.line.color;var D=(f.marker||{}).color;if(o.opacity(O)&&f.line.width)t.color=O;else if(o.opacity(D)&&f.boxpoints)t.color=D;else t.color=f.fillcolor;t[v+"0"]=m.c2p(P.pos+h.bPos-T,true);t[v+"1"]=m.c2p(P.pos+h.bPos+T,true);t[v+"LabelVal"]=P.pos;var R=v+"Spike";t.spikeDistance=I(P)*A/M;t[R]=m.c2p(P.pos,true);var B={};var F=["med","min","q1","q3","max"];if(f.boxmean||(f.meanline||{}).visible){F.push("mean")}if(f.boxpoints||f.points){F.push("lf","uf")}for(var N=0;N<F.length;N++){var j=F[N];if(!(j in P)||P[j]in B)continue;B[P[j]]=true;var V=P[j];var U=y.c2p(V,true);var q=a.extendFlat({},t);q[g+"0"]=q[g+"1"]=U;q[g+"LabelVal"]=V;q[g+"Label"]=(h.labels?h.labels[j]+" ":"")+n.hoverLabelText(y,V);if(j==="mean"&&"sd"in P&&f.boxmean==="sd"){q[g+"err"]=P.sd}t.name="";t.spikeDistance=undefined;t[R]=undefined;d.push(q)}return d}function c(t,e,r){var n=t.cd;var o=t.xa;var l=t.ya;var u=n[0].trace;var c=o.c2p(e);var f=l.c2p(r);var h;var p=function(t){var e=Math.max(3,t.mrc||0);return Math.max(Math.abs(o.c2p(t.x)-c)-e,1-3/e)};var d=function(t){var e=Math.max(3,t.mrc||0);return Math.max(Math.abs(l.c2p(t.y)-f)-e,1-3/e)};var v=i.quadrature(p,d);var g=false;var m,y;for(var x=0;x<n.length;x++){m=n[x];for(var b=0;b<(m.pts||[]).length;b++){y=m.pts[b];var _=v(y);if(_<=t.distance){t.distance=_;g=[x,b]}}}if(!g)return false;m=n[g[0]];y=m.pts[g[1]];var w=o.c2p(y.x,true);var k=l.c2p(y.y,true);var M=y.mrc||1;h=a.extendFlat({},t,{index:y.i,color:(u.marker||{}).color,name:u.name,x0:w-M,x1:w+M,xLabelVal:y.x,y0:k-M,y1:k+M,yLabelVal:y.y,spikeDistance:t.distance});var A=u.orientation==="h"?"y":"x";var T=u.orientation==="h"?l:o;h[A+"Spike"]=T.c2p(m.pos,true);s(y,u,h);return h}e.exports={hoverPoints:l,hoverOnBoxes:u,hoverOnPoints:c}},{"../../components/color":558,"../../components/fx":600,"../../lib":684,"../../plots/cartesian/axes":732,"../scatter/fill_hover_text":1022}],844:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.layoutAttributes=t("./layout_attributes");n.supplyDefaults=t("./defaults").supplyDefaults;n.supplyLayoutDefaults=t("./layout_defaults").supplyLayoutDefaults;n.calc=t("./calc");n.setPositions=t("./set_positions").setPositions;n.plot=t("./plot").plot;n.style=t("./style").style;n.styleOnSelect=t("./style").styleOnSelect;n.hoverPoints=t("./hover").hoverPoints;n.selectPoints=t("./select");n.moduleType="trace";n.name="box";n.basePlotModule=t("../../plots/cartesian");n.categories=["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"];n.meta={};e.exports=n},{"../../plots/cartesian":743,"./attributes":840,"./calc":841,"./defaults":842,"./hover":843,"./layout_attributes":845,"./layout_defaults":846,"./plot":847,"./select":848,"./set_positions":849,"./style":850}],845:[function(t,e,r){"use strict";e.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],846:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");var i=t("./layout_attributes");function o(t,e,r,a,i){var o;var s=i+"Layout";for(var l=0;l<r.length;l++){if(n.traceIs(r[l],s)){o=true;break}}if(!o)return;a(i+"mode");a(i+"gap");a(i+"groupgap")}function s(t,e,r){function n(r,n){return a.coerce(t,e,i,r,n)}o(t,e,r,n,"box")}e.exports={supplyLayoutDefaults:s,_supply:o}},{"../../lib":684,"../../registry":817,"./layout_attributes":845}],847:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../lib");var i=t("../../components/drawing");var o=5;var s=.01;function l(t,e,r,a){var i=t._fullLayout;var o=e.xaxis;var s=e.yaxis;var l=a.selectAll("g.trace.boxes").data(r,function(t){return t[0].trace.uid});l.enter().append("g").attr("class","trace boxes");l.exit().remove();l.order();l.each(function(t){var r=t[0];var a=r.t;var l=r.trace;var h=n.select(this);if(!e.isRangePlot)r.node3=h;var p=i._numBoxes;var d=1-i.boxgap;var v=i.boxmode==="group"&&p>1;var g=a.dPos*d*(1-i.boxgroupgap)/(v?p:1);var m=v?2*a.dPos*(-.5+(a.num+.5)/p)*d:0;var y=g*l.whiskerwidth;if(l.visible!==true||a.empty){h.remove();return}var x,b;if(l.orientation==="h"){x=s;b=o}else{x=o;b=s}a.bPos=m;a.bdPos=g;a.wdPos=y;a.wHover=a.dPos*(v?d/p:1);u(h,{pos:x,val:b},l,a);c(h,{x:o,y:s},l,a);f(h,{pos:x,val:b},l,a)})}function u(t,e,r,i){var o=e.pos;var s=e.val;var l=i.bPos;var u=i.wdPos||0;var c=i.bPosPxOffset||0;var f=r.whiskerwidth||0;var h=r.notched||false;var p=h?1-2*r.notchwidth:1;var d;var v;if(Array.isArray(i.bdPos)){d=i.bdPos[0];v=i.bdPos[1]}else{d=i.bdPos;v=i.bdPos}var g=t.selectAll("path.box").data(r.type!=="violin"||r.box?a.identity:[]);g.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box");g.exit().remove();g.each(function(t){var e=t.pos;var i=o.c2p(e+l,true)+c;var g=o.c2p(e+l-d,true)+c;var m=o.c2p(e+l+v,true)+c;var y=o.c2p(e+l-u,true)+c;var x=o.c2p(e+l+u,true)+c;var b=o.c2p(e+l-d*p,true)+c;var _=o.c2p(e+l+v*p,true)+c;var w=s.c2p(t.q1,true);var k=s.c2p(t.q3,true);var M=a.constrain(s.c2p(t.med,true),Math.min(w,k)+1,Math.max(w,k)-1);var A=t.lf===undefined||r.boxpoints===false;var T=s.c2p(A?t.min:t.lf,true);var S=s.c2p(A?t.max:t.uf,true);var E=s.c2p(t.ln,true);var C=s.c2p(t.un,true);if(r.orientation==="h"){n.select(this).attr("d","M"+M+","+b+"V"+_+"M"+w+","+g+"V"+m+(h?"H"+E+"L"+M+","+_+"L"+C+","+m:"")+"H"+k+"V"+g+(h?"H"+C+"L"+M+","+b+"L"+E+","+g:"")+"Z"+"M"+w+","+i+"H"+T+"M"+k+","+i+"H"+S+(f===0?"":"M"+T+","+y+"V"+x+"M"+S+","+y+"V"+x))}else{n.select(this).attr("d","M"+b+","+M+"H"+_+"M"+g+","+w+"H"+m+(h?"V"+E+"L"+_+","+M+"L"+m+","+C:"")+"V"+k+"H"+g+(h?"V"+C+"L"+b+","+M+"L"+g+","+E:"")+"Z"+"M"+i+","+w+"V"+T+"M"+i+","+k+"V"+S+(f===0?"":"M"+y+","+T+"H"+x+"M"+y+","+S+"H"+x))}})}function c(t,e,r,n){var l=e.x;var u=e.y;var c=n.bdPos;var f=n.bPos;var h=r.boxpoints||r.points;a.seedPseudoRandom();var p=function(t){t.forEach(function(t){t.t=n;t.trace=r});return t};var d=t.selectAll("g.points").data(h?p:[]);d.enter().append("g").attr("class","points");d.exit().remove();var v=d.selectAll("path").data(function(t){var e;var n=h==="all"?t.pts:t.pts.filter(function(e){return e.v<t.lf||e.v>t.uf});var i=Math.max((t.max-t.min)/10,t.q3-t.q1);var l=i*1e-9;var u=i*s;var p=[];var d=0;var v;if(r.jitter){if(i===0){d=1;p=new Array(n.length);for(e=0;e<n.length;e++){p[e]=1}}else{for(e=0;e<n.length;e++){var g=Math.max(0,e-o);var m=n[g].v;var y=Math.min(n.length-1,e+o);var x=n[y].v;if(h!=="all"){if(n[e].v<t.lf)x=Math.min(x,t.lf);else m=Math.max(m,t.uf)}var b=Math.sqrt(u*(y-g)/(x-m+l))||0;b=a.constrain(Math.abs(b),0,1);p.push(b);d=Math.max(b,d)}}v=r.jitter*2/(d||1)}for(e=0;e<n.length;e++){var _=n[e];var w=_.v;var k=r.jitter?v*p[e]*(a.pseudoRandom()-.5):0;var M=t.pos+f+c*(r.pointpos+k);if(r.orientation==="h"){_.y=M;_.x=w}else{_.x=M;_.y=w}if(h==="suspectedoutliers"&&w<t.uo&&w>t.lo){_.so=true}}return n});v.enter().append("path").classed("point",true);v.exit().remove();v.call(i.translatePoints,l,u)}function f(t,e,r,i){var o=e.pos;var s=e.val;var l=i.bPos;var u=i.bPosPxOffset||0;var c=r.boxmean||(r.meanline||{}).visible;var f;var h;if(Array.isArray(i.bdPos)){f=i.bdPos[0];h=i.bdPos[1]}else{f=i.bdPos;h=i.bdPos}var p=t.selectAll("path.mean").data(r.type==="box"&&r.boxmean||r.type==="violin"&&r.box&&r.meanline?a.identity:[]);p.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"});p.exit().remove();p.each(function(t){var e=o.c2p(t.pos+l,true)+u;var a=o.c2p(t.pos+l-f,true)+u;var i=o.c2p(t.pos+l+h,true)+u;var p=s.c2p(t.mean,true);var d=s.c2p(t.mean-t.sd,true);var v=s.c2p(t.mean+t.sd,true);if(r.orientation==="h"){n.select(this).attr("d","M"+p+","+a+"V"+i+(c==="sd"?"m0,0L"+d+","+e+"L"+p+","+a+"L"+v+","+e+"Z":""))}else{n.select(this).attr("d","M"+a+","+p+"H"+i+(c==="sd"?"m0,0L"+e+","+d+"L"+a+","+p+"L"+e+","+v+"Z":""))}})}e.exports={plot:l,plotBoxAndWhiskers:u,plotPoints:c,plotBoxMean:f}},{"../../components/drawing":583,"../../lib":684,d3:147}],848:[function(t,e,r){"use strict";e.exports=function t(e,r){var n=e.cd;var a=e.xaxis;var i=e.yaxis;var o=[];var s,l;if(r===false){for(s=0;s<n.length;s++){for(l=0;l<(n[s].pts||[]).length;l++){n[s].pts[l].selected=0}}}else{for(s=0;s<n.length;s++){for(l=0;l<(n[s].pts||[]).length;l++){var u=n[s].pts[l];var c=a.c2p(u.x);var f=i.c2p(u.y);if(r.contains([c,f])){o.push({pointNumber:u.i,x:a.c2d(u.x),y:i.c2d(u.y)});u.selected=1}else{u.selected=0}}}}return o}},{}],849:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/axes");var a=t("../../lib");var i=["v","h"];function o(t,e){var r=t.calcdata;var n=e.xaxis;var a=e.yaxis;for(var o=0;o<i.length;o++){var l=i[o];var u=l==="h"?a:n;var c=[];var f=0;var h=0;for(var p=0;p<r.length;p++){var d=r[p];var v=d[0].t;var g=d[0].trace;if(g.visible===true&&(g.type==="box"||g.type==="candlestick")&&!v.empty&&(g.orientation||"v")===l&&g.xaxis===n._id&&g.yaxis===a._id){c.push(p);if(g.boxpoints){f=Math.max(f,g.jitter-g.pointpos-1);h=Math.max(h,g.jitter+g.pointpos-1)}}}s("box",t,c,u,[f,h])}}function s(t,e,r,i,o){var s=e.calcdata;var l=e._fullLayout;var u=[];var c=t==="violin"?"_numViolins":"_numBoxes";var f,h,p;for(f=0;f<r.length;f++){p=s[r[f]];for(h=0;h<p.length;h++){u.push(p[h].pos)}}if(!u.length)return;var d=a.distinctVals(u);var v=d.minDiff/2;if(u.length===d.vals.length){l[c]=1}n.minDtick(i,d.minDiff,d.vals[0],true);for(f=0;f<r.length;f++){p=s[r[f]];p[0].t.dPos=v}var g=l[t+"gap"];var m=l[t+"groupgap"];var y=(1-g)*(1-m)*v/l[c];n.expand(i,d.vals,{vpadminus:v+o[0]*y,vpadplus:v+o[1]*y})}e.exports={setPositions:o,setPositionOffset:s}},{"../../lib":684,"../../plots/cartesian/axes":732}],850:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/color");var i=t("../../components/drawing");function o(t,e){var r=e?e[0].node3:n.select(t).selectAll("g.trace.boxes");r.style("opacity",function(t){return t[0].trace.opacity});r.each(function(e){var r=n.select(this);var o=e[0].trace;var s=o.line.width;function l(t,e,r,n){t.style("stroke-width",e+"px").call(a.stroke,r).call(a.fill,n)}var u=r.selectAll("path.box");if(o.type==="candlestick"){u.each(function(t){var e=n.select(this);var r=o[t.dir];l(e,r.line.width,r.line.color,r.fillcolor);e.style("opacity",o.selectedpoints&&!t.selected?.3:1)})}else{l(u,s,o.line.color,o.fillcolor);r.selectAll("path.mean").style({"stroke-width":s,"stroke-dasharray":2*s+"px,"+s+"px"}).call(a.stroke,o.line.color);var c=r.selectAll("path.point");i.pointStyle(c,o,t)}})}function s(t,e){var r=e[0].node3;var n=e[0].trace;var a=r.selectAll("path.point");if(n.selectedpoints){i.selectedPointStyle(a,n)}else{i.pointStyle(a,n,t)}}e.exports={style:o,styleOnSelect:s}},{"../../components/color":558,"../../components/drawing":583,d3:147}],851:[function(t,e,r){"use strict";var n=t("../../lib").extendFlat;var a=t("../ohlc/attributes");var i=t("../box/attributes");function o(t){return{line:{color:n({},i.line.color,{dflt:t}),width:i.line.width,editType:"style"},fillcolor:i.fillcolor,editType:"style"}}e.exports={x:a.x,open:a.open,high:a.high,low:a.low,close:a.close,line:{width:n({},i.line.width,{}),editType:"style"},increasing:o(a.increasing.line.color.dflt),decreasing:o(a.decreasing.line.color.dflt),text:a.text,whiskerwidth:n({},i.whiskerwidth,{dflt:0})}},{"../../lib":684,"../box/attributes":840,"../ohlc/attributes":970}],852:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/cartesian/axes");var i=t("../ohlc/calc").calcCommon;e.exports=function(t,e){var r=t._fullLayout;var s=a.getFromId(t,e.xaxis);var l=a.getFromId(t,e.yaxis);var u=s.makeCalcdata(e,"x");var c=i(t,e,u,l,o);if(c.length){n.extendFlat(c[0].t,{num:r._numBoxes,dPos:n.distinctVals(u).minDiff/2,posLetter:"x",valLetter:"y"});r._numBoxes++;return c}else{return[{t:{empty:true}}]}};function o(t,e,r,n){return{min:r,q1:Math.min(t,n),med:n,q3:Math.max(t,n),max:e}}},{"../../lib":684,"../../plots/cartesian/axes":732,"../ohlc/calc":971}],853:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../components/color");var i=t("../ohlc/ohlc_defaults");var o=t("./attributes");e.exports=function t(e,r,a,l){function u(t,a){return n.coerce(e,r,o,t,a)}var c=i(e,r,u,l);if(!c){r.visible=false;return}u("line.width");s(e,r,u,"increasing");s(e,r,u,"decreasing");u("text");u("whiskerwidth");l._requestRangeslider[r.xaxis]=true};function s(t,e,r,n){var i=r(n+".line.color");r(n+".line.width",e.line.width);r(n+".fillcolor",a.addOpacity(i,.5))}},{"../../components/color":558,"../../lib":684,"../ohlc/ohlc_defaults":975,"./attributes":851}],854:[function(t,e,r){"use strict";e.exports={moduleType:"trace",name:"candlestick",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:t("./attributes"),layoutAttributes:t("../box/layout_attributes"),supplyLayoutDefaults:t("../box/layout_defaults").supplyLayoutDefaults,setPositions:t("../box/set_positions").setPositions,supplyDefaults:t("./defaults"),calc:t("./calc"),plot:t("../box/plot").plot,layerName:"boxlayer",style:t("../box/style").style,hoverPoints:t("../ohlc/hover"),selectPoints:t("../ohlc/select")}},{"../../plots/cartesian":743,"../box/layout_attributes":845,"../box/layout_defaults":846,"../box/plot":847,"../box/set_positions":849,"../box/style":850,"../ohlc/hover":973,"../ohlc/select":977,"./attributes":851,"./calc":852,"./defaults":853}],855:[function(t,e,r){"use strict";var n=t("./axis_defaults");e.exports=function t(e,r,n,i,o){var s=i("a");if(!s){i("da");i("a0")}var l=i("b");if(!l){i("db");i("b0")}a(e,r,n,o)};function a(t,e,r,a){var i=["aaxis","baxis"];i.forEach(function(i){var o=i.charAt(0);var s=t[i]||{};var l={};var u={tickfont:"x",id:o+"axis",letter:o,font:e.font,name:i,data:t[o],calendar:e.calendar,dfltColor:a,bgColor:r.paper_bgcolor,fullLayout:r};n(s,l,u);l._categories=l._categories||[];e[i]=l;if(!t[i]&&s.type!=="-"){t[i]={type:s.type}}})}},{"./axis_defaults":860}],856:[function(t,e,r){"use strict";var n=t("../../lib").isArrayOrTypedArray;e.exports=function(t){return a(t,0)};function a(t,e){if(!n(t)||e>=10){return null}var r=Infinity;var i=-Infinity;var o=t.length;for(var s=0;s<o;s++){var l=t[s];if(n(l)){var u=a(l,e+1);if(u){r=Math.min(u[0],r);i=Math.max(u[1],i)}}else{r=Math.min(l,r);i=Math.max(l,i)}}return[r,i]}},{"../../lib":684}],857:[function(t,e,r){"use strict";var n=t("../../plots/font_attributes");var a=t("./axis_attributes");var i=t("../../components/color/attributes");var o=n({editType:"calc"});o.family.dflt='"Open Sans", verdana, arial, sans-serif';o.size.dflt=12;o.color.dflt=i.defaultLine;e.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:a,baxis:a,font:o,color:{valType:"color",dflt:i.defaultLine,editType:"plot"}}},{"../../components/color/attributes":557,"../../plots/font_attributes":758,"./axis_attributes":859}],858:[function(t,e,r){"use strict";var n=t("../../lib").isArrayOrTypedArray;e.exports=function(t,e,r,a){var i,o,s,l,u,c;var f,h,p,d,v,g,m;var y=n(r)?"a":"b";var x=y==="a"?t.aaxis:t.baxis;var b=x.smoothing;var _=y==="a"?t.a2i:t.b2j;var w=y==="a"?r:a;var k=y==="a"?a:r;var M=y==="a"?e.a.length:e.b.length;var A=y==="a"?e.b.length:e.a.length;var T=Math.floor(y==="a"?t.b2j(k):t.a2i(k));var S=y==="a"?function(e){return t.evalxy([],e,T)}:function(e){return t.evalxy([],T,e)};if(b){s=Math.max(0,Math.min(A-2,T));l=T-s;o=y==="a"?function(e,r){return t.dxydi([],e,s,r,l)}:function(e,r){return t.dxydj([],s,e,l,r)}}var E=_(w[0]);var C=_(w[1]);var L=E<C?1:-1;var I=(C-E)*1e-8;var z=L>0?Math.floor:Math.ceil;var P=L>0?Math.ceil:Math.floor;var O=L>0?Math.min:Math.max;var D=L>0?Math.max:Math.min;var R=z(E+I);var B=P(C-I);f=S(E);var F=[[f]];for(i=R;i*L<B*L;i+=L){u=[];v=D(E,i);g=O(C,i+L);m=g-v;c=Math.max(0,Math.min(M-2,Math.floor(.5*(v+g))));h=S(g);if(b){p=o(c,v-c);d=o(c,g-c);u.push([f[0]+p[0]/3*m,f[1]+p[1]/3*m]);u.push([h[0]-d[0]/3*m,h[1]-d[1]/3*m])}u.push(h);F.push(u);f=h}return F}},{"../../lib":684}],859:[function(t,e,r){"use strict";var n=t("../../plots/font_attributes");var a=t("../../components/color/attributes");var i=t("../../plots/cartesian/layout_attributes");var o=t("../../plot_api/edit_types").overrideAll;e.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{valType:"string",editType:"calc"},titlefont:n({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autorange:{valType:"enumerated",values:[true,false,"reversed"],dflt:true,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:false,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:n({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},separatethousands:{valType:"boolean",dflt:false,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc"},tickformatstops:o(i.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:false,editType:"calc"},linecolor:{valType:"color",dflt:a.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:true,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:a.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},editType:"calc"}},{"../../components/color/attributes":557,"../../plot_api/edit_types":715,"../../plots/cartesian/layout_attributes":744,"../../plots/font_attributes":758}],860:[function(t,e,r){"use strict";var n=t("./attributes");var a=t("../../components/color").addOpacity;var i=t("../../registry");var o=t("../../lib");var s=t("../../plots/cartesian/tick_value_defaults");var l=t("../../plots/cartesian/tick_label_defaults");var u=t("../../plots/cartesian/category_order_defaults");var c=t("../../plots/cartesian/set_convert");var f=t("../../plots/cartesian/axis_autotype");e.exports=function t(e,r,f){var p=f.letter,d=f.font||{},v=n[p+"axis"];function g(t,n){return o.coerce(e,r,v,t,n)}function m(t,n){return o.coerce2(e,r,v,t,n)}if(f.name){r._name=f.name;r._id=f.name}var y=g("type");if(y==="-"){if(f.data)h(r,f.data);if(r.type==="-"){r.type="linear"}else{y=e.type=r.type}}g("smoothing");g("cheatertype");g("showticklabels");g("labelprefix",p+" = ");g("labelsuffix");g("showtickprefix");g("showticksuffix");g("separatethousands");g("tickformat");g("exponentformat");g("showexponent");g("categoryorder");g("tickmode");g("tickvals");g("ticktext");g("tick0");g("dtick");if(r.tickmode==="array"){g("arraytick0");g("arraydtick")}g("labelpadding");r._hovertitle=p;if(y==="date"){var x=i.getComponentMethod("calendars","handleDefaults");x(e,r,"calendar",f.calendar)}c(r,f.fullLayout);r.c2p=o.identity;var b=g("color",f.dfltColor);var _=b===e.color?b:d.color;g("title");o.coerceFont(g,"titlefont",{family:d.family,size:Math.round(d.size*1.2),color:_});g("titleoffset");g("tickangle");var w=g("autorange",!r.isValidRange(e.range));if(w)g("rangemode");g("range");r.cleanRange();g("fixedrange");s(e,r,g,y);l(e,r,g,y,f);u(e,r,g,{data:f.data,dataAttr:p});var k=m("gridcolor",a(b,.3));var M=m("gridwidth");var A=g("showgrid");if(!A){delete r.gridcolor;delete r.gridwidth}var T=m("startlinecolor",b);var S=m("startlinewidth",M);var E=g("startline",r.showgrid||!!T||!!S);if(!E){delete r.startlinecolor;delete r.startlinewidth}var C=m("endlinecolor",b);var L=m("endlinewidth",M);var I=g("endline",r.showgrid||!!C||!!L);if(!I){delete r.endlinecolor;delete r.endlinewidth}if(!A){delete r.gridcolor;delete r.gridWidth}else{g("minorgridcount");g("minorgridwidth",M);g("minorgridcolor",a(k,.06));if(!r.minorgridcount){delete r.minorgridwidth;delete r.minorgridcolor}}if(r.showticklabels==="none"){delete r.tickfont;delete r.tickangle;delete r.showexponent;delete r.exponentformat;delete r.tickformat;delete r.showticksuffix;delete r.showtickprefix}if(!r.showticksuffix){delete r.ticksuffix}if(!r.showtickprefix){delete r.tickprefix}g("tickmode");if(!r.title||r.title&&r.title.length===0){delete r.titlefont;delete r.titleoffset}return r};function h(t,e){if(t.type!=="-")return;var r=t._id,n=r.charAt(0);var a=n+"calendar",i=t[a];t.type=f(e,i)}},{"../../components/color":558,"../../lib":684,"../../plots/cartesian/axis_autotype":733,"../../plots/cartesian/category_order_defaults":736,"../../plots/cartesian/set_convert":750,"../../plots/cartesian/tick_label_defaults":751,"../../plots/cartesian/tick_value_defaults":753,"../../registry":817,"./attributes":857}],861:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/axes");var a=t("../../lib").isArray1D;var i=t("./cheater_basis");var o=t("./array_minmax");var s=t("./calc_gridlines");var l=t("./calc_labels");var u=t("./calc_clippath");var c=t("../heatmap/clean_2d_array");var f=t("./smooth_fill_2d_array");var h=t("../heatmap/convert_column_xyz");var p=t("./set_convert");e.exports=function t(e,r){var d=n.getFromId(e,r.xaxis);var v=n.getFromId(e,r.yaxis);var g=r.aaxis;var m=r.baxis;var y=r.x;var x=r.y;var b=[];if(y&&a(y))b.push("x");if(x&&a(x))b.push("y");if(b.length){h(r,g,m,"a","b",b)}var _=r._a=r._a||r.a;var w=r._b=r._b||r.b;y=r._x||r.x;x=r._y||r.y;var k={};if(r._cheater){var M=g.cheatertype==="index"?_.length:_;var A=m.cheatertype==="index"?w.length:w;y=i(M,A,r.cheaterslope)}r._x=y=c(y);r._y=x=c(x);f(y,_,w);f(x,_,w);p(r);r.setScale();var T=o(y);var S=o(x);var E=.5*(T[1]-T[0]);var C=.5*(T[1]+T[0]);var L=.5*(S[1]-S[0]);var I=.5*(S[1]+S[0]);var z=1.3;T=[C-E*z,C+E*z];S=[I-L*z,I+L*z];n.expand(d,T,{padded:true});n.expand(v,S,{padded:true});s(r,"a","b");s(r,"b","a");l(r,g);l(r,m);k.clipsegments=u(r._xctrl,r._yctrl,g,m);k.x=y;k.y=x;k.a=_;k.b=w;return[k]}},{"../../lib":684,"../../plots/cartesian/axes":732,"../heatmap/clean_2d_array":927,"../heatmap/convert_column_xyz":929,"./array_minmax":856,"./calc_clippath":862,"./calc_gridlines":863,"./calc_labels":864,"./cheater_basis":866,"./set_convert":879,"./smooth_fill_2d_array":880}],862:[function(t,e,r){"use strict";e.exports=function t(e,r,n,a){var i,o,s;var l=[];var u=!!n.smoothing;var c=!!a.smoothing;var f=e[0].length-1;var h=e.length-1;for(i=0,o=[],s=[];i<=f;i++){o[i]=e[0][i];s[i]=r[0][i]}l.push({x:o,y:s,bicubic:u});for(i=0,o=[],s=[];i<=h;i++){o[i]=e[i][f];s[i]=r[i][f]}l.push({x:o,y:s,bicubic:c});for(i=f,o=[],s=[];i>=0;i--){o[f-i]=e[h][i];s[f-i]=r[h][i]}l.push({x:o,y:s,bicubic:u});for(i=h,o=[],s=[];i>=0;i--){o[h-i]=e[i][0];s[h-i]=r[i][0]}l.push({x:o,y:s,bicubic:c});return l}},{}],863:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/axes");var a=t("../../lib/extend").extendFlat;e.exports=function t(e,r,i){var o,s,l;var u,c,f,h,p,d,v;var g,m,y,x;var b=e["_"+r];var _=e[r+"axis"];var w=_._gridlines=[];var k=_._minorgridlines=[];var M=_._boundarylines=[];var A=e["_"+i];var T=e[i+"axis"];if(_.tickmode==="array"){_.tickvals=b.slice()}var S=e._xctrl;var E=e._yctrl;var C=S[0].length;var L=S.length;var I=e._a.length;var z=e._b.length;n.prepTicks(_);if(_.tickmode==="array")delete _.tickvals;var P=_.smoothing?3:1;function O(t){var n,a,o,s,l,u,c,f,h,d,v,g;var m=[];var y=[];var x={};if(r==="b"){a=e.b2j(t);o=Math.floor(Math.max(0,Math.min(z-2,a)));s=a-o;x.length=z;x.crossLength=I;x.xy=function(t){return e.evalxy([],t,a)};x.dxy=function(t,r){return e.dxydi([],t,o,r,s)};for(n=0;n<I;n++){u=Math.min(I-2,n);c=n-u;f=e.evalxy([],n,a);if(T.smoothing&&n>0){h=e.dxydi([],n-1,o,0,s);m.push(l[0]+h[0]/3);y.push(l[1]+h[1]/3);d=e.dxydi([],n-1,o,1,s);m.push(f[0]-d[0]/3);y.push(f[1]-d[1]/3)}m.push(f[0]);y.push(f[1]);l=f}}else{n=e.a2i(t);u=Math.floor(Math.max(0,Math.min(I-2,n)));c=n-u;x.length=I;x.crossLength=z;x.xy=function(t){return e.evalxy([],n,t)};x.dxy=function(t,r){return e.dxydj([],u,t,c,r)};for(a=0;a<z;a++){o=Math.min(z-2,a);s=a-o;f=e.evalxy([],n,a);if(T.smoothing&&a>0){v=e.dxydj([],u,a-1,c,0);m.push(l[0]+v[0]/3);y.push(l[1]+v[1]/3);g=e.dxydj([],u,a-1,c,1);m.push(f[0]-g[0]/3);y.push(f[1]-g[1]/3)}m.push(f[0]);y.push(f[1]);l=f}}x.axisLetter=r;x.axis=_;x.crossAxis=T;x.value=t;x.constvar=i;x.index=p;x.x=m;x.y=y;x.smoothing=T.smoothing;return x}function D(t){var n,a,o,s,l;var u=[];var c=[];var f={};f.length=b.length;f.crossLength=A.length;if(r==="b"){o=Math.max(0,Math.min(z-2,t));l=Math.min(1,Math.max(0,t-o));f.xy=function(r){return e.evalxy([],r,t)};f.dxy=function(t,r){return e.dxydi([],t,o,r,l)};for(n=0;n<C;n++){u[n]=S[t*P][n];c[n]=E[t*P][n]}}else{a=Math.max(0,Math.min(I-2,t));s=Math.min(1,Math.max(0,t-a));f.xy=function(r){return e.evalxy([],t,r)};f.dxy=function(t,r){return e.dxydj([],a,t,s,r)};for(n=0;n<L;n++){u[n]=S[n][t*P];c[n]=E[n][t*P]}}f.axisLetter=r;f.axis=_;f.crossAxis=T;f.value=b[t];f.constvar=i;f.index=t;f.x=u;f.y=c;f.smoothing=T.smoothing;return f}if(_.tickmode==="array"){u=5e-15;c=[Math.floor((b.length-1-_.arraytick0)/_.arraydtick*(1+u)),Math.ceil(-_.arraytick0/_.arraydtick/(1+u))].sort(function(t,e){return t-e});f=c[0]-1;h=c[1]+1;for(p=f;p<h;p++){s=_.arraytick0+_.arraydtick*p;if(s<0||s>b.length-1)continue;w.push(a(D(s),{color:_.gridcolor,width:_.gridwidth}))}for(p=f;p<h;p++){l=_.arraytick0+_.arraydtick*p;g=Math.min(l+_.arraydtick,b.length-1);if(l<0||l>b.length-1)continue;if(g<0||g>b.length-1)continue;m=b[l];y=b[g];for(o=0;o<_.minorgridcount;o++){x=g-l;if(x<=0)continue;v=m+(y-m)*(o+1)/(_.minorgridcount+1)*(_.arraydtick/x);if(v<b[0]||v>b[b.length-1])continue;k.push(a(O(v),{color:_.minorgridcolor,width:_.minorgridwidth}))}}if(_.startline){M.push(a(D(0),{color:_.startlinecolor,width:_.startlinewidth}))}if(_.endline){M.push(a(D(b.length-1),{color:_.endlinecolor,width:_.endlinewidth}))}}else{u=5e-15;c=[Math.floor((b[b.length-1]-_.tick0)/_.dtick*(1+u)),Math.ceil((b[0]-_.tick0)/_.dtick/(1+u))].sort(function(t,e){return t-e});f=c[0];h=c[1];for(p=f;p<=h;p++){d=_.tick0+_.dtick*p;w.push(a(O(d),{color:_.gridcolor,width:_.gridwidth}))}for(p=f-1;p<h+1;p++){d=_.tick0+_.dtick*p;for(o=0;o<_.minorgridcount;o++){v=d+_.dtick*(o+1)/(_.minorgridcount+1);if(v<b[0]||v>b[b.length-1])continue;k.push(a(O(v),{color:_.minorgridcolor,width:_.minorgridwidth}))}}if(_.startline){M.push(a(O(b[0]),{color:_.startlinecolor,width:_.startlinewidth}))}if(_.endline){M.push(a(O(b[b.length-1]),{color:_.endlinecolor,width:_.endlinewidth}))}}}},{"../../lib/extend":673,"../../plots/cartesian/axes":732}],864:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/axes");var a=t("../../lib/extend").extendFlat;e.exports=function t(e,r){var i,o,s,l,u;var c=r._labels=[];var f=r._gridlines;for(i=0;i<f.length;i++){u=f[i];if(["start","both"].indexOf(r.showticklabels)!==-1){o=n.tickText(r,u.value);a(o,{prefix:s,suffix:l,endAnchor:true,xy:u.xy(0),dxy:u.dxy(0,0),axis:u.axis,length:u.crossAxis.length,font:u.axis.tickfont,isFirst:i===0,isLast:i===f.length-1});c.push(o)}if(["end","both"].indexOf(r.showticklabels)!==-1){o=n.tickText(r,u.value);a(o,{endAnchor:false,xy:u.xy(u.crossLength-1),dxy:u.dxy(u.crossLength-2,1),axis:u.axis,length:u.crossAxis.length,font:u.axis.tickfont,isFirst:i===0,isLast:i===f.length-1});c.push(o)}}}},{"../../lib/extend":673,"../../plots/cartesian/axes":732}],865:[function(t,e,r){"use strict";var n=.5;e.exports=function t(e,r,a,i){var o=e[0]-r[0],s=e[1]-r[1],l=a[0]-r[0],u=a[1]-r[1],c=Math.pow(o*o+s*s,n/2),f=Math.pow(l*l+u*u,n/2),h=(f*f*o-c*c*l)*i,p=(f*f*s-c*c*u)*i,d=f*(c+f)*3,v=c*(c+f)*3;return[[r[0]+(d&&h/d),r[1]+(d&&p/d)],[r[0]-(v&&h/v),r[1]-(v&&p/v)]]}},{}],866:[function(t,e,r){"use strict";var n=t("../../lib").isArrayOrTypedArray;e.exports=function(t,e,r){var a,i,o,s,l,u;var c=[];var f=n(t)?t.length:t;var h=n(e)?e.length:e;var p=n(t)?t:null;var d=n(e)?e:null;if(p){o=(p.length-1)/(p[p.length-1]-p[0])/(f-1)}if(d){s=(d.length-1)/(d[d.length-1]-d[0])/(h-1)}var v;var g=Infinity;var m=-Infinity;for(i=0;i<h;i++){c[i]=[];u=d?(d[i]-d[0])*s:i/(h-1);for(a=0;a<f;a++){l=p?(p[a]-p[0])*o:a/(f-1);v=l-u*r;g=Math.min(v,g);m=Math.max(v,m);c[i][a]=v}}var y=1/(m-g);var x=-g*y;for(i=0;i<h;i++){for(a=0;a<f;a++){c[i][a]=y*c[i][a]+x}}return c}},{"../../lib":684}],867:[function(t,e,r){"use strict";var n=t("./catmull_rom");var a=t("../../lib").ensureArray;function i(t,e,r){var n=-.5*r[0]+1.5*e[0];var a=-.5*r[1]+1.5*e[1];return[(2*n+t[0])/3,(2*a+t[1])/3]}e.exports=function t(e,r,o,s,l,u){var c,f,h,p,d,v,g,m,y,x;var b=o[0].length;var _=o.length;var w=l?3*b-2:b;var k=u?3*_-2:_;e=a(e,k);r=a(r,k);for(h=0;h<k;h++){e[h]=a(e[h],w);r[h]=a(r[h],w)}for(f=0,p=0;f<_;f++,p+=u?3:1){d=e[p];v=r[p];g=o[f];m=s[f];for(c=0,h=0;c<b;c++,h+=l?3:1){d[h]=g[c];v[h]=m[c]}}if(l){for(f=0,p=0;f<_;f++,p+=u?3:1){for(c=1,h=3;c<b-1;c++,h+=3){y=n([o[f][c-1],s[f][c-1]],[o[f][c],s[f][c]],[o[f][c+1],s[f][c+1]],l);e[p][h-1]=y[0][0];r[p][h-1]=y[0][1];e[p][h+1]=y[1][0];r[p][h+1]=y[1][1]}x=i([e[p][0],r[p][0]],[e[p][2],r[p][2]],[e[p][3],r[p][3]]);e[p][1]=x[0];r[p][1]=x[1];x=i([e[p][w-1],r[p][w-1]],[e[p][w-3],r[p][w-3]],[e[p][w-4],r[p][w-4]]);e[p][w-2]=x[0];r[p][w-2]=x[1]}}if(u){for(h=0;h<w;h++){for(p=3;p<k-3;p+=3){y=n([e[p-3][h],r[p-3][h]],[e[p][h],r[p][h]],[e[p+3][h],r[p+3][h]],u);e[p-1][h]=y[0][0];r[p-1][h]=y[0][1];e[p+1][h]=y[1][0];r[p+1][h]=y[1][1]}x=i([e[0][h],r[0][h]],[e[2][h],r[2][h]],[e[3][h],r[3][h]]);e[1][h]=x[0];r[1][h]=x[1];x=i([e[k-1][h],r[k-1][h]],[e[k-3][h],r[k-3][h]],[e[k-4][h],r[k-4][h]]);e[k-2][h]=x[0];r[k-2][h]=x[1]}}if(l&&u){for(p=1;p<k;p+=(p+1)%3===0?2:1){for(h=3;h<w-3;h+=3){y=n([e[p][h-3],r[p][h-3]],[e[p][h],r[p][h]],[e[p][h+3],r[p][h+3]],l);e[p][h-1]=.5*(e[p][h-1]+y[0][0]);r[p][h-1]=.5*(r[p][h-1]+y[0][1]);e[p][h+1]=.5*(e[p][h+1]+y[1][0]);r[p][h+1]=.5*(r[p][h+1]+y[1][1])}x=i([e[p][0],r[p][0]],[e[p][2],r[p][2]],[e[p][3],r[p][3]]);e[p][1]=.5*(e[p][1]+x[0]);r[p][1]=.5*(r[p][1]+x[1]);x=i([e[p][w-1],r[p][w-1]],[e[p][w-3],r[p][w-3]],[e[p][w-4],r[p][w-4]]);e[p][w-2]=.5*(e[p][w-2]+x[0]);r[p][w-2]=.5*(r[p][w-2]+x[1])}}return[e,r]}},{"../../lib":684,"./catmull_rom":865}],868:[function(t,e,r){"use strict";e.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],869:[function(t,e,r){"use strict";e.exports=function(t,e,r){if(e&&r){return function(e,r,n,a,i){if(!e)e=[];var o,s,l,u,c,f;r*=3;n*=3;var h=a*a;var p=1-a;var d=p*p;var v=p*a*2;var g=-3*d;var m=3*(d-v);var y=3*(v-h);var x=3*h;var b=i*i;var _=b*i;var w=1-i;var k=w*w;var M=k*w;for(f=0;f<t.length;f++){c=t[f];o=g*c[n][r]+m*c[n][r+1]+y*c[n][r+2]+x*c[n][r+3];s=g*c[n+1][r]+m*c[n+1][r+1]+y*c[n+1][r+2]+x*c[n+1][r+3];l=g*c[n+2][r]+m*c[n+2][r+1]+y*c[n+2][r+2]+x*c[n+2][r+3];u=g*c[n+3][r]+m*c[n+3][r+1]+y*c[n+3][r+2]+x*c[n+3][r+3];e[f]=M*o+3*(k*i*s+w*b*l)+_*u}return e}}else if(e){return function(e,r,n,a,i){if(!e)e=[];var o,s,l,u;r*=3;var c=a*a;var f=1-a;var h=f*f;var p=f*a*2;var d=-3*h;var v=3*(h-p);var g=3*(p-c);var m=3*c;var y=1-i;for(l=0;l<t.length;l++){u=t[l];o=d*u[n][r]+v*u[n][r+1]+g*u[n][r+2]+m*u[n][r+3];s=d*u[n+1][r]+v*u[n+1][r+1]+g*u[n+1][r+2]+m*u[n+1][r+3];e[l]=y*o+i*s}return e}}else if(r){return function(e,r,n,a,i){if(!e)e=[];var o,s,l,u,c,f;n*=3;var h=i*i;var p=h*i;var d=1-i;var v=d*d;var g=v*d;for(c=0;c<t.length;c++){f=t[c];o=f[n][r+1]-f[n][r];s=f[n+1][r+1]-f[n+1][r];l=f[n+2][r+1]-f[n+2][r];u=f[n+3][r+1]-f[n+3][r];e[c]=g*o+3*(v*i*s+d*h*l)+p*u}return e}}else{return function(e,r,n,a,i){if(!e)e=[];var o,s,l,u;var c=1-i;for(l=0;l<t.length;l++){u=t[l];o=u[n][r+1]-u[n][r];s=u[n+1][r+1]-u[n+1][r];e[l]=c*o+i*s}return e}}}},{}],870:[function(t,e,r){"use strict";e.exports=function(t,e,r){if(e&&r){return function(e,r,n,a,i){if(!e)e=[];var o,s,l,u,c,f;r*=3;n*=3;var h=a*a;var p=h*a;var d=1-a;var v=d*d;var g=v*d;var m=i*i;var y=1-i;var x=y*y;var b=y*i*2;var _=-3*x;var w=3*(x-b);var k=3*(b-m);var M=3*m;for(f=0;f<t.length;f++){c=t[f];o=_*c[n][r]+w*c[n+1][r]+k*c[n+2][r]+M*c[n+3][r];s=_*c[n][r+1]+w*c[n+1][r+1]+k*c[n+2][r+1]+M*c[n+3][r+1];l=_*c[n][r+2]+w*c[n+1][r+2]+k*c[n+2][r+2]+M*c[n+3][r+2];u=_*c[n][r+3]+w*c[n+1][r+3]+k*c[n+2][r+3]+M*c[n+3][r+3];e[f]=g*o+3*(v*a*s+d*h*l)+p*u}return e}}else if(e){return function(e,r,n,a,i){if(!e)e=[];var o,s,l,u,c,f;r*=3;var h=i*i;var p=h*i;var d=1-i;var v=d*d;var g=v*d;for(c=0;c<t.length;c++){f=t[c];o=f[n+1][r]-f[n][r];s=f[n+1][r+1]-f[n][r+1];l=f[n+1][r+2]-f[n][r+2];u=f[n+1][r+3]-f[n][r+3];e[c]=g*o+3*(v*i*s+d*h*l)+p*u}return e}}else if(r){return function(e,r,n,a,i){if(!e)e=[];var o,s,l,u;n*=3;var c=1-a;var f=i*i;var h=1-i;var p=h*h;var d=h*i*2;var v=-3*p;var g=3*(p-d);var m=3*(d-f);var y=3*f;for(l=0;l<t.length;l++){u=t[l];o=v*u[n][r]+g*u[n+1][r]+m*u[n+2][r]+y*u[n+3][r];s=v*u[n][r+1]+g*u[n+1][r+1]+m*u[n+2][r+1]+y*u[n+3][r+1];e[l]=c*o+a*s}return e}}else{return function(e,r,n,a,i){if(!e)e=[];var o,s,l,u;var c=1-a;for(l=0;l<t.length;l++){u=t[l];o=u[n+1][r]-u[n][r];s=u[n+1][r+1]-u[n][r+1];e[l]=c*o+a*s}return e}}}},{}],871:[function(t,e,r){"use strict";e.exports=function(t,e,r,n,a){var i=e-2;var o=r-2;if(n&&a){return function(e,r,n){if(!e)e=[];var a,s,l,u,c,f;var h=Math.max(0,Math.min(Math.floor(r),i));var p=Math.max(0,Math.min(Math.floor(n),o));var d=Math.max(0,Math.min(1,r-h));var v=Math.max(0,Math.min(1,n-p));h*=3;p*=3;var g=d*d;var m=g*d;var y=1-d;var x=y*y;var b=x*y;var _=v*v;var w=_*v;var k=1-v;var M=k*k;var A=M*k;for(f=0;f<t.length;f++){c=t[f];a=b*c[p][h]+3*(x*d*c[p][h+1]+y*g*c[p][h+2])+m*c[p][h+3];s=b*c[p+1][h]+3*(x*d*c[p+1][h+1]+y*g*c[p+1][h+2])+m*c[p+1][h+3];l=b*c[p+2][h]+3*(x*d*c[p+2][h+1]+y*g*c[p+2][h+2])+m*c[p+2][h+3];u=b*c[p+3][h]+3*(x*d*c[p+3][h+1]+y*g*c[p+3][h+2])+m*c[p+3][h+3];e[f]=A*a+3*(M*v*s+k*_*l)+w*u}return e}}else if(n){return function(e,r,n){if(!e)e=[];var a=Math.max(0,Math.min(Math.floor(r),i));var s=Math.max(0,Math.min(Math.floor(n),o));var l=Math.max(0,Math.min(1,r-a));var u=Math.max(0,Math.min(1,n-s));var c,f,h,p,d,v;a*=3;var g=l*l;var m=g*l;var y=1-l;var x=y*y;var b=x*y;var _=1-u;for(d=0;d<t.length;d++){v=t[d];c=_*v[s][a]+u*v[s+1][a];f=_*v[s][a+1]+u*v[s+1][a+1];h=_*v[s][a+2]+u*v[s+1][a+1];p=_*v[s][a+3]+u*v[s+1][a+1];e[d]=b*c+3*(x*l*f+y*g*h)+m*p}return e}}else if(a){return function(e,r,n){if(!e)e=[];var a=Math.max(0,Math.min(Math.floor(r),i));var s=Math.max(0,Math.min(Math.floor(n),o));var l=Math.max(0,Math.min(1,r-a));var u=Math.max(0,Math.min(1,n-s));var c,f,h,p,d,v;s*=3;var g=u*u;var m=g*u;var y=1-u;var x=y*y;var b=x*y;var _=1-l;for(d=0;d<t.length;d++){v=t[d];c=_*v[s][a]+l*v[s][a+1];f=_*v[s+1][a]+l*v[s+1][a+1];h=_*v[s+2][a]+l*v[s+2][a+1];p=_*v[s+3][a]+l*v[s+3][a+1];e[d]=b*c+3*(x*u*f+y*g*h)+m*p}return e}}else{return function(e,r,n){if(!e)e=[];var a=Math.max(0,Math.min(Math.floor(r),i));var s=Math.max(0,Math.min(Math.floor(n),o));var l=Math.max(0,Math.min(1,r-a));var u=Math.max(0,Math.min(1,n-s));var c,f,h,p;var d=1-u;var v=1-l;for(h=0;h<t.length;h++){p=t[h];c=v*p[s][a]+l*p[s][a+1];f=v*p[s+1][a]+l*p[s+1][a+1];e[h]=d*c+u*f}return e}}}},{}],872:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./xy_defaults");var i=t("./ab_defaults");var o=t("./attributes");var s=t("../../components/color/attributes");e.exports=function t(e,r,l,u){function c(t,a){return n.coerce(e,r,o,t,a)}r._clipPathId="clip"+r.uid+"carpet";var f=c("color",s.defaultLine);n.coerceFont(c,"font");c("carpet");i(e,r,u,c,f);if(!r.a||!r.b){r.visible=false;return}if(r.a.length<3){r.aaxis.smoothing=0}if(r.b.length<3){r.baxis.smoothing=0}var h=a(e,r,c);if(!h){r.visible=false}if(r._cheater){c("cheaterslope")}}},{"../../components/color/attributes":557,"../../lib":684,"./ab_defaults":855,"./attributes":857,"./xy_defaults":881}],873:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.plot=t("./plot");n.calc=t("./calc");n.animatable=true;n.isContainer=true;n.moduleType="trace";n.name="carpet";n.basePlotModule=t("../../plots/cartesian");n.categories=["cartesian","svg","carpet","carpetAxis","notLegendIsolatable"];n.meta={};e.exports=n},{"../../plots/cartesian":743,"./attributes":857,"./calc":861,"./defaults":872,"./plot":878}],874:[function(t,e,r){"use strict";e.exports=function(t,e){var r=t._fullData.length;var n;for(var a=0;a<r;a++){var i=t._fullData[a];if(i.index===e.index)continue;if(i.type==="carpet"){if(!n){n=i}if(i.carpet===e.carpet){return i}}}return n}},{}],875:[function(t,e,r){"use strict";e.exports=function t(e,r,n){if(e.length===0)return"";var a,i=[];var o=n?3:1;for(a=0;a<e.length;a+=o){i.push(e[a]+","+r[a]);if(n&&a<e.length-o){i.push("C");i.push([e[a+1]+","+r[a+1],e[a+2]+","+r[a+2]+" "].join(" "))}}return i.join(n?"":"L")}},{}],876:[function(t,e,r){"use strict";var n=t("../../lib").isArrayOrTypedArray;e.exports=function t(e,r,a){var i;if(!n(e)){e=[]}else if(e.length>r.length){e=e.slice(0,r.length)}for(i=0;i<r.length;i++){e[i]=a(r[i])}return e}},{"../../lib":684}],877:[function(t,e,r){"use strict";e.exports=function t(e,r,n,a,i,o){var s=i[0]*e.dpdx(r);var l=i[1]*e.dpdy(n);var u=1;var c=1;if(o){var f=Math.sqrt(i[0]*i[0]+i[1]*i[1]);var h=Math.sqrt(o[0]*o[0]+o[1]*o[1]);var p=(i[0]*o[0]+i[1]*o[1])/f/h;c=Math.max(0,p)}var d=Math.atan2(l,s)*180/Math.PI;if(d<-90){d+=180;u=-u}else if(d>90){d-=180;u=-u}return{angle:d,flip:u,p:e.c2p(a,r,n),offsetMultplier:c}}},{}],878:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/drawing");var i=t("./map_1d_array");var o=t("./makepath");var s=t("./orient_text");var l=t("../../lib/svg_text_utils");var u=t("../../lib");var c=t("../../constants/alignment");var f=t("../../plots/get_data").getUidsFromCalcData;e.exports=function t(e,r,a,i){var o=f(a);i.selectAll("g.trace").each(function(){var t=n.select(this).attr("class");var e=t.split("carpet")[1].split(/\s/)[0];if(!o[e]){n.select(this).remove()}});for(var s=0;s<a.length;s++){h(e,r,a[s],i)}};function h(t,e,r,n){var a=r[0];var i=r[0].trace,o=e.xaxis,s=e.yaxis,l=i.aaxis,c=i.baxis,f=t._fullLayout;var h=f._clips;var m=u.ensureSingle(n,"g","carpet"+i.uid).classed("trace",true);var y=u.ensureSingle(m,"g","minorlayer");var x=u.ensureSingle(m,"g","majorlayer");var b=u.ensureSingle(m,"g","boundarylayer");var _=u.ensureSingle(m,"g","labellayer");m.style("opacity",i.opacity);d(o,s,x,l,"a",l._gridlines,true);d(o,s,x,c,"b",c._gridlines,true);d(o,s,y,l,"a",l._minorgridlines,true);d(o,s,y,c,"b",c._minorgridlines,true);d(o,s,b,l,"a-boundary",l._boundarylines);d(o,s,b,c,"b-boundary",c._boundarylines);var w=v(t,o,s,i,a,_,l._labels,"a-label");var k=v(t,o,s,i,a,_,c._labels,"b-label");g(t,_,i,a,o,s,w,k);p(i,a,h,o,s)}function p(t,e,r,n,a){var s,l,c,f;var h=r.select("#"+t._clipPathId);if(!h.size()){h=r.append("clipPath").classed("carpetclip",true)}var p=u.ensureSingle(h,"path","carpetboundary");var d=e.clipsegments;var v=[];for(f=0;f<d.length;f++){s=d[f];l=i([],s.x,n.c2p);c=i([],s.y,a.c2p);v.push(o(l,c,s.bicubic))}var g="M"+v.join("L")+"Z";h.attr("id",t._clipPathId);p.attr("d",g)}function d(t,e,r,a,s,l){var u="const-"+s+"-lines";var c=r.selectAll("."+u).data(l);c.enter().append("path").classed(u,true).style("vector-effect","non-scaling-stroke");c.each(function(r){var a=r;var s=a.x;var l=a.y;var u=i([],s,t.c2p);var c=i([],l,e.c2p);var f="M"+o(u,c,a.smoothing);var h=n.select(this);h.attr("d",f).style("stroke-width",a.width).style("stroke",a.color).style("fill","none")});c.exit().remove()}function v(t,e,r,i,o,u,c,f){var h=u.selectAll("text."+f).data(c);h.enter().append("text").classed(f,true);var p=0;var d={};h.each(function(o,u){var c;if(o.axis.tickangle==="auto"){c=s(i,e,r,o.xy,o.dxy)}else{var f=(o.axis.tickangle+180)*Math.PI/180;c=s(i,e,r,o.xy,[Math.cos(f),Math.sin(f)])}if(!u){d={angle:c.angle,flip:c.flip}}var h=(o.endAnchor?-1:1)*c.flip;var v=n.select(this).attr({"text-anchor":h>0?"start":"end","data-notex":1}).call(a.font,o.font).text(o.text).call(l.convertToTspans,t);var g=a.bBox(this);v.attr("transform","translate("+c.p[0]+","+c.p[1]+") "+"rotate("+c.angle+")"+"translate("+o.axis.labelpadding*h+","+g.height*.3+")");p=Math.max(p,g.width+o.axis.labelpadding)});h.exit().remove();d.maxExtent=p;return d}function g(t,e,r,n,a,i,o,l){var c,f,h,p;c=.5*(r.a[0]+r.a[r.a.length-1]);f=r.b[0];h=r.ab2xy(c,f,true);p=r.dxyda_rough(c,f);if(o.angle===undefined){u.extendFlat(o,s(r,a,i,h,r.dxydb_rough(c,f)))}x(t,e,r,n,h,p,r.aaxis,a,i,o,"a-title");c=r.a[0];f=.5*(r.b[0]+r.b[r.b.length-1]);h=r.ab2xy(c,f,true);p=r.dxydb_rough(c,f);if(l.angle===undefined){u.extendFlat(l,s(r,a,i,h,r.dxyda_rough(c,f)))}x(t,e,r,n,h,p,r.baxis,a,i,l,"b-title")}var m=c.LINE_SPACING;var y=(1-c.MID_SHIFT)/m+1;function x(t,e,r,i,o,u,c,f,h,p,d){var v=[];if(c.title)v.push(c.title);var g=e.selectAll("text."+d).data(v);var x=p.maxExtent;g.enter().append("text").classed(d,true);g.each(function(){var e=s(r,f,h,o,u);if(["start","both"].indexOf(c.showticklabels)===-1){x=0}var i=c.titlefont.size;x+=i+c.titleoffset;var d=p.angle+(p.flip<0?180:0);var v=(d-e.angle+450)%360;var g=v>90&&v<270;var b=n.select(this);b.text(c.title||"").call(l.convertToTspans,t);if(g){x=(-l.lineCount(b)+y)*m*i-x}b.attr("transform","translate("+e.p[0]+","+e.p[1]+") "+"rotate("+e.angle+") "+"translate(0,"+x+")").classed("user-select-none",true).attr("text-anchor","middle").call(a.font,c.titlefont)});g.exit().remove()}},{"../../components/drawing":583,"../../constants/alignment":656,"../../lib":684,"../../lib/svg_text_utils":708,"../../plots/get_data":768,"./makepath":875,"./map_1d_array":876,"./orient_text":877,d3:147}],879:[function(t,e,r){"use strict";var n=t("./constants");var a=t("../../lib/search").findBin;var i=t("./compute_control_points");var o=t("./create_spline_evaluator");var s=t("./create_i_derivative_evaluator");var l=t("./create_j_derivative_evaluator");e.exports=function t(e){var r=e._a;var u=e._b;var c=r.length;var f=u.length;var h=e.aaxis;var p=e.baxis;var d=r[0];var v=r[c-1];var g=u[0];var m=u[f-1];var y=r[r.length-1]-r[0];var x=u[u.length-1]-u[0];var b=y*n.RELATIVE_CULL_TOLERANCE;var _=x*n.RELATIVE_CULL_TOLERANCE;d-=b;v+=b;g-=_;m+=_;e.isVisible=function(t,e){return t>d&&t<v&&e>g&&e<m};e.isOccluded=function(t,e){return t<d||t>v||e<g||e>m};e.setScale=function(){var t=e._x;var r=e._y;var n=i(e._xctrl,e._yctrl,t,r,h.smoothing,p.smoothing);e._xctrl=n[0];e._yctrl=n[1];e.evalxy=o([e._xctrl,e._yctrl],c,f,h.smoothing,p.smoothing);e.dxydi=s([e._xctrl,e._yctrl],h.smoothing,p.smoothing);e.dxydj=l([e._xctrl,e._yctrl],h.smoothing,p.smoothing)};e.i2a=function(t){var e=Math.max(0,Math.floor(t[0]),c-2);var n=t[0]-e;return(1-n)*r[e]+n*r[e+1]};e.j2b=function(t){var e=Math.max(0,Math.floor(t[1]),c-2);var r=t[1]-e;return(1-r)*u[e]+r*u[e+1]};e.ij2ab=function(t){return[e.i2a(t[0]),e.j2b(t[1])]};e.a2i=function(t){var e=Math.max(0,Math.min(a(t,r),c-2));var n=r[e];var i=r[e+1];return Math.max(0,Math.min(c-1,e+(t-n)/(i-n)))};e.b2j=function(t){var e=Math.max(0,Math.min(a(t,u),f-2));var r=u[e];var n=u[e+1];return Math.max(0,Math.min(f-1,e+(t-r)/(n-r)))};e.ab2ij=function(t){return[e.a2i(t[0]),e.b2j(t[1])]};e.i2c=function(t,r){return e.evalxy([],t,r)};e.ab2xy=function(t,n,a){if(!a&&(t<r[0]||t>r[c-1]|n<u[0]||n>u[f-1])){return[false,false]}var i=e.a2i(t);var o=e.b2j(n);var s=e.evalxy([],i,o);if(a){var l=0;var h=0;var p=[];var d,v,g,m;if(t<r[0]){d=0;v=0;l=(t-r[0])/(r[1]-r[0])}else if(t>r[c-1]){d=c-2;v=1;l=(t-r[c-1])/(r[c-1]-r[c-2])}else{d=Math.max(0,Math.min(c-2,Math.floor(i)));v=i-d}if(n<u[0]){g=0;m=0;h=(n-u[0])/(u[1]-u[0])}else if(n>u[f-1]){g=f-2;m=1;h=(n-u[f-1])/(u[f-1]-u[f-2])}else{g=Math.max(0,Math.min(f-2,Math.floor(o)));m=o-g}if(l){e.dxydi(p,d,g,v,m);s[0]+=p[0]*l;s[1]+=p[1]*l}if(h){e.dxydj(p,d,g,v,m);s[0]+=p[0]*h;s[1]+=p[1]*h}}return s};e.c2p=function(t,e,r){return[e.c2p(t[0]),r.c2p(t[1])]};e.p2x=function(t,e,r){return[e.p2c(t[0]),r.p2c(t[1])]};e.dadi=function(t){var e=Math.max(0,Math.min(r.length-2,t));return r[e+1]-r[e]};e.dbdj=function(t){var e=Math.max(0,Math.min(u.length-2,t));return u[e+1]-u[e]};e.dxyda=function(t,r,n,a){var i=e.dxydi(null,t,r,n,a);var o=e.dadi(t,n);return[i[0]/o,i[1]/o]};e.dxydb=function(t,r,n,a){var i=e.dxydj(null,t,r,n,a);var o=e.dbdj(r,a);return[i[0]/o,i[1]/o]};e.dxyda_rough=function(t,r,n){var a=y*(n||.1);var i=e.ab2xy(t+a,r,true);var o=e.ab2xy(t-a,r,true);return[(i[0]-o[0])*.5/a,(i[1]-o[1])*.5/a]};e.dxydb_rough=function(t,r,n){var a=x*(n||.1);var i=e.ab2xy(t,r+a,true);var o=e.ab2xy(t,r-a,true);return[(i[0]-o[0])*.5/a,(i[1]-o[1])*.5/a]};e.dpdx=function(t){return t._m};e.dpdy=function(t){return t._m}}},{"../../lib/search":703,"./compute_control_points":867,"./constants":868,"./create_i_derivative_evaluator":869,"./create_j_derivative_evaluator":870,"./create_spline_evaluator":871}],880:[function(t,e,r){"use strict";var n=t("../../lib");e.exports=function t(e,r,a){var i,o,s;var l=[];var u=[];var c=e[0].length;var f=e.length;function h(t,r){var n=0;var a;var i=0;if(t>0&&(a=e[r][t-1])!==undefined){i++;n+=a}if(t<c-1&&(a=e[r][t+1])!==undefined){i++;n+=a}if(r>0&&(a=e[r-1][t])!==undefined){i++;n+=a}if(r<f-1&&(a=e[r+1][t])!==undefined){i++;n+=a}return n/Math.max(1,i)}var p=0;for(i=0;i<c;i++){for(o=0;o<f;o++){if(e[o][i]===undefined){l.push(i);u.push(o);e[o][i]=h(i,o)}p=Math.max(p,Math.abs(e[o][i]))}}if(!l.length)return e;var d,v,g,m,y,x,b,_,w,k,M;var A=1e-5;var T=0;var S=100;var E=0;var C=l.length;do{T=0;for(s=0;s<C;s++){i=l[s];o=u[s];var L=0;var I=0;var z,P,O,D,R,B;if(i===0){R=Math.min(c-1,2);O=r[R];D=r[1];z=e[o][R];P=e[o][1];I+=P+(P-z)*(r[0]-D)/(D-O);L++}else if(i===c-1){R=Math.max(0,c-3);O=r[R];D=r[c-2];z=e[o][R];P=e[o][c-2];I+=P+(P-z)*(r[c-1]-D)/(D-O);L++}if((i===0||i===c-1)&&(o>0&&o<f-1)){d=a[o+1]-a[o];v=a[o]-a[o-1];I+=(v*e[o+1][i]+d*e[o-1][i])/(v+d);L++}if(o===0){B=Math.min(f-1,2);O=a[B];D=a[1];z=e[B][i];P=e[1][i];I+=P+(P-z)*(a[0]-D)/(D-O);L++}else if(o===f-1){B=Math.max(0,f-3);O=a[B];D=a[f-2];z=e[B][i];P=e[f-2][i];I+=P+(P-z)*(a[f-1]-D)/(D-O);L++}if((o===0||o===f-1)&&(i>0&&i<c-1)){d=r[i+1]-r[i];v=r[i]-r[i-1];I+=(v*e[o][i+1]+d*e[o][i-1])/(v+d);L++}if(!L){g=r[i+1]-r[i];m=r[i]-r[i-1];y=a[o+1]-a[o];x=a[o]-a[o-1];b=g*m*(g+m);_=y*x*(y+x);I=(b*(x*e[o+1][i]+y*e[o-1][i])+_*(m*e[o][i+1]+g*e[o][i-1]))/(_*(m+g)+b*(x+y))}else{I/=L}w=I-e[o][i];k=w/p;T+=k*k;M=L?0:.85;e[o][i]+=w*(1+M)}T=Math.sqrt(T)}while(E++<S&&T>A);n.log("Smoother converged to",T,"after",E,"iterations");return e}},{"../../lib":684}],881:[function(t,e,r){"use strict";var n=t("../../lib").isArray1D;e.exports=function t(e,r,a){var i=a("x");var o=i&&i.length;var s=a("y");var l=s&&s.length;if(!o&&!l)return false;r._cheater=!i;if((!o||n(i))&&(!l||n(s))){var u=o?i.length:Infinity;if(l)u=Math.min(u,s.length);if(r.a&&r.a.length)u=Math.min(u,r.a.length);if(r.b&&r.b.length)u=Math.min(u,r.b.length);r._length=u}else r._length=null;return true}},{"../../lib":684}],882:[function(t,e,r){"use strict";var n=t("../scattergeo/attributes");var a=t("../../components/colorscale/attributes");var i=t("../../components/colorbar/attributes");var o=t("../../plots/attributes");var s=t("../../lib/extend").extendFlat;var l=n.marker.line;e.exports=s({locations:{valType:"data_array",editType:"calc"},locationmode:n.locationmode,z:{valType:"data_array",editType:"calc"},text:s({},n.text,{}),marker:{line:{color:l.color,width:s({},l.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:true,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:n.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:n.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:s({},o.hoverinfo,{editType:"calc",flags:["location","z","text","name"]})},a("",{cLetter:"z",editTypeOverride:"calc"}),{colorbar:i})},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../../plots/attributes":729,"../scattergeo/attributes":1053}],883:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../constants/numerical").BADNUM;var i=t("../../components/colorscale/calc");var o=t("../scatter/arrays_to_calcdata");var s=t("../scatter/calc_selection");e.exports=function t(e,r){var l=r._length;var u=new Array(l);for(var c=0;c<l;c++){var f=u[c]={};var h=r.locations[c];var p=r.z[c];f.loc=typeof h==="string"?h:null;f.z=n(p)?p:a}o(u,r);i(r,r.z,"","z");s(u,r);return u}},{"../../components/colorscale/calc":566,"../../constants/numerical":661,"../scatter/arrays_to_calcdata":1014,"../scatter/calc_selection":1017,"fast-isnumeric":214}],884:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../components/colorscale/defaults");var i=t("./attributes");e.exports=function t(e,r,o,s){function l(t,a){return n.coerce(e,r,i,t,a)}var u=l("locations");var c=l("z");if(!(u&&u.length&&n.isArrayOrTypedArray(c)&&c.length)){r.visible=false;return}r._length=Math.min(u.length,c.length);l("locationmode");l("text");l("marker.line.color");l("marker.line.width");l("marker.opacity");a(e,r,s,l,{prefix:"",cLetter:"z"});n.coerceSelectionMarkerOpacity(r,l)}},{"../../components/colorscale/defaults":568,"../../lib":684,"./attributes":882}],885:[function(t,e,r){"use strict";e.exports=function t(e,r){e.location=r.location;e.z=r.z;return e}},{}],886:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/axes");var a=t("./attributes");var i=t("../scatter/fill_hover_text");e.exports=function t(e,r,n){var a=e.cd;var i=a[0].trace;var s=e.subplot;var l,u,c,f;for(u=0;u<a.length;u++){l=a[u];f=false;if(l._polygons){for(c=0;c<l._polygons.length;c++){if(l._polygons[c].contains([r,n])){f=!f}if(l._polygons[c].contains([r+360,n])){f=!f}}if(f)break}}if(!f||!l)return;e.x0=e.x1=e.xa.c2p(l.ct);e.y0=e.y1=e.ya.c2p(l.ct);e.index=l.index;e.location=l.loc;e.z=l.z;o(e,i,l,s.mockAxis);return[e]};function o(t,e,r,o){var s=r.hi||e.hoverinfo;var l=s==="all"?a.hoverinfo.flags:s.split("+");var u=l.indexOf("name")!==-1;var c=l.indexOf("location")!==-1;var f=l.indexOf("z")!==-1;var h=l.indexOf("text")!==-1;var p=!u&&c;var d=[];function v(t){return n.tickText(o,o.c2l(t),"hover").text}if(p){t.nameOverride=r.loc}else{if(u)t.nameOverride=e.name;if(c)d.push(r.loc)}if(f)d.push(v(r.z));if(h){i(r,e,d)}t.extraText=d.join("<br>")}},{"../../plots/cartesian/axes":732,"../scatter/fill_hover_text":1022,"./attributes":882}],887:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.colorbar=t("../heatmap/colorbar");n.calc=t("./calc");n.plot=t("./plot");n.style=t("./style").style;n.styleOnSelect=t("./style").styleOnSelect;n.hoverPoints=t("./hover");n.eventData=t("./event_data");n.selectPoints=t("./select");n.moduleType="trace";n.name="choropleth";n.basePlotModule=t("../../plots/geo");n.categories=["geo","noOpacity"];n.meta={};e.exports=n},{"../../plots/geo":762,"../heatmap/colorbar":928,"./attributes":882,"./calc":883,"./defaults":884,"./event_data":885,"./hover":886,"./plot":888,"./select":889,"./style":890}],888:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../lib");var i=t("../../lib/polygon");var o=t("../../lib/topojson_utils").getTopojsonFeatures;var s=t("../../lib/geo_location_utils").locationToFeature;var l=t("./style").style;e.exports=function t(e,r,i){for(var o=0;o<i.length;o++){u(i[o],r.topojson)}function s(t){return t[0].trace.uid}var c=r.layers.backplot.select(".choroplethlayer").selectAll("g.trace.choropleth").data(i,s);c.enter().append("g").attr("class","trace choropleth");c.exit().remove();c.each(function(t){var r=t[0].node3=n.select(this);var i=r.selectAll("path.choroplethlocation").data(a.identity);i.enter().append("path").classed("choroplethlocation",true);i.exit().remove();l(e,t)})};function u(t,e){var r=t[0].trace;var n=t.length;var a=o(r,e);for(var i=0;i<n;i++){var l=t[i];var u=s(r.locationmode,l.loc,a);if(!u){l.geojson=null;continue}l.geojson=u;l.ct=u.properties.ct;l.index=i;l._polygons=c(u)}}function c(t){var e=t.geometry;var r=e.coordinates;var n=t.id;var a=[];var o,s,l,u;function c(t){for(var e=0;e<t.length-1;e++){if(t[e][0]>0&&t[e+1][0]<0)return e}return null}if(n==="RUS"||n==="FJI"){o=function(t){var e;if(c(t)===null){e=t}else{e=new Array(t.length);for(u=0;u<t.length;u++){e[u]=[t[u][0]<0?t[u][0]+360:t[u][0],t[u][1]]}}a.push(i.tester(e))}}else if(n==="ATA"){o=function(t){var e=c(t);if(e===null){return a.push(i.tester(t))}var r=new Array(t.length+1);var n=0;for(u=0;u<t.length;u++){if(u>e){r[n++]=[t[u][0]+360,t[u][1]]}else if(u===e){r[n++]=t[u];r[n++]=[t[u][0],-90]}else{r[n++]=t[u]}}var o=i.tester(r);o.pts.pop();a.push(o)}}else{o=function(t){a.push(i.tester(t))}}switch(e.type){case"MultiPolygon":for(s=0;s<r.length;s++){for(l=0;l<r[s].length;l++){o(r[s][l])}}break;case"Polygon":for(s=0;s<r.length;s++){o(r[s])}break}return a}},{"../../lib":684,"../../lib/geo_location_utils":676,"../../lib/polygon":696,"../../lib/topojson_utils":711,"./style":890,d3:147}],889:[function(t,e,r){"use strict";e.exports=function t(e,r){var n=e.cd;var a=e.xaxis;var i=e.yaxis;var o=[];var s,l,u,c,f;if(r===false){for(s=0;s<n.length;s++){n[s].selected=0}}else{for(s=0;s<n.length;s++){l=n[s];u=l.ct;if(!u)continue;c=a.c2p(u);f=i.c2p(u);if(r.contains([c,f])){o.push({pointNumber:s,lon:u[0],lat:u[1]});l.selected=1}else{l.selected=0}}}return o}},{}],890:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/color");var i=t("../../components/drawing");var o=t("../../components/colorscale");function s(t,e){if(e)l(t,e)}function l(t,e){var r=e[0].trace;var s=e[0].node3;var l=s.selectAll(".choroplethlocation");var u=r.marker||{};var c=u.line||{};var f=o.makeColorScaleFunc(o.extractScale(r.colorscale,r.zmin,r.zmax));l.each(function(t){n.select(this).attr("fill",f(t.z)).call(a.stroke,t.mlc||c.color).call(i.dashLine,"",t.mlw||c.width||0).style("opacity",u.opacity)});i.selectedPointStyle(l,r,t)}function u(t,e){var r=e[0].node3;var n=e[0].trace;if(n.selectedpoints){i.selectedPointStyle(r.selectAll(".choroplethlocation"),n,t)}else{l(t,e)}}e.exports={style:s,styleOnSelect:u}},{"../../components/color":558,"../../components/colorscale":573,"../../components/drawing":583,d3:147}],891:[function(t,e,r){"use strict";var n=t("../../components/colorscale/attributes");var a=t("../../components/colorbar/attributes");var i=t("../mesh3d/attributes");var o=t("../../plots/attributes");var s=t("../../lib/extend").extendFlat;var l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"}};s(l,n("",{colorAttr:"u/v/w norm",showScaleDflt:true,editTypeOverride:"calc"}),{colorbar:a});var u=["opacity","lightposition","lighting"];u.forEach(function(t){l[t]=i[t]});l.hoverinfo=s({},o.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"});e.exports=l},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../../plots/attributes":729,"../mesh3d/attributes":965}],892:[function(t,e,r){"use strict";var n=t("../../components/colorscale/calc");e.exports=function t(e,r){var a=r.u;var i=r.v;var o=r.w;var s=Math.min(r.x.length,r.y.length,r.z.length,a.length,i.length,o.length);var l=-Infinity;var u=Infinity;for(var c=0;c<s;c++){var f=a[c];var h=i[c];var p=o[c];var d=Math.sqrt(f*f+h*h+p*p);l=Math.max(l,d);u=Math.min(u,d)}r._len=s;r._normMax=l;n(r,[u,l],"","c")}},{"../../components/colorscale/calc":566}],893:[function(t,e,r){"use strict";var n=t("gl-cone3d");var a=t("gl-cone3d").createConeMesh;var i=t("../../lib").simpleMap;var o=t("../../lib/gl_format_color").parseColorScale;var s=t("../../plots/gl3d/zip3");function l(t,e){this.scene=t;this.uid=e;this.mesh=null;this.data=null}var u=l.prototype;u.handlePick=function(t){if(t.object===this.mesh){var e=t.index=t.data.index;var r=this.data.x[e];var n=this.data.y[e];var a=this.data.z[e];var i=this.data.u[e];var o=this.data.v[e];var s=this.data.w[e];t.traceCoordinate=[r,n,a,i,o,s,Math.sqrt(i*i+o*o+s*s)];var l=this.data.text;if(Array.isArray(l)&&l[e]!==undefined){t.textLabel=l[e]}else if(l){t.textLabel=l}return true}};var c={xaxis:0,yaxis:1,zaxis:2};var f={tip:1,tail:0,cm:.25,center:.5};var h={tip:1,tail:1,cm:.75,center:.5};function p(t,e){var r=t.fullSceneLayout;var a=t.dataScale;var l={};function u(t,e){var n=r[e];var o=a[c[e]];return i(t,function(t){return n.d2l(t)*o})}l.vectors=s(u(e.u,"xaxis"),u(e.v,"yaxis"),u(e.w,"zaxis"),e._len);l.positions=s(u(e.x,"xaxis"),u(e.y,"yaxis"),u(e.z,"zaxis"),e._len);l.colormap=o(e.colorscale);l.vertexIntensityBounds=[e.cmin/e._normMax,e.cmax/e._normMax];l.coneOffset=f[e.anchor];if(e.sizemode==="scaled"){l.coneSize=e.sizeref||.5}else{l.coneSize=e.sizeref&&e._normMax?e.sizeref/e._normMax:.5}var p=n(l);var d=e.lightposition;p.lightPosition=[d.x,d.y,d.z];p.ambient=e.lighting.ambient;p.diffuse=e.lighting.diffuse;p.specular=e.lighting.specular;p.roughness=e.lighting.roughness;p.fresnel=e.lighting.fresnel;p.opacity=e.opacity;e._pad=h[e.anchor]*p.vectorScale*p.coneScale*e._normMax;return p}u.update=function(t){this.data=t;var e=p(this.scene,t);this.mesh.update(e)};u.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function d(t,e){var r=t.glplot.gl;var n=p(t,e);var i=a(r,n);var o=new l(t,e.uid);o.mesh=i;o.data=e;i._trace=o;t.glplot.add(i);return o}e.exports=d},{"../../lib":684,"../../lib/gl_format_color":680,"../../plots/gl3d/zip3":785,"gl-cone3d":231}],894:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../components/colorscale/defaults");var i=t("./attributes");e.exports=function t(e,r,o,s){function l(t,a){return n.coerce(e,r,i,t,a)}var u=l("u");var c=l("v");var f=l("w");var h=l("x");var p=l("y");var d=l("z");if(!u||!u.length||!c||!c.length||!f||!f.length||!h||!h.length||!p||!p.length||!d||!d.length){r.visible=false;return}l("sizeref");l("sizemode");l("anchor");l("lighting.ambient");l("lighting.diffuse");l("lighting.specular");l("lighting.roughness");l("lighting.fresnel");l("lightposition.x");l("lightposition.y");l("lightposition.z");a(e,r,s,l,{prefix:"",cLetter:"c"});l("text");r._length=null}},{"../../components/colorscale/defaults":568,"../../lib":684,"./attributes":891}],895:[function(t,e,r){"use strict";e.exports={moduleType:"trace",name:"cone",basePlotModule:t("../../plots/gl3d"),categories:["gl3d"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:t("./calc"),plot:t("./convert"),meta:{}}},{"../../plots/gl3d":774,"./attributes":891,"./calc":892,"./convert":893,"./defaults":894}],896:[function(t,e,r){"use strict";var n=t("../heatmap/attributes");var a=t("../scatter/attributes");var i=t("../../components/colorscale/attributes");var o=t("../../components/colorbar/attributes");var s=t("../../components/drawing/attributes").dash;var l=t("../../plots/font_attributes");var u=t("../../lib/extend").extendFlat;var c=t("../../constants/filter_ops");var f=c.COMPARISON_OPS2;var h=c.INTERVAL_OPS;var p=a.line;e.exports=u({z:n.z,x:n.x,x0:n.x0,dx:n.dx,y:n.y,y0:n.y0,dy:n.dy,text:n.text,transpose:n.transpose,xtype:n.xtype,ytype:n.ytype,zhoverformat:n.zhoverformat,connectgaps:n.connectgaps,fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:true,editType:"calc",impliedEdits:{"contours.start":undefined,"contours.end":undefined,"contours.size":undefined}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":false}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":false}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":false}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:true,editType:"plot"},showlabels:{valType:"boolean",dflt:false,editType:"plot"},labelfont:l({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot"},operation:{valType:"enumerated",values:[].concat(f).concat(h),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:false}},line:{color:u({},p.color,{editType:"style+colorbars"}),width:u({},p.width,{editType:"style+colorbars"}),dash:s,smoothing:u({},p.smoothing,{}),editType:"plot"}},i("",{cLetter:"z",autoColorDflt:false,editTypeOverride:"calc"}),{colorbar:o})},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../components/drawing/attributes":582,"../../constants/filter_ops":657,"../../lib/extend":673,"../../plots/font_attributes":758,"../heatmap/attributes":925,"../scatter/attributes":1015}],897:[function(t,e,r){"use strict";var n=t("../heatmap/calc");var a=t("./set_contours");e.exports=function t(e,r){var i=n(e,r);a(r);return i}},{"../heatmap/calc":926,"./set_contours":915}],898:[function(t,e,r){"use strict";e.exports=function(t,e,r,n){var a,i,o;var s=t[0];var l=s.x.length;var u=s.y.length;var c=s.z;var f=n.contours;var h=-Infinity;var p=Infinity;for(a=0;a<u;a++){p=Math.min(p,c[a][0]);p=Math.min(p,c[a][l-1]);h=Math.max(h,c[a][0]);h=Math.max(h,c[a][l-1])}for(a=1;a<l-1;a++){p=Math.min(p,c[0][a]);p=Math.min(p,c[u-1][a]);h=Math.max(h,c[0][a]);h=Math.max(h,c[u-1][a])}s.prefixBoundary=false;switch(e){case">":if(f.value>h){s.prefixBoundary=true}break;case"<":if(f.value<p){s.prefixBoundary=true}break;case"[]":i=Math.min.apply(null,f.value);o=Math.max.apply(null,f.value);if(o<p||i>h){s.prefixBoundary=true}break;case"][":i=Math.min.apply(null,f.value);o=Math.max.apply(null,f.value);if(i<p&&o>h){s.prefixBoundary=true}break}}},{}],899:[function(t,e,r){"use strict";var n=t("../../components/colorbar/draw");var a=t("./make_color_map");var i=t("./end_plus");e.exports=function t(e,r){var o=r[0].trace,s="cb"+o.uid;e._fullLayout._infolayer.selectAll("."+s).remove();if(!o.showscale)return;var l=n(e,s);r[0].t.cb=l;var u=o.contours,c=o.line,f=u.size||1,h=u.coloring;var p=a(o,{isColorbar:true});if(h==="heatmap"){l.filllevels({start:o.zmin,end:o.zmax,size:(o.zmax-o.zmin)/254})}l.fillcolor(h==="fill"||h==="heatmap"?p:"").line({color:h==="lines"?p:c.color,width:u.showlines!==false?c.width:0,dash:c.dash}).levels({start:u.start,end:i(u),size:f}).options(o.colorbar)()}},{"../../components/colorbar/draw":563,"./end_plus":907,"./make_color_map":912}],900:[function(t,e,r){"use strict";e.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],901:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("./label_defaults");var i=t("../../components/color");var o=i.addOpacity;var s=i.opacity;var l=t("../../constants/filter_ops");var u=l.CONSTRAINT_REDUCTION;var c=l.COMPARISON_OPS2;e.exports=function t(e,r,n,i,l,c){var h=r.contours;var p,d,v;var g=n("contours.operation");h._operation=u[g];f(n,h);if(g==="="){p=h.showlines=true}else{p=n("contours.showlines");v=n("fillcolor",o((e.line||{}).color||l,.5))}if(p){var m=v&&s(v)?o(r.fillcolor,1):l;d=n("line.color",m);n("line.width",2);n("line.dash")}n("line.smoothing");a(n,i,d,c)};function f(t,e){var r;if(c.indexOf(e.operation)===-1){t("contours.value",[0,1]);if(!Array.isArray(e.value)){if(n(e.value)){r=parseFloat(e.value);e.value=[r,r+1]}}else if(e.value.length>2){e.value=e.value.slice(2)}else if(e.length===0){e.value=[0,1]}else if(e.length<2){r=parseFloat(e.value[0]);e.value=[r,r+1]}else{e.value=[parseFloat(e.value[0]),parseFloat(e.value[1])]}}else{t("contours.value",0);if(!n(e.value)){if(Array.isArray(e.value)){e.value=parseFloat(e.value[0])}else{e.value=0}}}}},{"../../components/color":558,"../../constants/filter_ops":657,"./label_defaults":911,"fast-isnumeric":214}],902:[function(t,e,r){"use strict";var n=t("../../constants/filter_ops");var a=t("fast-isnumeric");e.exports={"[]":o("[]"),"][":o("]["),">":s(">"),"<":s("<"),"=":s("=")};function i(t,e){var r=Array.isArray(e);var i;function o(t){return a(t)?+t:null}if(n.COMPARISON_OPS2.indexOf(t)!==-1){i=r?o(e[0]):o(e)}else if(n.INTERVAL_OPS.indexOf(t)!==-1){i=r?[o(e[0]),o(e[1])]:[o(e),o(e)]}else if(n.SET_OPS.indexOf(t)!==-1){i=r?e.map(o):[o(e)]}return i}function o(t){return function(e){e=i(t,e);var r=Math.min(e[0],e[1]);var n=Math.max(e[0],e[1]);return{start:r,end:n,size:n-r}}}function s(t){return function(e){e=i(t,e);return{start:e,end:Infinity,size:Infinity}}}},{"../../constants/filter_ops":657,"fast-isnumeric":214}],903:[function(t,e,r){"use strict";e.exports=function t(e,r,n,a){var i=a("contours.start");var o=a("contours.end");var s=i===false||o===false;var l=n("contours.size");var u;if(s)u=r.autocontour=true;else u=n("autocontour",false);if(u||!l)n("ncontours")}},{}],904:[function(t,e,r){"use strict";var n=t("../../lib");e.exports=function(t,e){var r,i,o;var s=function(t){return t.reverse()};var l=function(t){return t};switch(e){case"=":case"<":return t;case">":if(t.length!==1){n.warn("Contour data invalid for the specified inequality operation.")}i=t[0];for(r=0;r<i.edgepaths.length;r++){i.edgepaths[r]=s(i.edgepaths[r])}for(r=0;r<i.paths.length;r++){i.paths[r]=s(i.paths[r])}return t;case"][":var u=s;s=l;l=u;case"[]":if(t.length!==2){n.warn("Contour data invalid for the specified inequality range operation.")}i=a(t[0]);o=a(t[1]);for(r=0;r<i.edgepaths.length;r++){i.edgepaths[r]=s(i.edgepaths[r])}for(r=0;r<i.paths.length;r++){i.paths[r]=s(i.paths[r])}while(o.edgepaths.length){i.edgepaths.push(l(o.edgepaths.shift()))}while(o.paths.length){i.paths.push(l(o.paths.shift()))}return[i]}};function a(t){return n.extendFlat({},t,{edgepaths:n.extendDeep([],t.edgepaths),paths:n.extendDeep([],t.paths)})}},{"../../lib":684}],905:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../heatmap/xyz_defaults");var i=t("./constraint_defaults");var o=t("./contours_defaults");var s=t("./style_defaults");var l=t("./attributes");e.exports=function t(e,r,u,c){function f(t,a){return n.coerce(e,r,l,t,a)}function h(t){return n.coerce2(e,r,l,t)}var p=a(e,r,f,c);if(!p){r.visible=false;return}f("text");var d=f("contours.type")==="constraint";f("connectgaps",n.isArray1D(r.z));if(!d)delete r.showlegend;if(d){i(e,r,f,c,u)}else{o(e,r,f,h);s(e,r,f,c)}}},{"../../lib":684,"../heatmap/xyz_defaults":940,"./attributes":896,"./constraint_defaults":901,"./contours_defaults":903,"./style_defaults":917}],906:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./constraint_mapping");var i=t("./end_plus");e.exports=function t(e,r,o){var s=e.type==="constraint"?a[e._operation](e.value):e;var l=s.size;var u=[];var c=i(s);var f=o.trace._carpetTrace;var h=f?{xaxis:f.aaxis,yaxis:f.baxis,x:o.a,y:o.b}:{xaxis:r.xaxis,yaxis:r.yaxis,x:o.x,y:o.y};for(var p=s.start;p<c;p+=l){u.push(n.extendFlat({level:p,crossings:{},starts:[],edgepaths:[],paths:[],z:o.z,smoothing:o.trace.line.smoothing},h));if(u.length>1e3){n.warn("Too many contours, clipping at 1000",e);break}}return u}},{"../../lib":684,"./constraint_mapping":902,"./end_plus":907}],907:[function(t,e,r){"use strict";e.exports=function t(e){return e.end+e.size/1e6}},{}],908:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./constants");e.exports=function t(e,r,a){var i,o,l,u,c;r=r||.01;a=a||.01;for(l=0;l<e.length;l++){u=e[l];for(c=0;c<u.starts.length;c++){o=u.starts[c];s(u,o,"edge",r,a)}i=0;while(Object.keys(u.crossings).length&&i<1e4){i++;o=Object.keys(u.crossings)[0].split(",").map(Number);s(u,o,undefined,r,a)}if(i===1e4)n.log("Infinite loop in contour?")}};function i(t,e,r,n){return Math.abs(t[0]-e[0])<r&&Math.abs(t[1]-e[1])<n}function o(t,e){var r=t[2]-e[2],n=t[3]-e[3];return Math.sqrt(r*r+n*n)}function s(t,e,r,s,c){var f=e.join(",");var h=f;var p=t.crossings[h];var d=l(p,r,e);var v=[u(t,e,[-d[0],-d[1]])];var g=d.join(",");var m=t.z.length;var y=t.z[0].length;var x;for(x=0;x<1e4;x++){if(p>20){p=a.CHOOSESADDLE[p][(d[0]||d[1])<0?0:1];t.crossings[h]=a.SADDLEREMAINDER[p]}else{delete t.crossings[h]}d=a.NEWDELTA[p];if(!d){n.log("Found bad marching index:",p,e,t.level);break}v.push(u(t,e,d));e[0]+=d[0];e[1]+=d[1];if(i(v[v.length-1],v[v.length-2],s,c))v.pop();h=e.join(",");var b=d[0]&&(e[0]<0||e[0]>y-2)||d[1]&&(e[1]<0||e[1]>m-2),_=h===f&&d.join(",")===g;if(_||r&&b)break;p=t.crossings[h]}if(x===1e4){n.log("Infinite loop in contour?")}var w=i(v[0],v[v.length-1],s,c);var k=0;var M=.2*t.smoothing;var A=[];var T=0;var S,E,C,L,I,z,P,O,D,R,B;for(x=1;x<v.length;x++){P=o(v[x],v[x-1]);k+=P;A.push(P)}var F=k/A.length*M;function N(t){return v[t%v.length]}for(x=v.length-2;x>=T;x--){S=A[x];if(S<F){C=0;for(E=x-1;E>=T;E--){if(S+A[E]<F){S+=A[E]}else break}if(w&&x===v.length-2){for(C=0;C<E;C++){if(S+A[C]<F){S+=A[C]}else break}}I=x-E+C+1;z=Math.floor((x+E+C+2)/2);if(!w&&x===v.length-2)L=v[v.length-1];else if(!w&&E===-1)L=v[0];else if(I%2)L=N(z);else{L=[(N(z)[0]+N(z+1)[0])/2,(N(z)[1]+N(z+1)[1])/2]}v.splice(E+1,x-E+1,L);x=E+1;if(C)T=C;if(w){if(x===v.length-2)v[C]=v[v.length-1];else if(x===0)v[v.length-1]=v[0]}}}v.splice(0,T);for(x=0;x<v.length;x++)v[x].length=2;if(v.length<2)return;else if(w){v.pop();t.paths.push(v)}else{if(!r){n.log("Unclosed interior contour?",t.level,f,v.join("L"))}var j=false;for(O=0;O<t.edgepaths.length;O++){R=t.edgepaths[O];if(!j&&i(R[0],v[v.length-1],s,c)){v.pop();j=true;var V=false;for(D=0;D<t.edgepaths.length;D++){B=t.edgepaths[D];if(i(B[B.length-1],v[0],s,c)){V=true;v.shift();t.edgepaths.splice(O,1);if(D===O){t.paths.push(v.concat(B))}else{if(D>O)D--;t.edgepaths[D]=B.concat(v,R)}break}}if(!V){t.edgepaths[O]=v.concat(R)}}}for(O=0;O<t.edgepaths.length;O++){if(j)break;R=t.edgepaths[O];if(i(R[R.length-1],v[0],s,c)){v.shift();t.edgepaths[O]=R.concat(v);j=true}}if(!j)t.edgepaths.push(v)}}function l(t,e,r){var n=0,i=0;if(t>20&&e){if(t===208||t===1114){n=r[0]===0?1:-1}else{i=r[1]===0?1:-1}}else if(a.BOTTOMSTART.indexOf(t)!==-1)i=1;else if(a.LEFTSTART.indexOf(t)!==-1)n=1;else if(a.TOPSTART.indexOf(t)!==-1)i=-1;else n=-1;return[n,i]}function u(t,e,r){var n=e[0]+Math.max(r[0],0),a=e[1]+Math.max(r[1],0),i=t.z[a][n],o=t.xaxis,s=t.yaxis;if(r[1]){var l=(t.level-i)/(t.z[a][n+1]-i);return[o.c2p((1-l)*t.x[n]+l*t.x[n+1],true),s.c2p(t.y[a],true),n+l,a]}else{var u=(t.level-i)/(t.z[a+1][n]-i);return[o.c2p(t.x[n],true),s.c2p((1-u)*t.y[a]+u*t.y[a+1],true),n,a+u]}}},{"../../lib":684,"./constants":900}],909:[function(t,e,r){"use strict";var n=t("../../components/color");var a=t("../heatmap/hover");e.exports=function t(e,r,i,o,s){var l=a(e,r,i,o,s,true);if(l){l.forEach(function(t){var e=t.trace;if(e.contours.type==="constraint"){if(e.fillcolor&&n.opacity(e.fillcolor)){t.color=n.addOpacity(e.fillcolor,1)}else if(e.contours.showlines&&n.opacity(e.line.color)){t.color=n.addOpacity(e.line.color,1)}}})}return l}},{"../../components/color":558,"../heatmap/hover":932}],910:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.calc=t("./calc");n.plot=t("./plot").plot;n.style=t("./style");n.colorbar=t("./colorbar");n.hoverPoints=t("./hover");n.moduleType="trace";n.name="contour";n.basePlotModule=t("../../plots/cartesian");n.categories=["cartesian","svg","2dMap","contour","showLegend"];n.meta={};e.exports=n},{"../../plots/cartesian":743,"./attributes":896,"./calc":897,"./colorbar":899,"./defaults":905,"./hover":909,"./plot":914,"./style":916}],911:[function(t,e,r){"use strict";var n=t("../../lib");e.exports=function t(e,r,a,i){if(!i)i={};var o=e("contours.showlabels");if(o){var s=r.font;n.coerceFont(e,"contours.labelfont",{family:s.family,size:s.size,color:a});e("contours.labelformat")}if(i.hasHover!==false)e("zhoverformat")}},{"../../lib":684}],912:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/colorscale");var i=t("./end_plus");e.exports=function t(e){var r=e.contours,o=r.start,s=i(r),l=r.size||1,u=Math.floor((s-o)/l)+1,c=r.coloring==="lines"?0:1;if(!isFinite(l)){l=1;u=1}var f=e.colorscale,h=f.length;var p=new Array(h),d=new Array(h);var v,g;if(r.coloring==="heatmap"){if(e.zauto&&e.autocontour===false){e.zmin=o-l/2;e.zmax=e.zmin+u*l}for(g=0;g<h;g++){v=f[g];p[g]=v[0]*(e.zmax-e.zmin)+e.zmin;d[g]=v[1]}var m=n.extent([e.zmin,e.zmax,r.start,r.start+l*(u-1)]),y=m[e.zmin<e.zmax?0:1],x=m[e.zmin<e.zmax?1:0];if(y!==e.zmin){p.splice(0,0,y);d.splice(0,0,Range[0])}if(x!==e.zmax){p.push(x);d.push(d[d.length-1])}}else{for(g=0;g<h;g++){v=f[g];p[g]=(v[0]*(u+c-1)-c/2)*l+o;d[g]=v[1]}}return a.makeColorScaleFunc({domain:p,range:d},{noNumericCheck:true})}},{"../../components/colorscale":573,"./end_plus":907,d3:147}],913:[function(t,e,r){"use strict";var n=t("./constants");e.exports=function t(e){var r=e[0].z,i=r.length,o=r[0].length,s=i===2||o===2,l,u,c,f,h,p,d,v,g;for(u=0;u<i-1;u++){f=[];if(u===0)f=f.concat(n.BOTTOMSTART);if(u===i-2)f=f.concat(n.TOPSTART);for(l=0;l<o-1;l++){c=f.slice();if(l===0)c=c.concat(n.LEFTSTART);if(l===o-2)c=c.concat(n.RIGHTSTART);h=l+","+u;p=[[r[u][l],r[u][l+1]],[r[u+1][l],r[u+1][l+1]]];for(g=0;g<e.length;g++){v=e[g];d=a(v.level,p);if(!d)continue;v.crossings[h]=d;if(c.indexOf(d)!==-1){v.starts.push([l,u]);if(s&&c.indexOf(d,c.indexOf(d)+1)!==-1){v.starts.push([l,u])}}}}}};function a(t,e){var r=(e[0][0]>t?0:1)+(e[0][1]>t?0:2)+(e[1][1]>t?0:4)+(e[1][0]>t?0:8);if(r===5||r===10){var n=(e[0][0]+e[0][1]+e[1][0]+e[1][1])/4;if(t>n)return r===5?713:1114;return r===5?104:208}return r===15?0:r}},{"./constants":900}],914:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../lib");var i=t("../../components/drawing");var o=t("../../lib/svg_text_utils");var s=t("../../plots/cartesian/axes");var l=t("../../plots/cartesian/set_convert");var u=t("../../plots/get_data").getUidsFromCalcData;var c=t("../heatmap/plot");var f=t("./make_crossings");var h=t("./find_all_paths");var p=t("./empty_pathinfo");var d=t("./convert_to_constraints");var v=t("./close_boundaries");var g=t("./constants");var m=g.LABELOPTIMIZER;r.plot=function t(e,r,a,i){var o=u(a);i.selectAll("g.contour").each(function(t){if(!o[t.trace.uid]){n.select(this).remove()}});for(var s=0;s<a.length;s++){y(e,r,a[s],i)}};function y(t,e,n,i){var o=n[0].trace;var s=n[0].x;var l=n[0].y;var u=o.contours;var g="contour"+o.uid;var m=e.xaxis;var y=e.yaxis;var _=t._fullLayout;var w=p(u,e,n[0]);var M=a.ensureSingle(i,"g","heatmapcoloring");var T=[];if(u.coloring==="heatmap"){if(o.zauto&&o.autocontour===false){o._input.zmin=o.zmin=u.start-u.size/2;o._input.zmax=o.zmax=o.zmin+w.length*u.size}T=[n]}c(t,e,T,M);f(w);h(w);var S=m.c2p(s[0],true),E=m.c2p(s[s.length-1],true),C=y.c2p(l[0],true),L=y.c2p(l[l.length-1],true),I=[[S,L],[E,L],[E,C],[S,C]];var z=w;if(u.type==="constraint"){z=d(w,u._operation);v(z,u._operation,I,o)}var P=r.makeContourGroup(i,n,g);x(P,I,u);b(P,z,I,u);k(P,w,t,n[0],u,I);A(P,e,_._clips,n[0],I)}r.makeContourGroup=function(t,e,r){var n=t.selectAll("g.contour."+r).data(e);n.enter().append("g").classed("contour",true).classed(r,true);n.exit().remove();return n};function x(t,e,r){var n=a.ensureSingle(t,"g","contourbg");var i=n.selectAll("path").data(r.coloring==="fill"?[0]:[]);i.enter().append("path");i.exit().remove();i.attr("d","M"+e.join("L")+"Z").style("stroke","none")}function b(t,e,r,i){var o=a.ensureSingle(t,"g","contourfill");var s=o.selectAll("path").data(i.coloring==="fill"||i.type==="constraint"&&i._operation!=="="?e:[]);s.enter().append("path");s.exit().remove();s.each(function(t){var e=w(t,r);if(!e)n.select(this).remove();else n.select(this).attr("d",e).style("stroke","none")})}function _(t,e){var r=t.prefixBoundary;if(r===undefined){var n=Math.min(t.z[0][0],t.z[0][1]);r=!t.edgepaths.length&&n>t.level}if(r){return"M"+e.join("L")+"Z"}return""}function w(t,e){var r=_(t,e),n=0,o=t.edgepaths.map(function(t,e){return e}),s=true,l,u,c,f,h,p;function d(t){return Math.abs(t[1]-e[0][1])<.01}function v(t){return Math.abs(t[1]-e[2][1])<.01}function g(t){return Math.abs(t[0]-e[0][0])<.01}function m(t){return Math.abs(t[0]-e[2][0])<.01}while(o.length){p=i.smoothopen(t.edgepaths[n],t.smoothing);r+=s?p:p.replace(/^M/,"L");o.splice(o.indexOf(n),1);l=t.edgepaths[n][t.edgepaths[n].length-1];f=-1;for(c=0;c<4;c++){if(!l){a.log("Missing end?",n,t);break}if(d(l)&&!m(l))u=e[1];else if(g(l))u=e[0];else if(v(l))u=e[3];else if(m(l))u=e[2];for(h=0;h<t.edgepaths.length;h++){var y=t.edgepaths[h][0];if(Math.abs(l[0]-u[0])<.01){if(Math.abs(l[0]-y[0])<.01&&(y[1]-l[1])*(u[1]-y[1])>=0){u=y;f=h}}else if(Math.abs(l[1]-u[1])<.01){if(Math.abs(l[1]-y[1])<.01&&(y[0]-l[0])*(u[0]-y[0])>=0){u=y;f=h}}else{a.log("endpt to newendpt is not vert. or horz.",l,u,y)}}l=u;if(f>=0)break;r+="L"+u}if(f===t.edgepaths.length){a.log("unclosed perimeter path");break}n=f;s=o.indexOf(n)===-1;if(s){n=o[0];r+="Z"}}for(n=0;n<t.paths.length;n++){r+=i.smoothclosed(t.paths[n],t.smoothing)}return r}function k(t,e,o,s,l,u){var c=a.ensureSingle(t,"g","contourlines");var f=l.showlines!==false;var h=l.showlabels;var p=f&&h;var d=r.createLines(c,f||h,e);var v=r.createLineClip(c,p,o._fullLayout._clips,s.trace.uid);var m=t.selectAll("g.contourlabels").data(h?[0]:[]);m.exit().remove();m.enter().append("g").classed("contourlabels",true);if(h){var y=[u];var x=[];a.clearLocationCache();var b=r.labelFormatter(l,s.t.cb,o._fullLayout);var _=i.tester.append("text").attr("data-notex",1).call(i.font,l.labelfont);var w=e[0].xaxis._length;var k=e[0].yaxis._length;var M={left:Math.max(u[0][0],0),right:Math.min(u[2][0],w),top:Math.max(u[0][1],0),bottom:Math.min(u[2][1],k)};M.middle=(M.top+M.bottom)/2;M.center=(M.left+M.right)/2;var A=Math.sqrt(w*w+k*k);var T=g.LABELDISTANCE*A/Math.max(1,e.length/g.LABELINCREASE);d.each(function(t){var e=r.calcTextOpts(t.level,b,_,o);n.select(this).selectAll("path").each(function(){var t=this;var n=a.getVisibleSegment(t,M,e.height/2);if(!n)return;if(n.len<(e.width+e.height)*g.LABELMIN)return;var i=Math.min(Math.ceil(n.len/T),g.LABELMAX);for(var o=0;o<i;o++){var s=r.findBestTextLocation(t,n,e,x,M);if(!s)break;r.addLabelData(s,e,x,y)}})});_.remove();r.drawLabels(m,x,o,v,p?y:null)}if(h&&!f)d.remove()}r.createLines=function(t,e,r){var n=r[0].smoothing;var a=t.selectAll("g.contourlevel").data(e?r:[]);a.exit().remove();a.enter().append("g").classed("contourlevel",true);if(e){var o=a.selectAll("path.openline").data(function(t){return t.pedgepaths||t.edgepaths});o.exit().remove();o.enter().append("path").classed("openline",true);o.attr("d",function(t){return i.smoothopen(t,n)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var s=a.selectAll("path.closedline").data(function(t){return t.ppaths||t.paths});s.exit().remove();s.enter().append("path").classed("closedline",true);s.attr("d",function(t){return i.smoothclosed(t,n)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return a};r.createLineClip=function(t,e,r,n){var a=e?"clipline"+n:null;var o=r.selectAll("#"+a).data(e?[0]:[]);o.exit().remove();o.enter().append("clipPath").classed("contourlineclip",true).attr("id",a);i.setClipUrl(t,a);return o};r.labelFormatter=function(t,e,r){if(t.labelformat){return r._d3locale.numberFormat(t.labelformat)}else{var n;if(e){n=e.axis}else{n={type:"linear",_id:"ycontour",showexponent:"all"};if(t.type==="constraint"){var a=t.value;if(Array.isArray(a)){n.range=[a[0],a[a.length-1]]}else n.range=[a,a]}else{n.range=[t.start,t.end];n.nticks=(t.end-t.start)/t.size}if(n.range[0]===n.range[1]){n.range[1]+=n.range[0]||1}if(!n.nticks)n.nticks=1e3;l(n,r);s.prepTicks(n);n._tmin=null;n._tmax=null}return function(t){return s.tickText(n,t).text}}};r.calcTextOpts=function(t,e,r,n){var a=e(t);r.text(a).call(o.convertToTspans,n);var s=i.bBox(r.node(),true);return{text:a,width:s.width,height:s.height,level:t,dy:(s.top+s.bottom)/2}};r.findBestTextLocation=function(t,e,r,n,i){var o=r.width;var s,l,u,c,f;if(e.isClosed){l=e.len/m.INITIALSEARCHPOINTS;s=e.min+l/2;u=e.max}else{l=(e.len-o)/(m.INITIALSEARCHPOINTS+1);s=e.min+l+o/2;u=e.max-(l+o)/2}var h=Infinity;for(var p=0;p<m.ITERATIONS;p++){for(var d=s;d<u;d+=l){var v=a.getTextLocation(t,e.total,d,o);var g=M(v,r,n,i);if(g<h){h=g;f=v;c=d}}if(h>m.MAXCOST*2)break;if(p)l/=2;s=c-l/2;u=s+l*1.5}if(h<=m.MAXCOST)return f};function M(t,e,r,n){var i=e.width/2;var o=e.height/2;var s=t.x;var l=t.y;var u=t.theta;var c=Math.cos(u)*i;var f=Math.sin(u)*i;var h=(s>n.center?n.right-s:s-n.left)/(c+Math.abs(Math.sin(u)*o));var p=(l>n.middle?n.bottom-l:l-n.top)/(Math.abs(f)+Math.cos(u)*o);if(h<1||p<1)return Infinity;var d=m.EDGECOST*(1/(h-1)+1/(p-1));d+=m.ANGLECOST*u*u;var v=s-c;var g=l-f;var y=s+c;var x=l+f;for(var b=0;b<r.length;b++){var _=r[b];var w=Math.cos(_.theta)*_.width/2;var k=Math.sin(_.theta)*_.width/2;var M=a.segmentDistance(v,g,y,x,_.x-w,_.y-k,_.x+w,_.y+k)*2/(e.height+_.height);var A=_.level===e.level;var T=A?m.SAMELEVELDISTANCE:1;if(M<=T)return Infinity;var S=m.NEIGHBORCOST*(A?m.SAMELEVELFACTOR:1);d+=S/(M-T)}return d}r.addLabelData=function(t,e,r,n){var a=e.width/2;var i=e.height/2;var o=t.x;var s=t.y;var l=t.theta;var u=Math.sin(l);var c=Math.cos(l);var f=a*c;var h=i*u;var p=a*u;var d=-i*c;var v=[[o-f-h,s-p-d],[o+f-h,s+p-d],[o+f+h,s+p+d],[o-f+h,s-p+d]];r.push({text:e.text,x:o,y:s,dy:e.dy,theta:l,level:e.level,width:e.width,height:e.height});n.push(v)};r.drawLabels=function(t,e,r,i,s){var l=t.selectAll("text").data(e,function(t){return t.text+","+t.x+","+t.y+","+t.theta});l.exit().remove();l.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(t){var e=t.x+Math.sin(t.theta)*t.dy;var a=t.y-Math.cos(t.theta)*t.dy;n.select(this).text(t.text).attr({x:e,y:a,transform:"rotate("+180*t.theta/Math.PI+" "+e+" "+a+")"}).call(o.convertToTspans,r)});if(s){var u="";for(var c=0;c<s.length;c++){u+="M"+s[c].join("L")+"Z"}var f=a.ensureSingle(i,"path","");f.attr("d",u)}};function A(t,e,r,n,o){var s="clip"+n.trace.uid;var l=r.selectAll("#"+s).data(n.trace.connectgaps?[]:[0]);l.enter().append("clipPath").classed("contourclip",true).attr("id",s);l.exit().remove();if(n.trace.connectgaps===false){var u={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:e.xaxis,yaxis:e.yaxis,x:n.x,y:n.y,z:T(n),smoothing:0};f([u]);h([u]);var c=w(u,o);var p=a.ensureSingle(l,"path","");p.attr("d",c)}else s=null;t.call(i.setClipUrl,s);e.plot.selectAll(".hm"+n.trace.uid).call(i.setClipUrl,s)}function T(t){var e=t.trace._emptypoints,r=[],n=t.z.length,a=t.z[0].length,i,o=[],s;for(i=0;i<a;i++)o.push(1);for(i=0;i<n;i++)r.push(o.slice());for(i=0;i<e.length;i++){s=e[i];r[s[0]][s[1]]=0}t.zmask=r;return r}},{"../../components/drawing":583,"../../lib":684,"../../lib/svg_text_utils":708,"../../plots/cartesian/axes":732,"../../plots/cartesian/set_convert":750,"../../plots/get_data":768,"../heatmap/plot":937,"./close_boundaries":898,"./constants":900,"./convert_to_constraints":904,"./empty_pathinfo":906,"./find_all_paths":908,"./make_crossings":913,d3:147}],915:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/axes");var a=t("../../lib");e.exports=function t(e){var r=e.contours;if(e.autocontour){var o=e.zmin;var s=e.zmax;if(o===undefined||s===undefined){o=a.aggNums(Math.min,null,e._z);s=a.aggNums(Math.max,null,e._z)}var l=i(o,s,e.ncontours);r.size=l.dtick;r.start=n.tickFirst(l);l.range.reverse();r.end=n.tickFirst(l);if(r.start===o)r.start+=r.size;if(r.end===s)r.end-=r.size;if(r.start>r.end){r.start=r.end=(r.start+r.end)/2}if(!e._input.contours)e._input.contours={};a.extendFlat(e._input.contours,{start:r.start,end:r.end,size:r.size});e._input.autocontour=true}else if(r.type!=="constraint"){var u=r.start,c=r.end,f=e._input.contours;if(u>c){r.start=f.start=c;c=r.end=f.end=u;u=r.start}if(!(r.size>0)){var h;if(u===c)h=1;else h=i(u,c,e.ncontours).dtick;f.size=r.size=h}}};function i(t,e,r){var a={type:"linear",range:[t,e]};n.autoTicks(a,(e-t)/(r||15));return a}},{"../../lib":684,"../../plots/cartesian/axes":732}],916:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/drawing");var i=t("../heatmap/style");var o=t("./make_color_map");e.exports=function t(e){var r=n.select(e).selectAll("g.contour");r.style("opacity",function(t){return t.trace.opacity});r.each(function(t){var e=n.select(this);var r=t.trace;var i=r.contours;var s=r.line;var l=i.size||1;var u=i.start;var c=i.type==="constraint";var f=!c&&i.coloring==="lines";var h=!c&&i.coloring==="fill";var p=f||h?o(r):null;e.selectAll("g.contourlevel").each(function(t){n.select(this).selectAll("path").call(a.lineGroupStyle,s.width,f?p(t.level):s.color,s.dash)});var d=i.labelfont;e.selectAll("g.contourlabels text").each(function(t){a.font(n.select(this),{family:d.family,size:d.size,color:d.color||(f?p(t.level):s.color)})});if(c){e.selectAll("g.contourfill path").style("fill",r.fillcolor)}else if(h){var v;e.selectAll("g.contourfill path").style("fill",function(t){if(v===undefined)v=t.level;return p(t.level+.5*l)});if(v===undefined)v=u;e.selectAll("g.contourbg path").style("fill",p(v-.5*l))}});i(e)}},{"../../components/drawing":583,"../heatmap/style":938,"./make_color_map":912,d3:147}],917:[function(t,e,r){"use strict";var n=t("../../components/colorscale/defaults");var a=t("./label_defaults");e.exports=function t(e,r,i,o,s){var l=i("contours.coloring");var u;var c="";if(l==="fill")u=i("contours.showlines");if(u!==false){if(l!=="lines")c=i("line.color","#000");i("line.width",.5);i("line.dash")}if(l!=="none"){n(e,r,o,i,{prefix:"",cLetter:"z"})}i("line.smoothing");a(i,o,c,s)}},{"../../components/colorscale/defaults":568,"./label_defaults":911}],918:[function(t,e,r){"use strict";var n=t("../heatmap/attributes");var a=t("../contour/attributes");var i=a.contours;var o=t("../scatter/attributes");var s=t("../../components/colorscale/attributes");var l=t("../../components/colorbar/attributes");var u=t("../../lib/extend").extendFlat;var c=o.line;e.exports=u({carpet:{valType:"string",editType:"calc"},z:n.z,a:n.x,a0:n.x0,da:n.dx,b:n.y,b0:n.y0,db:n.dy,text:n.text,transpose:n.transpose,atype:n.xtype,btype:n.ytype,fillcolor:a.fillcolor,autocontour:a.autocontour,ncontours:a.ncontours,contours:{type:i.type,start:i.start,end:i.end,size:i.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:i.showlines,showlabels:i.showlabels,labelfont:i.labelfont,labelformat:i.labelformat,operation:i.operation,value:i.value,editType:"calc",impliedEdits:{autocontour:false}},line:{color:u({},c.color,{}),width:c.width,dash:c.dash,smoothing:u({},c.smoothing,{}),editType:"plot"}},s("",{cLetter:"z",autoColorDflt:false}),{colorbar:l})},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../contour/attributes":896,"../heatmap/attributes":925,"../scatter/attributes":1015}],919:[function(t,e,r){"use strict";var n=t("../../components/colorscale/calc");var a=t("../../lib").isArray1D;var i=t("../heatmap/convert_column_xyz");var o=t("../heatmap/clean_2d_array");var s=t("../heatmap/max_row_length");var l=t("../heatmap/interp2d");var u=t("../heatmap/find_empties");var c=t("../heatmap/make_bound_array");var f=t("./defaults");var h=t("../carpet/lookup_carpetid");var p=t("../contour/set_contours");e.exports=function t(e,r){var n=r._carpetTrace=h(e,r);if(!n||!n.visible||n.visible==="legendonly")return;if(!r.a||!r.b){var a=e.data[n.index];var i=e.data[r.index];if(!i.a)i.a=a.a;if(!i.b)i.b=a.b;f(i,r,r._defaultColor,e._fullLayout)}var o=d(e,r);p(r);return o};function d(t,e){var r=e._carpetTrace;var f=r.aaxis;var h=r.baxis;var p,d,v,g,m,y,x;f._minDtick=0;h._minDtick=0;if(a(e.z))i(e,f,h,"a","b",["z"]);p=e._a=e._a||e.a;g=e._b=e._b||e.b;p=p?f.makeCalcdata(e,"_a"):[];g=g?h.makeCalcdata(e,"_b"):[];d=e.a0||0;v=e.da||1;m=e.b0||0;y=e.db||1;x=e._z=o(e._z||e.z,e.transpose);e._emptypoints=u(x);l(x,e._emptypoints);var b=s(x),_=e.xtype==="scaled"?"":p,w=c(e,_,d,v,b,f),k=e.ytype==="scaled"?"":g,M=c(e,k,m,y,x.length,h);var A={a:w,b:M,z:x};if(e.contours.type==="levels"&&e.contours.coloring!=="none"){n(e,x,"","z")}return[A]}},{"../../components/colorscale/calc":566,"../../lib":684,"../carpet/lookup_carpetid":874,"../contour/set_contours":915,"../heatmap/clean_2d_array":927,"../heatmap/convert_column_xyz":929,"../heatmap/find_empties":931,"../heatmap/interp2d":934,"../heatmap/make_bound_array":935,"../heatmap/max_row_length":936,"./defaults":920}],920:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../heatmap/xyz_defaults");var i=t("./attributes");var o=t("../contour/constraint_defaults");var s=t("../contour/contours_defaults");var l=t("../contour/style_defaults");e.exports=function t(e,r,u,c){function f(t,a){return n.coerce(e,r,i,t,a)}function h(t){return n.coerce2(e,r,i,t)}f("carpet");if(e.a&&e.b){var p=a(e,r,f,c,"a","b");if(!p){r.visible=false;return}f("text");var d=f("contours.type")==="constraint";if(!d)delete r.showlegend;if(d){o(e,r,f,c,u,{hasHover:false})}else{s(e,r,f,h);l(e,r,f,c,{hasHover:false})}}else{r._defaultColor=u;r._length=null}}},{"../../lib":684,"../contour/constraint_defaults":901,"../contour/contours_defaults":903,"../contour/style_defaults":917,"../heatmap/xyz_defaults":940,"./attributes":918}],921:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.colorbar=t("../contour/colorbar");n.calc=t("./calc");n.plot=t("./plot");n.style=t("../contour/style");n.moduleType="trace";n.name="contourcarpet";n.basePlotModule=t("../../plots/cartesian");n.categories=["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent"];n.meta={};e.exports=n},{"../../plots/cartesian":743,"../contour/colorbar":899,"../contour/style":916,"./attributes":918,"./calc":919,"./defaults":920,"./plot":924}],922:[function(t,e,r){"use strict";var n=t("../../components/drawing");var a=t("../carpet/axis_aligned_line");var i=t("../../lib");e.exports=function t(e,r,o,s,l,u,c,f){var h;var p="";var d=r.edgepaths.map(function(t,e){return e});var v=true;var g,m,y,x,b,_;var w=Math.abs(o[0][0]-o[2][0])*1e-4;var k=Math.abs(o[0][1]-o[2][1])*1e-4;function M(t){return Math.abs(t[1]-o[0][1])<k}function A(t){return Math.abs(t[1]-o[2][1])<k}function T(t){return Math.abs(t[0]-o[0][0])<w}function S(t){return Math.abs(t[0]-o[2][0])<w}function E(t,e){var r,n,i,o;var s="";if(M(t)&&!S(t)||A(t)&&!T(t)){o=l.aaxis;i=a(l,u,[t[0],e[0]],.5*(t[1]+e[1]))}else{o=l.baxis;i=a(l,u,.5*(t[0]+e[0]),[t[1],e[1]])}for(r=1;r<i.length;r++){s+=o.smoothing?"C":"L";for(n=0;n<i[r].length;n++){var h=i[r][n];s+=[c.c2p(h[0]),f.c2p(h[1])]+" "}}return s}h=0;g=null;while(d.length){var C=r.edgepaths[h][0];if(g){p+=E(g,C)}_=n.smoothopen(r.edgepaths[h].map(s),r.smoothing);p+=v?_:_.replace(/^M/,"L");d.splice(d.indexOf(h),1);g=r.edgepaths[h][r.edgepaths[h].length-1];x=-1;for(y=0;y<4;y++){if(!g){i.log("Missing end?",h,r);break}if(M(g)&&!S(g)){m=o[1]}else if(T(g)){m=o[0]}else if(A(g)){m=o[3]}else if(S(g)){m=o[2]}for(b=0;b<r.edgepaths.length;b++){var L=r.edgepaths[b][0];if(Math.abs(g[0]-m[0])<w){if(Math.abs(g[0]-L[0])<w&&(L[1]-g[1])*(m[1]-L[1])>=0){m=L;x=b}}else if(Math.abs(g[1]-m[1])<k){if(Math.abs(g[1]-L[1])<k&&(L[0]-g[0])*(m[0]-L[0])>=0){m=L;x=b}}else{i.log("endpt to newendpt is not vert. or horz.",g,m,L)}}if(x>=0)break;p+=E(g,m);g=m}if(x===r.edgepaths.length){i.log("unclosed perimeter path");break}h=x;v=d.indexOf(h)===-1;if(v){h=d[0];p+=E(g,m)+"Z";g=null}}for(h=0;h<r.paths.length;h++){p+=n.smoothclosed(r.paths[h].map(s),r.smoothing)}return p}},{"../../components/drawing":583,"../../lib":684,"../carpet/axis_aligned_line":858}],923:[function(t,e,r){"use strict";e.exports=function t(e,r){var n,a,i,o,s,l,u,c,f;for(n=0;n<e.length;n++){o=e[n];s=o.pedgepaths=[];l=o.ppaths=[];for(a=0;a<o.edgepaths.length;a++){f=o.edgepaths[a];u=[];for(i=0;i<f.length;i++){u[i]=r(f[i])}s.push(u)}for(a=0;a<o.paths.length;a++){f=o.paths[a];c=[];for(i=0;i<f.length;i++){c[i]=r(f[i])}l.push(c)}}}},{}],924:[function(t,e,r){"use strict";var n=t("d3");var a=t("../carpet/map_1d_array");var i=t("../carpet/makepath");var o=t("../../components/drawing");var s=t("../../lib");var l=t("../../plots/get_data").getUidsFromCalcData;var u=t("../contour/make_crossings");var c=t("../contour/find_all_paths");var f=t("../contour/plot");var h=t("../contour/constants");var p=t("../contour/convert_to_constraints");var d=t("./join_all_paths");var v=t("../contour/empty_pathinfo");var g=t("./map_pathinfo");var m=t("../carpet/lookup_carpetid");var y=t("../contour/close_boundaries");e.exports=function t(e,r,a,i){var o=l(a);i.selectAll("g.contour").each(function(t){if(!o[t.trace.uid]){n.select(this).remove()}});for(var s=0;s<a.length;s++){x(e,r,a[s],i)}};function x(t,e,r,n){var s=r[0].trace;var l=s._carpetTrace=m(t,s);var h=t.calcdata[l.index][0];if(!l.visible||l.visible==="legendonly")return;var d=r[0].a;var x=r[0].b;var _=s.contours;var w=s.uid;var k=e.xaxis;var M=e.yaxis;var S="contour"+w;var E=v(_,e,r[0]);var C=_.type==="constraint";var L=_._operation;var I=C?L==="="?"lines":"fill":_.coloring;function z(t){var e=l.ab2xy(t[0],t[1],true);return[k.c2p(e[0]),M.c2p(e[1])]}var P=[[d[0],x[x.length-1]],[d[d.length-1],x[x.length-1]],[d[d.length-1],x[0]],[d[0],x[0]]];u(E);var O=(d[d.length-1]-d[0])*1e-8;var D=(x[x.length-1]-x[0])*1e-8;c(E,O,D);var R=E;if(_.type==="constraint"){R=p(E,L);y(R,L,P,s)}g(E,z);var B=f.makeContourGroup(n,r,S);var F,N,j,V;var U=[];for(V=h.clipsegments.length-1;V>=0;V--){F=h.clipsegments[V];N=a([],F.x,k.c2p);j=a([],F.y,M.c2p);N.reverse();j.reverse();U.push(i(N,j,F.bicubic))}var q="M"+U.join("L")+"Z";A(B,h.clipsegments,k,M,C,I);T(s,B,k,M,R,P,z,l,h,I,q);b(B,E,t,r[0],_,e,l);o.setClipUrl(B,l._clipPathId)}function b(t,e,r,a,i,l,u){var c=s.ensureSingle(t,"g","contourlines");var p=i.showlines!==false;var d=i.showlabels;var v=p&&d;var g=f.createLines(c,p||d,e);var m=f.createLineClip(c,v,r._fullLayout._defs,a.trace.uid);var y=t.selectAll("g.contourlabels").data(d?[0]:[]);y.exit().remove();y.enter().append("g").classed("contourlabels",true);if(d){var x=l.xaxis;var b=l.yaxis;var w=x._length;var k=b._length;var M=[[[0,0],[w,0],[w,k],[0,k]]];var A=[];s.clearLocationCache();var T=f.labelFormatter(i,a.t.cb,r._fullLayout);var S=o.tester.append("text").attr("data-notex",1).call(o.font,i.labelfont);var E={left:0,right:w,center:w/2,top:0,bottom:k,middle:k/2};var C=Math.sqrt(w*w+k*k);var L=h.LABELDISTANCE*C/Math.max(1,e.length/h.LABELINCREASE);g.each(function(t){var e=f.calcTextOpts(t.level,T,S,r);n.select(this).selectAll("path").each(function(r){var n=this;var a=s.getVisibleSegment(n,E,e.height/2);if(!a)return;_(n,r,t,a,u,e.height);if(a.len<(e.width+e.height)*h.LABELMIN)return;var i=Math.min(Math.ceil(a.len/L),h.LABELMAX);for(var o=0;o<i;o++){var l=f.findBestTextLocation(n,a,e,A,E);if(!l)break;f.addLabelData(l,e,A,M)}})});S.remove();f.drawLabels(y,A,r,m,v?M:null)}if(d&&!p)g.remove()}function _(t,e,r,n,a,i){var o;for(var s=0;s<r.pedgepaths.length;s++){if(e===r.pedgepaths[s]){o=r.edgepaths[s]}}if(!o)return;var l=a.a[0];var u=a.a[a.a.length-1];var c=a.b[0];var f=a.b[a.b.length-1];function h(t,e){var r=0;var n;var o=.1;if(Math.abs(t[0]-l)<o||Math.abs(t[0]-u)<o){n=k(a.dxydb_rough(t[0],t[1],o));r=Math.max(r,i*M(e,n)/2)}if(Math.abs(t[1]-c)<o||Math.abs(t[1]-f)<o){n=k(a.dxyda_rough(t[0],t[1],o));r=Math.max(r,i*M(e,n)/2)}return r}var p=w(t,0,1);var d=w(t,n.total,n.total-1);var v=h(o[0],p);var g=n.total-h(o[o.length-1],d);if(n.min<v)n.min=v;if(n.max>g)n.max=g;n.len=n.max-n.min}function w(t,e,r){var n=t.getPointAtLength(e);var a=t.getPointAtLength(r);var i=a.x-n.x;var o=a.y-n.y;var s=Math.sqrt(i*i+o*o);return[i/s,o/s]}function k(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]}function M(t,e){var r=Math.abs(t[0]*e[0]+t[1]*e[1]);var n=Math.sqrt(1-r*r);return n/r}function A(t,e,r,n,o,l){var u,c,f,h;var p=s.ensureSingle(t,"g","contourbg");var d=p.selectAll("path").data(l==="fill"&&!o?[0]:[]);d.enter().append("path");d.exit().remove();var v=[];for(h=0;h<e.length;h++){u=e[h];c=a([],u.x,r.c2p);f=a([],u.y,n.c2p);v.push(i(c,f,u.bicubic))}d.attr("d","M"+v.join("L")+"Z").style("stroke","none")}function T(t,e,r,a,i,o,l,u,c,f,h){var p=s.ensureSingle(e,"g","contourfill");var v=p.selectAll("path").data(f==="fill"?i:[]);v.enter().append("path");v.exit().remove();v.each(function(e){var i=d(t,e,o,l,u,c,r,a);if(e.prefixBoundary){i=h+i}if(!i){n.select(this).remove()}else{n.select(this).attr("d",i).style("stroke","none")}})}},{"../../components/drawing":583,"../../lib":684,"../../plots/get_data":768,"../carpet/lookup_carpetid":874,"../carpet/makepath":875,"../carpet/map_1d_array":876,"../contour/close_boundaries":898,"../contour/constants":900,"../contour/convert_to_constraints":904,"../contour/empty_pathinfo":906,"../contour/find_all_paths":908,"../contour/make_crossings":913,"../contour/plot":914,"./join_all_paths":922,"./map_pathinfo":923,d3:147}],925:[function(t,e,r){"use strict";var n=t("../scatter/attributes");var a=t("../../components/colorscale/attributes");var i=t("../../components/colorbar/attributes");var o=t("../../lib/extend").extendFlat;e.exports=o({z:{valType:"data_array",editType:"calc"},x:o({},n.x,{impliedEdits:{xtype:"array"}}),x0:o({},n.x0,{impliedEdits:{xtype:"scaled"}}),dx:o({},n.dx,{impliedEdits:{xtype:"scaled"}}),y:o({},n.y,{impliedEdits:{ytype:"array"}}),y0:o({},n.y0,{impliedEdits:{ytype:"scaled"}}),dy:o({},n.dy,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:false,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",false],dflt:false,editType:"calc"},connectgaps:{valType:"boolean",dflt:false,editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},zhoverformat:{valType:"string",dflt:"",editType:"none"}},a("",{cLetter:"z",autoColorDflt:false}),{colorbar:i})},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../scatter/attributes":1015}],926:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");var i=t("../../plots/cartesian/axes");var o=t("../histogram2d/calc");var s=t("../../components/colorscale/calc");var l=t("./convert_column_xyz");var u=t("./max_row_length");var c=t("./clean_2d_array");var f=t("./interp2d");var h=t("./find_empties");var p=t("./make_bound_array");e.exports=function t(e,r){var d=i.getFromId(e,r.xaxis||"x"),v=i.getFromId(e,r.yaxis||"y"),g=n.traceIs(r,"contour"),m=n.traceIs(r,"histogram"),y=n.traceIs(r,"gl2d"),x=g?"best":r.zsmooth,b,_,w,k,M,A,T,S,E;d._minDtick=0;v._minDtick=0;if(m){E=o(e,r);b=E.x;_=E.x0;w=E.dx;k=E.y;M=E.y0;A=E.dy;T=E.z}else{var C=r.z;if(a.isArray1D(C)){l(r,d,v,"x","y",["z"]);b=r._x;k=r._y;C=r._z}else{b=r.x?d.makeCalcdata(r,"x"):[];k=r.y?v.makeCalcdata(r,"y"):[]}_=r.x0||0;w=r.dx||1;M=r.y0||0;A=r.dy||1;T=c(C,r.transpose);if(g||r.connectgaps){r._emptypoints=h(T);f(T,r._emptypoints)}}function L(t){x=r._input.zsmooth=r.zsmooth=false;a.warn('cannot use zsmooth: "fast": '+t)}if(x==="fast"){if(d.type==="log"||v.type==="log"){L("log axis found")}else if(!m){if(b.length){var I=(b[b.length-1]-b[0])/(b.length-1),z=Math.abs(I/100);for(S=0;S<b.length-1;S++){if(Math.abs(b[S+1]-b[S]-I)>z){L("x scale is not linear");break}}}if(k.length&&x==="fast"){var P=(k[k.length-1]-k[0])/(k.length-1),O=Math.abs(P/100);for(S=0;S<k.length-1;S++){if(Math.abs(k[S+1]-k[S]-P)>O){L("y scale is not linear");break}}}}}var D=u(T);var R=r.xtype==="scaled"?"":b;var B=p(r,R,_,w,D,d);var F=r.ytype==="scaled"?"":k;var N=p(r,F,M,A,T.length,v);if(!y){i.expand(d,B);i.expand(v,N)}var j={x:B,y:N,z:T,text:r._text||r.text};if(R&&R.length===B.length-1)j.xCenter=R;if(F&&F.length===N.length-1)j.yCenter=F;if(m){j.xRanges=E.xRanges;j.yRanges=E.yRanges;j.pts=E.pts}if(!g||r.contours.type!=="constraint"){s(r,T,"","z")}if(g&&r.contours&&r.contours.coloring==="heatmap"){var V={type:r.type==="contour"?"heatmap":"histogram2d",xcalendar:r.xcalendar,ycalendar:r.ycalendar};j.xfill=p(V,R,_,w,D,d);j.yfill=p(V,F,M,A,T.length,v)}return[j]}},{"../../components/colorscale/calc":566,"../../lib":684,"../../plots/cartesian/axes":732,"../../registry":817,"../histogram2d/calc":957,"./clean_2d_array":927,"./convert_column_xyz":929,"./find_empties":931,"./interp2d":934,"./make_bound_array":935,"./max_row_length":936}],927:[function(t,e,r){"use strict";var n=t("fast-isnumeric");e.exports=function t(e,r){var a,i,o,s,l,u;function c(t){if(!n(t))return undefined;return+t}if(r){a=0;for(l=0;l<e.length;l++)a=Math.max(a,e[l].length);if(a===0)return false;o=function(t){return t.length};s=function(t,e,r){return t[r][e]}}else{a=e.length;o=function(t,e){return t[e].length};s=function(t,e,r){return t[e][r]}}var f=new Array(a);for(l=0;l<a;l++){i=o(e,l);f[l]=new Array(i);for(u=0;u<i;u++)f[l][u]=c(s(e,l,u))}return f}},{"fast-isnumeric":214}],928:[function(t,e,r){"use strict";e.exports={min:"zmin",max:"zmax"}},{}],929:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../constants/numerical").BADNUM;e.exports=function t(e,r,i,o,s,l){var u=e._length;var c=e[o].slice(0,u);var f=e[s].slice(0,u);var h=e.text;var p=h!==undefined&&n.isArray1D(h);var d=e[o+"calendar"];var v=e[s+"calendar"];var g,m,y,x,b;for(g=0;g<u;g++){c[g]=r.d2c(c[g],0,d);f[g]=i.d2c(f[g],0,v)}var _=n.distinctVals(c),w=_.vals,k=n.distinctVals(f),M=k.vals,A=[];for(g=0;g<l.length;g++){A[g]=n.init2dArray(M.length,w.length)}var T,S,E;if(p)E=n.init2dArray(M.length,w.length);for(g=0;g<u;g++){if(c[g]!==a&&f[g]!==a){T=n.findBin(c[g]+_.minDiff/2,w);S=n.findBin(f[g]+k.minDiff/2,M);for(m=0;m<l.length;m++){b=l[m];y=e[b];x=A[m];x[S][T]=y[g]}if(p)E[S][T]=h[g]}}e["_"+o]=w;e["_"+s]=M;for(m=0;m<l.length;m++){e["_"+l[m]]=A[m]}if(p)e._text=E}},{"../../constants/numerical":661,"../../lib":684}],930:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./xyz_defaults");var i=t("./style_defaults");var o=t("../../components/colorscale/defaults");var s=t("./attributes");e.exports=function t(e,r,l,u){function c(t,a){return n.coerce(e,r,s,t,a)}var f=a(e,r,c,u);if(!f){r.visible=false;return}c("text");i(e,r,c,u);c("connectgaps",n.isArray1D(r.z)&&r.zsmooth!==false);o(e,r,u,c,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":568,"../../lib":684,"./attributes":925,"./style_defaults":939,"./xyz_defaults":940}],931:[function(t,e,r){"use strict";var n=t("./max_row_length");e.exports=function t(e){var r=[],a={},i=[],o=e[0],s=[],l=[0,0,0],u=n(e),c,f,h,p,d,v,g,m;for(f=0;f<e.length;f++){c=s;s=o;o=e[f+1]||[];for(h=0;h<u;h++){if(s[h]===undefined){v=(s[h-1]!==undefined?1:0)+(s[h+1]!==undefined?1:0)+(c[h]!==undefined?1:0)+(o[h]!==undefined?1:0);if(v){if(f===0)v++;if(h===0)v++;if(f===e.length-1)v++;if(h===s.length-1)v++;if(v<4){a[[f,h]]=[f,h,v]}r.push([f,h,v])}else i.push([f,h])}}}while(i.length){g={};m=false;for(d=i.length-1;d>=0;d--){p=i[d];f=p[0];h=p[1];v=((a[[f-1,h]]||l)[2]+(a[[f+1,h]]||l)[2]+(a[[f,h-1]]||l)[2]+(a[[f,h+1]]||l)[2])/20;if(v){g[p]=[f,h,v];i.splice(d,1);m=true}}if(!m){throw"findEmpties iterated with no new neighbors"}for(p in g){a[p]=g[p];r.push(g[p])}}return r.sort(function(t,e){return e[2]-t[2]})}},{"./max_row_length":936}],932:[function(t,e,r){"use strict";var n=t("../../components/fx");var a=t("../../lib");var i=t("../../plots/cartesian/axes");e.exports=function t(e,r,o,s,l,u){var c=e.cd[0];var f=c.trace;var h=e.xa;var p=e.ya;var d=c.x;var v=c.y;var g=c.z;var m=c.xCenter;var y=c.yCenter;var x=c.zmask;var b=[f.zmin,f.zmax];var _=f.zhoverformat;var w=d;var k=v;var M,A,T,S;if(e.index!==false){try{T=Math.round(e.index[1]);S=Math.round(e.index[0])}catch(t){a.error("Error hovering on heatmap, "+"pointNumber must be [row,col], found:",e.index);return}if(T<0||T>=g[0].length||S<0||S>g.length){return}}else if(n.inbox(r-d[0],r-d[d.length-1],0)>0||n.inbox(o-v[0],o-v[v.length-1],0)>0){return}else{if(u){var E;w=[2*d[0]-d[1]];for(E=1;E<d.length;E++){w.push((d[E]+d[E-1])/2)}w.push([2*d[d.length-1]-d[d.length-2]]);k=[2*v[0]-v[1]];for(E=1;E<v.length;E++){k.push((v[E]+v[E-1])/2)}k.push([2*v[v.length-1]-v[v.length-2]])}T=Math.max(0,Math.min(w.length-2,a.findBin(r,w)));S=Math.max(0,Math.min(k.length-2,a.findBin(o,k)))}var C=h.c2p(d[T]),L=h.c2p(d[T+1]),I=p.c2p(v[S]),z=p.c2p(v[S+1]);if(u){L=C;M=d[T];z=I;A=v[S]}else{M=m?m[T]:(d[T]+d[T+1])/2;A=y?y[S]:(v[S]+v[S+1])/2;if(f.zsmooth){C=L=h.c2p(M);I=z=p.c2p(A)}}var P=g[S][T];if(x&&!x[S][T])P=undefined;var O;if(Array.isArray(c.text)&&Array.isArray(c.text[S])){O=c.text[S][T]}var D;var R={type:"linear",range:b,hoverformat:_,_separators:h._separators,_numFormat:h._numFormat};var B=i.tickText(R,P,"hover");D=B.text;return[a.extendFlat(e,{index:[S,T],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:C,x1:L,y0:I,y1:z,xLabelVal:M,yLabelVal:A,zLabelVal:P,zLabel:D,text:O})]}},{"../../components/fx":600,"../../lib":684,"../../plots/cartesian/axes":732}],933:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.calc=t("./calc");n.plot=t("./plot");n.colorbar=t("./colorbar");n.style=t("./style");n.hoverPoints=t("./hover");n.moduleType="trace";n.name="heatmap";n.basePlotModule=t("../../plots/cartesian");n.categories=["cartesian","svg","2dMap"];n.meta={};e.exports=n},{"../../plots/cartesian":743,"./attributes":925,"./calc":926,"./colorbar":928,"./defaults":930,"./hover":932,"./plot":937,"./style":938}],934:[function(t,e,r){"use strict";var n=t("../../lib");var a=.01;var i=[[-1,0],[1,0],[0,-1],[0,1]];function o(t){return.5-.25*Math.min(1,t*.5)}e.exports=function t(e,r){var i=1;var l;s(e,r);for(l=0;l<r.length;l++){if(r[l][2]<4)break}r=r.slice(l);for(l=0;l<100&&i>a;l++){i=s(e,r,o(i))}if(i>a){n.log("interp2d didn't converge quickly",i)}return e};function s(t,e,r){var n=0,a,o,s,l,u,c,f,h,p,d,v,g,m;for(l=0;l<e.length;l++){a=e[l];o=a[0];s=a[1];v=t[o][s];d=0;p=0;for(u=0;u<4;u++){c=i[u];f=t[o+c[0]];if(!f)continue;h=f[s+c[1]];if(h!==undefined){if(d===0){g=m=h}else{g=Math.min(g,h);m=Math.max(m,h)}p++;d+=h}}if(p===0){throw"iterateInterp2d order is wrong: no defined neighbors"}t[o][s]=d/p;if(v===undefined){if(p<4)n=1}else{t[o][s]=(1+r)*t[o][s]-r*v;if(m>g){n=Math.max(n,Math.abs(t[o][s]-v)/(m-g))}}}return n}},{"../../lib":684}],935:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib").isArrayOrTypedArray;e.exports=function t(e,r,i,o,s,l){var u=[],c=n.traceIs(e,"contour"),f=n.traceIs(e,"histogram"),h=n.traceIs(e,"gl2d"),p,d,v;var g=a(r)&&r.length>1;if(g&&!f&&l.type!=="category"){var m=r.length;if(m<=s){if(c||h)u=r.slice(0,s);else if(s===1){u=[r[0]-.5,r[0]+.5]}else{u=[1.5*r[0]-.5*r[1]];for(v=1;v<m;v++){u.push((r[v-1]+r[v])*.5)}u.push(1.5*r[m-1]-.5*r[m-2])}if(m<s){var y=u[u.length-1],x=y-u[u.length-2];for(v=m;v<s;v++){y+=x;u.push(y)}}}else{return c?r.slice(0,s):r.slice(0,s+1)}}else{d=o||1;var b=e[l._id.charAt(0)+"calendar"];if(f||l.type==="category")p=l.r2c(i,0,b)||0;else if(a(r)&&r.length===1)p=r[0];else if(i===undefined)p=0;else p=l.d2c(i,0,b);for(v=c||h?0:-.5;v<s;v++){u.push(p+d*v)}}return u}},{"../../lib":684,"../../registry":817}],936:[function(t,e,r){"use strict";e.exports=function t(e){var r=0;for(var n=0;n<e.length;n++){r=Math.max(r,e[n].length)}return r}},{}],937:[function(t,e,r){"use strict";var n=t("d3");var a=t("tinycolor2");var i=t("../../registry");var o=t("../../lib");var s=t("../../components/colorscale");var l=t("../../constants/xmlns_namespaces");var u=t("../../plots/get_data").getUidsFromCalcData;var c=t("./max_row_length");e.exports=function(t,e,r,a){var i=u(r);a.selectAll(".hm > image").each(function(t){var e=t.trace||{};if(!i[e.uid]){n.select(this.parentNode).remove()}});for(var o=0;o<r.length;o++){f(t,e,r[o],a)}};function f(t,e,r,n){var u=r[0];var f=u.trace;var v=e.xaxis;var g=e.yaxis;var m="hm"+f.uid;var y=u.z;var x=u.x;var b=u.y;var _=u.xCenter;var w=u.yCenter;var k=i.traceIs(f,"contour");var M=k?"best":f.zsmooth;var A=y.length;var T=c(y);var S=false;var E=false;var C,L,I,z,P,O;O=0;while(C===undefined&&O<x.length-1){C=v.c2p(x[O]);O++}O=x.length-1;while(L===undefined&&O>0){L=v.c2p(x[O]);O--}if(L<C){I=L;L=C;C=I;S=true}O=0;while(z===undefined&&O<b.length-1){z=g.c2p(b[O]);O++}O=b.length-1;while(P===undefined&&O>0){P=g.c2p(b[O]);O--}if(P<z){I=z;z=P;P=I;E=true}if(k){_=x;w=b;x=u.xfill;b=u.yfill}if(M!=="fast"){var D=M==="best"?0:.5;C=Math.max(-D*v._length,C);L=Math.min((1+D)*v._length,L);z=Math.max(-D*g._length,z);P=Math.min((1+D)*g._length,P)}var R=Math.round(L-C),B=Math.round(P-z);var F=R<=0||B<=0;var N=n.selectAll("g.hm."+m).data(F?[]:[0]);N.enter().append("g").classed("hm",true).classed(m,true);N.exit().remove();if(F)return;var j,V;if(M==="fast"){j=T;V=A}else{j=R;V=B}var U=document.createElement("canvas");U.width=j;U.height=V;var q=U.getContext("2d");var H=s.makeColorScaleFunc(s.extractScale(f.colorscale,f.zmin,f.zmax),{noNumericCheck:true,returnArray:true});var G,W;if(M==="fast"){G=S?function(t){return T-1-t}:o.identity;W=E?function(t){return A-1-t}:o.identity}else{G=function(t){return o.constrain(Math.round(v.c2p(x[t])-C),0,R)};W=function(t){return o.constrain(Math.round(g.c2p(b[t])-z),0,B)}}var Y=W(0);var X=[Y,Y];var Z=S?0:1;var $=E?0:1;var J=0;var K=0;var Q=0;var tt=0;var et,rt,nt,at,it,ot;function st(t,e){if(t!==undefined){var r=H(t);r[0]=Math.round(r[0]);r[1]=Math.round(r[1]);r[2]=Math.round(r[2]);J+=e;K+=r[0]*e;Q+=r[1]*e;tt+=r[2]*e;return r}return[0,0,0,0]}function lt(t,e,r,n){var a=t[r.bin0];if(a===undefined)return st(undefined,1);var i=t[r.bin1],o=e[r.bin0],s=e[r.bin1],l=i-a||0,u=o-a||0,c;if(i===undefined){if(s===undefined)c=0;else if(o===undefined)c=2*(s-a);else c=(2*s-o-a)*2/3}else if(s===undefined){if(o===undefined)c=0;else c=(2*a-i-o)*2/3}else if(o===undefined)c=(2*s-i-a)*2/3;else c=s+a-i-o;return st(a+r.frac*l+n.frac*(u+r.frac*c))}if(M){var ut=0,ct;try{ct=new Uint8Array(R*B*4)}catch(t){ct=new Array(R*B*4)}if(M==="best"){var ft=_||x;var ht=w||b;var pt=new Array(ft.length);var dt=new Array(ht.length);var vt=new Array(R);var gt=_?p:h;var mt=w?p:h;var yt,xt,bt;for(O=0;O<ft.length;O++)pt[O]=Math.round(v.c2p(ft[O])-C);for(O=0;O<ht.length;O++)dt[O]=Math.round(g.c2p(ht[O])-z);for(O=0;O<R;O++)vt[O]=gt(O,pt);for(rt=0;rt<B;rt++){yt=mt(rt,dt);xt=y[yt.bin0];bt=y[yt.bin1];for(O=0;O<R;O++,ut+=4){ot=lt(xt,bt,vt[O],yt);d(ct,ut,ot)}}}else{for(rt=0;rt<A;rt++){it=y[rt];X=W(rt);for(O=0;O<R;O++){ot=st(it[O],1);ut=(X*R+G(O))*4;d(ct,ut,ot)}}}var _t=q.createImageData(R,B);try{_t.data.set(ct)}catch(t){var wt=_t.data,kt=wt.length;for(rt=0;rt<kt;rt++){wt[rt]=ct[rt]}}q.putImageData(_t,0,0)}else{var Mt=f.xgap;var At=f.ygap;var Tt=Math.floor(Mt/2);var St=Math.floor(At/2);for(rt=0;rt<A;rt++){it=y[rt];X.reverse();X[$]=W(rt+1);if(X[0]===X[1]||X[0]===undefined||X[1]===undefined){continue}nt=G(0);et=[nt,nt];for(O=0;O<T;O++){et.reverse();et[Z]=G(O+1);if(et[0]===et[1]||et[0]===undefined||et[1]===undefined){continue}at=it[O];ot=st(at,(et[1]-et[0])*(X[1]-X[0]));q.fillStyle="rgba("+ot.join(",")+")";q.fillRect(et[0]+Tt,X[0]+St,et[1]-et[0]-Mt,X[1]-X[0]-At)}}}K=Math.round(K/J);Q=Math.round(Q/J);tt=Math.round(tt/J);var Et=a("rgb("+K+","+Q+","+tt+")");t._hmpixcount=(t._hmpixcount||0)+J;t._hmlumcount=(t._hmlumcount||0)+J*Et.getLuminance();var Ct=N.selectAll("image").data(r);Ct.enter().append("svg:image").attr({xmlns:l.svg,preserveAspectRatio:"none"});Ct.attr({height:B,width:R,x:C,y:z,"xlink:href":U.toDataURL("image/png")});Ct.exit().remove()}function h(t,e){var r=e.length-2;var n=o.constrain(o.findBin(t,e),0,r);var a=e[n];var i=e[n+1];var s=o.constrain(n+(t-a)/(i-a)-.5,0,r);var l=Math.round(s);var u=Math.abs(s-l);if(!s||s===r||!u){return{bin0:l,bin1:l,frac:0}}return{bin0:l,frac:u,bin1:Math.round(l+u/(s-l))}}function p(t,e){var r=e.length-1;var n=o.constrain(o.findBin(t,e),0,r);var a=e[n];var i=e[n+1];var s=(t-a)/(i-a)||0;if(s<=0){return{bin0:n,bin1:n,frac:0}}if(s<.5){return{bin0:n,bin1:n+1,frac:s}}return{bin0:n+1,bin1:n,frac:1-s}}function d(t,e,r){t[e]=r[0];t[e+1]=r[1];t[e+2]=r[2];t[e+3]=Math.round(r[3]*255)}},{"../../components/colorscale":573,"../../constants/xmlns_namespaces":663,"../../lib":684,"../../plots/get_data":768,"../../registry":817,"./max_row_length":936,d3:147,tinycolor2:499}],938:[function(t,e,r){"use strict";var n=t("d3");e.exports=function t(e){n.select(e).selectAll(".hm image").style("opacity",function(t){return t.trace.opacity})}},{d3:147}],939:[function(t,e,r){"use strict";e.exports=function t(e,r,n){var a=n("zsmooth");if(a===false){n("xgap");n("ygap")}n("zhoverformat")}},{}],940:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib");var i=t("../../registry");e.exports=function t(e,r,n,l,u,c){var f=n("z");u=u||"x";c=c||"y";var h,p;if(f===undefined||!f.length)return 0;if(a.isArray1D(e.z)){h=n(u);p=n(c);if(!(h&&h.length&&p&&p.length))return 0;r._length=Math.min(h.length,p.length,f.length)}else{h=o(u,n);p=o(c,n);if(!s(f))return 0;n("transpose");r._length=null}var d=i.getComponentMethod("calendars","handleTraceDefaults");d(e,r,[u,c],l);return true};function o(t,e){var r=e(t),n=r?e(t+"type","array"):"scaled";if(n==="scaled"){e(t+"0");e("d"+t)}return r}function s(t){var e=true,r=false,i=false,o;for(var s=0;s<t.length;s++){o=t[s];if(!a.isArrayOrTypedArray(o)){e=false;break}if(o.length>0)r=true;for(var l=0;l<o.length;l++){if(n(o[l])){i=true;break}}}return e&&r&&i}},{"../../lib":684,"../../registry":817,"fast-isnumeric":214}],941:[function(t,e,r){"use strict";var n=t("../heatmap/attributes");var a=t("../../components/colorscale/attributes");var i=t("../../components/colorbar/attributes");var o=t("../../lib/extend").extendFlat;var s=t("../../plot_api/edit_types").overrideAll;var l=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"];var u={};for(var c=0;c<l.length;c++){var f=l[c];u[f]=n[f]}o(u,a("",{cLetter:"z",autoColorDflt:false}),{colorbar:i});e.exports=s(u,"calc","nested")},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../../plot_api/edit_types":715,"../heatmap/attributes":925}],942:[function(t,e,r){"use strict";var n=t("gl-heatmap2d");var a=t("../../plots/cartesian/axes");var i=t("../../lib/str2rgbarray");function o(t,e){this.scene=t;this.uid=e;this.type="heatmapgl";this.name="";this.hoverinfo="all";this.xData=[];this.yData=[];this.zData=[];this.textLabels=[];this.idToIndex=[];this.bounds=[0,0,0,0];this.options={z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]};this.heatmap=n(t.glplot,this.options);this.heatmap._trace=this}var s=o.prototype;s.handlePick=function(t){var e=this.options,r=e.shape,n=t.pointId,a=n%r[0],i=Math.floor(n/r[0]),o=n;return{trace:this,dataCoord:t.dataCoord,traceCoord:[e.x[a],e.y[i],e.z[o]],textLabel:this.textLabels[n],name:this.name,pointIndex:[i,a],hoverinfo:this.hoverinfo}};s.update=function(t,e){var r=e[0];this.index=t.index;this.name=t.name;this.hoverinfo=t.hoverinfo;var n=r.z;this.options.z=[].concat.apply([],n);var i=n[0].length,o=n.length;this.options.shape=[i,o];this.options.x=r.x;this.options.y=r.y;var s=l(t);this.options.colorLevels=s.colorLevels;this.options.colorValues=s.colorValues;this.textLabels=[].concat.apply([],t.text);this.heatmap.update(this.options);a.expand(this.scene.xaxis,r.x);a.expand(this.scene.yaxis,r.y)};s.dispose=function(){this.heatmap.dispose()};function l(t){var e=t.colorscale,r=t.zmin,n=t.zmax;var a=e.length,o=new Array(a),s=new Array(4*a);for(var l=0;l<a;l++){var u=e[l];var c=i(u[1]);o[l]=r+u[0]*(n-r);for(var f=0;f<4;f++){s[4*l+f]=c[f]}}return{colorLevels:o,colorValues:s}}function u(t,e,r){var n=new o(t,e.uid);n.update(e,r);return n}e.exports=u},{"../../lib/str2rgbarray":707,"../../plots/cartesian/axes":732,"gl-heatmap2d":241}],943:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("../heatmap/defaults");n.colorbar=t("../heatmap/colorbar");n.calc=t("../heatmap/calc");n.plot=t("./convert");n.moduleType="trace";n.name="heatmapgl";n.basePlotModule=t("../../plots/gl2d");n.categories=["gl","gl2d","2dMap"];n.meta={};e.exports=n},{"../../plots/gl2d":771,"../heatmap/calc":926,"../heatmap/colorbar":928,"../heatmap/defaults":930,"./attributes":941,"./convert":942}],944:[function(t,e,r){"use strict";var n=t("../bar/attributes");e.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},text:n.text,orientation:n.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:false,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},autobinx:{valType:"boolean",dflt:null,editType:"calc",impliedEdits:{"xbins.start":undefined,"xbins.end":undefined,"xbins.size":undefined}},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:a("x"),autobiny:{valType:"boolean",dflt:null,editType:"calc",impliedEdits:{"ybins.start":undefined,"ybins.end":undefined,"ybins.size":undefined}},nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:a("y"),marker:n.marker,selected:n.selected,unselected:n.unselected,_deprecated:{bardir:n._deprecated.bardir}};function a(t){var e={};e["autobin"+t]=false;var r={};r["^autobin"+t]=false;return{start:{valType:"any",dflt:null,editType:"calc",impliedEdits:r},end:{valType:"any",dflt:null,editType:"calc",impliedEdits:r},size:{valType:"any",dflt:null,editType:"calc",impliedEdits:r},editType:"calc",impliedEdits:e}}},{"../bar/attributes":827}],945:[function(t,e,r){"use strict";e.exports=function t(e,r){var n=e.length,a=0;for(var i=0;i<n;i++){if(r[i]){e[i]/=r[i];a+=e[i]}else e[i]=null}return a}},{}],946:[function(t,e,r){"use strict";e.exports=function t(e,r,n,a){n("histnorm");a.forEach(function(t){n(t+"bins.start");n(t+"bins.end");n(t+"bins.size");var e=n("autobin"+t);if(e!==false)n("nbins"+t)});return r}},{}],947:[function(t,e,r){"use strict";var n=t("fast-isnumeric");e.exports={count:function(t,e,r){r[t]++;return 1},sum:function(t,e,r,a){var i=a[e];if(n(i)){i=Number(i);r[t]+=i;return i}return 0},avg:function(t,e,r,a,i){var o=a[e];if(n(o)){o=Number(o);r[t]+=o;i[t]++}return 0},min:function(t,e,r,a){var i=a[e];if(n(i)){i=Number(i);if(!n(r[t])){r[t]=i;return i}else if(r[t]>i){var o=i-r[t];r[t]=i;return o}}return 0},max:function(t,e,r,a){var i=a[e];if(n(i)){i=Number(i);if(!n(r[t])){r[t]=i;return i}else if(r[t]<i){var o=i-r[t];r[t]=i;return o}}return 0}}},{"fast-isnumeric":214}],948:[function(t,e,r){"use strict";var n=t("../../constants/numerical");var a=n.ONEAVGYEAR;var i=n.ONEAVGMONTH;var o=n.ONEDAY;var s=n.ONEHOUR;var l=n.ONEMIN;var u=n.ONESEC;var c=t("../../plots/cartesian/axes").tickIncrement;e.exports=function t(e,r,n,i,s){var l=-1.1*r;var u=-.1*r;var h=e-u;var p=n[0];var d=n[1];var v=Math.min(f(p+u,p+h,i,s),f(d+u,d+h,i,s));var g=Math.min(f(p+l,p+u,i,s),f(d+l,d+u,i,s));var m,y;if(v>g&&g<Math.abs(d-p)/4e3){m=v;y=false}else{m=Math.min(v,g);y=true}if(i.type==="date"&&m>o){var x=m===a?1:6;var b=m===a?"M12":"M1";return function(t,r){var n=i.c2d(t,a,s);var o=n.indexOf("-",x);if(o>0)n=n.substr(0,o);var l=i.d2c(n,0,s);if(l<t){var u=c(l,b,false,s);if((l+u)/2<t+e)l=u}if(r&&y){return c(l,b,true,s)}return l}}return function(t,r){var n=m*Math.round(t/m);if(n+m/10<t&&n+m*.9<t+e){n+=m}if(r&&y){n-=m}return n}};function f(t,e,r,n){if(t*e<=0)return Infinity;var a=Math.abs(e-t);var i=r.type==="date";var o=h(a,i);for(var s=0;s<10;s++){var l=h(o*80,i);if(o===l)break;if(p(l,t,e,i,r,n))o=l;else break}return o}function h(t,e){if(e&&t>u){if(t>o){if(t>a*1.1)return a;if(t>i*1.1)return i;return o}if(t>s)return s;if(t>l)return l;return u}return Math.pow(10,Math.floor(Math.log(t)/Math.LN10))}function p(t,e,r,n,i,s){if(n&&t>o){var l=d(e,i,s);var u=d(r,i,s);var c=t===a?0:1;return l[c]!==u[c]}return Math.floor(r/t)-Math.floor(e/t)>.1}function d(t,e,r){var n=e.c2d(t,a,r).split("-");if(n[0]===""){n.unshift();n[0]="-"+n[0]}return n}},{"../../constants/numerical":661,"../../plots/cartesian/axes":732}],949:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib");var i=t("../../plots/cartesian/axes");var o=t("../bar/arrays_to_calcdata");var s=t("./bin_functions");var l=t("./norm_functions");var u=t("./average");var c=t("./clean_bins");var f=t("../../constants/numerical").ONEAVGMONTH;var h=t("./bin_label_vals");e.exports=function t(e,r){if(r.visible!==true)return;var f=[];var d=[];var v=i.getFromId(e,r.orientation==="h"?r.yaxis||"y":r.xaxis||"x");var g=r.orientation==="h"?"y":"x";var m={x:"y",y:"x"}[g];var x=r[g+"calendar"];var b=r.cumulative;var _;c(r,v,g);var w=p(e,r,v,g);var k=w[0];var M=w[1];var A=typeof k.size==="string";var T=[];var S=A?T:k;var E=[];var C=[];var L=[];var I=0;var z=r.histnorm;var P=r.histfunc;var O=z.indexOf("density")!==-1;var D,R,B;if(b.enabled&&O){z=z.replace(/ ?density$/,"");O=false}var F=P==="max"||P==="min";var N=F?null:0;var j=s.count;var V=l[z];var U=false;var q=function(t){return v.r2c(t,0,x)};var H;if(a.isArrayOrTypedArray(r[m])&&P!=="count"){H=r[m];U=P==="avg";j=s[P]}_=q(k.start);R=q(k.end)+(_-i.tickIncrement(_,k.size,false,x))/1e6;while(_<R&&f.length<1e6){D=i.tickIncrement(_,k.size,false,x);f.push((_+D)/2);d.push(N);L.push([]);T.push(_);if(O)E.push(1/(D-_));if(U)C.push(0);if(D<=_)break;_=D}T.push(_);if(!A&&v.type==="date"){S={start:q(S.start),end:q(S.end),size:S.size}}var G=d.length;var W=true;var Y=Infinity;var X=Infinity;var Z={};for(_=0;_<M.length;_++){var $=M[_];B=a.findBin($,S);if(B>=0&&B<G){I+=j(B,_,d,H,C);if(W&&L[B].length&&$!==M[L[B][0]]){W=false}L[B].push(_);Z[_]=B;Y=Math.min(Y,$-T[B]);X=Math.min(X,T[B+1]-$)}}var J;if(!W){J=h(Y,X,T,v,x)}if(U)I=u(d,C);if(V)V(d,I,E);if(b.enabled)y(d,b.direction,b.currentbin);var K=Math.min(f.length,d.length);var Q=[];var tt=0;var et=K-1;for(_=0;_<K;_++){if(d[_]){tt=_;break}}for(_=K-1;_>=tt;_--){if(d[_]){et=_;break}}for(_=tt;_<=et;_++){if(n(f[_])&&n(d[_])){var rt={p:f[_],s:d[_],b:0};if(!b.enabled){rt.pts=L[_];if(W){rt.p0=rt.p1=L[_].length?M[L[_][0]]:f[_]}else{rt.p0=J(T[_]);rt.p1=J(T[_+1],true)}}Q.push(rt)}}if(Q.length===1){Q[0].width1=i.tickIncrement(Q[0].p,k.size,false,x)-Q[0].p}o(Q,r);if(a.isArrayOrTypedArray(r.selectedpoints)){a.tagSelected(Q,r,Z)}return Q};function p(t,e,r,a,o){var s=a+"bins";var l=t._fullLayout.barmode==="overlay";var u,c,f,h,p;if(e._autoBinFinished){delete e._autoBinFinished}else{var m=l?[e]:v(t,e);var y=[];var x=Infinity;var b=Infinity;var _=-Infinity;var w="autobin"+a;for(u=0;u<m.length;u++){c=m[u];p=c._pos0=r.makeCalcdata(c,a);var k=c[s];if(c[w]||!k||k.start===null||k.end===null){f=c[a+"calendar"];var M=c.cumulative;k=i.autoBin(p,r,c["nbins"+a],false,f);if(l&&k._dataSpan===0&&r.type!=="category"){if(o)return[k,p,true];k=d(t,e,r,a,s)}if(M.enabled&&M.currentbin!=="include"){if(M.direction==="decreasing"){b=Math.min(b,r.r2c(k.start,0,f)-k.size)}else{_=Math.max(_,r.r2c(k.end,0,f)+k.size)}}y.push(c)}else if(!h){h={size:k.size,start:r.r2c(k.start,0,f),end:r.r2c(k.end,0,f)}}x=g(x,k.size);b=Math.min(b,r.r2c(k.start,0,f));_=Math.max(_,r.r2c(k.end,0,f));if(u)c._autoBinFinished=1}if(h&&n(h.size)&&n(x)){if(x>h.size/1.9)x=h.size;else x=h.size/Math.ceil(h.size/x);var A=h.start+(h.size-x)/2;b=A-x*Math.ceil((A-b)/x)}for(u=0;u<y.length;u++){c=y[u];f=c[a+"calendar"];c._input[s]=c[s]={start:r.c2r(b,0,f),end:r.c2r(_,0,f),size:x};c._input[w]=c[w]}}p=e._pos0;delete e._pos0;return[e[s],p]}function d(t,e,r,n,i){var o=v(t,e);var s=false;var l=Infinity;var u=[e];var c,f;for(c=0;c<o.length;c++){f=o[c];if(f===e)s=true;else if(!s){l=Math.min(l,f[i].size)}else{var h=p(t,f,r,n,true);var d=h[0];var g=h[2];f._autoBinFinished=1;f._pos0=h[1];if(g){u.push(f)}else{l=Math.min(l,d.size)}}}var m=new Array(u.length);for(c=0;c<u.length;c++){var y=u[c]._pos0;for(var x=0;x<y.length;x++){if(y[x]!==undefined){m[c]=y[x];break}}}if(!isFinite(l)){l=a.distinctVals(m).minDiff}for(c=0;c<u.length;c++){f=u[c];var b=f[n+"calendar"];f._input[i]=f[i]={start:r.c2r(m[c]-l/2,0,b),end:r.c2r(m[c]+l/2,0,b),size:l}}return e[i]}function v(t,e){var r=e.xaxis;var n=e.yaxis;var a=e.orientation;var i=[];var o=t._fullData;for(var s=0;s<o.length;s++){var l=o[s];if(l.type==="histogram"&&l.visible===true&&l.orientation===a&&l.xaxis===r&&l.yaxis===n){i.push(l)}}return i}function g(t,e){if(t===Infinity)return e;var r=m(t);var n=m(e);return n<r?e:t}function m(t){if(n(t))return t;if(typeof t==="string"&&t.charAt(0)==="M"){return f*+t.substr(1)}return Infinity}function y(t,e,r){var n,a,i;function o(e){i=t[e];t[e]/=2}function s(e){a=t[e];t[e]=i+a/2;i+=a}if(r==="half"){if(e==="increasing"){o(0);for(n=1;n<t.length;n++){s(n)}}else{o(t.length-1);for(n=t.length-2;n>=0;n--){s(n)}}}else if(e==="increasing"){for(n=1;n<t.length;n++){t[n]+=t[n-1]}if(r==="exclude"){t.unshift(0);t.pop()}}else{for(n=t.length-2;n>=0;n--){t[n]+=t[n+1]}if(r==="exclude"){t.push(0);t.shift()}}}},{"../../constants/numerical":661,"../../lib":684,"../../plots/cartesian/axes":732,"../bar/arrays_to_calcdata":826,"./average":945,"./bin_functions":947,"./bin_label_vals":948,"./clean_bins":950,"./norm_functions":955,"fast-isnumeric":214}],950:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib").cleanDate;var i=t("../../constants/numerical");var o=i.ONEDAY;var s=i.BADNUM;e.exports=function t(e,r,i){var l=r.type,u=i+"bins",c=e[u];if(!c)c=e[u]={};var f=l==="date"?function(t){return t||t===0?a(t,s,c.calendar):null}:function(t){return n(t)?Number(t):null};c.start=f(c.start);c.end=f(c.end);var h=l==="date"?o:1,p=c.size;if(n(p)){c.size=p>0?Number(p):h}else if(typeof p!=="string"){c.size=h}else{var d=p.charAt(0),v=p.substr(1);v=n(v)?Number(v):0;if(v<=0||!(l==="date"&&d==="M"&&v===Math.round(v))){c.size=h}}var g="autobin"+i;if(typeof e[g]!=="boolean"){e[g]=e._fullInput[g]=e._input[g]=!((c.start||c.start===0)&&(c.end||c.end===0))}if(!e[g]){delete e["nbins"+i];delete e._fullInput["nbins"+i]}}},{"../../constants/numerical":661,"../../lib":684,"fast-isnumeric":214}],951:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");var i=t("../../components/color");var o=t("./bin_defaults");var s=t("../bar/style_defaults");var l=t("./attributes");e.exports=function t(e,r,u,c){function f(t,n){return a.coerce(e,r,l,t,n)}var h=f("x");var p=f("y");var d=f("cumulative.enabled");if(d){f("cumulative.direction");f("cumulative.currentbin")}f("text");var v=f("orientation",p&&!h?"h":"v");var g=v==="v"?"x":"y";var m=v==="v"?"y":"x";var y=h&&p?Math.min(h.length&&p.length):(r[g]||[]).length;if(!y){r.visible=false;return}r._length=y;var x=n.getComponentMethod("calendars","handleTraceDefaults");x(e,r,["x","y"],c);var b=r[m];if(b)f("histfunc");o(e,r,f,[g]);s(e,r,f,u,c);var _=n.getComponentMethod("errorbars","supplyDefaults");_(e,r,i.defaultLine,{axis:"y"});_(e,r,i.defaultLine,{axis:"x",inherit:"y"});a.coerceSelectionMarkerOpacity(r,f)}},{"../../components/color":558,"../../lib":684,"../../registry":817,"../bar/style_defaults":839,"./attributes":944,"./bin_defaults":946}],952:[function(t,e,r){"use strict";e.exports=function t(e,r,n,a,i){e.x="xVal"in r?r.xVal:r.x;e.y="yVal"in r?r.yVal:r.y;if(r.xa)e.xaxis=r.xa;if(r.ya)e.yaxis=r.ya;if(!(n.cumulative||{}).enabled){var o=Array.isArray(i)?a[0].pts[i[0]][i[1]]:a[i].pts;e.pointNumbers=o;e.binNumber=e.pointNumber;delete e.pointNumber;delete e.pointIndex;var s;if(n._indexToPoints){s=[];for(var l=0;l<o.length;l++){s=s.concat(n._indexToPoints[o[l]])}}else{s=o}e.pointIndices=s}return e}},{}],953:[function(t,e,r){"use strict";var n=t("../bar/hover");var a=t("../../plots/cartesian/axes").hoverLabelText;e.exports=function t(e,r,i,o){var s=n(e,r,i,o);if(!s)return;e=s[0];var l=e.cd[e.index];var u=e.cd[0].trace;if(!u.cumulative.enabled){var c=u.orientation==="h"?"y":"x";e[c+"Label"]=a(e[c+"a"],l.p0,l.p1)}return s}},{"../../plots/cartesian/axes":732,"../bar/hover":830}],954:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.layoutAttributes=t("../bar/layout_attributes");n.supplyDefaults=t("./defaults");n.supplyLayoutDefaults=t("../bar/layout_defaults");n.calc=t("./calc");n.setPositions=t("../bar/set_positions");n.plot=t("../bar/plot");n.layerName="barlayer";n.style=t("../bar/style").style;n.styleOnSelect=t("../bar/style").styleOnSelect;n.colorbar=t("../scatter/marker_colorbar");n.hoverPoints=t("./hover");n.selectPoints=t("../bar/select");n.eventData=t("./event_data");n.moduleType="trace";n.name="histogram";n.basePlotModule=t("../../plots/cartesian");n.categories=["cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"];n.meta={};e.exports=n},{"../../plots/cartesian":743,"../bar/layout_attributes":832,"../bar/layout_defaults":833,"../bar/plot":834,"../bar/select":835,"../bar/set_positions":836,"../bar/style":838,"../scatter/marker_colorbar":1032,"./attributes":944,"./calc":949,"./defaults":951,"./event_data":952,"./hover":953}],955:[function(t,e,r){"use strict";e.exports={percent:function(t,e){var r=t.length,n=100/e;for(var a=0;a<r;a++)t[a]*=n},probability:function(t,e){var r=t.length;for(var n=0;n<r;n++)t[n]/=e},density:function(t,e,r,n){var a=t.length;n=n||1;for(var i=0;i<a;i++)t[i]*=r[i]*n},"probability density":function(t,e,r,n){var a=t.length;if(n)e/=n;for(var i=0;i<a;i++)t[i]*=r[i]/e}}},{}],956:[function(t,e,r){"use strict";var n=t("../histogram/attributes");var a=t("../heatmap/attributes");var i=t("../../components/colorscale/attributes");var o=t("../../components/colorbar/attributes");var s=t("../../lib/extend").extendFlat;e.exports=s({x:n.x,y:n.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:n.histnorm,histfunc:n.histfunc,autobinx:n.autobinx,nbinsx:n.nbinsx,xbins:n.xbins,autobiny:n.autobiny,nbinsy:n.nbinsy,ybins:n.ybins,xgap:a.xgap,ygap:a.ygap,zsmooth:a.zsmooth,zhoverformat:a.zhoverformat},i("",{cLetter:"z",autoColorDflt:false}),{colorbar:o})},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../heatmap/attributes":925,"../histogram/attributes":944}],957:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/cartesian/axes");var i=t("../histogram/bin_functions");var o=t("../histogram/norm_functions");var s=t("../histogram/average");var l=t("../histogram/clean_bins");var u=t("../histogram/bin_label_vals");e.exports=function t(e,r){var l=a.getFromId(e,r.xaxis||"x");var u=r.x?l.makeCalcdata(r,"x"):[];var d=a.getFromId(e,r.yaxis||"y");var v=r.y?d.makeCalcdata(r,"y"):[];var g=r.xcalendar;var m=r.ycalendar;var y=function(t){return l.r2c(t,0,g)};var x=function(t){return d.r2c(t,0,m)};var b=function(t){return l.c2r(t,0,g)};var _=function(t){return d.c2r(t,0,m)};var w,k,M,A;var T=r._length;if(u.length>T)u.splice(T,u.length-T);if(v.length>T)v.splice(T,v.length-T);c(r,"x",u,l,y,b,g);c(r,"y",v,d,x,_,m);var S=[];var E=[];var C=[];var L=typeof r.xbins.size==="string";var I=typeof r.ybins.size==="string";var z=[];var P=[];var O=L?z:r.xbins;var D=I?P:r.ybins;var R=0;var B=[];var F=[];var N=r.histnorm;var j=r.histfunc;var V=N.indexOf("density")!==-1;var U=j==="max"||j==="min";var q=U?null:0;var H=i.count;var G=o[N];var W=false;var Y=[];var X=[];var Z="z"in r?r.z:"marker"in r&&Array.isArray(r.marker.color)?r.marker.color:"";if(Z&&j!=="count"){W=j==="avg";H=i[j]}var $=r.xbins,J=y($.start),K=y($.end)+(J-a.tickIncrement(J,$.size,false,g))/1e6;for(w=J;w<K;w=a.tickIncrement(w,$.size,false,g)){E.push(q);z.push(w);if(W)C.push(0)}z.push(w);var Q=E.length;var tt=y(r.xbins.start);var et=(w-tt)/Q;var rt=b(tt+et/2);$=r.ybins;J=x($.start);K=x($.end)+(J-a.tickIncrement(J,$.size,false,m))/1e6;for(w=J;w<K;w=a.tickIncrement(w,$.size,false,m)){S.push(E.slice());P.push(w);var nt=new Array(Q);for(k=0;k<Q;k++)nt[k]=[];F.push(nt);if(W)B.push(C.slice())}P.push(w);var at=S.length;var it=x(r.ybins.start);var ot=(w-it)/at;var st=_(it+ot/2);if(V){Y=f(E.length,O,et,L);X=f(S.length,D,ot,I)}if(!L&&l.type==="date")O=h(y,O);if(!I&&d.type==="date")D=h(x,D);var lt=true;var ut=true;var ct=new Array(Q);var ft=new Array(at);var ht=Infinity;var pt=Infinity;var dt=Infinity;var vt=Infinity;for(w=0;w<T;w++){var gt=u[w];var mt=v[w];M=n.findBin(gt,O);A=n.findBin(mt,D);if(M>=0&&M<Q&&A>=0&&A<at){R+=H(M,w,S[A],Z,B[A]);F[A][M].push(w);if(lt){if(ct[M]===undefined)ct[M]=gt;else if(ct[M]!==gt)lt=false}if(ut){if(ft[M]===undefined)ft[M]=mt;else if(ft[M]!==mt)ut=false}ht=Math.min(ht,gt-z[M]);pt=Math.min(pt,z[M+1]-gt);dt=Math.min(dt,mt-P[A]);vt=Math.min(vt,P[A+1]-mt)}}if(W){for(A=0;A<at;A++)R+=s(S[A],B[A])}if(G){for(A=0;A<at;A++)G(S[A],R,Y,X[A])}return{x:u,xRanges:p(z,lt&&ct,ht,pt,l,g),x0:rt,dx:et,y:v,yRanges:p(P,ut&&ft,dt,vt,d,m),y0:st,dy:ot,z:S,pts:F}};function c(t,e,r,n,i,o,s){var u=e+"bins";var c="autobin"+e;var f=t[u];l(t,n,e);if(t[c]||!f||f.start===null||f.end===null){f=a.autoBin(r,n,t["nbins"+e],"2d",s);if(t.type==="histogram2dcontour"){f.start=o(a.tickIncrement(i(f.start),f.size,true,s));f.end=o(a.tickIncrement(i(f.end),f.size,false,s))}t._input[u]=t[u]=f;t._input[c]=t[c]}}function f(t,e,r,n){var a=new Array(t);var i;if(n){for(i=0;i<t;i++)a[i]=1/(e[i+1]-e[i])}else{var o=1/r;for(i=0;i<t;i++)a[i]=o}return a}function h(t,e){return{start:t(e.start),end:t(e.end),size:e.size}}function p(t,e,r,n,a,i){var o;var s=t.length-1;var l=new Array(s);if(e){for(o=0;o<s;o++)l[o]=[e[o],e[o]]}else{var c=u(r,n,t,a,i);for(o=0;o<s;o++)l[o]=[c(t[o]),c(t[o+1],true)]}return l}},{"../../lib":684,"../../plots/cartesian/axes":732,"../histogram/average":945,"../histogram/bin_functions":947,"../histogram/bin_label_vals":948,"../histogram/clean_bins":950,"../histogram/norm_functions":955}],958:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./sample_defaults");var i=t("../heatmap/style_defaults");var o=t("../../components/colorscale/defaults");var s=t("./attributes");e.exports=function t(e,r,l,u){function c(t,a){return n.coerce(e,r,s,t,a)}a(e,r,c,u);if(r.visible===false)return;i(e,r,c,u);o(e,r,u,c,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":568,"../../lib":684,"../heatmap/style_defaults":939,"./attributes":956,"./sample_defaults":961}],959:[function(t,e,r){"use strict";var n=t("../heatmap/hover");var a=t("../../plots/cartesian/axes").hoverLabelText;e.exports=function t(e,r,i,o,s,l){var u=n(e,r,i,o,s,l);if(!u)return;e=u[0];var c=e.index;var f=c[0];var h=c[1];var p=e.cd[0];var d=p.xRanges[h];var v=p.yRanges[f];e.xLabel=a(e.xa,d[0],d[1]);e.yLabel=a(e.ya,v[0],v[1]);return u}},{"../../plots/cartesian/axes":732,"../heatmap/hover":932}],960:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.calc=t("../heatmap/calc");n.plot=t("../heatmap/plot");n.layerName="heatmaplayer";n.colorbar=t("../heatmap/colorbar");n.style=t("../heatmap/style");n.hoverPoints=t("./hover");n.eventData=t("../histogram/event_data");n.moduleType="trace";n.name="histogram2d";n.basePlotModule=t("../../plots/cartesian");n.categories=["cartesian","svg","2dMap","histogram"];n.meta={};e.exports=n},{"../../plots/cartesian":743,"../heatmap/calc":926,"../heatmap/colorbar":928,"../heatmap/plot":937,"../heatmap/style":938,"../histogram/event_data":952,"./attributes":956,"./defaults":958,"./hover":959}],961:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../histogram/bin_defaults");e.exports=function t(e,r,i,o){var s=i("x");var l=i("y");if(!(s&&s.length&&l&&l.length)){r.visible=false;return}r._length=Math.min(s.length,l.length);var u=n.getComponentMethod("calendars","handleTraceDefaults");u(e,r,["x","y"],o);var c=i("z")||i("marker.color");if(c)i("histfunc");var f=["x","y"];a(e,r,i,f)}},{"../../registry":817,"../histogram/bin_defaults":946}],962:[function(t,e,r){"use strict";var n=t("../histogram2d/attributes");var a=t("../contour/attributes");var i=t("../../components/colorscale/attributes");var o=t("../../components/colorbar/attributes");var s=t("../../lib/extend").extendFlat;e.exports=s({x:n.x,y:n.y,z:n.z,marker:n.marker,histnorm:n.histnorm,histfunc:n.histfunc,autobinx:n.autobinx,nbinsx:n.nbinsx,xbins:n.xbins,autobiny:n.autobiny,nbinsy:n.nbinsy,ybins:n.ybins,autocontour:a.autocontour,ncontours:a.ncontours,contours:a.contours,line:a.line,zhoverformat:n.zhoverformat},i("",{cLetter:"z",editTypeOverride:"calc"}),{colorbar:o})},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../contour/attributes":896,"../histogram2d/attributes":956}],963:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../histogram2d/sample_defaults");var i=t("../contour/contours_defaults");var o=t("../contour/style_defaults");var s=t("./attributes");e.exports=function t(e,r,l,u){function c(t,a){return n.coerce(e,r,s,t,a)}function f(t){return n.coerce2(e,r,s,t)}a(e,r,c,u);if(r.visible===false)return;i(e,r,c,f);o(e,r,c,u)}},{"../../lib":684,"../contour/contours_defaults":903,"../contour/style_defaults":917,"../histogram2d/sample_defaults":961,"./attributes":962}],964:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.calc=t("../contour/calc");n.plot=t("../contour/plot").plot;n.layerName="contourlayer";n.style=t("../contour/style");n.colorbar=t("../contour/colorbar");n.hoverPoints=t("../contour/hover");n.moduleType="trace";n.name="histogram2dcontour";n.basePlotModule=t("../../plots/cartesian");n.categories=["cartesian","svg","2dMap","contour","histogram"];n.meta={};e.exports=n},{"../../plots/cartesian":743,"../contour/calc":897,"../contour/colorbar":899,"../contour/hover":909,"../contour/plot":914,"../contour/style":916,"./attributes":962,"./defaults":963}],965:[function(t,e,r){"use strict";var n=t("../../components/colorscale/attributes");var a=t("../../components/colorbar/attributes");var i=t("../surface/attributes");var o=t("../../plots/attributes");var s=t("../../lib/extend").extendFlat;e.exports=s({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"}},n("",{colorAttr:"`intensity`",showScaleDflt:true,editTypeOverride:"calc"}),{colorbar:a,opacity:i.opacity,flatshading:{valType:"boolean",dflt:false,editType:"calc"},contour:{show:s({},i.contours.x.show,{}),color:i.contours.x.color,width:i.contours.x.width,editType:"calc"},lightposition:{x:s({},i.lightposition.x,{dflt:1e5}),y:s({},i.lightposition.y,{dflt:1e5}),z:s({},i.lightposition.z,{dflt:0}),editType:"calc"},lighting:s({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},i.lighting),hoverinfo:s({},o.hoverinfo,{editType:"calc"})})},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../../plots/attributes":729,"../surface/attributes":1100}],966:[function(t,e,r){"use strict";var n=t("../../components/colorscale/calc");e.exports=function t(e,r){if(r.intensity){n(r,r.intensity,"","c")}}},{"../../components/colorscale/calc":566}],967:[function(t,e,r){"use strict";var n=t("gl-mesh3d");var a=t("delaunay-triangulate");var i=t("alpha-shape");var o=t("convex-hull");var s=t("../../lib/gl_format_color").parseColorScale;var l=t("../../lib/str2rgbarray");var u=t("../../plots/gl3d/zip3");function c(t,e,r){this.scene=t;this.uid=r;this.mesh=e;this.name="";this.color="#fff";this.data=null;this.showContour=false}var f=c.prototype;f.handlePick=function(t){if(t.object===this.mesh){var e=t.index=t.data.index;t.traceCoordinate=[this.data.x[e],this.data.y[e],this.data.z[e]];var r=this.data.text;if(Array.isArray(r)&&r[e]!==undefined){t.textLabel=r[e]}else if(r){t.textLabel=r}return true}};function h(t){return t.map(l)}f.update=function(t){var e=this.scene,r=e.fullSceneLayout;this.data=t;function n(t,e,r,n){return e.map(function(e){return t.d2l(e,0,n)*r})}var c=u(n(r.xaxis,t.x,e.dataScale[0],t.xcalendar),n(r.yaxis,t.y,e.dataScale[1],t.ycalendar),n(r.zaxis,t.z,e.dataScale[2],t.zcalendar));var f;if(t.i&&t.j&&t.k){f=u(t.i,t.j,t.k)}else if(t.alphahull===0){f=o(c)}else if(t.alphahull>0){f=i(t.alphahull,c)}else{var p=["x","y","z"].indexOf(t.delaunayaxis);f=a(c.map(function(t){return[t[(p+1)%3],t[(p+2)%3]]}))}var d={positions:c,cells:f,lightPosition:[t.lightposition.x,t.lightposition.y,t.lightposition.z],ambient:t.lighting.ambient,diffuse:t.lighting.diffuse,specular:t.lighting.specular,roughness:t.lighting.roughness,fresnel:t.lighting.fresnel,vertexNormalsEpsilon:t.lighting.vertexnormalsepsilon,faceNormalsEpsilon:t.lighting.facenormalsepsilon,opacity:t.opacity,contourEnable:t.contour.show,contourColor:l(t.contour.color).slice(0,3),contourWidth:t.contour.width,useFacetNormals:t.flatshading};if(t.intensity){this.color="#fff";d.vertexIntensity=t.intensity;d.vertexIntensityBounds=[t.cmin,t.cmax];d.colormap=s(t.colorscale)}else if(t.vertexcolor){this.color=t.vertexcolor[0];d.vertexColors=h(t.vertexcolor)}else if(t.facecolor){this.color=t.facecolor[0];d.cellColors=h(t.facecolor)}else{this.color=t.color;d.meshColor=l(t.color)}this.mesh.update(d)};f.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function p(t,e){var r=t.glplot.gl;var a=n({gl:r});var i=new c(t,a,e.uid);a._trace=i;i.update(e);t.glplot.add(a);return i}e.exports=p},{"../../lib/gl_format_color":680,"../../lib/str2rgbarray":707,"../../plots/gl3d/zip3":785,"alpha-shape":55,"convex-hull":117,"delaunay-triangulate":149,"gl-mesh3d":268}],968:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");var i=t("../../components/colorscale/defaults");var o=t("./attributes");e.exports=function t(e,r,s,l){function u(t,n){return a.coerce(e,r,o,t,n)}function c(t){var e=t.map(function(t){var e=u(t);if(e&&a.isArrayOrTypedArray(e))return e;return null});return e.every(function(t){return t&&t.length===e[0].length})&&e}var f=c(["x","y","z"]);var h=c(["i","j","k"]);if(!f){r.visible=false;return}if(h){h.forEach(function(t){for(var e=0;e<t.length;++e)t[e]|=0})}var p=n.getComponentMethod("calendars","handleTraceDefaults");p(e,r,["x","y","z"],l);["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","contour.show","contour.color","contour.width","colorscale","reversescale","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(t){u(t)});if("intensity"in e){u("intensity");i(e,r,l,u,{prefix:"",cLetter:"c"})}else{r.showscale=false;if("facecolor"in e)u("facecolor");else if("vertexcolor"in e)u("vertexcolor");else u("color",s)}u("text");r._length=null}},{"../../components/colorscale/defaults":568,"../../lib":684,"../../registry":817,"./attributes":965}],969:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.calc=t("./calc");n.colorbar={min:"cmin",max:"cmax"};n.plot=t("./convert");n.moduleType="trace";n.name="mesh3d",n.basePlotModule=t("../../plots/gl3d");n.categories=["gl3d"];n.meta={};e.exports=n},{"../../plots/gl3d":774,"./attributes":965,"./calc":966,"./convert":967,"./defaults":968}],970:[function(t,e,r){"use strict";var n=t("../../lib").extendFlat;var a=t("../scatter/attributes");var i=t("../../components/drawing/attributes").dash;var o="#3D9970";var s="#FF4136";var l=a.line;function u(t){return{line:{color:n({},l.color,{dflt:t}),width:l.width,dash:i,editType:"style"},editType:"style"}}e.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:n({},l.width,{}),dash:n({},i,{}),editType:"style"},increasing:u(o),decreasing:u(s),text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calcIfAutorange"}}},{"../../components/drawing/attributes":582,"../../lib":684,"../scatter/attributes":1015}],971:[function(t,e,r){"use strict";var n=t("../../lib");var a=n._;var i=t("../../plots/cartesian/axes");var o=t("../../constants/numerical").BADNUM;function s(t,e){var r=i.getFromId(t,e.xaxis);var a=i.getFromId(t,e.yaxis);var o=c(t,r,e);var s=e._minDiff;e._minDiff=null;var f=e._xcalc;e._xcalc=null;var h=u(t,e,f,a,l);i.expand(r,f,{vpad:s/2});if(h.length){n.extendFlat(h[0].t,{wHover:s/2,tickLen:o});return h}else{return[{t:{empty:true}}]}}function l(t,e,r,n){return{o:t,h:e,l:r,c:n}}function u(t,e,r,n,s){var l=n.makeCalcdata(e,"open");var u=n.makeCalcdata(e,"high");var c=n.makeCalcdata(e,"low");var f=n.makeCalcdata(e,"close");var h=Array.isArray(e.text);var p=true;var d=null;var v=[];for(var g=0;g<r.length;g++){var m=r[g];var y=l[g];var x=u[g];var b=c[g];var _=f[g];if(m!==o&&y!==o&&x!==o&&b!==o&&_!==o){if(_===y){if(d!==null&&_!==d)p=_>d}else p=_>y;d=_;var w=s(y,x,b,_);w.pos=m;w.yc=(y+_)/2;w.i=g;w.dir=p?"increasing":"decreasing";if(h)w.tx=e.text[g];v.push(w)}}i.expand(n,c.concat(u),{padded:true});if(v.length){v[0].t={labels:{open:a(t,"open:")+" ",high:a(t,"high:")+" ",low:a(t,"low:")+" ",close:a(t,"close:")+" "}}}return v}function c(t,e,r){var a=r._minDiff;if(!a){var i=t._fullData,o=[];a=Infinity;var s;for(s=0;s<i.length;s++){var l=i[s];if(l.type==="ohlc"&&l.visible===true&&l.xaxis===e._id){o.push(l);var u=e.makeCalcdata(l,"x");l._xcalc=u;var c=n.distinctVals(u).minDiff;if(c&&isFinite(c)){a=Math.min(a,c)}}}if(a===Infinity)a=1;for(s=0;s<o.length;s++){o[s]._minDiff=a}}return a*r.tickwidth}e.exports={calc:s,calcCommon:u}},{"../../constants/numerical":661,"../../lib":684,"../../plots/cartesian/axes":732}],972:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./ohlc_defaults");var i=t("./attributes");e.exports=function t(e,r,s,l){function u(t,a){return n.coerce(e,r,i,t,a)}var c=a(e,r,u,l);if(!c){r.visible=false;return}u("line.width");u("line.dash");o(e,r,u,"increasing");o(e,r,u,"decreasing");u("text");u("tickwidth");l._requestRangeslider[r.xaxis]=true};function o(t,e,r,n){r(n+".line.color");r(n+".line.width",e.line.width);r(n+".line.dash",e.line.dash)}},{"../../lib":684,"./attributes":970,"./ohlc_defaults":975}],973:[function(t,e,r){"use strict";var n=t("../../plots/cartesian/axes");var a=t("../../components/fx");var i=t("../../components/color");var o=t("../scatter/fill_hover_text");var s={increasing:"\u25b2",decreasing:"\u25bc"};e.exports=function t(e,r,l,u){var c=e.cd;var f=e.xa;var h=e.ya;var p=c[0].trace;var d=c[0].t;var v=p.type;var g=v==="ohlc"?"l":"min";var m=v==="ohlc"?"h":"max";var y=d.bPos||0;var x=r-y;var b=d.bdPos||d.tickLen;var _=d.wHover;var w=Math.min(1,b/Math.abs(f.r2c(f.range[1])-f.r2c(f.range[0])));var k=e.maxHoverDistance-w;var M=e.maxSpikeDistance-w;function A(t){var e=t.pos-x;return a.inbox(e-_,e+_,k)}function T(t){return a.inbox(t[g]-l,t[m]-l,k)}function S(t){return(A(t)+T(t))/2}var E=a.getDistanceFunction(u,A,T,S);a.getClosest(c,E,e);if(e.index===false)return[];var C=e.index;var L=c[C];var I=e.index=L.i;var z=L.dir;var P=p[z];var O=P.line.color;if(i.opacity(O)&&P.line.width)e.color=O;else e.color=P.fillcolor;e.x0=f.c2p(L.pos+y-b,true);e.x1=f.c2p(L.pos+y+b,true);e.xLabelVal=L.pos;e.spikeDistance=S(L)*M/k;e.xSpike=f.c2p(L.pos,true);function D(t){return d.labels[t]+n.hoverLabelText(h,p[t][I])}var R=p.hoverinfo;var B=R.split("+");var F=R==="all";var N=F||B.indexOf("y")!==-1;var j=F||B.indexOf("text")!==-1;var V=N?[D("open"),D("high"),D("low"),D("close")+"  "+s[z]]:[];if(j)o(L,p,V);e.extraText=V.join("<br>");e.y0=e.y1=h.c2p(L.yc,true);return[e]}},{"../../components/color":558,"../../components/fx":600,"../../plots/cartesian/axes":732,"../scatter/fill_hover_text":1022}],974:[function(t,e,r){"use strict";e.exports={moduleType:"trace",name:"ohlc",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:t("./attributes"),supplyDefaults:t("./defaults"),calc:t("./calc").calc,plot:t("./plot"),style:t("./style"),hoverPoints:t("./hover"),selectPoints:t("./select")}},{"../../plots/cartesian":743,"./attributes":970,"./calc":971,"./defaults":972,"./hover":973,"./plot":976,"./select":977,"./style":978}],975:[function(t,e,r){"use strict";var n=t("../../registry");e.exports=function t(e,r,a,i){var o=a("x");var s=a("open");var l=a("high");var u=a("low");var c=a("close");var f=n.getComponentMethod("calendars","handleTraceDefaults");f(e,r,["x"],i);if(!(s&&l&&u&&c))return;var h=Math.min(s.length,l.length,u.length,c.length);if(o)h=Math.min(h,o.length);r._length=h;return h}},{"../../registry":817}],976:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../lib");e.exports=function t(e,r,i,o){var s=r.xaxis;var l=r.yaxis;var u=o.selectAll("g.trace").data(i,function(t){return t[0].trace.uid});u.enter().append("g").attr("class","trace ohlc");u.exit().remove();u.order();u.each(function(t){var e=t[0];var i=e.t;var o=e.trace;var u=n.select(this);if(!r.isRangePlot)e.node3=u;if(o.visible!==true||i.empty){u.remove();return}var c=i.tickLen;var f=u.selectAll("path").data(a.identity);f.enter().append("path");f.exit().remove();f.attr("d",function(t){var e=s.c2p(t.pos,true);var r=s.c2p(t.pos-c,true);var n=s.c2p(t.pos+c,true);var a=l.c2p(t.o,true);var i=l.c2p(t.h,true);var o=l.c2p(t.l,true);var u=l.c2p(t.c,true);return"M"+r+","+a+"H"+e+"M"+e+","+i+"V"+o+"M"+n+","+u+"H"+e})})}},{"../../lib":684,d3:147}],977:[function(t,e,r){"use strict";e.exports=function t(e,r){var n=e.cd;var a=e.xaxis;var i=e.yaxis;var o=[];var s;var l=n[0].t.bPos||0;if(r===false){for(s=0;s<n.length;s++){n[s].selected=0}}else{for(s=0;s<n.length;s++){var u=n[s];if(r.contains([a.c2p(u.pos+l),i.c2p(u.yc)])){o.push({pointNumber:u.i,x:a.c2d(u.pos),y:i.c2d(u.yc)});u.selected=1}else{u.selected=0}}}return o}},{}],978:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/drawing");var i=t("../../components/color");e.exports=function t(e,r){var o=r?r[0].node3:n.select(e).selectAll("g.ohlclayer").selectAll("g.trace");o.style("opacity",function(t){return t[0].trace.opacity});o.each(function(t){var e=t[0].trace;n.select(this).selectAll("path").each(function(t){var r=e[t.dir].line;n.select(this).style("fill","none").call(i.stroke,r.color).call(a.dashLine,r.dash,r.width).style("opacity",e.selectedpoints&&!t.selected?.3:1)})})}},{"../../components/color":558,"../../components/drawing":583,d3:147}],979:[function(t,e,r){"use strict";var n=t("../../components/colorscale/attributes");var a=t("../../components/colorbar/attributes");var i=t("../../plots/cartesian/layout_attributes");var o=t("../../plots/font_attributes");var s=t("../../plots/domain").attributes;var l=t("../../lib/extend").extendFlat;var u=t("../../plot_api/plot_template").templatedArray;e.exports={domain:s({name:"parcoords",trace:true,editType:"calc"}),labelfont:o({editType:"calc"}),tickfont:o({editType:"calc"}),rangefont:o({editType:"calc"}),dimensions:u("dimension",{label:{valType:"string",editType:"calc"},tickvals:l({},i.tickvals,{editType:"calc"}),ticktext:l({},i.ticktext,{editType:"calc"}),tickformat:{valType:"string",dflt:"3s",editType:"calc"},visible:{valType:"boolean",dflt:true,editType:"calc"},range:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},constraintrange:{valType:"info_array",freeLength:true,dimensions:"1-2",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},multiselect:{valType:"boolean",dflt:true,editType:"calc"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:l(n("line",{colorscaleDflt:"Viridis",autoColorDflt:false,editTypeOverride:"calc"}),{colorbar:a,editType:"calc"})}},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../../plot_api/plot_template":722,"../../plots/cartesian/layout_attributes":744,"../../plots/domain":757,"../../plots/font_attributes":758}],980:[function(t,e,r){"use strict";var n=t("./constants");var a=t("d3");var i=t("../../lib/gup").keyFun;var o=t("../../lib/gup").repeat;var s=t("../../lib").sorterAsc;var l=n.bar.snapRatio;function u(t,e){return t*(1-l)+e*l}var c=n.bar.snapClose;function f(t,e){return t*(1-c)+e*c}function h(t,e,r){if(d(e,r))return e;var n=t[0];var a=n;for(var i=1;i<t.length;i++){var o=t[i];if(e<f(n,o))return u(n,a);if(e<o||i===t.length-1)return u(o,n);a=n;n=o}}function p(t,e,r){if(d(e,r))return e;var n=t[t.length-1];var a=n;for(var i=t.length-2;i>=0;i--){var o=t[i];if(e>f(n,o))return u(n,a);if(e>o||i===t.length-1)return u(o,n);a=n;n=o}}function d(t,e){for(var r=0;r<e.length;r++){if(t>=e[r][0]&&t<=e[r][1])return true}return false}function v(t){t.attr("x",-n.bar.captureWidth/2).attr("width",n.bar.captureWidth)}function g(t){t.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function m(t){if(!t.brush.filterSpecified){return"0,"+t.height}var e=y(t.brush.filter.getConsolidated(),t.height);var r=[0];var n,a,i;var o=e.length?e[0][0]:null;for(var s=0;s<e.length;s++){n=e[s];a=n[1]-n[0];r.push(o);r.push(a);i=s+1;if(i<e.length){o=e[i][0]-n[1]}}r.push(t.height);return r}function y(t,e){return t.map(function(t){return t.map(function(t){return t*e}).sort(s)})}function x(t,e){var r=n.bar.handleHeight;if(e>t[1]+r||e<t[0]-r)return;if(e>=.9*t[1]+.1*t[0])return"n";if(e<=.9*t[0]+.1*t[1])return"s";return"ns"}function b(){a.select(document.body).style("cursor",null)}function _(t){t.attr("stroke-dasharray",m)}function w(t,e){var r=a.select(t).selectAll(".highlight, .highlight-shadow");var i=e?r.transition().duration(n.bar.snapDuration).each("end",e):r;_(i)}function k(t,e){var r=t.brush;var n=r.filterSpecified;var a=NaN;var i={};var o;if(n){var s=t.height;var l=r.filter.getConsolidated();var u=y(l,s);var c=NaN;var f=NaN;var h=NaN;for(o=0;o<=u.length;o++){var p=u[o];if(p&&p[0]<=e&&e<=p[1]){c=o;break}else{f=o?o-1:NaN;if(p&&p[0]>e){h=o;break}}}a=c;if(isNaN(a)){if(isNaN(f)||isNaN(h)){a=isNaN(f)?h:f}else{a=e-u[f][1]<u[h][0]-e?f:h}}if(!isNaN(a)){var d=u[a];var v=x(d,e);if(v){i.interval=l[a];i.intervalPix=d;i.region=v}}}if(t.ordinal&&!i.region){var g=t.unitTickvals;var m=t.unitToPaddedPx.invert(e);for(o=0;o<g.length;o++){var b=[g[Math.max(o-1,0)]*.25+g[o]*.75,g[Math.min(o+1,g.length-1)]*.25+g[o]*.75];if(m>=b[0]&&m<=b[1]){i.clickableOrdinalRange=b;break}}}return i}function M(t){t.on("mousemove",function(t){a.event.preventDefault();if(!t.parent.inBrushDrag){var e=t.height-a.mouse(this)[1]-2*n.verticalPadding;var r=k(t,e);var i="crosshair";if(r.clickableOrdinalRange)i="pointer";else if(r.region)i=r.region+"-resize";a.select(document.body).style("cursor",i)}}).on("mouseleave",function(t){if(!t.parent.inBrushDrag)b()}).call(a.behavior.drag().on("dragstart",function(t){a.event.sourceEvent.stopPropagation();var e=t.height-a.mouse(this)[1]-2*n.verticalPadding;var r=t.unitToPaddedPx.invert(e);var i=t.brush;var o=k(t,e);var s=o.interval;var l=i.svgBrush;l.wasDragged=false;l.grabbingBar=o.region==="ns";if(l.grabbingBar){var u=s.map(t.unitToPaddedPx);l.grabPoint=e-u[0]-n.verticalPadding;l.barLength=u[1]-u[0]}l.clickableOrdinalRange=o.clickableOrdinalRange;l.stayingIntervals=t.multiselect&&i.filterSpecified?i.filter.getConsolidated():[];if(s){l.stayingIntervals=l.stayingIntervals.filter(function(t){return t[0]!==s[0]&&t[1]!==s[1]})}l.startExtent=o.region?s[o.region==="s"?1:0]:r;t.parent.inBrushDrag=true;l.brushStartCallback()}).on("drag",function(t){a.event.sourceEvent.stopPropagation();var e=t.height-a.mouse(this)[1]-2*n.verticalPadding;var r=t.brush.svgBrush;r.wasDragged=true;if(r.grabbingBar){r.newExtent=[e-r.grabPoint,e+r.barLength-r.grabPoint].map(t.unitToPaddedPx.invert)}else{r.newExtent=[r.startExtent,t.unitToPaddedPx.invert(e)].sort(s)}var i=Math.max(0,-r.newExtent[0]);var o=Math.max(0,r.newExtent[1]-1);r.newExtent[0]+=i;r.newExtent[1]-=o;if(r.grabbingBar){r.newExtent[1]+=i;r.newExtent[0]-=o}t.brush.filterSpecified=true;r.extent=r.stayingIntervals.concat([r.newExtent]);r.brushCallback(t);w(this.parentNode)}).on("dragend",function(t){var e=a.event;e.sourceEvent.stopPropagation();var r=t.brush;var n=r.filter;var i=r.svgBrush;var o=i.grabbingBar;i.grabbingBar=false;i.grabLocation=undefined;t.parent.inBrushDrag=false;b();if(!i.wasDragged){i.wasDragged=undefined;if(i.clickableOrdinalRange){if(r.filterSpecified&&t.multiselect){i.extent.push(i.clickableOrdinalRange)}else{i.extent=[i.clickableOrdinalRange];r.filterSpecified=true}}else if(o){i.extent=i.stayingIntervals;if(i.extent.length===0){C(r)}}else{C(r)}i.brushCallback(t);w(this.parentNode);i.brushEndCallback(r.filterSpecified?n.getConsolidated():[]);return}var s=function(){n.set(n.getConsolidated())};if(t.ordinal){var l=t.unitTickvals;if(l[l.length-1]<l[0])l.reverse();i.newExtent=[h(l,i.newExtent[0],i.stayingIntervals),p(l,i.newExtent[1],i.stayingIntervals)];var u=i.newExtent[1]>i.newExtent[0];i.extent=i.stayingIntervals.concat(u?[i.newExtent]:[]);if(!i.extent.length){C(r)}i.brushCallback(t);if(u){w(this.parentNode,s)}else{s();w(this.parentNode)}}else{s()}i.brushEndCallback(r.filterSpecified?n.getConsolidated():[])}))}function A(t,e){return t[0]-e[0]}function T(t){var e=t.selectAll(".background").data(o);e.enter().append("rect").classed("background",true).call(v).call(g).style("pointer-events","auto").attr("transform","translate(0 "+n.verticalPadding+")");e.call(M).attr("height",function(t){return t.height-n.verticalPadding});var r=t.selectAll(".highlight-shadow").data(o);r.enter().append("line").classed("highlight-shadow",true).attr("x",-n.bar.width/2).attr("stroke-width",n.bar.width+n.bar.strokeWidth).attr("stroke",n.bar.strokeColor).attr("opacity",n.bar.strokeOpacity).attr("stroke-linecap","butt");r.attr("y1",function(t){return t.height}).call(_);var a=t.selectAll(".highlight").data(o);a.enter().append("line").classed("highlight",true).attr("x",-n.bar.width/2).attr("stroke-width",n.bar.width-n.bar.strokeWidth).attr("stroke",n.bar.fillColor).attr("opacity",n.bar.fillOpacity).attr("stroke-linecap","butt");a.attr("y1",function(t){return t.height}).call(_)}function S(t){var e=t.selectAll("."+n.cn.axisBrush).data(o,i);e.enter().append("g").classed(n.cn.axisBrush,true);T(e)}function E(t){return t.svgBrush.extent.map(function(t){return t.slice()})}function C(t){t.filterSpecified=false;t.svgBrush.extent=[[0,1]]}function L(t){return function e(r){var n=r.brush;var a=E(n);var i=a.slice();n.filter.set(i);t()}}function I(t){var e=t.slice();var r=[];var n;var a=e.shift();while(a){n=a.slice();while((a=e.shift())&&a[0]<=n[1]){n[1]=Math.max(n[1],a[1])}r.push(n)}return r}function z(){var t=[];var e;var r;return{set:function(n){t=n.map(function(t){return t.slice().sort(s)}).sort(A);e=I(t);r=t.reduce(function(t,e){return[Math.min(t[0],e[0]),Math.max(t[1],e[1])]},[Infinity,-Infinity])},get:function(){return t.slice()},getConsolidated:function(){return e},getBounds:function(){return r}}}function P(t,e,r,n,a,i){var o=z();o.set(r);return{filter:o,filterSpecified:e,svgBrush:{extent:[],brushStartCallback:n,brushCallback:L(a),brushEndCallback:i}}}function O(t,e){if(Array.isArray(t[0])){t=t.map(function(t){return t.sort(s)});if(!e.multiselect)t=[t[0]];else t=I(t.sort(A))}else t=[t.sort(s)];if(e.tickvals){var r=e.tickvals.slice().sort(s);t=t.map(function(t){var e=[h(r,t[0],[]),p(r,t[1],[])];if(e[1]>e[0])return e}).filter(function(t){return t});if(!t.length)return}return t.length>1?t:t[0]}e.exports={makeBrush:P,ensureAxisBrush:S,cleanRanges:O}},{"../../lib":684,"../../lib/gup":681,"./constants":983,d3:147}],981:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../plots/get_data").getModuleCalcData;var i=t("./plot");var o=t("../../constants/xmlns_namespaces");var s="parcoords";r.name=s;r.plot=function(t){var e=a(t.calcdata,s)[0];if(e.length)i(t,e)};r.clean=function(t,e,r,n){var a=n._has&&n._has(s);var i=e._has&&e._has(s);if(a&&!i){n._paperdiv.selectAll(".parcoords").remove();n._glimages.selectAll("*").remove()}};r.toSVG=function(t){var e=t._fullLayout._glimages;var r=n.select(t).selectAll(".svg-container");var a=r.filter(function(t,e){return e===r.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function i(){var t=this;var r=t.toDataURL("image/png");var n=e.append("svg:image");n.attr({xmlns:o.svg,"xlink:href":r,preserveAspectRatio:"none",x:0,y:0,width:t.width,height:t.height})}a.each(i);window.setTimeout(function(){n.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":663,"../../plots/get_data":768,"./plot":989,d3:147}],982:[function(t,e,r){"use strict";var n=t("../../components/colorscale/has_colorscale");var a=t("../../components/colorscale/calc");var i=t("../../lib");var o=t("../../lib/gup").wrap;e.exports=function t(e,r){var l=!!r.line.colorscale&&i.isArrayOrTypedArray(r.line.color);var u=l?r.line.color:s(r._length);var c=l?r.line.colorscale:[[0,r.line.color],[1,r.line.color]];if(n(r,"line")){a(r,u,"line","c")}return o({lineColor:u,cscale:c})};function s(t){var e=new Array(t);for(var r=0;r<t;r++){e[r]=.5}return e}},{"../../components/colorscale/calc":566,"../../components/colorscale/has_colorscale":572,"../../lib":684,"../../lib/gup":681}],983:[function(t,e,r){"use strict";e.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeColor:"white",strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],984:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../components/colorscale/has_colorscale");var i=t("../../components/colorscale/defaults");var o=t("../../plots/domain").defaults;var s=t("../../plots/array_container_defaults");var l=t("./attributes");var u=t("./axisbrush");var c=t("./constants").maxDimensionCount;var f=t("./merge_length");function h(t,e,r,o,s){var l=s("line.color",r);if(a(t,"line")&&n.isArrayOrTypedArray(l)){if(l.length){s("line.colorscale");i(t,e,o,s,{prefix:"line.",cLetter:"c"});return l.length}else{e.line.color=r}}return Infinity}function p(t,e){function r(r,a){return n.coerce(t,e,l.dimensions,r,a)}var a=r("values");var i=r("visible");if(!(a&&a.length)){i=e.visible=false}if(i){r("label");r("tickvals");r("ticktext");r("tickformat");r("range");r("multiselect");var o=r("constraintrange");if(o){e.constraintrange=u.cleanRanges(o,e)}}}e.exports=function t(e,r,a,i){function u(t,a){return n.coerce(e,r,l,t,a)}var d=e.dimensions;if(Array.isArray(d)&&d.length>c){n.log("parcoords traces support up to "+c+" dimensions at the moment");d.splice(c)}var v=s(e,r,{name:"dimensions",handleItemDefaults:p});var g=h(e,r,a,i,u);o(r,i,u);if(!Array.isArray(v)||!v.length){r.visible=false}f(r,v,"values",g);var m={family:i.font.family,size:Math.round(i.font.size/1.2),color:i.font.color};n.coerceFont(u,"labelfont",m);n.coerceFont(u,"tickfont",m);n.coerceFont(u,"rangefont",m)}},{"../../components/colorscale/defaults":568,"../../components/colorscale/has_colorscale":572,"../../lib":684,"../../plots/array_container_defaults":728,"../../plots/domain":757,"./attributes":979,"./axisbrush":980,"./constants":983,"./merge_length":987}],985:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.calc=t("./calc");n.plot=t("./plot");n.colorbar={container:"line",min:"cmin",max:"cmax"};n.moduleType="trace";n.name="parcoords";n.basePlotModule=t("./base_plot");n.categories=["gl","regl","noOpacity"];n.meta={};e.exports=n},{"./attributes":979,"./base_plot":981,"./calc":982,"./defaults":984,"./plot":989}],986:[function(t,e,r){"use strict";var n=t("glslify");var a=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 p0, p1, p2, p3,\n               p4, p5, p6, p7,\n               p8, p9, pa, pb,\n               pc, pd, pe;\n\nattribute vec4 pf;\n\nuniform mat4 dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution,\n             viewBoxPosition,\n             viewBoxSize;\n\nuniform sampler2D palette;\nuniform sampler2D mask;\nuniform float maskHeight;\n\nuniform vec2 colorClamp;\n\nvarying vec4 fragColor;\n\nvec4 unit_1 = vec4(1, 1, 1, 1);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * unit_1, unit_1);\n}\n\nfloat axisY(\n        float x,\n        mat4 d[4],\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D\n    ) {\n\n    float y1 = val(d[0], dim1A) + val(d[1], dim1B) + val(d[2], dim1C) + val(d[3], dim1D);\n    float y2 = val(d[0], dim2A) + val(d[1], dim2B) + val(d[2], dim2C) + val(d[3], dim2D);\n    return y1 * (1.0 - x) + y2 * x;\n}\n\nconst int bitsPerByte = 8;\n\nint mod2(int a) {\n    return a - 2 * (a / 2);\n}\n\nint mod8(int a) {\n    return a - 8 * (a / 8);\n}\n\nvec4 zero = vec4(0, 0, 0, 0);\nvec4 unit_0 = vec4(1, 1, 1, 1);\nvec2 xyProjection = vec2(1, 1);\n\nmat4 mclamp(mat4 m, mat4 lo, mat4 hi) {\n    return mat4(clamp(m[0], lo[0], hi[0]),\n                clamp(m[1], lo[1], hi[1]),\n                clamp(m[2], lo[2], hi[2]),\n                clamp(m[3], lo[3], hi[3]));\n}\n\nbool mshow(mat4 p, mat4 lo, mat4 hi) {\n    return mclamp(p, lo, hi) == p;\n}\n\nbool withinBoundingBox(\n        mat4 d[4],\n        mat4 loA, mat4 hiA, mat4 loB, mat4 hiB, mat4 loC, mat4 hiC, mat4 loD, mat4 hiD\n    ) {\n\n    return mshow(d[0], loA, hiA) &&\n           mshow(d[1], loB, hiB) &&\n           mshow(d[2], loC, hiC) &&\n           mshow(d[3], loD, hiD);\n}\n\nbool withinRasterMask(mat4 d[4], sampler2D mask, float height) {\n    bool result = true;\n    int bitInByteStepper;\n    float valY, valueY, scaleX;\n    int hit, bitmask, valX;\n    for(int i = 0; i < 4; i++) {\n        for(int j = 0; j < 4; j++) {\n            for(int k = 0; k < 4; k++) {\n                bitInByteStepper = mod8(j * 4 + k);\n                valX = i * 2 + j / 2;\n                valY = d[i][j][k];\n                valueY = valY * (height - 1.0) + 0.5;\n                scaleX = (float(valX) + 0.5) / 8.0;\n                hit = int(texture2D(mask, vec2(scaleX, (valueY + 0.5) / height))[3] * 255.0) / int(pow(2.0, float(bitInByteStepper)));\n                result = result && mod2(hit) == 1;\n            }\n        }\n    }\n    return result;\n}\n\nvec4 position(\n        float depth,\n        vec2 resolution, vec2 viewBoxPosition, vec2 viewBoxSize,\n        mat4 dims[4],\n        float signum,\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D,\n        mat4 loA, mat4 hiA, mat4 loB, mat4 hiB, mat4 loC, mat4 hiC, mat4 loD, mat4 hiD,\n        sampler2D mask, float maskHeight\n    ) {\n\n    float x = 0.5 * signum + 0.5;\n    float y = axisY(x, dims, dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D);\n\n    float show = float(\n                            withinBoundingBox(dims, loA, hiA, loB, hiB, loC, hiC, loD, hiD)\n                         && withinRasterMask(dims, mask, maskHeight)\n                      );\n\n    vec2 viewBoxXY = viewBoxPosition + viewBoxSize * vec2(x, y);\n    float depthOrHide = depth + 2.0 * (1.0 - show);\n\n    return vec4(\n        xyProjection * (2.0 * viewBoxXY / resolution - 1.0),\n        depthOrHide,\n        1.0\n    );\n}\n\nvoid main() {\n\n    float prominence = abs(pf[3]);\n\n    mat4 p[4];\n    p[0] = mat4(p0, p1, p2, p3);\n    p[1] = mat4(p4, p5, p6, p7);\n    p[2] = mat4(p8, p9, pa, pb);\n    p[3] = mat4(pc, pd, pe, abs(pf));\n\n    gl_Position = position(\n        1.0 - prominence,\n        resolution, viewBoxPosition, viewBoxSize,\n        p,\n        sign(pf[3]),\n        dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D,\n        loA, hiA, loB, hiB, loC, hiC, loD, hiD,\n        mask, maskHeight\n    );\n\n    float clampedColorIndex = clamp((prominence - colorClamp[0]) / (colorClamp[1] - colorClamp[0]), 0.0, 1.0);\n    fragColor = texture2D(palette, vec2((clampedColorIndex * 255.0 + 0.5) / 256.0, 0.5));\n}\n"]);var i=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 p0, p1, p2, p3,\n               p4, p5, p6, p7,\n               p8, p9, pa, pb,\n               pc, pd, pe;\n\nattribute vec4 pf;\n\nuniform mat4 dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D;\n\nuniform vec2 resolution,\n             viewBoxPosition,\n             viewBoxSize;\n\nuniform sampler2D palette;\n\nuniform vec2 colorClamp;\n\nvarying vec4 fragColor;\n\nvec2 xyProjection = vec2(1, 1);\n\nvec4 unit = vec4(1, 1, 1, 1);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * unit, unit);\n}\n\nfloat axisY(\n        float x,\n        mat4 d[4],\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D\n    ) {\n\n    float y1 = val(d[0], dim1A) + val(d[1], dim1B) + val(d[2], dim1C) + val(d[3], dim1D);\n    float y2 = val(d[0], dim2A) + val(d[1], dim2B) + val(d[2], dim2C) + val(d[3], dim2D);\n    return y1 * (1.0 - x) + y2 * x;\n}\n\nvec4 position(\n        float depth,\n        vec2 resolution, vec2 viewBoxPosition, vec2 viewBoxSize,\n        mat4 dims[4],\n        float signum,\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D\n    ) {\n\n    float x = 0.5 * signum + 0.5;\n    float y = axisY(x, dims, dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D);\n\n    vec2 viewBoxXY = viewBoxPosition + viewBoxSize * vec2(x, y);\n\n    return vec4(\n        xyProjection * (2.0 * viewBoxXY / resolution - 1.0),\n        depth,\n        1.0\n    );\n}\n\nvoid main() {\n\n    float prominence = abs(pf[3]);\n\n    mat4 p[4];\n    p[0] = mat4(p0, p1, p2, p3);\n    p[1] = mat4(p4, p5, p6, p7);\n    p[2] = mat4(p8, p9, pa, pb);\n    p[3] = mat4(pc, pd, pe, abs(pf));\n\n    gl_Position = position(\n        1.0 - prominence,\n        resolution, viewBoxPosition, viewBoxSize,\n        p,\n        sign(pf[3]),\n        dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D\n    );\n\n    float clampedColorIndex = clamp((prominence - colorClamp[0]) / (colorClamp[1] - colorClamp[0]), 0.0, 1.0);\n    fragColor = texture2D(palette, vec2((clampedColorIndex * 255.0 + 0.5) / 256.0, 0.5));\n}\n"]);var o=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 p0, p1, p2, p3,\n               p4, p5, p6, p7,\n               p8, p9, pa, pb,\n               pc, pd, pe;\n\nattribute vec4 pf;\n\nuniform mat4 dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution,\n             viewBoxPosition,\n             viewBoxSize;\n\nuniform sampler2D mask;\nuniform float maskHeight;\n\nuniform vec2 colorClamp;\n\nvarying vec4 fragColor;\n\nvec4 unit_1 = vec4(1, 1, 1, 1);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * unit_1, unit_1);\n}\n\nfloat axisY(\n        float x,\n        mat4 d[4],\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D\n    ) {\n\n    float y1 = val(d[0], dim1A) + val(d[1], dim1B) + val(d[2], dim1C) + val(d[3], dim1D);\n    float y2 = val(d[0], dim2A) + val(d[1], dim2B) + val(d[2], dim2C) + val(d[3], dim2D);\n    return y1 * (1.0 - x) + y2 * x;\n}\n\nconst int bitsPerByte = 8;\n\nint mod2(int a) {\n    return a - 2 * (a / 2);\n}\n\nint mod8(int a) {\n    return a - 8 * (a / 8);\n}\n\nvec4 zero = vec4(0, 0, 0, 0);\nvec4 unit_0 = vec4(1, 1, 1, 1);\nvec2 xyProjection = vec2(1, 1);\n\nmat4 mclamp(mat4 m, mat4 lo, mat4 hi) {\n    return mat4(clamp(m[0], lo[0], hi[0]),\n                clamp(m[1], lo[1], hi[1]),\n                clamp(m[2], lo[2], hi[2]),\n                clamp(m[3], lo[3], hi[3]));\n}\n\nbool mshow(mat4 p, mat4 lo, mat4 hi) {\n    return mclamp(p, lo, hi) == p;\n}\n\nbool withinBoundingBox(\n        mat4 d[4],\n        mat4 loA, mat4 hiA, mat4 loB, mat4 hiB, mat4 loC, mat4 hiC, mat4 loD, mat4 hiD\n    ) {\n\n    return mshow(d[0], loA, hiA) &&\n           mshow(d[1], loB, hiB) &&\n           mshow(d[2], loC, hiC) &&\n           mshow(d[3], loD, hiD);\n}\n\nbool withinRasterMask(mat4 d[4], sampler2D mask, float height) {\n    bool result = true;\n    int bitInByteStepper;\n    float valY, valueY, scaleX;\n    int hit, bitmask, valX;\n    for(int i = 0; i < 4; i++) {\n        for(int j = 0; j < 4; j++) {\n            for(int k = 0; k < 4; k++) {\n                bitInByteStepper = mod8(j * 4 + k);\n                valX = i * 2 + j / 2;\n                valY = d[i][j][k];\n                valueY = valY * (height - 1.0) + 0.5;\n                scaleX = (float(valX) + 0.5) / 8.0;\n                hit = int(texture2D(mask, vec2(scaleX, (valueY + 0.5) / height))[3] * 255.0) / int(pow(2.0, float(bitInByteStepper)));\n                result = result && mod2(hit) == 1;\n            }\n        }\n    }\n    return result;\n}\n\nvec4 position(\n        float depth,\n        vec2 resolution, vec2 viewBoxPosition, vec2 viewBoxSize,\n        mat4 dims[4],\n        float signum,\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D,\n        mat4 loA, mat4 hiA, mat4 loB, mat4 hiB, mat4 loC, mat4 hiC, mat4 loD, mat4 hiD,\n        sampler2D mask, float maskHeight\n    ) {\n\n    float x = 0.5 * signum + 0.5;\n    float y = axisY(x, dims, dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D);\n\n    float show = float(\n                            withinBoundingBox(dims, loA, hiA, loB, hiB, loC, hiC, loD, hiD)\n                         && withinRasterMask(dims, mask, maskHeight)\n                      );\n\n    vec2 viewBoxXY = viewBoxPosition + viewBoxSize * vec2(x, y);\n    float depthOrHide = depth + 2.0 * (1.0 - show);\n\n    return vec4(\n        xyProjection * (2.0 * viewBoxXY / resolution - 1.0),\n        depthOrHide,\n        1.0\n    );\n}\n\nvoid main() {\n\n    float prominence = abs(pf[3]);\n\n    mat4 p[4];\n    p[0] = mat4(p0, p1, p2, p3);\n    p[1] = mat4(p4, p5, p6, p7);\n    p[2] = mat4(p8, p9, pa, pb);\n    p[3] = mat4(pc, pd, pe, abs(pf));\n\n    gl_Position = position(\n        1.0 - prominence,\n        resolution, viewBoxPosition, viewBoxSize,\n        p,\n        sign(pf[3]),\n        dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D,\n        loA, hiA, loB, hiB, loC, hiC, loD, hiD,\n        mask, maskHeight\n    );\n\n    fragColor = vec4(pf.rgb, 1.0);\n}\n"]);var s=n(["precision lowp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]);var l=t("../../lib");var u=1e-6;var c=1e-7;var f=2048;var h=64;var p=2;var d=4;var v=8;var g=h/v;var m=[119,119,119];var y=new Uint8Array(4);var x=new Uint8Array(4);var b={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function _(t){t.read({x:0,y:0,width:1,height:1,data:y})}function w(t,e,r,n,a){var i=t._gl;i.enable(i.SCISSOR_TEST);i.scissor(e,r,n,a);t.clear({color:[0,0,0,0],depth:1})}function k(t,e,r,n,a,i){var o=i.key;function s(l){var u;u=Math.min(n,a-l*n);i.offset=p*l*n;i.count=p*u;if(l===0){window.cancelAnimationFrame(r.currentRafs[o]);delete r.currentRafs[o];w(t,i.scissorX,i.scissorY,i.scissorWidth,i.viewBoxSize[1])}if(r.clearOnly){return}e(i);if(l*n+u<a){r.currentRafs[o]=window.requestAnimationFrame(function(){s(l+1)})}r.drawCompleted=false}if(!r.drawCompleted){_(t);r.drawCompleted=true}s(0)}function M(t){return Math.max(u,Math.min(1-u,t))}function A(t,e,r){var n=[];for(var a=0;a<256;a++){var i=t(a/255);n.push((e?m:i).concat(r))}return n}function T(t,e){return(t>>>8*e)%256/255}function S(t,e,r){var n=e.length;var a=[];for(var i=0;i<t;i++){for(var o=0;o<h;o++){a.push(o<n?e[o].paddedUnitValues[i]:o===h-1?M(r[i]):o>=h-4?T(i,h-2-o):.5)}}return a}function E(t,e,r){var n,a,i;var o=[];for(a=0;a<t;a++){for(i=0;i<p;i++){for(n=0;n<d;n++){o.push(e[a*h+r*d+n]);if(r*d+n===h-1&&i%2===0){o[o.length-1]*=-1}}}}return o}function C(t,e,r){for(var n=0;n<16;n++){t["p"+n.toString(16)](E(e,r,n))}}function L(t){var e={};for(var r=0;r<16;r++){e["p"+r.toString(16)]=t.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)})}return e}e.exports=function(t,e){var r=e.context;var n=e.pick;var u=e.regl;var h={currentRafs:{},drawCompleted:true,clearOnly:false};var p;var d;var m;var y;var _=L(u);var M;var T=u.texture(b);I(e);var E=u({profile:false,blend:{enable:r,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!r,mask:true,func:"less",range:[0,1]},cull:{enable:true,face:"back"},scissor:{enable:true,box:{x:u.prop("scissorX"),y:u.prop("scissorY"),width:u.prop("scissorWidth"),height:u.prop("scissorHeight")}},viewport:{x:u.prop("viewportX"),y:u.prop("viewportY"),width:u.prop("viewportWidth"),height:u.prop("viewportHeight")},dither:false,vert:n?o:r?i:a,frag:s,primitive:"lines",lineWidth:1,attributes:_,uniforms:{resolution:u.prop("resolution"),viewBoxPosition:u.prop("viewBoxPosition"),viewBoxSize:u.prop("viewBoxSize"),dim1A:u.prop("dim1A"),dim2A:u.prop("dim2A"),dim1B:u.prop("dim1B"),dim2B:u.prop("dim2B"),dim1C:u.prop("dim1C"),dim2C:u.prop("dim2C"),dim1D:u.prop("dim1D"),dim2D:u.prop("dim2D"),loA:u.prop("loA"),hiA:u.prop("hiA"),loB:u.prop("loB"),hiB:u.prop("hiB"),loC:u.prop("loC"),hiC:u.prop("hiC"),loD:u.prop("loD"),hiD:u.prop("hiD"),palette:T,mask:u.prop("maskTexture"),maskHeight:u.prop("maskHeight"),colorClamp:u.prop("colorClamp")},offset:u.prop("offset"),count:u.prop("count")});function I(t){p=t.model;d=t.viewModel;m=d.dimensions.slice();y=m[0]?m[0].values.length:0;var e=p.lines;var a=n?e.color.map(function(t,r){return r/e.color.length}):e.color;var i=Math.max(1/255,Math.pow(1/a.length,1/3));var o=S(y,m,a);C(_,y,o);T=u.texture(l.extendFlat({data:A(p.unitToColor,r,Math.round((r?i:1)*255))},b))}var z=[0,1];function P(t){z[0]=t[0];z[1]=t[1]}var O=[];function D(t,e,r,n,a,i,o,s,u,c,f){var h,d,v,g;var m=[t,e];var y=[0,1].map(function(){return[0,1,2,3].map(function(){return new Float32Array(16)})});for(h=0;h<2;h++){g=m[h];for(d=0;d<4;d++){for(v=0;v<16;v++){y[h][d][v]=v+16*d===g?1:0}}}var x=p.lines.canvasOverdrag;var b=p.domain;var _=p.canvasWidth;var w=p.canvasHeight;var k=l.extendFlat({key:o,resolution:[_,w],viewBoxPosition:[r+x,n],viewBoxSize:[a,i],i:t,ii:e,dim1A:y[0][0],dim1B:y[0][1],dim1C:y[0][2],dim1D:y[0][3],dim2A:y[1][0],dim2B:y[1][1],dim2C:y[1][2],dim2D:y[1][3],colorClamp:z,scissorX:(s===u?0:r+x)+(p.pad.l-x)+p.layoutWidth*b.x[0],scissorWidth:(s===c?_-r+x:a+.5)+(s===u?r+x:0),scissorY:n+p.pad.b+p.layoutHeight*b.y[0],scissorHeight:i,viewportX:p.pad.l-x+p.layoutWidth*b.x[0],viewportY:p.pad.b+p.layoutHeight*b.y[0],viewportWidth:_,viewportHeight:w},f);return k}function R(){var t,e,r;var n=[0,1].map(function(){return[0,1,2,3].map(function(){return new Float32Array(16)})});for(t=0;t<2;t++){for(e=0;e<4;e++){for(r=0;r<16;r++){var a=r+16*e;var i;if(a<m.length){i=m[a].brush.filter.getBounds()[t]}else i=t;n[t][e][r]=i+(2*t-1)*c}}}function o(t,e){var r=f-1;return[Math.max(0,Math.floor(e[0]*r)),Math.min(r,Math.ceil(e[1]*r))]}var s=Array.apply(null,new Array(f*g)).map(function(){return 255});for(var l=0;l<m.length;l++){var h=l%v;var p=(l-h)/v;var d=Math.pow(2,h);var y=m[l];var x=y.brush.filter.get();if(x.length<2)continue;var b=o(y,x[0])[1];for(var _=1;_<x.length;_++){var w=o(y,x[_]);for(var k=b+1;k<w[0];k++){s[k*g+p]&=~d}b=Math.max(b,w[1])}}var A={shape:[g,f],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:s};if(M)M(A);else M=u.texture(A);return{maskTexture:M,maskHeight:f,loA:n[0][0],loB:n[0][1],loC:n[0][2],loD:n[0][3],hiA:n[1][0],hiB:n[1][1],hiC:n[1][2],hiD:n[1][3]}}function B(t,e,n){var a=t.length;var i;var o,s,l=Infinity,c=-Infinity;for(i=0;i<a;i++){if(t[i].dim2.canvasX>c){c=t[i].dim2.canvasX;s=i}if(t[i].dim1.canvasX<l){l=t[i].dim1.canvasX;o=i}}if(a===0){w(u,0,0,p.canvasWidth,p.canvasHeight)}var f=r?{}:R();for(i=0;i<a;i++){var d=t[i];var v=d.dim1;var g=v.crossfilterDimensionIndex;var m=d.canvasX;var x=d.canvasY;var b=d.dim2;var _=b.crossfilterDimensionIndex;var M=d.panelSizeX;var A=d.panelSizeY;var T=m+M;if(e||!O[g]||O[g][0]!==m||O[g][1]!==T){O[g]=[m,T];var S=D(g,_,m,x,M,A,v.crossfilterDimensionIndex,i,o,s,f);h.clearOnly=n;k(u,E,h,e?p.lines.blockLineCount:y,y,S)}}}function F(t,e){u.read({x:t,y:e,width:1,height:1,data:x});return x}function N(t,e,r,n){var a=new Uint8Array(4*r*n);u.read({x:t,y:e,width:r,height:n,data:a});return a}function j(){t.style["pointer-events"]="none";T.destroy();if(M)M.destroy();for(var e in _)_[e].destroy()}return{setColorDomain:P,render:B,readPixel:F,readPixels:N,destroy:j,update:I}}},{"../../lib":684,glslify:377}],987:[function(t,e,r){"use strict";e.exports=function(t,e,r,n){if(!n)n=Infinity;var a,i;for(a=0;a<e.length;a++){i=e[a];if(i.visible)n=Math.min(n,i[r].length)}if(n===Infinity)n=0;t._length=n;for(a=0;a<e.length;a++){i=e[a];if(i.visible)i._length=n}return n}},{}],988:[function(t,e,r){"use strict";var n=t("./lines");var a=t("./constants");var i=t("../../lib");var o=t("d3");var s=t("../../components/drawing");var l=t("../../lib/gup");var u=l.keyFun;var c=l.repeat;var f=l.unwrap;var h=t("./axisbrush");function p(t){return!("visible"in t)||t.visible}function d(t){var e=t.range?t.range[0]:i.aggNums(Math.min,null,t.values,t._length);var r=t.range?t.range[1]:i.aggNums(Math.max,null,t.values,t._length);if(isNaN(e)||!isFinite(e)){e=0}if(isNaN(r)||!isFinite(r)){r=0}if(e===r){if(e===0){e-=1;r+=1}else{e*=.9;r*=1.1}}return[e,r]}function v(t,e){if(e){return function(r,n){var a=e[n];if(a===null||a===undefined)return t(r);return a}}return t}function g(t,e,r,n,a){var i=d(r);if(n){return o.scale.ordinal().domain(n.map(v(o.format(r.tickformat),a))).range(n.map(function(r){var n=(r-i[0])/(i[1]-i[0]);return t-e+n*(2*e-t)}))}return o.scale.linear().domain(i).range([t-e,e])}function m(t,e){return o.scale.linear().range([e,t-e])}function y(t,e){return o.scale.linear().domain(d(t)).range([e,1-e])}function x(t){if(!t.tickvals)return;var e=d(t);return o.scale.ordinal().domain(t.tickvals).range(t.tickvals.map(function(t){return(t-e[0])/(e[1]-e[0])}))}function b(t){var e=t.map(function(t){return t[0]});var r=t.map(function(t){return o.rgb(t[1])});var n=function(t){return function(e){return e[t]}};var a="rgb".split("").map(function(t){return o.scale.linear().clamp(true).domain(e).range(r.map(n(t)))});return function(t){return a.map(function(e){return e(t)})}}function _(t){return t.dimensions.some(function(t){return t.brush.filterSpecified})}function w(t,e,r){var n=f(e),s=n.trace,l=n.lineColor,u=n.cscale,c=s.line,h=s.domain,v=s.dimensions,g=t.width,m=s.labelfont,y=s.tickfont,x=s.rangefont;var _=i.extendDeepNoArrays({},c,{color:l.map(o.scale.linear().domain(d({values:l,range:[c.cmin,c.cmax],_length:s._length}))),blockLineCount:a.blockLineCount,canvasOverdrag:a.overdrag*a.canvasPixelRatio});var w=Math.floor(g*(h.x[1]-h.x[0]));var k=Math.floor(t.height*(h.y[1]-h.y[0]));var M=t.margin||{l:80,r:80,t:100,b:80};var A=w;var T=k;return{key:r,colCount:v.filter(p).length,dimensions:v,tickDistance:a.tickDistance,unitToColor:b(u),lines:_,labelFont:m,tickFont:y,rangeFont:x,layoutWidth:g,layoutHeight:t.height,domain:h,translateX:h.x[0]*g,translateY:t.height-h.y[1]*t.height,pad:M,canvasWidth:A*a.canvasPixelRatio+2*_.canvasOverdrag,canvasHeight:T*a.canvasPixelRatio,width:A,height:T,canvasPixelRatio:a.canvasPixelRatio}}function k(t,e,r){var n=r.width;var s=r.height;var l=r.dimensions;var u=r.canvasPixelRatio;var c=function(t){return n*t/Math.max(1,r.colCount-1)};var f=a.verticalPadding/s;var d=m(s,a.verticalPadding);var v={key:r.key,xScale:c,model:r,inBrushDrag:false};var b={};v.dimensions=l.filter(p).map(function(n,l){var p=y(n,f);var m=b[n.label];b[n.label]=(m||0)+1;var w=n.label+(m?"__"+m:"");var k=n.constraintrange;var M=k&&k.length;if(M&&!Array.isArray(k[0])){k=[k]}var A=M?k.map(function(t){return t.map(p)}):[[0,1]];var T=function(){var e=v;e.focusLayer&&e.focusLayer.render(e.panels,true);var r=_(e);if(!t.contextShown()&&r){e.contextLayer&&e.contextLayer.render(e.panels,true);t.contextShown(true)}else if(t.contextShown()&&!r){e.contextLayer&&e.contextLayer.render(e.panels,true,true);t.contextShown(false)}};var S=n.values;if(S.length>n._length){S=S.slice(0,n._length)}var E=n.tickvals;var C;function L(t,e){return{val:t,text:C[e]}}function I(t,e){return t.val-e.val}if(Array.isArray(E)&&E.length){C=n.ticktext;if(!Array.isArray(C)||!C.length){C=E.map(o.format(n.tickformat))}else if(C.length>E.length){C=C.slice(0,E.length)}else if(E.length>C.length){E=E.slice(0,C.length)}for(var z=1;z<E.length;z++){if(E[z]<E[z-1]){var P=E.map(L).sort(I);for(var O=0;O<E.length;O++){E[O]=P[O].val;C[O]=P[O].text}break}}}else E=undefined;return{key:w,label:n.label,tickFormat:n.tickformat,tickvals:E,ticktext:C,ordinal:!!E,multiselect:n.multiselect,xIndex:l,crossfilterDimensionIndex:l,visibleIndex:n._index,height:s,values:S,paddedUnitValues:S.map(p),unitTickvals:E&&E.map(p),xScale:c,x:c(l),canvasX:c(l)*u,unitToPaddedPx:d,domainScale:g(s,a.verticalPadding,n,E,C),ordinalScale:x(n),parent:v,model:r,brush:h.makeBrush(t,M,A,function(){t.linePickActive(false)},T,function(r){var a=v;a.focusLayer.render(a.panels,true);a.pickLayer&&a.pickLayer.render(a.panels,true);t.linePickActive(true);if(e&&e.filterChanged){var o=p.invert;var s=r.map(function(t){return t.map(o).sort(i.sorterAsc)}).sort(function(t,e){return t[0]-e[0]});e.filterChanged(a.key,n._index,s)}})}});return v}function M(t){t.classed(a.cn.axisExtentText,true).attr("text-anchor","middle").style("cursor","default").style("user-select","none")}function A(){var t=true;var e=false;return{linePickActive:function(e){return arguments.length?t=!!e:t},contextShown:function(t){return arguments.length?e=!!t:e}}}e.exports=function(t,e,r,l,p,d){var v=A();var g=l.filter(function(t){return f(t).trace.visible}).map(w.bind(0,p)).map(k.bind(0,v,d));r.each(function(t,e){return i.extendFlat(t,g[e])});var m=r.selectAll(".gl-canvas").each(function(t){t.viewModel=g[0];t.model=t.viewModel?t.viewModel.model:null});var y=null;var x=m.filter(function(t){return t.pick});x.style("pointer-events","auto").on("mousemove",function(t){if(v.linePickActive()&&t.lineLayer&&d&&d.hover){var e=o.event;var r=this.width;var n=this.height;var a=o.mouse(this);var i=a[0];var s=a[1];if(i<0||s<0||i>=r||s>=n){return}var l=t.lineLayer.readPixel(i,n-1-s);var u=l[3]!==0;var c=u?l[2]+256*(l[1]+256*l[0]):null;var f={x:i,y:s,clientX:e.clientX,clientY:e.clientY,dataIndex:t.model.key,curveNumber:c};if(c!==y){if(u){d.hover(f)}else if(d.unhover){d.unhover(f)}y=c}}});m.style("opacity",function(t){return t.pick?.01:1});e.style("background","rgba(255, 255, 255, 0)");var b=e.selectAll("."+a.cn.parcoords).data(g,u);b.exit().remove();b.enter().append("g").classed(a.cn.parcoords,true).style("shape-rendering","crispEdges").style("pointer-events","none");b.attr("transform",function(t){return"translate("+t.model.translateX+","+t.model.translateY+")"});var T=b.selectAll("."+a.cn.parcoordsControlView).data(c,u);T.enter().append("g").classed(a.cn.parcoordsControlView,true);T.attr("transform",function(t){return"translate("+t.model.pad.l+","+t.model.pad.t+")"});var S=T.selectAll("."+a.cn.yAxis).data(function(t){return t.dimensions},u);function E(t,e){var r=e.panels||(e.panels=[]);var n=t.data();var a=n.length-1;for(var i=0;i<a;i++){var o=r[i]||(r[i]={});var s=n[i];var l=n[i+1];o.dim1=s;o.dim2=l;o.canvasX=s.canvasX;o.panelSizeX=l.canvasX-s.canvasX;o.panelSizeY=e.model.canvasHeight;o.y=0;o.canvasY=0}}S.enter().append("g").classed(a.cn.yAxis,true);T.each(function(t){E(S,t)});m.each(function(t){if(t.viewModel){if(t.lineLayer)t.lineLayer.update(t);else t.lineLayer=n(this,t);t.viewModel[t.key]=t.lineLayer;t.lineLayer.render(t.viewModel.panels,!t.context)}});S.attr("transform",function(t){return"translate("+t.xScale(t.xIndex)+", 0)"});S.call(o.behavior.drag().origin(function(t){return t}).on("drag",function(t){var e=t.parent;v.linePickActive(false);t.x=Math.max(-a.overdrag,Math.min(t.model.width+a.overdrag,o.event.x));t.canvasX=t.x*t.model.canvasPixelRatio;S.sort(function(t,e){return t.x-e.x}).each(function(e,r){e.xIndex=r;e.x=t===e?e.x:e.xScale(e.xIndex);e.canvasX=e.x*e.model.canvasPixelRatio});E(S,e);S.filter(function(e){return Math.abs(t.xIndex-e.xIndex)!==0}).attr("transform",function(t){return"translate("+t.xScale(t.xIndex)+", 0)"});o.select(this).attr("transform","translate("+t.x+", 0)");S.each(function(r,n,a){if(a===t.parent.key)e.dimensions[n]=r});e.contextLayer&&e.contextLayer.render(e.panels,false,!_(e));e.focusLayer.render&&e.focusLayer.render(e.panels)}).on("dragend",function(t){var e=t.parent;t.x=t.xScale(t.xIndex);t.canvasX=t.x*t.model.canvasPixelRatio;E(S,e);o.select(this).attr("transform",function(t){return"translate("+t.x+", 0)"});e.contextLayer&&e.contextLayer.render(e.panels,false,!_(e));e.focusLayer&&e.focusLayer.render(e.panels);e.pickLayer&&e.pickLayer.render(e.panels,true);v.linePickActive(true);if(d&&d.axesMoved){d.axesMoved(e.key,e.dimensions.map(function(t){return t.crossfilterDimensionIndex}))}}));S.exit().remove();var C=S.selectAll("."+a.cn.axisOverlays).data(c,u);C.enter().append("g").classed(a.cn.axisOverlays,true);C.selectAll("."+a.cn.axis).remove();var L=C.selectAll("."+a.cn.axis).data(c,u);L.enter().append("g").classed(a.cn.axis,true);L.each(function(t){var e=t.model.height/t.model.tickDistance;var r=t.domainScale;var n=r.domain();o.select(this).call(o.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(e,t.tickFormat).tickValues(t.ordinal?n:null).tickFormat(t.ordinal?function(t){return t}:null).scale(r));s.font(L.selectAll("text"),t.model.tickFont)});L.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px");L.selectAll("text").style("text-shadow","1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff").style("cursor","default").style("user-select","none");var I=C.selectAll("."+a.cn.axisHeading).data(c,u);I.enter().append("g").classed(a.cn.axisHeading,true);var z=I.selectAll("."+a.cn.axisTitle).data(c,u);z.enter().append("text").classed(a.cn.axisTitle,true).attr("text-anchor","middle").style("cursor","ew-resize").style("user-select","none").style("pointer-events","auto");z.attr("transform","translate(0,"+-a.axisTitleOffset+")").text(function(t){return t.label}).each(function(t){s.font(o.select(this),t.model.labelFont)});var P=C.selectAll("."+a.cn.axisExtent).data(c,u);P.enter().append("g").classed(a.cn.axisExtent,true);var O=P.selectAll("."+a.cn.axisExtentTop).data(c,u);O.enter().append("g").classed(a.cn.axisExtentTop,true);O.attr("transform","translate("+0+","+-a.axisExtentOffset+")");var D=O.selectAll("."+a.cn.axisExtentTopText).data(c,u);function R(t,e){if(t.ordinal)return"";var r=t.domainScale.domain();return o.format(t.tickFormat)(r[e?r.length-1:0])}D.enter().append("text").classed(a.cn.axisExtentTopText,true).call(M);D.text(function(t){return R(t,true)}).each(function(t){s.font(o.select(this),t.model.rangeFont)});var B=P.selectAll("."+a.cn.axisExtentBottom).data(c,u);B.enter().append("g").classed(a.cn.axisExtentBottom,true);B.attr("transform",function(t){return"translate("+0+","+(t.model.height+a.axisExtentOffset)+")"});var F=B.selectAll("."+a.cn.axisExtentBottomText).data(c,u);F.enter().append("text").classed(a.cn.axisExtentBottomText,true).attr("dy","0.75em").call(M);F.text(function(t){return R(t)}).each(function(t){s.font(o.select(this),t.model.rangeFont)});h.ensureAxisBrush(C)}},{"../../components/drawing":583,"../../lib":684,"../../lib/gup":681,"./axisbrush":980,"./constants":983,"./lines":986,d3:147}],989:[function(t,e,r){"use strict";var n=t("./parcoords");var a=t("../../lib/prepare_regl");e.exports=function t(e,r){var i=e._fullLayout;var o=i._toppaper;var s=i._paperdiv;var l=i._glcontainer;var u=a(e);if(!u)return;var c={};var f={};var h=i._size;r.forEach(function(t,r){c[r]=e.data[r].dimensions;f[r]=e.data[r].dimensions.slice()});var p=function(t,r,n){var a=f[t][r];var i=n.map(function(t){return t.slice()});if(!i.length){delete a.constraintrange;i=null}else{if(i.length===1)i=i[0];a.constraintrange=i;i=[i]}var o={};var s="dimensions["+r+"].constraintrange";o[s]=i;e.emit("plotly_restyle",[o,[t]])};var d=function(t){e.emit("plotly_hover",t)};var v=function(t){e.emit("plotly_unhover",t)};var g=function(t,r){function n(t){return!("visible"in t)||t.visible}function a(t,e,r){var n=e.indexOf(r);var a=t.indexOf(n);if(a===-1){a+=e.length}return a}function i(t){return function e(n,i){var o=a(r,t,n);var s=a(r,t,i);return o-s}}var o=i(f[t].filter(n));c[t].sort(o);f[t].filter(function(t){return!n(t)}).sort(function(e){return f[t].indexOf(e)}).forEach(function(e){c[t].splice(c[t].indexOf(e),1);c[t].splice(f[t].indexOf(e),0,e)});e.emit("plotly_restyle")};n(s,o,l,r,{width:h.w,height:h.h,margin:{t:h.t,r:h.r,b:h.b,l:h.l}},{filterChanged:p,hover:d,unhover:v,axesMoved:g})}},{"../../lib/prepare_regl":697,"./parcoords":988}],990:[function(t,e,r){"use strict";var n=t("../../components/color/attributes");var a=t("../../plots/font_attributes");var i=t("../../plots/attributes");var o=t("../../plots/domain").attributes;var s=t("../../lib/extend").extendFlat;var l=a({editType:"calc",colorEditType:"style"});e.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:n.defaultLine,arrayOk:true,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:true,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:s({},i.hoverinfo,{flags:["label","text","value","percent","name"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:true,editType:"calc"},textfont:s({},l,{}),insidetextfont:s({},l,{}),outsidetextfont:s({},l,{}),domain:o({name:"pie",trace:true,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:true,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:true,editType:"calc"}}},{"../../components/color/attributes":557,"../../lib/extend":673,"../../plots/attributes":729,"../../plots/domain":757,"../../plots/font_attributes":758}],991:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../plots/get_data").getModuleCalcData;r.name="pie";r.plot=function(t){var e=n.getModule("pie");var r=a(t.calcdata,e)[0];if(r.length)e.plot(t,r)};r.clean=function(t,e,r,n){var a=n._has&&n._has("pie");var i=e._has&&e._has("pie");if(a&&!i){n._pielayer.selectAll("g.trace").remove()}}},{"../../plots/get_data":768,"../../registry":817}],992:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib").isArrayOrTypedArray;var i=t("tinycolor2");var o=t("../../components/color");var s=t("./helpers");e.exports=function t(e,r){var l=r.values;var f=a(l)&&l.length;var h=r.labels;var p=r.marker.colors||[];var d=[];var v=e._fullLayout;var g=v.colorway;var m=v._piecolormap;var y={};var x=0;var b=v.hiddenlabels||[];var _,w,k,M,A;if(!v._piecolorway&&g!==o.defaults){v._piecolorway=c(g)}if(r.dlabel){h=new Array(l.length);for(_=0;_<l.length;_++){h[_]=String(r.label0+_*r.dlabel)}}function T(t,e){if(!t)return false;t=i(t);if(!t.isValid())return false;t=o.addOpacity(t,t.getAlpha());if(!m[e])m[e]=t;return t}var S=(f?l:h).length;for(_=0;_<S;_++){if(f){w=l[_];if(!n(w))continue;w=+w;if(w<0)continue}else w=1;k=h[_];if(k===undefined||k==="")k=_;k=String(k);var E=y[k];if(E===undefined){y[k]=d.length;M=b.indexOf(k)!==-1;if(!M)x+=w;d.push({v:w,label:k,color:T(p[_]),i:_,pts:[_],hidden:M})}else{A=d[E];A.v+=w;A.pts.push(_);if(!A.hidden)x+=w;if(A.color===false&&p[_]){A.color=T(p[_],k)}}}if(r.sort)d.sort(function(t,e){return e.v-t.v});for(_=0;_<d.length;_++){A=d[_];if(A.color===false){if(m[A.label]){A.color=m[A.label]}else{m[A.label]=A.color=u(v._piedefaultcolorcount,v._piecolorway);v._piedefaultcolorcount++}}}if(d[0])d[0].vTotal=x;if(r.textinfo&&r.textinfo!=="none"){var C=r.textinfo.indexOf("label")!==-1;var L=r.textinfo.indexOf("text")!==-1;var I=r.textinfo.indexOf("value")!==-1;var z=r.textinfo.indexOf("percent")!==-1;var P=v.separators;var O;for(_=0;_<d.length;_++){A=d[_];O=C?[A.label]:[];if(L){var D=s.getFirstFilled(r.text,A.pts);if(D)O.push(D)}if(I)O.push(s.formatPieValue(A.v,P));if(z)O.push(s.formatPiePercent(A.v/x,P));A.text=O.join("<br>")}}return d};var l;function u(t,e){if(!l){var r=o.defaults;l=c(r)}var n=e||l;return n[t%n.length]}function c(t){var e;var r=t.slice();for(e=0;e<t.length;e++){r.push(i(t[e]).lighten(20).toHexString())}for(e=0;e<t.length;e++){r.push(i(t[e]).darken(20).toHexString())}return r}},{"../../components/color":558,"../../lib":684,"./helpers":995,"fast-isnumeric":214,tinycolor2:499}],993:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./attributes");var i=t("../../plots/domain").defaults;e.exports=function t(e,r,o,s){function l(t,i){return n.coerce(e,r,a,t,i)}var u=n.coerceFont;var c;var f=l("values");var h=n.isArrayOrTypedArray(f);var p=l("labels");if(Array.isArray(p)){c=p.length;if(h)c=Math.min(c,f.length)}else if(h){c=f.length;l("label0");l("dlabel")}if(!c){r.visible=false;return}r._length=c;var d=l("marker.line.width");if(d)l("marker.line.color");l("marker.colors");l("scalegroup");var v=l("text");var g=l("textinfo",Array.isArray(v)?"text+percent":"percent");l("hovertext");if(g&&g!=="none"){var m=l("textposition"),y=Array.isArray(m)||m==="auto",x=y||m==="inside",b=y||m==="outside";if(x||b){var _=u(l,"textfont",s.font);if(x)u(l,"insidetextfont",_);if(b)u(l,"outsidetextfont",_)}}i(r,s,l);l("hole");l("sort");l("direction");l("rotation");l("pull")}},{"../../lib":684,"../../plots/domain":757,"./attributes":990}],994:[function(t,e,r){"use strict";var n=t("../../components/fx/helpers").appendArrayMultiPointValues;e.exports=function t(e,r){var a={curveNumber:r.index,pointNumbers:e.pts,data:r._input,fullData:r,label:e.label,color:e.color,value:e.v,v:e.v};if(e.pts.length===1)a.pointNumber=a.i=e.pts[0];n(a,r,e.pts);return a}},{"../../components/fx/helpers":597}],995:[function(t,e,r){"use strict";var n=t("../../lib");r.formatPiePercent=function t(e,r){var a=(e*100).toPrecision(3);if(a.lastIndexOf(".")!==-1){a=a.replace(/[.]?0+$/,"")}return n.numSeparate(a,r)+"%"};r.formatPieValue=function t(e,r){var a=e.toPrecision(10);if(a.lastIndexOf(".")!==-1){a=a.replace(/[.]?0+$/,"")}return n.numSeparate(a,r)};r.getFirstFilled=function t(e,r){if(!Array.isArray(e))return;for(var n=0;n<r.length;n++){var a=e[r[n]];if(a||a===0)return a}};r.castOption=function t(e,n){if(Array.isArray(e))return r.getFirstFilled(e,n);else if(e)return e}},{"../../lib":684}],996:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.supplyLayoutDefaults=t("./layout_defaults");n.layoutAttributes=t("./layout_attributes");n.calc=t("./calc");n.plot=t("./plot");n.style=t("./style");n.styleOne=t("./style_one");n.moduleType="trace";n.name="pie";n.basePlotModule=t("./base_plot");n.categories=["pie","showLegend"];n.meta={};e.exports=n},{"./attributes":990,"./base_plot":991,"./calc":992,"./defaults":993,"./layout_attributes":997,"./layout_defaults":998,"./plot":999,"./style":1e3,"./style_one":1001}],997:[function(t,e,r){"use strict";e.exports={hiddenlabels:{valType:"data_array",editType:"calc"}}},{}],998:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./layout_attributes");e.exports=function t(e,r){function i(t,i){return n.coerce(e,r,a,t,i)}i("hiddenlabels")}},{"../../lib":684,"./layout_attributes":997}],999:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/fx");var i=t("../../components/color");var o=t("../../components/drawing");var s=t("../../lib");var l=t("../../lib/svg_text_utils");var u=t("./helpers");var c=t("./event_data");e.exports=function t(e,r){var m=e._fullLayout;v(r,m._size);var y=m._pielayer.selectAll("g.trace").data(r);y.enter().append("g").attr({"stroke-linejoin":"round",class:"trace"});y.exit().remove();y.order();y.each(function(t){var r=n.select(this);var v=t[0];var y=v.trace;g(t);r.each(function(){var r=n.select(this).selectAll("g.slice").data(t);r.enter().append("g").classed("slice",true);r.exit().remove();var g=[[[],[]],[[],[]]];var x=false;r.each(function(t){if(t.hidden){n.select(this).selectAll("path,g").remove();return}t.pointNumber=t.i;t.curveNumber=y.index;g[t.pxmid[1]<0?0:1][t.pxmid[0]<0?0:1].push(t);var r=v.cx;var i=v.cy;var d=n.select(this);var b=d.selectAll("path.surface").data([t]);var _=false;var w=false;function k(){var o=e._fullLayout;var s=e._fullData[y.index];if(e._dragging||o.hovermode===false)return;var l=s.hoverinfo;if(Array.isArray(l)){l=a.castHoverinfo({hoverinfo:[u.castOption(l,t.pts)],_module:y._module},o,0)}if(l==="all")l="label+text+value+percent+name";if(l!=="none"&&l!=="skip"&&l){var f=h(t,v);var p=r+t.pxmid[0]*(1-f);var d=i+t.pxmid[1]*(1-f);var g=m.separators;var x=[];if(l.indexOf("label")!==-1)x.push(t.label);if(l.indexOf("text")!==-1){var b=u.castOption(s.hovertext||s.text,t.pts);if(b)x.push(b)}if(l.indexOf("value")!==-1)x.push(u.formatPieValue(t.v,g));if(l.indexOf("percent")!==-1)x.push(u.formatPiePercent(t.v/v.vTotal,g));var k=y.hoverlabel;var M=k.font;a.loneHover({x0:p-f*v.r,x1:p+f*v.r,y:d,text:x.join("<br>"),name:l.indexOf("name")!==-1?s.name:undefined,idealAlign:t.pxmid[0]<0?"left":"right",color:u.castOption(k.bgcolor,t.pts)||t.color,borderColor:u.castOption(k.bordercolor,t.pts),fontFamily:u.castOption(M.family,t.pts),fontSize:u.castOption(M.size,t.pts),fontColor:u.castOption(M.color,t.pts)},{container:o._hoverlayer.node(),outerContainer:o._paper.node(),gd:e});_=true}e.emit("plotly_hover",{points:[c(t,s)],event:n.event});w=true}function M(r){var i=e._fullLayout;var o=e._fullData[y.index];if(w){r.originalEvent=n.event;e.emit("plotly_unhover",{points:[c(t,o)],event:n.event});w=false}if(_){a.loneUnhover(i._hoverlayer.node());_=false}}function A(){var r=e._fullLayout;var i=e._fullData[y.index];if(e._dragging||r.hovermode===false)return;e._hoverdata=[c(t,i)];a.click(e,n.event)}b.enter().append("path").classed("surface",true).style({"pointer-events":"all"});d.select("path.textline").remove();d.on("mouseover",k).on("mouseout",M).on("click",A);if(y.pull){var T=+u.castOption(y.pull,t.pts)||0;if(T>0){r+=T*t.pxmid[0];i+=T*t.pxmid[1]}}t.cxFinal=r;t.cyFinal=i;function S(e,r,n,a){return"a"+a*v.r+","+a*v.r+" 0 "+t.largeArc+(n?" 1 ":" 0 ")+a*(r[0]-e[0])+","+a*(r[1]-e[1])}var E=y.hole;if(t.v===v.vTotal){var C="M"+(r+t.px0[0])+","+(i+t.px0[1])+S(t.px0,t.pxmid,true,1)+S(t.pxmid,t.px0,true,1)+"Z";if(E){b.attr("d","M"+(r+E*t.px0[0])+","+(i+E*t.px0[1])+S(t.px0,t.pxmid,false,E)+S(t.pxmid,t.px0,false,E)+"Z"+C)}else b.attr("d",C)}else{var L=S(t.px0,t.px1,true,1);if(E){var I=1-E;b.attr("d","M"+(r+E*t.px1[0])+","+(i+E*t.px1[1])+S(t.px1,t.px0,false,E)+"l"+I*t.px0[0]+","+I*t.px0[1]+L+"Z")}else{b.attr("d","M"+r+","+i+"l"+t.px0[0]+","+t.px0[1]+L+"Z")}}var z=u.castOption(y.textposition,t.pts);var P=d.selectAll("g.slicetext").data(t.text&&z!=="none"?[0]:[]);P.enter().append("g").classed("slicetext",true);P.exit().remove();P.each(function(){var a=s.ensureSingle(n.select(this),"text","",function(t){t.attr("data-notex",1)});a.text(t.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(o.font,z==="outside"?y.outsidetextfont:y.insidetextfont).call(l.convertToTspans,e);var u=o.bBox(a.node());var c;if(z==="outside"){c=p(u,t)}else{c=f(u,t,v);if(z==="auto"&&c.scale<1){a.call(o.font,y.outsidetextfont);if(y.outsidetextfont.family!==y.insidetextfont.family||y.outsidetextfont.size!==y.insidetextfont.size){u=o.bBox(a.node())}c=p(u,t)}}var h=r+t.pxmid[0]*c.rCenter+(c.x||0);var d=i+t.pxmid[1]*c.rCenter+(c.y||0);if(c.outside){t.yLabelMin=d-u.height/2;t.yLabelMid=d;t.yLabelMax=d+u.height/2;t.labelExtraX=0;t.labelExtraY=0;x=true}a.attr("transform","translate("+h+","+d+")"+(c.scale<1?"scale("+c.scale+")":"")+(c.rotate?"rotate("+c.rotate+")":"")+"translate("+-(u.left+u.right)/2+","+-(u.top+u.bottom)/2+")")})});if(x)d(g,y);r.each(function(t){if(t.labelExtraX||t.labelExtraY){var e=n.select(this);var r=e.select("g.slicetext text");r.attr("transform","translate("+t.labelExtraX+","+t.labelExtraY+")"+r.attr("transform"));var a=t.cxFinal+t.pxmid[0];var o=t.cyFinal+t.pxmid[1];var s="M"+a+","+o;var l=(t.yLabelMax-t.yLabelMin)*(t.pxmid[0]<0?-1:1)/4;if(t.labelExtraX){var u=t.labelExtraX*t.pxmid[1]/t.pxmid[0];var c=t.yLabelMid+t.labelExtraY-(t.cyFinal+t.pxmid[1]);if(Math.abs(u)>Math.abs(c)){s+="l"+c*t.pxmid[0]/t.pxmid[1]+","+c+"H"+(a+t.labelExtraX+l)}else{s+="l"+t.labelExtraX+","+u+"v"+(c-u)+"h"+l}}else{s+="V"+(t.yLabelMid+t.labelExtraY)+"h"+l}e.append("path").classed("textline",true).call(i.stroke,y.outsidetextfont.color).attr({"stroke-width":Math.min(2,y.outsidetextfont.size/8),d:s,fill:"none"})}})})});setTimeout(function(){y.selectAll("tspan").each(function(){var t=n.select(this);if(t.attr("dy"))t.attr("dy",t.attr("dy"))})},0)};function f(t,e,r){var n=Math.sqrt(t.width*t.width+t.height*t.height);var a=t.width/t.height;var i=Math.PI*Math.min(e.v/r.vTotal,.5);var o=1-r.trace.hole;var s=h(e,r),l={scale:s*r.r*2/n,rCenter:1-s,rotate:0};if(l.scale>=1)return l;var u=a+1/(2*Math.tan(i));var c=r.r*Math.min(1/(Math.sqrt(u*u+.5)+u),o/(Math.sqrt(a*a+o/2)+a));var f={scale:c*2/t.height,rCenter:Math.cos(c/r.r)-c*a/r.r,rotate:(180/Math.PI*e.midangle+720)%180-90};var p=1/a;var d=p+1/(2*Math.tan(i));var v=r.r*Math.min(1/(Math.sqrt(d*d+.5)+d),o/(Math.sqrt(p*p+o/2)+p));var g={scale:v*2/t.width,rCenter:Math.cos(v/r.r)-v/a/r.r,rotate:(180/Math.PI*e.midangle+810)%180-90};var m=g.scale>f.scale?g:f;if(l.scale<1&&m.scale>l.scale)return m;return l}function h(t,e){if(t.v===e.vTotal&&!e.trace.hole)return 1;var r=Math.PI*Math.min(t.v/e.vTotal,.5);return Math.min(1/(1+1/Math.sin(r)),(1-e.trace.hole)/2)}function p(t,e){var r=e.pxmid[0];var n=e.pxmid[1];var a=t.width/2;var i=t.height/2;if(r<0)a*=-1;if(n<0)i*=-1;return{scale:1,rCenter:1,rotate:0,x:a+Math.abs(i)*(a>0?1:-1)/2,y:i/(1+r*r/(n*n)),outside:true}}function d(t,e){var r,n,a,i,o,s,l,c,f,h,p,d,v;function g(t,e){return t.pxmid[1]-e.pxmid[1]}function m(t,e){return e.pxmid[1]-t.pxmid[1]}function y(t,r){if(!r)r={};var a=r.labelExtraY+(n?r.yLabelMax:r.yLabelMin);var c=n?t.yLabelMin:t.yLabelMax;var f=n?t.yLabelMax:t.yLabelMin;var p=t.cyFinal+o(t.px0[1],t.px1[1]);var d=a-c;var v,g,m,y,x,b;if(d*l>0)t.labelExtraY=d;if(!Array.isArray(e.pull))return;for(g=0;g<h.length;g++){m=h[g];if(m===t||(u.castOption(e.pull,t.pts)||0)>=(u.castOption(e.pull,m.pts)||0)){continue}if((t.pxmid[1]-m.pxmid[1])*l>0){y=m.cyFinal+o(m.px0[1],m.px1[1]);d=y-c-t.labelExtraY;if(d*l>0)t.labelExtraY+=d}else if((f+t.labelExtraY-p)*l>0){v=3*s*Math.abs(g-h.indexOf(t));x=m.cxFinal+i(m.px0[0],m.px1[0]);b=x+v-(t.cxFinal+t.pxmid[0])-t.labelExtraX;if(b*s>0)t.labelExtraX+=b}}}for(n=0;n<2;n++){a=n?g:m;o=n?Math.max:Math.min;l=n?1:-1;for(r=0;r<2;r++){i=r?Math.max:Math.min;s=r?1:-1;c=t[n][r];c.sort(a);f=t[1-n][r];h=f.concat(c);d=[];for(p=0;p<c.length;p++){if(c[p].yLabelMid!==undefined)d.push(c[p])}v=false;for(p=0;n&&p<f.length;p++){if(f[p].yLabelMid!==undefined){v=f[p];break}}for(p=0;p<d.length;p++){var x=p&&d[p-1];if(v&&!p)x=v;y(d[p],x)}}}}function v(t,e){var r=[];var n,a,i,o,s,l,u,c,f;for(i=0;i<t.length;i++){s=t[i][0];l=s.trace;n=e.w*(l.domain.x[1]-l.domain.x[0]);a=e.h*(l.domain.y[1]-l.domain.y[0]);u=l.pull;if(Array.isArray(u)){u=0;for(o=0;o<l.pull.length;o++){if(l.pull[o]>u)u=l.pull[o]}}s.r=Math.min(n,a)/(2+2*u);s.cx=e.l+e.w*(l.domain.x[1]+l.domain.x[0])/2;s.cy=e.t+e.h*(2-l.domain.y[1]-l.domain.y[0])/2;if(l.scalegroup&&r.indexOf(l.scalegroup)===-1){r.push(l.scalegroup)}}for(o=0;o<r.length;o++){f=Infinity;c=r[o];for(i=0;i<t.length;i++){s=t[i][0];if(s.trace.scalegroup===c){f=Math.min(f,s.r*s.r/s.vTotal)}}for(i=0;i<t.length;i++){s=t[i][0];if(s.trace.scalegroup===c){s.r=Math.sqrt(f*s.vTotal)}}}}function g(t){var e=t[0];var r=e.trace;var n=r.rotation*Math.PI/180;var a=2*Math.PI/e.vTotal;var i="px0";var o="px1";var s,l,u;if(r.direction==="counterclockwise"){for(s=0;s<t.length;s++){if(!t[s].hidden)break}if(s===t.length)return;n+=a*t[s].v;a*=-1;i="px1";o="px0"}function c(t){return[e.r*Math.sin(t),-e.r*Math.cos(t)]}u=c(n);for(s=0;s<t.length;s++){l=t[s];if(l.hidden)continue;l[i]=u;n+=a*l.v/2;l.pxmid=c(n);l.midangle=n;n+=a*l.v/2;u=c(n);l[o]=u;l.largeArc=l.v>e.vTotal/2?1:0}}},{"../../components/color":558,"../../components/drawing":583,"../../components/fx":600,"../../lib":684,"../../lib/svg_text_utils":708,"./event_data":994,"./helpers":995,d3:147}],1000:[function(t,e,r){"use strict";var n=t("d3");var a=t("./style_one");e.exports=function t(e){e._fullLayout._pielayer.selectAll(".trace").each(function(t){var e=t[0];var r=e.trace;var i=n.select(this);i.style({opacity:r.opacity});i.selectAll("path.surface").each(function(t){n.select(this).call(a,t,r)})})}},{"./style_one":1001,d3:147}],1001:[function(t,e,r){"use strict";var n=t("../../components/color");var a=t("./helpers").castOption;e.exports=function t(e,r,i){var o=i.marker.line;var s=a(o.color,r.pts)||n.defaultLine;var l=a(o.width,r.pts)||0;e.style({"stroke-width":l}).call(n.fill,r.color).call(n.stroke,s)}},{"../../components/color":558,"./helpers":995}],1002:[function(t,e,r){"use strict";var n=t("../scatter/attributes");e.exports={x:n.x,y:n.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:n.text,marker:{color:{valType:"color",arrayOk:false,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:false,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:false,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"}}},{"../scatter/attributes":1015}],1003:[function(t,e,r){"use strict";var n=t("gl-pointcloud2d");var a=t("../../lib/str2rgbarray");var i=t("../../plots/cartesian/autorange").expand;var o=t("../scatter/get_trace_color");function s(t,e){this.scene=t;this.uid=e;this.type="pointcloud";this.pickXData=[];this.pickYData=[];this.xData=[];this.yData=[];this.textLabels=[];this.color="rgb(0, 0, 0)";this.name="";this.hoverinfo="all";this.idToIndex=new Int32Array(0);this.bounds=[0,0,0,0];this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]};this.pointcloud=n(t.glplot,this.pointcloudOptions);this.pointcloud._trace=this}var l=s.prototype;l.handlePick=function(t){var e=this.idToIndex[t.pointId];return{trace:this,dataCoord:t.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[e*2],this.pickXYData[e*2+1]]:[this.pickXData[e],this.pickYData[e]],textLabel:Array.isArray(this.textLabels)?this.textLabels[e]:this.textLabels,color:this.color,name:this.name,pointIndex:e,hoverinfo:this.hoverinfo}};l.update=function(t){this.index=t.index;this.textLabels=t.text;this.name=t.name;this.hoverinfo=t.hoverinfo;this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.updateFast(t);this.color=o(t,{})};l.updateFast=function(t){var e=this.xData=this.pickXData=t.x;var r=this.yData=this.pickYData=t.y;var n=this.pickXYData=t.xy;var i=t.xbounds&&t.ybounds;var o=t.indices;var s,l,u,c=this.bounds;var f,h,p;if(n){u=n;s=n.length>>>1;if(i){c[0]=t.xbounds[0];c[2]=t.xbounds[1];c[1]=t.ybounds[0];c[3]=t.ybounds[1]}else{for(p=0;p<s;p++){f=u[p*2];h=u[p*2+1];if(f<c[0])c[0]=f;if(f>c[2])c[2]=f;if(h<c[1])c[1]=h;if(h>c[3])c[3]=h}}if(o){l=o}else{l=new Int32Array(s);for(p=0;p<s;p++){l[p]=p}}}else{s=e.length;u=new Float32Array(2*s);l=new Int32Array(s);for(p=0;p<s;p++){f=e[p];h=r[p];l[p]=p;u[p*2]=f;u[p*2+1]=h;if(f<c[0])c[0]=f;if(f>c[2])c[2]=f;if(h<c[1])c[1]=h;if(h>c[3])c[3]=h}}this.idToIndex=l;this.pointcloudOptions.idToIndex=l;this.pointcloudOptions.positions=u;var d=a(t.marker.color),v=a(t.marker.border.color),g=t.opacity*t.marker.opacity;d[3]*=g;this.pointcloudOptions.color=d;var m=t.marker.blend;if(m===null){var y=100;m=e.length<y||r.length<y}this.pointcloudOptions.blend=m;v[3]*=g;this.pointcloudOptions.borderColor=v;var x=t.marker.sizemin;var b=Math.max(t.marker.sizemax,t.marker.sizemin);this.pointcloudOptions.sizeMin=x;this.pointcloudOptions.sizeMax=b;this.pointcloudOptions.areaRatio=t.marker.border.arearatio;this.pointcloud.update(this.pointcloudOptions);this.expandAxesFast(c,b/2)};l.expandAxesFast=function(t,e){var r=e||.5;i(this.scene.xaxis,[t[0],t[2]],{ppad:r});i(this.scene.yaxis,[t[1],t[3]],{ppad:r})};l.dispose=function(){this.pointcloud.dispose()};function u(t,e){var r=new s(t,e.uid);r.update(e);return r}e.exports=u},{"../../lib/str2rgbarray":707,"../../plots/cartesian/autorange":731,"../scatter/get_trace_color":1024,"gl-pointcloud2d":279}],1004:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./attributes");e.exports=function t(e,r,i){function o(t,i){return n.coerce(e,r,a,t,i)}o("x");o("y");o("xbounds");o("ybounds");if(e.xy&&e.xy instanceof Float32Array){r.xy=e.xy}if(e.indices&&e.indices instanceof Int32Array){r.indices=e.indices}o("text");o("marker.color",i);o("marker.opacity");o("marker.blend");o("marker.sizemin");o("marker.sizemax");o("marker.border.color",i);o("marker.border.arearatio");r._length=null}},{"../../lib":684,"./attributes":1002}],1005:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.calc=t("../scatter3d/calc");n.plot=t("./convert");n.moduleType="trace";n.name="pointcloud";n.basePlotModule=t("../../plots/gl2d");n.categories=["gl","gl2d","showLegend"];n.meta={};e.exports=n},{"../../plots/gl2d":771,"../scatter3d/calc":1041,"./attributes":1002,"./convert":1003,"./defaults":1004}],1006:[function(t,e,r){"use strict";var n=t("../../plots/font_attributes");var a=t("../../plots/attributes");var i=t("../../components/color/attributes");var o=t("../../components/fx/attributes");var s=t("../../plots/domain").attributes;var l=t("../../lib/extend").extendFlat;var u=t("../../plot_api/edit_types").overrideAll;e.exports=u({hoverinfo:l({},a.hoverinfo,{flags:["label","text","value","percent","name"]}),hoverlabel:o.hoverlabel,domain:s({name:"sankey",trace:true}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s"},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:n({}),node:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:true},line:{color:{valType:"color",dflt:i.defaultLine,arrayOk:true},width:{valType:"number",min:0,dflt:.5,arrayOk:true}},pad:{valType:"number",arrayOk:false,min:0,dflt:20},thickness:{valType:"number",arrayOk:false,min:1,dflt:20}},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:true},line:{color:{valType:"color",dflt:i.defaultLine,arrayOk:true},width:{valType:"number",min:0,dflt:0,arrayOk:true}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]}}},"calc","nested")},{"../../components/color/attributes":557,"../../components/fx/attributes":592,"../../lib/extend":673,"../../plot_api/edit_types":715,"../../plots/attributes":729,"../../plots/domain":757,"../../plots/font_attributes":758}],1007:[function(t,e,r){"use strict";var n=t("../../plot_api/edit_types").overrideAll;var a=t("../../plots/get_data").getModuleCalcData;var i=t("./plot");var o=t("../../components/fx/layout_attributes");var s="sankey";r.name=s;r.baseLayoutAttrOverrides=n({hoverlabel:o.hoverlabel},"plot","nested");r.plot=function(t){var e=a(t.calcdata,s)[0];i(t,e)};r.clean=function(t,e,r,n){var a=n._has&&n._has(s);var i=e._has&&e._has(s);if(a&&!i){n._paperdiv.selectAll(".sankey").remove()}}},{"../../components/fx/layout_attributes":601,"../../plot_api/edit_types":715,"../../plots/get_data":768,"./plot":1012}],1008:[function(t,e,r){"use strict";var n=t("strongly-connected-components");var a=t("../../lib");var i=t("../../lib/gup").wrap;function o(t,e,r){var i=t.length;var o=a.init2dArray(i,0);for(var s=0;s<Math.min(e.length,r.length);s++){if(a.isIndex(e[s],i)&&a.isIndex(r[s],i)){if(e[s]===r[s]){return true}o[e[s]].push(r[s])}}var l=n(o);return l.components.some(function(t){return t.length>1})}e.exports=function t(e,r){if(o(r.node.label,r.link.source,r.link.target)){a.error("Circularity is present in the Sankey data. Removing all nodes and links.");r.link.label=[];r.link.source=[];r.link.target=[];r.link.value=[];r.link.color=[];r.node.label=[];r.node.color=[]}return i({link:r.link,node:r.node})}},{"../../lib":684,"../../lib/gup":681,"strongly-connected-components":491}],1009:[function(t,e,r){"use strict";e.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"cubic-in-out",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeCapture:"node-capture",nodeCentered:"node-entered",nodeLabelGuide:"node-label-guide",nodeLabel:"node-label",nodeLabelTextPath:"node-label-text-path"}}},{}],1010:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./attributes");var i=t("../../components/color");var o=t("tinycolor2");var s=t("../../plots/domain").defaults;e.exports=function t(e,r,l,u){function c(t,i){return n.coerce(e,r,a,t,i)}c("node.label");c("node.pad");c("node.thickness");c("node.line.color");c("node.line.width");var f=u.colorway;var h=function(t){return f[t%f.length]};c("node.color",r.node.label.map(function(t,e){return i.addOpacity(h(e),.8)}));c("link.label");c("link.source");c("link.target");c("link.value");c("link.line.color");c("link.line.width");c("link.color",r.link.value.map(function(){return o(u.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)"}));s(r,u,c);c("orientation");c("valueformat");c("valuesuffix");c("arrangement");n.coerceFont(c,"textfont",n.extendFlat({},u.font));r._length=null}},{"../../components/color":558,"../../lib":684,"../../plots/domain":757,"./attributes":1006,tinycolor2:499}],1011:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.calc=t("./calc");n.plot=t("./plot");n.moduleType="trace";n.name="sankey";n.basePlotModule=t("./base_plot");n.categories=["noOpacity"];n.meta={};e.exports=n},{"./attributes":1006,"./base_plot":1007,"./calc":1008,"./defaults":1010,"./plot":1012}],1012:[function(t,e,r){"use strict";var n=t("d3");var a=t("./render");var i=t("../../components/fx");var o=t("../../components/color");var s=t("../../lib");var l=t("./constants").cn;var u=s._;function c(t){return t!==""}function f(t,e){return t.filter(function(t){return t.key===e.traceId})}function h(t,e){n.select(t).select("path").style("fill-opacity",e);n.select(t).select("rect").style("fill-opacity",e)}function p(t){n.select(t).select("text.name").style("fill","black")}function d(t){return function(e){return t.node.sourceLinks.indexOf(e.link)!==-1||t.node.targetLinks.indexOf(e.link)!==-1}}function v(t){return function(e){return e.node.sourceLinks.indexOf(t.link)!==-1||e.node.targetLinks.indexOf(t.link)!==-1}}function g(t,e,r){if(e&&r){f(r,e).selectAll("."+l.sankeyLink).filter(d(e)).call(y.bind(0,e,r,false))}}function m(t,e,r){if(e&&r){f(r,e).selectAll("."+l.sankeyLink).filter(d(e)).call(x.bind(0,e,r,false))}}function y(t,e,r,n){var a=n.datum().link.label;n.style("fill-opacity",.4);if(a){f(e,t).selectAll("."+l.sankeyLink).filter(function(t){return t.link.label===a}).style("fill-opacity",.4)}if(r){f(e,t).selectAll("."+l.sankeyNode).filter(v(t)).call(g)}}function x(t,e,r,n){var a=n.datum().link.label;n.style("fill-opacity",function(t){return t.tinyColorAlpha});if(a){f(e,t).selectAll("."+l.sankeyLink).filter(function(t){return t.link.label===a}).style("fill-opacity",function(t){return t.tinyColorAlpha})}if(r){f(e,t).selectAll(l.sankeyNode).filter(v(t)).call(m)}}function b(t,e){var r=t.hoverlabel||{};var n=s.nestedProperty(r,e).get();return Array.isArray(n)?false:n}e.exports=function t(e,r){var s=e._fullLayout;var f=s._paper;var d=s._size;var v=function(t,r){var a=r.link;a.originalEvent=n.event;e._hoverdata=[a];i.click(e,{target:true})};var _=function(t,r,a){n.select(t).call(y.bind(0,r,a,true));e.emit("plotly_hover",{event:n.event,points:[r.link]})};var w=u(e,"source:")+" ";var k=u(e,"target:")+" ";var M=u(e,"incoming flow count:")+" ";var A=u(e,"outgoing flow count:")+" ";var T=function(t,r){var a=r.link.trace;var l=e._fullLayout._paperdiv.node().getBoundingClientRect();var u=t.getBoundingClientRect();var f=u.left+u.width/2;var d=u.top+u.height/2;var v=i.loneHover({x:f-l.left,y:d-l.top,name:n.format(r.valueFormat)(r.link.value)+r.valueSuffix,text:[r.link.label||"",w+r.link.source.label,k+r.link.target.label].filter(c).join("<br>"),color:b(a,"bgcolor")||o.addOpacity(r.tinyColorHue,1),borderColor:b(a,"bordercolor"),fontFamily:b(a,"font.family"),fontSize:b(a,"font.size"),fontColor:b(a,"font.color"),idealAlign:n.event.x<f?"right":"left"},{container:s._hoverlayer.node(),outerContainer:s._paper.node(),gd:e});h(v,.65);p(v)};var S=function(t,r,a){n.select(t).call(x.bind(0,r,a,true));e.emit("plotly_unhover",{event:n.event,points:[r.link]});i.loneUnhover(s._hoverlayer.node())};var E=function(t,r,a){var o=r.node;o.originalEvent=n.event;e._hoverdata=[o];n.select(t).call(m,r,a);i.click(e,{target:true})};var C=function(t,r,a){n.select(t).call(g,r,a);e.emit("plotly_hover",{event:n.event,points:[r.node]})};var L=function(t,r){var a=r.node.trace;var o=n.select(t).select("."+l.nodeRect);var u=e._fullLayout._paperdiv.node().getBoundingClientRect();var f=o.node().getBoundingClientRect();var d=f.left-2-u.left;var v=f.right+2-u.left;var g=f.top+f.height/4-u.top;var m=i.loneHover({x0:d,x1:v,y:g,name:n.format(r.valueFormat)(r.node.value)+r.valueSuffix,text:[r.node.label,M+r.node.targetLinks.length,A+r.node.sourceLinks.length].filter(c).join("<br>"),color:b(a,"bgcolor")||r.tinyColorHue,borderColor:b(a,"bordercolor"),fontFamily:b(a,"font.family"),fontSize:b(a,"font.size"),fontColor:b(a,"font.color"),idealAlign:"left"},{container:s._hoverlayer.node(),outerContainer:s._paper.node(),gd:e});h(m,.85);p(m)};var I=function(t,r,a){n.select(t).call(m,r,a);e.emit("plotly_unhover",{event:n.event,points:[r.node]});i.loneUnhover(s._hoverlayer.node())};a(f,r,{width:d.w,height:d.h,margin:{t:d.t,r:d.r,b:d.b,l:d.l}},{linkEvents:{hover:_,follow:T,unhover:S,select:v},nodeEvents:{hover:C,follow:L,unhover:I,select:E}})}},{"../../components/color":558,"../../components/fx":600,"../../lib":684,"./constants":1009,"./render":1013,d3:147}],1013:[function(t,e,r){"use strict";var n=t("./constants");var a=t("d3");var i=t("tinycolor2");var o=t("../../components/color");var s=t("../../components/drawing");var l=t("@plotly/d3-sankey").sankey;var u=t("d3-force");var c=t("../../lib");var f=c.isArrayOrTypedArray;var h=c.isIndex;var p=t("../../lib/gup");var d=p.keyFun;var v=p.repeat;var g=p.unwrap;function m(t){var e,r=[];for(e=0;e<t.length;e++){t[e].originalX=t[e].x;t[e].originalY=t[e].y;if(r.indexOf(t[e].x)===-1){r.push(t[e].x)}}r.sort(function(t,e){return t-e});for(e=0;e<t.length;e++){t[e].originalLayerIndex=r.indexOf(t[e].originalX);t[e].originalLayer=t[e].originalLayerIndex/(r.length-1)}}function y(t){t.lastDraggedX=t.x;t.lastDraggedY=t.y}function x(t){return function(e){return e.node.originalX===t.node.originalX}}function b(t){for(var e=0;e<t.length;e++){t[e].y=t[e].y+t[e].dy/2}}function _(t){for(var e=0;e<t.length;e++){t[e].y=t[e].y-t[e].dy/2}}function w(t,e,r){var a=g(e).trace;var i=a.domain;var o=a.node;var s=a.link;var u=a.arrangement;var c=a.orientation==="h";var p=a.node.pad;var d=a.node.thickness;var v=a.node.line.color;var m=a.node.line.width;var y=a.link.line.color;var x=a.link.line.width;var _=a.valueformat;var w=a.valuesuffix;var k=a.textfont;var M=t.width*(i.x[1]-i.x[0]);var A=t.height*(i.y[1]-i.y[0]);var T=[];var S=f(s.color);var E={};var C=o.label.length;var L;for(L=0;L<s.value.length;L++){var I=s.value[L];var z=s.source[L];var P=s.target[L];if(!(I>0&&h(z,C)&&h(P,C))){continue}z=+z;P=+P;E[z]=E[P]=true;T.push({pointNumber:L,label:s.label[L],color:S?s.color[L]:s.color,source:z,target:P,value:+I})}var O=f(o.color);var D=[];var R=false;var B={};for(L=0;L<C;L++){if(E[L]){var F=o.label[L];B[L]=D.length;D.push({pointNumber:L,label:F,color:O?o.color[L]:o.color})}else R=true}if(R){for(L=0;L<T.length;L++){T[L].source=B[T[L].source];T[L].target=B[T[L].target]}}var N=l().size(c?[M,A]:[A,M]).nodeWidth(d).nodePadding(p).nodes(D).links(T).layout(n.sankeyIterations);var j,V=N.nodes();for(var U=0;U<V.length;U++){j=V[U];j.width=M;j.height=A}b(D);return{key:r,trace:a,guid:Math.floor(1e12*(1+Math.random())),horizontal:c,width:M,height:A,nodePad:p,nodeLineColor:v,nodeLineWidth:m,linkLineColor:y,linkLineWidth:x,valueFormat:_,valueSuffix:w,textFont:k,translateX:i.x[0]*M+t.margin.l,translateY:t.height-i.y[1]*t.height+t.margin.t,dragParallel:c?A:M,dragPerpendicular:c?M:A,nodes:D,links:T,arrangement:u,sankey:N,forceLayouts:{},interactionState:{dragInProgress:false,hovered:false}}}function k(t,e,r){var n=i(r.color);var a=r.source.label+"|"+r.target.label;var s=t[a];t[a]=(s||0)+1;var l=a+"__"+t[a];r.trace=e.trace;r.curveNumber=e.trace.index;return{key:l,traceId:e.key,link:r,tinyColorHue:o.tinyRGB(n),tinyColorAlpha:n.getAlpha(),linkLineColor:e.linkLineColor,linkLineWidth:e.linkLineWidth,valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,interactionState:e.interactionState}}function M(t,e,r){var a=i(r.color),s=n.nodePadAcross,l=e.nodePad/2,u=r.dx,c=Math.max(.5,r.dy);var f=r.label;var h=t[f];t[f]=(h||0)+1;var p=f+"__"+t[f];r.trace=e.trace;r.curveNumber=e.trace.index;return{key:p,traceId:e.key,node:r,nodePad:e.nodePad,nodeLineColor:e.nodeLineColor,nodeLineWidth:e.nodeLineWidth,textFont:e.textFont,size:e.horizontal?e.height:e.width,visibleWidth:Math.ceil(u),visibleHeight:c,zoneX:-s,zoneY:-l,zoneWidth:u+2*s,zoneHeight:c+2*l,labelY:e.horizontal?r.dy/2+1:r.dx/2+1,left:r.originalLayer===1,sizeAcross:e.width,forceLayouts:e.forceLayouts,horizontal:e.horizontal,darkBackground:a.getBrightness()<=128,tinyColorHue:o.tinyRGB(a),tinyColorAlpha:a.getAlpha(),valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,arrangement:e.arrangement,uniqueNodeLabelPathId:[e.guid,e.key,p].join(" "),interactionState:e.interactionState}}function A(t){t.attr("transform",function(t){return"translate("+t.node.x.toFixed(3)+", "+(t.node.y-t.node.dy/2).toFixed(3)+")"})}function T(t){var e=t.sankey.nodes();_(e);var r=t.sankey.link()(t.link);b(e);return r}function S(t){t.call(A)}function E(t,e){t.call(S);e.attr("d",T)}function C(t){t.attr("width",function(t){return t.visibleWidth}).attr("height",function(t){return t.visibleHeight})}function L(t){return t.link.dy>1||t.linkLineWidth>0}function I(t){var e="translate("+t.translateX+","+t.translateY+")";return e+(t.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function z(t){return"translate("+(t.horizontal?0:t.labelY)+" "+(t.horizontal?t.labelY:0)+")"}function P(t){return a.svg.line()([[t.horizontal?t.left?-t.sizeAcross:t.visibleWidth+n.nodeTextOffsetHorizontal:n.nodeTextOffsetHorizontal,0],[t.horizontal?t.left?-n.nodeTextOffsetHorizontal:t.sizeAcross:t.visibleHeight-n.nodeTextOffsetHorizontal,0]])}function O(t){return t.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)"}function D(t){return t.horizontal?"scale(1 1)":"scale(-1 1)"}function R(t){return t.darkBackground&&!t.horizontal?"rgb(255,255,255)":"rgb(0,0,0)"}function B(t){return t.horizontal&&t.left?"100%":"0%"}function F(t,e,r){t.on(".basic",null).on("mouseover.basic",function(t){if(!t.interactionState.dragInProgress){r.hover(this,t,e);t.interactionState.hovered=[this,t]}}).on("mousemove.basic",function(t){if(!t.interactionState.dragInProgress){r.follow(this,t);t.interactionState.hovered=[this,t]}}).on("mouseout.basic",function(t){if(!t.interactionState.dragInProgress){r.unhover(this,t,e);t.interactionState.hovered=false}}).on("click.basic",function(t){if(t.interactionState.hovered){r.unhover(this,t,e);t.interactionState.hovered=false}if(!t.interactionState.dragInProgress){r.select(this,t,e)}})}function N(t,e,r){var n=a.behavior.drag().origin(function(t){return t.node}).on("dragstart",function(n){if(n.arrangement==="fixed")return;c.raiseToTop(this);n.interactionState.dragInProgress=n.node;y(n.node);if(n.interactionState.hovered){r.nodeEvents.unhover.apply(0,n.interactionState.hovered);n.interactionState.hovered=false}if(n.arrangement==="snap"){var a=n.traceId+"|"+Math.floor(n.node.originalX);if(n.forceLayouts[a]){n.forceLayouts[a].alpha(1)}else{j(t,a,n)}V(t,e,n,a)}}).on("drag",function(r){if(r.arrangement==="fixed")return;var n=a.event.x;var i=a.event.y;if(r.arrangement==="snap"){r.node.x=n;r.node.y=i}else{if(r.arrangement==="freeform"){r.node.x=n}r.node.y=Math.max(r.node.dy/2,Math.min(r.size-r.node.dy/2,i))}y(r.node);if(r.arrangement!=="snap"){r.sankey.relayout();E(t.filter(x(r)),e)}}).on("dragend",function(t){t.interactionState.dragInProgress=false});t.on(".drag",null).call(n)}function j(t,e,r){var a=r.sankey.nodes().filter(function(t){return t.originalX===r.node.originalX});r.forceLayouts[e]=u.forceSimulation(a).alphaDecay(0).force("collide",u.forceCollide().radius(function(t){return t.dy/2+r.nodePad/2}).strength(1).iterations(n.forceIterations)).force("constrain",U(t,e,a,r)).stop()}function V(t,e,r,a){window.requestAnimationFrame(function i(){for(var o=0;o<n.forceTicksPerFrame;o++){r.forceLayouts[a].tick()}r.sankey.relayout();E(t.filter(x(r)),e);if(r.forceLayouts[a].alpha()>0){window.requestAnimationFrame(i)}})}function U(t,e,r,a){return function t(){var i=0;for(var o=0;o<r.length;o++){var s=r[o];if(s===a.interactionState.dragInProgress){s.x=s.lastDraggedX;s.y=s.lastDraggedY}else{s.vx=(s.originalX-s.x)/n.forceTicksPerFrame;s.y=Math.min(a.size-s.dy/2,Math.max(s.dy/2,s.y))}i=Math.max(i,Math.abs(s.vx),Math.abs(s.vy))}if(!a.interactionState.dragInProgress&&i<.1&&a.forceLayouts[e].alpha()>0){a.forceLayouts[e].alpha(0)}}}e.exports=function(t,e,r,a){var l=t.selectAll("."+n.cn.sankey).data(e.filter(function(t){return g(t).trace.visible}).map(w.bind(null,r)),d);l.exit().remove();l.enter().append("g").classed(n.cn.sankey,true).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",I);l.transition().ease(n.ease).duration(n.duration).attr("transform",I);var u=l.selectAll("."+n.cn.sankeyLinks).data(v,d);u.enter().append("g").classed(n.cn.sankeyLinks,true).style("fill","none");var c=u.selectAll("."+n.cn.sankeyLink).data(function(t){var e={};return t.sankey.links().filter(function(t){return t.value}).map(k.bind(null,e,t))},d);c.enter().append("path").classed(n.cn.sankeyLink,true).attr("d",T).call(F,l,a.linkEvents);c.style("stroke",function(t){return L(t)?o.tinyRGB(i(t.linkLineColor)):t.tinyColorHue}).style("stroke-opacity",function(t){return L(t)?o.opacity(t.linkLineColor):t.tinyColorAlpha}).style("stroke-width",function(t){return L(t)?t.linkLineWidth:1}).style("fill",function(t){return t.tinyColorHue}).style("fill-opacity",function(t){return t.tinyColorAlpha});c.transition().ease(n.ease).duration(n.duration).attr("d",T);c.exit().transition().ease(n.ease).duration(n.duration).style("opacity",0).remove();var f=l.selectAll("."+n.cn.sankeyNodeSet).data(v,d);f.enter().append("g").classed(n.cn.sankeyNodeSet,true);f.style("cursor",function(t){switch(t.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var h=f.selectAll("."+n.cn.sankeyNode).data(function(t){var e=t.sankey.nodes();var r={};m(e);return e.filter(function(t){return t.value}).map(M.bind(null,r,t))},d);h.enter().append("g").classed(n.cn.sankeyNode,true).call(A).call(F,l,a.nodeEvents);h.call(N,c,a);h.transition().ease(n.ease).duration(n.duration).call(A);h.exit().transition().ease(n.ease).duration(n.duration).style("opacity",0).remove();var p=h.selectAll("."+n.cn.nodeRect).data(v);p.enter().append("rect").classed(n.cn.nodeRect,true).call(C);p.style("stroke-width",function(t){return t.nodeLineWidth}).style("stroke",function(t){return o.tinyRGB(i(t.nodeLineColor))}).style("stroke-opacity",function(t){return o.opacity(t.nodeLineColor)}).style("fill",function(t){return t.tinyColorHue}).style("fill-opacity",function(t){return t.tinyColorAlpha});p.transition().ease(n.ease).duration(n.duration).call(C);var y=h.selectAll("."+n.cn.nodeCapture).data(v);y.enter().append("rect").classed(n.cn.nodeCapture,true).style("fill-opacity",0);y.attr("x",function(t){return t.zoneX}).attr("y",function(t){return t.zoneY}).attr("width",function(t){return t.zoneWidth}).attr("height",function(t){return t.zoneHeight});var x=h.selectAll("."+n.cn.nodeCentered).data(v);x.enter().append("g").classed(n.cn.nodeCentered,true).attr("transform",z);x.transition().ease(n.ease).duration(n.duration).attr("transform",z);var b=x.selectAll("."+n.cn.nodeLabelGuide).data(v);b.enter().append("path").classed(n.cn.nodeLabelGuide,true).attr("id",function(t){return t.uniqueNodeLabelPathId}).attr("d",P).attr("transform",O);b.transition().ease(n.ease).duration(n.duration).attr("d",P).attr("transform",O);var _=x.selectAll("."+n.cn.nodeLabel).data(v);_.enter().append("text").classed(n.cn.nodeLabel,true).attr("transform",D).style("user-select","none").style("cursor","default").style("fill","black");_.style("text-shadow",function(t){return t.horizontal?"-1px 1px 1px #fff, 1px 1px 1px #fff, 1px -1px 1px #fff, -1px -1px 1px #fff":"none"}).each(function(t){s.font(_,t.textFont)});_.transition().ease(n.ease).duration(n.duration).attr("transform",D);var S=_.selectAll("."+n.cn.nodeLabelTextPath).data(v);S.enter().append("textPath").classed(n.cn.nodeLabelTextPath,true).attr("alignment-baseline","middle").attr("xlink:href",function(t){return"#"+t.uniqueNodeLabelPathId}).attr("startOffset",B).style("fill",R);S.text(function(t){return t.horizontal||t.node.dy>5?t.node.label:""}).attr("text-anchor",function(t){return t.horizontal&&t.left?"end":"start"});S.transition().ease(n.ease).duration(n.duration).attr("startOffset",B).style("fill",R)}},{"../../components/color":558,"../../components/drawing":583,"../../lib":684,"../../lib/gup":681,"./constants":1009,"@plotly/d3-sankey":49,d3:147,"d3-force":143,tinycolor2:499}],1014:[function(t,e,r){"use strict";var n=t("../../lib");e.exports=function t(e,r){for(var a=0;a<e.length;a++)e[a].i=a;n.mergeArray(r.text,e,"tx");n.mergeArray(r.hovertext,e,"htx");n.mergeArray(r.customdata,e,"data");n.mergeArray(r.textposition,e,"tp");if(r.textfont){n.mergeArray(r.textfont.size,e,"ts");n.mergeArray(r.textfont.color,e,"tc");n.mergeArray(r.textfont.family,e,"tf")}var i=r.marker;if(i){n.mergeArray(i.size,e,"ms");n.mergeArray(i.opacity,e,"mo");n.mergeArray(i.symbol,e,"mx");n.mergeArray(i.color,e,"mc");var o=i.line;if(i.line){n.mergeArray(o.color,e,"mlc");n.mergeArray(o.width,e,"mlw")}var s=i.gradient;if(s&&s.type!=="none"){n.mergeArray(s.type,e,"mgt");n.mergeArray(s.color,e,"mgc")}}}},{"../../lib":684}],1015:[function(t,e,r){"use strict";var n=t("../../components/colorscale/attributes");var a=t("../../components/colorbar/attributes");var i=t("../../plots/font_attributes");var o=t("../../components/drawing/attributes").dash;var s=t("../../components/drawing");var l=t("./constants");var u=t("../../lib/extend").extendFlat;e.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:u({},o,{editType:"style"}),simplify:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:false,editType:"calc"},cliponaxis:{valType:"boolean",dflt:true,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],dflt:"none",editType:"calc"},fillcolor:{valType:"color",editType:"style"},marker:u({symbol:{valType:"enumerated",values:s.symbolList,dflt:"circle",arrayOk:true,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:true,editType:"style"},size:{valType:"number",min:0,dflt:6,arrayOk:true,editType:"calcIfAutorange"},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},colorbar:a,line:u({width:{valType:"number",min:0,arrayOk:true,editType:"style"},editType:"calc"},n("marker.line")),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:true,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:true,editType:"calc"},editType:"calc"},editType:"calc"},n("marker")),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:true,editType:"calc"},textfont:i({editType:"calc",colorEditType:"style",arrayOk:true}),r:{valType:"data_array",editType:"calc"},t:{valType:"data_array",editType:"calc"}}},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../components/drawing":583,"../../components/drawing/attributes":582,"../../lib/extend":673,"../../plots/font_attributes":758,"./constants":1020}],1016:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib").isArrayOrTypedArray;var i=t("../../plots/cartesian/axes");var o=t("../../constants/numerical").BADNUM;var s=t("./subtypes");var l=t("./colorscale_calc");var u=t("./arrays_to_calcdata");var c=t("./calc_selection");function f(t,e){var r=i.getFromId(t,e.xaxis||"x");var a=i.getFromId(t,e.yaxis||"y");var s=r.makeCalcdata(e,"x");var f=a.makeCalcdata(e,"y");var d=e._length;var v=new Array(d);var g=p(e,d);h(t,e,r,a,s,f,g);for(var m=0;m<d;m++){v[m]=n(s[m])&&n(f[m])?{x:s[m],y:f[m]}:{x:o,y:o};if(e.ids){v[m].id=String(e.ids[m])}}u(v,e);l(e);c(v,e);t.firstscatter=false;return v}function h(t,e,r,n,a,o,l){var u=e._length;r._minDtick=0;n._minDtick=0;var c={padded:true};var f={padded:true};if(l){c.ppad=f.ppad=l}if((e.fill==="tozerox"||e.fill==="tonextx"&&t.firstscatter)&&(a[0]!==a[u-1]||o[0]!==o[u-1])){c.tozero=true}else if(!(e.error_y||{}).visible&&(["tonexty","tozeroy"].indexOf(e.fill)!==-1||!s.hasMarkers(e)&&!s.hasText(e))){c.padded=false;c.ppad=0}if((e.fill==="tozeroy"||e.fill==="tonexty"&&t.firstscatter)&&(a[0]!==a[u-1]||o[0]!==o[u-1])){f.tozero=true}else if(["tonextx","tozerox"].indexOf(e.fill)!==-1){f.padded=false}i.expand(r,a,c);i.expand(n,o,f)}function p(t,e){if(!s.hasMarkers(t))return;var r=t.marker;var n=1.6*(t.marker.sizeref||1);var o;if(t.marker.sizemode==="area"){o=function(t){return Math.max(Math.sqrt((t||0)/n),3)}}else{o=function(t){return Math.max((t||0)/n,3)}}if(a(r.size)){var l={type:"linear"};i.setConvert(l);var u=l.makeCalcdata(t.marker,"size");var c=new Array(e);for(var f=0;f<e;f++){c[f]=o(u[f])}return c}else{return o(r.size)}}e.exports={calc:f,calcMarkerSize:p,calcAxisExpansion:h}},{"../../constants/numerical":661,"../../lib":684,"../../plots/cartesian/axes":732,"./arrays_to_calcdata":1014,"./calc_selection":1017,"./colorscale_calc":1019,"./subtypes":1037,"fast-isnumeric":214}],1017:[function(t,e,r){"use strict";var n=t("../../lib");e.exports=function t(e,r){if(n.isArrayOrTypedArray(r.selectedpoints)){n.tagSelected(e,r)}}},{"../../lib":684}],1018:[function(t,e,r){"use strict";e.exports=function t(e){for(var r=0;r<e.length;r++){var n=e[r];if(n.type!=="scatter")continue;var a=n.fill;if(a==="none"||a==="toself")continue;n.opacity=undefined;if(a==="tonexty"||a==="tonextx"){for(var i=r-1;i>=0;i--){var o=e[i];if(o.type==="scatter"&&o.xaxis===n.xaxis&&o.yaxis===n.yaxis){o.opacity=undefined;break}}}}}},{}],1019:[function(t,e,r){"use strict";var n=t("../../components/colorscale/has_colorscale");var a=t("../../components/colorscale/calc");var i=t("./subtypes");e.exports=function t(e){if(i.hasLines(e)&&n(e,"line")){a(e,e.line.color,"line","c")}if(i.hasMarkers(e)){if(n(e,"marker")){a(e,e.marker.color,"marker","c")}if(n(e,"marker.line")){a(e,e.marker.line.color,"marker.line","c")}}}},{"../../components/colorscale/calc":566,"../../components/colorscale/has_colorscale":572,"./subtypes":1037}],1020:[function(t,e,r){"use strict";e.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20}},{}],1021:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../registry");var i=t("./attributes");var o=t("./constants");var s=t("./subtypes");var l=t("./xy_defaults");var u=t("./marker_defaults");var c=t("./line_defaults");var f=t("./line_shape_defaults");var h=t("./text_defaults");var p=t("./fillcolor_defaults");e.exports=function t(e,r,d,v){function g(t,a){return n.coerce(e,r,i,t,a)}var m=l(e,r,v,g),y=m<o.PTS_LINESONLY?"lines+markers":"lines";if(!m){r.visible=false;return}g("text");g("hovertext");g("mode",y);if(s.hasLines(r)){c(e,r,d,v,g);f(e,r,g);g("connectgaps");g("line.simplify")}if(s.hasMarkers(r)){u(e,r,d,v,g,{gradient:true})}if(s.hasText(r)){h(e,r,v,g)}var x=[];if(s.hasMarkers(r)||s.hasText(r)){g("cliponaxis");g("marker.maxdisplayed");x.push("points")}g("fill");if(r.fill!=="none"){p(e,r,d,g);if(!s.hasLines(r))f(e,r,g)}if(r.fill==="tonext"||r.fill==="toself"){x.push("fills")}g("hoveron",x.join("+")||"points");var b=a.getComponentMethod("errorbars","supplyDefaults");b(e,r,d,{axis:"y"});b(e,r,d,{axis:"x",inherit:"y"});n.coerceSelectionMarkerOpacity(r,g)}},{"../../lib":684,"../../registry":817,"./attributes":1015,"./constants":1020,"./fillcolor_defaults":1023,"./line_defaults":1027,"./line_shape_defaults":1029,"./marker_defaults":1033,"./subtypes":1037,"./text_defaults":1038,"./xy_defaults":1039}],1022:[function(t,e,r){"use strict";var n=t("../../lib");e.exports=function t(e,r,i){var o=Array.isArray(i)?function(t){i.push(t)}:function(t){i.text=t};var s=n.extractOption(e,r,"htx","hovertext");if(a(s))return o(s);var l=n.extractOption(e,r,"tx","text");if(a(l))return o(l)};function a(t){return t||t===0}},{"../../lib":684}],1023:[function(t,e,r){"use strict";var n=t("../../components/color");var a=t("../../lib").isArrayOrTypedArray;e.exports=function t(e,r,i,o){var s=false;if(r.marker){var l=r.marker.color,u=(r.marker.line||{}).color;if(l&&!a(l)){s=l}else if(u&&!a(u)){s=u}}o("fillcolor",n.addOpacity((r.line||{}).color||s||i,.5))}},{"../../components/color":558,"../../lib":684}],1024:[function(t,e,r){"use strict";var n=t("../../components/color");var a=t("./subtypes");e.exports=function t(e,r){var i,o;if(e.mode==="lines"){i=e.line.color;return i&&n.opacity(i)?i:e.fillcolor}else if(e.mode==="none"){return e.fill?e.fillcolor:""}else{var s=r.mcc||(e.marker||{}).color,l=r.mlcc||((e.marker||{}).line||{}).color;o=s&&n.opacity(s)?s:l&&n.opacity(l)&&(r.mlw||((e.marker||{}).line||{}).width)?l:"";if(o){if(n.opacity(o)<.3){return n.addOpacity(o,.3)}else return o}else{i=(e.line||{}).color;return i&&n.opacity(i)&&a.hasLines(e)&&e.line.width?i:e.fillcolor}}}},{"../../components/color":558,"./subtypes":1037}],1025:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../components/fx");var i=t("../../registry");var o=t("./get_trace_color");var s=t("../../components/color");var l=t("./fill_hover_text");e.exports=function t(e,r,u,c){var f=e.cd;var h=f[0].trace;var p=e.xa;var d=e.ya;var v=p.c2p(r);var g=d.c2p(u);var m=[v,g];var y=h.hoveron||"";var x=h.mode.indexOf("markers")!==-1?3:.5;if(y.indexOf("points")!==-1){var b=function(t){var e=Math.max(3,t.mrc||0);var r=1-1/e;var n=Math.abs(p.c2p(t.x)-v);var a=n<e?r*n/e:n-e+r;return a};var _=function(t){var e=Math.max(3,t.mrc||0);var r=1-1/e;var n=Math.abs(d.c2p(t.y)-g);return n<e?r*n/e:n-e+r};var w=function(t){var e=Math.max(x,t.mrc||0);var r=p.c2p(t.x)-v;var n=d.c2p(t.y)-g;return Math.max(Math.sqrt(r*r+n*n)-e,1-x/e)};var k=a.getDistanceFunction(c,b,_,w);a.getClosest(f,k,e);if(e.index!==false){var M=f[e.index];var A=p.c2p(M.x,true);var T=d.c2p(M.y,true);var S=M.mrc||1;n.extendFlat(e,{color:o(h,M),x0:A-S,x1:A+S,xLabelVal:M.x,y0:T-S,y1:T+S,yLabelVal:M.y,spikeDistance:w(M)});l(M,h,e);i.getComponentMethod("errorbars","hoverInfo")(M,h,e);return[e]}}if(y.indexOf("fills")!==-1&&h._polygons){var E=h._polygons;var C=[];var L=false;var I=Infinity;var z=-Infinity;var P=Infinity;var O=-Infinity;var D,R,B,F,N,j,V,U,q;for(D=0;D<E.length;D++){B=E[D];if(B.contains(m)){L=!L;C.push(B);P=Math.min(P,B.ymin);O=Math.max(O,B.ymax)}}if(L){P=Math.max(P,0);O=Math.min(O,d._length);var H=(P+O)/2;for(D=0;D<C.length;D++){F=C[D].pts;for(R=1;R<F.length;R++){U=F[R-1][1];q=F[R][1];if(U>H!==q>=H){j=F[R-1][0];V=F[R][0];if(q-U){N=j+(V-j)*(H-U)/(q-U);I=Math.min(I,N);z=Math.max(z,N)}}}}I=Math.max(I,0);z=Math.min(z,p._length);var G=s.defaultLine;if(s.opacity(h.fillcolor))G=h.fillcolor;else if(s.opacity((h.line||{}).color)){G=h.line.color}n.extendFlat(e,{distance:e.maxHoverDistance,x0:I,x1:z,y0:H,y1:H,color:G});delete e.index;if(h.text&&!Array.isArray(h.text)){e.text=String(h.text)}else e.text=h.name;return[e]}}}},{"../../components/color":558,"../../components/fx":600,"../../lib":684,"../../registry":817,"./fill_hover_text":1022,"./get_trace_color":1024}],1026:[function(t,e,r){"use strict";var n={};var a=t("./subtypes");n.hasLines=a.hasLines;n.hasMarkers=a.hasMarkers;n.hasText=a.hasText;n.isBubble=a.isBubble;n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.cleanData=t("./clean_data");n.calc=t("./calc").calc;n.arraysToCalcdata=t("./arrays_to_calcdata");n.plot=t("./plot");n.colorbar=t("./marker_colorbar");n.style=t("./style").style;n.styleOnSelect=t("./style").styleOnSelect;n.hoverPoints=t("./hover");n.selectPoints=t("./select");n.animatable=true;n.moduleType="trace";n.name="scatter";n.basePlotModule=t("../../plots/cartesian");n.categories=["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"];n.meta={};e.exports=n},{"../../plots/cartesian":743,"./arrays_to_calcdata":1014,"./attributes":1015,"./calc":1016,"./clean_data":1018,"./defaults":1021,"./hover":1025,"./marker_colorbar":1032,"./plot":1034,"./select":1035,"./style":1036,"./subtypes":1037}],1027:[function(t,e,r){"use strict";var n=t("../../lib").isArrayOrTypedArray;var a=t("../../components/colorscale/has_colorscale");var i=t("../../components/colorscale/defaults");e.exports=function t(e,r,o,s,l,u){var c=(e.marker||{}).color;l("line.color",o);if(a(e,"line")){i(e,r,s,l,{prefix:"line.",cLetter:"c"})}else{var f=(n(c)?false:c)||o;l("line.color",f)}l("line.width");if(!(u||{}).noDash)l("line.dash")}},{"../../components/colorscale/defaults":568,"../../components/colorscale/has_colorscale":572,"../../lib":684}],1028:[function(t,e,r){"use strict";var n=t("../../constants/numerical").BADNUM;var a=t("../../lib");var i=a.segmentsIntersect;var o=a.constrain;var s=t("./constants");e.exports=function t(e,r){var l=r.xaxis;var u=r.yaxis;var c=r.simplify;var f=r.connectGaps;var h=r.baseTolerance;var p=r.shape;var d=p==="linear";var v=[];var g=s.minTolerance;var m=new Array(e.length);var y=0;var x;var b,_,w,k;var M;var A;var T;var S;var E,C,L,I;var z,P,O;if(!c){h=g=-1}function D(t){var r=e[t];if(!r)return false;var a=l.c2p(r.x);var i=u.c2p(r.y);if(a===n||i===n)return r.intoCenter||false;return[a,i]}function R(t,e,r,n){var a=r-t;var i=n-e;var o=.5-t;var s=.5-e;var l=a*a+i*i;var u=a*o+i*s;if(u>0&&u<l){var c=o*i-s*a;if(c*c<l)return true}}var B,F;function N(t,e){var r=t[0]/l._length;var n=t[1]/u._length;var a=Math.max(0,-r,r-1,-n,n-1);if(a&&B!==undefined&&R(r,n,B,F)){a=0}if(a&&e&&R(r,n,e[0]/l._length,e[1]/u._length)){a=0}return(1+s.toleranceGrowth*a)*h}function j(t,e){var r=t[0]-e[0];var n=t[1]-e[1];return Math.sqrt(r*r+n*n)}var V=s.maxScreensAway;var U=-l._length*V;var q=l._length*(1+V);var H=-u._length*V;var G=u._length*(1+V);var W=[[U,H,q,H],[q,H,q,G],[q,G,U,G],[U,G,U,H]];var Y,X,Z,$,J,K;function Q(t,e){var r=[];var n=0;for(var a=0;a<4;a++){var o=W[a];var s=i(t[0],t[1],e[0],e[1],o[0],o[1],o[2],o[3]);if(s&&(!n||Math.abs(s.x-r[0][0])>1||Math.abs(s.y-r[0][1])>1)){s=[s.x,s.y];if(n&&j(s,t)<j(r[0],t))r.unshift(s);else r.push(s);n++}}return r}function tt(t){if(t[0]<U||t[0]>q||t[1]<H||t[1]>G){return[o(t[0],U,q),o(t[1],H,G)]}}function et(t,e){if(t[0]===e[0]&&(t[0]===U||t[0]===q))return true;if(t[1]===e[1]&&(t[1]===H||t[1]===G))return true}function rt(t,e){var r=[];var n=tt(t);var a=tt(e);if(n&&a&&et(n,a))return r;if(n)r.push(n);if(a)r.push(a);return r}function nt(t,e,r){return function(n,i){var o=tt(n);var s=tt(i);var l=[];if(o&&s&&et(o,s))return l;if(o)l.push(o);if(s)l.push(s);var u=2*a.constrain((n[t]+i[t])/2,e,r)-((o||n)[t]+(s||i)[t]);if(u){var c;if(o&&s){c=u>0===o[t]>s[t]?o:s}else c=o||s;c[t]+=u}return l}}var at;if(p==="linear"||p==="spline"){at=Q}else if(p==="hv"||p==="vh"){at=rt}else if(p==="hvh")at=nt(0,U,q);else if(p==="vhv")at=nt(1,H,G);function it(t,e){var r=e[0]-t[0];var n=(e[1]-t[1])/r;var a=(t[1]*e[0]-e[1]*t[0])/r;if(a>0)return[n>0?U:q,G];else return[n>0?q:U,H]}function ot(t){var e=t[0];var r=t[1];var n=e===m[y-1][0];var a=r===m[y-1][1];if(n&&a)return;if(y>1){var i=e===m[y-2][0];var o=r===m[y-2][1];if(n&&(e===U||e===q)&&i){if(o)y--;else m[y-1]=t}else if(a&&(r===H||r===G)&&o){if(i)y--;else m[y-1]=t}else m[y++]=t}else m[y++]=t}function st(t){if(m[y-1][0]!==t[0]&&m[y-1][1]!==t[1]){ot([Z,$])}ot(t);J=null;Z=$=0}function lt(t){B=t[0]/l._length;F=t[1]/u._length;Y=t[0]<U?U:t[0]>q?q:0;X=t[1]<H?H:t[1]>G?G:0;if(Y||X){if(!y){m[y++]=[Y||t[0],X||t[1]]}else if(J){var e=at(J,t);if(e.length>1){st(e[0]);m[y++]=e[1]}}else{K=at(m[y-1],t)[0];m[y++]=K}var r=m[y-1];if(Y&&X&&(r[0]!==Y||r[1]!==X)){if(J){if(Z!==Y&&$!==X){if(Z&&$){ot(it(J,t))}else{ot([Z||Y,$||X])}}else if(Z&&$){ot([Z,$])}}ot([Y,X])}else if(Z-Y&&$-X){ot([Y||Z,X||$])}J=t;Z=Y;$=X}else{if(J){st(at(J,t)[0])}m[y++]=t}}for(x=0;x<e.length;x++){b=D(x);if(!b)continue;y=0;J=null;lt(b);for(x++;x<e.length;x++){w=D(x);if(!w){if(f)continue;else break}if(!d){lt(w);continue}var ut=D(x+1);E=j(w,b);if(E<N(w,ut)*g)continue;T=[(w[0]-b[0])/E,(w[1]-b[1])/E];k=b;C=E;L=z=P=0;A=false;_=w;for(x++;x<e.length;x++){M=ut;ut=D(x+1);if(!M){if(f)continue;else break}S=[M[0]-b[0],M[1]-b[1]];O=S[0]*T[1]-S[1]*T[0];z=Math.min(z,O);P=Math.max(P,O);if(P-z>N(M,ut))break;_=M;I=S[0]*T[0]+S[1]*T[1];if(I>C){C=I;w=M;A=false}else if(I<L){L=I;k=M;A=true}}if(A){lt(w);if(_!==k)lt(k)}else{if(k!==b)lt(k);if(_!==w)lt(w)}lt(_);if(x>=e.length||!M)break;lt(M);b=M}if(J)ot([Z||J[0],$||J[1]]);v.push(m.slice(0,y))}return v}},{"../../constants/numerical":661,"../../lib":684,"./constants":1020}],1029:[function(t,e,r){"use strict";e.exports=function t(e,r,n){var a=n("line.shape");if(a==="spline")n("line.smoothing")}},{}],1030:[function(t,e,r){"use strict";e.exports=function t(e,r,n){var a,i;var o=null;for(i=0;i<n.length;++i){a=n[i][0].trace;if(a.visible===true){a._nexttrace=null;if(["tonextx","tonexty","tonext"].indexOf(a.fill)!==-1){a._prevtrace=o;if(o){o._nexttrace=a}}o=a}else{a._prevtrace=a._nexttrace=null}}}},{}],1031:[function(t,e,r){"use strict";var n=t("fast-isnumeric");e.exports=function t(e){var r=e.marker,a=r.sizeref||1,i=r.sizemin||0;var o=r.sizemode==="area"?function(t){return Math.sqrt(t/a)}:function(t){return t/a};return function(t){var e=o(t/2);return n(e)&&e>0?Math.max(e,i):0}}},{"fast-isnumeric":214}],1032:[function(t,e,r){"use strict";e.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1033:[function(t,e,r){"use strict";var n=t("../../components/color");var a=t("../../components/colorscale/has_colorscale");var i=t("../../components/colorscale/defaults");var o=t("./subtypes");e.exports=function t(e,r,s,l,u,c){var f=o.isBubble(e),h=(e.line||{}).color,p;c=c||{};if(h)s=h;u("marker.symbol");u("marker.opacity",f?.7:1);u("marker.size");u("marker.color",s);if(a(e,"marker")){i(e,r,l,u,{prefix:"marker.",cLetter:"c"})}if(!c.noSelect){u("selected.marker.color");u("unselected.marker.color");u("selected.marker.size");u("unselected.marker.size")}if(!c.noLine){if(h&&!Array.isArray(h)&&r.marker.color!==h){p=h}else if(f)p=n.background;else p=n.defaultLine;u("marker.line.color",p);if(a(e,"marker.line")){i(e,r,l,u,{prefix:"marker.line.",cLetter:"c"})}u("marker.line.width",f?1:0)}if(f){u("marker.sizeref");u("marker.sizemin");u("marker.sizemode")}if(c.gradient){var d=u("marker.gradient.type");if(d!=="none"){u("marker.gradient.color")}}}},{"../../components/color":558,"../../components/colorscale/defaults":568,"../../components/colorscale/has_colorscale":572,"./subtypes":1037}],1034:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../registry");var i=t("../../lib");var o=t("../../components/drawing");var s=t("./subtypes");var l=t("./line_points");var u=t("./link_traces");var c=t("../../lib/polygon").tester;e.exports=function t(e,r,a,i,o,s){var l,c,p,d;var v=!o;var g=!!o&&o.duration>0;p=i.selectAll("g.trace").data(a,function(t){return t[0].trace.uid});p.enter().append("g").attr("class",function(t){return"trace scatter trace"+t[0].trace.uid}).style("stroke-miterlimit",2);u(e,r,a);f(e,i,r);for(l=0,c={};l<a.length;l++){c[a[l][0].trace.uid]=l}i.selectAll("g.trace").sort(function(t,e){var r=c[t[0].trace.uid];var n=c[e[0].trace.uid];return r>n?1:-1});if(g){if(s){d=s()}var m=n.transition().duration(o.duration).ease(o.easing).each("end",function(){d&&d()}).each("interrupt",function(){d&&d()});m.each(function(){i.selectAll("g.trace").each(function(t,n){h(e,n,r,t,a,this,o)})})}else{i.selectAll("g.trace").each(function(t,n){h(e,n,r,t,a,this,o)})}if(v){p.exit().remove()}i.selectAll("path:not([d])").remove()};function f(t,e,r){var a;e.selectAll("g.trace").each(function(t){var e=n.select(this);a=t[0].trace;if(a._nexttrace){a._nextFill=e.select(".js-fill.js-tonext");if(!a._nextFill.size()){var i=":first-child";if(e.select(".js-fill.js-tozero").size()){i+=" + *"}a._nextFill=e.insert("path",i).attr("class","js-fill js-tonext")}}else{e.selectAll(".js-fill.js-tonext").remove();a._nextFill=null}if(a.fill&&(a.fill.substr(0,6)==="tozero"||a.fill==="toself"||a.fill.substr(0,2)==="to"&&!a._prevtrace)){a._ownFill=e.select(".js-fill.js-tozero");if(!a._ownFill.size()){a._ownFill=e.insert("path",":first-child").attr("class","js-fill js-tozero")}}else{e.selectAll(".js-fill.js-tozero").remove();a._ownFill=null}e.selectAll(".js-fill").call(o.setClipUrl,r.layerClipId)})}function h(t,e,r,u,f,h,d){var v,g;p(t,e,r,u,f);var m=!!d&&d.duration>0;function y(t){return m?t.transition():t}var x=r.xaxis,b=r.yaxis;var _=u[0].trace,w=_.line,k=n.select(h);a.getComponentMethod("errorbars","plot")(k,r,d);if(_.visible!==true)return;y(k).style("opacity",_.opacity);var M,A;var T=_.fill.charAt(_.fill.length-1);if(T!=="x"&&T!=="y")T="";if(!r.isRangePlot)u[0].node3=k;var S="";var E=[];var C=_._prevtrace;if(C){S=C._prevRevpath||"";A=C._nextFill;E=C._polygons}var L,I,z="",P="",O,D,R,B,F,N,j;var V=[],U=i.noop;M=_._ownFill;if(s.hasLines(_)||_.fill!=="none"){if(A){A.datum(u)}if(["hv","vh","hvh","vhv"].indexOf(w.shape)!==-1){O=o.steps(w.shape);D=o.steps(w.shape.split("").reverse().join(""))}else if(w.shape==="spline"){O=D=function(t){var e=t[t.length-1];if(t.length>1&&t[0][0]===e[0]&&t[0][1]===e[1]){return o.smoothclosed(t.slice(1),w.smoothing)}else{return o.smoothopen(t,w.smoothing)}}}else{O=D=function(t){return"M"+t.join("L")}}R=function(t){return D(t.reverse())};V=l(u,{xaxis:x,yaxis:b,connectGaps:_.connectgaps,baseTolerance:Math.max(w.width||1,3)/4,shape:w.shape,simplify:w.simplify});j=_._polygons=new Array(V.length);for(g=0;g<V.length;g++){_._polygons[g]=c(V[g])}if(V.length){B=V[0][0];F=V[V.length-1];N=F[F.length-1]}U=function(t){return function(e){L=O(e);I=R(e);if(!z){z=L;P=I}else if(T){z+="L"+L.substr(1);P=I+("L"+P.substr(1))}else{z+="Z"+L;P=I+"Z"+P}if(s.hasLines(_)&&e.length>1){var r=n.select(this);r.datum(u);if(t){y(r.style("opacity",0).attr("d",L).call(o.lineGroupStyle)).style("opacity",1)}else{var a=y(r);a.attr("d",L);o.singleLineStyle(u,a)}}}}}var q=k.selectAll(".js-line").data(V);y(q.exit()).style("opacity",0).remove();q.each(U(false));q.enter().append("path").classed("js-line",true).style("vector-effect","non-scaling-stroke").call(o.lineGroupStyle).each(U(true));o.setClipUrl(q,r.layerClipId);function H(t){y(t).attr("d","M0,0Z")}if(V.length){if(M){if(B&&N){if(T){if(T==="y"){B[1]=N[1]=b.c2p(0,true)}else if(T==="x"){B[0]=N[0]=x.c2p(0,true)}y(M).attr("d","M"+N+"L"+B+"L"+z.substr(1)).call(o.singleFillStyle)}else{y(M).attr("d",z+"Z").call(o.singleFillStyle)}}}else if(A){if(_.fill.substr(0,6)==="tonext"&&z&&S){if(_.fill==="tonext"){y(A).attr("d",z+"Z"+S+"Z").call(o.singleFillStyle)}else{y(A).attr("d",z+"L"+S.substr(1)+"Z").call(o.singleFillStyle)}_._polygons=_._polygons.concat(E)}else{H(A);_._polygons=null}}_._prevRevpath=P;_._prevPolygons=j}else{if(M)H(M);else if(A)H(A);_._polygons=_._prevRevpath=_._prevPolygons=null}function G(t){return t.filter(function(t){return t.vis})}function W(t){return t.id}function Y(t){if(t.ids){return W}}function X(){return false}function Z(e){var a,l,u;var c=e[0].trace;var f=n.select(this);var h=s.hasMarkers(c);var p=s.hasText(c);var d=Y(c);var v=X;var g=X;if(h){v=c.marker.maxdisplayed||c._needsCull?G:i.identity}if(p){g=c.marker.maxdisplayed||c._needsCull?G:i.identity}l=f.selectAll("path.point");a=l.data(v,d);var _=a.enter().append("path").classed("point",true);if(m){_.call(o.pointStyle,c,t).call(o.translatePoints,x,b).style("opacity",0).transition().style("opacity",1)}a.order();var w;if(h){w=o.makePointStyleFns(c)}a.each(function(e){var a=n.select(this);var i=y(a);u=o.translatePoint(e,i,x,b);if(u){o.singlePointStyle(e,i,c,w,t);if(r.layerClipId){o.hideOutsideRangePoint(e,i,x,b,c.xcalendar,c.ycalendar)}if(c.customdata){a.classed("plotly-customdata",e.data!==null&&e.data!==undefined)}}else{i.remove()}});if(m){a.exit().transition().style("opacity",0).remove()}else{a.exit().remove()}l=f.selectAll("g");a=l.data(g,d);a.enter().append("g").classed("textpoint",true).append("text");a.order();a.each(function(t){var e=n.select(this);var a=y(e.select("text"));u=o.translatePoint(t,a,x,b);if(u){if(r.layerClipId){o.hideOutsideRangePoint(t,e,x,b,c.xcalendar,c.ycalendar)}}else{e.remove()}});a.selectAll("text").call(o.textPointStyle,c,t).each(function(t){var e=x.c2p(t.x);var r=b.c2p(t.y);n.select(this).selectAll("tspan.line").each(function(){y(n.select(this)).attr({x:e,y:r})})});a.exit().remove()}var $=k.selectAll(".points");v=$.data([u]);$.each(Z);v.enter().append("g").classed("points",true).each(Z);v.exit().remove();v.each(function(t){var e=t[0].trace.cliponaxis===false;o.setClipUrl(n.select(this),e?null:r.layerClipId)})}function p(t,e,r,a,o){var l=r.xaxis,u=r.yaxis,c=n.extent(i.simpleMap(l.range,l.r2c)),f=n.extent(i.simpleMap(u.range,u.r2c));var h=a[0].trace;if(!s.hasMarkers(h))return;var p=h.marker.maxdisplayed;if(p===0)return;var d=a.filter(function(t){return t.x>=c[0]&&t.x<=c[1]&&t.y>=f[0]&&t.y<=f[1]}),v=Math.ceil(d.length/p),g=0;o.forEach(function(t,r){var n=t[0].trace;if(s.hasMarkers(n)&&n.marker.maxdisplayed>0&&r<e){g++}});var m=Math.round(g*v/3+Math.floor(g/3)*v/7.1);a.forEach(function(t){delete t.vis});d.forEach(function(t,e){if(Math.round((e+m)%v)===0)t.vis=true})}},{"../../components/drawing":583,"../../lib":684,"../../lib/polygon":696,"../../registry":817,"./line_points":1028,"./link_traces":1030,"./subtypes":1037,d3:147}],1035:[function(t,e,r){"use strict";var n=t("./subtypes");e.exports=function t(e,r){var a=e.cd,i=e.xaxis,o=e.yaxis,s=[],l=a[0].trace,u,c,f,h;var p=!n.hasMarkers(l)&&!n.hasText(l);if(p)return[];if(r===false){for(u=0;u<a.length;u++){a[u].selected=0}}else{for(u=0;u<a.length;u++){c=a[u];f=i.c2p(c.x);h=o.c2p(c.y);if(r.contains([f,h])){s.push({pointNumber:u,x:i.c2d(c.x),y:o.c2d(c.y)});c.selected=1}else{c.selected=0}}}return s}},{"./subtypes":1037}],1036:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/drawing");var i=t("../../registry");function o(t,e){var r=e?e[0].node3:n.select(t).selectAll("g.trace.scatter");r.style("opacity",function(t){return t[0].trace.opacity});r.selectAll("g.points").each(function(e){var r=n.select(this);var a=e.trace||e[0].trace;s(r,a,t)});r.selectAll("g.trace path.js-line").call(a.lineGroupStyle);r.selectAll("g.trace path.js-fill").call(a.fillGroupStyle);i.getComponentMethod("errorbars","style")(r)}function s(t,e,r){a.pointStyle(t.selectAll("path.point"),e,r);a.textPointStyle(t.selectAll("text"),e,r)}function l(t,e){var r=e[0].node3;var n=e[0].trace;if(n.selectedpoints){a.selectedPointStyle(r.selectAll("path.point"),n);a.selectedTextStyle(r.selectAll("text"),n)}else{s(r,n,t)}}e.exports={style:o,stylePoints:s,styleOnSelect:l}},{"../../components/drawing":583,"../../registry":817,d3:147}],1037:[function(t,e,r){"use strict";var n=t("../../lib");e.exports={hasLines:function(t){return t.visible&&t.mode&&t.mode.indexOf("lines")!==-1},hasMarkers:function(t){return t.visible&&(t.mode&&t.mode.indexOf("markers")!==-1||t.type==="splom")},hasText:function(t){return t.visible&&t.mode&&t.mode.indexOf("text")!==-1},isBubble:function(t){return n.isPlainObject(t.marker)&&n.isArrayOrTypedArray(t.marker.size)}}},{"../../lib":684}],1038:[function(t,e,r){"use strict";var n=t("../../lib");e.exports=function(t,e,r,a,i){i=i||{};a("textposition");n.coerceFont(a,"textfont",r.font);if(!i.noSelect){a("selected.textfont.color");a("unselected.textfont.color")}}},{"../../lib":684}],1039:[function(t,e,r){"use strict";var n=t("../../registry");e.exports=function t(e,r,a,i){var o,s=i("x"),l=i("y");var u=n.getComponentMethod("calendars","handleTraceDefaults");u(e,r,["x","y"],a);if(s){if(l){o=Math.min(s.length,l.length)}else{o=s.length;i("y0");i("dy")}}else{if(!l)return 0;o=r.y.length;i("x0");i("dx")}r._length=o;return o}},{"../../registry":817}],1040:[function(t,e,r){"use strict";var n=t("../scatter/attributes");var a=t("../../components/colorscale/attributes");var i=t("../../plots/attributes");var o=t("../../constants/gl3d_dashes");var s=t("../../constants/gl3d_markers");var l=t("../../lib/extend").extendFlat;var u=t("../../plot_api/edit_types").overrideAll;var c=n.line;var f=n.marker;var h=f.line;function p(t){return{show:{valType:"boolean",dflt:false},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var d=e.exports=u({x:n.x,y:n.y,z:{valType:"data_array"},text:l({},n.text,{}),hovertext:l({},n.hovertext,{}),mode:l({},n.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:p("x"),y:p("y"),z:p("z")},connectgaps:n.connectgaps,line:l({width:c.width,dash:{valType:"enumerated",values:Object.keys(o),dflt:"solid"}},a("line")),marker:l({symbol:{valType:"enumerated",values:Object.keys(s),dflt:"circle",arrayOk:true},size:l({},f.size,{dflt:8}),sizeref:f.sizeref,sizemin:f.sizemin,sizemode:f.sizemode,opacity:l({},f.opacity,{arrayOk:false}),colorbar:f.colorbar,line:l({width:l({},h.width,{arrayOk:false})},a("marker.line"))},a("marker")),textposition:l({},n.textposition,{dflt:"top center"}),textfont:n.textfont,hoverinfo:l({},i.hoverinfo)},"calc","nested");d.x.editType=d.y.editType=d.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":565,"../../constants/gl3d_dashes":658,"../../constants/gl3d_markers":659,"../../lib/extend":673,"../../plot_api/edit_types":715,"../../plots/attributes":729,"../scatter/attributes":1015}],1041:[function(t,e,r){"use strict";var n=t("../scatter/arrays_to_calcdata");var a=t("../scatter/colorscale_calc");e.exports=function t(e,r){var i=[{x:false,y:false,trace:r,t:{}}];n(i,r);a(r);return i}},{"../scatter/arrays_to_calcdata":1014,"../scatter/colorscale_calc":1019}],1042:[function(t,e,r){"use strict";var n=t("../../registry");function a(t,e,r){if(!e||!e.visible)return null;var a=n.getComponentMethod("errorbars","makeComputeError")(e);var i=new Array(t.length);for(var o=0;o<t.length;o++){var s=a(+t[o],o);i[o]=[-s[0]*r,s[1]*r]}return i}function i(t){for(var e=0;e<t.length;e++){if(t[e])return t[e].length}return 0}function o(t,e){var r=[a(t.x,t.error_x,e[0]),a(t.y,t.error_y,e[1]),a(t.z,t.error_z,e[2])];var n=i(r);if(n===0)return null;var o=new Array(n);for(var s=0;s<n;s++){var l=[[0,0,0],[0,0,0]];for(var u=0;u<3;u++){if(r[u]){for(var c=0;c<2;c++){l[c][u]=r[u][s][c]}}}o[s]=l}return o}e.exports=o},{"../../registry":817}],1043:[function(t,e,r){"use strict";var n=t("gl-line3d");var a=t("gl-scatter3d");var i=t("gl-error3d");var o=t("gl-mesh3d");var s=t("delaunay-triangulate");var l=t("../../lib");var u=t("../../lib/str2rgbarray");var c=t("../../lib/gl_format_color").formatColor;var f=t("../scatter/make_bubble_size_func");var h=t("../../constants/gl3d_dashes");var p=t("../../constants/gl3d_markers");var d=t("./calc_errors");function v(t,e){this.scene=t;this.uid=e;this.linePlot=null;this.scatterPlot=null;this.errorBars=null;this.textMarkers=null;this.delaunayMesh=null;this.color=null;this.mode="";this.dataPoints=[];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.textLabels=null;this.data=null}var g=v.prototype;g.handlePick=function(t){if(t.object&&(t.object===this.linePlot||t.object===this.delaunayMesh||t.object===this.textMarkers||t.object===this.scatterPlot)){var e=t.index=t.data.index;if(t.object.highlight){t.object.highlight(null)}if(this.scatterPlot){t.object=this.scatterPlot;this.scatterPlot.highlight(t.data)}t.textLabel="";if(this.textLabels){if(Array.isArray(this.textLabels)){if(this.textLabels[e]||this.textLabels[e]===0){t.textLabel=this.textLabels[e]}}else{t.textLabel=this.textLabels}}t.traceCoordinate=[this.data.x[e],this.data.y[e],this.data.z[e]];return true}};function m(t,e,r){var n=(r+1)%3;var a=(r+2)%3;var i=[];var o=[];var l;for(l=0;l<t.length;++l){var u=t[l];if(isNaN(u[n])||!isFinite(u[n])||isNaN(u[a])||!isFinite(u[a])){continue}i.push([u[n],u[a]]);o.push(l)}var c=s(i);for(l=0;l<c.length;++l){var f=c[l];for(var h=0;h<f.length;++h){f[h]=o[f[h]]}}return{positions:t,cells:c,meshColor:e}}function y(t){var e=[0,0,0],r=[[0,0,0],[0,0,0],[0,0,0]],n=[0,0,0];for(var a=0;a<3;a++){var i=t[a];if(i&&i.copy_zstyle!==false)i=t[2];if(!i)continue;e[a]=i.width/2;r[a]=u(i.color);n=i.thickness}return{capSize:e,color:r,lineWidth:n}}function x(t){var e=[0,0];if(Array.isArray(t))return[0,-1];if(t.indexOf("bottom")>=0)e[1]+=1;if(t.indexOf("top")>=0)e[1]-=1;if(t.indexOf("left")>=0)e[0]-=1;if(t.indexOf("right")>=0)e[0]+=1;return e}function b(t,e){return e(t*4)}function _(t){return p[t]}function w(t,e,r,n,a){var i=null;if(l.isArrayOrTypedArray(t)){i=[];for(var o=0;o<e;o++){if(t[o]===undefined)i[o]=n;else i[o]=r(t[o],a)}}else i=r(t,l.identity);return i}function k(t,e){var r,n,a=[],i=t.fullSceneLayout,o=t.dataScale,s=i.xaxis,h=i.yaxis,p=i.zaxis,v=e.marker,g=e.line,m,k=e.x||[],M,A=e.y||[],T,S=e.z||[],E=k.length,C=e.xcalendar,L=e.ycalendar,I=e.zcalendar,z;for(n=0;n<E;n++){m=s.d2l(k[n],0,C)*o[0];M=h.d2l(A[n],0,L)*o[1];T=p.d2l(S[n],0,I)*o[2];a[n]=[m,M,T]}if(Array.isArray(e.text))z=e.text;else if(e.text!==undefined){z=new Array(E);for(n=0;n<E;n++)z[n]=e.text}r={position:a,mode:e.mode,text:z};if("line"in e){r.lineColor=c(g,1,E);r.lineWidth=g.width;r.lineDashes=g.dash}if("marker"in e){var P=f(e);r.scatterColor=c(v,1,E);r.scatterSize=w(v.size,E,b,20,P);r.scatterMarker=w(v.symbol,E,_,"\u25cf");r.scatterLineWidth=v.line.width;r.scatterLineColor=c(v.line,1,E);r.scatterAngle=0}if("textposition"in e){r.textOffset=x(e.textposition);r.textColor=c(e.textfont,1,E);r.textSize=w(e.textfont.size,E,l.identity,12);r.textFont=e.textfont.family;r.textAngle=0}var O=["x","y","z"];r.project=[false,false,false];r.projectScale=[1,1,1];r.projectOpacity=[1,1,1];for(n=0;n<3;++n){var D=e.projection[O[n]];if(r.project[n]=D.show){r.projectOpacity[n]=D.opacity;r.projectScale[n]=D.scale}}r.errorBounds=d(e,o);var R=y([e.error_x,e.error_y,e.error_z]);r.errorColor=R.color;r.errorLineWidth=R.lineWidth;r.errorCapSize=R.capSize;r.delaunayAxis=e.surfaceaxis;r.delaunayColor=u(e.surfacecolor);return r}function M(t){if(Array.isArray(t)){var e=t[0];if(Array.isArray(e))t=e;return"rgb("+t.slice(0,3).map(function(t){return Math.round(t*255)})+")"}return null}g.update=function(t){var e=this.scene.glplot.gl,r,s,l,u,c=h.solid;this.data=t;var f=k(this.scene,t);if("mode"in f){this.mode=f.mode}if("lineDashes"in f){if(f.lineDashes in h){c=h[f.lineDashes]}}this.color=M(f.scatterColor)||M(f.lineColor);this.dataPoints=f.position;r={gl:e,position:f.position,color:f.lineColor,lineWidth:f.lineWidth||1,dashes:c[0],dashScale:c[1],opacity:t.opacity,connectGaps:t.connectgaps};if(this.mode.indexOf("lines")!==-1){if(this.linePlot)this.linePlot.update(r);else{this.linePlot=n(r);this.linePlot._trace=this;this.scene.glplot.add(this.linePlot)}}else if(this.linePlot){this.scene.glplot.remove(this.linePlot);this.linePlot.dispose();this.linePlot=null}var p=t.opacity;if(t.marker&&t.marker.opacity)p*=t.marker.opacity;s={gl:e,position:f.position,color:f.scatterColor,size:f.scatterSize,glyph:f.scatterMarker,opacity:p,orthographic:true,lineWidth:f.scatterLineWidth,lineColor:f.scatterLineColor,project:f.project,projectScale:f.projectScale,projectOpacity:f.projectOpacity};if(this.mode.indexOf("markers")!==-1){if(this.scatterPlot)this.scatterPlot.update(s);else{this.scatterPlot=a(s);this.scatterPlot._trace=this;this.scatterPlot.highlightScale=1;this.scene.glplot.add(this.scatterPlot)}}else if(this.scatterPlot){this.scene.glplot.remove(this.scatterPlot);this.scatterPlot.dispose();this.scatterPlot=null}u={gl:e,position:f.position,glyph:f.text,color:f.textColor,size:f.textSize,angle:f.textAngle,alignment:f.textOffset,font:f.textFont,orthographic:true,lineWidth:0,project:false,opacity:t.opacity};this.textLabels=t.hovertext||t.text;if(this.mode.indexOf("text")!==-1){if(this.textMarkers)this.textMarkers.update(u);else{this.textMarkers=a(u);this.textMarkers._trace=this;this.textMarkers.highlightScale=1;this.scene.glplot.add(this.textMarkers)}}else if(this.textMarkers){this.scene.glplot.remove(this.textMarkers);this.textMarkers.dispose();this.textMarkers=null}l={gl:e,position:f.position,color:f.errorColor,error:f.errorBounds,lineWidth:f.errorLineWidth,capSize:f.errorCapSize,opacity:t.opacity};if(this.errorBars){if(f.errorBounds){this.errorBars.update(l)}else{this.scene.glplot.remove(this.errorBars);this.errorBars.dispose();this.errorBars=null}}else if(f.errorBounds){this.errorBars=i(l);this.errorBars._trace=this;this.scene.glplot.add(this.errorBars)}if(f.delaunayAxis>=0){var d=m(f.position,f.delaunayColor,f.delaunayAxis);d.opacity=t.opacity;if(this.delaunayMesh){this.delaunayMesh.update(d)}else{d.gl=e;this.delaunayMesh=o(d);this.delaunayMesh._trace=this;this.scene.glplot.add(this.delaunayMesh)}}else if(this.delaunayMesh){this.scene.glplot.remove(this.delaunayMesh);this.delaunayMesh.dispose();this.delaunayMesh=null}};g.dispose=function(){if(this.linePlot){this.scene.glplot.remove(this.linePlot);this.linePlot.dispose()}if(this.scatterPlot){this.scene.glplot.remove(this.scatterPlot);this.scatterPlot.dispose()}if(this.errorBars){this.scene.glplot.remove(this.errorBars);this.errorBars.dispose()}if(this.textMarkers){this.scene.glplot.remove(this.textMarkers);this.textMarkers.dispose()}if(this.delaunayMesh){this.scene.glplot.remove(this.delaunayMesh);this.delaunayMesh.dispose()}};function A(t,e){var r=new v(t,e.uid);r.update(e);return r}e.exports=A},{"../../constants/gl3d_dashes":658,"../../constants/gl3d_markers":659,"../../lib":684,"../../lib/gl_format_color":680,"../../lib/str2rgbarray":707,"../scatter/make_bubble_size_func":1031,"./calc_errors":1042,"delaunay-triangulate":149,"gl-error3d":237,"gl-line3d":245,"gl-mesh3d":268,"gl-scatter3d":283}],1044:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");var i=t("../scatter/subtypes");var o=t("../scatter/marker_defaults");var s=t("../scatter/line_defaults");var l=t("../scatter/text_defaults");var u=t("./attributes");e.exports=function t(e,r,f,h){function p(t,n){return a.coerce(e,r,u,t,n)}var d=c(e,r,p,h);if(!d){r.visible=false;return}p("text");p("hovertext");p("mode");if(i.hasLines(r)){p("connectgaps");s(e,r,f,h,p)}if(i.hasMarkers(r)){o(e,r,f,h,p,{noSelect:true})}if(i.hasText(r)){l(e,r,h,p,{noSelect:true})}var v=(r.line||{}).color,g=(r.marker||{}).color;if(p("surfaceaxis")>=0)p("surfacecolor",v||g);var m=["x","y","z"];for(var y=0;y<3;++y){var x="projection."+m[y];if(p(x+".show")){p(x+".opacity");p(x+".scale")}}var b=n.getComponentMethod("errorbars","supplyDefaults");b(e,r,f,{axis:"z"});b(e,r,f,{axis:"y",inherit:"z"});b(e,r,f,{axis:"x",inherit:"z"})};function c(t,e,r,a){var i=0,o=r("x"),s=r("y"),l=r("z");var u=n.getComponentMethod("calendars","handleTraceDefaults");u(t,e,["x","y","z"],a);if(o&&s&&l){i=Math.min(o.length,s.length,l.length);e._length=e._xlength=e._ylength=e._zlength=i}return i}},{"../../lib":684,"../../registry":817,"../scatter/line_defaults":1027,"../scatter/marker_defaults":1033,"../scatter/subtypes":1037,"../scatter/text_defaults":1038,"./attributes":1040}],1045:[function(t,e,r){"use strict";var n={};n.plot=t("./convert");n.attributes=t("./attributes");n.markerSymbols=t("../../constants/gl3d_markers");n.supplyDefaults=t("./defaults");n.colorbar=t("../scatter/marker_colorbar");n.calc=t("./calc");n.moduleType="trace";n.name="scatter3d";n.basePlotModule=t("../../plots/gl3d");n.categories=["gl3d","symbols","showLegend"];n.meta={};e.exports=n},{"../../constants/gl3d_markers":659,"../../plots/gl3d":774,"../scatter/marker_colorbar":1032,"./attributes":1040,"./calc":1041,"./convert":1043,"./defaults":1044}],1046:[function(t,e,r){"use strict";var n=t("../scatter/attributes");var a=t("../../plots/attributes");var i=t("../../components/colorscale/attributes");var o=t("../../components/colorbar/attributes");var s=t("../../lib/extend").extendFlat;var l=n.marker,u=n.line,c=l.line;e.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:s({},n.mode,{dflt:"markers"}),text:s({},n.text,{}),line:{color:u.color,width:u.width,dash:u.dash,shape:s({},u.shape,{values:["linear","spline"]}),smoothing:u.smoothing,editType:"calc"},connectgaps:n.connectgaps,fill:s({},n.fill,{values:["none","toself","tonext"]}),fillcolor:n.fillcolor,marker:s({symbol:l.symbol,opacity:l.opacity,maxdisplayed:l.maxdisplayed,size:l.size,sizeref:l.sizeref,sizemin:l.sizemin,sizemode:l.sizemode,line:s({width:c.width,editType:"calc"},i("marker.line")),gradient:l.gradient,editType:"calc"},i("marker"),{colorbar:o}),textfont:n.textfont,textposition:n.textposition,selected:n.selected,unselected:n.unselected,hoverinfo:s({},a.hoverinfo,{flags:["a","b","text","name"]}),hoveron:n.hoveron}},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../../plots/attributes":729,"../scatter/attributes":1015}],1047:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../scatter/colorscale_calc");var i=t("../scatter/arrays_to_calcdata");var o=t("../scatter/calc_selection");var s=t("../scatter/calc").calcMarkerSize;var l=t("../carpet/lookup_carpetid");e.exports=function t(e,r){var u=r._carpetTrace=l(e,r);if(!u||!u.visible||u.visible==="legendonly")return;var c;r.xaxis=u.xaxis;r.yaxis=u.yaxis;var f=r._length;var h=new Array(f);var p,d;var v=false;for(c=0;c<f;c++){p=r.a[c];d=r.b[c];if(n(p)&&n(d)){var g=u.ab2xy(+p,+d,true);var m=u.isVisible(+p,+d);if(!m)v=true;h[c]={x:g[0],y:g[1],a:p,b:d,vis:m}}else h[c]={x:false,y:false}}r._needsCull=v;h[0].carpet=u;h[0].trace=r;s(r,f);a(r);i(h,r);o(h,r);return h}},{"../carpet/lookup_carpetid":874,"../scatter/arrays_to_calcdata":1014,"../scatter/calc":1016,"../scatter/calc_selection":1017,"../scatter/colorscale_calc":1019,"fast-isnumeric":214}],1048:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../scatter/constants");var i=t("../scatter/subtypes");var o=t("../scatter/marker_defaults");var s=t("../scatter/line_defaults");var l=t("../scatter/line_shape_defaults");var u=t("../scatter/text_defaults");var c=t("../scatter/fillcolor_defaults");var f=t("./attributes");e.exports=function t(e,r,h,p){function d(t,a){return n.coerce(e,r,f,t,a)}d("carpet");r.xaxis="x";r.yaxis="y";var v=d("a");var g=d("b");var m=Math.min(v.length,g.length);if(!m){r.visible=false;return}r._length=m;d("text");var y=m<a.PTS_LINESONLY?"lines+markers":"lines";d("mode",y);if(i.hasLines(r)){s(e,r,h,p,d);l(e,r,d);d("connectgaps")}if(i.hasMarkers(r)){o(e,r,h,p,d,{gradient:true})}if(i.hasText(r)){u(e,r,p,d)}var x=[];if(i.hasMarkers(r)||i.hasText(r)){d("marker.maxdisplayed");x.push("points")}d("fill");if(r.fill!=="none"){c(e,r,h,d);if(!i.hasLines(r))l(e,r,d)}if(r.fill==="tonext"||r.fill==="toself"){x.push("fills")}d("hoveron",x.join("+")||"points");n.coerceSelectionMarkerOpacity(r,d)}},{"../../lib":684,"../scatter/constants":1020,"../scatter/fillcolor_defaults":1023,"../scatter/line_defaults":1027,"../scatter/line_shape_defaults":1029,"../scatter/marker_defaults":1033,"../scatter/subtypes":1037,"../scatter/text_defaults":1038,"./attributes":1046}],1049:[function(t,e,r){"use strict";e.exports=function t(e,r,n,a,i){var o=a[i];e.a=o.a;e.b=o.b;return e}},{}],1050:[function(t,e,r){"use strict";var n=t("../scatter/hover");e.exports=function t(e,r,a,i){var o=n(e,r,a,i);if(!o||o[0].index===false)return;var s=o[0];if(s.index===undefined){var l=1-s.y0/e.ya._length,u=e.xa._length,c=u*l/2,f=u-c;s.x0=Math.max(Math.min(s.x0,f),c);s.x1=Math.max(Math.min(s.x1,f),c);return o}var h=s.cd[s.index];s.a=h.a;s.b=h.b;s.xLabelVal=undefined;s.yLabelVal=undefined;var p=s.trace;var d=p._carpet;var v=h.hi||p.hoverinfo;var g=v.split("+");var m=[];function y(t,e){var r;if(t.labelprefix&&t.labelprefix.length>0){r=t.labelprefix.replace(/ = $/,"")}else{r=t._hovertitle}m.push(r+": "+e.toFixed(3)+t.labelsuffix)}if(g.indexOf("all")!==-1)g=["a","b"];if(g.indexOf("a")!==-1)y(d.aaxis,h.a);if(g.indexOf("b")!==-1)y(d.baxis,h.b);var x=d.ab2ij([h.a,h.b]);var b=Math.floor(x[0]);var _=x[0]-b;var w=Math.floor(x[1]);var k=x[1]-w;var M=d.evalxy([],b,w,_,k);m.push("y: "+M[1].toFixed(3));s.extraText=m.join("<br>");return o}},{"../scatter/hover":1025}],1051:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.colorbar=t("../scatter/marker_colorbar");n.calc=t("./calc");n.plot=t("./plot");n.style=t("../scatter/style").style;n.styleOnSelect=t("../scatter/style").styleOnSelect;n.hoverPoints=t("./hover");n.selectPoints=t("../scatter/select");n.eventData=t("./event_data");n.moduleType="trace";n.name="scattercarpet";n.basePlotModule=t("../../plots/cartesian");n.categories=["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"];n.meta={};e.exports=n},{"../../plots/cartesian":743,"../scatter/marker_colorbar":1032,"../scatter/select":1035,"../scatter/style":1036,"./attributes":1046,"./calc":1047,"./defaults":1048,"./event_data":1049,"./hover":1050,"./plot":1052}],1052:[function(t,e,r){"use strict";var n=t("../scatter/plot");var a=t("../../plots/cartesian/axes");var i=t("../../components/drawing");e.exports=function t(e,r,o,s){var l,u,c;var f=o[0][0].carpet;var h={xaxis:a.getFromId(e,f.xaxis||"x"),yaxis:a.getFromId(e,f.yaxis||"y"),plot:r.plot};n(e,h,o,s);for(l=0;l<o.length;l++){u=o[l][0].trace;c=s.selectAll("g.trace"+u.uid+" .js-line");i.setClipUrl(c,f._clipPathId)}}},{"../../components/drawing":583,"../../plots/cartesian/axes":732,"../scatter/plot":1034}],1053:[function(t,e,r){"use strict";var n=t("../scatter/attributes");var a=t("../../plots/attributes");var i=t("../../components/colorscale/attributes");var o=t("../../components/drawing/attributes").dash;var s=t("../../lib/extend").extendFlat;var l=t("../../plot_api/edit_types").overrideAll;var u=n.marker,c=n.line,f=u.line;e.exports=l({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names"],dflt:"ISO-3"},mode:s({},n.mode,{dflt:"markers"}),text:s({},n.text,{}),hovertext:s({},n.hovertext,{}),textfont:n.textfont,textposition:n.textposition,line:{color:c.color,width:c.width,dash:o},connectgaps:n.connectgaps,marker:s({symbol:u.symbol,opacity:u.opacity,size:u.size,sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,colorbar:u.colorbar,line:s({width:f.width},i("marker.line")),gradient:u.gradient},i("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:n.fillcolor,selected:n.selected,unselected:n.unselected,hoverinfo:s({},a.hoverinfo,{flags:["lon","lat","location","text","name"]})},"calc","nested")},{"../../components/colorscale/attributes":565,"../../components/drawing/attributes":582,"../../lib/extend":673,"../../plot_api/edit_types":715,"../../plots/attributes":729,"../scatter/attributes":1015}],1054:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../constants/numerical").BADNUM;var i=t("../scatter/colorscale_calc");var o=t("../scatter/arrays_to_calcdata");var s=t("../scatter/calc_selection");var l=t("../../lib")._;e.exports=function t(e,r){var u=Array.isArray(r.locations);var c=u?r.locations.length:r._length;var f=new Array(c);for(var h=0;h<c;h++){var p=f[h]={};if(u){var d=r.locations[h];p.loc=typeof d==="string"?d:null}else{var v=r.lon[h];var g=r.lat[h];if(n(v)&&n(g))p.lonlat=[+v,+g];else p.lonlat=[a,a]}}o(f,r);i(r);s(f,r);if(c){f[0].t={labels:{lat:l(e,"lat:")+" ",lon:l(e,"lon:")+" "}}}return f}},{"../../constants/numerical":661,"../../lib":684,"../scatter/arrays_to_calcdata":1014,"../scatter/calc_selection":1017,"../scatter/colorscale_calc":1019,"fast-isnumeric":214}],1055:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../scatter/subtypes");var i=t("../scatter/marker_defaults");var o=t("../scatter/line_defaults");var s=t("../scatter/text_defaults");var l=t("../scatter/fillcolor_defaults");var u=t("./attributes");e.exports=function t(e,r,f,h){function p(t,a){return n.coerce(e,r,u,t,a)}var d=c(e,r,p);if(!d){r.visible=false;return}p("text");p("hovertext");p("mode");if(a.hasLines(r)){o(e,r,f,h,p);p("connectgaps")}if(a.hasMarkers(r)){i(e,r,f,h,p,{gradient:true})}if(a.hasText(r)){s(e,r,h,p)}p("fill");if(r.fill!=="none"){l(e,r,f,p)}};function c(t,e,r){var n=0,a=r("locations");var i,o;if(a){r("locationmode");n=a.length;return n}i=r("lon")||[];o=r("lat")||[];n=Math.min(i.length,o.length);e._length=n;return n}},{"../../lib":684,"../scatter/fillcolor_defaults":1023,"../scatter/line_defaults":1027,"../scatter/marker_defaults":1033,"../scatter/subtypes":1037,"../scatter/text_defaults":1038,"./attributes":1053}],1056:[function(t,e,r){"use strict";e.exports=function t(e,r){e.lon=r.lon;e.lat=r.lat;e.location=r.loc?r.loc:null;return e}},{}],1057:[function(t,e,r){"use strict";var n=t("../../components/fx");var a=t("../../plots/cartesian/axes");var i=t("../../constants/numerical").BADNUM;var o=t("../scatter/get_trace_color");var s=t("../scatter/fill_hover_text");var l=t("./attributes");e.exports=function t(e,r,a){var s=e.cd;var l=s[0].trace;var c=e.xa;var f=e.ya;var h=e.subplot;var p=h.projection.isLonLatOverEdges;var d=h.project;function v(t){var e=t.lonlat;if(e[0]===i)return Infinity;if(p(e))return Infinity;var n=d(e);var o=d([r,a]);var s=Math.abs(n[0]-o[0]);var l=Math.abs(n[1]-o[1]);var u=Math.max(3,t.mrc||0);return Math.max(Math.sqrt(s*s+l*l)-u,1-3/u)}n.getClosest(s,v,e);if(e.index===false)return;var g=s[e.index];var m=g.lonlat;var y=[c.c2p(m),f.c2p(m)];var x=g.mrc||1;e.x0=y[0]-x;e.x1=y[0]+x;e.y0=y[1]-x;e.y1=y[1]+x;e.loc=g.loc;e.lon=m[0];e.lat=m[1];e.color=o(l,g);e.extraText=u(l,g,h.mockAxis,s[0].t.labels);return[e]};function u(t,e,r,n){var i=e.hi||t.hoverinfo;var o=i==="all"?l.hoverinfo.flags:i.split("+");var u=o.indexOf("location")!==-1&&Array.isArray(t.locations);var c=o.indexOf("lon")!==-1;var f=o.indexOf("lat")!==-1;var h=o.indexOf("text")!==-1;var p=[];function d(t){return a.tickText(r,r.c2l(t),"hover").text+"\xb0"}if(u){p.push(e.loc)}else if(c&&f){p.push("("+d(e.lonlat[0])+", "+d(e.lonlat[1])+")")}else if(c){p.push(n.lon+d(e.lonlat[0]))}else if(f){p.push(n.lat+d(e.lonlat[1]))}if(h){s(e,t,p)}return p.join("<br>")}},{"../../components/fx":600,"../../constants/numerical":661,"../../plots/cartesian/axes":732,"../scatter/fill_hover_text":1022,"../scatter/get_trace_color":1024,"./attributes":1053}],1058:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.colorbar=t("../scatter/marker_colorbar");n.calc=t("./calc");n.plot=t("./plot");n.style=t("./style");n.styleOnSelect=t("../scatter/style").styleOnSelect;n.hoverPoints=t("./hover");n.eventData=t("./event_data");n.selectPoints=t("./select");n.moduleType="trace";n.name="scattergeo";n.basePlotModule=t("../../plots/geo");n.categories=["geo","symbols","showLegend","scatter-like"];n.meta={};e.exports=n},{"../../plots/geo":762,"../scatter/marker_colorbar":1032,"../scatter/style":1036,"./attributes":1053,"./calc":1054,"./defaults":1055,"./event_data":1056,"./hover":1057,"./plot":1059,"./select":1060,"./style":1061}],1059:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../lib");var i=t("../../constants/numerical").BADNUM;var o=t("../../lib/topojson_utils").getTopojsonFeatures;var s=t("../../lib/geo_location_utils").locationToFeature;var l=t("../../lib/geojson_utils");var u=t("../scatter/subtypes");var c=t("./style");e.exports=function t(e,r,o){for(var s=0;s<o.length;s++){f(o[s],r.topojson)}function h(t){return t[0].trace.uid}function p(t,e){if(t.lonlat[0]===i){n.select(e).remove()}}var d=r.layers.frontplot.select(".scatterlayer").selectAll("g.trace.scattergeo").data(o,h);d.enter().append("g").attr("class","trace scattergeo");d.exit().remove();d.selectAll("*").remove();d.each(function(t){var r=t[0].node3=n.select(this);var i=t[0].trace;if(u.hasLines(i)||i.fill!=="none"){var o=l.calcTraceToLineCoords(t);var s=i.fill!=="none"?l.makePolygon(o):l.makeLine(o);r.selectAll("path.js-line").data([{geojson:s,trace:i}]).enter().append("path").classed("js-line",true).style("stroke-miterlimit",2)}if(u.hasMarkers(i)){r.selectAll("path.point").data(a.identity).enter().append("path").classed("point",true).each(function(t){p(t,this)})}if(u.hasText(i)){r.selectAll("g").data(a.identity).enter().append("g").append("text").each(function(t){p(t,this)})}c(e,t)})};function f(t,e){var r=t[0].trace;if(!Array.isArray(r.locations))return;var n=o(r,e);var a=r.locationmode;for(var l=0;l<t.length;l++){var u=t[l];var c=s(a,u.loc,n);u.lonlat=c?c.properties.ct:[i,i]}}},{"../../constants/numerical":661,"../../lib":684,"../../lib/geo_location_utils":676,"../../lib/geojson_utils":677,"../../lib/topojson_utils":711,"../scatter/subtypes":1037,"./style":1061,d3:147}],1060:[function(t,e,r){"use strict";var n=t("../scatter/subtypes");e.exports=function t(e,r){var a=e.cd;var i=e.xaxis;var o=e.yaxis;var s=[];var l=a[0].trace;var u,c,f,h,p;var d=!n.hasMarkers(l)&&!n.hasText(l);if(d)return[];if(r===false){for(p=0;p<a.length;p++){a[p].selected=0}}else{for(p=0;p<a.length;p++){u=a[p];c=u.lonlat;f=i.c2p(c);h=o.c2p(c);if(r.contains([f,h])){s.push({pointNumber:p,lon:c[0],lat:c[1]});u.selected=1}else{u.selected=0}}}return s}},{"../scatter/subtypes":1037}],1061:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/drawing");var i=t("../../components/color");var o=t("../scatter/style").stylePoints;e.exports=function t(e,r){if(r)s(e,r)};function s(t,e){var r=e[0].trace;var s=e[0].node3;s.style("opacity",e[0].trace.opacity);o(s,r,t);s.selectAll("path.js-line").style("fill","none").each(function(t){var e=n.select(this);var r=t.trace;var o=r.line||{};e.call(i.stroke,o.color).call(a.dashLine,o.dash||"",o.width||0);if(r.fill!=="none"){e.call(i.fill,r.fillcolor)}})}},{"../../components/color":558,"../../components/drawing":583,"../scatter/style":1036,d3:147}],1062:[function(t,e,r){"use strict";var n=t("../../plots/attributes");var a=t("../scatter/attributes");var i=t("../../components/colorscale/attributes");var o=t("../../lib/extend").extendFlat;var s=t("../../plot_api/edit_types").overrideAll;var l=t("./constants").DASHES;var u=a.line;var c=a.marker;var f=c.line;var h=e.exports=s({x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,text:o({},a.text,{}),hovertext:a.hovertext,textposition:a.textposition,textfont:a.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:u.color,width:u.width,dash:{valType:"enumerated",values:Object.keys(l),dflt:"solid"}},marker:o({},i("marker"),{symbol:c.symbol,size:c.size,sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,opacity:c.opacity,colorbar:c.colorbar,line:o({},i("marker.line"),{width:f.width})}),connectgaps:a.connectgaps,fill:a.fill,fillcolor:a.fillcolor,hoveron:a.hoveron,selected:{marker:a.selected.marker,textfont:a.selected.textfont},unselected:{marker:a.unselected.marker,textfont:a.unselected.textfont},opacity:n.opacity},"calc","nested");h.x.editType=h.y.editType=h.x0.editType=h.y0.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":565,"../../lib/extend":673,"../../plot_api/edit_types":715,"../../plots/attributes":729,"../scatter/attributes":1015,"./constants":1063}],1063:[function(t,e,r){"use strict";var n=20;e.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:n,SYMBOL_STROKE:n/20,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1064:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("svg-path-sdf");var i=t("color-normalize");var o=t("../../registry");var s=t("../../lib");var l=t("../../components/drawing");var u=t("../../plots/cartesian/axes");var c=t("../../plots/cartesian/axis_ids");var f=t("../../lib/gl_format_color").formatColor;var h=t("../scatter/subtypes");var p=t("../scatter/make_bubble_size_func");var d=t("./constants");var v=t("../../constants/interactions").DESELECTDIM;var g={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1};function m(t,e){var r;var n={marker:undefined,markerSel:undefined,markerUnsel:undefined,line:undefined,fill:undefined,errorX:undefined,errorY:undefined,text:undefined,textSel:undefined,textUnsel:undefined};if(e.visible!==true)return n;if(h.hasText(e)){n.text=y(e);n.textSel=_(e,e.selected);n.textUnsel=_(e,e.unselected)}if(h.hasMarkers(e)){n.marker=x(e);n.markerSel=b(e,e.selected);n.markerUnsel=b(e,e.unselected);if(!e.unselected&&Array.isArray(e.marker.opacity)){var a=e.marker.opacity;n.markerUnsel.opacity=new Array(a.length);for(r=0;r<a.length;r++){n.markerUnsel.opacity[r]=v*a[r]}}}if(h.hasLines(e)){n.line={overlay:true,thickness:e.line.width,color:e.line.color,opacity:e.opacity};var i=(d.DASHES[e.line.dash]||[1]).slice();for(r=0;r<i.length;++r){i[r]*=e.line.width}n.line.dashes=i}if(e.error_x&&e.error_x.visible){n.errorX=w(e,e.error_x)}if(e.error_y&&e.error_y.visible){n.errorY=w(e,e.error_y)}if(!!e.fill&&e.fill!=="none"){n.fill={closed:true,fill:e.fillcolor,thickness:0}}return n}function y(t){var e=t._length;var r=t.textfont;var a=t.textposition;var i=Array.isArray(a)?a:[a];var o=r.color;var s=r.size;var l=r.family;var u={};var c;u.text=t.text;u.opacity=t.opacity;u.font={};u.align=[];u.baseline=[];for(c=0;c<i.length;c++){var f=i[c].split(/\s+/);switch(f[1]){case"left":u.align.push("right");break;case"right":u.align.push("left");break;default:u.align.push(f[1])}switch(f[0]){case"top":u.baseline.push("bottom");break;case"bottom":u.baseline.push("top");break;default:u.baseline.push(f[0])}}if(Array.isArray(o)){u.color=new Array(e);for(c=0;c<e;c++){u.color[c]=o[c]}}else{u.color=o}if(Array.isArray(s)||Array.isArray(l)){u.font=new Array(e);for(c=0;c<e;c++){var h=u.font[c]={};h.size=Array.isArray(s)?n(s[c])?s[c]:0:s;h.family=Array.isArray(l)?l[c]:l}}else{u.font={size:s,family:l}}return u}function x(t){var e=t._length;var r=t.marker;var n={};var a;var o=Array.isArray(r.symbol);var l=s.isArrayOrTypedArray(r.color);var u=s.isArrayOrTypedArray(r.line.color);var c=s.isArrayOrTypedArray(r.opacity);var h=s.isArrayOrTypedArray(r.size);var v=s.isArrayOrTypedArray(r.line.width);var g;if(!o)g=d.OPEN_RE.test(r.symbol);if(o||l||u||c){n.colors=new Array(e);n.borderColors=new Array(e);var m=f(r,r.opacity,e);var y=f(r.line,r.opacity,e);if(!Array.isArray(y[0])){var x=y;y=Array(e);for(a=0;a<e;a++){y[a]=x}}if(!Array.isArray(m[0])){var b=m;m=Array(e);for(a=0;a<e;a++){m[a]=b}}n.colors=m;n.borderColors=y;for(a=0;a<e;a++){if(o){var _=r.symbol[a];g=d.OPEN_RE.test(_)}if(g){y[a]=m[a].slice();m[a]=m[a].slice();m[a][3]=0}}n.opacity=t.opacity}else{if(g){n.color=i(r.color,"uint8");n.color[3]=0;n.borderColor=i(r.color,"uint8")}else{n.color=i(r.color,"uint8");n.borderColor=i(r.line.color,"uint8")}n.opacity=t.opacity*r.opacity}if(o){n.markers=new Array(e);for(a=0;a<e;a++){n.markers[a]=E(r.symbol[a])}}else{n.marker=E(r.symbol)}var w=p(t);var k;if(h||v){var M=n.sizes=new Array(e);var A=n.borderSizes=new Array(e);var T=0;var S;if(h){for(a=0;a<e;a++){M[a]=w(r.size[a]);T+=M[a]}S=T/e}else{k=w(r.size);for(a=0;a<e;a++){M[a]=k}}if(v){for(a=0;a<e;a++){A[a]=r.line.width[a]/2}}else{k=r.line.width/2;for(a=0;a<e;a++){A[a]=k}}n.sizeAvg=S}else{n.size=w(r&&r.size||10);n.borderSizes=w(r.line.width)}return n}function b(t,e){var r=t.marker;var n={};if(!e)return n;if(e.marker&&e.marker.symbol){n=x(s.extendFlat({},r,e.marker))}else if(e.marker){if(e.marker.size)n.size=e.marker.size/2;if(e.marker.color)n.colors=e.marker.color;if(e.marker.opacity!==undefined)n.opacity=e.marker.opacity}return n}function _(t,e){var r={};if(!e)return r;if(e.textfont){var n={opacity:1,text:t.text,textposition:t.textposition,textfont:s.extendFlat({},t.textfont)};if(e.textfont){s.extendFlat(n.textfont,e.textfont)}r=y(n)}return r}function w(t,e){var r={capSize:e.width*2,lineWidth:e.thickness,color:e.color};if(e.copy_ystyle){r=t.error_y}return r}var k=d.SYMBOL_SDF_SIZE;var M=d.SYMBOL_SIZE;var A=d.SYMBOL_STROKE;var T={};var S=l.symbolFuncs[0](M*.05);function E(t){if(t==="circle")return null;var e,r;var n=l.symbolNumber(t);var i=l.symbolFuncs[n%100];var o=!!l.symbolNoDot[n%100];var s=!!l.symbolNoFill[n%100];var u=d.DOT_RE.test(t);if(T[t])return T[t];if(u&&!o){e=i(M*1.1)+S}else{e=i(M)}r=a(e,{w:k,h:k,viewBox:[-M,-M,M,M],stroke:s?A:-A});T[t]=r;return r||null}function C(t,e,r){var n=r.length/2;var a;var i;if(h.hasLines(e)&&n){if(e.line.shape==="hv"){a=[];for(i=0;i<n-1;i++){if(isNaN(r[i*2])||isNaN(r[i*2+1])){a.push(NaN);a.push(NaN);a.push(NaN);a.push(NaN)}else{a.push(r[i*2]);a.push(r[i*2+1]);a.push(r[i*2+2]);a.push(r[i*2+1])}}a.push(r[r.length-2]);a.push(r[r.length-1])}else if(e.line.shape==="vh"){a=[];for(i=0;i<n-1;i++){if(isNaN(r[i*2])||isNaN(r[i*2+1])){a.push(NaN);a.push(NaN);a.push(NaN);a.push(NaN)}else{a.push(r[i*2]);a.push(r[i*2+1]);a.push(r[i*2]);a.push(r[i*2+3])}}a.push(r[r.length-2]);a.push(r[r.length-1])}else{a=r}}var o=false;for(i=0;i<a.length;i++){if(isNaN(a[i])){o=true;break}}var s=o||a.length>d.TOO_MANY_POINTS?"rect":h.hasMarkers(e)?"rect":"round";if(o&&e.connectgaps){var l=a[0];var u=a[1];for(i=0;i<a.length;i+=2){if(isNaN(a[i])||isNaN(a[i+1])){a[i]=l;a[i+1]=u}else{l=a[i];u=a[i+1]}}}return{join:s,positions:a}}function L(t,e,r,a,i){var s=o.getComponentMethod("errorbars","makeComputeError");var l=c.getFromId(t,e.xaxis);var f=c.getFromId(t,e.yaxis);var h=r.length/2;var p={};function d(t,a){var i=a._id.charAt(0);var o=e["error_"+i];if(o&&o.visible&&(a.type==="linear"||a.type==="log")){var l=s(o);var c={x:0,y:1}[i];var f={x:[0,1,2,3],y:[2,3,0,1]}[i];var d=new Float64Array(4*h);var v=Infinity;var g=-Infinity;for(var m=0,y=0;m<h;m++,y+=4){var x=t[m];if(n(x)){var b=r[m*2+c];var _=l(x,m);var w=_[0];var k=_[1];if(n(w)&&n(k)){var M=x-w;var A=x+k;d[y+f[0]]=b-a.c2l(M);d[y+f[1]]=a.c2l(A)-b;d[y+f[2]]=0;d[y+f[3]]=0;v=Math.min(v,x-w);g=Math.max(g,x+k)}}}u.expand(a,[v,g],{padded:true});p[i]={positions:r,errors:d}}}d(a,l);d(i,f);return p}function I(t,e,r,n){var a=e._length;var i={};var o;if(h.hasMarkers(e)){var s=r.font;var l=r.align;var u=r.baseline;i.offset=new Array(a);for(o=0;o<a;o++){var c=n.sizes?n.sizes[o]:n.size;var f=Array.isArray(s)?s[o].size:s.size;var p=Array.isArray(l)?l.length>1?l[o]:l[0]:l;var d=Array.isArray(u)?u.length>1?u[o]:u[0]:u;var v=g[p];var m=g[d];var y=c?c/.8+1:0;var x=-m*y-m*.5;i.offset[o]=[v*y/f,x/f]}}return i}e.exports={style:m,markerStyle:x,markerSelection:b,linePositions:C,errorBarPositions:L,textPosition:I}},{"../../components/drawing":583,"../../constants/interactions":660,"../../lib":684,"../../lib/gl_format_color":680,"../../plots/cartesian/axes":732,"../../plots/cartesian/axis_ids":735,"../../registry":817,"../scatter/make_bubble_size_func":1031,"../scatter/subtypes":1037,"./constants":1063,"color-normalize":107,"fast-isnumeric":214,"svg-path-sdf":497}],1065:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../registry");var i=t("./attributes");var o=t("../scatter/constants");var s=t("../scatter/subtypes");var l=t("../scatter/xy_defaults");var u=t("../scatter/marker_defaults");var c=t("../scatter/line_defaults");var f=t("../scatter/fillcolor_defaults");var h=t("../scatter/text_defaults");e.exports=function t(e,r,p,d){function v(t,a){return n.coerce(e,r,i,t,a)}var g=e.marker?/-open/.test(e.marker.symbol):false;var m=s.isBubble(e);var y=l(e,r,d,v);if(!y){r.visible=false;return}var x=y<o.PTS_LINESONLY?"lines+markers":"lines";v("text");v("hovertext");v("mode",x);if(s.hasLines(r)){v("connectgaps");c(e,r,p,d,v)}var b=[];if(s.hasMarkers(r)){u(e,r,p,d,v);v("marker.line.width",g||m?1:0);b.push("points")}if(s.hasText(r)){h(e,r,d,v)}v("fill");if(r.fill!=="none"){f(e,r,p,v)}if(r.fill==="tonext"||r.fill==="toself"){b.push("fills")}v("hoveron",b.join("+")||"points");var _=a.getComponentMethod("errorbars","supplyDefaults");_(e,r,p,{axis:"y"});_(e,r,p,{axis:"x",inherit:"y"});n.coerceSelectionMarkerOpacity(r,v)}},{"../../lib":684,"../../registry":817,"../scatter/constants":1020,"../scatter/fillcolor_defaults":1023,"../scatter/line_defaults":1027,"../scatter/marker_defaults":1033,"../scatter/subtypes":1037,"../scatter/text_defaults":1038,"../scatter/xy_defaults":1039,"./attributes":1062}],1066:[function(t,e,r){"use strict";var n=t("regl-scatter2d");var a=t("regl-line2d");var i=t("regl-error2d");var o=t("point-cluster");var s=t("array-range");var l=t("@etpinard/gl-text");var u=t("../../registry");var c=t("../../lib");var f=t("../../lib/prepare_regl");var h=t("../../plots/cartesian/axis_ids");var p=t("../../components/color");var d=t("../scatter/subtypes");var v=t("../scatter/calc").calcMarkerSize;var g=t("../scatter/calc").calcAxisExpansion;var m=t("../scatter/colorscale_calc");var y=t("../scatter/link_traces");var x=t("../scatter/get_trace_color");var b=t("../scatter/fill_hover_text");var _=t("./convert");var w=t("../../constants/numerical").BADNUM;var k=t("./constants").TOO_MANY_POINTS;var M=t("../../constants/interactions").DESELECTDIM;function A(t,e){var r=t._fullLayout;var n=h.getFromId(t,e.xaxis);var a=h.getFromId(t,e.yaxis);var i=r._plots[e.xaxis+e.yaxis];var s=e._length;var l=s*2;var u={};var c,f,p;var d=n.makeCalcdata(e,"x");var y=a.makeCalcdata(e,"y");var x=new Array(l);for(c=0;c<s;c++){f=d[c];p=y[c];x[c*2]=f===w?NaN:f;x[c*2+1]=p===w?NaN:p}if(n.type==="log"){for(c=0;c<l;c+=2){x[c]=n.c2l(x[c])}}if(a.type==="log"){for(c=1;c<l;c+=2){x[c]=a.c2l(x[c])}}if(n.type!=="log"&&a.type!=="log"){u.tree=o(x)}else{var b=u.ids=new Array(s);for(c=0;c<s;c++){b[c]=c}}m(e);var _=T(t,i,e,x,d,y);var M=S(t,i);var A;if(s<k){A=v(e,s)}else if(_.marker){A=2*(_.marker.sizeAvg||Math.max(_.marker.size,3))}g(t,e,n,a,d,y,A);if(_.fill&&!M.fill2d)M.fill2d=true;if(_.marker&&!M.scatter2d)M.scatter2d=true;if(_.line&&!M.line2d)M.line2d=true;if((_.errorX||_.errorY)&&!M.error2d)M.error2d=true;if(_.text&&!M.glText)M.glText=true;if(_.marker&&s>=k){_.marker.cluster=u.tree}M.lineOptions.push(_.line);M.errorXOptions.push(_.errorX);M.errorYOptions.push(_.errorY);M.fillOptions.push(_.fill);M.markerOptions.push(_.marker);M.markerSelectedOptions.push(_.markerSel);M.markerUnselectedOptions.push(_.markerUnsel);M.textOptions.push(_.text);M.textSelectedOptions.push(_.textSel);M.textUnselectedOptions.push(_.textUnsel);M.count++;u._scene=M;u.index=M.count-1;u.x=d;u.y=y;u.positions=x;u.count=s;t.firstscatter=false;return[{x:false,y:false,t:u,trace:e}]}function T(t,e,r,n,a,i){var o=_.style(t,r);if(o.marker){o.marker.positions=n}if(o.line&&n.length>1){c.extendFlat(o.line,_.linePositions(t,r,n))}if(o.errorX||o.errorY){var s=_.errorBarPositions(t,r,n,a,i);if(o.errorX){c.extendFlat(o.errorX,s.x)}if(o.errorY){c.extendFlat(o.errorY,s.y)}}if(o.text){c.extendFlat(o.text,{positions:n},_.textPosition(t,r,o.text,o.marker));c.extendFlat(o.textSel,{positions:n},_.textPosition(t,r,o.text,o.markerSel));c.extendFlat(o.textUnsel,{positions:n},_.textPosition(t,r,o.text,o.markerUnsel))}return o}function S(t,e){var r=e._scene;var n=t._fullLayout;var a={count:0,dirty:true,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[]};var i={selectBatch:null,unselectBatch:null,fill2d:false,scatter2d:false,error2d:false,line2d:false,glText:false,select2d:null};if(!e._scene){r=e._scene={};r.init=function t(){c.extendFlat(r,i,a)};r.init();r.update=function t(e){var n;var a=new Array(r.count);for(n=0;n<r.count;n++){a[n]=e}if(r.fill2d)r.fill2d.update(a);if(r.scatter2d)r.scatter2d.update(a);if(r.line2d)r.line2d.update(a);if(r.error2d)r.error2d.update(a.concat(a));if(r.select2d)r.select2d.update(a);if(r.glText){for(n=0;n<r.count;n++){r.glText[n].update(a[n])}}r.draw()};r.draw=function t(){var e;for(e=0;e<r.count;e++){if(r.fill2d&&r.fillOptions[e]){r.fill2d.draw(e)}}for(e=0;e<r.count;e++){if(r.line2d&&r.lineOptions[e]){r.line2d.draw(e)}if(r.error2d&&r.errorXOptions[e]){r.error2d.draw(e)}if(r.error2d&&r.errorYOptions[e]){r.error2d.draw(e+r.count)}if(r.scatter2d&&r.markerOptions[e]&&(!r.selectBatch||!r.selectBatch[e])){r.scatter2d.draw(e)}}if(r.scatter2d&&r.select2d&&r.selectBatch){r.select2d.draw(r.selectBatch);r.scatter2d.draw(r.unselectBatch)}for(e=0;e<r.count;e++){if(r.glText[e]&&r.textOptions[e]){r.glText[e].render()}}r.dirty=false};r.clear=function t(){var a=n._size;var i=n.width;var o=n.height;var s=e.xaxis;var l=e.yaxis;var u=[a.l+s.domain[0]*a.w,a.b+l.domain[0]*a.h,i-a.r-(1-s.domain[1])*a.w,o-a.t-(1-l.domain[1])*a.h];if(r.select2d){E(r.select2d,u)}if(r.scatter2d){E(r.scatter2d,u)}else if(r.glText){E(r.glText[0],u)}};r.destroy=function t(){if(r.fill2d)r.fill2d.destroy();if(r.scatter2d)r.scatter2d.destroy();if(r.error2d)r.error2d.destroy();if(r.line2d)r.line2d.destroy();if(r.select2d)r.select2d.destroy();if(r.glText){r.glText.forEach(function(t){t.destroy()})}r.lineOptions=null;r.fillOptions=null;r.markerOptions=null;r.markerSelectedOptions=null;r.markerUnselectedOptions=null;r.errorXOptions=null;r.errorYOptions=null;r.textOptions=null;r.textSelectedOptions=null;r.textUnselectedOptions=null;r.selectBatch=null;r.unselectBatch=null;e._scene=null}}if(!r.dirty){c.extendFlat(r,a)}return r}function E(t,e){var r=t.regl._gl;r.enable(r.SCISSOR_TEST);r.scissor(e[0],e[1],e[2]-e[0],e[3]-e[1]);r.clearColor(0,0,0,0);r.clear(r.COLOR_BUFFER_BIT)}function C(t,e,r){if(!r.length)return;var o;var s=t._fullLayout;var u=r[0][0].t._scene;var p=s.dragmode;if(!u)return;var d=s._size;var v=s.width;var g=s.height;var m=f(t,["ANGLE_instanced_arrays","OES_element_index_uint"]);if(!m){u.init();return}var x=s._glcanvas.data()[0].regl;y(t,e,r);if(u.dirty){if(u.error2d===true){u.error2d=i(x)}if(u.line2d===true){u.line2d=a(x)}if(u.scatter2d===true){u.scatter2d=n(x)}if(u.fill2d===true){u.fill2d=a(x)}if(u.glText===true){u.glText=new Array(u.count);for(o=0;o<u.count;o++){u.glText[o]=new l(x)}}if(u.glText){for(o=0;o<u.count;o++){u.glText[o].update(u.textOptions[o])}}if(u.line2d){u.line2d.update(u.lineOptions)}if(u.error2d){var b=(u.errorXOptions||[]).concat(u.errorYOptions||[]);u.error2d.update(b)}if(u.scatter2d){u.scatter2d.update(u.markerOptions)}if(u.fill2d){u.fillOptions=u.fillOptions.map(function(t,e){var n=r[e];if(!t||!n||!n[0]||!n[0].trace)return null;var a=n[0];var i=a.trace;var o=a.t;var s=u.lineOptions[e];var l,c;var f=[],h=s&&s.positions||o.positions;if(i.fill==="tozeroy"){f=[h[0],0];f=f.concat(h);f.push(h[h.length-2]);f.push(0)}else if(i.fill==="tozerox"){f=[0,h[1]];f=f.concat(h);f.push(0);f.push(h[h.length-1])}else if(i.fill==="toself"||i.fill==="tonext"){f=[];l=0;for(c=0;c<h.length;c+=2){if(isNaN(h[c])||isNaN(h[c+1])){f=f.concat(h.slice(l,c));f.push(h[l],h[l+1]);l=c+2}}f=f.concat(h.slice(l));if(l){f.push(h[l],h[l+1])}}else{var p=i._nexttrace;if(p){var d=u.lineOptions[e+1];if(d){var v=d.positions;if(i.fill==="tonexty"){f=h.slice();for(e=Math.floor(v.length/2);e--;){var g=v[e*2],m=v[e*2+1];if(isNaN(g)||isNaN(m))continue;f.push(g);f.push(m)}t.fill=p.fillcolor}}}}if(i._prevtrace&&i._prevtrace.fill==="tonext"){var y=u.lineOptions[e-1].positions;var x=f.length/2;l=x;var b=[l];for(c=0;c<y.length;c+=2){if(isNaN(y[c])||isNaN(y[c+1])){b.push(c/2+x+1);l=c+2}}f=f.concat(y);t.hole=b}t.opacity=i.opacity;t.positions=f;return t});u.fill2d.update(u.fillOptions)}}var _=p==="lasso"||p==="select";u.selectBatch=null;u.unselectBatch=null;var w=r.map(function(r){if(!r||!r[0]||!r[0].trace)return;var n=r[0];var a=n.trace;var i=n.t;var o=i.index;var s=i.x;var l=i.y;var f=e.xaxis||h.getFromId(t,a.xaxis||"x");var p=e.yaxis||h.getFromId(t,a.yaxis||"y");var m;var y=[(f._rl||f.range)[0],(p._rl||p.range)[0],(f._rl||f.range)[1],(p._rl||p.range)[1]];var x=[d.l+f.domain[0]*d.w,d.b+p.domain[0]*d.h,v-d.r-(1-f.domain[1])*d.w,g-d.t-(1-p.domain[1])*d.h];if(a.selectedpoints||_){if(!_)_=true;if(!u.selectBatch){u.selectBatch=[];u.unselectBatch=[]}if(a.selectedpoints){var b=u.selectBatch[o]=c.selIndices2selPoints(a);var w={};for(m=0;m<b.length;m++){w[b[m]]=1}var k=[];for(m=0;m<i.count;m++){if(!w[m])k.push(m)}u.unselectBatch[o]=k}var M=new Array(i.count);var A=new Array(i.count);for(m=0;m<i.count;m++){M[m]=f.c2p(s[m]);A[m]=p.c2p(l[m])}i.xpx=M;i.ypx=A}else{i.xpx=i.ypx=null}return a.visible?{viewport:x,range:y}:null});if(_){if(!u.select2d){u.select2d=n(s._glcanvas.data()[1].regl)}if(u.scatter2d&&u.selectBatch&&u.selectBatch.length){u.scatter2d.update(u.markerUnselectedOptions.map(function(t,e){return u.selectBatch[e]?t:null}))}if(u.select2d){u.select2d.update(u.markerOptions);u.select2d.update(u.markerSelectedOptions)}if(u.glText){r.forEach(function(t){if(t&&t[0]&&t[0].trace){O(t)}})}}if(u.fill2d){u.fill2d.update(w)}if(u.line2d){u.line2d.update(w)}if(u.error2d){u.error2d.update(w.concat(w))}if(u.scatter2d){u.scatter2d.update(w)}if(u.select2d){u.select2d.update(w)}if(u.glText){u.glText.forEach(function(t,e){t.update(w[e])})}u.draw();return}function L(t,e,r,n){var a=t.cd;var i=a[0].t;var o=a[0].trace;var s=t.xa;var l=t.ya;var u=i.x;var c=i.y;var f=s.c2p(e);var h=l.c2p(r);var p=t.distance;var d;if(i.tree){var v=s.p2c(f-p);var g=s.p2c(f+p);var m=l.p2c(h-p);var y=l.p2c(h+p);if(n==="x"){d=i.tree.range(Math.min(v,g),Math.min(l._rl[0],l._rl[1]),Math.max(v,g),Math.max(l._rl[0],l._rl[1]))}else{d=i.tree.range(Math.min(v,g),Math.min(m,y),Math.max(v,g),Math.max(m,y))}}else if(i.ids){d=i.ids}else return[t];var x,b,_,w,k,M,A,T;var S=p;if(n==="x"){for(w=0;w<d.length;w++){b=u[d[w]];k=Math.abs(s.c2p(b)-f);if(k<S){S=k;M=l.c2p(c[d[w]])-h;T=Math.sqrt(k*k+M*M);x=d[w]}}}else{for(w=0;w<d.length;w++){b=u[d[w]];_=c[d[w]];k=s.c2p(b)-f;M=l.c2p(_)-h;A=Math.sqrt(k*k+M*M);if(A<S){S=T=A;x=d[w]}}}t.index=x;t.distance=S;t.dxy=T;if(x===undefined)return[t];I(t,u,c,o);return[t]}function I(t,e,r,n){var a=t.xa;var i=t.ya;var o=t.distance;var s=t.dxy;var l=t.index;var f={pointNumber:l,x:e[l],y:r[l]};f.tx=Array.isArray(n.text)?n.text[l]:n.text;f.htx=Array.isArray(n.hovertext)?n.hovertext[l]:n.hovertext;f.data=Array.isArray(n.customdata)?n.customdata[l]:n.customdata;f.tp=Array.isArray(n.textposition)?n.textposition[l]:n.textposition;var h=n.textfont;if(h){f.ts=Array.isArray(h.size)?h.size[l]:h.size;f.tc=Array.isArray(h.color)?h.color[l]:h.color;f.tf=Array.isArray(h.family)?h.family[l]:h.family}var p=n.marker;if(p){f.ms=c.isArrayOrTypedArray(p.size)?p.size[l]:p.size;f.mo=c.isArrayOrTypedArray(p.opacity)?p.opacity[l]:p.opacity;f.mx=Array.isArray(p.symbol)?p.symbol[l]:p.symbol;f.mc=c.isArrayOrTypedArray(p.color)?p.color[l]:p.color}var d=p&&p.line;if(d){f.mlc=Array.isArray(d.color)?d.color[l]:d.color;f.mlw=c.isArrayOrTypedArray(d.width)?d.width[l]:d.width}var v=p&&p.gradient;if(v&&v.type!=="none"){f.mgt=Array.isArray(v.type)?v.type[l]:v.type;f.mgc=Array.isArray(v.color)?v.color[l]:v.color}var g=a.c2p(f.x,true);var m=i.c2p(f.y,true);var y=f.mrc||1;var _=n.hoverlabel;if(_){f.hbg=Array.isArray(_.bgcolor)?_.bgcolor[l]:_.bgcolor;f.hbc=Array.isArray(_.bordercolor)?_.bordercolor[l]:_.bordercolor;f.hts=Array.isArray(_.font.size)?_.font.size[l]:_.font.size;f.htc=Array.isArray(_.font.color)?_.font.color[l]:_.font.color;f.htf=Array.isArray(_.font.family)?_.font.family[l]:_.font.family;f.hnl=Array.isArray(_.namelength)?_.namelength[l]:_.namelength}var w=n.hoverinfo;if(w){f.hi=Array.isArray(w)?w[l]:w}var k={};k[t.index]=f;c.extendFlat(t,{color:x(n,f),x0:g-y,x1:g+y,xLabelVal:f.x,y0:m-y,y1:m+y,yLabelVal:f.y,cd:k,distance:o,spikeDistance:s});if(f.htx)t.text=f.htx;else if(f.tx)t.text=f.tx;else if(n.text)t.text=n.text;b(f,n,t);u.getComponentMethod("errorbars","hoverInfo")(f,n,t);return t}function z(t,e){var r=t.cd;var n=[];var a=r[0].trace;var i=r[0].t;var o=i.x;var l=i.y;var u=i._scene;if(!u)return n;var c=d.hasText(a);var f=d.hasMarkers(a);var h=!f&&!c;if(a.visible!==true||h)return n;var p=null;var v=null;var g;if(e!==false&&!e.degenerate){p=[],v=[];for(g=0;g<i.count;g++){if(e.contains([i.xpx[g],i.ypx[g]])){p.push(g);n.push({pointNumber:g,x:o[g],y:l[g]})}else{v.push(g)}}}else{v=s(i.count)}if(!u.selectBatch){u.selectBatch=[];u.unselectBatch=[]}if(!u.selectBatch[i.index]){for(g=0;g<u.count;g++){u.selectBatch[g]=[];u.unselectBatch[g]=[]}if(f){u.scatter2d.update(u.markerUnselectedOptions)}}u.selectBatch[i.index]=p;u.unselectBatch[i.index]=v;if(c){O(r)}return n}function P(t,e){if(!e)return;var r=e[0][0].t;var n=r._scene;if(!t._fullLayout._has("splom")){n.clear()}n.draw()}function O(t){var e=t[0];var r=e.t;var n=r._scene;var a=r.index;var i=n.selectBatch[a];var o=n.unselectBatch[a];var s=n.textOptions[a];var l=n.textSelectedOptions[a]||{};var u=n.textUnselectedOptions[a]||{};var f=c.extendFlat({},s);var h,d;if(i&&o){var v=l.color;var g=u.color;var m=s.color;var y=Array.isArray(m);f.color=new Array(r.count);for(h=0;h<i.length;h++){d=i[h];f.color[d]=v||(y?m[d]:m)}for(h=0;h<o.length;h++){d=o[h];var x=y?m[d]:m;f.color[d]=g?g:v?x:p.addOpacity(x,M)}}n.glText[a].update(f)}e.exports={moduleType:"trace",name:"scattergl",basePlotModule:t("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),cleanData:t("../scatter/clean_data"),colorbar:t("../scatter/marker_colorbar"),calc:A,plot:C,hoverPoints:L,style:P,selectPoints:z,sceneOptions:T,sceneUpdate:S,calcHover:I,meta:{}}},{"../../components/color":558,"../../constants/interactions":660,"../../constants/numerical":661,"../../lib":684,"../../lib/prepare_regl":697,"../../plots/cartesian":743,"../../plots/cartesian/axis_ids":735,"../../registry":817,"../scatter/calc":1016,"../scatter/clean_data":1018,"../scatter/colorscale_calc":1019,"../scatter/fill_hover_text":1022,"../scatter/get_trace_color":1024,"../scatter/link_traces":1030,"../scatter/marker_colorbar":1032,"../scatter/subtypes":1037,"./attributes":1062,"./constants":1063,"./convert":1064,"./defaults":1065,"@etpinard/gl-text":44,"array-range":58,"point-cluster":436,"regl-error2d":457,"regl-line2d":458,"regl-scatter2d":459}],1067:[function(t,e,r){"use strict";var n=t("../scattergeo/attributes");var a=t("../scatter/attributes");var i=t("../../plots/mapbox/layout_attributes");var o=t("../../plots/attributes");var s=t("../../components/colorbar/attributes");var l=t("../../lib/extend").extendFlat;var u=t("../../plot_api/edit_types").overrideAll;var c=n.line;var f=n.marker;e.exports=u({lon:n.lon,lat:n.lat,mode:l({},a.mode,{dflt:"markers"}),text:l({},a.text,{}),hovertext:l({},a.hovertext,{}),line:{color:c.color,width:c.width},connectgaps:a.connectgaps,marker:{symbol:{valType:"string",dflt:"circle",arrayOk:true},opacity:f.opacity,size:f.size,sizeref:f.sizeref,sizemin:f.sizemin,sizemode:f.sizemode,color:f.color,colorscale:f.colorscale,cauto:f.cauto,cmax:f.cmax,cmin:f.cmin,autocolorscale:f.autocolorscale,reversescale:f.reversescale,showscale:f.showscale,colorbar:s},fill:n.fill,fillcolor:a.fillcolor,textfont:i.layers.symbol.textfont,textposition:i.layers.symbol.textposition,selected:{marker:a.selected.marker},unselected:{marker:a.unselected.marker},hoverinfo:l({},o.hoverinfo,{flags:["lon","lat","text","name"]})},"calc","nested")},{"../../components/colorbar/attributes":559,"../../lib/extend":673,"../../plot_api/edit_types":715,"../../plots/attributes":729,"../../plots/mapbox/layout_attributes":791,"../scatter/attributes":1015,"../scattergeo/attributes":1053}],1068:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../lib");var i=t("../../constants/numerical").BADNUM;var o=t("../../lib/geojson_utils");var s=t("../../components/colorscale");var l=t("../../components/drawing");var u=t("../scatter/make_bubble_size_func");var c=t("../scatter/subtypes");var f=t("../../plots/mapbox/convert_text_opts");e.exports=function t(e){var r=e[0].trace;var n=r.visible===true;var i=r.fill!=="none";var s=c.hasLines(r);var l=c.hasMarkers(r);var u=c.hasText(r);var v=l&&r.marker.symbol==="circle";var g=l&&r.marker.symbol!=="circle";var m=h();var y=h();var x=h();var b=h();var _={fill:m,line:y,circle:x,symbol:b};if(!n)return _;var w;if(i||s){w=o.calcTraceToLineCoords(e)}if(i){m.geojson=o.makePolygon(w);m.layout.visibility="visible";a.extendFlat(m.paint,{"fill-color":r.fillcolor})}if(s){y.geojson=o.makeLine(w);y.layout.visibility="visible";a.extendFlat(y.paint,{"line-width":r.line.width,"line-color":r.line.color,"line-opacity":r.opacity})}if(v){var k=p(e);x.geojson=k.geojson;x.layout.visibility="visible";a.extendFlat(x.paint,{"circle-color":k.mcc,"circle-radius":k.mrc,"circle-opacity":k.mo})}if(g||u){b.geojson=d(e);a.extendFlat(b.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"});if(g){a.extendFlat(b.layout,{"icon-size":r.marker.size/10});a.extendFlat(b.paint,{"icon-opacity":r.opacity*r.marker.opacity,"icon-color":r.marker.color})}if(u){var M=(r.marker||{}).size,A=f(r.textposition,M);a.extendFlat(b.layout,{"text-size":r.textfont.size,"text-anchor":A.anchor,"text-offset":A.offset});a.extendFlat(b.paint,{"text-color":r.textfont.color,"text-opacity":r.opacity})}}return _};function h(){return{geojson:o.makeBlank(),layout:{visibility:"none"},paint:{}}}function p(t){var e=t[0].trace;var r=e.marker;var i=e.selectedpoints;var o=a.isArrayOrTypedArray(r.color);var c=a.isArrayOrTypedArray(r.size);var f=a.isArrayOrTypedArray(r.opacity);var h;function p(t){return e.opacity*t}function d(t){return t/2}var v;if(o){if(s.hasColorscale(e,"marker")){v=s.makeColorScaleFunc(s.extractScale(r.colorscale,r.cmin,r.cmax))}else{v=a.identity}}var g;if(c){g=u(e)}var y;if(f){y=function(t){var e=n(t)?+a.constrain(t,0,1):0;return p(e)}}var x=[];for(h=0;h<t.length;h++){var b=t[h];var _=b.lonlat;if(m(_))continue;var w={};if(v)w.mcc=b.mcc=v(b.mc);if(g)w.mrc=b.mrc=g(b.ms);if(y)w.mo=y(b.mo);if(i)w.selected=b.selected||0;x.push({type:"Feature",geometry:{type:"Point",coordinates:_},properties:w})}var k;if(i){k=l.makeSelectedPointStyleFns(e);for(h=0;h<x.length;h++){var M=x[h].properties;if(k.selectedOpacityFn){M.mo=p(k.selectedOpacityFn(M))}if(k.selectedColorFn){M.mcc=k.selectedColorFn(M)}if(k.selectedSizeFn){M.mrc=k.selectedSizeFn(M)}}}return{geojson:{type:"FeatureCollection",features:x},mcc:o||k&&k.selectedColorFn?{type:"identity",property:"mcc"}:r.color,mrc:c||k&&k.selectedSizeFn?{type:"identity",property:"mrc"}:d(r.size),mo:f||k&&k.selectedOpacityFn?{type:"identity",property:"mo"}:p(r.opacity)}}function d(t){var e=t[0].trace;var r=e.marker||{},n=r.symbol,a=e.text;var i=n!=="circle"?v(n):g;var o=c.hasText(e)?v(a):g;var s=[];for(var l=0;l<t.length;l++){var u=t[l];if(m(u.lonlat))continue;s.push({type:"Feature",geometry:{type:"Point",coordinates:u.lonlat},properties:{symbol:i(u.mx),text:o(u.tx)}})}return{type:"FeatureCollection",features:s}}function v(t){if(a.isArrayOrTypedArray(t)){return function(t){return t}}else if(t){return function(){return t}}else{return g}}function g(){return""}function m(t){return t[0]===i}},{"../../components/colorscale":573,"../../components/drawing":583,"../../constants/numerical":661,"../../lib":684,"../../lib/geojson_utils":677,"../../plots/mapbox/convert_text_opts":788,"../scatter/make_bubble_size_func":1031,"../scatter/subtypes":1037,"fast-isnumeric":214}],1069:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../scatter/subtypes");var i=t("../scatter/marker_defaults");var o=t("../scatter/line_defaults");var s=t("../scatter/text_defaults");var l=t("../scatter/fillcolor_defaults");var u=t("./attributes");e.exports=function t(e,r,f,h){function p(t,a){return n.coerce(e,r,u,t,a)}var d=c(e,r,p);if(!d){r.visible=false;return}p("text");p("hovertext");p("mode");if(a.hasLines(r)){o(e,r,f,h,p,{noDash:true});p("connectgaps")}if(a.hasMarkers(r)){i(e,r,f,h,p,{noLine:true});var v=r.marker;if(v.symbol!=="circle"){if(n.isArrayOrTypedArray(v.size))v.size=v.size[0];if(n.isArrayOrTypedArray(v.color))v.color=v.color[0]}}if(a.hasText(r)){s(e,r,h,p,{noSelect:true})}p("fill");if(r.fill!=="none"){l(e,r,f,p)}n.coerceSelectionMarkerOpacity(r,p)};function c(t,e,r){var n=r("lon")||[];var a=r("lat")||[];var i=Math.min(n.length,a.length);e._length=i;return i}},{"../../lib":684,"../scatter/fillcolor_defaults":1023,"../scatter/line_defaults":1027,"../scatter/marker_defaults":1033,"../scatter/subtypes":1037,"../scatter/text_defaults":1038,"./attributes":1067}],1070:[function(t,e,r){"use strict";e.exports=function t(e,r){e.lon=r.lon;e.lat=r.lat;return e}},{}],1071:[function(t,e,r){"use strict";var n=t("../../components/fx");var a=t("../../lib");var i=t("../scatter/get_trace_color");var o=t("../scatter/fill_hover_text");var s=t("../../constants/numerical").BADNUM;e.exports=function t(e,r,o){var u=e.cd;var c=u[0].trace;var f=e.xa;var h=e.ya;var p=e.subplot;var d=r>=0?Math.floor((r+180)/360):Math.ceil((r-180)/360);var v=d*360;var g=r-v;function m(t){var e=t.lonlat;if(e[0]===s)return Infinity;var r=a.wrap180(e[0]);var n=e[1];var i=p.project([r,n]);var l=i.x-f.c2p([g,n]);var u=i.y-h.c2p([r,o]);var c=Math.max(3,t.mrc||0);return Math.max(Math.sqrt(l*l+u*u)-c,1-3/c)}n.getClosest(u,m,e);if(e.index===false)return;var y=u[e.index];var x=y.lonlat;var b=[a.wrap180(x[0])+v,x[1]];var _=f.c2p(b);var w=h.c2p(b);var k=y.mrc||1;e.x0=_-k;e.x1=_+k;e.y0=w-k;e.y1=w+k;e.color=i(c,y);e.extraText=l(c,y,u[0].t.labels);return[e]};function l(t,e,r){var n=e.hi||t.hoverinfo;var a=n.split("+");var i=a.indexOf("all")!==-1;var s=a.indexOf("lon")!==-1;var l=a.indexOf("lat")!==-1;var u=e.lonlat;var c=[];function f(t){return t+"\xb0"}if(i||s&&l){c.push("("+f(u[0])+", "+f(u[1])+")")}else if(s){c.push(r.lon+f(u[0]))}else if(l){c.push(r.lat+f(u[1]))}if(i||a.indexOf("text")!==-1){o(e,t,c)}return c.join("<br>")}},{"../../components/fx":600,"../../constants/numerical":661,"../../lib":684,"../scatter/fill_hover_text":1022,"../scatter/get_trace_color":1024}],1072:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.colorbar=t("../scatter/marker_colorbar");n.calc=t("../scattergeo/calc");n.plot=t("./plot");n.hoverPoints=t("./hover");n.eventData=t("./event_data");n.selectPoints=t("./select");n.style=function(t,e){if(e){var r=e[0].trace;r._glTrace.update(e)}};n.moduleType="trace";n.name="scattermapbox";n.basePlotModule=t("../../plots/mapbox");n.categories=["mapbox","gl","symbols","showLegend","scatterlike"];n.meta={};e.exports=n},{"../../plots/mapbox":789,"../scatter/marker_colorbar":1032,"../scattergeo/calc":1054,"./attributes":1067,"./defaults":1069,"./event_data":1070,"./hover":1071,"./plot":1073,"./select":1074}],1073:[function(t,e,r){"use strict";var n=t("./convert");function a(t,e){this.subplot=t;this.uid=e;this.sourceIds={fill:e+"-source-fill",line:e+"-source-line",circle:e+"-source-circle",symbol:e+"-source-symbol"};this.layerIds={fill:e+"-layer-fill",line:e+"-layer-line",circle:e+"-layer-circle",symbol:e+"-layer-symbol"};this.order=["fill","line","circle","symbol"]}var i=a.prototype;i.addSource=function(t,e){this.subplot.map.addSource(this.sourceIds[t],{type:"geojson",data:e.geojson})};i.setSourceData=function(t,e){this.subplot.map.getSource(this.sourceIds[t]).setData(e.geojson)};i.addLayer=function(t,e){this.subplot.map.addLayer({type:t,id:this.layerIds[t],source:this.sourceIds[t],layout:e.layout,paint:e.paint})};i.update=function t(e){var r=this.subplot;var a=n(e);for(var i=0;i<this.order.length;i++){var o=this.order[i];var s=a[o];r.setOptions(this.layerIds[o],"setLayoutProperty",s.layout);if(s.layout.visibility==="visible"){this.setSourceData(o,s);r.setOptions(this.layerIds[o],"setPaintProperty",s.paint)}}e[0].trace._glTrace=this};i.dispose=function t(){var e=this.subplot.map;for(var r=0;r<this.order.length;r++){var n=this.order[r];e.removeLayer(this.layerIds[n]);e.removeSource(this.sourceIds[n])}};e.exports=function t(e,r){var i=r[0].trace;var o=new a(e,i.uid);var s=n(r);for(var l=0;l<o.order.length;l++){var u=o.order[l];var c=s[u];o.addSource(u,c);o.addLayer(u,c)}r[0].trace._glTrace=o;return o}},{"./convert":1068}],1074:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../scatter/subtypes");var i=t("../../constants/numerical").BADNUM;e.exports=function t(e,r){var o=e.cd;var s=e.xaxis;var l=e.yaxis;var u=[];var c=o[0].trace;var f;if(!a.hasMarkers(c))return[];if(r===false){for(f=0;f<o.length;f++){o[f].selected=0}}else{for(f=0;f<o.length;f++){var h=o[f];var p=h.lonlat;if(p[0]!==i){var d=[n.wrap180(p[0]),p[1]];var v=[s.c2p(d),l.c2p(d)];if(r.contains(v)){u.push({pointNumber:f,lon:p[0],lat:p[1]});h.selected=1}else{h.selected=0}}}}return u}},{"../../constants/numerical":661,"../../lib":684,"../scatter/subtypes":1037}],1075:[function(t,e,r){"use strict";var n=t("../../lib/extend").extendFlat;var a=t("../scatter/attributes");var i=t("../../plots/attributes");var o=a.line;e.exports={mode:a.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:a.text,hovertext:a.hovertext,line:{color:o.color,width:o.width,dash:o.dash,shape:n({},o.shape,{values:["linear","spline"]}),smoothing:o.smoothing,editType:"calc"},connectgaps:a.connectgaps,marker:a.marker,cliponaxis:n({},a.cliponaxis,{dflt:false}),textposition:a.textposition,textfont:a.textfont,fill:n({},a.fill,{values:["none","toself","tonext"]}),fillcolor:a.fillcolor,hoverinfo:n({},i.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:a.hoveron,selected:a.selected,unselected:a.unselected}},{"../../lib/extend":673,"../../plots/attributes":729,"../scatter/attributes":1015}],1076:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../../constants/numerical").BADNUM;var i=t("../../plots/cartesian/axes");var o=t("../scatter/colorscale_calc");var s=t("../scatter/arrays_to_calcdata");var l=t("../scatter/calc_selection");var u=t("../scatter/calc").calcMarkerSize;e.exports=function t(e,r){var c=e._fullLayout;var f=r.subplot;var h=c[f].radialaxis;var p=c[f].angularaxis;var d=h.makeCalcdata(r,"r");var v=p.makeCalcdata(r,"theta");var g=r._length;var m=new Array(g);function y(t){return p.c2rad(t,r.thetaunit)}for(var x=0;x<g;x++){var b=d[x];var _=v[x];var w=m[x]={};if(n(b)&&n(_)){w.r=b;w.theta=_;w.rad=y(_)}else{w.r=a}}var k=u(r,g);i.expand(h,d,{ppad:k});o(r);s(m,r);l(m,r);return m}},{"../../constants/numerical":661,"../../plots/cartesian/axes":732,"../scatter/arrays_to_calcdata":1014,"../scatter/calc":1016,"../scatter/calc_selection":1017,"../scatter/colorscale_calc":1019,"fast-isnumeric":214}],1077:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../scatter/subtypes");var i=t("../scatter/marker_defaults");var o=t("../scatter/line_defaults");var s=t("../scatter/line_shape_defaults");var l=t("../scatter/text_defaults");var u=t("../scatter/fillcolor_defaults");var c=t("../scatter/constants").PTS_LINESONLY;var f=t("./attributes");e.exports=function t(e,r,h,p){function d(t,a){return n.coerce(e,r,f,t,a)}var v=d("r");var g=d("theta");var m=v&&g?Math.min(v.length,g.length):0;if(!m){r.visible=false;return}r._length=m;d("thetaunit");d("mode",m<c?"lines+markers":"lines");d("text");d("hovertext");if(a.hasLines(r)){o(e,r,h,p,d);s(e,r,d);d("connectgaps")}if(a.hasMarkers(r)){i(e,r,h,p,d,{gradient:true})}if(a.hasText(r)){l(e,r,p,d)}var y=[];if(a.hasMarkers(r)||a.hasText(r)){d("cliponaxis");d("marker.maxdisplayed");y.push("points")}d("fill");if(r.fill!=="none"){u(e,r,h,d);if(!a.hasLines(r))s(e,r,d)}if(r.fill==="tonext"||r.fill==="toself"){y.push("fills")}d("hoveron",y.join("+")||"points");n.coerceSelectionMarkerOpacity(r,d)}},{"../../lib":684,"../scatter/constants":1020,"../scatter/fillcolor_defaults":1023,"../scatter/line_defaults":1027,"../scatter/line_shape_defaults":1029,"../scatter/marker_defaults":1033,"../scatter/subtypes":1037,"../scatter/text_defaults":1038,"./attributes":1075}],1078:[function(t,e,r){"use strict";var n=t("../scatter/hover");var a=t("../../plots/cartesian/axes");var i=t("../../lib");function o(t,e,r,a){var i=n(t,e,r,a);if(!i||i[0].index===false)return;var o=i[0];if(o.index===undefined){return i}var l=t.subplot;var u=o.cd[o.index];var c=o.trace;if(!l.isPtWithinSector(u))return;o.xLabelVal=undefined;o.yLabelVal=undefined;o.extraText=s(u,c,l);return i}function s(t,e,r){var n=r.radialAxis;var o=r.angularAxis;var s=t.hi||e.hoverinfo;var l=s.split("+");var u=[];n._hovertitle="r";o._hovertitle="\u03b8";var c=o._c2rad(t.theta,e.thetaunit);var f;if(o.type==="linear"&&e.thetaunit!==o.thetaunit){f=o.thetaunit==="degrees"?i.rad2deg(c):c}else{f=t.theta}function h(t,e){u.push(t._hovertitle+": "+a.tickText(t,e,"hover").text)}if(l.indexOf("all")!==-1)l=["r","theta"];if(l.indexOf("r")!==-1)h(n,n.c2r(t.r));if(l.indexOf("theta")!==-1)h(o,f);return u.join("<br>")}e.exports={hoverPoints:o,makeHoverPointText:s}},{"../../lib":684,"../../plots/cartesian/axes":732,"../scatter/hover":1025}],1079:[function(t,e,r){"use strict";e.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:t("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../scatter/marker_colorbar"),calc:t("./calc"),plot:t("./plot"),style:t("../scatter/style").style,hoverPoints:t("./hover").hoverPoints,selectPoints:t("../scatter/select"),meta:{}}},{"../../plots/polar":798,"../scatter/marker_colorbar":1032,"../scatter/select":1035,"../scatter/style":1036,"./attributes":1075,"./calc":1076,"./defaults":1077,"./hover":1078,"./plot":1080}],1080:[function(t,e,r){"use strict";var n=t("../scatter/plot");var a=t("../../constants/numerical").BADNUM;e.exports=function t(e,r,i){var o,s;var l={xaxis:r.xaxis,yaxis:r.yaxis,plot:r.framework,layerClipId:r._hasClipOnAxisFalse?r.clipIds.forTraces:null};var u=r.radialAxis;var c=u.range;var f;if(c[0]>c[1]){f=function(t){return t<=0}}else{f=function(t){return t>=0}}for(o=0;o<i.length;o++){for(s=0;s<i[o].length;s++){var h=i[o][s];var p=h.r;if(p!==a){var d=u.c2r(p)-c[0];if(f(d)){var v=h.rad;h.x=d*Math.cos(v);h.y=d*Math.sin(v);continue}else{h.intoCenter=[r.cxx,r.cyy]}}h.x=a;h.y=a}}var g=r.layers.frontplot.select("g.scatterlayer");n(e,l,i,g)}},{"../../constants/numerical":661,"../scatter/plot":1034}],1081:[function(t,e,r){"use strict";var n=t("../scatterpolar/attributes");var a=t("../scattergl/attributes");e.exports={mode:n.mode,r:n.r,theta:n.theta,thetaunit:n.thetaunit,text:n.text,line:a.line,connectgaps:a.connectgaps,marker:a.marker,fill:a.fill,fillcolor:a.fillcolor,hoverinfo:n.hoverinfo,hoveron:n.hoveron,selected:n.selected,unselected:n.unselected}},{"../scattergl/attributes":1062,"../scatterpolar/attributes":1075}],1082:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../scatter/subtypes");var i=t("../scatter/marker_defaults");var o=t("../scatter/line_defaults");var s=t("../scatter/fillcolor_defaults");var l=t("../scatter/constants").PTS_LINESONLY;var u=t("./attributes");e.exports=function t(e,r,c,f){function h(t,a){return n.coerce(e,r,u,t,a)}var p=h("r");var d=h("theta");var v=p&&d?Math.min(p.length,d.length):0;if(!v){r.visible=false;return}r._length=v;h("thetaunit");h("mode",v<l?"lines+markers":"lines");h("text");if(a.hasLines(r)){o(e,r,c,f,h);h("connectgaps")}var g=[];if(a.hasMarkers(r)){i(e,r,c,f,h);g.push("points")}h("fill");if(r.fill!=="none"){s(e,r,c,h)}if(r.fill==="tonext"||r.fill==="toself"){g.push("fills")}h("hoveron",g.join("+")||"points");n.coerceSelectionMarkerOpacity(r,h)}},{"../../lib":684,"../scatter/constants":1020,"../scatter/fillcolor_defaults":1023,"../scatter/line_defaults":1027,"../scatter/marker_defaults":1033,"../scatter/subtypes":1037,"./attributes":1081}],1083:[function(t,e,r){"use strict";var n=t("point-cluster");var a=t("fast-isnumeric");var i=t("../scattergl");var o=t("../scatter/colorscale_calc");var s=t("../../plots/cartesian/axes");var l=t("../scatterpolar/hover").makeHoverPointText;var u=t("../scatter/subtypes");var c=t("../scattergl/constants").TOO_MANY_POINTS;function f(t,e){var r=t._fullLayout;var n=e.subplot;var a=r[n].radialaxis;var i=r[n].angularaxis;var l=a.makeCalcdata(e,"r");var u=i.makeCalcdata(e,"theta");var c={};if(e._length<l.length)l=l.slice(0,e._length);if(e._length<u.length)u=u.slice(0,e._length);o(e);c.r=l;c.theta=u;s.expand(a,l,{tozero:true});if(i.type!=="linear"){i.autorange=true;s.expand(i,u);delete i.autorange}return[{x:false,y:false,t:c,trace:e}]}function h(t,e,r){var o=e.radialAxis;var s=e.angularAxis;var l=o.range;var f=i.sceneUpdate(t,e);f.clear();r.forEach(function(h,p){if(!h||!h[0]||!h[0].trace)return;var d=h[0];var v=d.trace;var g=d.t;var m=g.r;var y=g.theta;var x,b,_,w,k;var M=m.slice();var A=y.slice();for(x=0;x<m.length;x++){b=m[x],w=y[x];k=s.c2rad(w,v.thetaunit);if(!e.isPtWithinSector({r:b,rad:k})){M[x]=NaN;A[x]=NaN}}var T=m.length;var S=new Array(T*2),E=Array(T),C=Array(T);function L(t){return s.c2rad(t,v.thetaunit)}for(x=0;x<T;x++){b=M[x];w=A[x];if(a(b)&&a(w)&&b>=0){_=o.c2r(b)-l[0];k=L(w);E[x]=S[x*2]=_*Math.cos(k);C[x]=S[x*2+1]=_*Math.sin(k)}else{E[x]=C[x]=S[x*2]=S[x*2+1]=NaN}}var I=i.sceneOptions(t,e,v,S);if(I.fill&&!f.fill2d)f.fill2d=true;if(I.marker&&!f.scatter2d)f.scatter2d=true;if(I.line&&!f.line2d)f.line2d=true;if((I.errorX||I.errorY)&&!f.error2d)f.error2d=true;g.tree=n(S);if(I.marker&&T>=c){I.marker.cluster=g.tree}if(u.hasMarkers(v)){I.markerSel.positions=I.markerUnsel.positions=I.marker.positions}f.lineOptions.push(I.line);f.errorXOptions.push(I.errorX);f.errorYOptions.push(I.errorY);f.fillOptions.push(I.fill);f.markerOptions.push(I.marker);f.markerSelectedOptions.push(I.markerSel);f.markerUnselectedOptions.push(I.markerUnsel);f.count=r.length;g._scene=f;g.index=p;g.x=E;g.y=C;g.rawx=E;g.rawy=C;g.r=m;g.theta=y;g.positions=S;g.count=T});return i.plot(t,e,r)}function p(t,e,r,n){var a=t.cd;var o=a[0].t;var s=o.r;var u=o.theta;var c=i.hoverPoints(t,e,r,n);if(!c||c[0].index===false)return;var f=c[0];if(f.index===undefined){return c}var h=t.subplot;var p=h.angularAxis;var d=f.cd[f.index];var v=f.trace;d.r=s[f.index];d.theta=u[f.index];d.rad=p.c2rad(d.theta,v.thetaunit);if(!h.isPtWithinSector(d))return;f.xLabelVal=undefined;f.yLabelVal=undefined;f.extraText=l(d,v,h);return c}e.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:t("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../scatter/marker_colorbar"),calc:f,plot:h,hoverPoints:p,style:i.style,selectPoints:i.selectPoints,meta:{}}},{"../../plots/cartesian/axes":732,"../../plots/polar":798,"../scatter/colorscale_calc":1019,"../scatter/marker_colorbar":1032,"../scatter/subtypes":1037,"../scattergl":1066,"../scattergl/constants":1063,"../scatterpolar/hover":1078,"./attributes":1081,"./defaults":1082,"fast-isnumeric":214,"point-cluster":436}],1084:[function(t,e,r){"use strict";var n=t("../scatter/attributes");var a=t("../../plots/attributes");var i=t("../../components/colorscale/attributes");var o=t("../../components/colorbar/attributes");var s=t("../../components/drawing/attributes").dash;var l=t("../../lib/extend").extendFlat;var u=n.marker,c=n.line,f=u.line;e.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:l({},n.mode,{dflt:"markers"}),text:l({},n.text,{}),hovertext:l({},n.hovertext,{}),line:{color:c.color,width:c.width,dash:s,shape:l({},c.shape,{values:["linear","spline"]}),smoothing:c.smoothing,editType:"calc"},connectgaps:n.connectgaps,cliponaxis:n.cliponaxis,fill:l({},n.fill,{values:["none","toself","tonext"]}),fillcolor:n.fillcolor,marker:l({symbol:u.symbol,opacity:u.opacity,maxdisplayed:u.maxdisplayed,size:u.size,sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,line:l({width:f.width,editType:"calc"},i("marker.line")),gradient:u.gradient,editType:"calc"},i("marker"),{colorbar:o}),textfont:n.textfont,textposition:n.textposition,selected:n.selected,unselected:n.unselected,hoverinfo:l({},a.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:n.hoveron}},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../components/drawing/attributes":582,"../../lib/extend":673,"../../plots/attributes":729,"../scatter/attributes":1015}],1085:[function(t,e,r){"use strict";var n=t("fast-isnumeric");var a=t("../scatter/colorscale_calc");var i=t("../scatter/arrays_to_calcdata");var o=t("../scatter/calc_selection");var s=t("../scatter/calc").calcMarkerSize;var l=["a","b","c"];var u={a:["b","c"],b:["a","c"],c:["a","b"]};e.exports=function t(e,r){var c=e._fullLayout[r.subplot];var f=c.sum;var h=r.sum||f;var p={a:r.a,b:r.b,c:r.c};var d,v,g,m,y,x;for(d=0;d<l.length;d++){g=l[d];if(p[g])continue;y=p[u[g][0]];x=p[u[g][1]];m=new Array(y.length);for(v=0;v<y.length;v++){m[v]=h-y[v]-x[v]}p[g]=m}var b=r._length;var _=new Array(b);var w,k,M,A,T,S;for(d=0;d<b;d++){w=p.a[d];k=p.b[d];M=p.c[d];if(n(w)&&n(k)&&n(M)){w=+w;k=+k;M=+M;A=f/(w+k+M);if(A!==1){w*=A;k*=A;M*=A}S=w;T=M-k;_[d]={x:T,y:S,a:w,b:k,c:M}}else _[d]={x:false,y:false}}s(r,b);a(r);i(_,r);o(_,r);return _}},{"../scatter/arrays_to_calcdata":1014,"../scatter/calc":1016,"../scatter/calc_selection":1017,"../scatter/colorscale_calc":1019,"fast-isnumeric":214}],1086:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../scatter/constants");var i=t("../scatter/subtypes");var o=t("../scatter/marker_defaults");var s=t("../scatter/line_defaults");var l=t("../scatter/line_shape_defaults");var u=t("../scatter/text_defaults");var c=t("../scatter/fillcolor_defaults");var f=t("./attributes");e.exports=function t(e,r,h,p){function d(t,a){return n.coerce(e,r,f,t,a)}var v=d("a"),g=d("b"),m=d("c"),y;if(v){y=v.length;if(g){y=Math.min(y,g.length);if(m)y=Math.min(y,m.length)}else if(m)y=Math.min(y,m.length);else y=0}else if(g&&m){y=Math.min(g.length,m.length)}if(!y){r.visible=false;return}r._length=y;d("sum");d("text");d("hovertext");var x=y<a.PTS_LINESONLY?"lines+markers":"lines";d("mode",x);if(i.hasLines(r)){s(e,r,h,p,d);l(e,r,d);d("connectgaps")}if(i.hasMarkers(r)){o(e,r,h,p,d,{gradient:true})}if(i.hasText(r)){u(e,r,p,d)}var b=[];if(i.hasMarkers(r)||i.hasText(r)){d("cliponaxis");d("marker.maxdisplayed");b.push("points")}d("fill");if(r.fill!=="none"){c(e,r,h,d);if(!i.hasLines(r))l(e,r,d)}if(r.fill==="tonext"||r.fill==="toself"){b.push("fills")}d("hoveron",b.join("+")||"points");n.coerceSelectionMarkerOpacity(r,d)}},{"../../lib":684,"../scatter/constants":1020,"../scatter/fillcolor_defaults":1023,"../scatter/line_defaults":1027,"../scatter/line_shape_defaults":1029,"../scatter/marker_defaults":1033,"../scatter/subtypes":1037,"../scatter/text_defaults":1038,"./attributes":1084}],1087:[function(t,e,r){"use strict";e.exports=function t(e,r,n,a,i){if(r.xa)e.xaxis=r.xa;if(r.ya)e.yaxis=r.ya;if(a[i]){var o=a[i];e.a=o.a;e.b=o.b;e.c=o.c}else{e.a=r.a;e.b=r.b;e.c=r.c}return e}},{}],1088:[function(t,e,r){"use strict";var n=t("../scatter/hover");var a=t("../../plots/cartesian/axes");e.exports=function t(e,r,i,o){var s=n(e,r,i,o);if(!s||s[0].index===false)return;var l=s[0];if(l.index===undefined){var u=1-l.y0/e.ya._length,c=e.xa._length,f=c*u/2,h=c-f;l.x0=Math.max(Math.min(l.x0,h),f);l.x1=Math.max(Math.min(l.x1,h),f);return s}var p=l.cd[l.index];l.a=p.a;l.b=p.b;l.c=p.c;l.xLabelVal=undefined;l.yLabelVal=undefined;var d=l.trace;var v=l.subplot;var g=p.hi||d.hoverinfo;var m=g.split("+");var y=[];function x(t,e){y.push(t._hovertitle+": "+a.tickText(t,e,"hover").text)}if(m.indexOf("all")!==-1)m=["a","b","c"];if(m.indexOf("a")!==-1)x(v.aaxis,p.a);if(m.indexOf("b")!==-1)x(v.baxis,p.b);if(m.indexOf("c")!==-1)x(v.caxis,p.c);l.extraText=y.join("<br>");return s}},{"../../plots/cartesian/axes":732,"../scatter/hover":1025}],1089:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.colorbar=t("../scatter/marker_colorbar");n.calc=t("./calc");n.plot=t("./plot");n.style=t("../scatter/style").style;n.styleOnSelect=t("../scatter/style").styleOnSelect;n.hoverPoints=t("./hover");n.selectPoints=t("../scatter/select");n.eventData=t("./event_data");n.moduleType="trace";n.name="scatterternary";n.basePlotModule=t("../../plots/ternary");n.categories=["ternary","symbols","showLegend","scatter-like"];n.meta={};e.exports=n},{"../../plots/ternary":810,"../scatter/marker_colorbar":1032,"../scatter/select":1035,"../scatter/style":1036,"./attributes":1084,"./calc":1085,"./defaults":1086,"./event_data":1087,"./hover":1088,"./plot":1090}],1090:[function(t,e,r){"use strict";var n=t("../scatter/plot");e.exports=function t(e,r,a){var i=r.plotContainer;i.select(".scatterlayer").selectAll("*").remove();var o={xaxis:r.xaxis,yaxis:r.yaxis,plot:i,layerClipId:r._hasClipOnAxisFalse?r.clipIdRelative:null};var s=r.layers.frontplot.select("g.scatterlayer");n(e,o,a,s)}},{"../scatter/plot":1034}],1091:[function(t,e,r){"use strict";var n=t("../scattergl/attributes");var a=t("../../plots/cartesian/constants").idRegex;var i=t("../../plot_api/plot_template").templatedArray;function o(t){return{valType:"info_array",freeLength:true,editType:"calc",items:{valType:"subplotid",regex:a[t],editType:"plot"}}}e.exports={dimensions:i("dimension",{visible:{valType:"boolean",dflt:true,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:n.text,marker:n.marker,xaxes:o("x"),yaxes:o("y"),diagonal:{visible:{valType:"boolean",dflt:true,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:true,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:true,editType:"calc"},selected:{marker:n.selected.marker,editType:"calc"},unselected:{marker:n.unselected.marker,editType:"calc"},opacity:n.opacity}},{"../../plot_api/plot_template":722,"../../plots/cartesian/constants":737,"../scattergl/attributes":1062}],1092:[function(t,e,r){"use strict";var n=t("regl-line2d");var a=t("../../registry");var i=t("../../lib");var o=t("../../lib/prepare_regl");var s=t("../../plots/get_data").getModuleCalcData;var l=t("../../plots/cartesian");var u=t("../../plots/cartesian/axis_ids");var c="splom";function f(t){var e=t._fullLayout;var r=a.getModule(c);var n=s(t.calcdata,r)[0];var i=o(t,["ANGLE_instanced_arrays","OES_element_index_uint"]);if(!i)return;if(e._hasOnlyLargeSploms){d(t)}r.plot(t,{},n)}function h(t){var e=t.calcdata;var r=t._fullLayout;if(r._hasOnlyLargeSploms){d(t)}for(var n=0;n<e.length;n++){var a=e[n][0];var i=a.trace;var o=a.t._scene;if(i.type==="splom"&&o&&o.matrix){p(t,i,o)}}}function p(t,e,r){var n=e.dimensions;var a=r.matrixOptions.data.length;var i=new Array(a);for(var o=0,s=0;o<n.length;o++){if(n[o].visible){var l=i[s]=new Array(4);var c=u.getFromId(t,e._diag[o][0]);if(c){l[0]=c.r2l(c.range[0]);l[2]=c.r2l(c.range[1])}var f=u.getFromId(t,e._diag[o][1]);if(f){l[1]=f.r2l(f.range[0]);l[3]=f.r2l(f.range[1])}s++}}if(r.selectBatch){r.matrix.update({ranges:i},{ranges:i});r.matrix.draw(r.unselectBatch,r.selectBatch)}else{r.matrix.update({ranges:i});r.matrix.draw()}}function d(t){var e=t._fullLayout;var r=e._glcanvas.data()[0].regl;var a=e._splomGrid;if(!a){a=e._splomGrid=n(r)}a.update(v(t));a.draw()}function v(t){var e=t._fullLayout;var r=e._size;var n=[0,0,e.width,e.height];var a={};var i;function o(t,e,r,i,o,s){var l=e[t+"color"];var u=e[t+"width"];var c=String(l+u);if(c in a){a[c].data.push(NaN,NaN,r,i,o,s)}else{a[c]={data:[r,i,o,s],join:"rect",thickness:u,color:l,viewport:n,range:n,overlay:false}}}for(i in e._splomSubplots){var s=e._plots[i];var l=s.xaxis;var u=s.yaxis;var c=l._vals;var f=u._vals;var h=r.b+u.domain[0]*r.h;var p=-u._m;var d=-p*u.r2l(u.range[0],u.calendar);var v,m;if(l.showgrid){for(i=0;i<c.length;i++){v=l._offset+l.l2p(c[i].x);o("grid",l,v,h,v,h+u._length)}}if(g(l)){v=l._offset+l.l2p(0);o("zeroline",l,v,h,v,h+u._length)}if(u.showgrid){for(i=0;i<f.length;i++){m=h+d+p*f[i].x;o("grid",u,l._offset,m,l._offset+l._length,m)}}if(g(u)){m=h+d+0;o("zeroline",u,l._offset,m,l._offset+l._length,m)}}var y=[];for(i in a){y.push(a[i])}return y}function g(t){var e=i.simpleMap(t.range,t.r2l);var r=t.l2p(0);return t.zeroline&&t._vals&&t._vals.length&&e[0]*e[1]<=0&&(t.type==="linear"||t.type==="-")&&(r>1&&r<t._length-1||!t.showline)}function m(t,e,r,n,a){var i=n._modules||[];var o=e._modules||[];var s,u;var c;for(c=0;c<i.length;c++){if(i[c].name==="splom"){s=true;break}}for(c=0;c<o.length;c++){if(o[c].name==="splom"){u=true;break}}if(s&&!u){for(c=0;c<a.length;c++){var f=a[c][0];var h=f.trace;var p=f.t._scene;if(h.type==="splom"&&p&&p.matrix&&p.matrix.destroy){p.matrix.destroy();f.t._scene=null}}}if(n._splomGrid&&(!e._hasOnlyLargeSploms&&n._hasOnlyLargeSploms)){n._splomGrid.destroy();n._splomGrid=null}l.clean(t,e,r,n)}e.exports={name:c,attr:l.attr,attrRegex:l.attrRegex,layoutAttributes:l.layoutAttributes,supplyLayoutDefaults:l.supplyLayoutDefaults,drawFramework:l.drawFramework,plot:f,drag:h,clean:m,updateFx:l.updateFx,toSVG:l.toSVG}},{"../../lib":684,"../../lib/prepare_regl":697,"../../plots/cartesian":743,"../../plots/cartesian/axis_ids":735,"../../plots/get_data":768,"../../registry":817,"regl-line2d":458}],1093:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/array_container_defaults");var i=t("./attributes");var o=t("../scatter/subtypes");var s=t("../scatter/marker_defaults");var l=t("../parcoords/merge_length");var u=/-open/;e.exports=function t(e,r,h,p){function d(t,a){return n.coerce(e,r,i,t,a)}var v=a(e,r,{name:"dimensions",handleItemDefaults:c});var g=d("diagonal.visible");var m=d("showupperhalf");var y=d("showlowerhalf");var x=l(r,v,"values");if(!x||!g&&!m&&!y){r.visible=false;return}d("text");s(e,r,h,p,d);var b=u.test(r.marker.symbol);var _=o.isBubble(r);d("marker.line.width",b||_?1:0);f(e,r,p,d);n.coerceSelectionMarkerOpacity(r,d)};function c(t,e){function r(r,a){return n.coerce(t,e,i.dimensions,r,a)}r("label");var a=r("values");if(!(a&&a.length))e.visible=false;else r("visible")}function f(t,e,r,n){var a=e.dimensions;var i=a.length;var o=e.showupperhalf;var s=e.showlowerhalf;var l=e.diagonal.visible;var u,c;var f=!l&&(!o||!s)?i-1:i;var v=n("xaxes",h("x",f));var g=n("yaxes",h("y",f));e._xaxes=d(v);e._yaxes=d(g);var m=Math.min(f,v.length,g.length);for(u=0;u<m;u++){for(c=0;c<m;c++){var y=[v[u]+g[c]];if(u>c&&o){r._splomSubplots[y]=1}else if(u<c&&s){r._splomSubplots[y]=1}else if(u===c&&(l||!s||!o)){r._splomSubplots[y]=1}}}var x=e._diag=new Array(i);var b=!l&&!s?-1:0;var _=!l&&!o?-1:0;for(u=0;u<i;u++){var w=a[u];var k=v[u+b];var M=g[u+_];p(r,k,w);p(r,M,w);x[u]=[k,M]}if(!s){r._splomGridDflt.xside="bottom";r._splomGridDflt.yside="left"}}function h(t,e){var r=new Array(e);for(var n=0;n<e;n++){r[n]=t+(n?n+1:"")}return r}function p(t,e,r){if(!e)return;var n=e.charAt(0);var a=t._splomAxes[n];if(!(e in a)){a[e]=(r||{}).label||""}}function d(t){var e={};for(var r=0;r<t.length;r++){e[t[r]]=1}return e}},{"../../lib":684,"../../plots/array_container_defaults":728,"../parcoords/merge_length":987,"../scatter/marker_defaults":1033,"../scatter/subtypes":1037,"./attributes":1091}],1094:[function(t,e,r){"use strict";var n=t("regl-splom");var a=t("array-range");var i=t("../../registry");var o=t("../../components/grid");var s=t("../../lib");var l=t("../../plots/cartesian/axis_ids");var u=t("../scatter/subtypes");var c=t("../scatter/calc").calcMarkerSize;var f=t("../scatter/calc").calcAxisExpansion;var h=t("../scatter/colorscale_calc");var p=t("../scattergl/convert").markerSelection;var d=t("../scattergl/convert").markerStyle;var v=t("../scattergl").calcHover;var g=t("../../constants/numerical").BADNUM;var m=t("../scattergl/constants").TOO_MANY_POINTS;function y(t,e){var r=e.dimensions;var n=e._length;var a={};var i={};var o=i.cdata=[];var u=i.data=[];var v,g,y;for(v=0;v<r.length;v++){y=r[v];if(y.visible){var _=e._diag[v][0]||e._diag[v][1];var w=l.getFromId(t,_);if(w){var k=x(w,e,y);var M=w.type==="log"?s.simpleMap(k,w.c2l):k;o.push(k);u.push(M)}}}h(e);s.extendFlat(i,d(e));var A=o.length;var T=A*n>m;for(v=0,g=0;v<r.length;v++){y=r[v];if(y.visible){var S=l.getFromId(t,e._diag[v][0])||{};var E=l.getFromId(t,e._diag[v][1])||{};var C;if(T){C=2*(i.sizeAvg||Math.max(i.size,3))}else{C=c(e,n)}f(t,e,S,E,o[g],o[g],C);g++}}var L=a._scene=b(t,a);if(!L.matrix)L.matrix=true;L.matrixOptions=i;L.selectedOptions=p(e,e.selected);L.unselectedOptions=p(e,e.unselected);return[{x:false,y:false,t:a,trace:e}]}function x(t,e,r){var n=t.makeCalcdata({v:r.values,vcalendar:e.calendar},"v");for(var a=0;a<n.length;a++){n[a]=n[a]===g?NaN:n[a]}return n}function b(t,e){var r=e._scene;var n={dirty:true};var a={selectBatch:null,unselectBatch:null,matrix:false,select:null};if(!r){r=e._scene=s.extendFlat({},n,a);r.draw=function t(){if(r.matrix&&r.selectBatch){r.matrix.draw(r.unselectBatch,r.selectBatch)}else if(r.matrix){r.matrix.draw()}r.dirty=false};r.destroy=function t(){if(r.matrix)r.matrix.destroy();r.matrixOptions=null;r.selectBatch=null;r.unselectBatch=null;e._scene=null}}if(!r.dirty){s.extendFlat(r,n)}return r}function _(t,e,r){if(!r.length)return;for(var n=0;n<r.length;n++){w(t,r[n][0])}}function w(t,e){var r=t._fullLayout;var a=r._size;var i=e.trace;var o=e.t;var s=o._scene;var u=s.matrixOptions;var c=u.cdata;var f=r._glcanvas.data()[0].regl;var h=r.dragmode;var p,d;var v,g,m;if(c.length===0)return;u.lower=i.showupperhalf;u.upper=i.showlowerhalf;u.diagonal=i.diagonal.visible;var y=i.dimensions;var x=c.length;var b={};b.ranges=new Array(x);b.domains=new Array(x);for(v=0,m=0;v<y.length;v++){if(i.dimensions[v].visible){var _=b.ranges[m]=new Array(4);var w=b.domains[m]=new Array(4);p=l.getFromId(t,i._diag[v][0]);if(p){_[0]=p._rl[0];_[2]=p._rl[1];w[0]=p.domain[0];w[2]=p.domain[1]}d=l.getFromId(t,i._diag[v][1]);if(d){_[1]=d._rl[0];_[3]=d._rl[1];w[1]=d.domain[0];w[3]=d.domain[1]}m++}}b.viewport=[a.l,a.b,a.w+a.l,a.h+a.b];if(s.matrix===true){s.matrix=n(f)}var k=h==="lasso"||h==="select"||!!i.selectedpoints;s.selectBatch=null;s.unselectBatch=null;if(k){var M=i._length;if(!s.selectBatch){s.selectBatch=[];s.unselectBatch=[]}if(i.selectedpoints){s.selectBatch=i.selectedpoints;var A=i.selectedpoints;var T={};for(v=0;v<A.length;v++){T[A[v]]=true}var S=[];for(v=0;v<M;v++){if(!T[v])S.push(v)}s.unselectBatch=S}var E=o.xpx=new Array(x);var C=o.ypx=new Array(x);for(v=0,m=0;v<y.length;v++){if(i.dimensions[v].visible){p=l.getFromId(t,i._diag[v][0]);if(p){E[m]=new Array(M);for(g=0;g<M;g++){E[m][g]=p.c2p(c[m][g])}}d=l.getFromId(t,i._diag[v][1]);if(d){C[m]=new Array(M);for(g=0;g<M;g++){C[m][g]=d.c2p(c[m][g])}}m++}}if(s.selectBatch){s.matrix.update(u,u);s.matrix.update(s.unselectedOptions,s.selectedOptions);s.matrix.update(b,b)}else{s.matrix.update(b,null)}}else{s.matrix.update(u);s.matrix.update(b);o.xpx=o.ypx=null}s.draw()}function k(t,e,r){var n=t.cd;var a=n[0].trace;var i=n[0].t;var o=i._scene;var s=o.matrixOptions.cdata;var l=t.xa;var u=t.ya;var c=l.c2p(e);var f=u.c2p(r);var h=t.distance;var p=T(a,l);var d=T(a,u);if(p===false||d===false)return[t];var g=s[p];var m=s[d];var y,x;var b=h;for(var _=0;_<g.length;_++){var w=g[_];var k=m[_];var M=l.c2p(w)-c;var A=u.c2p(k)-f;var S=Math.sqrt(M*M+A*A);if(S<b){b=x=S;y=_}}t.index=y;t.distance=b;t.dxy=x;if(y===undefined)return[t];v(t,g,m,a);return[t]}function M(t,e){var r=t.cd;var n=r[0].trace;var i=r[0].t;var o=i._scene;var s=o.matrixOptions.cdata;var l=t.xaxis;var c=t.yaxis;var f=[];var h;if(!o)return f;var p=!u.hasMarkers(n)&&!u.hasText(n);if(n.visible!==true||p)return f;var d=T(n,l);var v=T(n,c);if(d===false||v===false)return f;var g=i.xpx[d];var m=i.ypx[v];var y=s[d];var x=s[v];var b=null;var _=null;if(e!==false&&!e.degenerate){b=[],_=[];for(h=0;h<y.length;h++){if(e.contains([g[h],m[h]])){b.push(h);f.push({pointNumber:h,x:y[h],y:x[h]})}else{_.push(h)}}}else{_=a(i.count)}if(!o.selectBatch){o.selectBatch=[];o.unselectBatch=[]}if(!o.selectBatch){for(h=0;h<o.count;h++){o.selectBatch=[];o.unselectBatch=[]}o.matrix.update(o.unselectedOptions,o.selectedOptions)}o.selectBatch=b;o.unselectBatch=_;return f}function A(t,e){if(!e)return;var r=t._fullLayout;var n=e[0];var a=n[0].t._scene;a.matrix.regl.clear({color:true,depth:true});if(r._splomGrid){r._splomGrid.draw()}for(var i=0;i<e.length;i++){var o=e[i][0].t._scene;o.draw()}if(r._has("cartesian")){for(var s in r._plots){var l=r._plots[s];if(l._scene)l._scene.draw()}}}function T(t,e){var r=e._id;var n=r.charAt(0);var a={x:0,y:1}[n];var i=t.dimensions;for(var o=0,s=0;o<i.length;o++){if(i[o].visible){if(t._diag[o][a]===r)return s;s++}}return false}e.exports={moduleType:"trace",name:"splom",basePlotModule:t("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:t("../scatter/marker_colorbar"),calc:y,plot:_,hoverPoints:k,selectPoints:M,style:A,meta:{}};i.register(o)},{"../../components/grid":604,"../../constants/numerical":661,"../../lib":684,"../../plots/cartesian/axis_ids":735,"../../registry":817,"../scatter/calc":1016,"../scatter/colorscale_calc":1019,"../scatter/marker_colorbar":1032,"../scatter/subtypes":1037,"../scattergl":1066,"../scattergl/constants":1063,"../scattergl/convert":1064,"./attributes":1091,"./base_plot":1092,"./defaults":1093,"array-range":58,"regl-splom":461}],1095:[function(t,e,r){"use strict";var n=t("../../components/colorscale/attributes");var a=t("../../components/colorbar/attributes");var i=t("../mesh3d/attributes");var o=t("../../plots/attributes");var s=t("../../lib/extend").extendFlat;var l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"}};s(l,n("",{colorAttr:"u/v/w norm",showScaleDflt:true,editTypeOverride:"calc"}),{colorbar:a});var u=["opacity","lightposition","lighting"];u.forEach(function(t){l[t]=i[t]});l.hoverinfo=s({},o.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"});e.exports=l},{"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../../plots/attributes":729,"../mesh3d/attributes":965}],1096:[function(t,e,r){"use strict";var n=t("../../components/colorscale/calc");e.exports=function t(e,r){var a;var i=r.u;var o=r.v;var s=r.w;var l=r.x;var u=r.y;var c=r.z;var f=Math.min(l.length,u.length,c.length,i.length,o.length,s.length);var h=0;var p,d,v;if(r.starts){p=r.starts.x||[];d=r.starts.y||[];v=r.starts.z||[];h=Math.min(p.length,d.length,v.length)}var g=0;var m=Infinity;for(a=0;a<f;a++){var y=i[a];var x=o[a];var b=s[a];var _=Math.sqrt(y*y+x*x+b*b);g=Math.max(g,_);m=Math.min(m,_)}n(r,[m,g],"","c");var w=-Infinity;var k=Infinity;var M=-Infinity;var A=Infinity;var T=-Infinity;var S=Infinity;for(a=0;a<f;a++){var E=l[a];w=Math.max(w,E);k=Math.min(k,E);var C=u[a];M=Math.max(M,C);A=Math.min(A,C);var L=c[a];T=Math.max(T,L);S=Math.min(S,L)}for(a=0;a<h;a++){var I=p[a];w=Math.max(w,I);k=Math.min(k,I);var z=d[a];M=Math.max(M,z);A=Math.min(A,z);var P=v[a];T=Math.max(T,P);S=Math.min(S,P)}r._len=f;r._slen=h;r._normMax=g;r._xbnds=[k,w];r._ybnds=[A,M];r._zbnds=[S,T]}},{"../../components/colorscale/calc":566}],1097:[function(t,e,r){"use strict";var n=t("gl-streamtube3d");var a=n.createTubeMesh;var i=t("../../lib");var o=t("../../lib/gl_format_color").parseColorScale;var s=t("../../plots/gl3d/zip3");var l={xaxis:0,yaxis:1,zaxis:2};function u(t,e){this.scene=t;this.uid=e;this.mesh=null;this.data=null}var c=u.prototype;c.handlePick=function(t){var e=this.scene.fullSceneLayout;var r=this.scene.dataScale;function n(t,n){var a=e[n];var i=r[l[n]];return a.l2c(t)/i}if(t.object===this.mesh){var a=t.data.position;var i=t.data.velocity;t.traceCoordinate=[n(a[0],"xaxis"),n(a[1],"yaxis"),n(a[2],"zaxis"),n(i[0],"xaxis"),n(i[1],"yaxis"),n(i[2],"zaxis"),t.data.intensity*this.data._normMax,t.data.divergence];t.textLabel=this.data.text;return true}};function f(t){return i.distinctVals(t).vals}function h(t){var e=t.length;var r;if(e>2){r=t.slice(1,e-1)}else if(e===2){r=[(t[0]+t[1])/2]}else{r=t}return r}function p(t){var e=t.length;if(e===1){return[.5,.5]}else{return[t[1]-t[0],t[e-1]-t[e-2]]}}function d(t,e){var r=t.fullSceneLayout;var a=t.dataScale;var u=e._len;var c={};function d(t,e){var n=r[e];var o=a[l[e]];return i.simpleMap(t,function(t){return n.d2l(t)*o})}c.vectors=s(d(e.u,"xaxis"),d(e.v,"yaxis"),d(e.w,"zaxis"),u);var v=f(e.x.slice(0,u));var g=f(e.y.slice(0,u));var m=f(e.z.slice(0,u));if(v.length*g.length*m.length>u){return{positions:[],cells:[]}}var y=d(v,"xaxis");var x=d(g,"yaxis");var b=d(m,"zaxis");c.meshgrid=[y,x,b];if(e.starts){var _=e._slen;c.startingPositions=s(d(e.starts.x.slice(0,_),"xaxis"),d(e.starts.y.slice(0,_),"yaxis"),d(e.starts.z.slice(0,_),"zaxis"))}else{var w=x[0];var k=h(y);var M=h(b);var A=new Array(k.length*M.length);var T=0;for(var S=0;S<k.length;S++){for(var E=0;E<M.length;E++){A[T++]=[k[S],w,M[E]]}}c.startingPositions=A}c.colormap=o(e.colorscale);c.tubeSize=e.sizeref;c.maxLength=e.maxdisplayed;var C=d(e._xbnds,"xaxis");var L=d(e._ybnds,"yaxis");var I=d(e._zbnds,"zaxis");var z=p(y);var P=p(x);var O=p(b);var D=[[C[0]-z[0],L[0]-P[0],I[0]-O[0]],[C[1]+z[1],L[1]+P[1],I[1]+O[1]]];var R=n(c,D);R.vertexIntensityBounds=[e.cmin/e._normMax,e.cmax/e._normMax];var B=e.lightposition;R.lightPosition=[B.x,B.y,B.z];R.ambient=e.lighting.ambient;R.diffuse=e.lighting.diffuse;R.specular=e.lighting.specular;R.roughness=e.lighting.roughness;R.fresnel=e.lighting.fresnel;R.opacity=e.opacity;e._pad=R.tubeScale*e.sizeref*2;return R}c.update=function(t){this.data=t;var e=d(this.scene,t);this.mesh.update(e)};c.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function v(t,e){var r=t.glplot.gl;var n=d(t,e);var i=a(r,n);var o=new u(t,e.uid);o.mesh=i;o.data=e;i._trace=o;t.glplot.add(i);return o}e.exports=v},{"../../lib":684,"../../lib/gl_format_color":680,"../../plots/gl3d/zip3":785,"gl-streamtube3d":300}],1098:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../components/colorscale/defaults");var i=t("./attributes");e.exports=function t(e,r,o,s){function l(t,a){return n.coerce(e,r,i,t,a)}var u=l("u");var c=l("v");var f=l("w");var h=l("x");var p=l("y");var d=l("z");if(!u||!u.length||!c||!c.length||!f||!f.length||!h||!h.length||!p||!p.length||!d||!d.length){r.visible=false;return}l("starts.x");l("starts.y");l("starts.z");l("maxdisplayed");l("sizeref");l("lighting.ambient");l("lighting.diffuse");l("lighting.specular");l("lighting.roughness");l("lighting.fresnel");l("lightposition.x");l("lightposition.y");l("lightposition.z");a(e,r,s,l,{prefix:"",cLetter:"c"});l("text");r._length=null}},{"../../components/colorscale/defaults":568,"../../lib":684,"./attributes":1095}],1099:[function(t,e,r){"use strict";e.exports={moduleType:"trace",name:"streamtube",basePlotModule:t("../../plots/gl3d"),categories:["gl3d"],attributes:t("./attributes"),supplyDefaults:t("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:t("./calc"),plot:t("./convert"),eventData:function(t,e){t.tubex=t.x;t.tubey=t.y;t.tubez=t.z;t.tubeu=e.traceCoordinate[3];t.tubev=e.traceCoordinate[4];t.tubew=e.traceCoordinate[5];t.norm=e.traceCoordinate[6];t.divergence=e.traceCoordinate[7];delete t.x;delete t.y;delete t.z;return t},meta:{}}},{"../../plots/gl3d":774,"./attributes":1095,"./calc":1096,"./convert":1097,"./defaults":1098}],1100:[function(t,e,r){"use strict";var n=t("../../components/color");var a=t("../../components/colorscale/attributes");var i=t("../../components/colorbar/attributes");var o=t("../../plots/attributes");var s=t("../../lib/extend").extendFlat;var l=t("../../plot_api/edit_types").overrideAll;function u(t){return{valType:"boolean",dflt:false}}function c(t){return{show:{valType:"boolean",dflt:false},project:{x:u("x"),y:u("y"),z:u("z")},color:{valType:"color",dflt:n.defaultLine},usecolormap:{valType:"boolean",dflt:false},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:true},highlightcolor:{valType:"color",dflt:n.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var f=e.exports=l(s({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:true},surfacecolor:{valType:"data_array"}},a("",{colorAttr:"z or surfacecolor",showScaleDflt:true,autoColorDflt:false,editTypeOverride:"calc"}),{colorbar:i,contours:{x:c("x"),y:c("y"),z:c("z")},hidesurface:{valType:"boolean",dflt:false},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},_deprecated:{zauto:s({},a.zauto,{}),zmin:s({},a.zmin,{}),zmax:s({},a.zmax,{})},hoverinfo:s({},o.hoverinfo)}),"calc","nested");f.x.editType=f.y.editType=f.z.editType="calc+clearAxisTypes"},{"../../components/color":558,"../../components/colorbar/attributes":559,"../../components/colorscale/attributes":565,"../../lib/extend":673,"../../plot_api/edit_types":715,"../../plots/attributes":729}],1101:[function(t,e,r){"use strict";var n=t("../../components/colorscale/calc");e.exports=function t(e,r){if(r.surfacecolor){n(r,r.surfacecolor,"","c")}else{n(r,r.z,"","c")}}},{"../../components/colorscale/calc":566}],1102:[function(t,e,r){"use strict";var n=t("gl-surface3d");var a=t("ndarray");var i=t("ndarray-homography");var o=t("ndarray-fill");var s=t("ndarray-ops");var l=t("../../lib").isArrayOrTypedArray;var u=t("../../lib/gl_format_color").parseColorScale;var c=t("../../lib/str2rgbarray");var f=128;function h(t,e,r){this.scene=t;this.uid=r;this.surface=e;this.data=null;this.showContour=[false,false,false];this.dataScale=1}var p=h.prototype;p.handlePick=function(t){if(t.object===this.surface){var e=t.index=[Math.min(Math.round(t.data.index[0]/this.dataScale-1)|0,this.data.z[0].length-1),Math.min(Math.round(t.data.index[1]/this.dataScale-1)|0,this.data.z.length-1)];var r=[0,0,0];if(!l(this.data.x)){r[0]=e[0]}else if(l(this.data.x[0])){r[0]=this.data.x[e[1]][e[0]]}else{r[0]=this.data.x[e[0]]}if(!l(this.data.y)){r[1]=e[1]}else if(l(this.data.y[0])){r[1]=this.data.y[e[1]][e[0]]}else{r[1]=this.data.y[e[1]]}r[2]=this.data.z[e[1]][e[0]];t.traceCoordinate=r;var n=this.scene.fullSceneLayout;t.dataCoordinate=[n.xaxis.d2l(r[0],0,this.data.xcalendar)*this.scene.dataScale[0],n.yaxis.d2l(r[1],0,this.data.ycalendar)*this.scene.dataScale[1],n.zaxis.d2l(r[2],0,this.data.zcalendar)*this.scene.dataScale[2]];var a=this.data.text;if(Array.isArray(a)&&a[e[1]]&&a[e[1]][e[0]]!==undefined){t.textLabel=a[e[1]][e[0]]}else if(a){t.textLabel=a}else{t.textLabel=""}t.data.dataCoordinate=t.dataCoordinate.slice();this.surface.highlight(t.data);this.scene.glplot.spikes.position=t.dataCoordinate;return true}};function d(t){var e=t[0].rgb,r=t[t.length-1].rgb;return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}function v(t){var e=t.shape;var r=[e[0]+2,e[1]+2];var n=a(new Float32Array(r[0]*r[1]),r);s.assign(n.lo(1,1).hi(e[0],e[1]),t);s.assign(n.lo(1).hi(e[0],1),t.hi(e[0],1));s.assign(n.lo(1,r[1]-1).hi(e[0],1),t.lo(0,e[1]-1).hi(e[0],1));s.assign(n.lo(0,1).hi(1,e[1]),t.hi(1));s.assign(n.lo(r[0]-1,1).hi(1,e[1]),t.lo(e[0]-1));n.set(0,0,t.get(0,0));n.set(0,r[1]-1,t.get(0,e[1]-1));n.set(r[0]-1,0,t.get(e[0]-1,0));n.set(r[0]-1,r[1]-1,t.get(e[0]-1,e[1]-1));return n}function g(t){var e=Math.max(t[0].shape[0],t[0].shape[1]);if(e<f){var r=f/e;var n=[Math.floor(t[0].shape[0]*r+1)|0,Math.floor(t[0].shape[1]*r+1)|0];var o=n[0]*n[1];for(var s=0;s<t.length;++s){var l=v(t[s]);var u=a(new Float32Array(o),n);i(u,l,[r,0,0,0,r,0,0,0,1]);t[s]=u}return r}return 1}p.setContourLevels=function(){var t=[[],[],[]];var e=false;for(var r=0;r<3;++r){if(this.showContour[r]){e=true;t[r]=this.scene.contourLevels[r]}}if(e){this.surface.update({levels:t})}};p.update=function(t){var e,r=this.scene,n=r.fullSceneLayout,i=this.surface,s=t.opacity,f=u(t.colorscale,s),h=t.z,p=t.x,v=t.y,m=n.xaxis,y=n.yaxis,x=n.zaxis,b=r.dataScale,_=h[0].length,w=t._ylength,k=[a(new Float32Array(_*w),[_,w]),a(new Float32Array(_*w),[_,w]),a(new Float32Array(_*w),[_,w])],M=k[0],A=k[1],T=r.contourLevels;this.data=t;var S=t.xcalendar,E=t.ycalendar,C=t.zcalendar;o(k[2],function(t,e){return x.d2l(h[e][t],0,C)*b[2]});if(!l(p)){o(M,function(t){return m.d2l(t,0,S)*b[0]})}else if(l(p[0])){o(M,function(t,e){return m.d2l(p[e][t],0,S)*b[0]})}else{o(M,function(t){return m.d2l(p[t],0,S)*b[0]})}if(!l(p)){o(A,function(t,e){return y.d2l(e,0,S)*b[1]})}else if(l(v[0])){o(A,function(t,e){return y.d2l(v[e][t],0,E)*b[1]})}else{o(A,function(t,e){return y.d2l(v[e],0,E)*b[1]})}var L={colormap:f,levels:[[],[],[]],showContour:[true,true,true],showSurface:!t.hidesurface,contourProject:[[false,false,false],[false,false,false],[false,false,false]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacity:t.opacity};L.intensityBounds=[t.cmin,t.cmax];if(t.surfacecolor){var I=a(new Float32Array(_*w),[_,w]);o(I,function(e,r){return t.surfacecolor[r][e]});k.push(I)}else{L.intensityBounds[0]*=b[2];L.intensityBounds[1]*=b[2]}this.dataScale=g(k);if(t.surfacecolor){L.intensity=k.pop()}var z=[true,true,true];var P=["x","y","z"];for(e=0;e<3;++e){var O=t.contours[P[e]];z[e]=O.highlight;L.showContour[e]=O.show||O.highlight;if(!L.showContour[e])continue;L.contourProject[e]=[O.project.x,O.project.y,O.project.z];if(O.show){this.showContour[e]=true;L.levels[e]=T[e];i.highlightColor[e]=L.contourColor[e]=c(O.color);if(O.usecolormap){i.highlightTint[e]=L.contourTint[e]=0}else{i.highlightTint[e]=L.contourTint[e]=1}L.contourWidth[e]=O.width}else{this.showContour[e]=false}if(O.highlight){L.dynamicColor[e]=c(O.highlightcolor);L.dynamicWidth[e]=O.highlightwidth}}if(d(f)){L.vertexColor=true}L.coords=k;i.update(L);i.visible=t.visible;i.enableDynamic=z;i.enableHighlight=z;i.snapToData=true;if("lighting"in t){i.ambientLight=t.lighting.ambient;i.diffuseLight=t.lighting.diffuse;i.specularLight=t.lighting.specular;i.roughness=t.lighting.roughness;i.fresnel=t.lighting.fresnel}if("lightposition"in t){i.lightPosition=[t.lightposition.x,t.lightposition.y,t.lightposition.z]}if(s&&s<1){i.supportsTransparency=true}};p.dispose=function(){this.scene.glplot.remove(this.surface);this.surface.dispose()};function m(t,e){var r=t.glplot.gl;var a=n({gl:r});var i=new h(t,a,e.uid);a._trace=i;i.update(e);t.glplot.add(a);return i}e.exports=m},{"../../lib":684,"../../lib/gl_format_color":680,"../../lib/str2rgbarray":707,"gl-surface3d":302,ndarray:417,"ndarray-fill":407,"ndarray-homography":409,"ndarray-ops":411}],1103:[function(t,e,r){"use strict";var n=t("../../registry");var a=t("../../lib");var i=t("../../components/colorscale/defaults");var o=t("./attributes");e.exports=function t(e,r,l,u){var c,f;function h(t,n){return a.coerce(e,r,o,t,n)}var p=h("z");if(!p){r.visible=false;return}var d=h("x");h("y");r._xlength=Array.isArray(d)&&a.isArrayOrTypedArray(d[0])?p.length:p[0].length;r._ylength=p.length;var v=n.getComponentMethod("calendars","handleTraceDefaults");v(e,r,["x","y","z"],u);h("text");["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","opacity"].forEach(function(t){h(t)});var g=h("surfacecolor");h("colorscale");var m=["x","y","z"];for(c=0;c<3;++c){var y="contours."+m[c];var x=h(y+".show");var b=h(y+".highlight");if(x||b){for(f=0;f<3;++f){h(y+".project."+m[f])}}if(x){h(y+".color");h(y+".width");h(y+".usecolormap")}if(b){h(y+".highlightcolor");h(y+".highlightwidth")}}if(!g){s(e,"zmin","cmin");s(e,"zmax","cmax");s(e,"zauto","cauto")}i(e,r,u,h,{prefix:"",cLetter:"c"});r._length=null};function s(t,e,r){if(e in t&&!(r in t)){t[r]=t[e]}}},{"../../components/colorscale/defaults":568,"../../lib":684,"../../registry":817,"./attributes":1100}],1104:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.colorbar={min:"cmin",max:"cmax"};n.calc=t("./calc");n.plot=t("./convert");n.moduleType="trace";n.name="surface";n.basePlotModule=t("../../plots/gl3d");n.categories=["gl3d","2dMap","noOpacity"];n.meta={};e.exports=n},{"../../plots/gl3d":774,"./attributes":1100,"./calc":1101,"./convert":1102,"./defaults":1103}],1105:[function(t,e,r){"use strict";var n=t("../../components/annotations/attributes");var a=t("../../lib/extend").extendFlat;var i=t("../../plot_api/edit_types").overrideAll;var o=t("../../plots/font_attributes");var s=t("../../plots/domain").attributes;e.exports=i({domain:s({name:"table",trace:true}),columnwidth:{valType:"number",arrayOk:true,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:true,dflt:null},suffix:{valType:"string",arrayOk:true,dflt:null},height:{valType:"number",dflt:28},align:a({},n.align,{arrayOk:true}),line:{width:{valType:"number",arrayOk:true,dflt:1},color:{valType:"color",arrayOk:true,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:true,dflt:"white"}},font:a({},o({arrayOk:true}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:true,dflt:null},suffix:{valType:"string",arrayOk:true,dflt:null},height:{valType:"number",dflt:20},align:a({},n.align,{arrayOk:true}),line:{width:{valType:"number",arrayOk:true,dflt:1},color:{valType:"color",arrayOk:true,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:true,dflt:"white"}},font:a({},o({arrayOk:true}))}},"calc","from-root")},{"../../components/annotations/attributes":541,"../../lib/extend":673,"../../plot_api/edit_types":715,"../../plots/domain":757,"../../plots/font_attributes":758}],1106:[function(t,e,r){"use strict";var n=t("../../plots/get_data").getModuleCalcData;var a=t("./plot");var i="table";r.name=i;r.plot=function(t){var e=n(t.calcdata,i)[0];if(e.length)a(t,e)};r.clean=function(t,e,r,n){var a=n._has&&n._has(i);var o=e._has&&e._has(i);if(a&&!o){n._paperdiv.selectAll(".table").remove()}}},{"../../plots/get_data":768,"./plot":1113}],1107:[function(t,e,r){"use strict";var n=t("../../lib/gup").wrap;e.exports=function t(){return n({})}},{"../../lib/gup":681}],1108:[function(t,e,r){"use strict";e.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1109:[function(t,e,r){"use strict";var n=t("./constants");var a=t("../../lib/extend").extendFlat;var i=t("fast-isnumeric");e.exports=function t(e,r){var p=l(r.cells.values);var d=function(t){return t.slice(r.header.values.length,t.length)};var v=l(r.header.values);if(v.length&&!v[0].length){v[0]=[""];v=l(v)}var g=v.concat(d(p).map(function(){return u((v[0]||[""]).length)}));var m=r.domain;var y=Math.floor(e._fullLayout._size.w*(m.x[1]-m.x[0]));var x=Math.floor(e._fullLayout._size.h*(m.y[1]-m.y[0]));var b=r.header.values.length?g[0].map(function(){return r.header.height}):[n.emptyHeaderHeight];var _=p.length?p[0].map(function(){return r.cells.height}):[];var w=b.reduce(s,0);var k=x-w;var M=k+n.uplift;var A=h(_,M);var T=h(b,w);var S=f(T,[]);var E=f(A,S);var C={};var L=r._fullInput.columnorder.concat(d(p.map(function(t,e){return e})));var I=g.map(function(t,e){var n=Array.isArray(r.columnwidth)?r.columnwidth[Math.min(e,r.columnwidth.length-1)]:r.columnwidth;return i(n)?Number(n):1});var z=I.reduce(s,0);I=I.map(function(t){return t/z*y});var P=Math.max(o(r.header.line.width),o(r.cells.line.width));var O={key:r.index,translateX:m.x[0]*e._fullLayout._size.w,translateY:e._fullLayout._size.h*(1-m.y[1]),size:e._fullLayout._size,width:y,maxLineWidth:P,height:x,columnOrder:L,groupHeight:x,rowBlocks:E,headerRowBlocks:S,scrollY:0,cells:a({},r.cells,{values:p}),headerCells:a({},r.header,{values:g}),gdColumns:g.map(function(t){return t[0]}),gdColumnsOriginalOrder:g.map(function(t){return t[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:false},columns:g.map(function(t,e){var r=C[t];C[t]=(r||0)+1;var n=t+"__"+C[t];return{key:n,label:t,specIndex:e,xIndex:L[e],xScale:c,x:undefined,calcdata:undefined,columnWidth:I[e]}})};O.columns.forEach(function(t){t.calcdata=O;t.x=c(t)});return O};function o(t){if(Array.isArray(t)){var e=0;for(var r=0;r<t.length;r++){e=Math.max(e,o(t[r]))}return e}return t}function s(t,e){return t+e}function l(t){var e=t.slice();var r=Infinity;var n=0;var a;for(a=0;a<e.length;a++){if(!Array.isArray(e[a]))e[a]=[e[a]];r=Math.min(r,e[a].length);n=Math.max(n,e[a].length)}if(r!==n){for(a=0;a<e.length;a++){var i=n-e[a].length;if(i)e[a]=e[a].concat(u(i))}}return e}function u(t){var e=new Array(t);for(var r=0;r<t;r++)e[r]="";return e}function c(t){return t.calcdata.columns.reduce(function(e,r){return r.xIndex<t.xIndex?e+r.columnWidth:e},0)}function f(t,e){var r=Object.keys(t);return r.map(function(r){return a({},t[r],{auxiliaryBlocks:e})})}function h(t,e){var r={};var n;var a=0;var i=0;var o=p();var s=0;var l=0;for(var u=0;u<t.length;u++){n=t[u];o.rows.push({rowIndex:u,rowHeight:n});i+=n;if(i>=e||u===t.length-1){r[a]=o;o.key=l++;o.firstRowIndex=s;o.lastRowIndex=u;o=p();a+=i;s=u+1;i=0}}return r}function p(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}},{"../../lib/extend":673,"./constants":1108,"fast-isnumeric":214}],1110:[function(t,e,r){"use strict";var n=t("../../lib/extend").extendFlat;r.splitToPanels=function(t){var e=[0,0];var r=n({},t,{key:"header",type:"header",page:0,prevPages:e,currentRepaint:[null,null],dragHandle:true,values:t.calcdata.headerCells.values[t.specIndex],rowBlocks:t.calcdata.headerRowBlocks,calcdata:n({},t.calcdata,{cells:t.calcdata.headerCells})});var a=n({},t,{key:"cells1",type:"cells",page:0,prevPages:e,currentRepaint:[null,null],dragHandle:false,values:t.calcdata.cells.values[t.specIndex],rowBlocks:t.calcdata.rowBlocks});var i=n({},t,{key:"cells2",type:"cells",page:1,prevPages:e,currentRepaint:[null,null],dragHandle:false,values:t.calcdata.cells.values[t.specIndex],rowBlocks:t.calcdata.rowBlocks});return[a,i,r]};r.splitToCells=function(t){var e=a(t);return(t.values||[]).slice(e[0],e[1]).map(function(r,n){var a=typeof r==="string"&&r.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:n+a,key:e[0]+n,column:t,calcdata:t.calcdata,page:t.page,rowBlocks:t.rowBlocks,value:r}})};function a(t){var e=t.rowBlocks[t.page];var r=e?e.rows[0].rowIndex:0;var n=e?r+e.rows.length:0;return[r,n]}},{"../../lib/extend":673}],1111:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./attributes");var i=t("../../plots/domain").defaults;function o(t,e){var r=t.columnorder||[];var n=t.header.values.length;var a=r.slice(0,n);var i=a.slice().sort(function(t,e){return t-e});var o=a.map(function(t){return i.indexOf(t)});for(var s=o.length;s<n;s++){o.push(s)}e("columnorder",o)}e.exports=function t(e,r,s,l){function u(t,i){return n.coerce(e,r,a,t,i)}i(r,l,u);u("columnwidth");u("header.values");u("header.format");u("header.align");u("header.prefix");u("header.suffix");u("header.height");u("header.line.width");u("header.line.color");u("header.fill.color");n.coerceFont(u,"header.font",n.extendFlat({},l.font));o(r,u);u("cells.values");u("cells.format");u("cells.align");u("cells.prefix");u("cells.suffix");u("cells.height");u("cells.line.width");u("cells.line.color");u("cells.fill.color");n.coerceFont(u,"cells.font",n.extendFlat({},l.font));r._length=null}},{"../../lib":684,"../../plots/domain":757,"./attributes":1105}],1112:[function(t,e,r){"use strict";var n={};n.attributes=t("./attributes");n.supplyDefaults=t("./defaults");n.calc=t("./calc");n.plot=t("./plot");n.moduleType="trace";n.name="table";n.basePlotModule=t("./base_plot");n.categories=["noOpacity"];n.meta={};e.exports=n},{"./attributes":1105,"./base_plot":1106,"./calc":1107,"./defaults":1111,"./plot":1113}],1113:[function(t,e,r){"use strict";var n=t("./constants");var a=t("d3");var i=t("../../lib/gup");var o=t("../../components/drawing");var s=t("../../lib/svg_text_utils");var l=t("../../lib").raiseToTop;var u=t("../../lib").cancelTransition;var c=t("./data_preparation_helper");var f=t("./data_split_helpers");var h=t("../../components/color");e.exports=function t(e,r){var s=e._fullLayout._paper.selectAll("."+n.cn.table).data(r.map(function(t){var r=i.unwrap(t);var n=r.trace;return c(e,n)}),i.keyFun);s.exit().remove();s.enter().append("g").classed(n.cn.table,true).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all");s.attr("width",function(t){return t.width+t.size.l+t.size.r}).attr("height",function(t){return t.height+t.size.t+t.size.b}).attr("transform",function(t){return"translate("+t.translateX+","+t.translateY+")"});var h=s.selectAll("."+n.cn.tableControlView).data(i.repeat,i.keyFun);h.enter().append("g").classed(n.cn.tableControlView,true).style("box-sizing","content-box").on("mousemove",function(t){h.filter(function(e){return t===e}).call(m,e)}).on("mousewheel",function(t){if(t.scrollbarState.wheeling)return;t.scrollbarState.wheeling=true;a.event.stopPropagation();a.event.preventDefault();F(e,h,null,t.scrollY+a.event.deltaY)(t);t.scrollbarState.wheeling=false}).call(m,e,true);h.attr("transform",function(t){return"translate("+t.size.l+" "+t.size.t+")"});var x=h.selectAll("."+n.cn.scrollBackground).data(i.repeat,i.keyFun);x.enter().append("rect").classed(n.cn.scrollBackground,true).attr("fill","none");x.attr("width",function(t){return t.width}).attr("height",function(t){return t.height});h.each(function(t){o.setClipUrl(a.select(this),d(e,t))});var b=h.selectAll("."+n.cn.yColumn).data(function(t){return t.columns},i.keyFun);b.enter().append("g").classed(n.cn.yColumn,true);b.exit().remove();b.attr("transform",function(t){return"translate("+t.x+" 0)"}).call(a.behavior.drag().origin(function(t){var r=a.select(this);z(r,t,-n.uplift);l(this);t.calcdata.columnDragInProgress=true;m(h.filter(function(e){return t.calcdata.key===e.key}),e);return t}).on("drag",function(t){var e=a.select(this);var r=function(e){return(t===e?a.event.x:e.x)+e.columnWidth/2};t.x=Math.max(-n.overdrag,Math.min(t.calcdata.width+n.overdrag-t.columnWidth,a.event.x));var i=g(b).filter(function(e){return e.calcdata.key===t.calcdata.key});var o=i.sort(function(t,e){return r(t)-r(e)});o.forEach(function(e,r){e.xIndex=r;e.x=t===e?e.x:e.xScale(e)});b.filter(function(e){return t!==e}).transition().ease(n.transitionEase).duration(n.transitionDuration).attr("transform",function(t){return"translate("+t.x+" 0)"});e.call(u).attr("transform","translate("+t.x+" -"+n.uplift+" )")}).on("dragend",function(t){var r=a.select(this);var n=t.calcdata;t.x=t.xScale(t);t.calcdata.columnDragInProgress=false;z(r,t,0);L(e,n,n.columns.map(function(t){return t.xIndex}))}));b.each(function(t){o.setClipUrl(a.select(this),v(e,t))});var _=b.selectAll("."+n.cn.columnBlock).data(f.splitToPanels,i.keyFun);_.enter().append("g").classed(n.cn.columnBlock,true).attr("id",function(t){return t.key});_.style("cursor",function(t){return t.dragHandle?"ew-resize":t.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var w=_.filter(O);var k=_.filter(P);k.call(a.behavior.drag().origin(function(t){a.event.stopPropagation();return t}).on("drag",F(e,h,-1)).on("dragend",function(){}));y(e,h,w,_);y(e,h,k,_);var M=h.selectAll("."+n.cn.scrollAreaClip).data(i.repeat,i.keyFun);M.enter().append("clipPath").classed(n.cn.scrollAreaClip,true).attr("id",function(t){return d(e,t)});var A=M.selectAll("."+n.cn.scrollAreaClipRect).data(i.repeat,i.keyFun);A.enter().append("rect").classed(n.cn.scrollAreaClipRect,true).attr("x",-n.overdrag).attr("y",-n.uplift).attr("fill","none");A.attr("width",function(t){return t.width+2*n.overdrag}).attr("height",function(t){return t.height+n.uplift});var T=b.selectAll("."+n.cn.columnBoundary).data(i.repeat,i.keyFun);T.enter().append("g").classed(n.cn.columnBoundary,true);var S=b.selectAll("."+n.cn.columnBoundaryClippath).data(i.repeat,i.keyFun);S.enter().append("clipPath").classed(n.cn.columnBoundaryClippath,true);S.attr("id",function(t){return v(e,t)});var E=S.selectAll("."+n.cn.columnBoundaryRect).data(i.repeat,i.keyFun);E.enter().append("rect").classed(n.cn.columnBoundaryRect,true).attr("fill","none");E.attr("width",function(t){return t.columnWidth+2*p(t)}).attr("height",function(t){return t.calcdata.height+2*p(t)+n.uplift}).attr("x",function(t){return-p(t)}).attr("y",function(t){return-p(t)});B(null,k,h)};function p(t){return Math.ceil(t.calcdata.maxLineWidth/2)}function d(t,e){return"clip"+t._fullLayout._uid+"_scrollAreaBottomClip_"+e.key}function v(t,e){return"clip"+t._fullLayout._uid+"_columnBoundaryClippath_"+e.calcdata.key+"_"+e.specIndex}function g(t){return[].concat.apply([],t.map(function(t){return t})).map(function(t){return t.__data__})}function m(t,e,r){function o(t){var e=t.rowBlocks;return H(e,e.length-1)+(e.length?G(e[e.length-1],Infinity):1)}var s=t.selectAll("."+n.cn.scrollbarKit).data(i.repeat,i.keyFun);s.enter().append("g").classed(n.cn.scrollbarKit,true).style("shape-rendering","geometricPrecision");s.each(function(t){var e=t.scrollbarState;e.totalHeight=o(t);e.scrollableAreaHeight=t.groupHeight-D(t);e.currentlyVisibleHeight=Math.min(e.totalHeight,e.scrollableAreaHeight);e.ratio=e.currentlyVisibleHeight/e.totalHeight;e.barLength=Math.max(e.ratio*e.currentlyVisibleHeight,n.goldenRatio*n.scrollbarWidth);e.barWiggleRoom=e.currentlyVisibleHeight-e.barLength;e.wiggleRoom=Math.max(0,e.totalHeight-e.scrollableAreaHeight);e.topY=e.barWiggleRoom===0?0:t.scrollY/e.wiggleRoom*e.barWiggleRoom;e.bottomY=e.topY+e.barLength;e.dragMultiplier=e.wiggleRoom/e.barWiggleRoom}).attr("transform",function(t){var e=t.width+n.scrollbarWidth/2+n.scrollbarOffset;return"translate("+e+" "+D(t)+")"});var l=s.selectAll("."+n.cn.scrollbar).data(i.repeat,i.keyFun);l.enter().append("g").classed(n.cn.scrollbar,true);var u=l.selectAll("."+n.cn.scrollbarSlider).data(i.repeat,i.keyFun);u.enter().append("g").classed(n.cn.scrollbarSlider,true);u.attr("transform",function(t){return"translate(0 "+(t.scrollbarState.topY||0)+")"});var c=u.selectAll("."+n.cn.scrollbarGlyph).data(i.repeat,i.keyFun);c.enter().append("line").classed(n.cn.scrollbarGlyph,true).attr("stroke","black").attr("stroke-width",n.scrollbarWidth).attr("stroke-linecap","round").attr("y1",n.scrollbarWidth/2);c.attr("y2",function(t){return t.scrollbarState.barLength-n.scrollbarWidth/2}).attr("stroke-opacity",function(t){return t.columnDragInProgress||!t.scrollbarState.barWiggleRoom||r?0:.4});c.transition().delay(0).duration(0);c.transition().delay(n.scrollbarHideDelay).duration(n.scrollbarHideDuration).attr("stroke-opacity",0);var f=l.selectAll("."+n.cn.scrollbarCaptureZone).data(i.repeat,i.keyFun);f.enter().append("line").classed(n.cn.scrollbarCaptureZone,true).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",n.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(r){var n=a.event.y;var i=this.getBoundingClientRect();var o=r.scrollbarState;var s=n-i.top;var l=a.scale.linear().domain([0,o.scrollableAreaHeight]).range([0,o.totalHeight]).clamp(true);if(!(o.topY<=s&&s<=o.bottomY)){F(e,t,null,l(s-o.barLength/2))(r)}}).call(a.behavior.drag().origin(function(t){a.event.stopPropagation();t.scrollbarState.scrollbarScrollInProgress=true;return t}).on("drag",F(e,t)).on("dragend",function(){}));f.attr("y2",function(t){return t.scrollbarState.scrollableAreaHeight})}function y(t,e,r,n){var a=x(r);var i=b(a);M(i);var o=_(i);T(o);var s=k(i);var l=w(s);A(l);S(l,e,n,t);q(i)}function x(t){var e=t.selectAll("."+n.cn.columnCells).data(i.repeat,i.keyFun);e.enter().append("g").classed(n.cn.columnCells,true);e.exit().remove();return e}function b(t){var e=t.selectAll("."+n.cn.columnCell).data(f.splitToCells,function(t){return t.keyWithinBlock});e.enter().append("g").classed(n.cn.columnCell,true);e.exit().remove();return e}function _(t){var e=t.selectAll("."+n.cn.cellRect).data(i.repeat,function(t){return t.keyWithinBlock});e.enter().append("rect").classed(n.cn.cellRect,true);return e}function w(t){var e=t.selectAll("."+n.cn.cellText).data(i.repeat,function(t){return t.keyWithinBlock});e.enter().append("text").classed(n.cn.cellText,true).style("cursor",function(){return"auto"}).on("mousedown",function(){a.event.stopPropagation()});return e}function k(t){var e=t.selectAll("."+n.cn.cellTextHolder).data(i.repeat,function(t){return t.keyWithinBlock});e.enter().append("g").classed(n.cn.cellTextHolder,true).style("shape-rendering","geometricPrecision");return e}function M(t){t.each(function(t,e){var r=t.calcdata.cells.font;var n=t.column.specIndex;var a={size:I(r.size,n,e),color:I(r.color,n,e),family:I(r.family,n,e)};t.rowNumber=t.key;t.align=I(t.calcdata.cells.align,n,e);t.cellBorderWidth=I(t.calcdata.cells.line.width,n,e);t.font=a})}function A(t){t.each(function(t){o.font(a.select(this),t.font)})}function T(t){t.attr("width",function(t){return t.column.columnWidth}).attr("stroke-width",function(t){return t.cellBorderWidth}).each(function(t){var e=a.select(this);h.stroke(e,I(t.calcdata.cells.line.color,t.column.specIndex,t.rowNumber));h.fill(e,I(t.calcdata.cells.fill.color,t.column.specIndex,t.rowNumber))})}function S(t,e,r,i){t.text(function(t){var e=t.column.specIndex;var r=t.rowNumber;var i=t.value;var o=typeof i==="string";var s=o&&i.match(/<br>/i);var l=!o||s;t.mayHaveMarkup=o&&i.match(/[<&>]/);var u=E(i);t.latex=u;var c=u?"":I(t.calcdata.cells.prefix,e,r)||"";var f=u?"":I(t.calcdata.cells.suffix,e,r)||"";var h=u?null:I(t.calcdata.cells.format,e,r)||null;var p=c+(h?a.format(h)(t.value):t.value)+f;var d;t.wrappingNeeded=!t.wrapped&&!l&&!u&&(d=C(p));t.cellHeightMayIncrease=s||u||t.mayHaveMarkup||(d===void 0?C(p):d);t.needsConvertToTspans=t.mayHaveMarkup||t.wrappingNeeded||t.latex;var v;if(t.wrappingNeeded){var g=n.wrapSplitCharacter===" "?p.replace(/<a href=/ig,"<a_href="):p;var m=g.split(n.wrapSplitCharacter);var y=n.wrapSplitCharacter===" "?m.map(function(t){return t.replace(/<a_href=/ig,"<a href=")}):m;t.fragments=y.map(function(t){return{text:t,width:null}});t.fragments.push({fragment:n.wrapSpacer,width:null});v=y.join(n.lineBreaker)+n.lineBreaker+n.wrapSpacer}else{delete t.fragments;v=p}return v}).attr("dy",function(t){return t.needsConvertToTspans?0:"0.75em"}).each(function(t){var o=this;var l=a.select(o);var u=t.wrappingNeeded?j:V;if(t.needsConvertToTspans){s.convertToTspans(l,i,u(r,o,e,i,t))}else{a.select(o.parentNode).attr("transform",function(t){return"translate("+U(t)+" "+n.cellPad+")"}).attr("text-anchor",function(t){return{left:"start",center:"middle",right:"end"}[t.align]})}})}function E(t){return typeof t==="string"&&t.match(n.latexCheck)}function C(t){return t.indexOf(n.wrapSplitCharacter)!==-1}function L(t,e,r){var n=e.gdColumnsOriginalOrder;e.gdColumns.sort(function(t,e){return r[n.indexOf(t)]-r[n.indexOf(e)]});e.columnorder=r;t.emit("plotly_restyle")}function I(t,e,r){if(Array.isArray(t)){var n=t[Math.min(e,t.length-1)];if(Array.isArray(n)){return n[Math.min(r,n.length-1)]}else{return n}}else{return t}}function z(t,e,r){t.transition().ease(n.releaseTransitionEase).duration(n.releaseTransitionDuration).attr("transform","translate("+e.x+" "+r+")")}function P(t){return t.type==="cells"}function O(t){return t.type==="header"}function D(t){var e=t.rowBlocks.length?t.rowBlocks[0].auxiliaryBlocks:[];return e.reduce(function(t,e){return t+G(e,Infinity)},0)}function R(t,e,r){var n=[];var a=0;for(var i=0;i<t.length;i++){var o=t[i];var s=o.rows;var l=0;for(var u=0;u<s.length;u++){l+=s[u].rowHeight}o.allRowsHeight=l;var c=a+l;var f=e;var h=f+r;if(f<c&&h>a){n.push(i)}a+=l}return n}function B(t,e,r){var n=g(e)[0];if(n===undefined)return;var a=n.rowBlocks;var i=n.calcdata;var o=H(a,a.length);var s=n.calcdata.groupHeight-D(n);var l=i.scrollY=Math.max(0,Math.min(o-s,i.scrollY));var u=R(a,l,s);if(u.length===1){if(u[0]===a.length-1){u.unshift(u[0]-1)}else{u.push(u[0]+1)}}if(u[0]%2){u.reverse()}e.each(function(t,e){t.page=u[e];t.scrollY=l});e.attr("transform",function(t){var e=H(t.rowBlocks,t.page)-t.scrollY;return"translate(0 "+e+")"});if(t){N(t,r,e,u,n.prevPages,n,0);N(t,r,e,u,n.prevPages,n,1);m(r,t)}}function F(t,e,r,i){return function o(s){var l=s.calcdata?s.calcdata:s;var u=e.filter(function(t){return l.key===t.key});var c=r||l.scrollbarState.dragMultiplier;l.scrollY=i===void 0?l.scrollY+c*a.event.dy:i;var f=u.selectAll("."+n.cn.yColumn).selectAll("."+n.cn.columnBlock).filter(P);B(t,f,u)}}function N(t,e,r,n,a,i,o){var s=n[o]!==a[o];if(s){clearTimeout(i.currentRepaint[o]);i.currentRepaint[o]=setTimeout(function(){var i=r.filter(function(t,e){return e===o&&n[e]!==a[e]});y(t,e,i,r);a[o]=n[o]})}}function j(t,e,r){return function i(){var o=a.select(e.parentNode);o.each(function(t){var e=t.fragments;o.selectAll("tspan.line").each(function(t,r){e[r].width=this.getComputedTextLength()});var r=e[e.length-1].width;var a=e.slice(0,-1);var i=[];var s,l;var u=0;var c=t.column.columnWidth-2*n.cellPad;t.value="";while(a.length){s=a.shift();l=s.width+r;if(u+l>c){t.value+=i.join(n.wrapSpacer)+n.lineBreaker;i=[];u=0}i.push(s.text);u+=l}if(u){t.value+=i.join(n.wrapSpacer)}t.wrapped=true});o.selectAll("tspan.line").remove();S(o.select("."+n.cn.cellText),r,t);a.select(e.parentNode.parentNode).call(q)}}function V(t,e,r,i,o){return function s(){if(o.settledY)return;var l=a.select(e.parentNode);var u=Y(o);var c=o.key-u.firstRowIndex;var f=u.rows[c].rowHeight;var h=o.cellHeightMayIncrease?e.parentNode.getBoundingClientRect().height+2*n.cellPad:f;var p=Math.max(h,f);var d=p-u.rows[c].rowHeight;if(d){u.rows[c].rowHeight=p;t.selectAll("."+n.cn.columnCell).call(q);B(null,t.filter(P),0);m(r,i,true)}l.attr("transform",function(){var t=this;var e=t.parentNode;var r=e.getBoundingClientRect();var i=a.select(t.parentNode).select("."+n.cn.cellRect).node().getBoundingClientRect();var s=t.transform.baseVal.consolidate();var l=i.top-r.top+(s?s.matrix.f:n.cellPad);return"translate("+U(o,a.select(t.parentNode).select("."+n.cn.cellTextHolder).node().getBoundingClientRect().width)+" "+l+")"});o.settledY=true}}function U(t,e){switch(t.align){case"left":return n.cellPad;case"right":return t.column.columnWidth-(e||0)-n.cellPad;case"center":return(t.column.columnWidth-(e||0))/2;default:return n.cellPad}}function q(t){t.attr("transform",function(t){var e=t.rowBlocks[0].auxiliaryBlocks.reduce(function(t,e){return t+G(e,Infinity)},0);var r=Y(t);var n=G(r,t.key);var a=n+e;return"translate(0 "+a+")"}).selectAll("."+n.cn.cellRect).attr("height",function(t){return X(Y(t),t.key).rowHeight})}function H(t,e){var r=0;for(var n=e-1;n>=0;n--){r+=W(t[n])}return r}function G(t,e){var r=0;for(var n=0;n<t.rows.length&&t.rows[n].rowIndex<e;n++){r+=t.rows[n].rowHeight}return r}function W(t){var e=t.allRowsHeight;if(e!==void 0){return e}var r=0;for(var n=0;n<t.rows.length;n++){r+=t.rows[n].rowHeight}t.allRowsHeight=r;return r}function Y(t){return t.rowBlocks[t.page]}function X(t,e){return t.rows[e-t.firstRowIndex]}},{"../../components/color":558,"../../components/drawing":583,"../../lib":684,"../../lib/gup":681,"../../lib/svg_text_utils":708,"./constants":1108,"./data_preparation_helper":1109,"./data_split_helpers":1110,d3:147}],1114:[function(t,e,r){"use strict";var n=t("../box/attributes");var a=t("../../lib/extend").extendFlat;e.exports={y:n.y,x:n.x,x0:n.x0,y0:n.y0,name:n.name,orientation:a({},n.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:n.fillcolor,points:a({},n.boxpoints,{}),jitter:a({},n.jitter,{}),pointpos:a({},n.pointpos,{}),marker:n.marker,text:n.text,box:{visible:{valType:"boolean",dflt:false,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:false,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"plot"},selected:n.selected,unselected:n.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":673,"../box/attributes":840}],1115:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/cartesian/axes");var i=t("../box/calc");var o=t("./helpers");var s=t("../../constants/numerical").BADNUM;e.exports=function t(e,r){var s=i(e,r);if(s[0].t.empty)return s;var l=e._fullLayout;var f=a.getFromId(e,r[r.orientation==="h"?"xaxis":"yaxis"]);var h=l._violinScaleGroupStats;var p=r.scalegroup;var d=h[p];if(!d){d=h[p]={maxWidth:0,maxCount:0}}for(var v=0;v<s.length;v++){var g=s[v];var m=g.pts.map(o.extractVal);var y=g.bandwidth=u(r,g,m);var x=g.span=c(r,g,f,y);var b=x[1]-x[0];var _=Math.ceil(b/(y/3));var w=b/_;if(!isFinite(w)||!isFinite(_)){n.error("Something went wrong with computing the violin span");s[0].t.empty=true;return s}var k=o.makeKDE(g,r,m);g.density=new Array(_);for(var M=0,A=x[0];A<x[1]+w/2;M++,A+=w){var T=k(A);d.maxWidth=Math.max(d.maxWidth,T);g.density[M]={v:T,t:A}}a.expand(f,x,{padded:true});d.maxCount=Math.max(d.maxCount,m.length)}s[0].t.labels.kde=n._(e,"kde:");return s};function l(t,e,r){var n=Math.min(e,r/1.349);return 1.059*n*Math.pow(t,-.2)}function u(t,e,r){var a=e.max-e.min;if(!a)return 1;if(t.bandwidth){return Math.max(t.bandwidth,a/1e4)}else{var i=r.length;var o=n.stdev(r,i-1,e.mean);return Math.max(l(i,o,e.q3-e.q1),a/100)}}function c(t,e,r,n){var i=t.spanmode;var o=t.span||[];var l=[e.min,e.max];var u=[e.min-2*n,e.max+2*n];var c;function f(n){var a=o[n];var i=r.d2c(a,0,t[e.valLetter+"calendar"]);return i===s?u[n]:i}if(i==="soft"){c=u}else if(i==="hard"){c=l}else{c=[f(0),f(1)]}var h={type:"linear",range:c};a.setConvert(h);h.cleanRange();return c}},{"../../constants/numerical":661,"../../lib":684,"../../plots/cartesian/axes":732,"../box/calc":841,"./helpers":1117}],1116:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../components/color");var i=t("../box/defaults");var o=t("./attributes");e.exports=function t(e,r,s,l){function u(t,a){return n.coerce(e,r,o,t,a)}function c(t,a){return n.coerce2(e,r,o,t,a)}i.handleSampleDefaults(e,r,u,l);if(r.visible===false)return;u("bandwidth");u("scalegroup",r.name);u("scalemode");u("side");var f=u("span");var h;if(Array.isArray(f))h="manual";u("spanmode",h);var p=u("line.color",(e.marker||{}).color||s);var d=u("line.width");var v=u("fillcolor",a.addOpacity(r.line.color,.5));i.handlePointsDefaults(e,r,u,{prefix:""});var g=c("box.width");var m=c("box.fillcolor",v);var y=c("box.line.color",p);var x=c("box.line.width",d);var b=u("box.visible",Boolean(g||m||y||x));if(!b)delete r.box;var _=c("meanline.color",p);var w=c("meanline.width",d);var k=u("meanline.visible",Boolean(_||w));if(!k)delete r.meanline}},{"../../components/color":558,"../../lib":684,"../box/defaults":842,"./attributes":1114}],1117:[function(t,e,r){"use strict";var n=t("../../lib");var a={gaussian:function(t){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*t*t)}};r.makeKDE=function(t,e,r){var n=r.length;var i=a.gaussian;var o=t.bandwidth;var s=1/(n*o);return function(t){var e=0;for(var a=0;a<n;a++){e+=i((t-r[a])/o)}return s*e}};r.getPositionOnKdePath=function(t,e,r){var a,i;if(e.orientation==="h"){a="y";i="x"}else{a="x";i="y"}var o=n.findPointOnPath(t.path,r,i,{pathLength:t.pathLength});var s=t.posCenterPx;var l=o[a];var u=e.side==="both"?2*s-l:s;return[l,u]};r.getKdeValue=function(t,e,n){var a=t.pts.map(r.extractVal);var i=r.makeKDE(t,e,a);return i(n)/t.posDensityScale};r.extractVal=function(t){return t.v}},{"../../lib":684}],1118:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("../../plots/cartesian/axes");var i=t("../box/hover");var o=t("./helpers");e.exports=function t(e,r,s,l,u){var c=e.cd;var f=c[0].trace;var h=f.hoveron;var p=h.indexOf("violins")!==-1;var d=h.indexOf("kde")!==-1;var v=[];var g;var m;if(p||d){var y=i.hoverOnBoxes(e,r,s,l);if(p){v=v.concat(y)}if(d&&y.length>0){var x=e.xa;var b=e.ya;var _,w,k,M,A;if(f.orientation==="h"){A=r;_="y";k=b;w="x";M=x}else{A=s;_="x";k=x;w="y";M=b}var T=c[e.index];if(A>=T.span[0]&&A<=T.span[1]){var S=n.extendFlat({},e);var E=M.c2p(A,true);var C=o.getKdeValue(T,f,A);var L=o.getPositionOnKdePath(T,f,E);var I=k._offset;var z=k._length;S[_+"0"]=L[0];S[_+"1"]=L[1];S[w+"0"]=S[w+"1"]=E;S[w+"Label"]=w+": "+a.hoverLabelText(M,A)+", "+c[0].t.labels.kde+" "+C.toFixed(3);S.spikeDistance=y[0].spikeDistance;var P=_+"Spike";S[P]=y[0][P];y[0].spikeDistance=undefined;y[0][P]=undefined;v.push(S);m={stroke:e.color};m[_+"1"]=n.constrain(I+L[0],I,I+z);m[_+"2"]=n.constrain(I+L[1],I,I+z);m[w+"1"]=m[w+"2"]=M._offset+E}}}if(h.indexOf("points")!==-1){g=i.hoverOnPoints(e,r,s)}var O=u.selectAll(".violinline-"+f.uid).data(m?[0]:[]);O.enter().append("line").classed("violinline-"+f.uid,true).attr("stroke-width",1.5);O.exit().remove();O.attr(m);if(l==="closest"){if(g)return[g];return v}if(g){v.push(g);return v}return v}},{"../../lib":684,"../../plots/cartesian/axes":732,"../box/hover":843,"./helpers":1117}],1119:[function(t,e,r){"use strict";e.exports={attributes:t("./attributes"),layoutAttributes:t("./layout_attributes"),supplyDefaults:t("./defaults"),supplyLayoutDefaults:t("./layout_defaults"),calc:t("./calc"),setPositions:t("./set_positions"),plot:t("./plot"),style:t("./style"),styleOnSelect:t("../scatter/style").styleOnSelect,hoverPoints:t("./hover"),selectPoints:t("../box/select"),moduleType:"trace",name:"violin",basePlotModule:t("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":743,"../box/select":848,"../scatter/style":1036,"./attributes":1114,"./calc":1115,"./defaults":1116,"./hover":1118,"./layout_attributes":1120,"./layout_defaults":1121,"./plot":1122,"./set_positions":1123,"./style":1124}],1120:[function(t,e,r){"use strict";var n=t("../box/layout_attributes");var a=t("../../lib").extendFlat;e.exports={violinmode:a({},n.boxmode,{}),violingap:a({},n.boxgap,{}),violingroupgap:a({},n.boxgroupgap,{})}},{"../../lib":684,"../box/layout_attributes":845}],1121:[function(t,e,r){"use strict";var n=t("../../lib");var a=t("./layout_attributes");var i=t("../box/layout_defaults");e.exports=function t(e,r,o){function s(t,i){return n.coerce(e,r,a,t,i)}i._supply(e,r,o,s,"violin")}},{"../../lib":684,"../box/layout_defaults":846,"./layout_attributes":1120}],1122:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../lib");var i=t("../../components/drawing");var o=t("../box/plot");var s=t("../scatter/line_points");var l=t("./helpers");e.exports=function t(e,r,u,c){var f=e._fullLayout;var h=r.xaxis;var p=r.yaxis;function d(t){var e=s(t,{xaxis:h,yaxis:p,connectGaps:true,baseTolerance:.75,shape:"spline",simplify:true});return i.smoothopen(e[0],1)}var v=c.selectAll("g.trace.violins").data(u,function(t){return t[0].trace.uid});v.enter().append("g").attr("class","trace violins");v.exit().remove();v.order();v.each(function(t){var e=t[0];var i=e.t;var s=e.trace;var u=n.select(this);if(!r.isRangePlot)e.node3=u;var c=f._numViolins;var v=f.violinmode==="group"&&c>1;var g=1-f.violingap;var m=i.bdPos=i.dPos*g*(1-f.violingroupgap)/(v?c:1);var y=i.bPos=v?2*i.dPos*(-.5+(i.num+.5)/c)*g:0;i.wHover=i.dPos*(v?g/c:1);if(s.visible!==true||i.empty){n.select(this).remove();return}var x=r[i.valLetter+"axis"];var b=r[i.posLetter+"axis"];var _=s.side==="both";var w=_||s.side==="positive";var k=_||s.side==="negative";var M=f._violinScaleGroupStats[s.scalegroup];var A=u.selectAll("path.violin").data(a.identity);A.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin");A.exit().remove();A.each(function(t){var e=n.select(this);var r=t.density;var a=r.length;var o=t.pos+y;var l=b.c2p(o);var u;switch(s.scalemode){case"width":u=M.maxWidth/m;break;case"count":u=M.maxWidth/m*(M.maxCount/t.pts.length);break}var c,f,h;var p,v,g,A;if(w){g=new Array(a);for(p=0;p<a;p++){A=g[p]={};A[i.posLetter]=o+r[p].v/u;A[i.valLetter]=r[p].t}c=d(g)}if(k){g=new Array(a);for(v=0,p=a-1;v<a;v++,p--){A=g[v]={};A[i.posLetter]=o-r[p].v/u;A[i.valLetter]=r[p].t}f=d(g)}if(_){h=c+"L"+f.substr(1)+"Z"}else{var T=[l,x.c2p(r[0].t)];var S=[l,x.c2p(r[a-1].t)];if(s.orientation==="h"){T.reverse();S.reverse()}if(w){h="M"+T+"L"+c.substr(1)+"L"+S}else{h="M"+S+"L"+f.substr(1)+"L"+T}}e.attr("d",h);t.posCenterPx=l;t.posDensityScale=u*m;t.path=e.node();t.pathLength=t.path.getTotalLength()/(_?2:1)});var T=s.box||{};var S=T.width;var E=(T.line||{}).width;var C;var L;if(_){C=m*S;L=0}else if(w){C=[0,m*S/2];L=-E}else{C=[m*S/2,0];L=E}o.plotBoxAndWhiskers(u,{pos:b,val:x},s,{bPos:y,bdPos:C,bPosPxOffset:L});o.plotBoxMean(u,{pos:b,val:x},s,{bPos:y,bdPos:C,bPosPxOffset:L});var I;if(!(s.box||{}).visible&&(s.meanline||{}).visible){I=a.identity}var z=u.selectAll("path.meanline").data(I||[]);z.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke");z.exit().remove();z.each(function(t){var e=x.c2p(t.mean,true);var r=l.getPositionOnKdePath(t,s,e);n.select(this).attr("d",s.orientation==="h"?"M"+e+","+r[0]+"V"+r[1]:"M"+r[0]+","+e+"H"+r[1])});o.plotPoints(u,{x:h,y:p},s,i)})}},{"../../components/drawing":583,"../../lib":684,"../box/plot":847,"../scatter/line_points":1028,"./helpers":1117,d3:147}],1123:[function(t,e,r){"use strict";var n=t("../box/set_positions").setPositionOffset;var a=["v","h"];e.exports=function t(e,r){var i=e.calcdata;var o=r.xaxis;var s=r.yaxis;for(var l=0;l<a.length;l++){var u=a[l];var c=u==="h"?s:o;var f=[];var h=0;var p=0;for(var d=0;d<i.length;d++){var v=i[d];var g=v[0].t;var m=v[0].trace;if(m.visible===true&&m.type==="violin"&&!g.empty&&m.orientation===u&&m.xaxis===o._id&&m.yaxis===s._id){f.push(d);if(m.points!==false){h=Math.max(h,m.jitter-m.pointpos-1);p=Math.max(p,m.jitter+m.pointpos-1)}}}n("violin",e,f,c,[h,p])}}},{"../box/set_positions":849}],1124:[function(t,e,r){"use strict";var n=t("d3");var a=t("../../components/color");var i=t("../scatter/style").stylePoints;e.exports=function t(e,r){var o=r?r[0].node3:n.select(e).selectAll("g.trace.violins");o.style("opacity",function(t){return t[0].trace.opacity});o.each(function(t){var r=t[0].trace;var o=n.select(this);var s=r.box||{};var l=s.line||{};var u=r.meanline||{};var c=u.width;o.selectAll("path.violin").style("stroke-width",r.line.width+"px").call(a.stroke,r.line.color).call(a.fill,r.fillcolor);o.selectAll("path.box").style("stroke-width",l.width+"px").call(a.stroke,l.color).call(a.fill,s.fillcolor);var f={"stroke-width":c+"px","stroke-dasharray":2*c+"px,"+c+"px"};o.selectAll("path.mean").style(f).call(a.stroke,u.color);o.selectAll("path.meanline").style(f).call(a.stroke,u.color);i(o,r,e)})}},{"../../components/color":558,"../scatter/style":1036,d3:147}],1125:[function(t,e,r){"use strict";var n=t("../plots/cartesian/axes");var a=t("../lib");var i=t("../plot_api/plot_schema");var o=t("./helpers").pointsAccessorFunction;var s=t("../constants/numerical").BADNUM;r.moduleType="transform";r.name="aggregate";var l=r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},groups:{valType:"string",strict:true,noBlank:true,arrayOk:true,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:true,editType:"calc"},editType:"calc"},editType:"calc"};var u=l.aggregations;r.supplyDefaults=function(t,e){var r={};var n;function o(e,n){return a.coerce(t,r,l,e,n)}var s=o("enabled");if(!s)return r;var c=i.findArrayAttributes(e);var f={};for(n=0;n<c.length;n++)f[c[n]]=1;var h=o("groups");if(!Array.isArray(h)){if(!f[h]){r.enabled=false;return}f[h]=0}var p=t.aggregations||[];var d=r.aggregations=new Array(p.length);var v;function g(t,e){return a.coerce(p[n],v,u,t,e)}for(n=0;n<p.length;n++){v={_index:n};var m=g("target");var y=g("func");var x=g("enabled");if(x&&m&&(f[m]||y==="count"&&f[m]===undefined)){if(y==="stddev")g("funcmode");f[m]=0;d[n]=v}else d[n]={enabled:false,_index:n}}for(n=0;n<c.length;n++){if(f[c[n]]){d.push({target:c[n],func:u.func.dflt,enabled:true,_index:-1})}}return r};r.calcTransform=function(t,e,r){if(!r.enabled)return;var n=r.groups;var i=a.getTargetArray(e,{target:n});if(!i)return;var s,l,u,f;var h={};var p={};var d=[];var v=o(e.transforms,r);var g=i.length;if(e._length)g=Math.min(g,e._length);for(s=0;s<g;s++){l=i[s];u=h[l];if(u===undefined){h[l]=d.length;f=[s];d.push(f);p[h[l]]=v(s)}else{d[u].push(s);p[h[l]]=(p[h[l]]||[]).concat(v(s))}}r._indexToPoints=p;var m=r.aggregations;for(s=0;s<m.length;s++){c(t,e,d,m[s])}if(typeof n==="string"){c(t,e,d,{target:n,func:"first",enabled:true})}e._length=d.length};function c(t,e,r,i){if(!i.enabled)return;var o=i.target;var s=a.nestedProperty(e,o);var l=s.get();var u=n.getDataConversions(t,e,o,l);var c=f(i,u);var h=new Array(r.length);for(var p=0;p<r.length;p++){h[p]=c(l,r[p])}s.set(h);if(i.func==="count"){a.pushUnique(e._arrayAttrs,o)}}function f(t,e){var r=t.func;var n=e.d2c;var a=e.c2d;switch(r){case"count":return h;case"first":return p;case"last":return d;case"sum":return function(t,e){var r=0;for(var i=0;i<e.length;i++){var o=n(t[e[i]]);if(o!==s)r+=o}return a(r)};case"avg":return function(t,e){var r=0;var i=0;for(var o=0;o<e.length;o++){var l=n(t[e[o]]);if(l!==s){r+=l;i++}}return i?a(r/i):s};case"min":return function(t,e){var r=Infinity;for(var i=0;i<e.length;i++){var o=n(t[e[i]]);if(o!==s)r=Math.min(r,o)}return r===Infinity?s:a(r)};case"max":return function(t,e){var r=-Infinity;for(var i=0;i<e.length;i++){var o=n(t[e[i]]);if(o!==s)r=Math.max(r,o)}return r===-Infinity?s:a(r)};case"range":return function(t,e){var r=Infinity;var i=-Infinity;for(var o=0;o<e.length;o++){var l=n(t[e[o]]);if(l!==s){r=Math.min(r,l);i=Math.max(i,l)}}return i===-Infinity||r===Infinity?s:a(i-r)};case"change":return function(t,e){var r=n(t[e[0]]);var i=n(t[e[e.length-1]]);return r===s||i===s?s:a(i-r)};case"median":return function(t,e){var r=[];for(var i=0;i<e.length;i++){var o=n(t[e[i]]);if(o!==s)r.push(o)}if(!r.length)return s;r.sort();var l=(r.length-1)/2;return a((r[Math.floor(l)]+r[Math.ceil(l)])/2)};case"mode":return function(t,e){var r={};var i=0;var o=s;for(var l=0;l<e.length;l++){var u=n(t[e[l]]);if(u!==s){var c=r[u]=(r[u]||0)+1;if(c>i){i=c;o=u}}}return i?a(o):s};case"rms":return function(t,e){var r=0;var i=0;for(var o=0;o<e.length;o++){var l=n(t[e[o]]);if(l!==s){r+=l*l;i++}}return i?a(Math.sqrt(r/i)):s};case"stddev":return function(e,r){var a=0;var i=0;var o=1;var l=s;var u;for(u=0;u<r.length&&l===s;u++){l=n(e[r[u]])}if(l===s)return s;for(;u<r.length;u++){var c=n(e[r[u]]);if(c!==s){var f=c-l;a+=f;i+=f*f;o++}}var h=t.funcmode==="sample"?o-1:o;if(!h)return 0;return Math.sqrt((i-a*a/o)/h)}}}function h(t,e){return e.length}function p(t,e){return t[e[0]]}function d(t,e){return t[e[e.length-1]]}},{"../constants/numerical":661,"../lib":684,"../plot_api/plot_schema":721,"../plots/cartesian/axes":732,"./helpers":1128}],1126:[function(t,e,r){"use strict";var n=t("../lib");var a=t("../registry");var i=t("../plots/cartesian/axes");var o=t("./helpers").pointsAccessorFunction;var s=t("../constants/filter_ops");var l=s.COMPARISON_OPS;var u=s.INTERVAL_OPS;var c=s.SET_OPS;r.moduleType="transform";r.name="filter";r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},target:{valType:"string",strict:true,noBlank:true,arrayOk:true,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(l).concat(u).concat(c),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:false,editType:"calc"},editType:"calc"};r.supplyDefaults=function(t){var e={};function i(a,i){return n.coerce(t,e,r.attributes,a,i)}var o=i("enabled");if(o){i("preservegaps");i("operation");i("value");i("target");var s=a.getComponentMethod("calendars","handleDefaults");s(t,e,"valuecalendar",null);s(t,e,"targetcalendar",null)}return e};r.calcTransform=function(t,e,r){if(!r.enabled)return;var a=n.getTargetArray(e,r);if(!a)return;var s=r.target;var l=a.length;if(e._length)l=Math.min(l,e._length);var u=r.targetcalendar;var c=e._arrayAttrs;var h=r.preservegaps;if(typeof s==="string"){var p=n.nestedProperty(e,s+"calendar").get();if(p)u=p}var d=i.getDataToCoordFunc(t,e,s,a);var v=f(r,d,u);var g={};var m={};var y=0;function x(t,r){for(var a=0;a<c.length;a++){var i=n.nestedProperty(e,c[a]);t(i,r)}}var b;var _;if(h){b=function(t){g[t.astr]=n.extendDeep([],t.get());t.set(new Array(l))};_=function(t,e){var r=g[t.astr][e];t.get()[e]=r}}else{b=function(t){g[t.astr]=n.extendDeep([],t.get());t.set([])};_=function(t,e){var r=g[t.astr][e];t.get().push(r)}}x(b);var w=o(e.transforms,r);for(var k=0;k<l;k++){var M=v(a[k]);if(M){x(_,k);m[y++]=w(k)}else if(h)y++}r._indexToPoints=m;e._length=y};function f(t,e,r){var n=t.operation,a=t.value,i=Array.isArray(a);function o(t){return t.indexOf(n)!==-1}var s=function(r){return e(r,0,t.valuecalendar)},f=function(t){return e(t,0,r)};var h;if(o(l)){h=i?s(a[0]):s(a)}else if(o(u)){h=i?[s(a[0]),s(a[1])]:[s(a),s(a)]}else if(o(c)){h=i?a.map(s):[s(a)]}switch(n){case"=":return function(t){return f(t)===h};case"!=":return function(t){return f(t)!==h};case"<":return function(t){return f(t)<h};case"<=":return function(t){return f(t)<=h};case">":return function(t){return f(t)>h};case">=":return function(t){return f(t)>=h};case"[]":return function(t){var e=f(t);return e>=h[0]&&e<=h[1]};case"()":return function(t){var e=f(t);return e>h[0]&&e<h[1]};case"[)":return function(t){var e=f(t);return e>=h[0]&&e<h[1]};case"(]":return function(t){var e=f(t);return e>h[0]&&e<=h[1]};case"][":return function(t){var e=f(t);return e<=h[0]||e>=h[1]};case")(":return function(t){var e=f(t);return e<h[0]||e>h[1]};case"](":return function(t){var e=f(t);return e<=h[0]||e>h[1]};case")[":return function(t){var e=f(t);return e<h[0]||e>=h[1]};case"{}":return function(t){return h.indexOf(f(t))!==-1};case"}{":return function(t){return h.indexOf(f(t))===-1}}}},{"../constants/filter_ops":657,"../lib":684,"../plots/cartesian/axes":732,"../registry":817,"./helpers":1128}],1127:[function(t,e,r){"use strict";var n=t("../lib");var a=t("../plot_api/plot_schema");var i=t("../plots/plots");var o=t("./helpers").pointsAccessorFunction;r.moduleType="transform";r.name="groupby";r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:true},editType:"calc"},editType:"calc"};r.supplyDefaults=function(t,e,a){var i;var o={};function s(e,a){return n.coerce(t,o,r.attributes,e,a)}var l=s("enabled");if(!l)return o;s("groups");s("nameformat",a._dataLength>1?"%{group} (%{trace})":"%{group}");var u=t.styles;var c=o.styles=[];if(u){for(i=0;i<u.length;i++){var f=c[i]={};n.coerce(u[i],c[i],r.attributes.styles,"target");var h=n.coerce(u[i],c[i],r.attributes.styles,"value");if(n.isPlainObject(h))f.value=n.extendDeep({},h);else if(h)delete f.value}}return o};r.transform=function(t,e){var r,n,a;var i=[];for(n=0;n<t.length;n++){r=s(t[n],e);for(a=0;a<r.length;a++){i.push(r[a])}}return i};function s(t,e){var r,s,u,c,f,h,p,d,v;var g;var m=e.transform;var y=e.transformIndex;var x=t.transforms[y].groups;var b=o(t.transforms,m);if(!Array.isArray(x)||x.length===0){return[t]}var _=n.filterUnique(x),w=new Array(_.length),k=x.length;var M=a.findArrayAttributes(t);var A=m.styles||[];var T={};for(r=0;r<A.length;r++){T[A[r].target]=A[r].value}if(m.styles){g=n.keyedContainer(m,"styles","target","value.name")}var S={};var E={};for(r=0;r<_.length;r++){h=_[r];S[h]=r;E[h]=0;p=w[r]=n.extendDeepNoArrays({},t);p._group=h;p.updateStyle=l(h,y);p.transforms[y]._indexToPoints={};var C=null;if(g){C=g.get(h)}if(C||C===""){p.name=C}else{p.name=n.templateString(m.nameformat,{trace:t.name,group:h})}d=p.transforms;p.transforms=[];for(s=0;s<d.length;s++){p.transforms[s]=n.extendDeepNoArrays({},d[s])}for(s=0;s<M.length;s++){n.nestedProperty(p,M[s]).set([])}}for(u=0;u<M.length;u++){c=M[u];for(s=0,v=[];s<_.length;s++){v[s]=n.nestedProperty(w[s],c).get()}f=n.nestedProperty(t,c).get();for(s=0;s<k;s++){v[S[x[s]]].push(f[s])}}for(s=0;s<k;s++){p=w[S[x[s]]];var L=p.transforms[y]._indexToPoints;L[E[x[s]]]=b(s);E[x[s]]++}for(r=0;r<_.length;r++){h=_[r];p=w[r];i.clearExpandedTraceDefaultColors(p);p=n.extendDeepNoArrays(p,T[h]||{})}return w}function l(t,e){return function(r,a,i){n.keyedContainer(r,"transforms["+e+"].styles","target","value."+a).set(String(t),i)}}},{"../lib":684,"../plot_api/plot_schema":721,"../plots/plots":795,"./helpers":1128}],1128:[function(t,e,r){"use strict";r.pointsAccessorFunction=function(t,e){var r;var n;for(var a=0;a<t.length;a++){r=t[a];if(r===e)break;if(!r._indexToPoints||r.enabled===false)continue;n=r._indexToPoints}var i=n?function(t){return n[t]}:function(t){return[t]};return i}},{}],1129:[function(t,e,r){"use strict";var n=t("../lib");var a=t("../plots/cartesian/axes");var i=t("./helpers").pointsAccessorFunction;r.moduleType="transform";r.name="sort";r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},target:{valType:"string",strict:true,noBlank:true,arrayOk:true,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"};r.supplyDefaults=function(t){var e={};function a(a,i){return n.coerce(t,e,r.attributes,a,i)}var i=a("enabled");if(i){a("target");a("order")}return e};r.calcTransform=function(t,e,r){if(!r.enabled)return;var s=n.getTargetArray(e,r);if(!s)return;var l=r.target;var u=s.length;if(e._length)u=Math.min(u,e._length);var c=e._arrayAttrs;var f=a.getDataToCoordFunc(t,e,l,s);var h=o(r,s,f,u);var p=i(e.transforms,r);var d={};var v,g;for(v=0;v<c.length;v++){var m=n.nestedProperty(e,c[v]);var y=m.get();var x=new Array(u);for(g=0;g<u;g++){x[g]=y[h[g]]}m.set(x)}for(g=0;g<u;g++){d[g]=p(h[g])}r._indexToPoints=d;e._length=u};function o(t,e,r,n){var a=new Array(n);var i=new Array(n);var o;for(o=0;o<n;o++){a[o]={v:e[o],i:o}}a.sort(s(t,r));for(o=0;o<n;o++){i[o]=a[o].i}return i}function s(t,e){switch(t.order){case"ascending":return function(t,r){return e(t.v)-e(r.v)};case"descending":return function(t,r){return e(r.v)-e(t.v)}}}},{"../lib":684,"../plots/cartesian/axes":732,"./helpers":1128}]},{},[21])(21)});